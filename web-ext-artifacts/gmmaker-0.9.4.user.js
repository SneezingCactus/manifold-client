// ==UserScript==
// @name         Game Mode Maker
// @version      0.9.4
// @author       SneezingCactus
// @namespace    https://github.com/SneezingCactus
// @description  A bonk.io mod that lets you create your own game modes using blocks.
// @homepage     https://github.com/SneezingCactus/gmmaker
// @match        https://bonk.io/gameframe-release.html
// @run-at       document-start
// @grant        none
// ==/UserScript==
/*
  Usable with:
  https://greasyfork.org/en/scripts/433861-code-injector-bonk-io
*/


window.gmInjectBonkScript=function(bonkSrc){console.log("[Game Mode Maker] Injecting alpha2s.js..."),window.gmRegexes={funcs:[{name:"io",regex:"=\\(1,(...[^\\)]+)\\).{0,100}reconnection",isConstructor:!1},{name:"Box2D",regex:"requirejs\\(\\[[^\\]]+\\],function\\([^,]+,[^,]+,([^\\)]+)",isConstructor:!0},{name:"BonkGraphics",regex:"null;[A-Za-z0-9\\[\\]]+\\(true\\);[A-Za-z0-9\\[\\]]+=null;}};([A-Za-z0-9\\[\\]]+)=class",isConstructor:!0},{name:"BonkUtils",regex:"(...\\[[^\\]]+\\]).{10,20}=function\\((...,){4}...\\).{0,1400}0\\.62",isConstructor:!0},{name:"NetworkEngine",regex:"function ([^\\)]*)\\([^\\)]{11}\\).{0,5000}reconnection:false",isConstructor:!0},{name:"NewBonkLobby",regex:"function (..)\\(.{15}\\).{0,10000}newbonklobby",isConstructor:!0},{name:"GenericGameSessionHandler",regex:"new (..)\\(null\\)",isConstructor:!0},{name:"MapEncoder",regex:"{try{.{3,6}=(.{1,2})\\[",isConstructor:!0},{name:"PhysicsClass",regex:";([A-Za-z])\\[.{0,100}]={discs",isConstructor:!0},{name:"ModeList",regex:";([A-Za-z0-9]{3}\\[[0-9]{0,10}\\]).{0,50}={lobbyName",isConstructor:!0}],replace:[{regex:"(for\\(([^\\]]+\\]){4}\\]\\(.{0,400}\\}[A-Z]([^\\]]+\\]){2}\\]=undefined;)",to:"window.gmReplaceAccessors.endStep = () => {$1};"},{regex:"(shapes:JSON[^,]{0,100},fixtures:)([^,]{0,100})(.{0,400}ppm:)([^}]{0,100})",to:"$1JSON.parse(JSON.stringify($2))$3JSON.parse(JSON.stringify($4))"},{regex:"( < 100\\).{0,100}\\+ 1.{0,200}\\+\\+;)([^\\]]+\\])",to:"$1window.gmReplaceAccessors.gameStateList = $2;$2"},{regex:"if\\(([^ ]+)( != Infinity\\){)(for[^<]+< )([^\\]]+\\])(.{0,400}=Infinity;)",to:"if($1$2gm.graphics.doRollback($4, $1);$3$4$5"},{regex:"(for.{0,100}if\\()(.{0,1200} == false &&.{0,100}> .{0,100}850)",to:"$1!window.gmReplaceAccessors.disableDeathBarrier && $2"},{regex:"(=Math.{0,30}Math.{0,30}\\(1[^,]{0,10},)([^,]{0,10},-1)",flags:"gm",to:"$1(window.gmReplaceAccessors.addToStereo ?? 0) + $2"}],inject:{regex:";}\\);}}\\);",wrap:{left:";});",right:"}});"}}};let newBonkSrc=bonkSrc,funcHooks="";const funcNames=[];return gmRegexes.funcs.map((function(func){const match=bonkSrc.match(func.regex);if(!match)throw console.error("[Game Mode Maker] Regex failed!",func),"Game Mode Maker injection error";const funcInBonk=match[1];funcNames.push({name:func.name,regex:func.regex,func:funcInBonk}),funcHooks+=`window.${func.name} = ${funcInBonk}; window.${func.name}_OLD = ${funcInBonk}; ${funcInBonk} = `+(func.isConstructor?`new Proxy(${funcInBonk}, {\n\tconstruct(target, args) { \n\t\treturn new ${func.name}(...args); \n\t}\n});\n`:`function(){\n\treturn ${func.name}(...arguments);\n};\n`)})),console.log("[Game Mode Maker] Using hooks:",funcNames),newBonkSrc=newBonkSrc.replace(new RegExp(gmRegexes.inject.regex),`${gmRegexes.inject.wrap.left}${funcHooks}\n\nif(window.initGM) {\n  window.initGM(); \n} else {\n  window.waitForGM = setInterval(()=>{\n    if(window.initGM){\n      window.initGM();\n      clearInterval(window.waitForGM);\n    }\n  }, 500);\n}\n${gmRegexes.inject.wrap.right}`),window.gmReplaceAccessors={},gmRegexes.replace.map((function(replace){if(!bonkSrc.match(replace.regex))throw console.error("[Game Mode Maker] Regex failed!",replace),"Game Mode Maker injection error";newBonkSrc=newBonkSrc.replace(new RegExp(replace.regex,replace.flags)," /* GMMAKER REPLACE */ "+replace.to)})),newBonkSrc},window.bonkCodeInjectors||(window.bonkCodeInjectors=[]),window.bonkCodeInjectors.push((bonkSrc=>{try{return gmInjectBonkScript(bonkSrc)}catch(error){throw alert("An error ocurred while loading Game Mode Maker.\n\n\nThis may have happened because you have an extension that is not compatible with Game Mode Maker. Try disabling all other bonk.io extensions, and reload.\n\nIf the problem persists, please report this error as it may be due to a bonk.io update."),error}})),window.bonkCodeInjectors.push((bonkSrc=>bonkSrc)),console.log("[Game Mode Maker] Injector loaded");
/*! For license information please see gmLoader.js.LICENSE.txt */
(()=>{var __webpack_modules__={4165:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{p:()=>WorkspaceSearch});const CSS_CONTENT=["path.blocklyPath.blockly-ws-search-highlight {","fill: black;","}","path.blocklyPath.blockly-ws-search-highlight.blockly-ws-search-current {","fill: grey;","}",".blockly-ws-search-close-btn {","background: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMTQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgd2lkdGg9IjE0Ij48cGF0aCBkPSJNMTkgNi40MUwxNy41OSA1IDEyIDEwLjU5IDYuNDEgNSA1IDYuNDEgMTAuNTkgMTIgNSAxNy41OSA2LjQxIDE5IDEyIDEzLjQxIDE3LjU5IDE5IDE5IDE3LjU5IDEzLjQxIDEyeiIvPjxwYXRoIGQ9Ik0wIDBoMjR2MjRIMHoiIGZpbGw9Im5vbmUiLz48L3N2Zz4=) no-repeat top left;","}",".blockly-ws-search-next-btn {","background: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMTQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgd2lkdGg9IjE0Ij48cGF0aCBkPSJNNy40MSA4LjU5TDEyIDEzLjE3bDQuNTktNC41OEwxOCAxMGwtNiA2LTYtNiAxLjQxLTEuNDF6Ii8+PHBhdGggZD0iTTAgMGgyNHYyNEgwVjB6IiBmaWxsPSJub25lIi8+PC9zdmc+) no-repeat top left;","}",".blockly-ws-search-previous-btn {","background: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMTQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgd2lkdGg9IjE0Ij48cGF0aCBkPSJNNy40MSAxNS40MUwxMiAxMC44M2w0LjU5IDQuNThMMTggMTRsLTYtNi02IDZ6Ii8+PHBhdGggZD0iTTAgMGgyNHYyNEgweiIgZmlsbD0ibm9uZSIvPjwvc3ZnPg==) no-repeat top left;","}",".blockly-ws-search {","background: white;","border: solid lightgrey .5px;","box-shadow: 0px 10px 20px grey;","justify-content: center;","padding: .25em;","position: absolute;","z-index: 70;","}",".blockly-ws-search-input input {","border: none;","}",".blockly-ws-search button {","border: none;","}",".blockly-ws-search-actions {","display: flex;","}",".blockly-ws-search-container {","display: flex;","}",".blockly-ws-search-content {","display: flex;","}"],injectSearchCss=function(){let executed=!1;return function(){if(executed)return;executed=!0;const text=CSS_CONTENT.join("\n"),cssNode=document.createElement("style");cssNode.id="blockly-ws-search-style";const cssTextNode=document.createTextNode(text);cssNode.appendChild(cssTextNode),document.head.insertBefore(cssNode,document.head.firstChild)}}();var core_browser=__webpack_require__(8256);class WorkspaceSearch{constructor(workspace){this.workspace_=workspace,this.id="workspaceSearch",this.htmlDiv_=null,this.actionDiv_=null,this.inputElement_=null,this.textInputPlaceholder_="Search",this.blocks_=[],this.currentBlockIndex_=-1,this.searchText_="",this.searchOnInput=!0,this.caseSensitive=!1,this.preserveSelected=!0,this.boundEvents_=[]}init(){this.workspace_.getComponentManager().addComponent({component:this,weight:0,capabilities:[core_browser.ComponentManager.Capability.POSITIONABLE]}),injectSearchCss(),this.createDom_(),this.setVisible_(!1),this.workspace_.resize()}dispose(){for(const event of this.boundEvents_)core_browser.unbindEvent_(event);this.boundEvents_=null,this.htmlDiv_&&(this.htmlDiv_.remove(),this.htmlDiv_=null),this.actionDiv_=null,this.inputElement_=null}createDom_(){const injectionDiv=this.workspace_.getInjectionDiv();this.addEvent_(injectionDiv,"keydown",this,(evt=>this.onWorkspaceKeyDown_(evt))),this.htmlDiv_=document.createElement("div"),core_browser.utils.dom.addClass(this.htmlDiv_,"blockly-ws-search");const searchContainer=document.createElement("div");core_browser.utils.dom.addClass(searchContainer,"blockly-ws-search-container");const searchContent=document.createElement("div");core_browser.utils.dom.addClass(searchContent,"blockly-ws-search-content"),searchContainer.appendChild(searchContent);const inputWrapper=document.createElement("div");core_browser.utils.dom.addClass(inputWrapper,"blockly-ws-search-input"),this.inputElement_=this.createTextInput_(),this.addEvent_(this.inputElement_,"keydown",this,(evt=>this.onKeyDown_(evt))),this.addEvent_(this.inputElement_,"input",this,(()=>this.onInput_())),this.addEvent_(this.inputElement_,"click",this,(()=>this.searchAndHighlight(this.searchText_,this.preserveSelected))),inputWrapper.appendChild(this.inputElement_),searchContent.appendChild(inputWrapper),this.actionDiv_=document.createElement("div"),core_browser.utils.dom.addClass(this.actionDiv_,"blockly-ws-search-actions"),searchContent.appendChild(this.actionDiv_);const nextBtn=this.createNextBtn_();nextBtn&&this.addActionBtn(nextBtn,(()=>this.next()));const previousBtn=this.createPreviousBtn_();previousBtn&&this.addActionBtn(previousBtn,(()=>this.previous()));const closeBtn=this.createCloseBtn_();closeBtn&&(this.addBtnListener_(closeBtn,(()=>this.close())),searchContainer.appendChild(closeBtn)),this.htmlDiv_.appendChild(searchContainer),injectionDiv.insertBefore(this.htmlDiv_,this.workspace_.getParentSvg())}addEvent_(node,name,thisObject,func){const event=core_browser.browserEvents.conditionalBind(node,name,thisObject,func);this.boundEvents_.push(event)}addActionBtn(btn,onClickFn){this.addBtnListener_(btn,onClickFn),this.actionDiv_.appendChild(btn)}createTextInput_(){const textInput=document.createElement("input");return textInput.type="text",textInput.setAttribute("placeholder",this.textInputPlaceholder_),textInput}createNextBtn_(){return this.createBtn_("blockly-ws-search-next-btn","Find next")}createPreviousBtn_(){return this.createBtn_("blockly-ws-search-previous-btn","Find previous")}createCloseBtn_(){return this.createBtn_("blockly-ws-search-close-btn","Close search bar")}createBtn_(className,text){const btn=document.createElement("button");return core_browser.utils.dom.addClass(btn,className),btn.setAttribute("aria-label",text),btn}addBtnListener_(btn,onClickFn){this.addEvent_(btn,"click",this,onClickFn),this.addEvent_(btn,"keydown",this,(e=>{e.keyCode===core_browser.utils.KeyCodes.ENTER?(onClickFn(e),e.preventDefault()):e.keyCode===core_browser.utils.KeyCodes.ESC&&this.close(),e.stopPropagation()}))}getBoundingRectangle(){return null}position(metrics,savedPositions){this.workspace_.RTL?this.htmlDiv_.style.left=metrics.absoluteMetrics.left+"px":metrics.toolboxMetrics.position===core_browser.TOOLBOX_AT_RIGHT?this.htmlDiv_.style.right=metrics.toolboxMetrics.width+"px":this.htmlDiv_.style.right="0",this.htmlDiv_.style.top=metrics.absoluteMetrics.top+"px"}onInput_(){if(this.searchOnInput){const inputValue=this.inputElement_.value.trim();inputValue!==this.searchText_&&this.searchAndHighlight(inputValue,this.preserveSelected)}}onKeyDown_(e){if(e.keyCode===core_browser.utils.KeyCodes.ESC)this.close();else if(e.keyCode===core_browser.utils.KeyCodes.ENTER)if(this.searchOnInput)this.next();else{const inputValue=this.inputElement_.value.trim();inputValue!==this.searchText_&&this.searchAndHighlight(inputValue,this.preserveSelected)}}onWorkspaceKeyDown_(e){(e.ctrlKey||e.metaKey)&&e.keyCode===core_browser.utils.KeyCodes.F&&(this.open(),e.preventDefault(),e.stopPropagation())}previous(){this.setCurrentBlock_(this.currentBlockIndex_-1)}next(){this.setCurrentBlock_(this.currentBlockIndex_+1)}setSearchPlaceholder(placeholderText){this.textInputPlaceholder_=placeholderText,this.inputElement_&&this.inputElement_.setAttribute("placeholder",this.textInputPlaceholder_)}setCurrentBlock_(index){if(!this.blocks_.length)return;let currentBlock=this.blocks_[this.currentBlockIndex_];currentBlock&&this.unhighlightCurrentSelection_(currentBlock),this.currentBlockIndex_=(index%this.blocks_.length+this.blocks_.length)%this.blocks_.length,currentBlock=this.blocks_[this.currentBlockIndex_],this.highlightCurrentSelection_(currentBlock),this.scrollToVisible_(currentBlock)}open(){this.setVisible_(!0),this.inputElement_.focus(),this.searchText_&&this.searchAndHighlight(this.searchText_)}close(){this.setVisible_(!1),this.workspace_.markFocused(),this.clearBlocks()}setVisible_(show){this.htmlDiv_.style.display=show?"flex":"none"}searchAndHighlight(searchText,preserveCurrent){const oldCurrentBlock=this.blocks_[this.currentBlockIndex_];this.searchText_=searchText.trim(),this.clearBlocks(),this.blocks_=this.getMatchingBlocks_(this.workspace_,this.searchText_,this.caseSensitive),this.highlightSearchGroup_(this.blocks_);let currentIdx=0;preserveCurrent&&(currentIdx=this.blocks_.indexOf(oldCurrentBlock),currentIdx=currentIdx>-1?currentIdx:0),this.setCurrentBlock_(currentIdx)}getSearchPool_(workspace){return workspace.getAllBlocks(!0).filter((block=>{const surroundParent=block.getSurroundParent();return!surroundParent||!surroundParent.isCollapsed()}))}isBlockMatch_(block,searchText,caseSensitive){let blockText="";if(block.isCollapsed())blockText=block.toString();else{const topBlockText=[];block.inputList.forEach((input=>{input.fieldRow.forEach((field=>{topBlockText.push(field.getText())}))})),blockText=topBlockText.join(" ").trim()}return caseSensitive||(blockText=blockText.toLowerCase()),blockText.indexOf(searchText)>-1}getMatchingBlocks_(workspace,searchText,caseSensitive){if(!searchText)return[];this.caseSensitive||(searchText=searchText.toLowerCase());return this.getSearchPool_(workspace).filter((block=>this.isBlockMatch_(block,searchText,caseSensitive)))}clearBlocks(){this.unhighlightSearchGroup_(this.blocks_);const currentBlock=this.blocks_[this.currentBlockIndex_];currentBlock&&this.unhighlightCurrentSelection_(currentBlock),this.currentBlockIndex_=-1,this.blocks_=[]}highlightCurrentSelection_(currentBlock){const path=currentBlock.pathObject.svgPath;core_browser.utils.dom.addClass(path,"blockly-ws-search-current")}unhighlightCurrentSelection_(currentBlock){const path=currentBlock.pathObject.svgPath;core_browser.utils.dom.removeClass(path,"blockly-ws-search-current")}highlightSearchGroup_(blocks){blocks.forEach((block=>{const blockPath=block.pathObject.svgPath;core_browser.utils.dom.addClass(blockPath,"blockly-ws-search-highlight")}))}unhighlightSearchGroup_(blocks){blocks.forEach((block=>{const blockPath=block.pathObject.svgPath;core_browser.utils.dom.removeClass(blockPath,"blockly-ws-search-highlight")}))}scrollToVisible_(block){if(!this.workspace_.isMovable())return;const xy=block.getRelativeToSurfaceXY(),scale=this.workspace_.scale,width=block.width*scale,height=block.height*scale,top=xy.y*scale,bottom=(xy.y+block.height)*scale,left=this.workspace_.RTL?xy.x*scale-width:xy.x*scale,right=this.workspace_.RTL?xy.x*scale:xy.x*scale+width,metrics=this.workspace_.getMetrics();let targetLeft=metrics.viewLeft;const overflowLeft=left<metrics.viewLeft,overflowRight=right>metrics.viewLeft+metrics.viewWidth,wideBlock=width>metrics.viewWidth;!wideBlock&&overflowLeft||wideBlock&&!this.workspace_.RTL?targetLeft=left:(!wideBlock&&overflowRight||wideBlock&&this.workspace_.RTL)&&(targetLeft=right-metrics.viewWidth);let targetTop=metrics.viewTop;const overflowTop=top<metrics.viewTop,overflowBottom=bottom>metrics.viewTop+metrics.viewHeight,tallBlock=height>metrics.viewHeight;if(overflowTop||tallBlock&&overflowBottom?targetTop=top:overflowBottom&&(targetTop=bottom-metrics.viewHeight),targetLeft!==metrics.viewLeft||targetTop!==metrics.viewTop){const activeEl=document.activeElement;this.workspace_.scroll(-targetLeft,-targetTop),activeEl&&activeEl.focus()}}}},4097:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(1334)],void 0===(__WEBPACK_AMD_DEFINE_RESULT__="function"==typeof(__WEBPACK_AMD_DEFINE_FACTORY__=function(Blockly){return Blockly})?__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__):__WEBPACK_AMD_DEFINE_FACTORY__)||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},1334:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__,factory;factory=function(){const $={};var $jscomp=$jscomp||{};$jscomp.scope={},$jscomp.createTemplateTagFirstArg=function(a){return a.raw=a},$jscomp.createTemplateTagFirstArgWithRaw=function(a,b){return a.raw=b,a},$jscomp.arrayIteratorImpl=function(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}},$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}},$jscomp.makeIterator=function(a){var b="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator(a)},$jscomp.arrayFromIterator=function(a){for(var b,c=[];!(b=a.next()).done;)c.push(b.value);return c},$jscomp.arrayFromIterable=function(a){return a instanceof Array?a:$jscomp.arrayFromIterator($jscomp.makeIterator(a))},$jscomp.owns=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},$jscomp.ASSUME_ES5=!1,$jscomp.ASSUME_NO_NATIVE_MAP=!1,$jscomp.ASSUME_NO_NATIVE_SET=!1,$jscomp.SIMPLE_FROUND_POLYFILL=!1,$jscomp.ISOLATE_POLYFILLS=!1,$jscomp.FORCE_POLYFILL_PROMISE=!1,$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1,$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){return a==Array.prototype||a==Object.prototype||(a[b]=c.value),a},$jscomp.getGlobal=function(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof __webpack_require__.g&&__webpack_require__.g];for(var b=0;b<a.length;++b){var c=a[b];if(c&&c.Math==Math)return c}throw Error("Cannot find global object")},$jscomp.global=$jscomp.getGlobal(this),$jscomp.IS_SYMBOL_NATIVE="function"==typeof Symbol&&"symbol"==typeof Symbol("x"),$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE,$jscomp.polyfills={},$jscomp.propertyToPolyfillSymbol={},$jscomp.POLYFILL_PREFIX="$jscp$",$jscomp.polyfill=function(a,b,c,d){b&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(a,b,c,d):$jscomp.polyfillUnisolated(a,b,c,d))},$jscomp.polyfillUnisolated=function(a,b,c,d){for(c=$jscomp.global,a=a.split("."),d=0;d<a.length-1;d++){var e=a[d];if(!(e in c))return;c=c[e]}(b=b(d=c[a=a[a.length-1]]))!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})},$jscomp.polyfillIsolated=function(a,b,c,d){var e=a.split(".");a=1===e.length,d=e[0],d=!a&&d in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var f=0;f<e.length-1;f++){var g=e[f];if(!(g in d))return;d=d[g]}e=e[e.length-1],null!=(b=b(c=$jscomp.IS_SYMBOL_NATIVE&&"es6"===c?d[e]:null))&&(a?$jscomp.defineProperty($jscomp.polyfills,e,{configurable:!0,writable:!0,value:b}):b!==c&&(void 0===$jscomp.propertyToPolyfillSymbol[e]&&(c=1e9*Math.random()>>>0,$jscomp.propertyToPolyfillSymbol[e]=$jscomp.IS_SYMBOL_NATIVE?$jscomp.global.Symbol(e):$jscomp.POLYFILL_PREFIX+c+"$"+e),$jscomp.defineProperty(d,$jscomp.propertyToPolyfillSymbol[e],{configurable:!0,writable:!0,value:b})))},$jscomp.assign=$jscomp.TRUST_ES6_POLYFILLS&&"function"==typeof Object.assign?Object.assign:function(a,b){for(var c=1;c<arguments.length;c++){var d=arguments[c];if(d)for(var e in d)$jscomp.owns(d,e)&&(a[e]=d[e])}return a},$jscomp.polyfill("Object.assign",(function(a){return a||$jscomp.assign}),"es6","es3"),$jscomp.objectCreate=$jscomp.ASSUME_ES5||"function"==typeof Object.create?Object.create:function(a){var b=function(){};return b.prototype=a,new b},$jscomp.getConstructImplementation=function(){if($jscomp.TRUST_ES6_POLYFILLS&&"undefined"!=typeof Reflect&&Reflect.construct){if(function(){function c(){}return new c,Reflect.construct(c,[],(function(){})),new c instanceof c}())return Reflect.construct;var b=Reflect.construct;return function(c,d,e){return c=b(c,d),e&&Reflect.setPrototypeOf(c,e.prototype),c}}return function(c,d,e){return void 0===e&&(e=c),e=$jscomp.objectCreate(e.prototype||Object.prototype),Function.prototype.apply.call(c,e,d)||e}},$jscomp.construct=$jscomp.getConstructImplementation(),$jscomp.underscoreProtoCanBeSet=function(){var b={};try{return b.__proto__={a:!0},b.a}catch(c){}return!1},$jscomp.setPrototypeOf=$jscomp.TRUST_ES6_POLYFILLS&&"function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(a,b){if(a.__proto__=b,a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null,$jscomp.inherits=function(a,b){if(a.prototype=$jscomp.objectCreate(b.prototype),a.prototype.constructor=a,$jscomp.setPrototypeOf){var c=$jscomp.setPrototypeOf;c(a,b)}else for(c in b)if("prototype"!=c)if(Object.defineProperties){var d=Object.getOwnPropertyDescriptor(b,c);d&&Object.defineProperty(a,c,d)}else a[c]=b[c];a.superClass_=b.prototype},$jscomp.polyfill("Reflect",(function(a){return a||{}}),"es6","es3"),$jscomp.polyfill("Reflect.construct",(function(a){return $jscomp.construct}),"es6","es3"),$jscomp.polyfill("Reflect.setPrototypeOf",(function(a){if(a)return a;if($jscomp.setPrototypeOf){var b=$jscomp.setPrototypeOf;return function(c,d){try{return b(c,d),!0}catch(e){return!1}}}return null}),"es6","es5"),$jscomp.polyfill("globalThis",(function(a){return a||$jscomp.global}),"es_2020","es3"),$jscomp.checkStringArgs=function(a,b,c){if(null==a)throw new TypeError("The 'this' value for String.prototype."+c+" must not be null or undefined");if(b instanceof RegExp)throw new TypeError("First argument to String.prototype."+c+" must not be a regular expression");return a+""},$jscomp.polyfill("String.prototype.startsWith",(function(a){return a||function(b,c){var d=$jscomp.checkStringArgs(this,b,"startsWith");b+="";var e=d.length,f=b.length;c=Math.max(0,Math.min(0|c,d.length));for(var g=0;g<f&&c<e;)if(d[c++]!=b[g++])return!1;return g>=f}}),"es6","es3"),$jscomp.initSymbol=function(){},$jscomp.polyfill("Symbol",(function(a){if(a)return a;var b=function(f,g){this.$jscomp$symbol$id_=f,$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:g})};b.prototype.toString=function(){return this.$jscomp$symbol$id_};var c="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",d=0,e=function(f){if(this instanceof e)throw new TypeError("Symbol is not a constructor");return new b(c+(f||"")+"_"+d++,f)};return e}),"es6","es3"),$jscomp.polyfill("Symbol.iterator",(function(a){if(a)return a;a=Symbol("Symbol.iterator");for(var b="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),c=0;c<b.length;c++){var d=$jscomp.global[b[c]];"function"==typeof d&&"function"!=typeof d.prototype[a]&&$jscomp.defineProperty(d.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}})}return a}),"es6","es3"),$jscomp.iteratorPrototype=function(a){return(a={next:a})[Symbol.iterator]=function(){return this},a},$jscomp.iteratorFromArray=function(a,b){a instanceof String&&(a+="");var c=0,d=!1,e={next:function(){if(!d&&c<a.length){var f=c++;return{value:b(f,a[f]),done:!1}}return d=!0,{done:!0,value:void 0}}};return e[Symbol.iterator]=function(){return e},e},$jscomp.polyfill("Array.prototype.keys",(function(a){return a||function(){return $jscomp.iteratorFromArray(this,(function(b){return b}))}}),"es6","es3"),$jscomp.polyfill("Object.setPrototypeOf",(function(a){return a||$jscomp.setPrototypeOf}),"es6","es5"),$jscomp.polyfill("Array.prototype.values",(function(a){return a||function(){return $jscomp.iteratorFromArray(this,(function(b,c){return c}))}}),"es8","es3"),$jscomp.polyfill("Object.entries",(function(a){return a||function(b){var d,c=[];for(d in b)$jscomp.owns(b,d)&&c.push([d,b[d]]);return c}}),"es8","es3"),$jscomp.polyfill("Object.getOwnPropertySymbols",(function(a){return a||function(){return[]}}),"es6","es5"),$jscomp.polyfill("Reflect.ownKeys",(function(a){return a||function(b){var c=[],d=Object.getOwnPropertyNames(b);b=Object.getOwnPropertySymbols(b);for(var e=0;e<d.length;e++)("jscomp_symbol_"==d[e].substring(0,14)?b:c).push(d[e]);return c.concat(b)}}),"es6","es5"),$jscomp.polyfill("Object.getOwnPropertyDescriptors",(function(a){return a||function(b){for(var c={},d=Reflect.ownKeys(b),e=0;e<d.length;e++)c[d[e]]=Object.getOwnPropertyDescriptor(b,d[e]);return c}}),"es8","es5"),$jscomp.polyfill("Array.prototype.fill",(function(a){return a||function(b,c,d){var e=this.length||0;for(0>c&&(c=Math.max(0,e+c)),(null==d||d>e)&&(d=e),0>(d=Number(d))&&(d=Math.max(0,e+d)),c=Number(c||0);c<d;c++)this[c]=b;return this}}),"es6","es3"),$jscomp.typedArrayFill=function(a){return a||Array.prototype.fill},$jscomp.polyfill("Int8Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5"),$jscomp.polyfill("Uint8Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5"),$jscomp.polyfill("Uint8ClampedArray.prototype.fill",$jscomp.typedArrayFill,"es6","es5"),$jscomp.polyfill("Int16Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5"),$jscomp.polyfill("Uint16Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5"),$jscomp.polyfill("Int32Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5"),$jscomp.polyfill("Uint32Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5"),$jscomp.polyfill("Float32Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5"),$jscomp.polyfill("Float64Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5"),$jscomp.polyfill("Object.is",(function(a){return a||function(b,c){return b===c?0!==b||1/b==1/c:b!=b&&c!=c}}),"es6","es3"),$jscomp.polyfill("Array.prototype.includes",(function(a){return a||function(b,c){var d=this;d instanceof String&&(d=String(d));var e=d.length;for(0>(c=c||0)&&(c=Math.max(c+e,0));c<e;c++){var f=d[c];if(f===b||Object.is(f,b))return!0}return!1}}),"es7","es3"),$jscomp.polyfill("String.prototype.includes",(function(a){return a||function(b,c){return-1!==$jscomp.checkStringArgs(this,b,"includes").indexOf(b,c||0)}}),"es6","es3");var goog=goog||{};goog.global=globalThis||root,goog.define=function(a,b){return b},goog.DEBUG=!1,goog.DISALLOW_TEST_ONLY_CODE=!goog.DEBUG,goog.provide=function(a){},goog.module=function(a){},goog.module.get=function(a){},goog.module.declareLegacyNamespace=function(){},goog.setTestOnly=function(a){if(goog.DISALLOW_TEST_ONLY_CODE)throw a=a||"",Error("Importing test-only code into non-debug environment"+(a?": "+a:"."))},goog.require=function(a){},goog.requireType=function(a){};var module$contents$Blockly$utils$string_wrapLine,module$contents$Blockly$utils$string_wrapScore,module$contents$Blockly$utils$string_wrapMutate,module$contents$Blockly$utils$string_wrapToText,module$exports$Blockly$utils$deprecation={warn:function(a,b,c,d){a=a+" was deprecated on "+b+" and will be deleted on "+c+".",d&&(a+="\nUse "+d+" instead."),console.warn(a)}},module$exports$Blockly$Css={},module$contents$Blockly$Css_injected=!1;module$exports$Blockly$Css.register=function(a){if(module$contents$Blockly$Css_injected)throw Error("CSS already injected");Array.isArray(a)?((0,module$exports$Blockly$utils$deprecation.warn)("Registering CSS by passing an array of strings","September 2021","September 2022","css.register passing a multiline string"),module$exports$Blockly$Css.content+="\n"+a.join("\n")):module$exports$Blockly$Css.content+="\n"+a},module$exports$Blockly$Css.inject=function(a,b){module$contents$Blockly$Css_injected||(module$contents$Blockly$Css_injected=!0,a&&(a=b.replace(/[\\/]$/,""),b=module$exports$Blockly$Css.content.replace(/<<<PATH>>>/g,a),module$exports$Blockly$Css.content="",(a=document.createElement("style")).id="blockly-common-style",b=document.createTextNode(b),a.appendChild(b),document.head.insertBefore(a,document.head.firstChild)))},module$exports$Blockly$Css.content='\n  .blocklySvg {\n    background-color: #fff;\n    outline: none;\n    overflow: hidden;  /* IE overflows by default. */\n    position: absolute;\n    display: block;\n  }\n\n  .blocklyWidgetDiv {\n    display: none;\n    position: absolute;\n    z-index: 99999;  /* big value for bootstrap3 compatibility */\n  }\n\n  .injectionDiv {\n    height: 100%;\n    position: relative;\n    overflow: hidden;  /* So blocks in drag surface disappear at edges */\n    touch-action: none;\n  }\n\n  .blocklyNonSelectable {\n    user-select: none;\n    -ms-user-select: none;\n    -webkit-user-select: none;\n  }\n\n  .blocklyWsDragSurface {\n    display: none;\n    position: absolute;\n    top: 0;\n    left: 0;\n  }\n\n  /* Added as a separate rule with multiple classes to make it more specific\n     than a bootstrap rule that selects svg:root. See issue #1275 for context.\n  */\n  .blocklyWsDragSurface.blocklyOverflowVisible {\n    overflow: visible;\n  }\n\n  .blocklyBlockDragSurface {\n    display: none;\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    overflow: visible !important;\n    z-index: 50;  /* Display below toolbox, but above everything else. */\n  }\n\n  .blocklyBlockCanvas.blocklyCanvasTransitioning,\n  .blocklyBubbleCanvas.blocklyCanvasTransitioning {\n    transition: transform .5s;\n  }\n\n  .blocklyTooltipDiv {\n    background-color: #ffffc7;\n    border: 1px solid #ddc;\n    box-shadow: 4px 4px 20px 1px rgba(0,0,0,.15);\n    color: #000;\n    display: none;\n    font: 9pt sans-serif;\n    opacity: .9;\n    padding: 2px;\n    position: absolute;\n    z-index: 100000;  /* big value for bootstrap3 compatibility */\n  }\n\n  .blocklyDropDownDiv {\n    position: absolute;\n    left: 0;\n    top: 0;\n    z-index: 1000;\n    display: none;\n    border: 1px solid;\n    border-color: #dadce0;\n    background-color: #fff;\n    border-radius: 2px;\n    padding: 4px;\n    box-shadow: 0 0 3px 1px rgba(0,0,0,.3);\n  }\n\n  .blocklyDropDownDiv.blocklyFocused {\n    box-shadow: 0 0 6px 1px rgba(0,0,0,.3);\n  }\n\n  .blocklyDropDownContent {\n    max-height: 300px;  // @todo: spec for maximum height.\n    overflow: auto;\n    overflow-x: hidden;\n    position: relative;\n  }\n\n  .blocklyDropDownArrow {\n    position: absolute;\n    left: 0;\n    top: 0;\n    width: 16px;\n    height: 16px;\n    z-index: -1;\n    background-color: inherit;\n    border-color: inherit;\n  }\n\n  .blocklyDropDownButton {\n    display: inline-block;\n    float: left;\n    padding: 0;\n    margin: 4px;\n    border-radius: 4px;\n    outline: none;\n    border: 1px solid;\n    transition: box-shadow .1s;\n    cursor: pointer;\n  }\n\n  .blocklyArrowTop {\n    border-top: 1px solid;\n    border-left: 1px solid;\n    border-top-left-radius: 4px;\n    border-color: inherit;\n  }\n\n  .blocklyArrowBottom {\n    border-bottom: 1px solid;\n    border-right: 1px solid;\n    border-bottom-right-radius: 4px;\n    border-color: inherit;\n  }\n\n  .blocklyResizeSE {\n    cursor: se-resize;\n    fill: #aaa;\n  }\n\n  .blocklyResizeSW {\n    cursor: sw-resize;\n    fill: #aaa;\n  }\n\n  .blocklyResizeLine {\n    stroke: #515A5A;\n    stroke-width: 1;\n  }\n\n  .blocklyHighlightedConnectionPath {\n    fill: none;\n    stroke: #fc3;\n    stroke-width: 4px;\n  }\n\n  .blocklyPathLight {\n    fill: none;\n    stroke-linecap: round;\n    stroke-width: 1;\n  }\n\n  .blocklySelected>.blocklyPathLight {\n    display: none;\n  }\n\n  .blocklyDraggable {\n    /* backup for browsers (e.g. IE11) that don\'t support grab */\n    cursor: url("<<<PATH>>>/handopen.cur"), auto;\n    cursor: grab;\n    cursor: -webkit-grab;\n  }\n\n    /* backup for browsers (e.g. IE11) that don\'t support grabbing */\n  .blocklyDragging {\n    /* backup for browsers (e.g. IE11) that don\'t support grabbing */\n    cursor: url("<<<PATH>>>/handclosed.cur"), auto;\n    cursor: grabbing;\n    cursor: -webkit-grabbing;\n  }\n\n    /* Changes cursor on mouse down. Not effective in Firefox because of\n       https://bugzilla.mozilla.org/show_bug.cgi?id=771241 */\n  .blocklyDraggable:active {\n    /* backup for browsers (e.g. IE11) that don\'t support grabbing */\n    cursor: url("<<<PATH>>>/handclosed.cur"), auto;\n    cursor: grabbing;\n    cursor: -webkit-grabbing;\n  }\n\n  /* Change the cursor on the whole drag surface in case the mouse gets\n     ahead of block during a drag. This way the cursor is still a closed hand.\n    */\n  .blocklyBlockDragSurface .blocklyDraggable {\n    /* backup for browsers (e.g. IE11) that don\'t support grabbing */\n    cursor: url("<<<PATH>>>/handclosed.cur"), auto;\n    cursor: grabbing;\n    cursor: -webkit-grabbing;\n  }\n\n  .blocklyDragging.blocklyDraggingDelete {\n    cursor: url("<<<PATH>>>/handdelete.cur"), auto;\n  }\n\n  .blocklyDragging>.blocklyPath,\n  .blocklyDragging>.blocklyPathLight {\n    fill-opacity: .8;\n    stroke-opacity: .8;\n  }\n\n  .blocklyDragging>.blocklyPathDark {\n    display: none;\n  }\n\n  .blocklyDisabled>.blocklyPath {\n    fill-opacity: .5;\n    stroke-opacity: .5;\n  }\n\n  .blocklyDisabled>.blocklyPathLight,\n  .blocklyDisabled>.blocklyPathDark {\n    display: none;\n  }\n\n  .blocklyInsertionMarker>.blocklyPath,\n  .blocklyInsertionMarker>.blocklyPathLight,\n  .blocklyInsertionMarker>.blocklyPathDark {\n    fill-opacity: .2;\n    stroke: none;\n  }\n\n  .blocklyMultilineText {\n    font-family: monospace;\n  }\n\n  .blocklyNonEditableText>text {\n    pointer-events: none;\n  }\n\n  .blocklyFlyout {\n    position: absolute;\n    z-index: 20;\n  }\n\n  .blocklyText text {\n    cursor: default;\n  }\n\n  /*\n    Don\'t allow users to select text.  It gets annoying when trying to\n    drag a block and selected text moves instead.\n  */\n  .blocklySvg text,\n  .blocklyBlockDragSurface text {\n    user-select: none;\n    -ms-user-select: none;\n    -webkit-user-select: none;\n    cursor: inherit;\n  }\n\n  .blocklyHidden {\n    display: none;\n  }\n\n  .blocklyFieldDropdown:not(.blocklyHidden) {\n    display: block;\n  }\n\n  .blocklyIconGroup {\n    cursor: default;\n  }\n\n  .blocklyIconGroup:not(:hover),\n  .blocklyIconGroupReadonly {\n    opacity: .6;\n  }\n\n  .blocklyIconShape {\n    fill: #00f;\n    stroke: #fff;\n    stroke-width: 1px;\n  }\n\n  .blocklyIconSymbol {\n    fill: #fff;\n  }\n\n  .blocklyMinimalBody {\n    margin: 0;\n    padding: 0;\n  }\n\n  .blocklyHtmlInput {\n    border: none;\n    border-radius: 4px;\n    height: 100%;\n    margin: 0;\n    outline: none;\n    padding: 0;\n    width: 100%;\n    text-align: center;\n    display: block;\n    box-sizing: border-box;\n  }\n\n  /* Edge and IE introduce a close icon when the input value is longer than a\n     certain length. This affects our sizing calculations of the text input.\n     Hiding the close icon to avoid that. */\n  .blocklyHtmlInput::-ms-clear {\n    display: none;\n  }\n\n  .blocklyMainBackground {\n    stroke-width: 1;\n    stroke: #c6c6c6;  /* Equates to #ddd due to border being off-pixel. */\n  }\n\n  .blocklyMutatorBackground {\n    fill: #fff;\n    stroke: #ddd;\n    stroke-width: 1;\n  }\n\n  .blocklyFlyoutBackground {\n    fill: #ddd;\n    fill-opacity: .8;\n  }\n\n  .blocklyMainWorkspaceScrollbar {\n    z-index: 20;\n  }\n\n  .blocklyFlyoutScrollbar {\n    z-index: 30;\n  }\n\n  .blocklyScrollbarHorizontal,\n  .blocklyScrollbarVertical {\n    position: absolute;\n    outline: none;\n  }\n\n  .blocklyScrollbarBackground {\n    opacity: 0;\n  }\n\n  .blocklyScrollbarHandle {\n    fill: #ccc;\n  }\n\n  .blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,\n  .blocklyScrollbarHandle:hover {\n    fill: #bbb;\n  }\n\n  /* Darken flyout scrollbars due to being on a grey background. */\n  /* By contrast, workspace scrollbars are on a white background. */\n  .blocklyFlyout .blocklyScrollbarHandle {\n    fill: #bbb;\n  }\n\n  .blocklyFlyout .blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,\n  .blocklyFlyout .blocklyScrollbarHandle:hover {\n    fill: #aaa;\n  }\n\n  .blocklyInvalidInput {\n    background: #faa;\n  }\n\n  .blocklyVerticalMarker {\n    stroke-width: 3px;\n    fill: rgba(255,255,255,.5);\n    pointer-events: none;\n  }\n\n  .blocklyComputeCanvas {\n    position: absolute;\n    width: 0;\n    height: 0;\n  }\n\n  .blocklyNoPointerEvents {\n    pointer-events: none;\n  }\n\n  .blocklyContextMenu {\n    border-radius: 4px;\n    max-height: 100%;\n  }\n\n  .blocklyDropdownMenu {\n    border-radius: 2px;\n    padding: 0 !important;\n  }\n\n  .blocklyDropdownMenu .blocklyMenuItem {\n    /* 28px on the left for icon or checkbox. */\n    padding-left: 28px;\n  }\n\n  /* BiDi override for the resting state. */\n  .blocklyDropdownMenu .blocklyMenuItemRtl {\n    /* Flip left/right padding for BiDi. */\n    padding-left: 5px;\n    padding-right: 28px;\n  }\n\n  .blocklyWidgetDiv .blocklyMenu {\n    background: #fff;\n    border: 1px solid transparent;\n    box-shadow: 0 0 3px 1px rgba(0,0,0,.3);\n    font: normal 13px Arial, sans-serif;\n    margin: 0;\n    outline: none;\n    padding: 4px 0;\n    position: absolute;\n    overflow-y: auto;\n    overflow-x: hidden;\n    max-height: 100%;\n    z-index: 20000;  /* Arbitrary, but some apps depend on it... */\n  }\n\n  .blocklyWidgetDiv .blocklyMenu.blocklyFocused {\n    box-shadow: 0 0 6px 1px rgba(0,0,0,.3);\n  }\n\n  .blocklyDropDownDiv .blocklyMenu {\n    background: inherit;  /* Compatibility with gapi, reset from goog-menu */\n    border: inherit;  /* Compatibility with gapi, reset from goog-menu */\n    font: normal 13px "Helvetica Neue", Helvetica, sans-serif;\n    outline: none;\n    position: relative;  /* Compatibility with gapi, reset from goog-menu */\n    z-index: 20000;  /* Arbitrary, but some apps depend on it... */\n  }\n\n  /* State: resting. */\n  .blocklyMenuItem {\n    border: none;\n    color: #000;\n    cursor: pointer;\n    list-style: none;\n    margin: 0;\n    /* 7em on the right for shortcut. */\n    min-width: 7em;\n    padding: 6px 15px;\n    white-space: nowrap;\n  }\n\n  /* State: disabled. */\n  .blocklyMenuItemDisabled {\n    color: #ccc;\n    cursor: inherit;\n  }\n\n  /* State: hover. */\n  .blocklyMenuItemHighlight {\n    background-color: rgba(0,0,0,.1);\n  }\n\n  /* State: selected/checked. */\n  .blocklyMenuItemCheckbox {\n    height: 16px;\n    position: absolute;\n    width: 16px;\n  }\n\n  .blocklyMenuItemSelected .blocklyMenuItemCheckbox {\n    background: url(<<<PATH>>>/sprites.png) no-repeat -48px -16px;\n    float: left;\n    margin-left: -24px;\n    position: static;  /* Scroll with the menu. */\n  }\n\n  .blocklyMenuItemRtl .blocklyMenuItemCheckbox {\n    float: right;\n    margin-right: -24px;\n  }\n',$.module$exports$Blockly$utils$string={startsWith:function(a,b){return 0===a.lastIndexOf(b,0)},shortestStringLength:function(a){return a.length?a.reduce((function(b,c){return b.length<c.length?b:c})).length:0},commonWordPrefix:function(a,b){if(!a.length)return 0;if(1===a.length)return a[0].length;var d,c=0;for(b=b||(0,$.module$exports$Blockly$utils$string.shortestStringLength)(a),d=0;d<b;d++){for(var e=a[0][d],f=1;f<a.length;f++)if(e!==a[f][d])return c;" "===e&&(c=d+1)}for(e=1;e<a.length;e++)if((f=a[e][d])&&" "!==f)return c;return b},commonWordSuffix:function(a,b){if(!a.length)return 0;if(1===a.length)return a[0].length;var d,c=0;for(b=b||(0,$.module$exports$Blockly$utils$string.shortestStringLength)(a),d=0;d<b;d++){for(var e=a[0].substr(-d-1,1),f=1;f<a.length;f++)if(e!==a[f].substr(-d-1,1))return c;" "===e&&(c=d+1)}for(e=1;e<a.length;e++)if((f=a[e].charAt(a[e].length-d-1))&&" "!==f)return c;return b},wrap:function(a,b){a=a.split("\n");for(var c=0;c<a.length;c++)a[c]=module$contents$Blockly$utils$string_wrapLine(a[c],b);return a.join("\n")}},module$contents$Blockly$utils$string_wrapLine=function(a,b){if(a.length<=b)return a;for(var c=a.trim().split(/\s+/),d=0;d<c.length;d++)c[d].length>b&&(b=c[d].length);var e=-1/0,f=1;do{d=e;var g=a;a=[],e=c.length/f;for(var h=1,k=0;k<c.length-1;k++)h<(k+1.5)/e?(h++,a[k]=!0):a[k]=!1;a=module$contents$Blockly$utils$string_wrapMutate(c,a,b),e=module$contents$Blockly$utils$string_wrapScore(c,a,b),a=module$contents$Blockly$utils$string_wrapToText(c,a),f++}while(e>d);return g},module$contents$Blockly$utils$string_wrapScore=function(a,b,c){for(var d=[0],e=[],f=0;f<a.length;f++)d[d.length-1]+=a[f].length,!0===b[f]?(d.push(0),e.push(a[f].charAt(a[f].length-1))):!1===b[f]&&d[d.length-1]++;for(a=Math.max.apply(Math,d),f=b=0;f<d.length;f++)b-=2*Math.pow(Math.abs(c-d[f]),1.5),b-=Math.pow(a-d[f],1.5),-1!==".?!".indexOf(e[f])?b+=c/3:-1!==",;)]}".indexOf(e[f])&&(b+=c/4);return 1<d.length&&d[d.length-1]<=d[d.length-2]&&(b+=.5),b},module$contents$Blockly$utils$string_wrapMutate=function(a,b,c){for(var e,d=module$contents$Blockly$utils$string_wrapScore(a,b,c),f=0;f<b.length-1;f++)if(b[f]!==b[f+1]){var g=[].concat(b);g[f]=!g[f],g[f+1]=!g[f+1];var h=module$contents$Blockly$utils$string_wrapScore(a,g,c);h>d&&(d=h,e=g)}return e?module$contents$Blockly$utils$string_wrapMutate(a,e,c):b},module$contents$Blockly$utils$string_wrapToText=function(a,b){for(var c=[],d=0;d<a.length;d++)c.push(a[d]),void 0!==b[d]&&c.push(b[d]?"\n":" ");return c.join("")},$.module$exports$Blockly$utils$string.isNumber=function(a){return/^\s*-?\d+(\.\d+)?\s*$/.test(a)},$.module$exports$Blockly$ConnectionType={ConnectionType:{INPUT_VALUE:1,OUTPUT_VALUE:2,NEXT_STATEMENT:3,PREVIOUS_STATEMENT:4}},$.module$exports$Blockly$internalConstants={LINE_MODE_MULTIPLIER:40,PAGE_MODE_MULTIPLIER:125,DRAG_RADIUS:5,FLYOUT_DRAG_RADIUS:10,SNAP_RADIUS:28},$.module$exports$Blockly$internalConstants.CONNECTING_SNAP_RADIUS=$.module$exports$Blockly$internalConstants.SNAP_RADIUS,$.module$exports$Blockly$internalConstants.CURRENT_CONNECTION_PREFERENCE=8,$.module$exports$Blockly$internalConstants.BUMP_DELAY=250,$.module$exports$Blockly$internalConstants.BUMP_RANDOMNESS=10,$.module$exports$Blockly$internalConstants.COLLAPSE_CHARS=30,$.module$exports$Blockly$internalConstants.LONGPRESS=750,$.module$exports$Blockly$internalConstants.SOUND_LIMIT=100,$.module$exports$Blockly$internalConstants.DRAG_STACK=!0,$.module$exports$Blockly$internalConstants.SPRITE={width:96,height:124,url:"sprites.png"},$.module$exports$Blockly$internalConstants.DRAG_NONE=0,$.module$exports$Blockly$internalConstants.DRAG_STICKY=1,$.module$exports$Blockly$internalConstants.DRAG_BEGIN=1,$.module$exports$Blockly$internalConstants.DRAG_FREE=2,$.module$exports$Blockly$internalConstants.OPPOSITE_TYPE=[],$.module$exports$Blockly$internalConstants.OPPOSITE_TYPE[$.module$exports$Blockly$ConnectionType.ConnectionType.INPUT_VALUE]=$.module$exports$Blockly$ConnectionType.ConnectionType.OUTPUT_VALUE,$.module$exports$Blockly$internalConstants.OPPOSITE_TYPE[$.module$exports$Blockly$ConnectionType.ConnectionType.OUTPUT_VALUE]=$.module$exports$Blockly$ConnectionType.ConnectionType.INPUT_VALUE,$.module$exports$Blockly$internalConstants.OPPOSITE_TYPE[$.module$exports$Blockly$ConnectionType.ConnectionType.NEXT_STATEMENT]=$.module$exports$Blockly$ConnectionType.ConnectionType.PREVIOUS_STATEMENT,$.module$exports$Blockly$internalConstants.OPPOSITE_TYPE[$.module$exports$Blockly$ConnectionType.ConnectionType.PREVIOUS_STATEMENT]=$.module$exports$Blockly$ConnectionType.ConnectionType.NEXT_STATEMENT,$.module$exports$Blockly$internalConstants.RENAME_VARIABLE_ID="RENAME_VARIABLE_ID",$.module$exports$Blockly$internalConstants.DELETE_VARIABLE_ID="DELETE_VARIABLE_ID",$.module$exports$Blockly$utils$global={},$.module$exports$Blockly$utils$global.globalThis=function(){return"object"==typeof globalThis?globalThis:"object"==typeof self?self:"object"==typeof window?window:"object"==typeof __webpack_require__.g?__webpack_require__.g:this}();var module$exports$Blockly$Touch={};module$exports$Blockly$Touch.TOUCH_ENABLED="ontouchstart"in $.module$exports$Blockly$utils$global.globalThis||!!($.module$exports$Blockly$utils$global.globalThis.document&&document.documentElement&&"ontouchstart"in document.documentElement)||!(!$.module$exports$Blockly$utils$global.globalThis.navigator||!$.module$exports$Blockly$utils$global.globalThis.navigator.maxTouchPoints&&!$.module$exports$Blockly$utils$global.globalThis.navigator.msMaxTouchPoints);var module$contents$Blockly$Touch_touchIdentifier_=null;module$exports$Blockly$Touch.TOUCH_MAP={},$.module$exports$Blockly$utils$global.globalThis.PointerEvent?module$exports$Blockly$Touch.TOUCH_MAP={mousedown:["pointerdown"],mouseenter:["pointerenter"],mouseleave:["pointerleave"],mousemove:["pointermove"],mouseout:["pointerout"],mouseover:["pointerover"],mouseup:["pointerup","pointercancel"],touchend:["pointerup"],touchcancel:["pointercancel"]}:module$exports$Blockly$Touch.TOUCH_ENABLED&&(module$exports$Blockly$Touch.TOUCH_MAP={mousedown:["touchstart"],mousemove:["touchmove"],mouseup:["touchend","touchcancel"]});var module$contents$Blockly$Touch_longPid_=0;module$exports$Blockly$Touch.longStart=function(a,b){(0,module$exports$Blockly$Touch.longStop)(),a.changedTouches&&1!==a.changedTouches.length||(module$contents$Blockly$Touch_longPid_=setTimeout((function(){a.changedTouches&&(a.button=2,a.clientX=a.changedTouches[0].clientX,a.clientY=a.changedTouches[0].clientY),b&&b.handleRightClick(a)}),$.module$exports$Blockly$internalConstants.LONGPRESS))},module$exports$Blockly$Touch.longStop=function(){module$contents$Blockly$Touch_longPid_&&(clearTimeout(module$contents$Blockly$Touch_longPid_),module$contents$Blockly$Touch_longPid_=0)},module$exports$Blockly$Touch.clearTouchIdentifier=function(){module$contents$Blockly$Touch_touchIdentifier_=null},module$exports$Blockly$Touch.shouldHandleEvent=function(a){return!(0,module$exports$Blockly$Touch.isMouseOrTouchEvent)(a)||(0,module$exports$Blockly$Touch.checkTouchIdentifier)(a)},module$exports$Blockly$Touch.getTouchIdentifierFromEvent=function(a){return void 0!==a.pointerId?a.pointerId:a.changedTouches&&a.changedTouches[0]&&void 0!==a.changedTouches[0].identifier&&null!==a.changedTouches[0].identifier?a.changedTouches[0].identifier:"mouse"},module$exports$Blockly$Touch.checkTouchIdentifier=function(a){var b=(0,module$exports$Blockly$Touch.getTouchIdentifierFromEvent)(a);return null!=module$contents$Blockly$Touch_touchIdentifier_?module$contents$Blockly$Touch_touchIdentifier_===b:("mousedown"===a.type||"touchstart"===a.type||"pointerdown"===a.type)&&(module$contents$Blockly$Touch_touchIdentifier_=b,!0)},module$exports$Blockly$Touch.setClientFromTouch=function(a){if((0,$.module$exports$Blockly$utils$string.startsWith)(a.type,"touch")){var b=a.changedTouches[0];a.clientX=b.clientX,a.clientY=b.clientY}},module$exports$Blockly$Touch.isMouseOrTouchEvent=function(a){return(0,$.module$exports$Blockly$utils$string.startsWith)(a.type,"touch")||(0,$.module$exports$Blockly$utils$string.startsWith)(a.type,"mouse")||(0,$.module$exports$Blockly$utils$string.startsWith)(a.type,"pointer")},module$exports$Blockly$Touch.isTouchEvent=function(a){return(0,$.module$exports$Blockly$utils$string.startsWith)(a.type,"touch")||(0,$.module$exports$Blockly$utils$string.startsWith)(a.type,"pointer")},module$exports$Blockly$Touch.splitEventByTouches=function(a){var b=[];if(a.changedTouches)for(var c=0;c<a.changedTouches.length;c++)b[c]={type:a.type,changedTouches:[a.changedTouches[c]],target:a.target,stopPropagation:function(){a.stopPropagation()},preventDefault:function(){a.preventDefault()}};else b.push(a);return b};var module$exports$Blockly$utils$userAgent={};!function(a){function b(d){return-1!==c.indexOf(d.toUpperCase())}module$exports$Blockly$utils$userAgent.raw=a;var c=module$exports$Blockly$utils$userAgent.raw.toUpperCase();module$exports$Blockly$utils$userAgent.IE=b("Trident")||b("MSIE"),module$exports$Blockly$utils$userAgent.EDGE=b("Edge"),module$exports$Blockly$utils$userAgent.JavaFx=b("JavaFX"),module$exports$Blockly$utils$userAgent.CHROME=(b("Chrome")||b("CriOS"))&&!module$exports$Blockly$utils$userAgent.EDGE,module$exports$Blockly$utils$userAgent.WEBKIT=b("WebKit")&&!module$exports$Blockly$utils$userAgent.EDGE,module$exports$Blockly$utils$userAgent.GECKO=b("Gecko")&&!module$exports$Blockly$utils$userAgent.WEBKIT&&!module$exports$Blockly$utils$userAgent.IE&&!module$exports$Blockly$utils$userAgent.EDGE,module$exports$Blockly$utils$userAgent.ANDROID=b("Android"),a=$.module$exports$Blockly$utils$global.globalThis.navigator&&$.module$exports$Blockly$utils$global.globalThis.navigator.maxTouchPoints,module$exports$Blockly$utils$userAgent.IPAD=b("iPad")||b("Macintosh")&&0<a,module$exports$Blockly$utils$userAgent.IPOD=b("iPod"),module$exports$Blockly$utils$userAgent.IPHONE=b("iPhone")&&!module$exports$Blockly$utils$userAgent.IPAD&&!module$exports$Blockly$utils$userAgent.IPOD,module$exports$Blockly$utils$userAgent.MAC=b("Macintosh"),module$exports$Blockly$utils$userAgent.TABLET=module$exports$Blockly$utils$userAgent.IPAD||module$exports$Blockly$utils$userAgent.ANDROID&&!b("Mobile")||b("Silk"),module$exports$Blockly$utils$userAgent.MOBILE=!module$exports$Blockly$utils$userAgent.TABLET&&(module$exports$Blockly$utils$userAgent.IPOD||module$exports$Blockly$utils$userAgent.IPHONE||module$exports$Blockly$utils$userAgent.ANDROID||b("IEMobile"))}($.module$exports$Blockly$utils$global.globalThis.navigator&&$.module$exports$Blockly$utils$global.globalThis.navigator.userAgent||"");var module$contents$Blockly$common_mainWorkspace,module$exports$Blockly$browserEvents={conditionalBind:function(a,b,c,d,e,f){var g=!1,h=function(p){var q=!e;p=(0,module$exports$Blockly$Touch.splitEventByTouches)(p);for(var r=0;r<p.length;r++){var t=p[r];q&&!(0,module$exports$Blockly$Touch.shouldHandleEvent)(t)||((0,module$exports$Blockly$Touch.setClientFromTouch)(t),c?d.call(c,t):d(t),g=!0)}},k=[];if($.module$exports$Blockly$utils$global.globalThis.PointerEvent&&b in module$exports$Blockly$Touch.TOUCH_MAP)for(var l=0;l<module$exports$Blockly$Touch.TOUCH_MAP[b].length;l++){var m=module$exports$Blockly$Touch.TOUCH_MAP[b][l];a.addEventListener(m,h,!1),k.push([a,m,h])}else if(a.addEventListener(b,h,!1),k.push([a,b,h]),b in module$exports$Blockly$Touch.TOUCH_MAP)for(l=function(p){h(p),g&&!f&&p.preventDefault()},m=0;m<module$exports$Blockly$Touch.TOUCH_MAP[b].length;m++){var n=module$exports$Blockly$Touch.TOUCH_MAP[b][m];a.addEventListener(n,l,!1),k.push([a,n,l])}return k},bind:function(a,b,c,d){var e=function(l){c?d.call(c,l):d(l)},f=[];if($.module$exports$Blockly$utils$global.globalThis.PointerEvent&&b in module$exports$Blockly$Touch.TOUCH_MAP)for(var g=0;g<module$exports$Blockly$Touch.TOUCH_MAP[b].length;g++){var h=module$exports$Blockly$Touch.TOUCH_MAP[b][g];a.addEventListener(h,e,!1),f.push([a,h,e])}else if(a.addEventListener(b,e,!1),f.push([a,b,e]),b in module$exports$Blockly$Touch.TOUCH_MAP)for(g=function(l){if(l.changedTouches&&1===l.changedTouches.length){var m=l.changedTouches[0];l.clientX=m.clientX,l.clientY=m.clientY}e(l),l.preventDefault()},h=0;h<module$exports$Blockly$Touch.TOUCH_MAP[b].length;h++){var k=module$exports$Blockly$Touch.TOUCH_MAP[b][h];a.addEventListener(k,g,!1),f.push([a,k,g])}return f},unbind:function(a){for(var b;a.length;){var c=(b=a.pop())[0],d=b[1];b=b[2],c.removeEventListener(d,b,!1)}return b},isTargetInput:function(a){return"textarea"===a.target.type||"text"===a.target.type||"number"===a.target.type||"email"===a.target.type||"password"===a.target.type||"search"===a.target.type||"tel"===a.target.type||"url"===a.target.type||a.target.isContentEditable||a.target.dataset&&"true"===a.target.dataset.isTextInput},isRightButton:function(a){return!(!a.ctrlKey||!module$exports$Blockly$utils$userAgent.MAC)||2===a.button},mouseToSvg:function(a,b,c){var d=b.createSVGPoint();return d.x=a.clientX,d.y=a.clientY,c||(c=b.getScreenCTM().inverse()),d.matrixTransform(c)},getScrollDeltaPixels:function(a){switch(a.deltaMode){default:return{x:a.deltaX,y:a.deltaY};case 1:return{x:a.deltaX*$.module$exports$Blockly$internalConstants.LINE_MODE_MULTIPLIER,y:a.deltaY*$.module$exports$Blockly$internalConstants.LINE_MODE_MULTIPLIER};case 2:return{x:a.deltaX*$.module$exports$Blockly$internalConstants.PAGE_MODE_MULTIPLIER,y:a.deltaY*$.module$exports$Blockly$internalConstants.PAGE_MODE_MULTIPLIER}}}};$.module$exports$Blockly$blocks={},$.module$exports$Blockly$blocks.Blocks=Object.create(null),$.module$exports$Blockly$common={},$.module$exports$Blockly$common.getMainWorkspace=function(){return module$contents$Blockly$common_mainWorkspace},$.module$exports$Blockly$common.setMainWorkspace=function(a){module$contents$Blockly$common_mainWorkspace=a};var module$contents$Blockly$common_parentContainer,module$contents$Blockly$common_selected=null;$.module$exports$Blockly$common.getSelected=function(){return module$contents$Blockly$common_selected},$.module$exports$Blockly$common.setSelected=function(a){module$contents$Blockly$common_selected=a},$.module$exports$Blockly$common.getParentContainer=function(){return module$contents$Blockly$common_parentContainer},$.module$exports$Blockly$common.setParentContainer=function(a){module$contents$Blockly$common_parentContainer=a},$.module$exports$Blockly$common.svgResize=function(a){for(;a.options.parentWorkspace;)a=a.options.parentWorkspace;var b=a.getParentSvg(),c=a.getCachedParentSvgSize(),d=b.parentNode;if(d){var e=d.offsetWidth;d=d.offsetHeight,c.width!==e&&(b.setAttribute("width",e+"px"),a.setCachedParentSvgSize(e,null)),c.height!==d&&(b.setAttribute("height",d+"px"),a.setCachedParentSvgSize(null,d)),a.resize()}},$.module$exports$Blockly$common.draggingConnections=[],$.module$exports$Blockly$common.getBlockTypeCounts=function(a,b){var c=Object.create(null),d=a.getDescendants(!0);for(b&&(a=a.getNextBlock())&&(a=d.indexOf(a),d.splice(a,d.length-a)),a=0;b=d[a];a++)c[b.type]?c[b.type]++:c[b.type]=1;return c};var module$contents$Blockly$common_jsonInitFactory=function(a){return function(){this.jsonInit(a)}};$.module$exports$Blockly$common.defineBlocksWithJsonArray=function(a){for(var b=0;b<a.length;b++){var c=a[b];if(c){var d=c.type;d?($.module$exports$Blockly$blocks.Blocks[d]&&console.warn("Block definition #"+b+' in JSON array overwrites prior definition of "'+d+'".'),$.module$exports$Blockly$blocks.Blocks[d]={init:module$contents$Blockly$common_jsonInitFactory(c)}):console.warn("Block definition #"+b+" in JSON array is missing a type attribute. Skipping.")}else console.warn("Block definition #"+b+" in JSON array is "+c+". Skipping.")}};var module$exports$Blockly$Tooltip={},module$contents$Blockly$Tooltip_visible=!1;module$exports$Blockly$Tooltip.isVisible=function(){return module$contents$Blockly$Tooltip_visible},Object.defineProperties(module$exports$Blockly$Tooltip,{visible:{get:function(){return(0,module$exports$Blockly$utils$deprecation.warn)("Blockly.Tooltip.visible","September 2021","September 2022","Blockly.Tooltip.isVisible()"),(0,module$exports$Blockly$Tooltip.isVisible)()}}});var module$contents$Blockly$Tooltip_blocked=!1;module$exports$Blockly$Tooltip.LIMIT=50;var module$contents$Blockly$Tooltip_mouseOutPid=0,module$contents$Blockly$Tooltip_showPid=0,module$contents$Blockly$Tooltip_lastX=0,module$contents$Blockly$Tooltip_lastY=0,module$contents$Blockly$Tooltip_element=null,module$contents$Blockly$Tooltip_poisonedElement=null;module$exports$Blockly$Tooltip.OFFSET_X=0,module$exports$Blockly$Tooltip.OFFSET_Y=10,module$exports$Blockly$Tooltip.RADIUS_OK=10,module$exports$Blockly$Tooltip.HOVER_MS=750,module$exports$Blockly$Tooltip.MARGINS=5;var module$contents$Blockly$Tooltip_DIV=null;module$exports$Blockly$Tooltip.getDiv=function(){return module$contents$Blockly$Tooltip_DIV},Object.defineProperties(module$exports$Blockly$Tooltip,{DIV:{get:function(){return(0,module$exports$Blockly$utils$deprecation.warn)("Blockly.Tooltip.DIV","September 2021","September 2022","Blockly.Tooltip.getDiv()"),(0,module$exports$Blockly$Tooltip.getDiv)()}}}),module$exports$Blockly$Tooltip.getTooltipOfObject=function(a){if(a=module$contents$Blockly$Tooltip_getTargetObject(a)){for(a=a.tooltip;"function"==typeof a;)a=a();if("string"!=typeof a)throw Error("Tooltip function must return a string.");return a}return""};var module$contents$Blockly$Tooltip_getTargetObject=function(a){for(;a&&a.tooltip;){if("string"==typeof a.tooltip||"function"==typeof a.tooltip)return a;a=a.tooltip}return null};module$exports$Blockly$Tooltip.createDom=function(){module$contents$Blockly$Tooltip_DIV||((module$contents$Blockly$Tooltip_DIV=document.createElement("div")).className="blocklyTooltipDiv",((0,$.module$exports$Blockly$common.getParentContainer)()||document.body).appendChild(module$contents$Blockly$Tooltip_DIV))},module$exports$Blockly$Tooltip.bindMouseEvents=function(a){a.mouseOverWrapper_=(0,module$exports$Blockly$browserEvents.bind)(a,"mouseover",null,module$contents$Blockly$Tooltip_onMouseOver),a.mouseOutWrapper_=(0,module$exports$Blockly$browserEvents.bind)(a,"mouseout",null,module$contents$Blockly$Tooltip_onMouseOut),a.addEventListener("mousemove",module$contents$Blockly$Tooltip_onMouseMove,!1)},module$exports$Blockly$Tooltip.unbindMouseEvents=function(a){a&&((0,module$exports$Blockly$browserEvents.unbind)(a.mouseOverWrapper_),(0,module$exports$Blockly$browserEvents.unbind)(a.mouseOutWrapper_),a.removeEventListener("mousemove",module$contents$Blockly$Tooltip_onMouseMove))};var module$contents$Blockly$Tooltip_onMouseOver=function(a){module$contents$Blockly$Tooltip_blocked||(a=module$contents$Blockly$Tooltip_getTargetObject(a.currentTarget),module$contents$Blockly$Tooltip_element!==a&&((0,module$exports$Blockly$Tooltip.hide)(),module$contents$Blockly$Tooltip_poisonedElement=null,module$contents$Blockly$Tooltip_element=a),clearTimeout(module$contents$Blockly$Tooltip_mouseOutPid))},module$contents$Blockly$Tooltip_onMouseOut=function(a){module$contents$Blockly$Tooltip_blocked||(module$contents$Blockly$Tooltip_mouseOutPid=setTimeout((function(){module$contents$Blockly$Tooltip_poisonedElement=module$contents$Blockly$Tooltip_element=null,(0,module$exports$Blockly$Tooltip.hide)()}),1),clearTimeout(module$contents$Blockly$Tooltip_showPid))},module$contents$Blockly$Tooltip_onMouseMove=function(a){if(module$contents$Blockly$Tooltip_element&&module$contents$Blockly$Tooltip_element.tooltip&&!module$contents$Blockly$Tooltip_blocked)if(module$contents$Blockly$Tooltip_visible){var b=module$contents$Blockly$Tooltip_lastX-a.pageX;a=module$contents$Blockly$Tooltip_lastY-a.pageY,Math.sqrt(b*b+a*a)>module$exports$Blockly$Tooltip.RADIUS_OK&&(0,module$exports$Blockly$Tooltip.hide)()}else module$contents$Blockly$Tooltip_poisonedElement!==module$contents$Blockly$Tooltip_element&&(clearTimeout(module$contents$Blockly$Tooltip_showPid),module$contents$Blockly$Tooltip_lastX=a.pageX,module$contents$Blockly$Tooltip_lastY=a.pageY,module$contents$Blockly$Tooltip_showPid=setTimeout(module$contents$Blockly$Tooltip_show,module$exports$Blockly$Tooltip.HOVER_MS))};module$exports$Blockly$Tooltip.dispose=function(){module$contents$Blockly$Tooltip_poisonedElement=module$contents$Blockly$Tooltip_element=null,(0,module$exports$Blockly$Tooltip.hide)()},module$exports$Blockly$Tooltip.hide=function(){module$contents$Blockly$Tooltip_visible&&(module$contents$Blockly$Tooltip_visible=!1,module$contents$Blockly$Tooltip_DIV&&(module$contents$Blockly$Tooltip_DIV.style.display="none")),module$contents$Blockly$Tooltip_showPid&&clearTimeout(module$contents$Blockly$Tooltip_showPid)},module$exports$Blockly$Tooltip.block=function(){(0,module$exports$Blockly$Tooltip.hide)(),module$contents$Blockly$Tooltip_blocked=!0},module$exports$Blockly$Tooltip.unblock=function(){module$contents$Blockly$Tooltip_blocked=!1};var module$contents$Blockly$Tooltip_show=function(){if(!module$contents$Blockly$Tooltip_blocked&&(module$contents$Blockly$Tooltip_poisonedElement=module$contents$Blockly$Tooltip_element,module$contents$Blockly$Tooltip_DIV)){module$contents$Blockly$Tooltip_DIV.textContent="";var a=(0,module$exports$Blockly$Tooltip.getTooltipOfObject)(module$contents$Blockly$Tooltip_element);a=(a=(0,$.module$exports$Blockly$utils$string.wrap)(a,module$exports$Blockly$Tooltip.LIMIT)).split("\n");for(var b=0;b<a.length;b++){var c=document.createElement("div");c.appendChild(document.createTextNode(a[b])),module$contents$Blockly$Tooltip_DIV.appendChild(c)}a=module$contents$Blockly$Tooltip_element.RTL,b=document.documentElement.clientWidth,c=document.documentElement.clientHeight,module$contents$Blockly$Tooltip_DIV.style.direction=a?"rtl":"ltr",module$contents$Blockly$Tooltip_DIV.style.display="block",module$contents$Blockly$Tooltip_visible=!0;var d=module$contents$Blockly$Tooltip_lastX;d=a?d-(module$exports$Blockly$Tooltip.OFFSET_X+module$contents$Blockly$Tooltip_DIV.offsetWidth):d+module$exports$Blockly$Tooltip.OFFSET_X;var e=module$contents$Blockly$Tooltip_lastY+module$exports$Blockly$Tooltip.OFFSET_Y;e+module$contents$Blockly$Tooltip_DIV.offsetHeight>c+window.scrollY&&(e-=module$contents$Blockly$Tooltip_DIV.offsetHeight+2*module$exports$Blockly$Tooltip.OFFSET_Y),a?d=Math.max(module$exports$Blockly$Tooltip.MARGINS-window.scrollX,d):d+module$contents$Blockly$Tooltip_DIV.offsetWidth>b+window.scrollX-2*module$exports$Blockly$Tooltip.MARGINS&&(d=b-module$contents$Blockly$Tooltip_DIV.offsetWidth-2*module$exports$Blockly$Tooltip.MARGINS),module$contents$Blockly$Tooltip_DIV.style.top=e+"px",module$contents$Blockly$Tooltip_DIV.style.left=d+"px"}},module$exports$Blockly$utils$dom={SVG_NS:"http://www.w3.org/2000/svg",HTML_NS:"http://www.w3.org/1999/xhtml",XLINK_NS:"http://www.w3.org/1999/xlink",NodeType:{ELEMENT_NODE:1,TEXT_NODE:3,COMMENT_NODE:8,DOCUMENT_POSITION_CONTAINED_BY:16}},module$contents$Blockly$utils$dom_cacheWidths=null,module$contents$Blockly$utils$dom_cacheReference=0,module$contents$Blockly$utils$dom_canvasContext=null;module$exports$Blockly$utils$dom.createSvgElement=function(a,b,c){for(var d in a=document.createElementNS(module$exports$Blockly$utils$dom.SVG_NS,String(a)),b)a.setAttribute(d,b[d]);return document.body.runtimeStyle&&(a.runtimeStyle=a.currentStyle=a.style),c&&c.appendChild(a),a},module$exports$Blockly$utils$dom.addClass=function(a,b){var c=a.getAttribute("class")||"";return-1===(" "+c+" ").indexOf(" "+b+" ")&&(c&&(c+=" "),a.setAttribute("class",c+b),!0)},module$exports$Blockly$utils$dom.removeClasses=function(a,b){b=b.split(" ");for(var c=0;c<b.length;c++)(0,module$exports$Blockly$utils$dom.removeClass)(a,b[c])},module$exports$Blockly$utils$dom.removeClass=function(a,b){var c=a.getAttribute("class");if(-1===(" "+c+" ").indexOf(" "+b+" "))return!1;c=c.split(/\s+/);for(var d=0;d<c.length;d++)c[d]&&c[d]!==b||(c.splice(d,1),d--);return c.length?a.setAttribute("class",c.join(" ")):a.removeAttribute("class"),!0},module$exports$Blockly$utils$dom.hasClass=function(a,b){return-1!==(" "+a.getAttribute("class")+" ").indexOf(" "+b+" ")},module$exports$Blockly$utils$dom.removeNode=function(a){return a&&a.parentNode?a.parentNode.removeChild(a):null},module$exports$Blockly$utils$dom.insertAfter=function(a,b){var c=b.nextSibling;if(!(b=b.parentNode))throw Error("Reference node has no parent.");c?b.insertBefore(a,c):b.appendChild(a)},module$exports$Blockly$utils$dom.containsNode=function(a,b){return!!(a.compareDocumentPosition(b)&module$exports$Blockly$utils$dom.NodeType.DOCUMENT_POSITION_CONTAINED_BY)},module$exports$Blockly$utils$dom.setCssTransform=function(a,b){a.style.transform=b,a.style["-webkit-transform"]=b},module$exports$Blockly$utils$dom.startTextWidthCache=function(){module$contents$Blockly$utils$dom_cacheReference++,module$contents$Blockly$utils$dom_cacheWidths||(module$contents$Blockly$utils$dom_cacheWidths=Object.create(null))},module$exports$Blockly$utils$dom.stopTextWidthCache=function(){--module$contents$Blockly$utils$dom_cacheReference||(module$contents$Blockly$utils$dom_cacheWidths=null)},module$exports$Blockly$utils$dom.getTextWidth=function(a){var c,b=a.textContent+"\n"+a.className.baseVal;if(module$contents$Blockly$utils$dom_cacheWidths&&(c=module$contents$Blockly$utils$dom_cacheWidths[b]))return c;try{c=module$exports$Blockly$utils$userAgent.IE||module$exports$Blockly$utils$userAgent.EDGE?a.getBBox().width:a.getComputedTextLength()}catch(d){return 8*a.textContent.length}return module$contents$Blockly$utils$dom_cacheWidths&&(module$contents$Blockly$utils$dom_cacheWidths[b]=c),c},module$exports$Blockly$utils$dom.getFastTextWidth=function(a,b,c,d){return(0,module$exports$Blockly$utils$dom.getFastTextWidthWithSizeString)(a,b+"pt",c,d)},module$exports$Blockly$utils$dom.getFastTextWidthWithSizeString=function(a,b,c,d){var f,e=a.textContent;return a=e+"\n"+a.className.baseVal,module$contents$Blockly$utils$dom_cacheWidths&&(f=module$contents$Blockly$utils$dom_cacheWidths[a])||(module$contents$Blockly$utils$dom_canvasContext||((f=document.createElement("canvas")).className="blocklyComputeCanvas",document.body.appendChild(f),module$contents$Blockly$utils$dom_canvasContext=f.getContext("2d")),module$contents$Blockly$utils$dom_canvasContext.font=c+" "+b+" "+d,f=module$contents$Blockly$utils$dom_canvasContext.measureText(e).width,module$contents$Blockly$utils$dom_cacheWidths&&(module$contents$Blockly$utils$dom_cacheWidths[a]=f)),f},module$exports$Blockly$utils$dom.measureFontMetrics=function(a,b,c,d){var e=document.createElement("span");e.style.font=c+" "+b+" "+d,e.textContent=a,(a=document.createElement("div")).style.width="1px",a.style.height=0,(b=document.createElement("div")).setAttribute("style","position: fixed; top: 0; left: 0; display: flex;"),b.appendChild(e),b.appendChild(a),document.body.appendChild(b),c={height:0,baseline:0};try{b.style.alignItems="baseline",c.baseline=a.offsetTop-e.offsetTop,b.style.alignItems="flex-end",c.height=a.offsetTop-e.offsetTop}finally{document.body.removeChild(b)}return c};var module$contents$Blockly$WidgetDiv_DIV,module$exports$Blockly$WidgetDiv={},module$contents$Blockly$WidgetDiv_owner=null,module$contents$Blockly$WidgetDiv_dispose=null,module$contents$Blockly$WidgetDiv_rendererClassName="",module$contents$Blockly$WidgetDiv_themeClassName="";module$exports$Blockly$WidgetDiv.getDiv=function(){return module$contents$Blockly$WidgetDiv_DIV},module$exports$Blockly$WidgetDiv.testOnly_setDiv=function(a){module$contents$Blockly$WidgetDiv_DIV=a},Object.defineProperties(module$exports$Blockly$WidgetDiv,{DIV:{get:function(){return(0,module$exports$Blockly$utils$deprecation.warn)("Blockly.WidgetDiv.DIV","September 2021","September 2022","Blockly.WidgetDiv.getDiv()"),(0,module$exports$Blockly$WidgetDiv.getDiv)()}}}),module$exports$Blockly$WidgetDiv.createDom=function(){module$contents$Blockly$WidgetDiv_DIV||((module$contents$Blockly$WidgetDiv_DIV=document.createElement("div")).className="blocklyWidgetDiv",((0,$.module$exports$Blockly$common.getParentContainer)()||document.body).appendChild(module$contents$Blockly$WidgetDiv_DIV))},module$exports$Blockly$WidgetDiv.show=function(a,b,c){(0,module$exports$Blockly$WidgetDiv.hide)(),module$contents$Blockly$WidgetDiv_owner=a,module$contents$Blockly$WidgetDiv_dispose=c,(a=module$contents$Blockly$WidgetDiv_DIV).style.direction=b?"rtl":"ltr",a.style.display="block",b=(0,$.module$exports$Blockly$common.getMainWorkspace)(),module$contents$Blockly$WidgetDiv_rendererClassName=b.getRenderer().getClassName(),module$contents$Blockly$WidgetDiv_themeClassName=b.getTheme().getClassName(),(0,module$exports$Blockly$utils$dom.addClass)(a,module$contents$Blockly$WidgetDiv_rendererClassName),(0,module$exports$Blockly$utils$dom.addClass)(a,module$contents$Blockly$WidgetDiv_themeClassName)},module$exports$Blockly$WidgetDiv.hide=function(){if((0,module$exports$Blockly$WidgetDiv.isVisible)()){module$contents$Blockly$WidgetDiv_owner=null;var a=module$contents$Blockly$WidgetDiv_DIV;a.style.display="none",a.style.left="",a.style.top="",module$contents$Blockly$WidgetDiv_dispose&&module$contents$Blockly$WidgetDiv_dispose(),module$contents$Blockly$WidgetDiv_dispose=null,a.textContent="",module$contents$Blockly$WidgetDiv_rendererClassName&&((0,module$exports$Blockly$utils$dom.removeClass)(a,module$contents$Blockly$WidgetDiv_rendererClassName),module$contents$Blockly$WidgetDiv_rendererClassName=""),module$contents$Blockly$WidgetDiv_themeClassName&&((0,module$exports$Blockly$utils$dom.removeClass)(a,module$contents$Blockly$WidgetDiv_themeClassName),module$contents$Blockly$WidgetDiv_themeClassName=""),(0,$.module$exports$Blockly$common.getMainWorkspace)().markFocused()}},module$exports$Blockly$WidgetDiv.isVisible=function(){return!!module$contents$Blockly$WidgetDiv_owner},module$exports$Blockly$WidgetDiv.hideIfOwner=function(a){module$contents$Blockly$WidgetDiv_owner===a&&(0,module$exports$Blockly$WidgetDiv.hide)()};var module$contents$Blockly$WidgetDiv_positionInternal=function(a,b,c){module$contents$Blockly$WidgetDiv_DIV.style.left=a+"px",module$contents$Blockly$WidgetDiv_DIV.style.top=b+"px",module$contents$Blockly$WidgetDiv_DIV.style.height=c+"px"};module$exports$Blockly$WidgetDiv.positionWithAnchor=function(a,b,c,d){var e=module$contents$Blockly$WidgetDiv_calculateY(a,b,c);a=module$contents$Blockly$WidgetDiv_calculateX(a,b,c,d),0>e?module$contents$Blockly$WidgetDiv_positionInternal(a,0,c.height+e):module$contents$Blockly$WidgetDiv_positionInternal(a,e,c.height)};var module$contents$Blockly$WidgetDiv_calculateX=function(a,b,c,d){return d?Math.min(Math.max(b.right-c.width,a.left),a.right-c.width):Math.max(Math.min(b.left,a.right-c.width),a.left)},module$contents$Blockly$WidgetDiv_calculateY=function(a,b,c){return b.bottom+c.height>=a.bottom?b.top-c.height:b.bottom},module$exports$Blockly$utils$aria={Role:{GRID:"grid",GRIDCELL:"gridcell",GROUP:"group",LISTBOX:"listbox",MENU:"menu",MENUITEM:"menuitem",MENUITEMCHECKBOX:"menuitemcheckbox",OPTION:"option",PRESENTATION:"presentation",ROW:"row",TREE:"tree",TREEITEM:"treeitem"},State:{ACTIVEDESCENDANT:"activedescendant",COLCOUNT:"colcount",DISABLED:"disabled",EXPANDED:"expanded",INVALID:"invalid",LABEL:"label",LABELLEDBY:"labelledby",LEVEL:"level",ORIENTATION:"orientation",POSINSET:"posinset",ROWCOUNT:"rowcount",SELECTED:"selected",SETSIZE:"setsize",VALUEMAX:"valuemax",VALUEMIN:"valuemin"},setRole:function(a,b){a.setAttribute("role",b)},setState:function(a,b,c){Array.isArray(c)&&(c=c.join(" ")),a.setAttribute("aria-"+b,c)}},module$exports$Blockly$utils$idGenerator={TEST_ONLY:{}},module$contents$Blockly$utils$idGenerator_nextId=0;module$exports$Blockly$utils$idGenerator.getNextUniqueId=function(){return"blockly-"+(module$contents$Blockly$utils$idGenerator_nextId++).toString(36)},module$exports$Blockly$utils$idGenerator.TEST_ONLY.genUid=function(){for(var a="!#$%()*+,-./:;=?@[]^_`{|}~ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".length,b=[],c=0;20>c;c++)b[c]="!#$%()*+,-./:;=?@[]^_`{|}~ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(Math.random()*a);return b.join("")},module$exports$Blockly$utils$idGenerator.genUid=function(){return module$exports$Blockly$utils$idGenerator.TEST_ONLY.genUid()};var module$exports$Blockly$registry={},module$contents$Blockly$registry_typeMap=Object.create(null);module$exports$Blockly$registry.TEST_ONLY={typeMap:module$contents$Blockly$registry_typeMap};var module$contents$Blockly$registry_nameMap=Object.create(null);module$exports$Blockly$registry.DEFAULT="default",module$exports$Blockly$registry.Type=function(a){this.name_=a},module$exports$Blockly$registry.Type.prototype.toString=function(){return this.name_},module$exports$Blockly$registry.Type.CONNECTION_CHECKER=new module$exports$Blockly$registry.Type("connectionChecker"),module$exports$Blockly$registry.Type.CURSOR=new module$exports$Blockly$registry.Type("cursor"),module$exports$Blockly$registry.Type.EVENT=new module$exports$Blockly$registry.Type("event"),module$exports$Blockly$registry.Type.FIELD=new module$exports$Blockly$registry.Type("field"),module$exports$Blockly$registry.Type.RENDERER=new module$exports$Blockly$registry.Type("renderer"),module$exports$Blockly$registry.Type.TOOLBOX=new module$exports$Blockly$registry.Type("toolbox"),module$exports$Blockly$registry.Type.THEME=new module$exports$Blockly$registry.Type("theme"),module$exports$Blockly$registry.Type.TOOLBOX_ITEM=new module$exports$Blockly$registry.Type("toolboxItem"),module$exports$Blockly$registry.Type.FLYOUTS_VERTICAL_TOOLBOX=new module$exports$Blockly$registry.Type("flyoutsVerticalToolbox"),module$exports$Blockly$registry.Type.FLYOUTS_HORIZONTAL_TOOLBOX=new module$exports$Blockly$registry.Type("flyoutsHorizontalToolbox"),module$exports$Blockly$registry.Type.METRICS_MANAGER=new module$exports$Blockly$registry.Type("metricsManager"),module$exports$Blockly$registry.Type.BLOCK_DRAGGER=new module$exports$Blockly$registry.Type("blockDragger"),module$exports$Blockly$registry.Type.SERIALIZER=new module$exports$Blockly$registry.Type("serializer"),module$exports$Blockly$registry.register=function(a,b,c,d){if(!(a instanceof module$exports$Blockly$registry.Type)&&"string"!=typeof a||""===String(a).trim())throw Error('Invalid type "'+a+'". The type must be a non-empty string or a Blockly.registry.Type.');if(a=String(a).toLowerCase(),"string"!=typeof b||""===b.trim())throw Error('Invalid name "'+b+'". The name must be a non-empty string.');var e=b.toLowerCase();if(!c)throw Error("Can not register a null value");var f=module$contents$Blockly$registry_typeMap[a],g=module$contents$Blockly$registry_nameMap[a];if(f||(f=module$contents$Blockly$registry_typeMap[a]=Object.create(null),g=module$contents$Blockly$registry_nameMap[a]=Object.create(null)),module$contents$Blockly$registry_validate(a,c),!d&&f[e])throw Error('Name "'+e+'" with type "'+a+'" already registered.');f[e]=c,g[e]=b};var module$contents$Blockly$registry_validate=function(a,b){if(a===String(module$exports$Blockly$registry.Type.FIELD)&&"function"!=typeof b.fromJson)throw Error('Type "'+a+'" must have a fromJson function')};module$exports$Blockly$registry.unregister=function(a,b){a=String(a).toLowerCase(),b=b.toLowerCase();var c=module$contents$Blockly$registry_typeMap[a];c&&c[b]?(delete module$contents$Blockly$registry_typeMap[a][b],delete module$contents$Blockly$registry_nameMap[a][b]):console.warn("Unable to unregister ["+b+"]["+a+"] from the registry.")};var module$contents$Blockly$registry_getItem=function(a,b,c){a=String(a).toLowerCase(),b=b.toLowerCase();var d=module$contents$Blockly$registry_typeMap[a];if(!d||!d[b]){if(b="Unable to find ["+b+"]["+a+"] in the registry.",c)throw Error(b+" You must require or register a "+a+" plugin.");return console.warn(b),null}return d[b]};module$exports$Blockly$registry.hasItem=function(a,b){return a=String(a).toLowerCase(),b=b.toLowerCase(),!!(a=module$contents$Blockly$registry_typeMap[a])&&!!a[b]},module$exports$Blockly$registry.getClass=function(a,b,c){return module$contents$Blockly$registry_getItem(a,b,c)},module$exports$Blockly$registry.getObject=function(a,b,c){return module$contents$Blockly$registry_getItem(a,b,c)},module$exports$Blockly$registry.getAllItems=function(a,b,c){a=String(a).toLowerCase();var d=module$contents$Blockly$registry_typeMap[a];if(!d){if(d="Unable to find ["+a+"] in the registry.",c)throw Error(d+" You must require or register a "+a+" plugin.");return console.warn(d),null}if(!b)return d;a=module$contents$Blockly$registry_nameMap[a],c=Object.create(null),b=Object.keys(d);for(var e=0;e<b.length;e++){var f=b[e];c[a[f]]=d[f]}return c},module$exports$Blockly$registry.getClassFromOptions=function(a,b,c){return"function"==typeof(b=b.plugins[a.toString()]||module$exports$Blockly$registry.DEFAULT)?b:(0,module$exports$Blockly$registry.getClass)(a,b,c)};var module$exports$Blockly$Events$utils={},module$contents$Blockly$Events$utils_group="",module$contents$Blockly$Events$utils_recordUndo=!0;module$exports$Blockly$Events$utils.setRecordUndo=function(a){module$contents$Blockly$Events$utils_recordUndo=a},module$exports$Blockly$Events$utils.getRecordUndo=function(){return module$contents$Blockly$Events$utils_recordUndo};var module$contents$Blockly$Events$utils_disabled=0;module$exports$Blockly$Events$utils.CREATE="create",module$exports$Blockly$Events$utils.BLOCK_CREATE=module$exports$Blockly$Events$utils.CREATE,module$exports$Blockly$Events$utils.DELETE="delete",module$exports$Blockly$Events$utils.BLOCK_DELETE=module$exports$Blockly$Events$utils.DELETE,module$exports$Blockly$Events$utils.CHANGE="change",module$exports$Blockly$Events$utils.BLOCK_CHANGE=module$exports$Blockly$Events$utils.CHANGE,module$exports$Blockly$Events$utils.MOVE="move",module$exports$Blockly$Events$utils.BLOCK_MOVE=module$exports$Blockly$Events$utils.MOVE,module$exports$Blockly$Events$utils.VAR_CREATE="var_create",module$exports$Blockly$Events$utils.VAR_DELETE="var_delete",module$exports$Blockly$Events$utils.VAR_RENAME="var_rename",module$exports$Blockly$Events$utils.UI="ui",module$exports$Blockly$Events$utils.BLOCK_DRAG="drag",module$exports$Blockly$Events$utils.SELECTED="selected",module$exports$Blockly$Events$utils.CLICK="click",module$exports$Blockly$Events$utils.MARKER_MOVE="marker_move",module$exports$Blockly$Events$utils.BUBBLE_OPEN="bubble_open",module$exports$Blockly$Events$utils.TRASHCAN_OPEN="trashcan_open",module$exports$Blockly$Events$utils.TOOLBOX_ITEM_SELECT="toolbox_item_select",module$exports$Blockly$Events$utils.THEME_CHANGE="theme_change",module$exports$Blockly$Events$utils.VIEWPORT_CHANGE="viewport_change",module$exports$Blockly$Events$utils.COMMENT_CREATE="comment_create",module$exports$Blockly$Events$utils.COMMENT_DELETE="comment_delete",module$exports$Blockly$Events$utils.COMMENT_CHANGE="comment_change",module$exports$Blockly$Events$utils.COMMENT_MOVE="comment_move",module$exports$Blockly$Events$utils.FINISHED_LOADING="finished_loading",module$exports$Blockly$Events$utils.BUMP_EVENTS=[module$exports$Blockly$Events$utils.CREATE,module$exports$Blockly$Events$utils.MOVE,module$exports$Blockly$Events$utils.COMMENT_CREATE,module$exports$Blockly$Events$utils.COMMENT_MOVE];var module$contents$Blockly$Events$utils_FIRE_QUEUE=[];module$exports$Blockly$Events$utils.fire=function(a){(0,module$exports$Blockly$Events$utils.isEnabled)()&&(module$contents$Blockly$Events$utils_FIRE_QUEUE.length||setTimeout(module$contents$Blockly$Events$utils_fireNow,0),module$contents$Blockly$Events$utils_FIRE_QUEUE.push(a))};var module$contents$Blockly$Events$utils_fireNow=function(){for(var c,a=(0,module$exports$Blockly$Events$utils.filter)(module$contents$Blockly$Events$utils_FIRE_QUEUE,!0),b=module$contents$Blockly$Events$utils_FIRE_QUEUE.length=0;c=a[b];b++)if(c.workspaceId){var d=module$exports$Blockly$Workspace.Workspace.getById(c.workspaceId);d&&d.fireChangeListener(c)}};module$exports$Blockly$Events$utils.filter=function(a,b){a=a.slice(),b||a.reverse();for(var c=[],d=Object.create(null),e=0,f=void 0;f=a[e];e++)if(!f.isNull()){var g=[f.isUiEvent?module$exports$Blockly$Events$utils.UI:f.type,f.blockId,f.workspaceId].join(" "),h=d[g],k=h?h.event:null;h?f.type===module$exports$Blockly$Events$utils.MOVE&&h.index===e-1?(k.newParentId=f.newParentId,k.newInputName=f.newInputName,k.newCoordinate=f.newCoordinate,h.index=e):f.type===module$exports$Blockly$Events$utils.CHANGE&&f.element===k.element&&f.name===k.name?k.newValue=f.newValue:f.type===module$exports$Blockly$Events$utils.VIEWPORT_CHANGE?(k.viewTop=f.viewTop,k.viewLeft=f.viewLeft,k.scale=f.scale,k.oldScale=f.oldScale):f.type===module$exports$Blockly$Events$utils.CLICK&&k.type===module$exports$Blockly$Events$utils.BUBBLE_OPEN||(d[g]={event:f,index:e},c.push(f)):(d[g]={event:f,index:e},c.push(f))}for(a=c.filter((function(l){return!l.isNull()})),b||a.reverse(),b=1,c=void 0;c=a[b];b++)c.type===module$exports$Blockly$Events$utils.CHANGE&&"mutation"===c.element&&a.unshift(a.splice(b,1)[0]);return a},module$exports$Blockly$Events$utils.clearPendingUndo=function(){for(var b,a=0;b=module$contents$Blockly$Events$utils_FIRE_QUEUE[a];a++)b.recordUndo=!1},module$exports$Blockly$Events$utils.disable=function(){module$contents$Blockly$Events$utils_disabled++},module$exports$Blockly$Events$utils.enable=function(){module$contents$Blockly$Events$utils_disabled--},module$exports$Blockly$Events$utils.isEnabled=function(){return 0===module$contents$Blockly$Events$utils_disabled},module$exports$Blockly$Events$utils.getGroup=function(){return module$contents$Blockly$Events$utils_group},module$exports$Blockly$Events$utils.setGroup=function(a){module$contents$Blockly$Events$utils_group="boolean"==typeof a?a?(0,module$exports$Blockly$utils$idGenerator.genUid)():"":a},module$exports$Blockly$Events$utils.getDescendantIds=function(a){var b=[];a=a.getDescendants(!1);for(var d,c=0;d=a[c];c++)b[c]=d.id;return b},module$exports$Blockly$Events$utils.fromJson=function(a,b){var c=(0,module$exports$Blockly$Events$utils.get)(a.type);if(!c)throw Error("Unknown event type.");return(c=new c).fromJson(a),c.workspaceId=b.id,c},module$exports$Blockly$Events$utils.get=function(a){return(0,module$exports$Blockly$registry.getClass)(module$exports$Blockly$registry.Type.EVENT,a)},module$exports$Blockly$Events$utils.disableOrphans=function(a){if((a.type===module$exports$Blockly$Events$utils.MOVE||a.type===module$exports$Blockly$Events$utils.CREATE)&&a.workspaceId){var b=module$exports$Blockly$Workspace.Workspace.getById(a.workspaceId),c=b.getBlockById(a.blockId);if(c){a=module$contents$Blockly$Events$utils_recordUndo;try{module$contents$Blockly$Events$utils_recordUndo=!1;var d=c.getParent();if(d&&d.isEnabled()){var e=c.getDescendants(!1);for(b=0,d=void 0;d=e[b];b++)d.setEnabled(!0)}else if((c.outputConnection||c.previousConnection)&&!b.isDragging())do{c.setEnabled(!1),c=c.getNextBlock()}while(c)}finally{module$contents$Blockly$Events$utils_recordUndo=a}}}},module$exports$Blockly$Events$utils.TEST_ONLY={FIRE_QUEUE:module$contents$Blockly$Events$utils_FIRE_QUEUE,fireNow:module$contents$Blockly$Events$utils_fireNow};var module$exports$Blockly$utils$math={toRadians:function(a){return a*Math.PI/180},toDegrees:function(a){return 180*a/Math.PI},clamp:function(a,b,c){if(c<a){var d=c;c=a,a=d}return Math.max(a,Math.min(b,c))}},module$exports$Blockly$bumpObjects={bumpIntoBounds:function(a,b,c){var d=c.getBoundingRectangle(),e=d.right-d.left,f=(0,module$exports$Blockly$utils$math.clamp)(b.top,d.top,b.top+b.height-(d.bottom-d.top))-d.top,g=b.left;return b=b.left+b.width-e,a.RTL?g=Math.min(b,g):b=Math.max(g,b),!(!(a=(0,module$exports$Blockly$utils$math.clamp)(g,d.left,b)-d.left)&&!f||(c.moveBy(a,f),0))},bumpIntoBoundsHandler:function(a){return function(b){var c=a.getMetricsManager();if(c.hasFixedEdges()&&!a.isDragging())if(-1!==module$exports$Blockly$Events$utils.BUMP_EVENTS.indexOf(b.type)){c=c.getScrollMetrics(!0);var d=module$contents$Blockly$bumpObjects_extractObjectFromEvent(a,b);if(d){var e=(0,module$exports$Blockly$Events$utils.getGroup)();(0,module$exports$Blockly$Events$utils.setGroup)(b.group),(0,module$exports$Blockly$bumpObjects.bumpIntoBounds)(a,c,d)&&!b.group&&console.warn("Moved object in bounds but there was no event group. This may break undo."),null!==e&&(0,module$exports$Blockly$Events$utils.setGroup)(e)}}else b.type===module$exports$Blockly$Events$utils.VIEWPORT_CHANGE&&b.scale>b.oldScale&&(0,module$exports$Blockly$bumpObjects.bumpTopObjectsIntoBounds)(a)}}},module$contents$Blockly$bumpObjects_extractObjectFromEvent=function(a,b){var c=null;switch(b.type){case module$exports$Blockly$Events$utils.CREATE:case module$exports$Blockly$Events$utils.MOVE:(c=a.getBlockById(b.blockId))&&(c=c.getRootBlock());break;case module$exports$Blockly$Events$utils.COMMENT_CREATE:case module$exports$Blockly$Events$utils.COMMENT_MOVE:c=a.getCommentById(b.commentId)}return c};module$exports$Blockly$bumpObjects.bumpTopObjectsIntoBounds=function(a){var b=a.getMetricsManager();if(b.hasFixedEdges()&&!a.isDragging()){b=b.getScrollMetrics(!0);for(var e,c=a.getTopBoundedElements(),d=0;e=c[d];d++)(0,module$exports$Blockly$bumpObjects.bumpIntoBounds)(a,b,e)}};var module$exports$Blockly$utils$Coordinate={Coordinate:function(a,b){this.x=a,this.y=b}};module$exports$Blockly$utils$Coordinate.Coordinate.equals=function(a,b){return a===b||!(!a||!b)&&a.x===b.x&&a.y===b.y},module$exports$Blockly$utils$Coordinate.Coordinate.distance=function(a,b){var c=a.x-b.x;return a=a.y-b.y,Math.sqrt(c*c+a*a)},module$exports$Blockly$utils$Coordinate.Coordinate.magnitude=function(a){return Math.sqrt(a.x*a.x+a.y*a.y)},module$exports$Blockly$utils$Coordinate.Coordinate.difference=function(a,b){return new module$exports$Blockly$utils$Coordinate.Coordinate(a.x-b.x,a.y-b.y)},module$exports$Blockly$utils$Coordinate.Coordinate.sum=function(a,b){return new module$exports$Blockly$utils$Coordinate.Coordinate(a.x+b.x,a.y+b.y)},module$exports$Blockly$utils$Coordinate.Coordinate.prototype.clone=function(){return new module$exports$Blockly$utils$Coordinate.Coordinate(this.x,this.y)},module$exports$Blockly$utils$Coordinate.Coordinate.prototype.scale=function(a){return this.x*=a,this.y*=a,this},module$exports$Blockly$utils$Coordinate.Coordinate.prototype.translate=function(a,b){return this.x+=a,this.y+=b,this};var module$exports$Blockly$utils$Size={Size:function(a,b){this.width=a,this.height=b}};module$exports$Blockly$utils$Size.Size.equals=function(a,b){return a===b||!(!a||!b)&&a.width===b.width&&a.height===b.height};var module$exports$Blockly$utils$style={getSize:function(a){if("none"!==module$contents$Blockly$utils$style_getStyle(a,"display"))return module$contents$Blockly$utils$style_getSizeWithDisplay(a);var b=a.style,c=b.display,d=b.visibility,e=b.position;b.visibility="hidden",b.position="absolute",b.display="inline";var f=a.offsetWidth;return a=a.offsetHeight,b.display=c,b.position=e,b.visibility=d,new module$exports$Blockly$utils$Size.Size(f,a)}},module$contents$Blockly$utils$style_getSizeWithDisplay=function(a){return new module$exports$Blockly$utils$Size.Size(a.offsetWidth,a.offsetHeight)},module$contents$Blockly$utils$style_getStyle=function(a,b){return(0,module$exports$Blockly$utils$style.getComputedStyle)(a,b)||(0,module$exports$Blockly$utils$style.getCascadedStyle)(a,b)||a.style&&a.style[b]};module$exports$Blockly$utils$style.getComputedStyle=function(a,b){return document.defaultView&&document.defaultView.getComputedStyle&&(a=document.defaultView.getComputedStyle(a,null))&&(a[b]||a.getPropertyValue(b))||""},module$exports$Blockly$utils$style.getCascadedStyle=function(a,b){return a.currentStyle?a.currentStyle[b]:null},module$exports$Blockly$utils$style.getPageOffset=function(a){var b=new module$exports$Blockly$utils$Coordinate.Coordinate(0,0);a=a.getBoundingClientRect();var c=document.documentElement;return c=new module$exports$Blockly$utils$Coordinate.Coordinate(window.pageXOffset||c.scrollLeft,window.pageYOffset||c.scrollTop),b.x=a.left+c.x,b.y=a.top+c.y,b},module$exports$Blockly$utils$style.getViewportPageOffset=function(){var a=document.body,b=document.documentElement;return new module$exports$Blockly$utils$Coordinate.Coordinate(a.scrollLeft||b.scrollLeft,a.scrollTop||b.scrollTop)},module$exports$Blockly$utils$style.setElementShown=function(a,b){a.style.display=b?"":"none"},module$exports$Blockly$utils$style.isRightToLeft=function(a){return"rtl"===module$contents$Blockly$utils$style_getStyle(a,"direction")},module$exports$Blockly$utils$style.getBorderBox=function(a){var b=(0,module$exports$Blockly$utils$style.getComputedStyle)(a,"borderLeftWidth"),c=(0,module$exports$Blockly$utils$style.getComputedStyle)(a,"borderRightWidth"),d=(0,module$exports$Blockly$utils$style.getComputedStyle)(a,"borderTopWidth");return a=(0,module$exports$Blockly$utils$style.getComputedStyle)(a,"borderBottomWidth"),{top:parseFloat(d),right:parseFloat(c),bottom:parseFloat(a),left:parseFloat(b)}},module$exports$Blockly$utils$style.scrollIntoContainerView=function(a,b,c){a=(0,module$exports$Blockly$utils$style.getContainerOffsetToScrollInto)(a,b,c),b.scrollLeft=a.x,b.scrollTop=a.y},module$exports$Blockly$utils$style.getContainerOffsetToScrollInto=function(a,b,c){var d=(0,module$exports$Blockly$utils$style.getPageOffset)(a),e=(0,module$exports$Blockly$utils$style.getPageOffset)(b),f=(0,module$exports$Blockly$utils$style.getBorderBox)(b),g=d.x-e.x-f.left;return d=d.y-e.y-f.top,e=module$contents$Blockly$utils$style_getSizeWithDisplay(a),a=b.clientWidth-e.width,e=b.clientHeight-e.height,f=b.scrollLeft,b=b.scrollTop,c?(f+=g-a/2,b+=d-e/2):(f+=Math.min(g,Math.max(g-a,0)),b+=Math.min(d,Math.max(d-e,0))),new module$exports$Blockly$utils$Coordinate.Coordinate(f,b)};var module$exports$Blockly$utils$Rect={Rect:function(a,b,c,d){this.top=a,this.bottom=b,this.left=c,this.right=d}};module$exports$Blockly$utils$Rect.Rect.prototype.contains=function(a,b){return a>=this.left&&a<=this.right&&b>=this.top&&b<=this.bottom},module$exports$Blockly$utils$Rect.Rect.prototype.intersects=function(a){return!(this.left>a.right||this.right<a.left||this.top>a.bottom||this.bottom<a.top)};var module$exports$Blockly$utils$svgMath={},module$contents$Blockly$utils$svgMath_XY_REGEX=/translate\(\s*([-+\d.e]+)([ ,]\s*([-+\d.e]+)\s*)?/,module$contents$Blockly$utils$svgMath_XY_STYLE_REGEX=/transform:\s*translate(?:3d)?\(\s*([-+\d.e]+)\s*px([ ,]\s*([-+\d.e]+)\s*px)?/;module$exports$Blockly$utils$svgMath.getRelativeXY=function(a){var b=new module$exports$Blockly$utils$Coordinate.Coordinate(0,0),c=a.getAttribute("x");return c&&(b.x=parseInt(c,10)),(c=a.getAttribute("y"))&&(b.y=parseInt(c,10)),(c=(c=a.getAttribute("transform"))&&c.match(module$contents$Blockly$utils$svgMath_XY_REGEX))&&(b.x+=Number(c[1]),c[3]&&(b.y+=Number(c[3]))),(a=a.getAttribute("style"))&&-1<a.indexOf("translate")&&(a=a.match(module$contents$Blockly$utils$svgMath_XY_STYLE_REGEX))&&(b.x+=Number(a[1]),a[3]&&(b.y+=Number(a[3]))),b},module$exports$Blockly$utils$svgMath.getInjectionDivXY=function(a){for(var b=0,c=0;a;){var d=(0,module$exports$Blockly$utils$svgMath.getRelativeXY)(a);if(b+=d.x,c+=d.y,-1!==(" "+(a.getAttribute("class")||"")+" ").indexOf(" injectionDiv "))break;a=a.parentNode}return new module$exports$Blockly$utils$Coordinate.Coordinate(b,c)},module$exports$Blockly$utils$svgMath.is3dSupported=function(){if(void 0!==module$exports$Blockly$utils$svgMath.is3dSupported.cached_)return module$exports$Blockly$utils$svgMath.is3dSupported.cached_;if(!$.module$exports$Blockly$utils$global.globalThis.getComputedStyle)return!1;var a=document.createElement("p"),b="none",c={webkitTransform:"-webkit-transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",transform:"transform"};for(var d in document.body.insertBefore(a,null),c)if(void 0!==a.style[d]){if(a.style[d]="translate3d(1px,1px,1px)",!(b=$.module$exports$Blockly$utils$global.globalThis.getComputedStyle(a)))return document.body.removeChild(a),!1;b=b.getPropertyValue(c[d])}return document.body.removeChild(a),module$exports$Blockly$utils$svgMath.is3dSupported.cached_="none"!==b,module$exports$Blockly$utils$svgMath.is3dSupported.cached_},module$exports$Blockly$utils$svgMath.getViewportBBox=function(){var a=(0,module$exports$Blockly$utils$style.getViewportPageOffset)();return new module$exports$Blockly$utils$Rect.Rect(a.y,document.documentElement.clientHeight+a.y,a.x,document.documentElement.clientWidth+a.x)},module$exports$Blockly$utils$svgMath.getDocumentScroll=function(){var a=document.documentElement,b=window;return module$exports$Blockly$utils$userAgent.IE&&b.pageYOffset!==a.scrollTop?new module$exports$Blockly$utils$Coordinate.Coordinate(a.scrollLeft,a.scrollTop):new module$exports$Blockly$utils$Coordinate.Coordinate(b.pageXOffset||a.scrollLeft,b.pageYOffset||a.scrollTop)},module$exports$Blockly$utils$svgMath.screenToWsCoordinates=function(a,b){var c=b.x;b=b.y;var d=a.getInjectionDiv().getBoundingClientRect();return c=new module$exports$Blockly$utils$Coordinate.Coordinate(c-d.left,b-d.top),b=a.getOriginOffsetInPixels(),module$exports$Blockly$utils$Coordinate.Coordinate.difference(c,b).scale(1/a.scale)},module$exports$Blockly$utils$svgMath.svgSize=function(a){return(0,module$exports$Blockly$utils$deprecation.warn)("Blockly.svgSize","March 2021","March 2022","workspace.getCachedParentSvgSize"),new module$exports$Blockly$utils$Size.Size(a.cachedWidth_,a.cachedHeight_)},module$exports$Blockly$utils$svgMath.TEST_ONLY={XY_REGEX:module$contents$Blockly$utils$svgMath_XY_REGEX,XY_STYLE_REGEX:module$contents$Blockly$utils$svgMath_XY_STYLE_REGEX};var module$exports$Blockly$utils$Svg={Svg:function(a){this.tagName_=a}};module$exports$Blockly$utils$Svg.Svg.prototype.toString=function(){return this.tagName_},module$exports$Blockly$utils$Svg.Svg.ANIMATE=new module$exports$Blockly$utils$Svg.Svg("animate"),module$exports$Blockly$utils$Svg.Svg.CIRCLE=new module$exports$Blockly$utils$Svg.Svg("circle"),module$exports$Blockly$utils$Svg.Svg.CLIPPATH=new module$exports$Blockly$utils$Svg.Svg("clipPath"),module$exports$Blockly$utils$Svg.Svg.DEFS=new module$exports$Blockly$utils$Svg.Svg("defs"),module$exports$Blockly$utils$Svg.Svg.FECOMPOSITE=new module$exports$Blockly$utils$Svg.Svg("feComposite"),module$exports$Blockly$utils$Svg.Svg.FECOMPONENTTRANSFER=new module$exports$Blockly$utils$Svg.Svg("feComponentTransfer"),module$exports$Blockly$utils$Svg.Svg.FEFLOOD=new module$exports$Blockly$utils$Svg.Svg("feFlood"),module$exports$Blockly$utils$Svg.Svg.FEFUNCA=new module$exports$Blockly$utils$Svg.Svg("feFuncA"),module$exports$Blockly$utils$Svg.Svg.FEGAUSSIANBLUR=new module$exports$Blockly$utils$Svg.Svg("feGaussianBlur"),module$exports$Blockly$utils$Svg.Svg.FEPOINTLIGHT=new module$exports$Blockly$utils$Svg.Svg("fePointLight"),module$exports$Blockly$utils$Svg.Svg.FESPECULARLIGHTING=new module$exports$Blockly$utils$Svg.Svg("feSpecularLighting"),module$exports$Blockly$utils$Svg.Svg.FILTER=new module$exports$Blockly$utils$Svg.Svg("filter"),module$exports$Blockly$utils$Svg.Svg.FOREIGNOBJECT=new module$exports$Blockly$utils$Svg.Svg("foreignObject"),module$exports$Blockly$utils$Svg.Svg.G=new module$exports$Blockly$utils$Svg.Svg("g"),module$exports$Blockly$utils$Svg.Svg.IMAGE=new module$exports$Blockly$utils$Svg.Svg("image"),module$exports$Blockly$utils$Svg.Svg.LINE=new module$exports$Blockly$utils$Svg.Svg("line"),module$exports$Blockly$utils$Svg.Svg.PATH=new module$exports$Blockly$utils$Svg.Svg("path"),module$exports$Blockly$utils$Svg.Svg.PATTERN=new module$exports$Blockly$utils$Svg.Svg("pattern"),module$exports$Blockly$utils$Svg.Svg.POLYGON=new module$exports$Blockly$utils$Svg.Svg("polygon"),module$exports$Blockly$utils$Svg.Svg.RECT=new module$exports$Blockly$utils$Svg.Svg("rect"),module$exports$Blockly$utils$Svg.Svg.SVG=new module$exports$Blockly$utils$Svg.Svg("svg"),module$exports$Blockly$utils$Svg.Svg.TEXT=new module$exports$Blockly$utils$Svg.Svg("text"),module$exports$Blockly$utils$Svg.Svg.TSPAN=new module$exports$Blockly$utils$Svg.Svg("tspan");var module$exports$Blockly$BlockDragSurfaceSvg={BlockDragSurfaceSvg:function(a){this.container_=a,this.createDom()}};module$exports$Blockly$BlockDragSurfaceSvg.BlockDragSurfaceSvg.prototype.SVG_=null,module$exports$Blockly$BlockDragSurfaceSvg.BlockDragSurfaceSvg.prototype.dragGroup_=null,module$exports$Blockly$BlockDragSurfaceSvg.BlockDragSurfaceSvg.prototype.container_=null,module$exports$Blockly$BlockDragSurfaceSvg.BlockDragSurfaceSvg.prototype.scale_=1,module$exports$Blockly$BlockDragSurfaceSvg.BlockDragSurfaceSvg.prototype.surfaceXY_=null,module$exports$Blockly$BlockDragSurfaceSvg.BlockDragSurfaceSvg.prototype.childSurfaceXY_=new module$exports$Blockly$utils$Coordinate.Coordinate(0,0),module$exports$Blockly$BlockDragSurfaceSvg.BlockDragSurfaceSvg.prototype.createDom=function(){this.SVG_||(this.SVG_=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.SVG,{xmlns:module$exports$Blockly$utils$dom.SVG_NS,"xmlns:html":module$exports$Blockly$utils$dom.HTML_NS,"xmlns:xlink":module$exports$Blockly$utils$dom.XLINK_NS,version:"1.1",class:"blocklyBlockDragSurface"},this.container_),this.dragGroup_=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.G,{},this.SVG_))},module$exports$Blockly$BlockDragSurfaceSvg.BlockDragSurfaceSvg.prototype.setBlocksAndShow=function(a){if(this.dragGroup_.childNodes.length)throw Error("Already dragging a block.");this.dragGroup_.appendChild(a),this.SVG_.style.display="block",this.surfaceXY_=new module$exports$Blockly$utils$Coordinate.Coordinate(0,0)},module$exports$Blockly$BlockDragSurfaceSvg.BlockDragSurfaceSvg.prototype.translateAndScaleGroup=function(a,b,c){this.scale_=c,a=a.toFixed(0),b=b.toFixed(0),this.childSurfaceXY_.x=parseInt(a,10),this.childSurfaceXY_.y=parseInt(b,10),this.dragGroup_.setAttribute("transform","translate("+a+","+b+") scale("+c+")")},module$exports$Blockly$BlockDragSurfaceSvg.BlockDragSurfaceSvg.prototype.translateSurfaceInternal_=function(){var a=this.surfaceXY_.x,b=this.surfaceXY_.y;a=a.toFixed(0),b=b.toFixed(0),this.SVG_.style.display="block",(0,module$exports$Blockly$utils$dom.setCssTransform)(this.SVG_,"translate3d("+a+"px, "+b+"px, 0)")},module$exports$Blockly$BlockDragSurfaceSvg.BlockDragSurfaceSvg.prototype.translateBy=function(a,b){this.surfaceXY_=new module$exports$Blockly$utils$Coordinate.Coordinate(this.surfaceXY_.x+a,this.surfaceXY_.y+b),this.translateSurfaceInternal_()},module$exports$Blockly$BlockDragSurfaceSvg.BlockDragSurfaceSvg.prototype.translateSurface=function(a,b){this.surfaceXY_=new module$exports$Blockly$utils$Coordinate.Coordinate(a*this.scale_,b*this.scale_),this.translateSurfaceInternal_()},module$exports$Blockly$BlockDragSurfaceSvg.BlockDragSurfaceSvg.prototype.getSurfaceTranslation=function(){var a=(0,module$exports$Blockly$utils$svgMath.getRelativeXY)(this.SVG_);return new module$exports$Blockly$utils$Coordinate.Coordinate(a.x/this.scale_,a.y/this.scale_)},module$exports$Blockly$BlockDragSurfaceSvg.BlockDragSurfaceSvg.prototype.getGroup=function(){return this.dragGroup_},module$exports$Blockly$BlockDragSurfaceSvg.BlockDragSurfaceSvg.prototype.getSvgRoot=function(){return this.SVG_},module$exports$Blockly$BlockDragSurfaceSvg.BlockDragSurfaceSvg.prototype.getCurrentBlock=function(){return this.dragGroup_.firstChild},module$exports$Blockly$BlockDragSurfaceSvg.BlockDragSurfaceSvg.prototype.getWsTranslation=function(){return this.childSurfaceXY_.clone()},module$exports$Blockly$BlockDragSurfaceSvg.BlockDragSurfaceSvg.prototype.clearAndHide=function(a){if(a?a.appendChild(this.getCurrentBlock()):this.dragGroup_.removeChild(this.getCurrentBlock()),this.SVG_.style.display="none",this.dragGroup_.childNodes.length)throw Error("Drag group was not cleared.");this.surfaceXY_=null};var module$exports$Blockly$DropDownDiv={DropDownDiv:function(){}};module$exports$Blockly$DropDownDiv.DropDownDiv.ARROW_SIZE=16,module$exports$Blockly$DropDownDiv.DropDownDiv.BORDER_SIZE=1,module$exports$Blockly$DropDownDiv.DropDownDiv.ARROW_HORIZONTAL_PADDING=12,module$exports$Blockly$DropDownDiv.DropDownDiv.PADDING_Y=16,module$exports$Blockly$DropDownDiv.DropDownDiv.ANIMATION_TIME=.25,module$exports$Blockly$DropDownDiv.DropDownDiv.animateOutTimer_=null,module$exports$Blockly$DropDownDiv.DropDownDiv.onHide_=null,module$exports$Blockly$DropDownDiv.DropDownDiv.rendererClassName_="",module$exports$Blockly$DropDownDiv.DropDownDiv.themeClassName_="",module$exports$Blockly$DropDownDiv.DropDownDiv.boundsElement_=null,module$exports$Blockly$DropDownDiv.DropDownDiv.owner_=null,module$exports$Blockly$DropDownDiv.DropDownDiv.positionToField_=null,module$exports$Blockly$DropDownDiv.DropDownDiv.createDom=function(){if(!module$exports$Blockly$DropDownDiv.DropDownDiv.DIV_){var a=document.createElement("div");a.className="blocklyDropDownDiv",((0,$.module$exports$Blockly$common.getParentContainer)()||document.body).appendChild(a),module$exports$Blockly$DropDownDiv.DropDownDiv.DIV_=a,(a=document.createElement("div")).className="blocklyDropDownContent",module$exports$Blockly$DropDownDiv.DropDownDiv.DIV_.appendChild(a),module$exports$Blockly$DropDownDiv.DropDownDiv.content_=a,(a=document.createElement("div")).className="blocklyDropDownArrow",module$exports$Blockly$DropDownDiv.DropDownDiv.DIV_.appendChild(a),module$exports$Blockly$DropDownDiv.DropDownDiv.arrow_=a,module$exports$Blockly$DropDownDiv.DropDownDiv.DIV_.style.opacity=0,module$exports$Blockly$DropDownDiv.DropDownDiv.DIV_.style.transition="transform "+module$exports$Blockly$DropDownDiv.DropDownDiv.ANIMATION_TIME+"s, opacity "+module$exports$Blockly$DropDownDiv.DropDownDiv.ANIMATION_TIME+"s",module$exports$Blockly$DropDownDiv.DropDownDiv.DIV_.addEventListener("focusin",(function(){(0,module$exports$Blockly$utils$dom.addClass)(module$exports$Blockly$DropDownDiv.DropDownDiv.DIV_,"blocklyFocused")})),module$exports$Blockly$DropDownDiv.DropDownDiv.DIV_.addEventListener("focusout",(function(){(0,module$exports$Blockly$utils$dom.removeClass)(module$exports$Blockly$DropDownDiv.DropDownDiv.DIV_,"blocklyFocused")}))}},module$exports$Blockly$DropDownDiv.DropDownDiv.setBoundsElement=function(a){module$exports$Blockly$DropDownDiv.DropDownDiv.boundsElement_=a},module$exports$Blockly$DropDownDiv.DropDownDiv.getContentDiv=function(){return module$exports$Blockly$DropDownDiv.DropDownDiv.content_},module$exports$Blockly$DropDownDiv.DropDownDiv.clearContent=function(){module$exports$Blockly$DropDownDiv.DropDownDiv.content_.textContent="",module$exports$Blockly$DropDownDiv.DropDownDiv.content_.style.width=""},module$exports$Blockly$DropDownDiv.DropDownDiv.setColour=function(a,b){module$exports$Blockly$DropDownDiv.DropDownDiv.DIV_.style.backgroundColor=a,module$exports$Blockly$DropDownDiv.DropDownDiv.DIV_.style.borderColor=b},module$exports$Blockly$DropDownDiv.DropDownDiv.showPositionedByBlock=function(a,b,c,d){return module$contents$Blockly$DropDownDiv_showPositionedByRect(module$contents$Blockly$DropDownDiv_getScaledBboxOfBlock(b),a,c,d)},module$exports$Blockly$DropDownDiv.DropDownDiv.showPositionedByField=function(a,b,c){return module$exports$Blockly$DropDownDiv.DropDownDiv.positionToField_=!0,module$contents$Blockly$DropDownDiv_showPositionedByRect(module$contents$Blockly$DropDownDiv_getScaledBboxOfField(a),a,b,c)};var module$contents$Blockly$DropDownDiv_internal={},module$contents$Blockly$DropDownDiv_getScaledBboxOfBlock=function(a){var b=a.getSvgRoot(),c=b.getBBox(),d=a.workspace.scale;return a=c.height*d,c=c.width*d,b=(0,module$exports$Blockly$utils$style.getPageOffset)(b),new module$exports$Blockly$utils$Rect.Rect(b.y,b.y+a,b.x,b.x+c)},module$contents$Blockly$DropDownDiv_getScaledBboxOfField=function(a){return a=a.getScaledBBox(),new module$exports$Blockly$utils$Rect.Rect(a.top,a.bottom,a.left,a.right)},module$contents$Blockly$DropDownDiv_showPositionedByRect=function(a,b,c,d){var e=a.left+(a.right-a.left)/2,f=a.bottom;a=a.top,d&&(a+=d);for(var g=(d=b.getSourceBlock()).workspace;g.options.parentWorkspace;)g=g.options.parentWorkspace;return module$exports$Blockly$DropDownDiv.DropDownDiv.setBoundsElement(g.getParentSvg().parentNode),module$exports$Blockly$DropDownDiv.DropDownDiv.show(b,d.RTL,e,f,e,a,c)};module$exports$Blockly$DropDownDiv.DropDownDiv.show=function(a,b,c,d,e,f,g){return module$exports$Blockly$DropDownDiv.DropDownDiv.owner_=a,module$exports$Blockly$DropDownDiv.DropDownDiv.onHide_=g||null,(a=module$exports$Blockly$DropDownDiv.DropDownDiv.DIV_).style.direction=b?"rtl":"ltr",b=(0,$.module$exports$Blockly$common.getMainWorkspace)(),module$exports$Blockly$DropDownDiv.DropDownDiv.rendererClassName_=b.getRenderer().getClassName(),module$exports$Blockly$DropDownDiv.DropDownDiv.themeClassName_=b.getTheme().getClassName(),(0,module$exports$Blockly$utils$dom.addClass)(a,module$exports$Blockly$DropDownDiv.DropDownDiv.rendererClassName_),(0,module$exports$Blockly$utils$dom.addClass)(a,module$exports$Blockly$DropDownDiv.DropDownDiv.themeClassName_),module$contents$Blockly$DropDownDiv_positionInternal(c,d,e,f)},module$contents$Blockly$DropDownDiv_internal.getBoundsInfo=function(){var a=(0,module$exports$Blockly$utils$style.getPageOffset)(module$exports$Blockly$DropDownDiv.DropDownDiv.boundsElement_),b=(0,module$exports$Blockly$utils$style.getSize)(module$exports$Blockly$DropDownDiv.DropDownDiv.boundsElement_);return{left:a.x,right:a.x+b.width,top:a.y,bottom:a.y+b.height,width:b.width,height:b.height}},module$contents$Blockly$DropDownDiv_internal.getPositionMetrics=function(a,b,c,d){var e=module$contents$Blockly$DropDownDiv_internal.getBoundsInfo(),f=(0,module$exports$Blockly$utils$style.getSize)(module$exports$Blockly$DropDownDiv.DropDownDiv.DIV_);return b+f.height<e.bottom?module$contents$Blockly$DropDownDiv_getPositionBelowMetrics(a,b,e,f):d-f.height>e.top?module$contents$Blockly$DropDownDiv_getPositionAboveMetrics(c,d,e,f):b+f.height<document.documentElement.clientHeight?module$contents$Blockly$DropDownDiv_getPositionBelowMetrics(a,b,e,f):d-f.height>document.documentElement.clientTop?module$contents$Blockly$DropDownDiv_getPositionAboveMetrics(c,d,e,f):module$contents$Blockly$DropDownDiv_getPositionTopOfPageMetrics(a,e,f)};var module$contents$Blockly$DropDownDiv_getPositionBelowMetrics=function(a,b,c,d){return{initialX:(a=module$exports$Blockly$DropDownDiv.DropDownDiv.getPositionX(a,c.left,c.right,d.width)).divX,initialY:b,finalX:a.divX,finalY:b+module$exports$Blockly$DropDownDiv.DropDownDiv.PADDING_Y,arrowX:a.arrowX,arrowY:-(module$exports$Blockly$DropDownDiv.DropDownDiv.ARROW_SIZE/2+module$exports$Blockly$DropDownDiv.DropDownDiv.BORDER_SIZE),arrowAtTop:!0,arrowVisible:!0}},module$contents$Blockly$DropDownDiv_getPositionAboveMetrics=function(a,b,c,d){return{initialX:(a=module$exports$Blockly$DropDownDiv.DropDownDiv.getPositionX(a,c.left,c.right,d.width)).divX,initialY:b-d.height,finalX:a.divX,finalY:b-d.height-module$exports$Blockly$DropDownDiv.DropDownDiv.PADDING_Y,arrowX:a.arrowX,arrowY:d.height-2*module$exports$Blockly$DropDownDiv.DropDownDiv.BORDER_SIZE-module$exports$Blockly$DropDownDiv.DropDownDiv.ARROW_SIZE/2,arrowAtTop:!1,arrowVisible:!0}},module$contents$Blockly$DropDownDiv_getPositionTopOfPageMetrics=function(a,b,c){return{initialX:(a=module$exports$Blockly$DropDownDiv.DropDownDiv.getPositionX(a,b.left,b.right,c.width)).divX,initialY:0,finalX:a.divX,finalY:0,arrowAtTop:null,arrowX:null,arrowY:null,arrowVisible:!1}};module$exports$Blockly$DropDownDiv.DropDownDiv.getPositionX=function(a,b,c,d){return b=(0,module$exports$Blockly$utils$math.clamp)(b,a-d/2,c-d),a=a-module$exports$Blockly$DropDownDiv.DropDownDiv.ARROW_SIZE/2-b,c=module$exports$Blockly$DropDownDiv.DropDownDiv.ARROW_HORIZONTAL_PADDING,{arrowX:a=(0,module$exports$Blockly$utils$math.clamp)(c,a,d-c-module$exports$Blockly$DropDownDiv.DropDownDiv.ARROW_SIZE),divX:b}},module$exports$Blockly$DropDownDiv.DropDownDiv.isVisible=function(){return!!module$exports$Blockly$DropDownDiv.DropDownDiv.owner_},module$exports$Blockly$DropDownDiv.DropDownDiv.hideIfOwner=function(a,b){return module$exports$Blockly$DropDownDiv.DropDownDiv.owner_===a&&(b?module$exports$Blockly$DropDownDiv.DropDownDiv.hideWithoutAnimation():module$exports$Blockly$DropDownDiv.DropDownDiv.hide(),!0)},module$exports$Blockly$DropDownDiv.DropDownDiv.hide=function(){module$exports$Blockly$DropDownDiv.DropDownDiv.DIV_.style.transform="translate(0, 0)",module$exports$Blockly$DropDownDiv.DropDownDiv.DIV_.style.opacity=0,module$exports$Blockly$DropDownDiv.DropDownDiv.animateOutTimer_=setTimeout((function(){module$exports$Blockly$DropDownDiv.DropDownDiv.hideWithoutAnimation()}),1e3*module$exports$Blockly$DropDownDiv.DropDownDiv.ANIMATION_TIME),module$exports$Blockly$DropDownDiv.DropDownDiv.onHide_&&(module$exports$Blockly$DropDownDiv.DropDownDiv.onHide_(),module$exports$Blockly$DropDownDiv.DropDownDiv.onHide_=null)},module$exports$Blockly$DropDownDiv.DropDownDiv.hideWithoutAnimation=function(){if(module$exports$Blockly$DropDownDiv.DropDownDiv.isVisible()){module$exports$Blockly$DropDownDiv.DropDownDiv.animateOutTimer_&&clearTimeout(module$exports$Blockly$DropDownDiv.DropDownDiv.animateOutTimer_);var a=module$exports$Blockly$DropDownDiv.DropDownDiv.DIV_;a.style.transform="",a.style.left="",a.style.top="",a.style.opacity=0,a.style.display="none",a.style.backgroundColor="",a.style.borderColor="",module$exports$Blockly$DropDownDiv.DropDownDiv.onHide_&&(module$exports$Blockly$DropDownDiv.DropDownDiv.onHide_(),module$exports$Blockly$DropDownDiv.DropDownDiv.onHide_=null),module$exports$Blockly$DropDownDiv.DropDownDiv.clearContent(),module$exports$Blockly$DropDownDiv.DropDownDiv.owner_=null,module$exports$Blockly$DropDownDiv.DropDownDiv.rendererClassName_&&((0,module$exports$Blockly$utils$dom.removeClass)(a,module$exports$Blockly$DropDownDiv.DropDownDiv.rendererClassName_),module$exports$Blockly$DropDownDiv.DropDownDiv.rendererClassName_=""),module$exports$Blockly$DropDownDiv.DropDownDiv.themeClassName_&&((0,module$exports$Blockly$utils$dom.removeClass)(a,module$exports$Blockly$DropDownDiv.DropDownDiv.themeClassName_),module$exports$Blockly$DropDownDiv.DropDownDiv.themeClassName_=""),(0,$.module$exports$Blockly$common.getMainWorkspace)().markFocused()}};var module$contents$Blockly$DropDownDiv_positionInternal=function(a,b,c,d){(a=module$contents$Blockly$DropDownDiv_internal.getPositionMetrics(a,b,c,d)).arrowVisible?(module$exports$Blockly$DropDownDiv.DropDownDiv.arrow_.style.display="",module$exports$Blockly$DropDownDiv.DropDownDiv.arrow_.style.transform="translate("+a.arrowX+"px,"+a.arrowY+"px) rotate(45deg)",module$exports$Blockly$DropDownDiv.DropDownDiv.arrow_.setAttribute("class",a.arrowAtTop?"blocklyDropDownArrow blocklyArrowTop":"blocklyDropDownArrow blocklyArrowBottom")):module$exports$Blockly$DropDownDiv.DropDownDiv.arrow_.style.display="none",b=Math.floor(a.initialX),c=Math.floor(a.initialY),d=Math.floor(a.finalX);var e=Math.floor(a.finalY),f=module$exports$Blockly$DropDownDiv.DropDownDiv.DIV_;return f.style.left=b+"px",f.style.top=c+"px",f.style.display="block",f.style.opacity=1,f.style.transform="translate("+(d-b)+"px,"+(e-c)+"px)",!!a.arrowAtTop};module$exports$Blockly$DropDownDiv.DropDownDiv.repositionForWindowResize=function(){if(module$exports$Blockly$DropDownDiv.DropDownDiv.owner_){var a=module$exports$Blockly$DropDownDiv.DropDownDiv.owner_,b=a.getSourceBlock();b=(a=module$exports$Blockly$DropDownDiv.DropDownDiv.positionToField_?module$contents$Blockly$DropDownDiv_getScaledBboxOfField(a):module$contents$Blockly$DropDownDiv_getScaledBboxOfBlock(b)).left+(a.right-a.left)/2,module$contents$Blockly$DropDownDiv_positionInternal(b,a.bottom,b,a.top)}else module$exports$Blockly$DropDownDiv.DropDownDiv.hide()},module$exports$Blockly$DropDownDiv.DropDownDiv.TEST_ONLY=module$contents$Blockly$DropDownDiv_internal;var module$contents$Blockly$utils$xml_xmlDocument,module$contents$Blockly$Xml_fieldToDom,module$contents$Blockly$Xml_allFieldsToDom,module$exports$Blockly$Grid={Grid:function(a,b){this.gridPattern_=a,this.spacing_=b.spacing,this.length_=b.length,this.line2_=(this.line1_=a.firstChild)&&this.line1_.nextSibling,this.snapToGrid_=b.snap}};module$exports$Blockly$Grid.Grid.prototype.scale_=1,module$exports$Blockly$Grid.Grid.prototype.dispose=function(){this.gridPattern_=null},module$exports$Blockly$Grid.Grid.prototype.shouldSnap=function(){return this.snapToGrid_},module$exports$Blockly$Grid.Grid.prototype.getSpacing=function(){return this.spacing_},module$exports$Blockly$Grid.Grid.prototype.getPatternId=function(){return this.gridPattern_.id},module$exports$Blockly$Grid.Grid.prototype.update=function(a){this.scale_=a;var b=this.spacing_*a||100;this.gridPattern_.setAttribute("width",b),this.gridPattern_.setAttribute("height",b);var c=(b=Math.floor(this.spacing_/2)+.5)-this.length_/2,d=b+this.length_/2;b*=a,c*=a,d*=a,this.setLineAttributes_(this.line1_,a,c,d,b,b),this.setLineAttributes_(this.line2_,a,b,b,c,d)},module$exports$Blockly$Grid.Grid.prototype.setLineAttributes_=function(a,b,c,d,e,f){a&&(a.setAttribute("stroke-width",b),a.setAttribute("x1",c),a.setAttribute("y1",e),a.setAttribute("x2",d),a.setAttribute("y2",f))},module$exports$Blockly$Grid.Grid.prototype.moveTo=function(a,b){this.gridPattern_.setAttribute("x",a),this.gridPattern_.setAttribute("y",b),(module$exports$Blockly$utils$userAgent.IE||module$exports$Blockly$utils$userAgent.EDGE)&&this.update(this.scale_)},module$exports$Blockly$Grid.Grid.createDom=function(a,b,c){return a=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.PATTERN,{id:"blocklyGridPattern"+a,patternUnits:"userSpaceOnUse"},c),0<b.length&&0<b.spacing?((0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.LINE,{stroke:b.colour},a),1<b.length&&(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.LINE,{stroke:b.colour},a)):(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.LINE,{},a),a},$.module$exports$Blockly$Msg={},$.module$exports$Blockly$Msg.Msg=Object.create(null),$.module$exports$Blockly$utils$xml={NAME_SPACE:"https://developers.google.com/blockly/xml"},module$contents$Blockly$utils$xml_xmlDocument=$.module$exports$Blockly$utils$global.globalThis.document,$.module$exports$Blockly$utils$xml.getDocument=function(){return module$contents$Blockly$utils$xml_xmlDocument},$.module$exports$Blockly$utils$xml.setDocument=function(a){module$contents$Blockly$utils$xml_xmlDocument=a},$.module$exports$Blockly$utils$xml.createElement=function(a){return module$contents$Blockly$utils$xml_xmlDocument.createElementNS($.module$exports$Blockly$utils$xml.NAME_SPACE,a)},$.module$exports$Blockly$utils$xml.createTextNode=function(a){return module$contents$Blockly$utils$xml_xmlDocument.createTextNode(a)},$.module$exports$Blockly$utils$xml.textToDomDocument=function(a){return(new DOMParser).parseFromString(a,"text/xml")},$.module$exports$Blockly$utils$xml.domToText=function(a){return(new XMLSerializer).serializeToString(a)},$.module$exports$Blockly$inputTypes={},$.module$exports$Blockly$inputTypes.inputTypes={VALUE:$.module$exports$Blockly$ConnectionType.ConnectionType.INPUT_VALUE,STATEMENT:$.module$exports$Blockly$ConnectionType.ConnectionType.NEXT_STATEMENT,DUMMY:5},$.module$exports$Blockly$Xml={workspaceToDom:function(a,b){var c=(0,$.module$exports$Blockly$utils$xml.createElement)("xml"),d=(0,$.module$exports$Blockly$Xml.variablesToDom)($.module$exports$Blockly$Variables.allUsedVarModels(a));d.hasChildNodes()&&c.appendChild(d),d=a.getTopComments(!0);for(var e=0;e<d.length;e++)c.appendChild(d[e].toXmlWithXY(b));for(a=a.getTopBlocks(!0),d=0;d<a.length;d++)c.appendChild((0,$.module$exports$Blockly$Xml.blockToDomWithXY)(a[d],b));return c},variablesToDom:function(a){for(var b=(0,$.module$exports$Blockly$utils$xml.createElement)("variables"),c=0;c<a.length;c++){var d=a[c],e=(0,$.module$exports$Blockly$utils$xml.createElement)("variable");e.appendChild((0,$.module$exports$Blockly$utils$xml.createTextNode)(d.name)),d.type&&e.setAttribute("type",d.type),e.id=d.getId(),b.appendChild(e)}return b},blockToDomWithXY:function(a,b){if(a.isInsertionMarker()&&!(a=a.getChildren(!1)[0]))return new DocumentFragment;var c;a.workspace.RTL&&(c=a.workspace.getWidth()),b=(0,$.module$exports$Blockly$Xml.blockToDom)(a,b);var d=a.getRelativeToSurfaceXY();return b.setAttribute("x",Math.round(a.workspace.RTL?c-d.x:d.x)),b.setAttribute("y",Math.round(d.y)),b}},module$contents$Blockly$Xml_fieldToDom=function(a){if(a.isSerializable()){var b=(0,$.module$exports$Blockly$utils$xml.createElement)("field");return b.setAttribute("name",a.name||""),a.toXml(b)}return null},module$contents$Blockly$Xml_allFieldsToDom=function(a,b){for(var c=0;c<a.inputList.length;c++)for(var d=a.inputList[c],e=0;e<d.fieldRow.length;e++){var f=module$contents$Blockly$Xml_fieldToDom(d.fieldRow[e]);f&&b.appendChild(f)}},$.module$exports$Blockly$Xml.blockToDom=function(a,b){if(a.isInsertionMarker())return(b=a.getChildren(!1)[0])?(0,$.module$exports$Blockly$Xml.blockToDom)(b):new DocumentFragment;var c=(0,$.module$exports$Blockly$utils$xml.createElement)(a.isShadow()?"shadow":"block");if(c.setAttribute("type",a.type),b||c.setAttribute("id",a.id),a.mutationToDom){var d=a.mutationToDom();d&&(d.hasChildNodes()||d.hasAttributes())&&c.appendChild(d)}if(module$contents$Blockly$Xml_allFieldsToDom(a,c),d=a.getCommentText()){var e=a.commentModel.size,f=a.commentModel.pinned,g=(0,$.module$exports$Blockly$utils$xml.createElement)("comment");g.appendChild((0,$.module$exports$Blockly$utils$xml.createTextNode)(d)),g.setAttribute("pinned",f),g.setAttribute("h",e.height),g.setAttribute("w",e.width),c.appendChild(g)}for(a.data&&((d=(0,$.module$exports$Blockly$utils$xml.createElement)("data")).appendChild((0,$.module$exports$Blockly$utils$xml.createTextNode)(a.data)),c.appendChild(d)),d=0;d<a.inputList.length;d++)if(f=void 0,g=!0,(e=a.inputList[d]).type!==$.module$exports$Blockly$inputTypes.inputTypes.DUMMY){var h=e.connection.targetBlock();e.type===$.module$exports$Blockly$inputTypes.inputTypes.VALUE?f=(0,$.module$exports$Blockly$utils$xml.createElement)("value"):e.type===$.module$exports$Blockly$inputTypes.inputTypes.STATEMENT&&(f=(0,$.module$exports$Blockly$utils$xml.createElement)("statement"));var k=e.connection.getShadowDom();!k||h&&h.isShadow()||f.appendChild(module$contents$Blockly$Xml_cloneShadow(k,b)),h&&(h=(0,$.module$exports$Blockly$Xml.blockToDom)(h,b)).nodeType===module$exports$Blockly$utils$dom.NodeType.ELEMENT_NODE&&(f.appendChild(h),g=!1),f.setAttribute("name",e.name),g||c.appendChild(f)}if(void 0!==a.inputsInline&&a.inputsInline!==a.inputsInlineDefault&&c.setAttribute("inline",a.inputsInline),a.isCollapsed()&&c.setAttribute("collapsed",!0),a.isEnabled()||c.setAttribute("disabled",!0),a.isDeletable()||a.isShadow()||c.setAttribute("deletable",!1),a.isMovable()||a.isShadow()||c.setAttribute("movable",!1),a.isEditable()||c.setAttribute("editable",!1),(d=a.getNextBlock())&&(e=(0,$.module$exports$Blockly$Xml.blockToDom)(d,b)).nodeType===module$exports$Blockly$utils$dom.NodeType.ELEMENT_NODE){var l=(0,$.module$exports$Blockly$utils$xml.createElement)("next");l.appendChild(e),c.appendChild(l)}return!(a=a.nextConnection&&a.nextConnection.getShadowDom())||d&&d.isShadow()||l.appendChild(module$contents$Blockly$Xml_cloneShadow(a,b)),c};var module$contents$Blockly$Xml_cloneShadow=function(a,b){for(var d,c=a=a.cloneNode(!0);c;)if(b&&"shadow"===c.nodeName&&c.removeAttribute("id"),c.firstChild)c=c.firstChild;else{for(;c&&!c.nextSibling;)d=c,c=c.parentNode,d.nodeType===module$exports$Blockly$utils$dom.NodeType.TEXT_NODE&&""===d.data.trim()&&c.firstChild!==d&&(0,module$exports$Blockly$utils$dom.removeNode)(d);c&&(d=c,c=c.nextSibling,d.nodeType===module$exports$Blockly$utils$dom.NodeType.TEXT_NODE&&""===d.data.trim()&&(0,module$exports$Blockly$utils$dom.removeNode)(d))}return a};$.module$exports$Blockly$Xml.domToText=function(a){return(0,$.module$exports$Blockly$utils$xml.domToText)(a).replace(/<(\w+)([^<]*)\/>/g,"<$1$2></$1>")},$.module$exports$Blockly$Xml.domToPrettyText=function(a){a=(0,$.module$exports$Blockly$Xml.domToText)(a).split("<");for(var b="",c=1;c<a.length;c++){var d=a[c];"/"===d[0]&&(b=b.substring(2)),a[c]=b+"<"+d,"/"!==d[0]&&"/>"!==d.slice(-2)&&(b+="  ")}return(a=(a=a.join("\n")).replace(/(<(\w+)\b[^>]*>[^\n]*)\n *<\/\2>/g,"$1</$2>")).replace(/^\n/,"")},$.module$exports$Blockly$Xml.textToDom=function(a){var b=(0,$.module$exports$Blockly$utils$xml.textToDomDocument)(a);if(!b||!b.documentElement||b.getElementsByTagName("parsererror").length)throw Error("textToDom was unable to parse: "+a);return b.documentElement},$.module$exports$Blockly$Xml.clearWorkspaceAndLoadFromXml=function(a,b){return b.setResizesEnabled(!1),b.clear(),a=(0,$.module$exports$Blockly$Xml.domToWorkspace)(a,b),b.setResizesEnabled(!0),a},$.module$exports$Blockly$Xml.domToWorkspace=function(a,b){if(a instanceof module$exports$Blockly$Workspace.Workspace){var c=a;a=b,b=c,console.warn("Deprecated call to domToWorkspace, swap the arguments.")}var d;b.RTL&&(d=b.getWidth()),c=[],(0,module$exports$Blockly$utils$dom.startTextWidthCache)();var e=(0,module$exports$Blockly$Events$utils.getGroup)();e||(0,module$exports$Blockly$Events$utils.setGroup)(!0),b.setResizesEnabled&&b.setResizesEnabled(!1);var f=!0;try{for(var g=0,h=void 0;h=a.childNodes[g];g++){var k=h.nodeName.toLowerCase(),l=h;if("block"===k||"shadow"===k&&!(0,module$exports$Blockly$Events$utils.getRecordUndo)()){var m=(0,$.module$exports$Blockly$Xml.domToBlock)(l,b);c.push(m.id);var n=l.hasAttribute("x")?parseInt(l.getAttribute("x"),10):10,p=l.hasAttribute("y")?parseInt(l.getAttribute("y"),10):10;isNaN(n)||isNaN(p)||m.moveBy(b.RTL?d-n:n,p),f=!1}else{if("shadow"===k)throw TypeError("Shadow block cannot be a top-level block.");if("comment"===k)if(b.rendered){var q=module$exports$Blockly$WorkspaceCommentSvg.WorkspaceCommentSvg;q?q.fromXml(l,b,d):console.warn("Missing require for Blockly.WorkspaceCommentSvg, ignoring workspace comment.")}else{var r=module$exports$Blockly$WorkspaceComment.WorkspaceComment;r?r.fromXml(l,b):console.warn("Missing require for Blockly.WorkspaceComment, ignoring workspace comment.")}else if("variables"===k){if(!f)throw Error("'variables' tag must exist once before block and shadow tag elements in the workspace XML, but it was found in another location.");(0,$.module$exports$Blockly$Xml.domToVariables)(l,b),f=!1}}}}finally{e||(0,module$exports$Blockly$Events$utils.setGroup)(!1),(0,module$exports$Blockly$utils$dom.stopTextWidthCache)()}return b.setResizesEnabled&&b.setResizesEnabled(!0),(0,module$exports$Blockly$Events$utils.fire)(new((0,module$exports$Blockly$Events$utils.get)(module$exports$Blockly$Events$utils.FINISHED_LOADING))(b)),c},$.module$exports$Blockly$Xml.appendDomToWorkspace=function(a,b){var c;if(Object.prototype.hasOwnProperty.call(b,"scale")&&(c=b.getBlocksBoundingBox()),a=(0,$.module$exports$Blockly$Xml.domToWorkspace)(a,b),c&&c.top!==c.bottom){var d=c.bottom;c=b.RTL?c.right:c.left;for(var e=1/0,f=-1/0,g=1/0,h=0;h<a.length;h++){var k=b.getBlockById(a[h]).getRelativeToSurfaceXY();k.y<g&&(g=k.y),k.x<e&&(e=k.x),k.x>f&&(f=k.x)}for(d=d-g+10,c=b.RTL?c-f:c-e,e=0;e<a.length;e++)b.getBlockById(a[e]).moveBy(c,d)}return a},$.module$exports$Blockly$Xml.domToBlock=function(a,b){if(a instanceof module$exports$Blockly$Workspace.Workspace){var c=a;a=b,b=c,console.warn("Deprecated call to domToBlock, swap the arguments.")}(0,module$exports$Blockly$Events$utils.disable)(),c=b.getAllVariables();try{var d=module$contents$Blockly$Xml_domToBlockHeadless(a,b),e=d.getDescendants(!1);if(b.rendered){d.setConnectionTracking(!1);for(var f=e.length-1;0<=f;f--)e[f].initSvg();for(var g=e.length-1;0<=g;g--)e[g].render(!1);setTimeout((function(){d.disposed||d.setConnectionTracking(!0)}),1),d.updateDisabled(),b.resizeContents()}else for(var h=e.length-1;0<=h;h--)e[h].initModel()}finally{(0,module$exports$Blockly$Events$utils.enable)()}if((0,module$exports$Blockly$Events$utils.isEnabled)()){for(a=$.module$exports$Blockly$Variables.getAddedVariables(b,c),b=0;b<a.length;b++)e=a[b],(0,module$exports$Blockly$Events$utils.fire)(new((0,module$exports$Blockly$Events$utils.get)(module$exports$Blockly$Events$utils.VAR_CREATE))(e));(0,module$exports$Blockly$Events$utils.fire)(new((0,module$exports$Blockly$Events$utils.get)(module$exports$Blockly$Events$utils.CREATE))(d))}return d},$.module$exports$Blockly$Xml.domToVariables=function(a,b){for(var c=0;c<a.childNodes.length;c++){var d=a.childNodes[c];if(d.nodeType===module$exports$Blockly$utils$dom.NodeType.ELEMENT_NODE){var e=d.getAttribute("type"),f=d.getAttribute("id");b.createVariable(d.textContent,e,f)}}};var module$contents$Blockly$Xml_findChildBlocks=function(a){for(var b={childBlockElement:null,childShadowElement:null},c=0;c<a.childNodes.length;c++){var d=a.childNodes[c];d.nodeType===module$exports$Blockly$utils$dom.NodeType.ELEMENT_NODE&&("block"===d.nodeName.toLowerCase()?b.childBlockElement=d:"shadow"===d.nodeName.toLowerCase()&&(b.childShadowElement=d))}return b},module$contents$Blockly$Xml_domToBlockHeadless=function(a,b,c,d){var e=a.getAttribute("type");if(!e)throw TypeError("Block type unspecified: "+a.outerHTML);var f=a.getAttribute("id");f=b.newBlock(e,f);var g=function(a){for(var b={mutation:[],comment:[],data:[],field:[],input:[],next:[]},c=0;c<a.childNodes.length;c++){var d=a.childNodes[c];if(d.nodeType!==module$exports$Blockly$utils$dom.NodeType.TEXT_NODE)switch(d.nodeName.toLowerCase()){case"mutation":b.mutation.push(d);break;case"comment":if(!module$exports$Blockly$Comment){console.warn("Missing require for Comment, ignoring block comment.");break}b.comment.push(d);break;case"data":b.data.push(d);break;case"title":case"field":b.field.push(d);break;case"value":case"statement":b.input.push(d);break;case"next":b.next.push(d);break;default:console.warn("Ignoring unknown tag: "+d.nodeName)}}return b}(a),h=function(a,b){for(var c=!1,d=0;d<a.length;d++){var e=a[d];b.domToMutation&&(b.domToMutation(e),b.initSvg&&(c=!0))}return c}(g.mutation,f);if(function(a,b){for(var c=0;c<a.length;c++){var d=a[c],e=d.textContent,f="true"===d.getAttribute("pinned"),g=parseInt(d.getAttribute("w"),10);d=parseInt(d.getAttribute("h"),10),b.setCommentText(e),b.commentModel.pinned=f,isNaN(g)||isNaN(d)||(b.commentModel.size=new module$exports$Blockly$utils$Size.Size(g,d)),f&&b.getCommentIcon&&!b.isInFlyout&&setTimeout((function(){b.getCommentIcon().setVisible(!0)}),1)}}(g.comment,f),function(a,b){for(var c=0;c<a.length;c++)b.data=a[c].textContent}(g.data,f),c)if(d){if(!f.previousConnection)throw TypeError("Next block does not have previous statement.");c.connect(f.previousConnection)}else if(f.outputConnection)c.connect(f.outputConnection);else{if(!f.previousConnection)throw TypeError("Child block does not have output or previous statement.");c.connect(f.previousConnection)}if(function(a,b){for(var c=0;c<a.length;c++){var d=a[c],e=d.getAttribute("name");module$contents$Blockly$Xml_domToField(b,e,d)}}(g.field,f),function(a,b,c,d){for(var e=0;e<a.length;e++){var f=a[e],g=f.getAttribute("name"),h=c.getInput(g);if(!h){console.warn("Ignoring non-existent input "+g+" in block "+d);break}if((f=module$contents$Blockly$Xml_findChildBlocks(f)).childBlockElement){if(!h.connection)throw TypeError("Input connection does not exist.");module$contents$Blockly$Xml_domToBlockHeadless(f.childBlockElement,b,h.connection,!1)}f.childShadowElement&&h.connection.setShadowDom(f.childShadowElement)}}(g.input,b,f,e),function(a,b,c){for(var d=0;d<a.length;d++){var e=module$contents$Blockly$Xml_findChildBlocks(a[d]);if(e.childBlockElement){if(!c.nextConnection)throw TypeError("Next statement does not exist.");if(c.nextConnection.isConnected())throw TypeError("Next statement is already connected.");module$contents$Blockly$Xml_domToBlockHeadless(e.childBlockElement,b,c.nextConnection,!0)}e.childShadowElement&&c.nextConnection&&c.nextConnection.setShadowDom(e.childShadowElement)}}(g.next,b,f),h&&f.initSvg(),(b=a.getAttribute("inline"))&&f.setInputsInline("true"===b),(b=a.getAttribute("disabled"))&&f.setEnabled("true"!==b&&"disabled"!==b),(b=a.getAttribute("deletable"))&&f.setDeletable("true"===b),(b=a.getAttribute("movable"))&&f.setMovable("true"===b),(b=a.getAttribute("editable"))&&f.setEditable("true"===b),(b=a.getAttribute("collapsed"))&&f.setCollapsed("true"===b),"shadow"===a.nodeName.toLowerCase()){for(a=f.getChildren(!1),b=0;b<a.length;b++)if(!a[b].isShadow())throw TypeError("Shadow block not allowed non-shadow child.");if(f.getVarModels().length)throw TypeError("Shadow blocks cannot have variable references.");f.setShadow(!0)}return f},module$contents$Blockly$Xml_domToField=function(a,b,c){var d=a.getField(b);d?d.fromXml(c):console.warn("Ignoring non-existent field "+b+" in block "+a.type)};$.module$exports$Blockly$Xml.deleteNext=function(a){for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];if("next"===c.nodeName.toLowerCase()){a.removeChild(c);break}}};var module$exports$Blockly$utils$toolbox={Position:{TOP:0,BOTTOM:1,LEFT:2,RIGHT:3},convertToolboxDefToJson:function(a){return a?((a instanceof Element||"string"==typeof a)&&(a=(0,module$exports$Blockly$utils$toolbox.parseToolboxTree)(a),a=module$contents$Blockly$utils$toolbox_convertToToolboxJson(a)),module$contents$Blockly$utils$toolbox_validateToolbox(a),a):null}},module$contents$Blockly$utils$toolbox_validateToolbox=function(a){var b=a.kind;if(a=a.contents,b&&"flyoutToolbox"!==b&&"categoryToolbox"!==b)throw Error("Invalid toolbox kind "+b+". Please supply either flyoutToolbox or categoryToolbox");if(!a)throw Error("Toolbox must have a contents attribute.")};module$exports$Blockly$utils$toolbox.convertFlyoutDefToJsonArray=function(a){return a?a.contents?a.contents:Array.isArray(a)&&0<a.length&&!a[0].nodeType?a:module$contents$Blockly$utils$toolbox_xmlToJsonArray(a):[]},module$exports$Blockly$utils$toolbox.hasCategories=function(a){if(!a)return!1;var b=a.kind;return b?"categoryToolbox"===b:!!a.contents.filter((function(c){return"CATEGORY"===c.kind.toUpperCase()})).length},module$exports$Blockly$utils$toolbox.isCategoryCollapsible=function(a){return!(!a||!a.contents||!a.contents.filter((function(b){return"CATEGORY"===b.kind.toUpperCase()})).length)};var module$contents$Blockly$utils$toolbox_convertToToolboxJson=function(a){var b={contents:module$contents$Blockly$utils$toolbox_xmlToJsonArray(a)};return a instanceof Node&&module$contents$Blockly$utils$toolbox_addAttributes(a,b),b},module$contents$Blockly$utils$toolbox_xmlToJsonArray=function(a){var d,b=[],c=a.childNodes;for(c||(c=a),a=0;d=c[a];a++)if(d.tagName){var e={},f=d.tagName.toUpperCase();e.kind=f,"BLOCK"===f?e.blockxml=d:d.childNodes&&0<d.childNodes.length&&(e.contents=module$contents$Blockly$utils$toolbox_xmlToJsonArray(d)),module$contents$Blockly$utils$toolbox_addAttributes(d,e),b.push(e)}return b},module$contents$Blockly$utils$toolbox_addAttributes=function(a,b){for(var c=0;c<a.attributes.length;c++){var d=a.attributes[c];-1<d.nodeName.indexOf("css-")?(b.cssconfig=b.cssconfig||{},b.cssconfig[d.nodeName.replace("css-","")]=d.value):b[d.nodeName]=d.value}};module$exports$Blockly$utils$toolbox.parseToolboxTree=function(a){if(a){if("string"!=typeof a&&(module$exports$Blockly$utils$userAgent.IE&&a.outerHTML?a=a.outerHTML:a instanceof Element||(a=null)),"string"==typeof a&&"xml"!==(a=(0,$.module$exports$Blockly$Xml.textToDom)(a)).nodeName.toLowerCase())throw TypeError("Toolbox should be an <xml> document.")}else a=null;return a},$.module$exports$Blockly$utils$object={inherits:function(a,b){a.superClass_=b.prototype,Object.setPrototypeOf(a,b),a.prototype=Object.create(b.prototype),a.prototype.constructor=a},mixin:function(a,b){for(var c in b)a[c]=b[c]},deepMerge:function(a,b){for(var c in b)a[c]=null!==b[c]&&"object"==typeof b[c]?(0,$.module$exports$Blockly$utils$object.deepMerge)(a[c]||Object.create(null),b[c]):b[c];return a},values:function(a){return Object.values?Object.values(a):Object.keys(a).map((function(b){return a[b]}))}};var module$exports$Blockly$Theme={Theme:function(a,b,c,d){this.name=a,this.blockStyles=b||Object.create(null),this.categoryStyles=c||Object.create(null),this.componentStyles=d||Object.create(null),this.fontStyle=Object.create(null),this.startHats=null,(0,module$exports$Blockly$registry.register)(module$exports$Blockly$registry.Type.THEME,a,this)}};module$exports$Blockly$Theme.Theme.prototype.getClassName=function(){return this.name+"-theme"},module$exports$Blockly$Theme.Theme.prototype.setBlockStyle=function(a,b){this.blockStyles[a]=b},module$exports$Blockly$Theme.Theme.prototype.setCategoryStyle=function(a,b){this.categoryStyles[a]=b},module$exports$Blockly$Theme.Theme.prototype.getComponentStyle=function(a){return(a=this.componentStyles[a])&&"string"==typeof a&&this.getComponentStyle(a)?this.getComponentStyle(a):a?String(a):null},module$exports$Blockly$Theme.Theme.prototype.setComponentStyle=function(a,b){this.componentStyles[a]=b},module$exports$Blockly$Theme.Theme.prototype.setFontStyle=function(a){this.fontStyle=a},module$exports$Blockly$Theme.Theme.prototype.setStartHats=function(a){this.startHats=a},module$exports$Blockly$Theme.Theme.defineTheme=function(a,b){var c=new module$exports$Blockly$Theme.Theme(a),d=b.base;return d&&("string"==typeof d&&(d=(0,module$exports$Blockly$registry.getObject)(module$exports$Blockly$registry.Type.THEME,d)),d instanceof module$exports$Blockly$Theme.Theme&&((0,$.module$exports$Blockly$utils$object.deepMerge)(c,d),c.name=a)),(0,$.module$exports$Blockly$utils$object.deepMerge)(c.blockStyles,b.blockStyles),(0,$.module$exports$Blockly$utils$object.deepMerge)(c.categoryStyles,b.categoryStyles),(0,$.module$exports$Blockly$utils$object.deepMerge)(c.componentStyles,b.componentStyles),(0,$.module$exports$Blockly$utils$object.deepMerge)(c.fontStyle,b.fontStyle),null!==b.startHats&&(c.startHats=b.startHats),c};var module$exports$Blockly$Themes$Classic={};module$exports$Blockly$Themes$Classic.Classic=new module$exports$Blockly$Theme.Theme("classic",{colour_blocks:{colourPrimary:"20"},list_blocks:{colourPrimary:"260"},logic_blocks:{colourPrimary:"210"},loop_blocks:{colourPrimary:"120"},math_blocks:{colourPrimary:"230"},procedure_blocks:{colourPrimary:"290"},text_blocks:{colourPrimary:"160"},variable_blocks:{colourPrimary:"330"},variable_dynamic_blocks:{colourPrimary:"310"},hat_blocks:{colourPrimary:"330",hat:"cap"}},{colour_category:{colour:"20"},list_category:{colour:"260"},logic_category:{colour:"210"},loop_category:{colour:"120"},math_category:{colour:"230"},procedure_category:{colour:"290"},text_category:{colour:"160"},variable_category:{colour:"330"},variable_dynamic_category:{colour:"310"}});var module$exports$Blockly$Options={Options:function(a){var b=null,c=!1,d=!1,e=!1,f=!1,g=!1,h=!1,k=!!a.readOnly;k||(b=(0,module$exports$Blockly$utils$toolbox.convertToolboxDefToJson)(a.toolbox),c=(0,module$exports$Blockly$utils$toolbox.hasCategories)(b),void 0===(d=a.trashcan)&&(d=c),void 0===(e=a.collapse)&&(e=c),void 0===(f=a.comments)&&(f=c),void 0===(g=a.disable)&&(g=c),void 0===(h=a.sounds)&&(h=!0));var l=a.maxTrashcanContents;d?void 0===l&&(l=32):l=0;var m=!!a.rtl,n=a.horizontalLayout;void 0===n&&(n=!1);var p=a.toolboxPosition;p="end"!==p,p=n?p?module$exports$Blockly$utils$toolbox.Position.TOP:module$exports$Blockly$utils$toolbox.Position.BOTTOM:p===m?module$exports$Blockly$utils$toolbox.Position.RIGHT:module$exports$Blockly$utils$toolbox.Position.LEFT;var q=a.css;void 0===q&&(q=!0);var r="https://blockly-demo.appspot.com/static/media/";a.media?r=a.media:a.path&&(r=a.path+"media/");var t=void 0===a.oneBasedIndex||!!a.oneBasedIndex,u=a.renderer||"geras",v=a.plugins||{};this.RTL=m,this.oneBasedIndex=t,this.collapse=e,this.comments=f,this.disable=g,this.readOnly=k,this.maxBlocks=a.maxBlocks||1/0,this.maxInstances=a.maxInstances,this.pathToMedia=r,this.hasCategories=c,this.moveOptions=module$exports$Blockly$Options.Options.parseMoveOptions_(a,c),this.hasScrollbars=!!this.moveOptions.scrollbars,this.hasTrashcan=d,this.maxTrashcanContents=l,this.hasSounds=h,this.hasCss=q,this.horizontalLayout=n,this.languageTree=b,this.gridOptions=module$exports$Blockly$Options.Options.parseGridOptions_(a),this.zoomOptions=module$exports$Blockly$Options.Options.parseZoomOptions_(a),this.toolboxPosition=p,this.theme=module$exports$Blockly$Options.Options.parseThemeOptions_(a),this.renderer=u,this.rendererOverrides=a.rendererOverrides,this.gridPattern=null,this.parentWorkspace=a.parentWorkspace,this.plugins=v}};module$exports$Blockly$Options.Options.parseMoveOptions_=function(a,b){var c=a.move||{},d={};return void 0===c.scrollbars&&void 0===a.scrollbars?d.scrollbars=b:"object"==typeof c.scrollbars?(d.scrollbars={},d.scrollbars.horizontal=!!c.scrollbars.horizontal,d.scrollbars.vertical=!!c.scrollbars.vertical,d.scrollbars.horizontal&&d.scrollbars.vertical?d.scrollbars=!0:d.scrollbars.horizontal||d.scrollbars.vertical||(d.scrollbars=!1)):d.scrollbars=!!c.scrollbars||!!a.scrollbars,d.wheel=d.scrollbars&&void 0!==c.wheel?!!c.wheel:"object"==typeof d.scrollbars,d.drag=!(!d.scrollbars||void 0!==c.drag&&!c.drag),d},module$exports$Blockly$Options.Options.parseZoomOptions_=function(a){a=a.zoom||{};var b={};return b.controls=void 0!==a.controls&&!!a.controls,b.wheel=void 0!==a.wheel&&!!a.wheel,b.startScale=void 0===a.startScale?1:Number(a.startScale),b.maxScale=void 0===a.maxScale?3:Number(a.maxScale),b.minScale=void 0===a.minScale?.3:Number(a.minScale),b.scaleSpeed=void 0===a.scaleSpeed?1.2:Number(a.scaleSpeed),b.pinch=void 0===a.pinch?b.wheel||b.controls:!!a.pinch,b},module$exports$Blockly$Options.Options.parseGridOptions_=function(a){a=a.grid||{};var b={};return b.spacing=Number(a.spacing)||0,b.colour=a.colour||"#888",b.length=void 0===a.length?1:Number(a.length),b.snap=0<b.spacing&&!!a.snap,b},module$exports$Blockly$Options.Options.parseThemeOptions_=function(a){return"string"==typeof(a=a.theme||module$exports$Blockly$Themes$Classic.Classic)?(0,module$exports$Blockly$registry.getObject)(module$exports$Blockly$registry.Type.THEME,a):a instanceof module$exports$Blockly$Theme.Theme?a:module$exports$Blockly$Theme.Theme.defineTheme(a.name||"builtin"+(0,module$exports$Blockly$utils$idGenerator.getNextUniqueId)(),a)};var module$exports$Blockly$Scrollbar={Scrollbar:function(a,b,c,d,e){this.workspace_=a,this.pair_=c||!1,this.horizontal_=b,this.margin_=void 0!==e?e:module$exports$Blockly$Scrollbar.Scrollbar.DEFAULT_SCROLLBAR_MARGIN,this.ratio=this.oldHostMetrics_=null,this.createDom_(d),this.position=new module$exports$Blockly$utils$Coordinate.Coordinate(0,0),a=module$exports$Blockly$Scrollbar.Scrollbar.scrollbarThickness,b?(this.svgBackground_.setAttribute("height",a),this.outerSvg_.setAttribute("height",a),this.svgHandle_.setAttribute("height",a-5),this.svgHandle_.setAttribute("y",2.5),this.lengthAttribute_="width",this.positionAttribute_="x"):(this.svgBackground_.setAttribute("width",a),this.outerSvg_.setAttribute("width",a),this.svgHandle_.setAttribute("width",a-5),this.svgHandle_.setAttribute("x",2.5),this.lengthAttribute_="height",this.positionAttribute_="y"),this.onMouseDownBarWrapper_=(0,module$exports$Blockly$browserEvents.conditionalBind)(this.svgBackground_,"mousedown",this,this.onMouseDownBar_),this.onMouseDownHandleWrapper_=(0,module$exports$Blockly$browserEvents.conditionalBind)(this.svgHandle_,"mousedown",this,this.onMouseDownHandle_)}};module$exports$Blockly$Scrollbar.Scrollbar.prototype.origin_=new module$exports$Blockly$utils$Coordinate.Coordinate(0,0),module$exports$Blockly$Scrollbar.Scrollbar.prototype.startDragMouse_=0,module$exports$Blockly$Scrollbar.Scrollbar.prototype.scrollbarLength_=0,module$exports$Blockly$Scrollbar.Scrollbar.prototype.handleLength_=0,module$exports$Blockly$Scrollbar.Scrollbar.prototype.handlePosition_=0,module$exports$Blockly$Scrollbar.Scrollbar.prototype.isVisible_=!0,module$exports$Blockly$Scrollbar.Scrollbar.prototype.containerVisible_=!0,module$exports$Blockly$Scrollbar.Scrollbar.scrollbarThickness=15,module$exports$Blockly$Touch.TOUCH_ENABLED&&(module$exports$Blockly$Scrollbar.Scrollbar.scrollbarThickness=25),module$exports$Blockly$Scrollbar.Scrollbar.DEFAULT_SCROLLBAR_MARGIN=.5,module$exports$Blockly$Scrollbar.Scrollbar.metricsAreEquivalent_=function(a,b){return a.viewWidth===b.viewWidth&&a.viewHeight===b.viewHeight&&a.viewLeft===b.viewLeft&&a.viewTop===b.viewTop&&a.absoluteTop===b.absoluteTop&&a.absoluteLeft===b.absoluteLeft&&a.scrollWidth===b.scrollWidth&&a.scrollHeight===b.scrollHeight&&a.scrollLeft===b.scrollLeft&&a.scrollTop===b.scrollTop},module$exports$Blockly$Scrollbar.Scrollbar.prototype.dispose=function(){this.cleanUp_(),(0,module$exports$Blockly$browserEvents.unbind)(this.onMouseDownBarWrapper_),this.onMouseDownBarWrapper_=null,(0,module$exports$Blockly$browserEvents.unbind)(this.onMouseDownHandleWrapper_),this.onMouseDownHandleWrapper_=null,(0,module$exports$Blockly$utils$dom.removeNode)(this.outerSvg_),this.svgBackground_=this.svgGroup_=this.outerSvg_=null,this.svgHandle_&&(this.workspace_.getThemeManager().unsubscribe(this.svgHandle_),this.svgHandle_=null),this.workspace_=null},module$exports$Blockly$Scrollbar.Scrollbar.prototype.constrainHandleLength_=function(a){return 0>=a||isNaN(a)?0:Math.min(a,this.scrollbarLength_)},module$exports$Blockly$Scrollbar.Scrollbar.prototype.setHandleLength_=function(a){this.handleLength_=a,this.svgHandle_.setAttribute(this.lengthAttribute_,this.handleLength_)},module$exports$Blockly$Scrollbar.Scrollbar.prototype.constrainHandlePosition_=function(a){return 0>=a||isNaN(a)?0:Math.min(a,this.scrollbarLength_-this.handleLength_)},module$exports$Blockly$Scrollbar.Scrollbar.prototype.setHandlePosition=function(a){this.handlePosition_=a,this.svgHandle_.setAttribute(this.positionAttribute_,this.handlePosition_)},module$exports$Blockly$Scrollbar.Scrollbar.prototype.setScrollbarLength_=function(a){this.scrollbarLength_=a,this.outerSvg_.setAttribute(this.lengthAttribute_,this.scrollbarLength_),this.svgBackground_.setAttribute(this.lengthAttribute_,this.scrollbarLength_)},module$exports$Blockly$Scrollbar.Scrollbar.prototype.setPosition=function(a,b){this.position.x=a,this.position.y=b,(0,module$exports$Blockly$utils$dom.setCssTransform)(this.outerSvg_,"translate("+(this.position.x+this.origin_.x)+"px,"+(this.position.y+this.origin_.y)+"px)")},module$exports$Blockly$Scrollbar.Scrollbar.prototype.resize=function(a){(a||(a=this.workspace_.getMetrics()))&&(this.oldHostMetrics_&&module$exports$Blockly$Scrollbar.Scrollbar.metricsAreEquivalent_(a,this.oldHostMetrics_)||(this.horizontal_?this.resizeHorizontal_(a):this.resizeVertical_(a),this.oldHostMetrics_=a,this.updateMetrics_()))},module$exports$Blockly$Scrollbar.Scrollbar.prototype.requiresViewResize_=function(a){return!this.oldHostMetrics_||this.oldHostMetrics_.viewWidth!==a.viewWidth||this.oldHostMetrics_.viewHeight!==a.viewHeight||this.oldHostMetrics_.absoluteLeft!==a.absoluteLeft||this.oldHostMetrics_.absoluteTop!==a.absoluteTop},module$exports$Blockly$Scrollbar.Scrollbar.prototype.resizeHorizontal_=function(a){this.requiresViewResize_(a)?this.resizeViewHorizontal(a):this.resizeContentHorizontal(a)},module$exports$Blockly$Scrollbar.Scrollbar.prototype.resizeViewHorizontal=function(a){var b=a.viewWidth-2*this.margin_;this.pair_&&(b-=module$exports$Blockly$Scrollbar.Scrollbar.scrollbarThickness),this.setScrollbarLength_(Math.max(0,b)),b=a.absoluteLeft+this.margin_,this.pair_&&this.workspace_.RTL&&(b+=module$exports$Blockly$Scrollbar.Scrollbar.scrollbarThickness),this.setPosition(b,a.absoluteTop+a.viewHeight-module$exports$Blockly$Scrollbar.Scrollbar.scrollbarThickness-this.margin_),this.resizeContentHorizontal(a)},module$exports$Blockly$Scrollbar.Scrollbar.prototype.resizeContentHorizontal=function(a){if(a.viewWidth>=a.scrollWidth)this.setHandleLength_(this.scrollbarLength_),this.setHandlePosition(0),this.pair_||this.setVisible(!1);else{this.pair_||this.setVisible(!0);var b=this.scrollbarLength_*a.viewWidth/a.scrollWidth;b=this.constrainHandleLength_(b),this.setHandleLength_(b),b=a.scrollWidth-a.viewWidth;var c=this.scrollbarLength_-this.handleLength_;a=(a.viewLeft-a.scrollLeft)/b*c,a=this.constrainHandlePosition_(a),this.setHandlePosition(a),this.ratio=c/b}},module$exports$Blockly$Scrollbar.Scrollbar.prototype.resizeVertical_=function(a){this.requiresViewResize_(a)?this.resizeViewVertical(a):this.resizeContentVertical(a)},module$exports$Blockly$Scrollbar.Scrollbar.prototype.resizeViewVertical=function(a){var b=a.viewHeight-2*this.margin_;this.pair_&&(b-=module$exports$Blockly$Scrollbar.Scrollbar.scrollbarThickness),this.setScrollbarLength_(Math.max(0,b)),this.setPosition(this.workspace_.RTL?a.absoluteLeft+this.margin_:a.absoluteLeft+a.viewWidth-module$exports$Blockly$Scrollbar.Scrollbar.scrollbarThickness-this.margin_,a.absoluteTop+this.margin_),this.resizeContentVertical(a)},module$exports$Blockly$Scrollbar.Scrollbar.prototype.resizeContentVertical=function(a){if(a.viewHeight>=a.scrollHeight)this.setHandleLength_(this.scrollbarLength_),this.setHandlePosition(0),this.pair_||this.setVisible(!1);else{this.pair_||this.setVisible(!0);var b=this.scrollbarLength_*a.viewHeight/a.scrollHeight;b=this.constrainHandleLength_(b),this.setHandleLength_(b),b=a.scrollHeight-a.viewHeight;var c=this.scrollbarLength_-this.handleLength_;a=(a.viewTop-a.scrollTop)/b*c,a=this.constrainHandlePosition_(a),this.setHandlePosition(a),this.ratio=c/b}},module$exports$Blockly$Scrollbar.Scrollbar.prototype.createDom_=function(a){var b="blocklyScrollbar"+(this.horizontal_?"Horizontal":"Vertical");a&&(b+=" "+a),this.outerSvg_=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.SVG,{class:b},null),this.svgGroup_=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.G,{},this.outerSvg_),this.svgBackground_=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.RECT,{class:"blocklyScrollbarBackground"},this.svgGroup_),a=Math.floor((module$exports$Blockly$Scrollbar.Scrollbar.scrollbarThickness-5)/2),this.svgHandle_=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.RECT,{class:"blocklyScrollbarHandle",rx:a,ry:a},this.svgGroup_),this.workspace_.getThemeManager().subscribe(this.svgHandle_,"scrollbarColour","fill"),this.workspace_.getThemeManager().subscribe(this.svgHandle_,"scrollbarOpacity","fill-opacity"),(0,module$exports$Blockly$utils$dom.insertAfter)(this.outerSvg_,this.workspace_.getParentSvg())},module$exports$Blockly$Scrollbar.Scrollbar.prototype.isVisible=function(){return this.isVisible_},module$exports$Blockly$Scrollbar.Scrollbar.prototype.setContainerVisible=function(a){var b=a!==this.containerVisible_;this.containerVisible_=a,b&&this.updateDisplay_()},module$exports$Blockly$Scrollbar.Scrollbar.prototype.setVisible=function(a){var b=a!==this.isVisible();if(this.pair_)throw Error("Unable to toggle visibility of paired scrollbars.");this.isVisible_=a,b&&this.updateDisplay_()},module$exports$Blockly$Scrollbar.Scrollbar.prototype.updateDisplay_=function(){this.containerVisible_&&this.isVisible()?this.outerSvg_.setAttribute("display","block"):this.outerSvg_.setAttribute("display","none")},module$exports$Blockly$Scrollbar.Scrollbar.prototype.onMouseDownBar_=function(a){if(this.workspace_.markFocused(),(0,module$exports$Blockly$Touch.clearTouchIdentifier)(),this.cleanUp_(),(0,module$exports$Blockly$browserEvents.isRightButton)(a))a.stopPropagation();else{var b=(0,module$exports$Blockly$browserEvents.mouseToSvg)(a,this.workspace_.getParentSvg(),this.workspace_.getInverseScreenCTM());b=this.horizontal_?b.x:b.y;var c=(0,module$exports$Blockly$utils$svgMath.getInjectionDivXY)(this.svgHandle_);c=this.horizontal_?c.x:c.y;var d=this.handlePosition_,e=.95*this.handleLength_;b<=c?d-=e:b>=c+this.handleLength_&&(d+=e),this.setHandlePosition(this.constrainHandlePosition_(d)),this.updateMetrics_(),a.stopPropagation(),a.preventDefault()}},module$exports$Blockly$Scrollbar.Scrollbar.prototype.onMouseDownHandle_=function(a){this.workspace_.markFocused(),this.cleanUp_(),(0,module$exports$Blockly$browserEvents.isRightButton)(a)?a.stopPropagation():(this.startDragHandle=this.handlePosition_,this.workspace_.setupDragSurface(),this.startDragMouse_=this.horizontal_?a.clientX:a.clientY,module$exports$Blockly$Scrollbar.Scrollbar.onMouseUpWrapper_=(0,module$exports$Blockly$browserEvents.conditionalBind)(document,"mouseup",this,this.onMouseUpHandle_),module$exports$Blockly$Scrollbar.Scrollbar.onMouseMoveWrapper_=(0,module$exports$Blockly$browserEvents.conditionalBind)(document,"mousemove",this,this.onMouseMoveHandle_),a.stopPropagation(),a.preventDefault())},module$exports$Blockly$Scrollbar.Scrollbar.prototype.onMouseMoveHandle_=function(a){this.setHandlePosition(this.constrainHandlePosition_(this.startDragHandle+((this.horizontal_?a.clientX:a.clientY)-this.startDragMouse_))),this.updateMetrics_()},module$exports$Blockly$Scrollbar.Scrollbar.prototype.onMouseUpHandle_=function(){this.workspace_.resetDragSurface(),(0,module$exports$Blockly$Touch.clearTouchIdentifier)(),this.cleanUp_()},module$exports$Blockly$Scrollbar.Scrollbar.prototype.cleanUp_=function(){this.workspace_.hideChaff(!0),module$exports$Blockly$Scrollbar.Scrollbar.onMouseUpWrapper_&&((0,module$exports$Blockly$browserEvents.unbind)(module$exports$Blockly$Scrollbar.Scrollbar.onMouseUpWrapper_),module$exports$Blockly$Scrollbar.Scrollbar.onMouseUpWrapper_=null),module$exports$Blockly$Scrollbar.Scrollbar.onMouseMoveWrapper_&&((0,module$exports$Blockly$browserEvents.unbind)(module$exports$Blockly$Scrollbar.Scrollbar.onMouseMoveWrapper_),module$exports$Blockly$Scrollbar.Scrollbar.onMouseMoveWrapper_=null)},module$exports$Blockly$Scrollbar.Scrollbar.prototype.getRatio_=function(){var a=this.handlePosition_/(this.scrollbarLength_-this.handleLength_);return isNaN(a)&&(a=0),a},module$exports$Blockly$Scrollbar.Scrollbar.prototype.updateMetrics_=function(){var a=this.getRatio_(),b={};this.horizontal_?b.x=a:b.y=a,this.workspace_.setMetrics(b)},module$exports$Blockly$Scrollbar.Scrollbar.prototype.set=function(a,b){this.setHandlePosition(this.constrainHandlePosition_(a*this.ratio)),(b||void 0===b)&&this.updateMetrics_()},module$exports$Blockly$Scrollbar.Scrollbar.prototype.setOrigin=function(a,b){this.origin_=new module$exports$Blockly$utils$Coordinate.Coordinate(a,b)};var module$exports$Blockly$ScrollbarPair={ScrollbarPair:function(a,b,c,d,e){this.workspace_=a,c=void 0===c||c;var f=(b=void 0===b||b)&&c;b&&(this.hScroll=new module$exports$Blockly$Scrollbar.Scrollbar(a,!0,f,d,e)),c&&(this.vScroll=new module$exports$Blockly$Scrollbar.Scrollbar(a,!1,f,d,e)),f&&(this.corner_=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.RECT,{height:module$exports$Blockly$Scrollbar.Scrollbar.scrollbarThickness,width:module$exports$Blockly$Scrollbar.Scrollbar.scrollbarThickness,class:"blocklyScrollbarBackground"},null),(0,module$exports$Blockly$utils$dom.insertAfter)(this.corner_,a.getBubbleCanvas())),this.oldHostMetrics_=null}};module$exports$Blockly$ScrollbarPair.ScrollbarPair.prototype.dispose=function(){(0,module$exports$Blockly$utils$dom.removeNode)(this.corner_),this.oldHostMetrics_=this.workspace_=this.corner_=null,this.hScroll&&(this.hScroll.dispose(),this.hScroll=null),this.vScroll&&(this.vScroll.dispose(),this.vScroll=null)},module$exports$Blockly$ScrollbarPair.ScrollbarPair.prototype.resize=function(){var a=this.workspace_.getMetrics();if(a){var b=!1,c=!1;if(this.oldHostMetrics_&&this.oldHostMetrics_.viewWidth===a.viewWidth&&this.oldHostMetrics_.viewHeight===a.viewHeight&&this.oldHostMetrics_.absoluteTop===a.absoluteTop&&this.oldHostMetrics_.absoluteLeft===a.absoluteLeft?(this.oldHostMetrics_&&this.oldHostMetrics_.scrollWidth===a.scrollWidth&&this.oldHostMetrics_.viewLeft===a.viewLeft&&this.oldHostMetrics_.scrollLeft===a.scrollLeft||(b=!0),this.oldHostMetrics_&&this.oldHostMetrics_.scrollHeight===a.scrollHeight&&this.oldHostMetrics_.viewTop===a.viewTop&&this.oldHostMetrics_.scrollTop===a.scrollTop||(c=!0)):c=b=!0,b||c){try{(0,module$exports$Blockly$Events$utils.disable)(),this.hScroll&&b&&this.hScroll.resize(a),this.vScroll&&c&&this.vScroll.resize(a)}finally{(0,module$exports$Blockly$Events$utils.enable)()}this.workspace_.maybeFireViewportChangeEvent()}this.hScroll&&this.vScroll&&(this.oldHostMetrics_&&this.oldHostMetrics_.viewWidth===a.viewWidth&&this.oldHostMetrics_.absoluteLeft===a.absoluteLeft||this.corner_.setAttribute("x",this.vScroll.position.x),this.oldHostMetrics_&&this.oldHostMetrics_.viewHeight===a.viewHeight&&this.oldHostMetrics_.absoluteTop===a.absoluteTop||this.corner_.setAttribute("y",this.hScroll.position.y)),this.oldHostMetrics_=a}},module$exports$Blockly$ScrollbarPair.ScrollbarPair.prototype.canScrollHorizontally=function(){return!!this.hScroll},module$exports$Blockly$ScrollbarPair.ScrollbarPair.prototype.canScrollVertically=function(){return!!this.vScroll},module$exports$Blockly$ScrollbarPair.ScrollbarPair.prototype.setOrigin=function(a,b){this.hScroll&&this.hScroll.setOrigin(a,b),this.vScroll&&this.vScroll.setOrigin(a,b)},module$exports$Blockly$ScrollbarPair.ScrollbarPair.prototype.set=function(a,b,c){this.hScroll&&this.hScroll.set(a,!1),this.vScroll&&this.vScroll.set(b,!1),(c||void 0===c)&&(a={},this.hScroll&&(a.x=this.hScroll.getRatio_()),this.vScroll&&(a.y=this.vScroll.getRatio_()),this.workspace_.setMetrics(a))},module$exports$Blockly$ScrollbarPair.ScrollbarPair.prototype.setX=function(a){this.hScroll&&this.hScroll.set(a,!0)},module$exports$Blockly$ScrollbarPair.ScrollbarPair.prototype.setY=function(a){this.vScroll&&this.vScroll.set(a,!0)},module$exports$Blockly$ScrollbarPair.ScrollbarPair.prototype.setContainerVisible=function(a){this.hScroll&&this.hScroll.setContainerVisible(a),this.vScroll&&this.vScroll.setContainerVisible(a)},module$exports$Blockly$ScrollbarPair.ScrollbarPair.prototype.isVisible=function(){var a=!1;return this.hScroll&&(a=this.hScroll.isVisible()),this.vScroll&&(a=a||this.vScroll.isVisible()),a},module$exports$Blockly$ScrollbarPair.ScrollbarPair.prototype.resizeContent=function(a){this.hScroll&&this.hScroll.resizeContentHorizontal(a),this.vScroll&&this.vScroll.resizeContentVertical(a)},module$exports$Blockly$ScrollbarPair.ScrollbarPair.prototype.resizeView=function(a){this.hScroll&&this.hScroll.resizeViewHorizontal(a),this.vScroll&&this.vScroll.resizeViewVertical(a)};var module$exports$Blockly$utils$KeyCodes_KeyCodes={WIN_KEY_FF_LINUX:0,MAC_ENTER:3,BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PLUS_SIGN:43,PRINT_SCREEN:44,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,FF_SEMICOLON:59,FF_EQUALS:61,FF_DASH:173,FF_HASH:163,QUESTION_MARK:63,AT_SIGN:64,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,META:91,WIN_KEY_RIGHT:92,CONTEXT_MENU:93,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SCROLL_LOCK:145,FIRST_MEDIA_KEY:166,LAST_MEDIA_KEY:183,SEMICOLON:186,DASH:189,EQUALS:187,COMMA:188,PERIOD:190,SLASH:191,APOSTROPHE:192,TILDE:192,SINGLE_QUOTE:222,OPEN_SQUARE_BRACKET:219,BACKSLASH:220,CLOSE_SQUARE_BRACKET:221,WIN_KEY:224,MAC_FF_META:224,MAC_WK_CMD_LEFT:91,MAC_WK_CMD_RIGHT:93,WIN_IME:229,VK_NONAME:252,PHANTOM:255},module$exports$Blockly$ShortcutRegistry={ShortcutRegistry:function(){module$exports$Blockly$ShortcutRegistry.ShortcutRegistry.registry=this,this.registry_=Object.create(null),this.keyMap_=Object.create(null)}};module$exports$Blockly$ShortcutRegistry.ShortcutRegistry.modifierKeys={Shift:module$exports$Blockly$utils$KeyCodes_KeyCodes.SHIFT,Control:module$exports$Blockly$utils$KeyCodes_KeyCodes.CTRL,Alt:module$exports$Blockly$utils$KeyCodes_KeyCodes.ALT,Meta:module$exports$Blockly$utils$KeyCodes_KeyCodes.META},module$exports$Blockly$ShortcutRegistry.ShortcutRegistry.prototype.register=function(a,b){if(this.registry_[a.name]&&!b)throw Error('Shortcut with name "'+a.name+'" already exists.');this.registry_[a.name]=a},module$exports$Blockly$ShortcutRegistry.ShortcutRegistry.prototype.unregister=function(a){return this.registry_[a]?(this.removeAllKeyMappings(a),delete this.registry_[a],!0):(console.warn('Keyboard shortcut with name "'+a+'" not found.'),!1)},module$exports$Blockly$ShortcutRegistry.ShortcutRegistry.prototype.addKeyMapping=function(a,b,c){a=String(a);var d=this.keyMap_[a];if(d&&!c)throw Error('Shortcut with name "'+b+'" collides with shortcuts '+d.toString());d&&c?d.unshift(b):this.keyMap_[a]=[b]},module$exports$Blockly$ShortcutRegistry.ShortcutRegistry.prototype.removeKeyMapping=function(a,b,c){var d=this.keyMap_[a];if(!d&&!c)return console.warn('No keyboard shortcut with name "'+b+'" registered with key code "'+a+'"'),!1;var e=d.indexOf(b);return-1<e?(d.splice(e,1),0===d.length&&delete this.keyMap_[a],!0):(c||console.warn('No keyboard shortcut with name "'+b+'" registered with key code "'+a+'"'),!1)},module$exports$Blockly$ShortcutRegistry.ShortcutRegistry.prototype.removeAllKeyMappings=function(a){for(var b in this.keyMap_)this.removeKeyMapping(b,a,!0)},module$exports$Blockly$ShortcutRegistry.ShortcutRegistry.prototype.setKeyMap=function(a){this.keyMap_=a},module$exports$Blockly$ShortcutRegistry.ShortcutRegistry.prototype.getKeyMap=function(){return(0,$.module$exports$Blockly$utils$object.deepMerge)(Object.create(null),this.keyMap_)},module$exports$Blockly$ShortcutRegistry.ShortcutRegistry.prototype.getRegistry=function(){return(0,$.module$exports$Blockly$utils$object.deepMerge)(Object.create(null),this.registry_)},module$exports$Blockly$ShortcutRegistry.ShortcutRegistry.prototype.onKeyDown=function(a,b){var c=this.serializeKeyEvent_(b);if(!(c=this.getShortcutNamesByKeyCode(c)))return!1;for(var e,d=0;e=c[d];d++)if((!(e=this.registry_[e]).preconditionFn||e.preconditionFn(a))&&e.callback&&e.callback(a,b,e))return!0;return!1},module$exports$Blockly$ShortcutRegistry.ShortcutRegistry.prototype.getShortcutNamesByKeyCode=function(a){return this.keyMap_[a]||[]},module$exports$Blockly$ShortcutRegistry.ShortcutRegistry.prototype.getKeyCodesByShortcutName=function(a){var c,b=[];for(c in this.keyMap_)-1<this.keyMap_[c].indexOf(a)&&b.push(c);return b},module$exports$Blockly$ShortcutRegistry.ShortcutRegistry.prototype.serializeKeyEvent_=function(a){var c,b="";for(c in module$exports$Blockly$ShortcutRegistry.ShortcutRegistry.modifierKeys)a.getModifierState(c)&&(""!==b&&(b+="+"),b+=c);return""!==b&&a.keyCode?b=b+"+"+a.keyCode:a.keyCode&&(b=a.keyCode.toString()),b},module$exports$Blockly$ShortcutRegistry.ShortcutRegistry.prototype.checkModifiers_=function(a){for(var d,b=(0,$.module$exports$Blockly$utils$object.values)(module$exports$Blockly$ShortcutRegistry.ShortcutRegistry.modifierKeys),c=0;d=a[c];c++)if(0>b.indexOf(d))throw Error(d+" is not a valid modifier key.")},module$exports$Blockly$ShortcutRegistry.ShortcutRegistry.prototype.createSerializedKey=function(a,b){var c="";if(b)for(var d in this.checkModifiers_(b),module$exports$Blockly$ShortcutRegistry.ShortcutRegistry.modifierKeys)-1<b.indexOf(module$exports$Blockly$ShortcutRegistry.ShortcutRegistry.modifierKeys[d])&&(""!==c&&(c+="+"),c+=d);return""!==c&&a?c=c+"+"+a:a&&(c=a.toString()),c},new module$exports$Blockly$ShortcutRegistry.ShortcutRegistry;var module$exports$Blockly$WorkspaceDragSurfaceSvg={WorkspaceDragSurfaceSvg:function(a){this.container_=a,this.createDom()}};module$exports$Blockly$WorkspaceDragSurfaceSvg.WorkspaceDragSurfaceSvg.prototype.SVG_=null,module$exports$Blockly$WorkspaceDragSurfaceSvg.WorkspaceDragSurfaceSvg.prototype.container_=null,module$exports$Blockly$WorkspaceDragSurfaceSvg.WorkspaceDragSurfaceSvg.prototype.createDom=function(){this.SVG_||(this.SVG_=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.SVG,{xmlns:module$exports$Blockly$utils$dom.SVG_NS,"xmlns:html":module$exports$Blockly$utils$dom.HTML_NS,"xmlns:xlink":module$exports$Blockly$utils$dom.XLINK_NS,version:"1.1",class:"blocklyWsDragSurface blocklyOverflowVisible"},null),this.container_.appendChild(this.SVG_))},module$exports$Blockly$WorkspaceDragSurfaceSvg.WorkspaceDragSurfaceSvg.prototype.translateSurface=function(a,b){a=a.toFixed(0),b=b.toFixed(0),this.SVG_.style.display="block",(0,module$exports$Blockly$utils$dom.setCssTransform)(this.SVG_,"translate3d("+a+"px, "+b+"px, 0)")},module$exports$Blockly$WorkspaceDragSurfaceSvg.WorkspaceDragSurfaceSvg.prototype.getSurfaceTranslation=function(){return(0,module$exports$Blockly$utils$svgMath.getRelativeXY)(this.SVG_)},module$exports$Blockly$WorkspaceDragSurfaceSvg.WorkspaceDragSurfaceSvg.prototype.clearAndHide=function(a){if(!a)throw Error("Couldn't clear and hide the drag surface: missing new surface.");var b=this.SVG_.childNodes[0],c=this.SVG_.childNodes[1];if(!(b&&c&&(0,module$exports$Blockly$utils$dom.hasClass)(b,"blocklyBlockCanvas")&&(0,module$exports$Blockly$utils$dom.hasClass)(c,"blocklyBubbleCanvas")))throw Error("Couldn't clear and hide the drag surface. A node was missing.");if(null!==this.previousSibling_?(0,module$exports$Blockly$utils$dom.insertAfter)(b,this.previousSibling_):a.insertBefore(b,a.firstChild),(0,module$exports$Blockly$utils$dom.insertAfter)(c,b),this.SVG_.style.display="none",this.SVG_.childNodes.length)throw Error("Drag surface was not cleared.");(0,module$exports$Blockly$utils$dom.setCssTransform)(this.SVG_,""),this.previousSibling_=null},module$exports$Blockly$WorkspaceDragSurfaceSvg.WorkspaceDragSurfaceSvg.prototype.setContentsAndShow=function(a,b,c,d,e,f){if(this.SVG_.childNodes.length)throw Error("Already dragging a block.");this.previousSibling_=c,a.setAttribute("transform","translate(0, 0) scale("+f+")"),b.setAttribute("transform","translate(0, 0) scale("+f+")"),this.SVG_.setAttribute("width",d),this.SVG_.setAttribute("height",e),this.SVG_.appendChild(a),this.SVG_.appendChild(b),this.SVG_.style.display="block"};var module$exports$Blockly$clipboard={},module$contents$Blockly$clipboard_copyData=null;module$exports$Blockly$clipboard.copy=function(a){module$contents$Blockly$clipboard_copyData=a.toCopyData()},module$exports$Blockly$clipboard.paste=function(){if(!module$contents$Blockly$clipboard_copyData)return!1;var a=module$contents$Blockly$clipboard_copyData.source;return a.isFlyout&&(a=a.targetWorkspace),!(!module$contents$Blockly$clipboard_copyData.typeCounts||!a.isCapacityAvailable(module$contents$Blockly$clipboard_copyData.typeCounts)||((0,module$exports$Blockly$Events$utils.setGroup)(!0),a.paste(module$contents$Blockly$clipboard_copyData.saveInfo),(0,module$exports$Blockly$Events$utils.setGroup)(!1),0))},module$exports$Blockly$clipboard.duplicate=function(a){var b=module$contents$Blockly$clipboard_copyData;(0,module$exports$Blockly$clipboard.copy)(a),a.workspace.paste(module$contents$Blockly$clipboard_copyData.saveInfo),module$contents$Blockly$clipboard_copyData=b};var module$exports$Blockly$MenuItem={MenuItem:function(a,b){this.content_=a,this.value_=b,this.enabled_=!0,this.element_=null,this.rightToLeft_=!1,this.roleName_=null,this.highlight_=this.checked_=this.checkable_=!1,this.actionHandler_=null}};module$exports$Blockly$MenuItem.MenuItem.prototype.createDom=function(){var a=document.createElement("div");a.id=(0,module$exports$Blockly$utils$idGenerator.getNextUniqueId)(),this.element_=a,a.className="blocklyMenuItem goog-menuitem "+(this.enabled_?"":"blocklyMenuItemDisabled goog-menuitem-disabled ")+(this.checked_?"blocklyMenuItemSelected goog-option-selected ":"")+(this.highlight_?"blocklyMenuItemHighlight goog-menuitem-highlight ":"")+(this.rightToLeft_?"blocklyMenuItemRtl goog-menuitem-rtl ":"");var b=document.createElement("div");if(b.className="blocklyMenuItemContent goog-menuitem-content",this.checkable_){var c=document.createElement("div");c.className="blocklyMenuItemCheckbox goog-menuitem-checkbox",b.appendChild(c)}return c=this.content_,"string"==typeof this.content_&&(c=document.createTextNode(this.content_)),b.appendChild(c),a.appendChild(b),this.roleName_&&(0,module$exports$Blockly$utils$aria.setRole)(a,this.roleName_),(0,module$exports$Blockly$utils$aria.setState)(a,module$exports$Blockly$utils$aria.State.SELECTED,this.checkable_&&this.checked_||!1),(0,module$exports$Blockly$utils$aria.setState)(a,module$exports$Blockly$utils$aria.State.DISABLED,!this.enabled_),a},module$exports$Blockly$MenuItem.MenuItem.prototype.dispose=function(){this.element_=null},module$exports$Blockly$MenuItem.MenuItem.prototype.getElement=function(){return this.element_},module$exports$Blockly$MenuItem.MenuItem.prototype.getId=function(){return this.element_.id},module$exports$Blockly$MenuItem.MenuItem.prototype.getValue=function(){return this.value_},module$exports$Blockly$MenuItem.MenuItem.prototype.setRightToLeft=function(a){this.rightToLeft_=a},module$exports$Blockly$MenuItem.MenuItem.prototype.setRole=function(a){this.roleName_=a},module$exports$Blockly$MenuItem.MenuItem.prototype.setCheckable=function(a){this.checkable_=a},module$exports$Blockly$MenuItem.MenuItem.prototype.setChecked=function(a){this.checked_=a},module$exports$Blockly$MenuItem.MenuItem.prototype.setHighlighted=function(a){this.highlight_=a;var b=this.getElement();b&&this.isEnabled()&&(a?((0,module$exports$Blockly$utils$dom.addClass)(b,"blocklyMenuItemHighlight"),(0,module$exports$Blockly$utils$dom.addClass)(b,"goog-menuitem-highlight")):((0,module$exports$Blockly$utils$dom.removeClass)(b,"blocklyMenuItemHighlight"),(0,module$exports$Blockly$utils$dom.removeClass)(b,"goog-menuitem-highlight")))},module$exports$Blockly$MenuItem.MenuItem.prototype.isEnabled=function(){return this.enabled_},module$exports$Blockly$MenuItem.MenuItem.prototype.setEnabled=function(a){this.enabled_=a},module$exports$Blockly$MenuItem.MenuItem.prototype.performAction=function(){this.isEnabled()&&this.actionHandler_&&this.actionHandler_(this)},module$exports$Blockly$MenuItem.MenuItem.prototype.onAction=function(a,b){this.actionHandler_=a.bind(b)};var module$exports$Blockly$Menu={Menu:function(){this.menuItems_=[],this.roleName_=this.element_=this.onKeyDownHandler_=this.mouseLeaveHandler_=this.mouseEnterHandler_=this.clickHandler_=this.mouseOverHandler_=this.highlightedItem_=this.openingCoords=null}};module$exports$Blockly$Menu.Menu.prototype.addChild=function(a){this.menuItems_.push(a)},module$exports$Blockly$Menu.Menu.prototype.render=function(a){var b=document.createElement("div");b.className="blocklyMenu goog-menu blocklyNonSelectable",b.tabIndex=0,this.roleName_&&(0,module$exports$Blockly$utils$aria.setRole)(b,this.roleName_),this.element_=b;for(var d,c=0;d=this.menuItems_[c];c++)b.appendChild(d.createDom());this.mouseOverHandler_=(0,module$exports$Blockly$browserEvents.conditionalBind)(b,"mouseover",this,this.handleMouseOver_,!0),this.clickHandler_=(0,module$exports$Blockly$browserEvents.conditionalBind)(b,"click",this,this.handleClick_,!0),this.mouseEnterHandler_=(0,module$exports$Blockly$browserEvents.conditionalBind)(b,"mouseenter",this,this.handleMouseEnter_,!0),this.mouseLeaveHandler_=(0,module$exports$Blockly$browserEvents.conditionalBind)(b,"mouseleave",this,this.handleMouseLeave_,!0),this.onKeyDownHandler_=(0,module$exports$Blockly$browserEvents.conditionalBind)(b,"keydown",this,this.handleKeyEvent_),a.appendChild(b)},module$exports$Blockly$Menu.Menu.prototype.getElement=function(){return this.element_},module$exports$Blockly$Menu.Menu.prototype.focus=function(){var a=this.getElement();a&&(a.focus({preventScroll:!0}),(0,module$exports$Blockly$utils$dom.addClass)(a,"blocklyFocused"))},module$exports$Blockly$Menu.Menu.prototype.blur_=function(){var a=this.getElement();a&&(a.blur(),(0,module$exports$Blockly$utils$dom.removeClass)(a,"blocklyFocused"))},module$exports$Blockly$Menu.Menu.prototype.setRole=function(a){this.roleName_=a},module$exports$Blockly$Menu.Menu.prototype.dispose=function(){this.mouseOverHandler_&&((0,module$exports$Blockly$browserEvents.unbind)(this.mouseOverHandler_),this.mouseOverHandler_=null),this.clickHandler_&&((0,module$exports$Blockly$browserEvents.unbind)(this.clickHandler_),this.clickHandler_=null),this.mouseEnterHandler_&&((0,module$exports$Blockly$browserEvents.unbind)(this.mouseEnterHandler_),this.mouseEnterHandler_=null),this.mouseLeaveHandler_&&((0,module$exports$Blockly$browserEvents.unbind)(this.mouseLeaveHandler_),this.mouseLeaveHandler_=null),this.onKeyDownHandler_&&((0,module$exports$Blockly$browserEvents.unbind)(this.onKeyDownHandler_),this.onKeyDownHandler_=null);for(var b,a=0;b=this.menuItems_[a];a++)b.dispose();this.element_=null},module$exports$Blockly$Menu.Menu.prototype.getMenuItem_=function(a){for(var b=this.getElement();a&&a!==b;){if((0,module$exports$Blockly$utils$dom.hasClass)(a,"blocklyMenuItem"))for(var d,c=0;d=this.menuItems_[c];c++)if(d.getElement()===a)return d;a=a.parentElement}return null},module$exports$Blockly$Menu.Menu.prototype.setHighlighted=function(a){var b=this.highlightedItem_;b&&(b.setHighlighted(!1),this.highlightedItem_=null),a&&(a.setHighlighted(!0),this.highlightedItem_=a,b=this.getElement(),(0,module$exports$Blockly$utils$style.scrollIntoContainerView)(a.getElement(),b),(0,module$exports$Blockly$utils$aria.setState)(b,module$exports$Blockly$utils$aria.State.ACTIVEDESCENDANT,a.getId()))},module$exports$Blockly$Menu.Menu.prototype.highlightNext=function(){var a=this.menuItems_.indexOf(this.highlightedItem_);this.highlightHelper_(a,1)},module$exports$Blockly$Menu.Menu.prototype.highlightPrevious=function(){var a=this.menuItems_.indexOf(this.highlightedItem_);this.highlightHelper_(0>a?this.menuItems_.length:a,-1)},module$exports$Blockly$Menu.Menu.prototype.highlightFirst_=function(){this.highlightHelper_(-1,1)},module$exports$Blockly$Menu.Menu.prototype.highlightLast_=function(){this.highlightHelper_(this.menuItems_.length,-1)},module$exports$Blockly$Menu.Menu.prototype.highlightHelper_=function(a,b){a+=b;for(var c;c=this.menuItems_[a];){if(c.isEnabled()){this.setHighlighted(c);break}a+=b}},module$exports$Blockly$Menu.Menu.prototype.handleMouseOver_=function(a){(a=this.getMenuItem_(a.target))&&(a.isEnabled()?this.highlightedItem_!==a&&this.setHighlighted(a):this.setHighlighted(null))},module$exports$Blockly$Menu.Menu.prototype.handleClick_=function(a){var b=this.openingCoords;if(this.openingCoords=null,b&&"number"==typeof a.clientX){var c=new module$exports$Blockly$utils$Coordinate.Coordinate(a.clientX,a.clientY);if(1>module$exports$Blockly$utils$Coordinate.Coordinate.distance(b,c))return}(a=this.getMenuItem_(a.target))&&a.performAction()},module$exports$Blockly$Menu.Menu.prototype.handleMouseEnter_=function(a){this.focus()},module$exports$Blockly$Menu.Menu.prototype.handleMouseLeave_=function(a){this.getElement()&&(this.blur_(),this.setHighlighted(null))},module$exports$Blockly$Menu.Menu.prototype.handleKeyEvent_=function(a){if(this.menuItems_.length&&!(a.shiftKey||a.ctrlKey||a.metaKey||a.altKey)){var b=this.highlightedItem_;switch(a.keyCode){case module$exports$Blockly$utils$KeyCodes_KeyCodes.ENTER:case module$exports$Blockly$utils$KeyCodes_KeyCodes.SPACE:b&&b.performAction();break;case module$exports$Blockly$utils$KeyCodes_KeyCodes.UP:this.highlightPrevious();break;case module$exports$Blockly$utils$KeyCodes_KeyCodes.DOWN:this.highlightNext();break;case module$exports$Blockly$utils$KeyCodes_KeyCodes.PAGE_UP:case module$exports$Blockly$utils$KeyCodes_KeyCodes.HOME:this.highlightFirst_();break;case module$exports$Blockly$utils$KeyCodes_KeyCodes.PAGE_DOWN:case module$exports$Blockly$utils$KeyCodes_KeyCodes.END:this.highlightLast_();break;default:return}a.preventDefault(),a.stopPropagation()}},module$exports$Blockly$Menu.Menu.prototype.getSize=function(){var a=this.getElement(),b=(0,module$exports$Blockly$utils$style.getSize)(a);return b.height=a.scrollHeight,b};var module$exports$Blockly$serialization$priorities={VARIABLES:100,BLOCKS:50},module$exports$Blockly$serialization$registry={register:function(a,b){(0,module$exports$Blockly$registry.register)(module$exports$Blockly$registry.Type.SERIALIZER,a,b)},unregister:function(a){(0,module$exports$Blockly$registry.unregister)(module$exports$Blockly$registry.Type.SERIALIZER,a)}},module$exports$Blockly$serialization$exceptions={DeserializationError:function(){var a=Error.apply(this,arguments);this.message=a.message,"stack"in a&&(this.stack=a.stack)}};$jscomp.inherits(module$exports$Blockly$serialization$exceptions.DeserializationError,Error),module$exports$Blockly$serialization$exceptions.MissingBlockType=function(a){module$exports$Blockly$serialization$exceptions.DeserializationError.call(this,"Expected to find a 'type' property, defining the block type"),this.state=a},$jscomp.inherits(module$exports$Blockly$serialization$exceptions.MissingBlockType,module$exports$Blockly$serialization$exceptions.DeserializationError),module$exports$Blockly$serialization$exceptions.MissingConnection=function(a,b,c){module$exports$Blockly$serialization$exceptions.DeserializationError.call(this,"The block "+b.toDevString()+" is missing a(n) "+a+"\nconnection"),this.block=b,this.state=c},$jscomp.inherits(module$exports$Blockly$serialization$exceptions.MissingConnection,module$exports$Blockly$serialization$exceptions.DeserializationError),module$exports$Blockly$serialization$exceptions.BadConnectionCheck=function(a,b,c,d){module$exports$Blockly$serialization$exceptions.DeserializationError.call(this,"The block "+c.toDevString()+" could not connect its\n"+b+" to its parent, because: "+a),this.childBlock=c,this.childState=d},$jscomp.inherits(module$exports$Blockly$serialization$exceptions.BadConnectionCheck,module$exports$Blockly$serialization$exceptions.DeserializationError),module$exports$Blockly$serialization$exceptions.RealChildOfShadow=function(a){module$exports$Blockly$serialization$exceptions.DeserializationError.call(this,"Encountered a real block which is defined as a child of a shadow\nblock. It is an invariant of Blockly that shadow blocks only have shadow\nchildren"),this.state=a},$jscomp.inherits(module$exports$Blockly$serialization$exceptions.RealChildOfShadow,module$exports$Blockly$serialization$exceptions.DeserializationError);var module$exports$Blockly$serialization$ISerializer={ISerializer:function(){}};module$exports$Blockly$serialization$ISerializer.ISerializer.prototype.save=function(a){},module$exports$Blockly$serialization$ISerializer.ISerializer.prototype.load=function(a,b){},module$exports$Blockly$serialization$ISerializer.ISerializer.prototype.clear=function(a){};var module$exports$Blockly$serialization$blocks={save:function(a,b){var c=void 0===b?{}:b;b=void 0!==c.addCoordinates&&c.addCoordinates;var d=void 0===c.addInputBlocks||c.addInputBlocks,e=void 0===c.addNextBlocks||c.addNextBlocks;if(c=void 0===c.doFullSerialization||c.doFullSerialization,a.isInsertionMarker())return null;var f={type:a.type,id:a.id};return b&&module$contents$Blockly$serialization$blocks_saveCoords(a,f),module$contents$Blockly$serialization$blocks_saveAttributes(a,f),module$contents$Blockly$serialization$blocks_saveExtraState(a,f),module$contents$Blockly$serialization$blocks_saveIcons(a,f),module$contents$Blockly$serialization$blocks_saveFields(a,f,c),d&&module$contents$Blockly$serialization$blocks_saveInputBlocks(a,f,c),e&&module$contents$Blockly$serialization$blocks_saveNextBlocks(a,f,c),f}},module$contents$Blockly$serialization$blocks_saveAttributes=function(a,b){a.isCollapsed()&&(b.collapsed=!0),a.isEnabled()||(b.enabled=!1),void 0!==a.inputsInline&&a.inputsInline!==a.inputsInlineDefault&&(b.inline=a.inputsInline),a.data&&(b.data=a.data)},module$contents$Blockly$serialization$blocks_saveCoords=function(a,b){var c=a.workspace;a=a.getRelativeToSurfaceXY(),b.x=Math.round(c.RTL?c.getWidth()-a.x:a.x),b.y=Math.round(a.y)},module$contents$Blockly$serialization$blocks_saveExtraState=function(a,b){a.saveExtraState?null!==(a=a.saveExtraState())&&(b.extraState=a):a.mutationToDom&&null!==(a=a.mutationToDom())&&(b.extraState=(0,$.module$exports$Blockly$Xml.domToText)(a).replace(' xmlns="https://developers.google.com/blockly/xml"',""))},module$contents$Blockly$serialization$blocks_saveIcons=function(a,b){a.getCommentText()&&(b.icons={comment:{text:a.getCommentText(),pinned:a.commentModel.pinned,height:Math.round(a.commentModel.size.height),width:Math.round(a.commentModel.size.width)}})},module$contents$Blockly$serialization$blocks_saveFields=function(a,b,c){for(var d=Object.create(null),e=0;e<a.inputList.length;e++)for(var f=a.inputList[e],g=0;g<f.fieldRow.length;g++){var h=f.fieldRow[g];h.isSerializable()&&(d[h.name]=h.saveState(c))}Object.keys(d).length&&(b.fields=d)},module$contents$Blockly$serialization$blocks_saveInputBlocks=function(a,b,c){for(var d=Object.create(null),e=0;e<a.inputList.length;e++){var f=a.inputList[e];if(f.type!==$.module$exports$Blockly$inputTypes.inputTypes.DUMMY){var g=module$contents$Blockly$serialization$blocks_saveConnection(f.connection,c);g&&(d[f.name]=g)}}Object.keys(d).length&&(b.inputs=d)},module$contents$Blockly$serialization$blocks_saveNextBlocks=function(a,b,c){a.nextConnection&&(a=module$contents$Blockly$serialization$blocks_saveConnection(a.nextConnection,c))&&(b.next=a)},module$contents$Blockly$serialization$blocks_saveConnection=function(a,b){var c=a.getShadowState(!0);if(a=a.targetBlock(),!c&&!a)return null;var d=Object.create(null);return c&&(d.shadow=c),a&&!a.isShadow()&&(d.block=(0,module$exports$Blockly$serialization$blocks.save)(a,{doFullSerialization:b})),d};module$exports$Blockly$serialization$blocks.append=function(a,b,c){return c=void 0===c?{}:c,(0,module$exports$Blockly$serialization$blocks.appendInternal)(a,b,{recordUndo:void 0!==c.recordUndo&&c.recordUndo})},module$exports$Blockly$serialization$blocks.appendInternal=function(a,b,c){var d=void 0===c?{}:c;c=void 0===d.parentConnection?void 0:d.parentConnection;var e=void 0!==d.isShadow&&d.isShadow,f=void 0!==d.recordUndo&&d.recordUndo;d=(0,module$exports$Blockly$Events$utils.getRecordUndo)(),(0,module$exports$Blockly$Events$utils.setRecordUndo)(f),(f=(0,module$exports$Blockly$Events$utils.getGroup)())||(0,module$exports$Blockly$Events$utils.setGroup)(!0),(0,module$exports$Blockly$Events$utils.disable)();var g=module$contents$Blockly$serialization$blocks_appendPrivate(a,b,{parentConnection:c,isShadow:e});return(0,module$exports$Blockly$Events$utils.enable)(),(0,module$exports$Blockly$Events$utils.fire)(new((0,module$exports$Blockly$Events$utils.get)(module$exports$Blockly$Events$utils.CREATE))(g)),(0,module$exports$Blockly$Events$utils.setGroup)(f),(0,module$exports$Blockly$Events$utils.setRecordUndo)(d),b.rendered&&setTimeout((function(){g.disposed||g.setConnectionTracking(!0)}),1),g};var module$contents$Blockly$serialization$blocks_appendPrivate=function(a,b,c){var d=void 0===c?{}:c;if(c=void 0===d.parentConnection?void 0:d.parentConnection,d=void 0!==d.isShadow&&d.isShadow,!a.type)throw new module$exports$Blockly$serialization$exceptions.MissingBlockType(a);var e=b.newBlock(a.type,a.id);return e.setShadow(d),module$contents$Blockly$serialization$blocks_loadCoords(e,a),module$contents$Blockly$serialization$blocks_loadAttributes(e,a),module$contents$Blockly$serialization$blocks_loadExtraState(e,a),module$contents$Blockly$serialization$blocks_tryToConnectParent(c,e,a),module$contents$Blockly$serialization$blocks_loadIcons(e,a),module$contents$Blockly$serialization$blocks_loadFields(e,a),module$contents$Blockly$serialization$blocks_loadInputBlocks(e,a),module$contents$Blockly$serialization$blocks_loadNextBlocks(e,a),module$contents$Blockly$serialization$blocks_initBlock(e,b.rendered),e},module$contents$Blockly$serialization$blocks_loadCoords=function(a,b){var c=void 0===b.x?0:b.x;b=void 0===b.y?0:b.y;var d=a.workspace;c=d.RTL?d.getWidth()-c:c,a.moveBy(c,b)},module$contents$Blockly$serialization$blocks_loadAttributes=function(a,b){b.collapsed&&a.setCollapsed(!0),!1===b.enabled&&a.setEnabled(!1),void 0!==b.inline&&a.setInputsInline(b.inline),void 0!==b.data&&(a.data=b.data)},module$contents$Blockly$serialization$blocks_loadExtraState=function(a,b){b.extraState&&(a.loadExtraState?a.loadExtraState(b.extraState):a.domToMutation((0,$.module$exports$Blockly$Xml.textToDom)(b.extraState)))},module$contents$Blockly$serialization$blocks_tryToConnectParent=function(a,b,c){if(a){if(a.getSourceBlock().isShadow()&&!b.isShadow())throw new module$exports$Blockly$serialization$exceptions.RealChildOfShadow(c);if(a.type===$.module$exports$Blockly$inputTypes.inputTypes.VALUE){var d=b.outputConnection;if(!d)throw new module$exports$Blockly$serialization$exceptions.MissingConnection("output",b,c)}else if(!(d=b.previousConnection))throw new module$exports$Blockly$serialization$exceptions.MissingConnection("previous",b,c);if(!a.connect(d)){var e=b.workspace.connectionChecker;throw new module$exports$Blockly$serialization$exceptions.BadConnectionCheck(e.getErrorMessage(e.canConnectWithReason(d,a,!1),d,a),a.type===$.module$exports$Blockly$inputTypes.inputTypes.VALUE?"output connection":"previous connection",b,c)}}},module$contents$Blockly$serialization$blocks_loadIcons=function(a,b){b.icons&&(b=b.icons.comment)&&(a.setCommentText(b.text),a.commentModel.pinned=b.pinned,a.commentModel.size=new module$exports$Blockly$utils$Size.Size(b.width,b.height),b.pinned&&a.getCommentIcon&&!a.isInFlyout&&setTimeout((function(){return a.getCommentIcon().setVisible(!0)}),1))},module$contents$Blockly$serialization$blocks_loadFields=function(a,b){if(b.fields)for(var c=Object.keys(b.fields),d=0;d<c.length;d++){var e=c[d],f=b.fields[e],g=a.getField(e);g?g.loadState(f):console.warn("Ignoring non-existant field "+e+" in block "+a.type)}},module$contents$Blockly$serialization$blocks_loadInputBlocks=function(a,b){if(b.inputs)for(var c=Object.keys(b.inputs),d=0;d<c.length;d++){var e=c[d],f=a.getInput(e);if(!f||!f.connection)throw new module$exports$Blockly$serialization$exceptions.MissingConnection(e,a,b);module$contents$Blockly$serialization$blocks_loadConnection(f.connection,b.inputs[e])}},module$contents$Blockly$serialization$blocks_loadNextBlocks=function(a,b){if(b.next){if(!a.nextConnection)throw new module$exports$Blockly$serialization$exceptions.MissingConnection("next",a,b);module$contents$Blockly$serialization$blocks_loadConnection(a.nextConnection,b.next)}},module$contents$Blockly$serialization$blocks_loadConnection=function(a,b){b.shadow&&a.setShadowState(b.shadow),b.block&&module$contents$Blockly$serialization$blocks_appendPrivate(b.block,a.getSourceBlock().workspace,{parentConnection:a})},module$contents$Blockly$serialization$blocks_initBlock=function(a,b){b?(a.setConnectionTracking(!1),a.initSvg(),a.render(!1)):a.initModel()},module$contents$Blockly$serialization$blocks_saveBlock=module$exports$Blockly$serialization$blocks.save,module$contents$Blockly$serialization$blocks_BlockSerializer=function(){this.priority=module$exports$Blockly$serialization$priorities.BLOCKS};module$contents$Blockly$serialization$blocks_BlockSerializer.prototype.save=function(a){for(var b=[],c=(a=$jscomp.makeIterator(a.getTopBlocks(!1))).next();!c.done;c=a.next())(c=module$contents$Blockly$serialization$blocks_saveBlock(c.value,{addCoordinates:!0,doFullSerialization:!1}))&&b.push(c);return b.length?{languageVersion:0,blocks:b}:null},module$contents$Blockly$serialization$blocks_BlockSerializer.prototype.load=function(a,b){for(var c=(a=$jscomp.makeIterator(a.blocks)).next();!c.done;c=a.next())(0,module$exports$Blockly$serialization$blocks.append)(c.value,b,{recordUndo:(0,module$exports$Blockly$Events$utils.getRecordUndo)()})},module$contents$Blockly$serialization$blocks_BlockSerializer.prototype.clear=function(a){for(var b=(a=$jscomp.makeIterator(a.getTopBlocks(!1))).next();!b.done;b=a.next())b.value.dispose(!1)},(0,module$exports$Blockly$serialization$registry.register)("blocks",new module$contents$Blockly$serialization$blocks_BlockSerializer);var module$exports$Blockly$Events$Abstract=function(){this.isBlank=null,this.workspaceId=void 0,this.group=(0,module$exports$Blockly$Events$utils.getGroup)(),this.recordUndo=(0,module$exports$Blockly$Events$utils.getRecordUndo)()};module$exports$Blockly$Events$Abstract.prototype.isUiEvent=!1,module$exports$Blockly$Events$Abstract.prototype.toJson=function(){var a={type:this.type};return this.group&&(a.group=this.group),a},module$exports$Blockly$Events$Abstract.prototype.fromJson=function(a){this.isBlank=!1,this.group=a.group},module$exports$Blockly$Events$Abstract.prototype.isNull=function(){return!1},module$exports$Blockly$Events$Abstract.prototype.run=function(a){},module$exports$Blockly$Events$Abstract.prototype.getEventWorkspace_=function(){var a;if(this.workspaceId&&(a=module$exports$Blockly$Workspace.Workspace.getById(this.workspaceId)),!a)throw Error("Workspace is null. Event must have been generated from real Blockly events.");return a};var module$exports$Blockly$Events$BlockBase={BlockBase:function(a){module$exports$Blockly$Events$BlockBase.BlockBase.superClass_.constructor.call(this),this.blockId=(this.isBlank=void 0===a)?"":a.id,this.workspaceId=this.isBlank?"":a.workspace.id}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$Events$BlockBase.BlockBase,module$exports$Blockly$Events$Abstract),module$exports$Blockly$Events$BlockBase.BlockBase.prototype.toJson=function(){var a=module$exports$Blockly$Events$BlockBase.BlockBase.superClass_.toJson.call(this);return a.blockId=this.blockId,a},module$exports$Blockly$Events$BlockBase.BlockBase.prototype.fromJson=function(a){module$exports$Blockly$Events$BlockBase.BlockBase.superClass_.fromJson.call(this,a),this.blockId=a.blockId};var module$contents$Blockly$ContextMenu_currentBlock,module$exports$Blockly$Events$BlockCreate={BlockCreate:function(a){module$exports$Blockly$Events$BlockCreate.BlockCreate.superClass_.constructor.call(this,a),a&&(a.isShadow()&&(this.recordUndo=!1),this.xml=(0,$.module$exports$Blockly$Xml.blockToDomWithXY)(a),this.ids=(0,module$exports$Blockly$Events$utils.getDescendantIds)(a),this.json=(0,module$exports$Blockly$serialization$blocks.save)(a,{addCoordinates:!0}))}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$Events$BlockCreate.BlockCreate,module$exports$Blockly$Events$BlockBase.BlockBase),module$exports$Blockly$Events$BlockCreate.BlockCreate.prototype.type=module$exports$Blockly$Events$utils.CREATE,module$exports$Blockly$Events$BlockCreate.BlockCreate.prototype.toJson=function(){var a=module$exports$Blockly$Events$BlockCreate.BlockCreate.superClass_.toJson.call(this);return a.xml=(0,$.module$exports$Blockly$Xml.domToText)(this.xml),a.ids=this.ids,a.json=this.json,this.recordUndo||(a.recordUndo=this.recordUndo),a},module$exports$Blockly$Events$BlockCreate.BlockCreate.prototype.fromJson=function(a){module$exports$Blockly$Events$BlockCreate.BlockCreate.superClass_.fromJson.call(this,a),this.xml=(0,$.module$exports$Blockly$Xml.textToDom)(a.xml),this.ids=a.ids,this.json=a.json,void 0!==a.recordUndo&&(this.recordUndo=a.recordUndo)},module$exports$Blockly$Events$BlockCreate.BlockCreate.prototype.run=function(a){var b=this.getEventWorkspace_();if(a)(0,module$exports$Blockly$serialization$blocks.append)(this.json,b);else for(a=0;a<this.ids.length;a++){var c=this.ids[a],d=b.getBlockById(c);d?d.dispose(!1):c===this.blockId&&console.warn("Can't uncreate non-existent block: "+c)}},(0,module$exports$Blockly$registry.register)(module$exports$Blockly$registry.Type.EVENT,module$exports$Blockly$Events$utils.CREATE,module$exports$Blockly$Events$BlockCreate.BlockCreate),$.module$exports$Blockly$ContextMenu={},module$contents$Blockly$ContextMenu_currentBlock=null,$.module$exports$Blockly$ContextMenu.getCurrentBlock=function(){return module$contents$Blockly$ContextMenu_currentBlock},$.module$exports$Blockly$ContextMenu.setCurrentBlock=function(a){module$contents$Blockly$ContextMenu_currentBlock=a},Object.defineProperties($.module$exports$Blockly$ContextMenu,{currentBlock:{get:function(){return(0,module$exports$Blockly$utils$deprecation.warn)("Blockly.ContextMenu.currentBlock","September 2021","September 2022","Blockly.Tooltip.getCurrentBlock()"),(0,$.module$exports$Blockly$ContextMenu.getCurrentBlock)()},set:function(a){(0,module$exports$Blockly$utils$deprecation.warn)("Blockly.ContextMenu.currentBlock","September 2021","September 2022","Blockly.Tooltip.setCurrentBlock(block)"),(0,$.module$exports$Blockly$ContextMenu.setCurrentBlock)(a)}}});var module$contents$Blockly$ContextMenu_menu_=null;$.module$exports$Blockly$ContextMenu.show=function(a,b,c){if((0,module$exports$Blockly$WidgetDiv.show)($.module$exports$Blockly$ContextMenu,c,$.module$exports$Blockly$ContextMenu.dispose),b.length){var d=module$contents$Blockly$ContextMenu_populate_(b,c);module$contents$Blockly$ContextMenu_menu_=d,module$contents$Blockly$ContextMenu_position_(d,a,c),setTimeout((function(){d.focus()}),1),module$contents$Blockly$ContextMenu_currentBlock=null}else(0,$.module$exports$Blockly$ContextMenu.hide)()};var module$contents$Blockly$ContextMenu_populate_=function(a,b){var c=new module$exports$Blockly$Menu.Menu;c.setRole(module$exports$Blockly$utils$aria.Role.MENU);for(var d=0;d<a.length;d++){var e=a[d],f=new module$exports$Blockly$MenuItem.MenuItem(e.text);f.setRightToLeft(b),f.setRole(module$exports$Blockly$utils$aria.Role.MENUITEM),c.addChild(f),f.setEnabled(e.enabled),e.enabled&&f.onAction((function(g){(0,$.module$exports$Blockly$ContextMenu.hide)(),this.callback(this.scope)}),e)}return c},module$contents$Blockly$ContextMenu_position_=function(a,b,c){var d=(0,module$exports$Blockly$utils$svgMath.getViewportBBox)();b=new module$exports$Blockly$utils$Rect.Rect(b.clientY+d.top,b.clientY+d.top,b.clientX+d.left,b.clientX+d.left),module$contents$Blockly$ContextMenu_createWidget_(a);var e=a.getSize();c&&(b.left+=e.width,b.right+=e.width,d.left+=e.width,d.right+=e.width),(0,module$exports$Blockly$WidgetDiv.positionWithAnchor)(d,b,e,c),a.focus()},module$contents$Blockly$ContextMenu_createWidget_=function(a){var b=(0,module$exports$Blockly$WidgetDiv.getDiv)();if(!b)throw Error("Attempting to create a context menu when widget div is null");a.render(b),b=a.getElement(),(0,module$exports$Blockly$utils$dom.addClass)(b,"blocklyContextMenu"),(0,module$exports$Blockly$browserEvents.conditionalBind)(b,"contextmenu",null,module$contents$Blockly$ContextMenu_haltPropagation),a.focus()},module$contents$Blockly$ContextMenu_haltPropagation=function(a){a.preventDefault(),a.stopPropagation()};$.module$exports$Blockly$ContextMenu.hide=function(){(0,module$exports$Blockly$WidgetDiv.hideIfOwner)($.module$exports$Blockly$ContextMenu),module$contents$Blockly$ContextMenu_currentBlock=null},$.module$exports$Blockly$ContextMenu.dispose=function(){module$contents$Blockly$ContextMenu_menu_&&(module$contents$Blockly$ContextMenu_menu_.dispose(),module$contents$Blockly$ContextMenu_menu_=null)},$.module$exports$Blockly$ContextMenu.callbackFactory=function(a,b){return function(){(0,module$exports$Blockly$Events$utils.disable)();try{var c=(0,$.module$exports$Blockly$Xml.domToBlock)(b,a.workspace),d=a.getRelativeToSurfaceXY();d.x=a.RTL?d.x-$.module$exports$Blockly$internalConstants.SNAP_RADIUS:d.x+$.module$exports$Blockly$internalConstants.SNAP_RADIUS,d.y+=2*$.module$exports$Blockly$internalConstants.SNAP_RADIUS,c.moveBy(d.x,d.y)}finally{(0,module$exports$Blockly$Events$utils.enable)()}(0,module$exports$Blockly$Events$utils.isEnabled)()&&!c.isShadow()&&(0,module$exports$Blockly$Events$utils.fire)(new((0,module$exports$Blockly$Events$utils.get)(module$exports$Blockly$Events$utils.CREATE))(c)),c.select()}},$.module$exports$Blockly$ContextMenu.commentDeleteOption=function(a){return{text:$.module$exports$Blockly$Msg.Msg.REMOVE_COMMENT,enabled:!0,callback:function(){(0,module$exports$Blockly$Events$utils.setGroup)(!0),a.dispose(),(0,module$exports$Blockly$Events$utils.setGroup)(!1)}}},$.module$exports$Blockly$ContextMenu.commentDuplicateOption=function(a){return{text:$.module$exports$Blockly$Msg.Msg.DUPLICATE_COMMENT,enabled:!0,callback:function(){(0,module$exports$Blockly$clipboard.duplicate)(a)}}},$.module$exports$Blockly$ContextMenu.workspaceCommentOption=function(a,b){var c=module$exports$Blockly$WorkspaceCommentSvg;if(!c)throw Error("Missing require for Blockly.WorkspaceCommentSvg");var d={enabled:!module$exports$Blockly$utils$userAgent.IE};return d.text=$.module$exports$Blockly$Msg.Msg.ADD_COMMENT,d.callback=function(){var e=new c(a,$.module$exports$Blockly$Msg.Msg.WORKSPACE_COMMENT_DEFAULT_TEXT,c.DEFAULT_SIZE,c.DEFAULT_SIZE),f=a.getInjectionDiv().getBoundingClientRect();f=new module$exports$Blockly$utils$Coordinate.Coordinate(b.clientX-f.left,b.clientY-f.top);var g=a.getOriginOffsetInPixels();(f=module$exports$Blockly$utils$Coordinate.Coordinate.difference(f,g)).scale(1/a.scale),e.moveBy(f.x,f.y),a.rendered&&(e.initSvg(),e.render(),e.select())},d};var module$exports$Blockly$utils$array_removeElem=function(a,b){return-1!==(b=a.indexOf(b))&&(a.splice(b,1),!0)},module$exports$Blockly$blockRendering$debug={},module$contents$Blockly$blockRendering$debug_useDebugger=!1;module$exports$Blockly$blockRendering$debug.isDebuggerEnabled=function(){return module$contents$Blockly$blockRendering$debug_useDebugger},module$exports$Blockly$blockRendering$debug.startDebugger=function(){module$contents$Blockly$blockRendering$debug_useDebugger=!0},module$exports$Blockly$blockRendering$debug.stopDebugger=function(){module$contents$Blockly$blockRendering$debug_useDebugger=!1};var module$exports$Blockly$blockRendering$Types={Types:{NONE:0,FIELD:1,HAT:2,ICON:4,SPACER:8,BETWEEN_ROW_SPACER:16,IN_ROW_SPACER:32,EXTERNAL_VALUE_INPUT:64,INPUT:128,INLINE_INPUT:256,STATEMENT_INPUT:512,CONNECTION:1024,PREVIOUS_CONNECTION:2048,NEXT_CONNECTION:4096,OUTPUT_CONNECTION:8192,CORNER:16384,LEFT_SQUARE_CORNER:32768,LEFT_ROUND_CORNER:65536,RIGHT_SQUARE_CORNER:131072,RIGHT_ROUND_CORNER:262144,JAGGED_EDGE:524288,ROW:1048576,TOP_ROW:2097152,BOTTOM_ROW:4194304,INPUT_ROW:8388608}};module$exports$Blockly$blockRendering$Types.Types.LEFT_CORNER=module$exports$Blockly$blockRendering$Types.Types.LEFT_SQUARE_CORNER|module$exports$Blockly$blockRendering$Types.Types.LEFT_ROUND_CORNER,module$exports$Blockly$blockRendering$Types.Types.RIGHT_CORNER=module$exports$Blockly$blockRendering$Types.Types.RIGHT_SQUARE_CORNER|module$exports$Blockly$blockRendering$Types.Types.RIGHT_ROUND_CORNER,module$exports$Blockly$blockRendering$Types.Types.nextTypeValue_=16777216,module$exports$Blockly$blockRendering$Types.Types.getType=function(a){return Object.prototype.hasOwnProperty.call(module$exports$Blockly$blockRendering$Types.Types,a)||(module$exports$Blockly$blockRendering$Types.Types[a]=module$exports$Blockly$blockRendering$Types.Types.nextTypeValue_,module$exports$Blockly$blockRendering$Types.Types.nextTypeValue_<<=1),module$exports$Blockly$blockRendering$Types.Types[a]},module$exports$Blockly$blockRendering$Types.Types.isField=function(a){return a.type&module$exports$Blockly$blockRendering$Types.Types.FIELD},module$exports$Blockly$blockRendering$Types.Types.isHat=function(a){return a.type&module$exports$Blockly$blockRendering$Types.Types.HAT},module$exports$Blockly$blockRendering$Types.Types.isIcon=function(a){return a.type&module$exports$Blockly$blockRendering$Types.Types.ICON},module$exports$Blockly$blockRendering$Types.Types.isSpacer=function(a){return a.type&module$exports$Blockly$blockRendering$Types.Types.SPACER},module$exports$Blockly$blockRendering$Types.Types.isInRowSpacer=function(a){return a.type&module$exports$Blockly$blockRendering$Types.Types.IN_ROW_SPACER},module$exports$Blockly$blockRendering$Types.Types.isInput=function(a){return a.type&module$exports$Blockly$blockRendering$Types.Types.INPUT},module$exports$Blockly$blockRendering$Types.Types.isExternalInput=function(a){return a.type&module$exports$Blockly$blockRendering$Types.Types.EXTERNAL_VALUE_INPUT},module$exports$Blockly$blockRendering$Types.Types.isInlineInput=function(a){return a.type&module$exports$Blockly$blockRendering$Types.Types.INLINE_INPUT},module$exports$Blockly$blockRendering$Types.Types.isStatementInput=function(a){return a.type&module$exports$Blockly$blockRendering$Types.Types.STATEMENT_INPUT},module$exports$Blockly$blockRendering$Types.Types.isPreviousConnection=function(a){return a.type&module$exports$Blockly$blockRendering$Types.Types.PREVIOUS_CONNECTION},module$exports$Blockly$blockRendering$Types.Types.isNextConnection=function(a){return a.type&module$exports$Blockly$blockRendering$Types.Types.NEXT_CONNECTION},module$exports$Blockly$blockRendering$Types.Types.isPreviousOrNextConnection=function(a){return a.type&(module$exports$Blockly$blockRendering$Types.Types.PREVIOUS_CONNECTION|module$exports$Blockly$blockRendering$Types.Types.NEXT_CONNECTION)},module$exports$Blockly$blockRendering$Types.Types.isLeftRoundedCorner=function(a){return a.type&module$exports$Blockly$blockRendering$Types.Types.LEFT_ROUND_CORNER},module$exports$Blockly$blockRendering$Types.Types.isRightRoundedCorner=function(a){return a.type&module$exports$Blockly$blockRendering$Types.Types.RIGHT_ROUND_CORNER},module$exports$Blockly$blockRendering$Types.Types.isLeftSquareCorner=function(a){return a.type&module$exports$Blockly$blockRendering$Types.Types.LEFT_SQUARE_CORNER},module$exports$Blockly$blockRendering$Types.Types.isRightSquareCorner=function(a){return a.type&module$exports$Blockly$blockRendering$Types.Types.RIGHT_SQUARE_CORNER},module$exports$Blockly$blockRendering$Types.Types.isCorner=function(a){return a.type&module$exports$Blockly$blockRendering$Types.Types.CORNER},module$exports$Blockly$blockRendering$Types.Types.isJaggedEdge=function(a){return a.type&module$exports$Blockly$blockRendering$Types.Types.JAGGED_EDGE},module$exports$Blockly$blockRendering$Types.Types.isRow=function(a){return a.type&module$exports$Blockly$blockRendering$Types.Types.ROW},module$exports$Blockly$blockRendering$Types.Types.isBetweenRowSpacer=function(a){return a.type&module$exports$Blockly$blockRendering$Types.Types.BETWEEN_ROW_SPACER},module$exports$Blockly$blockRendering$Types.Types.isTopRow=function(a){return a.type&module$exports$Blockly$blockRendering$Types.Types.TOP_ROW},module$exports$Blockly$blockRendering$Types.Types.isBottomRow=function(a){return a.type&module$exports$Blockly$blockRendering$Types.Types.BOTTOM_ROW},module$exports$Blockly$blockRendering$Types.Types.isTopOrBottomRow=function(a){return a.type&(module$exports$Blockly$blockRendering$Types.Types.TOP_ROW|module$exports$Blockly$blockRendering$Types.Types.BOTTOM_ROW)},module$exports$Blockly$blockRendering$Types.Types.isInputRow=function(a){return a.type&module$exports$Blockly$blockRendering$Types.Types.INPUT_ROW};var module$exports$Blockly$blockRendering$Row={Row:function(a){this.type=module$exports$Blockly$blockRendering$Types.Types.ROW,this.elements=[],this.xPos=this.yPos=this.widthWithConnectedBlocks=this.minWidth=this.minHeight=this.width=this.height=0,this.hasJaggedEdge=this.hasDummyInput=this.hasInlineInput=this.hasStatement=this.hasExternalInput=!1,this.constants_=a,this.notchOffset=this.constants_.NOTCH_OFFSET_LEFT,this.align=null}};module$exports$Blockly$blockRendering$Row.Row.prototype.getLastInput=function(){for(var a=this.elements.length-1;0<=a;a--){var b=this.elements[a];if(module$exports$Blockly$blockRendering$Types.Types.isInput(b))return b}return null},module$exports$Blockly$blockRendering$Row.Row.prototype.measure=function(){throw Error("Unexpected attempt to measure a base Row.")},module$exports$Blockly$blockRendering$Row.Row.prototype.startsWithElemSpacer=function(){return!0},module$exports$Blockly$blockRendering$Row.Row.prototype.endsWithElemSpacer=function(){return!0},module$exports$Blockly$blockRendering$Row.Row.prototype.getFirstSpacer=function(){for(var a=0;a<this.elements.length;a++){var b=this.elements[a];if(module$exports$Blockly$blockRendering$Types.Types.isSpacer(b))return b}return null},module$exports$Blockly$blockRendering$Row.Row.prototype.getLastSpacer=function(){for(var a=this.elements.length-1;0<=a;a--){var b=this.elements[a];if(module$exports$Blockly$blockRendering$Types.Types.isSpacer(b))return b}return null};var module$exports$Blockly$blockRendering$BottomRow={BottomRow:function(a){module$exports$Blockly$blockRendering$BottomRow.BottomRow.superClass_.constructor.call(this,a),this.type|=module$exports$Blockly$blockRendering$Types.Types.BOTTOM_ROW,this.hasNextConnection=!1,this.connection=null,this.baseline=this.descenderHeight=0}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$blockRendering$BottomRow.BottomRow,module$exports$Blockly$blockRendering$Row.Row),module$exports$Blockly$blockRendering$BottomRow.BottomRow.prototype.hasLeftSquareCorner=function(a){return!!a.outputConnection||!!a.getNextBlock()},module$exports$Blockly$blockRendering$BottomRow.BottomRow.prototype.hasRightSquareCorner=function(a){return!0},module$exports$Blockly$blockRendering$BottomRow.BottomRow.prototype.measure=function(){for(var a=0,b=0,c=0,d=0;d<this.elements.length;d++){var e=this.elements[d];b+=e.width,module$exports$Blockly$blockRendering$Types.Types.isSpacer(e)||(module$exports$Blockly$blockRendering$Types.Types.isNextConnection(e)?c=Math.max(c,e.height):a=Math.max(a,e.height))}this.width=Math.max(this.minWidth,b),this.height=Math.max(this.minHeight,a)+c,this.descenderHeight=c,this.widthWithConnectedBlocks=this.width},module$exports$Blockly$blockRendering$BottomRow.BottomRow.prototype.startsWithElemSpacer=function(){return!1},module$exports$Blockly$blockRendering$BottomRow.BottomRow.prototype.endsWithElemSpacer=function(){return!1};var module$exports$Blockly$blockRendering$Measurable_Measurable=function(a){this.height=this.width=0,this.type=module$exports$Blockly$blockRendering$Types.Types.NONE,this.centerline=this.xPos=0,this.constants_=a,this.notchOffset=this.constants_.NOTCH_OFFSET_LEFT},module$exports$Blockly$blockRendering$Connection={Connection:function(a,b){module$exports$Blockly$blockRendering$Connection.Connection.superClass_.constructor.call(this,a),this.connectionModel=b,this.shape=this.constants_.shapeFor(b),this.isDynamicShape=!!this.shape.isDynamic,this.type|=module$exports$Blockly$blockRendering$Types.Types.CONNECTION}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$blockRendering$Connection.Connection,module$exports$Blockly$blockRendering$Measurable_Measurable);var module$exports$Blockly$utils$colour={},module$contents$Blockly$utils$colour_hsvSaturation=.45;module$exports$Blockly$utils$colour.getHsvSaturation=function(){return module$contents$Blockly$utils$colour_hsvSaturation},module$exports$Blockly$utils$colour.setHsvSaturation=function(a){module$contents$Blockly$utils$colour_hsvSaturation=a};var module$contents$Blockly$utils$colour_hsvValue=.65;module$exports$Blockly$utils$colour.getHsvValue=function(){return module$contents$Blockly$utils$colour_hsvValue},module$exports$Blockly$utils$colour.setHsvValue=function(a){module$contents$Blockly$utils$colour_hsvValue=a},module$exports$Blockly$utils$colour.parse=function(a){a=String(a).toLowerCase().trim();var b=module$exports$Blockly$utils$colour.names[a];if(b)return b;if(b="#"===(b="0x"===a.substring(0,2)?"#"+a.substring(2):a)[0]?b:"#"+b,/^#[0-9a-f]{6}$/.test(b))return b;if(/^#[0-9a-f]{3}$/.test(b))return["#",b[1],b[1],b[2],b[2],b[3],b[3]].join("");var c=a.match(/^(?:rgb)?\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/);return c&&(a=Number(c[1]),b=Number(c[2]),c=Number(c[3]),0<=a&&256>a&&0<=b&&256>b&&0<=c&&256>c)?(0,module$exports$Blockly$utils$colour.rgbToHex)(a,b,c):null},module$exports$Blockly$utils$colour.rgbToHex=function(a,b,c){return b=a<<16|b<<8|c,16>a?"#"+(16777216|b).toString(16).substr(1):"#"+b.toString(16)},module$exports$Blockly$utils$colour.hexToRgb=function(a){return(a=(0,module$exports$Blockly$utils$colour.parse)(a))?[(a=parseInt(a.substr(1),16))>>16,a>>8&255,255&a]:[0,0,0]},module$exports$Blockly$utils$colour.hsvToHex=function(a,b,c){var d=0,e=0,f=0;if(0===b)f=e=d=c;else{var g=Math.floor(a/60),h=a/60-g;a=c*(1-b);var k=c*(1-b*h);switch(b=c*(1-b*(1-h)),g){case 1:d=k,e=c,f=a;break;case 2:d=a,e=c,f=b;break;case 3:d=a,e=k,f=c;break;case 4:d=b,e=a,f=c;break;case 5:d=c,e=a,f=k;break;case 6:case 0:d=c,e=b,f=a}}return(0,module$exports$Blockly$utils$colour.rgbToHex)(Math.floor(d),Math.floor(e),Math.floor(f))},module$exports$Blockly$utils$colour.blend=function(a,b,c){return(a=(0,module$exports$Blockly$utils$colour.parse)(a))&&(b=(0,module$exports$Blockly$utils$colour.parse)(b))?(a=(0,module$exports$Blockly$utils$colour.hexToRgb)(a),b=(0,module$exports$Blockly$utils$colour.hexToRgb)(b),(0,module$exports$Blockly$utils$colour.rgbToHex)(Math.round(b[0]+c*(a[0]-b[0])),Math.round(b[1]+c*(a[1]-b[1])),Math.round(b[2]+c*(a[2]-b[2])))):null},module$exports$Blockly$utils$colour.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00"},module$exports$Blockly$utils$colour.hueToHex=function(a){return(0,module$exports$Blockly$utils$colour.hsvToHex)(a,module$contents$Blockly$utils$colour_hsvSaturation,255*module$contents$Blockly$utils$colour_hsvValue)};var module$exports$Blockly$utils$svgPaths={point:function(a,b){return" "+a+","+b+" "},curve:function(a,b){return" "+a+b.join("")},moveTo:function(a,b){return" M "+a+","+b+" "},moveBy:function(a,b){return" m "+a+","+b+" "},lineTo:function(a,b){return" l "+a+","+b+" "},line:function(a){return" l"+a.join("")},lineOnAxis:function(a,b){return" "+a+" "+b+" "},arc:function(a,b,c,d){return a+" "+c+" "+c+" "+b+d}},module$exports$Blockly$utils$parsing={},module$contents$Blockly$utils$parsing_tokenizeInterpolationInternal=function(a,b){var c=[],d=a.split("");d.push("");var e=0;a=[];for(var f=null,g=0;g<d.length;g++){var h=d[g];0===e?"%"===h?((e=a.join(""))&&c.push(e),a.length=0,e=1):a.push(h):1===e?"%"===h?(a.push(h),e=0):b&&"0"<=h&&"9">=h?(e=2,f=h,(h=a.join(""))&&c.push(h),a.length=0):"{"===h?e=3:(a.push("%",h),e=0):2===e?"0"<=h&&"9">=h?f+=h:(c.push(parseInt(f,10)),g--,e=0):3===e&&(""===h?(a.splice(0,0,"%{"),g--,e=0):"}"!==h?a.push(h):(e=a.join(""),/[A-Z]\w*/i.test(e)?(h=e.toUpperCase(),(h=(0,$.module$exports$Blockly$utils$string.startsWith)(h,"BKY_")?h.substring(4):null)&&h in $.module$exports$Blockly$Msg.Msg?"string"==typeof(e=$.module$exports$Blockly$Msg.Msg[h])?Array.prototype.push.apply(c,module$contents$Blockly$utils$parsing_tokenizeInterpolationInternal(e,b)):b?c.push(String(e)):c.push(e):c.push("%{"+e+"}")):c.push("%{"+e+"}"),e=a.length=0))}for((b=a.join(""))&&c.push(b),d=[],f=a.length=0;f<c.length;f++)"string"==typeof c[f]?a.push(c[f]):((b=a.join(""))&&d.push(b),a.length=0,d.push(c[f]));return(b=a.join(""))&&d.push(b),a.length=0,d};module$exports$Blockly$utils$parsing.tokenizeInterpolation=function(a){return module$contents$Blockly$utils$parsing_tokenizeInterpolationInternal(a,!0)},module$exports$Blockly$utils$parsing.replaceMessageReferences=function(a){return"string"!=typeof a?a:(a=module$contents$Blockly$utils$parsing_tokenizeInterpolationInternal(a,!1)).length?String(a[0]):""},module$exports$Blockly$utils$parsing.checkMessageReferences=function(a){for(var b=!0,c=$.module$exports$Blockly$Msg.Msg,d=a.match(/%{BKY_[A-Z]\w*}/gi),e=0;e<d.length;e++)void 0===c[d[e].toUpperCase().slice(6,-1)]&&(console.warn("No message string for "+d[e]+" in "+a),b=!1);return b},module$exports$Blockly$utils$parsing.parseBlockColour=function(a){var b="string"==typeof a?(0,module$exports$Blockly$utils$parsing.replaceMessageReferences)(a):a,c=Number(b);if(!isNaN(c)&&0<=c&&360>=c)return{hue:c,hex:(0,module$exports$Blockly$utils$colour.hsvToHex)(c,(0,module$exports$Blockly$utils$colour.getHsvSaturation)(),255*(0,module$exports$Blockly$utils$colour.getHsvValue)())};if(c=(0,module$exports$Blockly$utils$colour.parse)(b))return{hue:null,hex:c};throw c='Invalid colour: "'+b+'"',a!==b&&(c+=' (from "'+a+'")'),Error(c)};var module$exports$Blockly$blockRendering$ConstantProvider={ConstantProvider:function(){this.NO_PADDING=0,this.SMALL_PADDING=3,this.MEDIUM_PADDING=5,this.MEDIUM_LARGE_PADDING=8,this.LARGE_PADDING=10,this.TALL_INPUT_FIELD_OFFSET_Y=this.MEDIUM_PADDING,this.TAB_HEIGHT=15,this.TAB_OFFSET_FROM_TOP=5,this.TAB_VERTICAL_OVERLAP=2.5,this.TAB_WIDTH=8,this.NOTCH_WIDTH=15,this.NOTCH_HEIGHT=4,this.MIN_BLOCK_WIDTH=12,this.EMPTY_BLOCK_SPACER_HEIGHT=16,this.DUMMY_INPUT_SHADOW_MIN_HEIGHT=this.DUMMY_INPUT_MIN_HEIGHT=this.TAB_HEIGHT,this.CORNER_RADIUS=8,this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT=15,this.STATEMENT_BOTTOM_SPACER=0,this.STATEMENT_INPUT_PADDING_LEFT=20,this.BETWEEN_STATEMENT_PADDING_Y=4,this.TOP_ROW_MIN_HEIGHT=this.MEDIUM_PADDING,this.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.BOTTOM_ROW_MIN_HEIGHT=this.MEDIUM_PADDING,this.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.ADD_START_HATS=!1,this.START_HAT_HEIGHT=15,this.START_HAT_WIDTH=100,this.SPACER_DEFAULT_HEIGHT=15,this.MIN_BLOCK_HEIGHT=24,this.EMPTY_INLINE_INPUT_PADDING=14.5,this.EMPTY_INLINE_INPUT_HEIGHT=this.TAB_HEIGHT+11,this.EXTERNAL_VALUE_INPUT_PADDING=2,this.EMPTY_STATEMENT_INPUT_HEIGHT=this.MIN_BLOCK_HEIGHT,this.START_POINT=(0,module$exports$Blockly$utils$svgPaths.moveBy)(0,0),this.JAGGED_TEETH_HEIGHT=12,this.JAGGED_TEETH_WIDTH=6,this.FIELD_TEXT_FONTSIZE=11,this.FIELD_TEXT_FONTWEIGHT="normal",this.FIELD_TEXT_FONTFAMILY="sans-serif",this.FIELD_TEXT_BASELINE=this.FIELD_TEXT_HEIGHT=-1,this.FIELD_BORDER_RECT_RADIUS=4,this.FIELD_BORDER_RECT_HEIGHT=16,this.FIELD_BORDER_RECT_X_PADDING=5,this.FIELD_BORDER_RECT_Y_PADDING=3,this.FIELD_BORDER_RECT_COLOUR="#fff",this.FIELD_TEXT_BASELINE_CENTER=!module$exports$Blockly$utils$userAgent.IE&&!module$exports$Blockly$utils$userAgent.EDGE,this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT,this.FIELD_DROPDOWN_SVG_ARROW=this.FIELD_DROPDOWN_COLOURED_DIV=this.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW=!1,this.FIELD_DROPDOWN_SVG_ARROW_PADDING=this.FIELD_BORDER_RECT_X_PADDING,this.FIELD_DROPDOWN_SVG_ARROW_SIZE=12,this.FIELD_DROPDOWN_SVG_ARROW_DATAURI="data:image/svg+xml;base64,PHN2ZyBpZD0iTGF5ZXJfMSIgZGF0YS1uYW1lPSJMYXllciAxIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMi43MSIgaGVpZ2h0PSI4Ljc5IiB2aWV3Qm94PSIwIDAgMTIuNzEgOC43OSI+PHRpdGxlPmRyb3Bkb3duLWFycm93PC90aXRsZT48ZyBvcGFjaXR5PSIwLjEiPjxwYXRoIGQ9Ik0xMi43MSwyLjQ0QTIuNDEsMi40MSwwLDAsMSwxMiw0LjE2TDguMDgsOC4wOGEyLjQ1LDIuNDUsMCwwLDEtMy40NSwwTDAuNzIsNC4xNkEyLjQyLDIuNDIsMCwwLDEsMCwyLjQ0LDIuNDgsMi40OCwwLDAsMSwuNzEuNzFDMSwwLjQ3LDEuNDMsMCw2LjM2LDBTMTEuNzUsMC40NiwxMiwuNzFBMi40NCwyLjQ0LDAsMCwxLDEyLjcxLDIuNDRaIiBmaWxsPSIjMjMxZjIwIi8+PC9nPjxwYXRoIGQ9Ik02LjM2LDcuNzlhMS40MywxLjQzLDAsMCwxLTEtLjQyTDEuNDIsMy40NWExLjQ0LDEuNDQsMCwwLDEsMC0yYzAuNTYtLjU2LDkuMzEtMC41Niw5Ljg3LDBhMS40NCwxLjQ0LDAsMCwxLDAsMkw3LjM3LDcuMzdBMS40MywxLjQzLDAsMCwxLDYuMzYsNy43OVoiIGZpbGw9IiNmZmYiLz48L3N2Zz4=",this.FIELD_COLOUR_FULL_BLOCK=this.FIELD_TEXTINPUT_BOX_SHADOW=!1,this.FIELD_COLOUR_DEFAULT_WIDTH=26,this.FIELD_COLOUR_DEFAULT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT,this.FIELD_CHECKBOX_X_OFFSET=this.FIELD_BORDER_RECT_X_PADDING-3,this.randomIdentifier=String(Math.random()).substring(2),this.defs_=null,this.embossFilterId="",this.embossFilter_=null,this.disabledPatternId="",this.disabledPattern_=null,this.debugFilterId="",this.cssNode_=this.debugFilter_=null,this.CURSOR_COLOUR="#cc0a0a",this.MARKER_COLOUR="#4286f4",this.CURSOR_WS_WIDTH=100,this.WS_CURSOR_HEIGHT=5,this.CURSOR_STACK_PADDING=10,this.CURSOR_BLOCK_PADDING=2,this.CURSOR_STROKE_WIDTH=4,this.FULL_BLOCK_FIELDS=!1,this.INSERTION_MARKER_COLOUR="#000000",this.INSERTION_MARKER_OPACITY=.2,this.SHAPES={PUZZLE:1,NOTCH:2}}};module$exports$Blockly$blockRendering$ConstantProvider.ConstantProvider.prototype.init=function(){this.JAGGED_TEETH=this.makeJaggedTeeth(),this.NOTCH=this.makeNotch(),this.START_HAT=this.makeStartHat(),this.PUZZLE_TAB=this.makePuzzleTab(),this.INSIDE_CORNERS=this.makeInsideCorners(),this.OUTSIDE_CORNERS=this.makeOutsideCorners()},module$exports$Blockly$blockRendering$ConstantProvider.ConstantProvider.prototype.setTheme=function(a){this.blockStyles=Object.create(null);var c,b=a.blockStyles;for(c in b)this.blockStyles[c]=this.validatedBlockStyle_(b[c]);this.setDynamicProperties_(a)},module$exports$Blockly$blockRendering$ConstantProvider.ConstantProvider.prototype.setDynamicProperties_=function(a){this.setFontConstants_(a),this.setComponentConstants_(a),this.ADD_START_HATS=null!==a.startHats?a.startHats:this.ADD_START_HATS},module$exports$Blockly$blockRendering$ConstantProvider.ConstantProvider.prototype.setFontConstants_=function(a){this.FIELD_TEXT_FONTFAMILY=a.fontStyle&&void 0!==a.fontStyle.family?a.fontStyle.family:this.FIELD_TEXT_FONTFAMILY,this.FIELD_TEXT_FONTWEIGHT=a.fontStyle&&void 0!==a.fontStyle.weight?a.fontStyle.weight:this.FIELD_TEXT_FONTWEIGHT,this.FIELD_TEXT_FONTSIZE=a.fontStyle&&void 0!==a.fontStyle.size?a.fontStyle.size:this.FIELD_TEXT_FONTSIZE,a=(0,module$exports$Blockly$utils$dom.measureFontMetrics)("Hg",this.FIELD_TEXT_FONTSIZE+"pt",this.FIELD_TEXT_FONTWEIGHT,this.FIELD_TEXT_FONTFAMILY),this.FIELD_TEXT_HEIGHT=a.height,this.FIELD_TEXT_BASELINE=a.baseline},module$exports$Blockly$blockRendering$ConstantProvider.ConstantProvider.prototype.setComponentConstants_=function(a){this.CURSOR_COLOUR=a.getComponentStyle("cursorColour")||this.CURSOR_COLOUR,this.MARKER_COLOUR=a.getComponentStyle("markerColour")||this.MARKER_COLOUR,this.INSERTION_MARKER_COLOUR=a.getComponentStyle("insertionMarkerColour")||this.INSERTION_MARKER_COLOUR,this.INSERTION_MARKER_OPACITY=Number(a.getComponentStyle("insertionMarkerOpacity"))||this.INSERTION_MARKER_OPACITY},module$exports$Blockly$blockRendering$ConstantProvider.ConstantProvider.prototype.getBlockStyleForColour=function(a){var b="auto_"+a;return this.blockStyles[b]||(this.blockStyles[b]=this.createBlockStyle_(a)),{style:this.blockStyles[b],name:b}},module$exports$Blockly$blockRendering$ConstantProvider.ConstantProvider.prototype.getBlockStyle=function(a){return this.blockStyles[a||""]||(a&&0===a.indexOf("auto_")?this.getBlockStyleForColour(a.substring(5)).style:this.createBlockStyle_("#000000"))},module$exports$Blockly$blockRendering$ConstantProvider.ConstantProvider.prototype.createBlockStyle_=function(a){return this.validatedBlockStyle_({colourPrimary:a})},module$exports$Blockly$blockRendering$ConstantProvider.ConstantProvider.prototype.validatedBlockStyle_=function(a){var b={};return a&&(0,$.module$exports$Blockly$utils$object.mixin)(b,a),a=(0,module$exports$Blockly$utils$parsing.parseBlockColour)(b.colourPrimary||"#000"),b.colourPrimary=a.hex,b.colourSecondary=b.colourSecondary?(0,module$exports$Blockly$utils$parsing.parseBlockColour)(b.colourSecondary).hex:this.generateSecondaryColour_(b.colourPrimary),b.colourTertiary=b.colourTertiary?(0,module$exports$Blockly$utils$parsing.parseBlockColour)(b.colourTertiary).hex:this.generateTertiaryColour_(b.colourPrimary),b.hat=b.hat||"",b},module$exports$Blockly$blockRendering$ConstantProvider.ConstantProvider.prototype.generateSecondaryColour_=function(a){return(0,module$exports$Blockly$utils$colour.blend)("#fff",a,.6)||a},module$exports$Blockly$blockRendering$ConstantProvider.ConstantProvider.prototype.generateTertiaryColour_=function(a){return(0,module$exports$Blockly$utils$colour.blend)("#fff",a,.3)||a},module$exports$Blockly$blockRendering$ConstantProvider.ConstantProvider.prototype.dispose=function(){this.embossFilter_&&(0,module$exports$Blockly$utils$dom.removeNode)(this.embossFilter_),this.disabledPattern_&&(0,module$exports$Blockly$utils$dom.removeNode)(this.disabledPattern_),this.debugFilter_&&(0,module$exports$Blockly$utils$dom.removeNode)(this.debugFilter_),this.cssNode_=null},module$exports$Blockly$blockRendering$ConstantProvider.ConstantProvider.prototype.makeJaggedTeeth=function(){var a=this.JAGGED_TEETH_HEIGHT,b=this.JAGGED_TEETH_WIDTH;return{height:a,width:b,path:(0,module$exports$Blockly$utils$svgPaths.line)([(0,module$exports$Blockly$utils$svgPaths.point)(b,a/4),(0,module$exports$Blockly$utils$svgPaths.point)(2*-b,a/2),(0,module$exports$Blockly$utils$svgPaths.point)(b,a/4)])}},module$exports$Blockly$blockRendering$ConstantProvider.ConstantProvider.prototype.makeStartHat=function(){var a=this.START_HAT_HEIGHT,b=this.START_HAT_WIDTH;return{height:a,width:b,path:(0,module$exports$Blockly$utils$svgPaths.curve)("c",[(0,module$exports$Blockly$utils$svgPaths.point)(30,-a),(0,module$exports$Blockly$utils$svgPaths.point)(70,-a),(0,module$exports$Blockly$utils$svgPaths.point)(b,0)])}},module$exports$Blockly$blockRendering$ConstantProvider.ConstantProvider.prototype.makePuzzleTab=function(){function a(f){var g=-(f=f?-1:1),h=c/2,k=h+2.5,l=h+.5,m=(0,module$exports$Blockly$utils$svgPaths.point)(-b,f*h);return h=(0,module$exports$Blockly$utils$svgPaths.point)(b,f*h),(0,module$exports$Blockly$utils$svgPaths.curve)("c",[(0,module$exports$Blockly$utils$svgPaths.point)(0,f*k),(0,module$exports$Blockly$utils$svgPaths.point)(-b,g*l),m])+(0,module$exports$Blockly$utils$svgPaths.curve)("s",[(0,module$exports$Blockly$utils$svgPaths.point)(b,2.5*g),h])}var b=this.TAB_WIDTH,c=this.TAB_HEIGHT,d=a(!0),e=a(!1);return{type:this.SHAPES.PUZZLE,width:b,height:c,pathDown:e,pathUp:d}},module$exports$Blockly$blockRendering$ConstantProvider.ConstantProvider.prototype.makeNotch=function(){function a(g){return(0,module$exports$Blockly$utils$svgPaths.line)([(0,module$exports$Blockly$utils$svgPaths.point)(g*d,c),(0,module$exports$Blockly$utils$svgPaths.point)(3*g,0),(0,module$exports$Blockly$utils$svgPaths.point)(g*d,-c)])}var b=this.NOTCH_WIDTH,c=this.NOTCH_HEIGHT,d=(b-3)/2,e=a(1),f=a(-1);return{type:this.SHAPES.NOTCH,width:b,height:c,pathLeft:e,pathRight:f}},module$exports$Blockly$blockRendering$ConstantProvider.ConstantProvider.prototype.makeInsideCorners=function(){var a=this.CORNER_RADIUS;return{width:a,height:a,pathTop:(0,module$exports$Blockly$utils$svgPaths.arc)("a","0 0,0",a,(0,module$exports$Blockly$utils$svgPaths.point)(-a,a)),pathBottom:(0,module$exports$Blockly$utils$svgPaths.arc)("a","0 0,0",a,(0,module$exports$Blockly$utils$svgPaths.point)(a,a))}},module$exports$Blockly$blockRendering$ConstantProvider.ConstantProvider.prototype.makeOutsideCorners=function(){var a=this.CORNER_RADIUS,b=(0,module$exports$Blockly$utils$svgPaths.moveBy)(0,a)+(0,module$exports$Blockly$utils$svgPaths.arc)("a","0 0,1",a,(0,module$exports$Blockly$utils$svgPaths.point)(a,-a)),c=(0,module$exports$Blockly$utils$svgPaths.arc)("a","0 0,1",a,(0,module$exports$Blockly$utils$svgPaths.point)(a,a)),d=(0,module$exports$Blockly$utils$svgPaths.arc)("a","0 0,1",a,(0,module$exports$Blockly$utils$svgPaths.point)(-a,-a));return{topLeft:b,topRight:c,bottomRight:(0,module$exports$Blockly$utils$svgPaths.arc)("a","0 0,1",a,(0,module$exports$Blockly$utils$svgPaths.point)(-a,a)),bottomLeft:d,rightHeight:a}},module$exports$Blockly$blockRendering$ConstantProvider.ConstantProvider.prototype.shapeFor=function(a){switch(a.type){case $.module$exports$Blockly$ConnectionType.ConnectionType.INPUT_VALUE:case $.module$exports$Blockly$ConnectionType.ConnectionType.OUTPUT_VALUE:return this.PUZZLE_TAB;case $.module$exports$Blockly$ConnectionType.ConnectionType.PREVIOUS_STATEMENT:case $.module$exports$Blockly$ConnectionType.ConnectionType.NEXT_STATEMENT:return this.NOTCH;default:throw Error("Unknown connection type")}},module$exports$Blockly$blockRendering$ConstantProvider.ConstantProvider.prototype.createDom=function(a,b,c){this.injectCSS_(b,c),this.defs_=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.DEFS,{},a),a=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.FILTER,{id:"blocklyEmbossFilter"+this.randomIdentifier},this.defs_),(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.FEGAUSSIANBLUR,{in:"SourceAlpha",stdDeviation:1,result:"blur"},a),b=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.FESPECULARLIGHTING,{in:"blur",surfaceScale:1,specularConstant:.5,specularExponent:10,"lighting-color":"white",result:"specOut"},a),(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.FEPOINTLIGHT,{x:-5e3,y:-1e4,z:2e4},b),(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.FECOMPOSITE,{in:"specOut",in2:"SourceAlpha",operator:"in",result:"specOut"},a),(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.FECOMPOSITE,{in:"SourceGraphic",in2:"specOut",operator:"arithmetic",k1:0,k2:1,k3:1,k4:0},a),this.embossFilterId=a.id,this.embossFilter_=a,a=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.PATTERN,{id:"blocklyDisabledPattern"+this.randomIdentifier,patternUnits:"userSpaceOnUse",width:10,height:10},this.defs_),(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.RECT,{width:10,height:10,fill:"#aaa"},a),(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.PATH,{d:"M 0 0 L 10 10 M 10 0 L 0 10",stroke:"#cc0"},a),this.disabledPatternId=a.id,this.disabledPattern_=a,this.createDebugFilter()},module$exports$Blockly$blockRendering$ConstantProvider.ConstantProvider.prototype.createDebugFilter=function(){if(!this.debugFilter_){var a=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.FILTER,{id:"blocklyDebugFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},this.defs_),b=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.FECOMPONENTTRANSFER,{result:"outBlur"},a);(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},b),(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.FEFLOOD,{"flood-color":"#ff0000","flood-opacity":.5,result:"outColor"},a),(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},a),this.debugFilterId=a.id,this.debugFilter_=a}},module$exports$Blockly$blockRendering$ConstantProvider.ConstantProvider.prototype.injectCSS_=function(a,b){b=this.getCSS_(b),a="blockly-renderer-style-"+a,this.cssNode_=document.getElementById(a);var c=b.join("\n");this.cssNode_?this.cssNode_.firstChild.textContent=c:((b=document.createElement("style")).id=a,a=document.createTextNode(c),b.appendChild(a),document.head.insertBefore(b,document.head.firstChild),this.cssNode_=b)},module$exports$Blockly$blockRendering$ConstantProvider.ConstantProvider.prototype.getCSS_=function(a){return[a+" .blocklyText, ",a+" .blocklyFlyoutLabelText {","font: "+this.FIELD_TEXT_FONTWEIGHT+" "+this.FIELD_TEXT_FONTSIZE+"pt "+this.FIELD_TEXT_FONTFAMILY+";","}",a+" .blocklyText {","fill: #fff;","}",a+" .blocklyNonEditableText>rect,",a+" .blocklyEditableText>rect {","fill: "+this.FIELD_BORDER_RECT_COLOUR+";","fill-opacity: .6;","stroke: none;","}",a+" .blocklyNonEditableText>text,",a+" .blocklyEditableText>text {","fill: #000;","}",a+" .blocklyFlyoutLabelText {","fill: #000;","}",a+" .blocklyText.blocklyBubbleText {","fill: #000;","}",a+" .blocklyEditableText:not(.editing):hover>rect {","stroke: #fff;","stroke-width: 2;","}",a+" .blocklyHtmlInput {","font-family: "+this.FIELD_TEXT_FONTFAMILY+";","font-weight: "+this.FIELD_TEXT_FONTWEIGHT+";","}",a+" .blocklySelected>.blocklyPath {","stroke: #fc3;","stroke-width: 3px;","}",a+" .blocklyHighlightedConnectionPath {","stroke: #fc3;","}",a+" .blocklyReplaceable .blocklyPath {","fill-opacity: .5;","}",a+" .blocklyReplaceable .blocklyPathLight,",a+" .blocklyReplaceable .blocklyPathDark {","display: none;","}",a+" .blocklyInsertionMarker>.blocklyPath {","fill-opacity: "+this.INSERTION_MARKER_OPACITY+";","stroke: none;","}"]};var module$exports$Blockly$fieldRegistry={register:function(a,b){(0,module$exports$Blockly$registry.register)(module$exports$Blockly$registry.Type.FIELD,a,b)},unregister:function(a){(0,module$exports$Blockly$registry.unregister)(module$exports$Blockly$registry.Type.FIELD,a)},fromJson:function(a){var b=(0,module$exports$Blockly$registry.getObject)(module$exports$Blockly$registry.Type.FIELD,a.type);return b?b.fromJson(a):(console.warn("Blockly could not create a field of type "+a.type+". The field is probably not being registered. This could be because the file is not loaded, the field does not register itself (Issue #1584), or the registration is not being reached."),null)}},module$exports$Blockly$MarkerManager={MarkerManager:function(a){this.cursorSvg_=this.cursor_=null,this.markers_=Object.create(null),this.workspace_=a}};module$exports$Blockly$MarkerManager.MarkerManager.LOCAL_MARKER="local_marker_1",module$exports$Blockly$MarkerManager.MarkerManager.prototype.registerMarker=function(a,b){this.markers_[a]&&this.unregisterMarker(a),b.setDrawer(this.workspace_.getRenderer().makeMarkerDrawer(this.workspace_,b)),this.setMarkerSvg(b.getDrawer().createDom()),this.markers_[a]=b},module$exports$Blockly$MarkerManager.MarkerManager.prototype.unregisterMarker=function(a){var b=this.markers_[a];if(!b)throw Error("Marker with ID "+a+" does not exist. Can only unregister markers that exist.");b.dispose(),delete this.markers_[a]},module$exports$Blockly$MarkerManager.MarkerManager.prototype.getCursor=function(){return this.cursor_},module$exports$Blockly$MarkerManager.MarkerManager.prototype.getMarker=function(a){return this.markers_[a]||null},module$exports$Blockly$MarkerManager.MarkerManager.prototype.setCursor=function(a){this.cursor_&&this.cursor_.getDrawer()&&this.cursor_.getDrawer().dispose(),(this.cursor_=a)&&(a=this.workspace_.getRenderer().makeMarkerDrawer(this.workspace_,this.cursor_),this.cursor_.setDrawer(a),this.setCursorSvg(this.cursor_.getDrawer().createDom()))},module$exports$Blockly$MarkerManager.MarkerManager.prototype.setCursorSvg=function(a){a?(this.workspace_.getBlockCanvas().appendChild(a),this.cursorSvg_=a):this.cursorSvg_=null},module$exports$Blockly$MarkerManager.MarkerManager.prototype.setMarkerSvg=function(a){a?this.workspace_.getBlockCanvas()&&(this.cursorSvg_?this.workspace_.getBlockCanvas().insertBefore(a,this.cursorSvg_):this.workspace_.getBlockCanvas().appendChild(a)):this.markerSvg_=null},module$exports$Blockly$MarkerManager.MarkerManager.prototype.updateMarkers=function(){this.workspace_.keyboardAccessibilityMode&&this.cursorSvg_&&this.workspace_.getCursor().draw()},module$exports$Blockly$MarkerManager.MarkerManager.prototype.dispose=function(){for(var c,a=Object.keys(this.markers_),b=0;c=a[b];b++)this.unregisterMarker(c);this.markers_=null,this.cursor_&&(this.cursor_.dispose(),this.cursor_=null)};var module$exports$Blockly$Events$BlockChange={BlockChange:function(a,b,c,d,e){module$exports$Blockly$Events$BlockChange.BlockChange.superClass_.constructor.call(this,a),a&&(this.element=void 0===b?"":b,this.name=void 0===c?"":c,this.oldValue=void 0===d?"":d,this.newValue=void 0===e?"":e)}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$Events$BlockChange.BlockChange,module$exports$Blockly$Events$BlockBase.BlockBase),module$exports$Blockly$Events$BlockChange.BlockChange.prototype.type=module$exports$Blockly$Events$utils.CHANGE,module$exports$Blockly$Events$BlockChange.BlockChange.prototype.toJson=function(){var a=module$exports$Blockly$Events$BlockChange.BlockChange.superClass_.toJson.call(this);return a.element=this.element,this.name&&(a.name=this.name),a.oldValue=this.oldValue,a.newValue=this.newValue,a},module$exports$Blockly$Events$BlockChange.BlockChange.prototype.fromJson=function(a){module$exports$Blockly$Events$BlockChange.BlockChange.superClass_.fromJson.call(this,a),this.element=a.element,this.name=a.name,this.oldValue=a.oldValue,this.newValue=a.newValue},module$exports$Blockly$Events$BlockChange.BlockChange.prototype.isNull=function(){return this.oldValue===this.newValue},module$exports$Blockly$Events$BlockChange.BlockChange.prototype.run=function(a){var b=this.getEventWorkspace_().getBlockById(this.blockId);if(b)switch(b.mutator&&b.mutator.setVisible(!1),a=a?this.newValue:this.oldValue,this.element){case"field":(b=b.getField(this.name))?b.setValue(a):console.warn("Can't set non-existent field: "+this.name);break;case"comment":b.setCommentText(a||null);break;case"collapsed":b.setCollapsed(!!a);break;case"disabled":b.setEnabled(!a);break;case"inline":b.setInputsInline(!!a);break;case"mutation":var c=module$exports$Blockly$Events$BlockChange.BlockChange.getExtraBlockState_(b);b.loadExtraState?b.loadExtraState(JSON.parse(a||"{}")):b.domToMutation&&b.domToMutation((0,$.module$exports$Blockly$Xml.textToDom)(a||"<mutation/>")),(0,module$exports$Blockly$Events$utils.fire)(new module$exports$Blockly$Events$BlockChange.BlockChange(b,"mutation",null,c,a));break;default:console.warn("Unknown change type: "+this.element)}else console.warn("Can't change non-existent block: "+this.blockId)},module$exports$Blockly$Events$BlockChange.BlockChange.getExtraBlockState_=function(a){return a.saveExtraState?(a=a.saveExtraState())?JSON.stringify(a):"":a.mutationToDom&&(a=a.mutationToDom())?(0,$.module$exports$Blockly$Xml.domToText)(a):""},(0,module$exports$Blockly$registry.register)(module$exports$Blockly$registry.Type.EVENT,module$exports$Blockly$Events$utils.CHANGE,module$exports$Blockly$Events$BlockChange.BlockChange);var module$exports$Blockly$blockAnimations={},module$contents$Blockly$blockAnimations_disconnectPid=0,module$contents$Blockly$blockAnimations_disconnectGroup=null;module$exports$Blockly$blockAnimations.disposeUiEffect=function(a){var b=a.workspace,c=a.getSvgRoot();b.getAudioManager().play("delete"),a=b.getSvgXY(c),(c=c.cloneNode(!0)).translateX_=a.x,c.translateY_=a.y,c.setAttribute("transform","translate("+a.x+","+a.y+")"),b.getParentSvg().appendChild(c),c.bBox_=c.getBBox(),module$contents$Blockly$blockAnimations_disposeUiStep(c,b.RTL,new Date,b.scale)};var module$contents$Blockly$blockAnimations_disposeUiStep=function(a,b,c,d){var e=(new Date-c)/150;1<e?(0,module$exports$Blockly$utils$dom.removeNode)(a):(a.setAttribute("transform","translate("+(a.translateX_+(b?-1:1)*a.bBox_.width*d/2*e)+","+(a.translateY_+a.bBox_.height*d*e)+") scale("+(1-e)*d+")"),setTimeout(module$contents$Blockly$blockAnimations_disposeUiStep,10,a,b,c,d))};module$exports$Blockly$blockAnimations.connectionUiEffect=function(a){var b=a.workspace,c=b.scale;if(b.getAudioManager().play("click"),!(1>c)){var d=b.getSvgXY(a.getSvgRoot());a.outputConnection?(d.x+=(a.RTL?3:-3)*c,d.y+=13*c):a.previousConnection&&(d.x+=(a.RTL?-23:23)*c,d.y+=3*c),a=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.CIRCLE,{cx:d.x,cy:d.y,r:0,fill:"none",stroke:"#888","stroke-width":10},b.getParentSvg()),module$contents$Blockly$blockAnimations_connectionUiStep(a,new Date,c)}};var module$contents$Blockly$blockAnimations_connectionUiStep=function(a,b,c){var d=(new Date-b)/150;1<d?(0,module$exports$Blockly$utils$dom.removeNode)(a):(a.setAttribute("r",25*d*c),a.style.opacity=1-d,module$contents$Blockly$blockAnimations_disconnectPid=setTimeout(module$contents$Blockly$blockAnimations_connectionUiStep,10,a,b,c))};module$exports$Blockly$blockAnimations.disconnectUiEffect=function(a){if(a.workspace.getAudioManager().play("disconnect"),!(1>a.workspace.scale)){var b=a.getHeightWidth().height;b=Math.atan(10/b)/Math.PI*180,a.RTL||(b*=-1),module$contents$Blockly$blockAnimations_disconnectUiStep(a.getSvgRoot(),b,new Date)}};var module$contents$Blockly$blockAnimations_disconnectUiStep=function(a,b,c){var d=(new Date-c)/200;1<d?a.skew_="":(a.skew_="skewX("+Math.round(Math.sin(d*Math.PI*3)*(1-d)*b)+")",module$contents$Blockly$blockAnimations_disconnectGroup=a,module$contents$Blockly$blockAnimations_disconnectPid=setTimeout(module$contents$Blockly$blockAnimations_disconnectUiStep,10,a,b,c)),a.setAttribute("transform",a.translate_+a.skew_)};module$exports$Blockly$blockAnimations.disconnectUiStop=function(){if(module$contents$Blockly$blockAnimations_disconnectGroup){clearTimeout(module$contents$Blockly$blockAnimations_disconnectPid);var a=module$contents$Blockly$blockAnimations_disconnectGroup;a.skew_="",a.setAttribute("transform",a.translate_),module$contents$Blockly$blockAnimations_disconnectGroup=null}};var module$exports$Blockly$ComponentManager={ComponentManager:function(){this.componentData_=Object.create(null),this.capabilityToComponentIds_=Object.create(null)}};module$exports$Blockly$ComponentManager.ComponentManager.prototype.addComponent=function(a,b){var c=a.component.id;if(!b&&this.componentData_[c])throw Error('Plugin "'+c+'" with capabilities "'+this.componentData_[c].capabilities+'" already added.');this.componentData_[c]=a,b=[];for(var d=0;d<a.capabilities.length;d++){var e=String(a.capabilities[d]).toLowerCase();b.push(e),void 0===this.capabilityToComponentIds_[e]?this.capabilityToComponentIds_[e]=[c]:this.capabilityToComponentIds_[e].push(c)}this.componentData_[c].capabilities=b},module$exports$Blockly$ComponentManager.ComponentManager.prototype.removeComponent=function(a){var b=this.componentData_[a];if(b){for(var c=0;c<b.capabilities.length;c++){var d=String(b.capabilities[c]).toLowerCase();module$exports$Blockly$utils$array_removeElem(this.capabilityToComponentIds_[d],a)}delete this.componentData_[a]}},module$exports$Blockly$ComponentManager.ComponentManager.prototype.addCapability=function(a,b){if(!this.getComponent(a))throw Error('Cannot add capability, "'+b+'". Plugin "'+a+'" has not been added to the ComponentManager');this.hasCapability(a,b)?console.warn('Plugin "'+a+'already has capability "'+b+'"'):(b=String(b).toLowerCase(),this.componentData_[a].capabilities.push(b),this.capabilityToComponentIds_[b].push(a))},module$exports$Blockly$ComponentManager.ComponentManager.prototype.removeCapability=function(a,b){if(!this.getComponent(a))throw Error('Cannot remove capability, "'+b+'". Plugin "'+a+'" has not been added to the ComponentManager');this.hasCapability(a,b)?(b=String(b).toLowerCase(),module$exports$Blockly$utils$array_removeElem(this.componentData_[a].capabilities,b),module$exports$Blockly$utils$array_removeElem(this.capabilityToComponentIds_[b],a)):console.warn('Plugin "'+a+"doesn't have capability \""+b+'" to remove')},module$exports$Blockly$ComponentManager.ComponentManager.prototype.hasCapability=function(a,b){return b=String(b).toLowerCase(),-1!==this.componentData_[a].capabilities.indexOf(b)},module$exports$Blockly$ComponentManager.ComponentManager.prototype.getComponent=function(a){return this.componentData_[a]&&this.componentData_[a].component},module$exports$Blockly$ComponentManager.ComponentManager.prototype.getComponents=function(a,b){if(a=String(a).toLowerCase(),!(a=this.capabilityToComponentIds_[a]))return[];var c=[];if(b){var d=[],e=this.componentData_;a.forEach((function(g){d.push(e[g])})),d.sort((function(g,h){return g.weight-h.weight})),d.forEach((function(g){c.push(g.component)}))}else{var f=this.componentData_;a.forEach((function(g){c.push(f[g].component)}))}return c},module$exports$Blockly$ComponentManager.ComponentManager.Capability=function(a){this.name_=a},module$exports$Blockly$ComponentManager.ComponentManager.Capability.prototype.toString=function(){return this.name_},module$exports$Blockly$ComponentManager.ComponentManager.Capability.POSITIONABLE=new module$exports$Blockly$ComponentManager.ComponentManager.Capability("positionable"),module$exports$Blockly$ComponentManager.ComponentManager.Capability.DRAG_TARGET=new module$exports$Blockly$ComponentManager.ComponentManager.Capability("drag_target"),module$exports$Blockly$ComponentManager.ComponentManager.Capability.DELETE_AREA=new module$exports$Blockly$ComponentManager.ComponentManager.Capability("delete_area"),module$exports$Blockly$ComponentManager.ComponentManager.Capability.AUTOHIDEABLE=new module$exports$Blockly$ComponentManager.ComponentManager.Capability("autohideable");var module$exports$Blockly$dialog={},module$contents$Blockly$dialog_alertImplementation=function(a,b){window.alert(a),b&&b()},module$contents$Blockly$dialog_confirmImplementation=function(a,b){b(window.confirm(a))},module$contents$Blockly$dialog_promptImplementation=function(a,b,c){c(window.prompt(a,b))};module$exports$Blockly$dialog.alert=function(a,b){module$contents$Blockly$dialog_alertImplementation(a,b)},module$exports$Blockly$dialog.setAlert=function(a){module$contents$Blockly$dialog_alertImplementation=a},module$exports$Blockly$dialog.confirm=function(a,b){module$contents$Blockly$dialog_confirmImplementation(a,b)},module$exports$Blockly$dialog.setConfirm=function(a){module$contents$Blockly$dialog_confirmImplementation=a},module$exports$Blockly$dialog.prompt=function(a,b,c){module$contents$Blockly$dialog_promptImplementation(a,b,c)},module$exports$Blockly$dialog.setPrompt=function(a){module$contents$Blockly$dialog_promptImplementation=a};var module$exports$Blockly$Events$VarBase={VarBase:function(a){module$exports$Blockly$Events$VarBase.VarBase.superClass_.constructor.call(this),this.varId=(this.isBlank=void 0===a)?"":a.getId(),this.workspaceId=this.isBlank?"":a.workspace.id}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$Events$VarBase.VarBase,module$exports$Blockly$Events$Abstract),module$exports$Blockly$Events$VarBase.VarBase.prototype.toJson=function(){var a=module$exports$Blockly$Events$VarBase.VarBase.superClass_.toJson.call(this);return a.varId=this.varId,a},module$exports$Blockly$Events$VarBase.VarBase.prototype.fromJson=function(a){module$exports$Blockly$Events$VarBase.VarBase.superClass_.toJson.call(this),this.varId=a.varId};var module$exports$Blockly$Events$VarCreate={VarCreate:function(a){module$exports$Blockly$Events$VarCreate.VarCreate.superClass_.constructor.call(this,a),a&&(this.varType=a.type,this.varName=a.name)}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$Events$VarCreate.VarCreate,module$exports$Blockly$Events$VarBase.VarBase),module$exports$Blockly$Events$VarCreate.VarCreate.prototype.type=module$exports$Blockly$Events$utils.VAR_CREATE,module$exports$Blockly$Events$VarCreate.VarCreate.prototype.toJson=function(){var a=module$exports$Blockly$Events$VarCreate.VarCreate.superClass_.toJson.call(this);return a.varType=this.varType,a.varName=this.varName,a},module$exports$Blockly$Events$VarCreate.VarCreate.prototype.fromJson=function(a){module$exports$Blockly$Events$VarCreate.VarCreate.superClass_.fromJson.call(this,a),this.varType=a.varType,this.varName=a.varName},module$exports$Blockly$Events$VarCreate.VarCreate.prototype.run=function(a){var b=this.getEventWorkspace_();a?b.createVariable(this.varName,this.varType,this.varId):b.deleteVariableById(this.varId)},(0,module$exports$Blockly$registry.register)(module$exports$Blockly$registry.Type.EVENT,module$exports$Blockly$Events$utils.VAR_CREATE,module$exports$Blockly$Events$VarCreate.VarCreate);var module$contents$Blockly$Variables_ALL_DEVELOPER_VARS_WARNINGS_BY_BLOCK_TYPE,module$exports$Blockly$VariableModel={VariableModel:function(a,b,c,d){this.workspace=a,this.name=b,this.type=c||"",this.id_=d||(0,module$exports$Blockly$utils$idGenerator.genUid)(),(0,module$exports$Blockly$Events$utils.fire)(new((0,module$exports$Blockly$Events$utils.get)(module$exports$Blockly$Events$utils.VAR_CREATE))(this))}};module$exports$Blockly$VariableModel.VariableModel.prototype.getId=function(){return this.id_},module$exports$Blockly$VariableModel.VariableModel.compareByName=function(a,b){return a.name.localeCompare(b.name,void 0,{sensitivity:"base"})},$.module$exports$Blockly$Variables={CATEGORY_NAME:"VARIABLE",allUsedVarModels:function(a){var b=a.getAllBlocks(!1);a=Object.create(null);for(var c=0;c<b.length;c++){var d=b[c].getVarModels();if(d)for(var e=0;e<d.length;e++){var f=d[e],g=f.getId();g&&(a[g]=f)}}for(var h in b=[],a)b.push(a[h]);return b}},module$contents$Blockly$Variables_ALL_DEVELOPER_VARS_WARNINGS_BY_BLOCK_TYPE={},$.module$exports$Blockly$Variables.allDeveloperVariables=function(a){a=a.getAllBlocks(!1);for(var d,b=Object.create(null),c=0;d=a[c];c++){var e=d.getDeveloperVariables;if(!e&&d.getDeveloperVars&&(e=d.getDeveloperVars,module$contents$Blockly$Variables_ALL_DEVELOPER_VARS_WARNINGS_BY_BLOCK_TYPE[d.type]||(console.warn("Function getDeveloperVars() deprecated. Use getDeveloperVariables() (block type '"+d.type+"')"),module$contents$Blockly$Variables_ALL_DEVELOPER_VARS_WARNINGS_BY_BLOCK_TYPE[d.type]=!0)),e)for(d=e(),e=0;e<d.length;e++)b[d[e]]=!0}return Object.keys(b)},$.module$exports$Blockly$Variables.flyoutCategory=function(a){var b=[],c=document.createElement("button");return c.setAttribute("text","%{BKY_NEW_VARIABLE}"),c.setAttribute("callbackKey","CREATE_VARIABLE"),a.registerButtonCallback("CREATE_VARIABLE",(function(d){(0,$.module$exports$Blockly$Variables.createVariableButtonHandler)(d.getTargetWorkspace())})),b.push(c),a=(0,$.module$exports$Blockly$Variables.flyoutCategoryBlocks)(a),b.concat(a)},$.module$exports$Blockly$Variables.flyoutCategoryBlocks=function(a){var b=[];if(0<(a=a.getVariablesOfType("")).length){var c=a[a.length-1];if($.module$exports$Blockly$blocks.Blocks.variables_set){var d=(0,$.module$exports$Blockly$utils$xml.createElement)("block");d.setAttribute("type","variables_set"),d.setAttribute("gap",$.module$exports$Blockly$blocks.Blocks.math_change?8:24),d.appendChild((0,$.module$exports$Blockly$Variables.generateVariableFieldDom)(c)),b.push(d)}if($.module$exports$Blockly$blocks.Blocks.math_change&&((d=(0,$.module$exports$Blockly$utils$xml.createElement)("block")).setAttribute("type","math_change"),d.setAttribute("gap",$.module$exports$Blockly$blocks.Blocks.variables_get?20:8),d.appendChild((0,$.module$exports$Blockly$Variables.generateVariableFieldDom)(c)),c=(0,$.module$exports$Blockly$Xml.textToDom)('<value name="DELTA"><shadow type="math_number"><field name="NUM">1</field></shadow></value>'),d.appendChild(c),b.push(d)),$.module$exports$Blockly$blocks.Blocks.variables_get)for(a.sort(module$exports$Blockly$VariableModel.VariableModel.compareByName),c=0;d=a[c];c++){var e=(0,$.module$exports$Blockly$utils$xml.createElement)("block");e.setAttribute("type","variables_get"),e.setAttribute("gap",8),e.appendChild((0,$.module$exports$Blockly$Variables.generateVariableFieldDom)(d)),b.push(e)}}return b},$.module$exports$Blockly$Variables.VAR_LETTER_OPTIONS="ijkmnopqrstuvwxyzabcdefgh",$.module$exports$Blockly$Variables.generateUniqueName=function(a){return(0,$.module$exports$Blockly$Variables.generateUniqueNameFromOptions)($.module$exports$Blockly$Variables.VAR_LETTER_OPTIONS.charAt(0),a.getAllVariableNames())},$.module$exports$Blockly$Variables.generateUniqueNameFromOptions=function(a,b){if(!b.length)return a;for(var c=$.module$exports$Blockly$Variables.VAR_LETTER_OPTIONS,d="",e=c.indexOf(a);;){for(var f=!1,g=0;g<b.length;g++)if(b[g].toLowerCase()===a){f=!0;break}if(!f)return a;++e===c.length&&(e=0,d=Number(d)+1),a=c.charAt(e)+d}},$.module$exports$Blockly$Variables.createVariableButtonHandler=function(a,b,c){var d=c||"",e=function(f){(0,$.module$exports$Blockly$Variables.promptName)($.module$exports$Blockly$Msg.Msg.NEW_VARIABLE_TITLE,f,(function(g){if(g){var h=(0,$.module$exports$Blockly$Variables.nameUsedWithAnyType)(g,a);if(h){if(h.type===d)var k=$.module$exports$Blockly$Msg.Msg.VARIABLE_ALREADY_EXISTS.replace("%1",h.name);else k=(k=$.module$exports$Blockly$Msg.Msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE).replace("%1",h.name).replace("%2",h.type);(0,module$exports$Blockly$dialog.alert)(k,(function(){e(g)}))}else a.createVariable(g,d),b&&b(g)}else b&&b(null)}))};e("")},$.module$exports$Blockly$Variables.renameVariable=function(a,b,c){var d=function(e){var f=$.module$exports$Blockly$Msg.Msg.RENAME_VARIABLE_TITLE.replace("%1",b.name);(0,$.module$exports$Blockly$Variables.promptName)(f,e,(function(g){if(g){var h=module$contents$Blockly$Variables_nameUsedWithOtherType(g,b.type,a);h?(h=$.module$exports$Blockly$Msg.Msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE.replace("%1",h.name).replace("%2",h.type),(0,module$exports$Blockly$dialog.alert)(h,(function(){d(g)}))):(a.renameVariableById(b.getId(),g),c&&c(g))}else c&&c(null)}))};d("")},$.module$exports$Blockly$Variables.promptName=function(a,b,c){(0,module$exports$Blockly$dialog.prompt)(a,b,(function(d){d&&((d=d.replace(/[\s\xa0]+/g," ").trim())===$.module$exports$Blockly$Msg.Msg.RENAME_VARIABLE||d===$.module$exports$Blockly$Msg.Msg.NEW_VARIABLE)&&(d=null),c(d)}))};var module$contents$Blockly$Variables_nameUsedWithOtherType=function(a,b,c){c=c.getVariableMap().getAllVariables(),a=a.toLowerCase();for(var e,d=0;e=c[d];d++)if(e.name.toLowerCase()===a&&e.type!==b)return e;return null};$.module$exports$Blockly$Variables.nameUsedWithAnyType=function(a,b){b=b.getVariableMap().getAllVariables(),a=a.toLowerCase();for(var d,c=0;d=b[c];c++)if(d.name.toLowerCase()===a)return d;return null},$.module$exports$Blockly$Variables.generateVariableFieldDom=function(a){var b=(0,$.module$exports$Blockly$utils$xml.createElement)("field");return b.setAttribute("name","VAR"),b.setAttribute("id",a.getId()),b.setAttribute("variabletype",a.type),a=(0,$.module$exports$Blockly$utils$xml.createTextNode)(a.name),b.appendChild(a),b},$.module$exports$Blockly$Variables.getOrCreateVariablePackage=function(a,b,c,d){var e=(0,$.module$exports$Blockly$Variables.getVariable)(a,b,c,d);return e||(e=module$contents$Blockly$Variables_createVariable(a,b,c,d)),e},$.module$exports$Blockly$Variables.getVariable=function(a,b,c,d){var e=a.getPotentialVariableMap(),f=null;if(b&&(!(f=a.getVariableById(b))&&e&&(f=e.getVariableById(b)),f))return f;if(c){if(void 0===d)throw Error("Tried to look up a variable by name without a type");!(f=a.getVariable(c,d))&&e&&(f=e.getVariable(c,d))}return f};var module$contents$Blockly$Variables_createVariable=function(a,b,c,d){var e=a.getPotentialVariableMap();return c||(c=$.module$exports$Blockly$Variables.generateUniqueName(a.isFlyout?a.targetWorkspace:a)),e?e.createVariable(c,d,b):a.createVariable(c,d,b)};$.module$exports$Blockly$Variables.getAddedVariables=function(a,b){a=a.getAllVariables();var c=[];if(b.length!==a.length)for(var d=0;d<a.length;d++){var e=a[d];-1===b.indexOf(e)&&c.push(e)}return c},$.module$exports$Blockly$Names={Names:function(a,b){if(this.variablePrefix_=b||"",this.reservedDict_=Object.create(null),a)for(a=a.split(","),b=0;b<a.length;b++)this.reservedDict_[a[b]]=!0;this.reset()},NameType:{DEVELOPER_VARIABLE:"DEVELOPER_VARIABLE",VARIABLE:"VARIABLE",PROCEDURE:"PROCEDURE"}},$.module$exports$Blockly$Names.Names.DEVELOPER_VARIABLE_TYPE=$.module$exports$Blockly$Names.NameType.DEVELOPER_VARIABLE,$.module$exports$Blockly$Names.Names.prototype.reset=function(){this.db_=Object.create(null),this.dbReverse_=Object.create(null),this.variableMap_=null},$.module$exports$Blockly$Names.Names.prototype.setVariableMap=function(a){this.variableMap_=a},$.module$exports$Blockly$Names.Names.prototype.getNameForUserVariable_=function(a){return this.variableMap_?(a=this.variableMap_.getVariableById(a))?a.name:null:(console.warn("Deprecated call to Names.prototype.getName without defining a variable map. To fix, add the following code in your generator's init() function:\nBlockly.YourGeneratorName.nameDB_.setVariableMap(workspace.getVariableMap());"),null)},$.module$exports$Blockly$Names.Names.prototype.populateVariables=function(a){a=(0,$.module$exports$Blockly$Variables.allUsedVarModels)(a);for(var b=0;b<a.length;b++)this.getName(a[b].getId(),$.module$exports$Blockly$Names.NameType.VARIABLE)},$.module$exports$Blockly$Names.Names.prototype.populateProcedures=function(a){a=(a=$.module$exports$Blockly$Procedures.allProcedures(a))[0].concat(a[1]);for(var b=0;b<a.length;b++)this.getName(a[b][0],$.module$exports$Blockly$Names.NameType.PROCEDURE)},$.module$exports$Blockly$Names.Names.prototype.getName=function(a,b){var c=a;b===$.module$exports$Blockly$Names.NameType.VARIABLE&&(a=this.getNameForUserVariable_(a))&&(c=a),a=c.toLowerCase();var d=b===$.module$exports$Blockly$Names.NameType.VARIABLE||b===$.module$exports$Blockly$Names.NameType.DEVELOPER_VARIABLE?this.variablePrefix_:"";b in this.db_||(this.db_[b]=Object.create(null));var e=this.db_[b];return a in e?d+e[a]:(b=this.getDistinctName(c,b),e[a]=b.substr(d.length),b)},$.module$exports$Blockly$Names.Names.prototype.getUserNames=function(a){return Object.keys(this.db_[a]||{})},$.module$exports$Blockly$Names.Names.prototype.getDistinctName=function(a,b){a=this.safeName_(a);for(var c="";this.dbReverse_[a+c]||a+c in this.reservedDict_;)c=c?c+1:2;return a+=c,this.dbReverse_[a]=!0,(b===$.module$exports$Blockly$Names.NameType.VARIABLE||b===$.module$exports$Blockly$Names.NameType.DEVELOPER_VARIABLE?this.variablePrefix_:"")+a},$.module$exports$Blockly$Names.Names.prototype.safeName_=function(a){return a?(a=encodeURI(a.replace(/ /g,"_")).replace(/[^\w]/g,"_"),-1!=="0123456789".indexOf(a[0])&&(a="my_"+a)):a=$.module$exports$Blockly$Msg.Msg.UNNAMED_KEY||"unnamed",a},$.module$exports$Blockly$Names.Names.equals=function(a,b){return a.toLowerCase()===b.toLowerCase()};var module$exports$Blockly$Events$VarDelete={VarDelete:function(a){module$exports$Blockly$Events$VarDelete.VarDelete.superClass_.constructor.call(this,a),a&&(this.varType=a.type,this.varName=a.name)}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$Events$VarDelete.VarDelete,module$exports$Blockly$Events$VarBase.VarBase),module$exports$Blockly$Events$VarDelete.VarDelete.prototype.type=module$exports$Blockly$Events$utils.VAR_DELETE,module$exports$Blockly$Events$VarDelete.VarDelete.prototype.toJson=function(){var a=module$exports$Blockly$Events$VarDelete.VarDelete.superClass_.toJson.call(this);return a.varType=this.varType,a.varName=this.varName,a},module$exports$Blockly$Events$VarDelete.VarDelete.prototype.fromJson=function(a){module$exports$Blockly$Events$VarDelete.VarDelete.superClass_.fromJson.call(this,a),this.varType=a.varType,this.varName=a.varName},module$exports$Blockly$Events$VarDelete.VarDelete.prototype.run=function(a){var b=this.getEventWorkspace_();a?b.deleteVariableById(this.varId):b.createVariable(this.varName,this.varType,this.varId)},(0,module$exports$Blockly$registry.register)(module$exports$Blockly$registry.Type.EVENT,module$exports$Blockly$Events$utils.VAR_DELETE,module$exports$Blockly$Events$VarDelete.VarDelete);var module$exports$Blockly$Events$VarRename={VarRename:function(a,b){module$exports$Blockly$Events$VarRename.VarRename.superClass_.constructor.call(this,a),a&&(this.oldName=a.name,this.newName=void 0===b?"":b)}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$Events$VarRename.VarRename,module$exports$Blockly$Events$VarBase.VarBase),module$exports$Blockly$Events$VarRename.VarRename.prototype.type=module$exports$Blockly$Events$utils.VAR_RENAME,module$exports$Blockly$Events$VarRename.VarRename.prototype.toJson=function(){var a=module$exports$Blockly$Events$VarRename.VarRename.superClass_.toJson.call(this);return a.oldName=this.oldName,a.newName=this.newName,a},module$exports$Blockly$Events$VarRename.VarRename.prototype.fromJson=function(a){module$exports$Blockly$Events$VarRename.VarRename.superClass_.fromJson.call(this,a),this.oldName=a.oldName,this.newName=a.newName},module$exports$Blockly$Events$VarRename.VarRename.prototype.run=function(a){var b=this.getEventWorkspace_();a?b.renameVariableById(this.varId,this.newName):b.renameVariableById(this.varId,this.oldName)},(0,module$exports$Blockly$registry.register)(module$exports$Blockly$registry.Type.EVENT,module$exports$Blockly$Events$utils.VAR_RENAME,module$exports$Blockly$Events$VarRename.VarRename);var module$exports$Blockly$VariableMap={VariableMap:function(a){this.variableMap_=Object.create(null),this.workspace=a}};module$exports$Blockly$VariableMap.VariableMap.prototype.clear=function(){this.variableMap_=Object.create(null)},module$exports$Blockly$VariableMap.VariableMap.prototype.renameVariable=function(a,b){var c=this.getVariable(b,a.type),d=this.workspace.getAllBlocks(!1);(0,module$exports$Blockly$Events$utils.setGroup)(!0);try{c&&c.getId()!==a.getId()?this.renameVariableWithConflict_(a,b,c,d):this.renameVariableAndUses_(a,b,d)}finally{(0,module$exports$Blockly$Events$utils.setGroup)(!1)}},module$exports$Blockly$VariableMap.VariableMap.prototype.renameVariableById=function(a,b){var c=this.getVariableById(a);if(!c)throw Error("Tried to rename a variable that didn't exist. ID: "+a);this.renameVariable(c,b)},module$exports$Blockly$VariableMap.VariableMap.prototype.renameVariableAndUses_=function(a,b,c){for((0,module$exports$Blockly$Events$utils.fire)(new((0,module$exports$Blockly$Events$utils.get)(module$exports$Blockly$Events$utils.VAR_RENAME))(a,b)),a.name=b,b=0;b<c.length;b++)c[b].updateVarName(a)},module$exports$Blockly$VariableMap.VariableMap.prototype.renameVariableWithConflict_=function(a,b,c,d){var e=a.type;for(b!==c.name&&this.renameVariableAndUses_(c,b,d),b=0;b<d.length;b++)d[b].renameVarById(a.getId(),c.getId());(0,module$exports$Blockly$Events$utils.fire)(new((0,module$exports$Blockly$Events$utils.get)(module$exports$Blockly$Events$utils.VAR_DELETE))(a)),module$exports$Blockly$utils$array_removeElem(this.variableMap_[e],a)},module$exports$Blockly$VariableMap.VariableMap.prototype.createVariable=function(a,b,c){var d=this.getVariable(a,b);if(d){if(c&&d.getId()!==c)throw Error('Variable "'+a+'" is already in use and its id is "'+d.getId()+'" which conflicts with the passed in id, "'+c+'".');return d}if(c&&this.getVariableById(c))throw Error('Variable id, "'+c+'", is already in use.');return d=c||(0,module$exports$Blockly$utils$idGenerator.genUid)(),b=b||"",d=new module$exports$Blockly$VariableModel.VariableModel(this.workspace,a,b,d),(a=this.variableMap_[b]||[]).push(d),delete this.variableMap_[b],this.variableMap_[b]=a,d},module$exports$Blockly$VariableMap.VariableMap.prototype.deleteVariable=function(a){for(var b=a.getId(),c=this.variableMap_[a.type],d=0;d<c.length;d++)if(c[d].getId()===b){c.splice(d,1),(0,module$exports$Blockly$Events$utils.fire)(new((0,module$exports$Blockly$Events$utils.get)(module$exports$Blockly$Events$utils.VAR_DELETE))(a));break}},module$exports$Blockly$VariableMap.VariableMap.prototype.deleteVariableById=function(a){var b=this.getVariableById(a);if(b){var c=b.name,d=this.getVariableUsesById(a);a=0;for(var e=void 0;e=d[a];a++)if("procedures_defnoreturn"===e.type||"procedures_defreturn"===e.type)return a=String(e.getFieldValue("NAME")),c=$.module$exports$Blockly$Msg.Msg.CANNOT_DELETE_VARIABLE_PROCEDURE.replace("%1",c).replace("%2",a),void(0,module$exports$Blockly$dialog.alert)(c);var f=this;1<d.length?(c=$.module$exports$Blockly$Msg.Msg.DELETE_VARIABLE_CONFIRMATION.replace("%1",String(d.length)).replace("%2",c),(0,module$exports$Blockly$dialog.confirm)(c,(function(g){g&&b&&f.deleteVariableInternal(b,d)}))):f.deleteVariableInternal(b,d)}else console.warn("Can't delete non-existent variable: "+a)},module$exports$Blockly$VariableMap.VariableMap.prototype.deleteVariableInternal=function(a,b){var c=(0,module$exports$Blockly$Events$utils.getGroup)();c||(0,module$exports$Blockly$Events$utils.setGroup)(!0);try{for(var d=0;d<b.length;d++)b[d].dispose(!0);this.deleteVariable(a)}finally{c||(0,module$exports$Blockly$Events$utils.setGroup)(!1)}},module$exports$Blockly$VariableMap.VariableMap.prototype.getVariable=function(a,b){if(b=this.variableMap_[b||""])for(var d,c=0;d=b[c];c++)if($.module$exports$Blockly$Names.Names.equals(d.name,a))return d;return null},module$exports$Blockly$VariableMap.VariableMap.prototype.getVariableById=function(a){for(var b=Object.keys(this.variableMap_),c=0;c<b.length;c++)for(var f,d=b[c],e=0;f=this.variableMap_[d][e];e++)if(f.getId()===a)return f;return null},module$exports$Blockly$VariableMap.VariableMap.prototype.getVariablesOfType=function(a){return(a=this.variableMap_[a||""])?a.slice():[]},module$exports$Blockly$VariableMap.VariableMap.prototype.getVariableTypes=function(a){var b={};(0,$.module$exports$Blockly$utils$object.mixin)(b,this.variableMap_),a&&a.getPotentialVariableMap()&&(0,$.module$exports$Blockly$utils$object.mixin)(b,a.getPotentialVariableMap().variableMap_),a=Object.keys(b),b=!1;for(var c=0;c<a.length;c++)""===a[c]&&(b=!0);return b||a.push(""),a},module$exports$Blockly$VariableMap.VariableMap.prototype.getAllVariables=function(){var b,a=[];for(b in this.variableMap_)a=a.concat(this.variableMap_[b]);return a},module$exports$Blockly$VariableMap.VariableMap.prototype.getAllVariableNames=function(){var b,a=[];for(b in this.variableMap_)for(var e,c=this.variableMap_[b],d=0;e=c[d];d++)a.push(e.name);return a},module$exports$Blockly$VariableMap.VariableMap.prototype.getVariableUsesById=function(a){for(var b=[],c=this.workspace.getAllBlocks(!1),d=0;d<c.length;d++){var e=c[d].getVarModels();if(e)for(var f=0;f<e.length;f++)e[f].getId()===a&&b.push(c[d])}return b};var module$exports$Blockly$Events$BlockMove={BlockMove:function(a){module$exports$Blockly$Events$BlockMove.BlockMove.superClass_.constructor.call(this,a),a&&(a.isShadow()&&(this.recordUndo=!1),a=this.currentLocation_(),this.oldParentId=a.parentId,this.oldInputName=a.inputName,this.oldCoordinate=a.coordinate)}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$Events$BlockMove.BlockMove,module$exports$Blockly$Events$BlockBase.BlockBase),module$exports$Blockly$Events$BlockMove.BlockMove.prototype.type=module$exports$Blockly$Events$utils.MOVE,module$exports$Blockly$Events$BlockMove.BlockMove.prototype.toJson=function(){var a=module$exports$Blockly$Events$BlockMove.BlockMove.superClass_.toJson.call(this);return this.newParentId&&(a.newParentId=this.newParentId),this.newInputName&&(a.newInputName=this.newInputName),this.newCoordinate&&(a.newCoordinate=Math.round(this.newCoordinate.x)+","+Math.round(this.newCoordinate.y)),this.recordUndo||(a.recordUndo=this.recordUndo),a},module$exports$Blockly$Events$BlockMove.BlockMove.prototype.fromJson=function(a){if(module$exports$Blockly$Events$BlockMove.BlockMove.superClass_.fromJson.call(this,a),this.newParentId=a.newParentId,this.newInputName=a.newInputName,a.newCoordinate){var b=a.newCoordinate.split(",");this.newCoordinate=new module$exports$Blockly$utils$Coordinate.Coordinate(Number(b[0]),Number(b[1]))}void 0!==a.recordUndo&&(this.recordUndo=a.recordUndo)},module$exports$Blockly$Events$BlockMove.BlockMove.prototype.recordNew=function(){var a=this.currentLocation_();this.newParentId=a.parentId,this.newInputName=a.inputName,this.newCoordinate=a.coordinate},module$exports$Blockly$Events$BlockMove.BlockMove.prototype.currentLocation_=function(){var a=this.getEventWorkspace_().getBlockById(this.blockId),b={},c=a.getParent();return c?(b.parentId=c.id,(a=c.getInputWithBlock(a))&&(b.inputName=a.name)):b.coordinate=a.getRelativeToSurfaceXY(),b},module$exports$Blockly$Events$BlockMove.BlockMove.prototype.isNull=function(){return this.oldParentId===this.newParentId&&this.oldInputName===this.newInputName&&module$exports$Blockly$utils$Coordinate.Coordinate.equals(this.oldCoordinate,this.newCoordinate)},module$exports$Blockly$Events$BlockMove.BlockMove.prototype.run=function(a){var b=this.getEventWorkspace_(),c=b.getBlockById(this.blockId);if(c){var d=a?this.newParentId:this.oldParentId,e=a?this.newInputName:this.oldInputName;if(a=a?this.newCoordinate:this.oldCoordinate,d){var f=b.getBlockById(d);if(!f)return void console.warn("Can't connect to non-existent block: "+d)}if(c.getParent()&&c.unplug(),a)e=c.getRelativeToSurfaceXY(),c.moveBy(a.x-e.x,a.y-e.y);else{if((!(b=c.outputConnection)||c.previousConnection&&c.previousConnection.isConnected())&&(b=c.previousConnection),c=b.type,e){if(c=f.getInput(e))var g=c.connection}else c===$.module$exports$Blockly$ConnectionType.ConnectionType.PREVIOUS_STATEMENT&&(g=f.nextConnection);g?b.connect(g):console.warn("Can't connect to non-existent input: "+e)}}else console.warn("Can't move non-existent block: "+this.blockId)},(0,module$exports$Blockly$registry.register)(module$exports$Blockly$registry.Type.EVENT,module$exports$Blockly$Events$utils.MOVE,module$exports$Blockly$Events$BlockMove.BlockMove);var module$exports$Blockly$constants={COLLAPSED_INPUT_NAME:"_TEMP_COLLAPSED_INPUT",COLLAPSED_FIELD_NAME:"_TEMP_COLLAPSED_FIELD"},module$exports$Blockly$Connection={Connection:function(a,b){this.sourceBlock_=a,this.type=b}};module$exports$Blockly$Connection.Connection.CAN_CONNECT=0,module$exports$Blockly$Connection.Connection.REASON_SELF_CONNECTION=1,module$exports$Blockly$Connection.Connection.REASON_WRONG_TYPE=2,module$exports$Blockly$Connection.Connection.REASON_TARGET_NULL=3,module$exports$Blockly$Connection.Connection.REASON_CHECKS_FAILED=4,module$exports$Blockly$Connection.Connection.REASON_DIFFERENT_WORKSPACES=5,module$exports$Blockly$Connection.Connection.REASON_SHADOW_PARENT=6,module$exports$Blockly$Connection.Connection.REASON_DRAG_CHECKS_FAILED=7,module$exports$Blockly$Connection.Connection.REASON_PREVIOUS_AND_OUTPUT=8,module$exports$Blockly$Connection.Connection.prototype.targetConnection=null,module$exports$Blockly$Connection.Connection.prototype.disposed=!1,module$exports$Blockly$Connection.Connection.prototype.check_=null,module$exports$Blockly$Connection.Connection.prototype.shadowDom_=null,module$exports$Blockly$Connection.Connection.prototype.x=0,module$exports$Blockly$Connection.Connection.prototype.y=0,module$exports$Blockly$Connection.Connection.prototype.connect_=function(a){var h,b=$.module$exports$Blockly$ConnectionType.ConnectionType.INPUT_VALUE,c=this.getSourceBlock(),d=a.getSourceBlock();if(a.isConnected()&&a.disconnect(),this.isConnected()){var e=this.stashShadowState_(),f=this.targetBlock();if(f.isShadow())f.dispose(!1);else{this.disconnect();var g=f}this.applyShadowState_(e)}(0,module$exports$Blockly$Events$utils.isEnabled)()&&(h=new((0,module$exports$Blockly$Events$utils.get)(module$exports$Blockly$Events$utils.MOVE))(d)),module$contents$Blockly$Connection_connectReciprocally(this,a),d.setParent(c),h&&(h.recordNew(),(0,module$exports$Blockly$Events$utils.fire)(h)),g&&(a=this.type===b?g.outputConnection:g.previousConnection,(d=module$exports$Blockly$Connection.Connection.getConnectionForOrphanedConnection(d,a))?a.connect(d):a.onFailedConnect(this))},module$exports$Blockly$Connection.Connection.prototype.dispose=function(){if(this.isConnected()){this.setShadowStateInternal_();var a=this.targetBlock();a&&a.unplug()}this.disposed=!0},module$exports$Blockly$Connection.Connection.prototype.getSourceBlock=function(){return this.sourceBlock_},module$exports$Blockly$Connection.Connection.prototype.isSuperior=function(){return this.type===$.module$exports$Blockly$ConnectionType.ConnectionType.INPUT_VALUE||this.type===$.module$exports$Blockly$ConnectionType.ConnectionType.NEXT_STATEMENT},module$exports$Blockly$Connection.Connection.prototype.isConnected=function(){return!!this.targetConnection},module$exports$Blockly$Connection.Connection.prototype.getConnectionChecker=function(){return this.sourceBlock_.workspace.connectionChecker},module$exports$Blockly$Connection.Connection.prototype.onFailedConnect=function(a){},module$exports$Blockly$Connection.Connection.prototype.connect=function(a){if(this.targetConnection===a)return!0;if(this.getConnectionChecker().canConnect(this,a,!1)){var b=(0,module$exports$Blockly$Events$utils.getGroup)();b||(0,module$exports$Blockly$Events$utils.setGroup)(!0),this.isSuperior()?this.connect_(a):a.connect_(this),b||(0,module$exports$Blockly$Events$utils.setGroup)(!1)}return this.isConnected()};var module$contents$Blockly$Connection_connectReciprocally=function(a,b){if(!a||!b)throw Error("Cannot connect null connections.");a.targetConnection=b,b.targetConnection=a},module$contents$Blockly$Connection_getSingleConnection=function(a,b){for(var f,c=null,d=(b=b.outputConnection).getConnectionChecker(),e=0;f=a.inputList[e];e++)if((f=f.connection)&&d.canConnect(b,f,!1)){if(c)return null;c=f}return c};module$exports$Blockly$Connection.Connection.getConnectionForOrphanedConnection=function(a,b){if(b.type===$.module$exports$Blockly$ConnectionType.ConnectionType.OUTPUT_VALUE)return function(a,b){for(var c;c=module$contents$Blockly$Connection_getSingleConnection(a,b);)if(!(a=c.targetBlock())||a.isShadow())return c;return null}(a,b.getSourceBlock());a=a.lastConnectionInStack(!0);var c=b.getConnectionChecker();return a&&c.canConnect(b,a,!1)?a:null},module$exports$Blockly$Connection.Connection.prototype.disconnect=function(){var a=this.targetConnection;if(!a)throw Error("Source connection not connected.");if(a.targetConnection!==this)throw Error("Target connection not connected to source connection.");if(this.isSuperior()){var b=this.sourceBlock_,c=a.getSourceBlock();a=this}else b=a.getSourceBlock(),c=this.sourceBlock_;var d=(0,module$exports$Blockly$Events$utils.getGroup)();d||(0,module$exports$Blockly$Events$utils.setGroup)(!0),this.disconnectInternal_(b,c),c.isShadow()||a.respawnShadow_(),d||(0,module$exports$Blockly$Events$utils.setGroup)(!1)},module$exports$Blockly$Connection.Connection.prototype.disconnectInternal_=function(a,b){var c;(0,module$exports$Blockly$Events$utils.isEnabled)()&&(c=new((0,module$exports$Blockly$Events$utils.get)(module$exports$Blockly$Events$utils.MOVE))(b)),this.targetConnection=this.targetConnection.targetConnection=null,b.setParent(null),c&&(c.recordNew(),(0,module$exports$Blockly$Events$utils.fire)(c))},module$exports$Blockly$Connection.Connection.prototype.respawnShadow_=function(){this.createShadowBlock_(!0)},module$exports$Blockly$Connection.Connection.prototype.targetBlock=function(){return this.isConnected()?this.targetConnection.getSourceBlock():null},module$exports$Blockly$Connection.Connection.prototype.onCheckChanged_=function(){!this.isConnected()||this.targetConnection&&this.getConnectionChecker().canConnect(this,this.targetConnection,!1)||(this.isSuperior()?this.targetBlock():this.sourceBlock_).unplug()},module$exports$Blockly$Connection.Connection.prototype.setCheck=function(a){return a?(Array.isArray(a)||(a=[a]),this.check_=a,this.onCheckChanged_()):this.check_=null,this},module$exports$Blockly$Connection.Connection.prototype.getCheck=function(){return this.check_},module$exports$Blockly$Connection.Connection.prototype.setShadowDom=function(a){this.setShadowStateInternal_({shadowDom:a})},module$exports$Blockly$Connection.Connection.prototype.getShadowDom=function(a){return a&&this.targetBlock().isShadow()?(0,$.module$exports$Blockly$Xml.blockToDom)(this.targetBlock()):this.shadowDom_},module$exports$Blockly$Connection.Connection.prototype.setShadowState=function(a){this.setShadowStateInternal_({shadowState:a})},module$exports$Blockly$Connection.Connection.prototype.getShadowState=function(a){return a&&this.targetBlock()&&this.targetBlock().isShadow()?(0,module$exports$Blockly$serialization$blocks.save)(this.targetBlock()):this.shadowState_},module$exports$Blockly$Connection.Connection.prototype.neighbours=function(a){return[]},module$exports$Blockly$Connection.Connection.prototype.getParentInput=function(){for(var a=null,b=this.sourceBlock_.inputList,c=0;c<b.length;c++)if(b[c].connection===this){a=b[c];break}return a},module$exports$Blockly$Connection.Connection.prototype.toString=function(){var a=this.sourceBlock_;if(!a)return"Orphan Connection";if(a.outputConnection===this)var b="Output Connection of ";else if(a.previousConnection===this)b="Previous Connection of ";else if(a.nextConnection===this)b="Next Connection of ";else{b=null;for(var d,c=0;d=a.inputList[c];c++)if(d.connection===this){b=d;break}if(!b)return console.warn("Connection not actually connected to sourceBlock_"),"Orphan Connection";b='Input "'+b.name+'" connection on '}return b+a.toDevString()},module$exports$Blockly$Connection.Connection.prototype.stashShadowState_=function(){var a=this.getShadowDom(!0),b=this.getShadowState(!0);return this.shadowState_=this.shadowDom_=null,{shadowDom:a,shadowState:b}},module$exports$Blockly$Connection.Connection.prototype.applyShadowState_=function(a){var b=a.shadowState;this.shadowDom_=a.shadowDom,this.shadowState_=b},module$exports$Blockly$Connection.Connection.prototype.setShadowStateInternal_=function(a){var b=void 0===(a=void 0===a?{}:a).shadowState?null:a.shadowState;this.shadowDom_=void 0===a.shadowDom?null:a.shadowDom,this.shadowState_=b,(a=this.targetBlock())?a.isShadow()?(a.dispose(!1),this.respawnShadow_(),this.targetBlock()&&this.targetBlock().isShadow()&&this.serializeShadow_(this.targetBlock())):(a=this.createShadowBlock_(!1),this.serializeShadow_(a),a&&a.dispose(!1)):(this.respawnShadow_(),this.targetBlock()&&this.targetBlock().isShadow()&&this.serializeShadow_(this.targetBlock()))},module$exports$Blockly$Connection.Connection.prototype.createShadowBlock_=function(a){var b=this.getSourceBlock(),c=this.getShadowState(),d=this.getShadowDom();if(!b.workspace||!c&&!d)return null;if(c)return(0,module$exports$Blockly$serialization$blocks.appendInternal)(c,b.workspace,{parentConnection:a?this:void 0,isShadow:!0,recordUndo:!1});if(d){if(b=(0,$.module$exports$Blockly$Xml.domToBlock)(d,b.workspace),a)if(this.type===$.module$exports$Blockly$ConnectionType.ConnectionType.INPUT_VALUE){if(!b.outputConnection)throw Error("Shadow block is missing an output connection");if(!this.connect(b.outputConnection))throw Error("Could not connect shadow block to connection")}else{if(this.type!==$.module$exports$Blockly$ConnectionType.ConnectionType.NEXT_STATEMENT)throw Error("Cannot connect a shadow block to a previous/output connection");if(!b.previousConnection)throw Error("Shadow block is missing previous connection");if(!this.connect(b.previousConnection))throw Error("Could not connect shadow block to connection")}return b}return null},module$exports$Blockly$Connection.Connection.prototype.serializeShadow_=function(a){a&&(this.shadowDom_=(0,$.module$exports$Blockly$Xml.blockToDom)(a),this.shadowState_=(0,module$exports$Blockly$serialization$blocks.save)(a))};var module$exports$Blockly$ConnectionChecker={ConnectionChecker:function(){}};module$exports$Blockly$ConnectionChecker.ConnectionChecker.prototype.canConnect=function(a,b,c,d){return this.canConnectWithReason(a,b,c,d)===module$exports$Blockly$Connection.Connection.CAN_CONNECT},module$exports$Blockly$ConnectionChecker.ConnectionChecker.prototype.canConnectWithReason=function(a,b,c,d){var e=this.doSafetyChecks(a,b);return e!==module$exports$Blockly$Connection.Connection.CAN_CONNECT?e:this.doTypeChecks(a,b)?c&&!this.doDragChecks(a,b,d||0)?module$exports$Blockly$Connection.Connection.REASON_DRAG_CHECKS_FAILED:module$exports$Blockly$Connection.Connection.CAN_CONNECT:module$exports$Blockly$Connection.Connection.REASON_CHECKS_FAILED},module$exports$Blockly$ConnectionChecker.ConnectionChecker.prototype.getErrorMessage=function(a,b,c){switch(a){case module$exports$Blockly$Connection.Connection.REASON_SELF_CONNECTION:return"Attempted to connect a block to itself.";case module$exports$Blockly$Connection.Connection.REASON_DIFFERENT_WORKSPACES:return"Blocks not on same workspace.";case module$exports$Blockly$Connection.Connection.REASON_WRONG_TYPE:return"Attempt to connect incompatible types.";case module$exports$Blockly$Connection.Connection.REASON_TARGET_NULL:return"Target connection is null.";case module$exports$Blockly$Connection.Connection.REASON_CHECKS_FAILED:return"Connection checks failed. "+b+" expected "+b.getCheck()+", found "+c.getCheck();case module$exports$Blockly$Connection.Connection.REASON_SHADOW_PARENT:return"Connecting non-shadow to shadow block.";case module$exports$Blockly$Connection.Connection.REASON_DRAG_CHECKS_FAILED:return"Drag checks failed.";case module$exports$Blockly$Connection.Connection.REASON_PREVIOUS_AND_OUTPUT:return"Block would have an output and a previous connection.";default:return"Unknown connection failure: this should never happen!"}},module$exports$Blockly$ConnectionChecker.ConnectionChecker.prototype.doSafetyChecks=function(a,b){if(!a||!b)return module$exports$Blockly$Connection.Connection.REASON_TARGET_NULL;if(a.isSuperior())var c=a.getSourceBlock(),d=b.getSourceBlock(),e=b;else d=a.getSourceBlock(),c=b.getSourceBlock(),e=a,a=b;return c===d?module$exports$Blockly$Connection.Connection.REASON_SELF_CONNECTION:e.type!==$.module$exports$Blockly$internalConstants.OPPOSITE_TYPE[a.type]?module$exports$Blockly$Connection.Connection.REASON_WRONG_TYPE:c.workspace!==d.workspace?module$exports$Blockly$Connection.Connection.REASON_DIFFERENT_WORKSPACES:c.isShadow()&&!d.isShadow()?module$exports$Blockly$Connection.Connection.REASON_SHADOW_PARENT:e.type===$.module$exports$Blockly$ConnectionType.ConnectionType.OUTPUT_VALUE&&d.previousConnection&&d.previousConnection.isConnected()||e.type===$.module$exports$Blockly$ConnectionType.ConnectionType.PREVIOUS_STATEMENT&&d.outputConnection&&d.outputConnection.isConnected()?module$exports$Blockly$Connection.Connection.REASON_PREVIOUS_AND_OUTPUT:module$exports$Blockly$Connection.Connection.CAN_CONNECT},module$exports$Blockly$ConnectionChecker.ConnectionChecker.prototype.doTypeChecks=function(a,b){if(a=a.getCheck(),b=b.getCheck(),!a||!b)return!0;for(var c=0;c<a.length;c++)if(-1!==b.indexOf(a[c]))return!0;return!1},module$exports$Blockly$ConnectionChecker.ConnectionChecker.prototype.doDragChecks=function(a,b,c){if(a.distanceFrom(b)>c||b.getSourceBlock().isInsertionMarker())return!1;switch(b.type){case $.module$exports$Blockly$ConnectionType.ConnectionType.PREVIOUS_STATEMENT:return this.canConnectToPrevious_(a,b);case $.module$exports$Blockly$ConnectionType.ConnectionType.OUTPUT_VALUE:if(b.isConnected()&&!b.targetBlock().isInsertionMarker()||a.isConnected())return!1;break;case $.module$exports$Blockly$ConnectionType.ConnectionType.INPUT_VALUE:if(b.isConnected()&&!b.targetBlock().isMovable()&&!b.targetBlock().isShadow())return!1;break;case $.module$exports$Blockly$ConnectionType.ConnectionType.NEXT_STATEMENT:if(b.isConnected()&&!a.getSourceBlock().nextConnection&&!b.targetBlock().isShadow()&&b.targetBlock().nextConnection)return!1;break;default:return!1}return-1===$.module$exports$Blockly$common.draggingConnections.indexOf(b)},module$exports$Blockly$ConnectionChecker.ConnectionChecker.prototype.canConnectToPrevious_=function(a,b){return!(a.targetConnection||-1!==$.module$exports$Blockly$common.draggingConnections.indexOf(b)||b.targetConnection&&(!(a=b.targetBlock()).isInsertionMarker()||a.getPreviousBlock()))},(0,module$exports$Blockly$registry.register)(module$exports$Blockly$registry.Type.CONNECTION_CHECKER,module$exports$Blockly$registry.DEFAULT,module$exports$Blockly$ConnectionChecker.ConnectionChecker);var module$exports$Blockly$Workspace={},module$contents$Blockly$Workspace_WorkspaceDB_=Object.create(null);module$exports$Blockly$Workspace.Workspace=function(a){this.id=(0,module$exports$Blockly$utils$idGenerator.genUid)(),module$contents$Blockly$Workspace_WorkspaceDB_[this.id]=this,this.options=a||new module$exports$Blockly$Options.Options({}),this.RTL=!!this.options.RTL,this.horizontalLayout=!!this.options.horizontalLayout,this.toolboxPosition=this.options.toolboxPosition,this.connectionChecker=new((0,module$exports$Blockly$registry.getClassFromOptions)(module$exports$Blockly$registry.Type.CONNECTION_CHECKER,this.options,!0))(this),this.topBlocks_=[],this.topComments_=[],this.commentDB_=Object.create(null),this.listeners_=[],this.undoStack_=[],this.redoStack_=[],this.blockDB_=Object.create(null),this.typedBlocksDB_=Object.create(null),this.variableMap_=new module$exports$Blockly$VariableMap.VariableMap(this),this.potentialVariableMap_=null},module$exports$Blockly$Workspace.Workspace.prototype.rendered=!1,module$exports$Blockly$Workspace.Workspace.prototype.isClearing=!1,module$exports$Blockly$Workspace.Workspace.prototype.MAX_UNDO=1024,module$exports$Blockly$Workspace.Workspace.prototype.connectionDBList=null,module$exports$Blockly$Workspace.Workspace.prototype.dispose=function(){this.listeners_.length=0,this.clear(),delete module$contents$Blockly$Workspace_WorkspaceDB_[this.id]},module$exports$Blockly$Workspace.Workspace.SCAN_ANGLE=3,module$exports$Blockly$Workspace.Workspace.prototype.sortObjects_=function(a,b){return a=a.getRelativeToSurfaceXY(),b=b.getRelativeToSurfaceXY(),a.y+module$exports$Blockly$Workspace.Workspace.prototype.sortObjects_.offset*a.x-(b.y+module$exports$Blockly$Workspace.Workspace.prototype.sortObjects_.offset*b.x)},module$exports$Blockly$Workspace.Workspace.prototype.addTopBlock=function(a){this.topBlocks_.push(a)},module$exports$Blockly$Workspace.Workspace.prototype.removeTopBlock=function(a){if(!module$exports$Blockly$utils$array_removeElem(this.topBlocks_,a))throw Error("Block not present in workspace's list of top-most blocks.")},module$exports$Blockly$Workspace.Workspace.prototype.getTopBlocks=function(a){var b=[].concat(this.topBlocks_);return a&&1<b.length&&(this.sortObjects_.offset=Math.sin((0,module$exports$Blockly$utils$math.toRadians)(module$exports$Blockly$Workspace.Workspace.SCAN_ANGLE)),this.RTL&&(this.sortObjects_.offset*=-1),b.sort(this.sortObjects_)),b},module$exports$Blockly$Workspace.Workspace.prototype.addTypedBlock=function(a){this.typedBlocksDB_[a.type]||(this.typedBlocksDB_[a.type]=[]),this.typedBlocksDB_[a.type].push(a)},module$exports$Blockly$Workspace.Workspace.prototype.removeTypedBlock=function(a){module$exports$Blockly$utils$array_removeElem(this.typedBlocksDB_[a.type],a),this.typedBlocksDB_[a.type].length||delete this.typedBlocksDB_[a.type]},module$exports$Blockly$Workspace.Workspace.prototype.getBlocksByType=function(a,b){return this.typedBlocksDB_[a]?(a=this.typedBlocksDB_[a].slice(0),b&&1<a.length&&(this.sortObjects_.offset=Math.sin((0,module$exports$Blockly$utils$math.toRadians)(module$exports$Blockly$Workspace.Workspace.SCAN_ANGLE)),this.RTL&&(this.sortObjects_.offset*=-1),a.sort(this.sortObjects_)),a.filter((function(c){return!c.isInsertionMarker()}))):[]},module$exports$Blockly$Workspace.Workspace.prototype.addTopComment=function(a){this.topComments_.push(a),this.commentDB_[a.id]&&console.warn('Overriding an existing comment on this workspace, with id "'+a.id+'"'),this.commentDB_[a.id]=a},module$exports$Blockly$Workspace.Workspace.prototype.removeTopComment=function(a){if(!module$exports$Blockly$utils$array_removeElem(this.topComments_,a))throw Error("Comment not present in workspace's list of top-most comments.");delete this.commentDB_[a.id]},module$exports$Blockly$Workspace.Workspace.prototype.getTopComments=function(a){var b=[].concat(this.topComments_);return a&&1<b.length&&(this.sortObjects_.offset=Math.sin((0,module$exports$Blockly$utils$math.toRadians)(module$exports$Blockly$Workspace.Workspace.SCAN_ANGLE)),this.RTL&&(this.sortObjects_.offset*=-1),b.sort(this.sortObjects_)),b},module$exports$Blockly$Workspace.Workspace.prototype.getAllBlocks=function(a){if(a){var b=this.getTopBlocks(!0);a=[];for(var c=0;c<b.length;c++)a.push.apply(a,b[c].getDescendants(!0))}else for(a=this.getTopBlocks(!1),b=0;b<a.length;b++)a.push.apply(a,a[b].getChildren(!1));return a.filter((function(d){return!d.isInsertionMarker()}))},module$exports$Blockly$Workspace.Workspace.prototype.clear=function(){this.isClearing=!0;try{var a=(0,module$exports$Blockly$Events$utils.getGroup)();for(a||(0,module$exports$Blockly$Events$utils.setGroup)(!0);this.topBlocks_.length;)this.topBlocks_[0].dispose(!1);for(;this.topComments_.length;)this.topComments_[this.topComments_.length-1].dispose();a||(0,module$exports$Blockly$Events$utils.setGroup)(!1),this.variableMap_.clear(),this.potentialVariableMap_&&this.potentialVariableMap_.clear()}finally{this.isClearing=!1}},module$exports$Blockly$Workspace.Workspace.prototype.renameVariableById=function(a,b){this.variableMap_.renameVariableById(a,b)},module$exports$Blockly$Workspace.Workspace.prototype.createVariable=function(a,b,c){return this.variableMap_.createVariable(a,b,c)},module$exports$Blockly$Workspace.Workspace.prototype.getVariableUsesById=function(a){return this.variableMap_.getVariableUsesById(a)},module$exports$Blockly$Workspace.Workspace.prototype.deleteVariableById=function(a){this.variableMap_.deleteVariableById(a)},module$exports$Blockly$Workspace.Workspace.prototype.getVariable=function(a,b){return this.variableMap_.getVariable(a,b)},module$exports$Blockly$Workspace.Workspace.prototype.getVariableById=function(a){return this.variableMap_.getVariableById(a)},module$exports$Blockly$Workspace.Workspace.prototype.getVariablesOfType=function(a){return this.variableMap_.getVariablesOfType(a)},module$exports$Blockly$Workspace.Workspace.prototype.getVariableTypes=function(){return this.variableMap_.getVariableTypes(this)},module$exports$Blockly$Workspace.Workspace.prototype.getAllVariables=function(){return this.variableMap_.getAllVariables()},module$exports$Blockly$Workspace.Workspace.prototype.getAllVariableNames=function(){return this.variableMap_.getAllVariableNames()},module$exports$Blockly$Workspace.Workspace.prototype.getWidth=function(){return 0},module$exports$Blockly$Workspace.Workspace.prototype.newBlock=function(a,b){return new module$exports$Blockly$Block.Block(this,a,b)},module$exports$Blockly$Workspace.Workspace.prototype.remainingCapacity=function(){return isNaN(this.options.maxBlocks)?1/0:this.options.maxBlocks-this.getAllBlocks(!1).length},module$exports$Blockly$Workspace.Workspace.prototype.remainingCapacityOfType=function(a){return this.options.maxInstances?(void 0!==this.options.maxInstances[a]?this.options.maxInstances[a]:1/0)-this.getBlocksByType(a,!1).length:1/0},module$exports$Blockly$Workspace.Workspace.prototype.isCapacityAvailable=function(a){if(!this.hasBlockLimits())return!0;var c,b=0;for(c in a){if(a[c]>this.remainingCapacityOfType(c))return!1;b+=a[c]}return!(b>this.remainingCapacity())},module$exports$Blockly$Workspace.Workspace.prototype.hasBlockLimits=function(){return 1/0!==this.options.maxBlocks||!!this.options.maxInstances},module$exports$Blockly$Workspace.Workspace.prototype.getUndoStack=function(){return this.undoStack_},module$exports$Blockly$Workspace.Workspace.prototype.getRedoStack=function(){return this.redoStack_},module$exports$Blockly$Workspace.Workspace.prototype.undo=function(a){var b=a?this.redoStack_:this.undoStack_,c=a?this.undoStack_:this.redoStack_,d=b.pop();if(d){for(var e=[d];b.length&&d.group&&d.group===b[b.length-1].group;)e.push(b.pop());for(b=0;b<e.length;b++)c.push(e[b]);e=(0,module$exports$Blockly$Events$utils.filter)(e,a),(0,module$exports$Blockly$Events$utils.setRecordUndo)(!1);try{for(c=0;c<e.length;c++)e[c].run(a)}finally{(0,module$exports$Blockly$Events$utils.setRecordUndo)(!0)}}},module$exports$Blockly$Workspace.Workspace.prototype.clearUndo=function(){this.undoStack_.length=0,this.redoStack_.length=0,(0,module$exports$Blockly$Events$utils.clearPendingUndo)()},module$exports$Blockly$Workspace.Workspace.prototype.addChangeListener=function(a){return this.listeners_.push(a),a},module$exports$Blockly$Workspace.Workspace.prototype.removeChangeListener=function(a){module$exports$Blockly$utils$array_removeElem(this.listeners_,a)},module$exports$Blockly$Workspace.Workspace.prototype.fireChangeListener=function(a){if(a.recordUndo)for(this.undoStack_.push(a),this.redoStack_.length=0;this.undoStack_.length>this.MAX_UNDO&&0<=this.MAX_UNDO;)this.undoStack_.shift();for(var b=0;b<this.listeners_.length;b++)(0,this.listeners_[b])(a)},module$exports$Blockly$Workspace.Workspace.prototype.getBlockById=function(a){return this.blockDB_[a]||null},module$exports$Blockly$Workspace.Workspace.prototype.setBlockById=function(a,b){this.blockDB_[a]=b},module$exports$Blockly$Workspace.Workspace.prototype.removeBlockById=function(a){delete this.blockDB_[a]},module$exports$Blockly$Workspace.Workspace.prototype.getCommentById=function(a){return this.commentDB_[a]||null},module$exports$Blockly$Workspace.Workspace.prototype.allInputsFilled=function(a){for(var b=this.getTopBlocks(!1),c=0;c<b.length;c++)if(!b[c].allInputsFilled(a))return!1;return!0},module$exports$Blockly$Workspace.Workspace.prototype.getPotentialVariableMap=function(){return this.potentialVariableMap_},module$exports$Blockly$Workspace.Workspace.prototype.createPotentialVariableMap=function(){this.potentialVariableMap_=new module$exports$Blockly$VariableMap.VariableMap(this)},module$exports$Blockly$Workspace.Workspace.prototype.getVariableMap=function(){return this.variableMap_},module$exports$Blockly$Workspace.Workspace.prototype.setVariableMap=function(a){this.variableMap_=a},module$exports$Blockly$Workspace.Workspace.getById=function(a){return module$contents$Blockly$Workspace_WorkspaceDB_[a]||null},module$exports$Blockly$Workspace.Workspace.getAll=function(){var b,a=[];for(b in module$contents$Blockly$Workspace_WorkspaceDB_)a.push(module$contents$Blockly$Workspace_WorkspaceDB_[b]);return a};var module$exports$Blockly$Bubble={Bubble:function(a,b,c,d,e,f){this.workspace_=a,this.content_=b,this.shape_=c,this.onMouseDownResizeWrapper_=this.onMouseDownBubbleWrapper_=this.moveCallback_=this.resizeCallback_=null,this.disposed=!1,c=module$exports$Blockly$Bubble.Bubble.ARROW_ANGLE,this.workspace_.RTL&&(c=-c),this.arrow_radians_=(0,module$exports$Blockly$utils$math.toRadians)(c),a.getBubbleCanvas().appendChild(this.createDom_(b,!(!e||!f))),this.setAnchorLocation(d),e&&f||(e=(a=this.content_.getBBox()).width+2*module$exports$Blockly$Bubble.Bubble.BORDER_WIDTH,f=a.height+2*module$exports$Blockly$Bubble.Bubble.BORDER_WIDTH),this.setBubbleSize(e,f),this.positionBubble_(),this.renderArrow_(),this.rendered_=!0}};module$exports$Blockly$Bubble.Bubble.BORDER_WIDTH=6,module$exports$Blockly$Bubble.Bubble.ARROW_THICKNESS=5,module$exports$Blockly$Bubble.Bubble.ARROW_ANGLE=20,module$exports$Blockly$Bubble.Bubble.ARROW_BEND=4,module$exports$Blockly$Bubble.Bubble.ANCHOR_RADIUS=8,module$exports$Blockly$Bubble.Bubble.onMouseUpWrapper_=null,module$exports$Blockly$Bubble.Bubble.onMouseMoveWrapper_=null,module$exports$Blockly$Bubble.Bubble.unbindDragEvents_=function(){module$exports$Blockly$Bubble.Bubble.onMouseUpWrapper_&&((0,module$exports$Blockly$browserEvents.unbind)(module$exports$Blockly$Bubble.Bubble.onMouseUpWrapper_),module$exports$Blockly$Bubble.Bubble.onMouseUpWrapper_=null),module$exports$Blockly$Bubble.Bubble.onMouseMoveWrapper_&&((0,module$exports$Blockly$browserEvents.unbind)(module$exports$Blockly$Bubble.Bubble.onMouseMoveWrapper_),module$exports$Blockly$Bubble.Bubble.onMouseMoveWrapper_=null)},module$exports$Blockly$Bubble.Bubble.bubbleMouseUp_=function(a){(0,module$exports$Blockly$Touch.clearTouchIdentifier)(),module$exports$Blockly$Bubble.Bubble.unbindDragEvents_()},module$exports$Blockly$Bubble.Bubble.prototype.rendered_=!1,module$exports$Blockly$Bubble.Bubble.prototype.anchorXY_=null,module$exports$Blockly$Bubble.Bubble.prototype.relativeLeft_=0,module$exports$Blockly$Bubble.Bubble.prototype.relativeTop_=0,module$exports$Blockly$Bubble.Bubble.prototype.width_=0,module$exports$Blockly$Bubble.Bubble.prototype.height_=0,module$exports$Blockly$Bubble.Bubble.prototype.autoLayout_=!0,module$exports$Blockly$Bubble.Bubble.prototype.createDom_=function(a,b){this.bubbleGroup_=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.G,{},null);var c={filter:"url(#"+this.workspace_.getRenderer().getConstants().embossFilterId+")"};return module$exports$Blockly$utils$userAgent.JAVA_FX&&(c={}),c=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.G,c,this.bubbleGroup_),this.bubbleArrow_=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.PATH,{},c),this.bubbleBack_=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.RECT,{class:"blocklyDraggable",x:0,y:0,rx:module$exports$Blockly$Bubble.Bubble.BORDER_WIDTH,ry:module$exports$Blockly$Bubble.Bubble.BORDER_WIDTH},c),b?(this.resizeGroup_=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.G,{class:this.workspace_.RTL?"blocklyResizeSW":"blocklyResizeSE"},this.bubbleGroup_),b=2*module$exports$Blockly$Bubble.Bubble.BORDER_WIDTH,(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.POLYGON,{points:"0,x x,x x,0".replace(/x/g,b.toString())},this.resizeGroup_),(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.LINE,{class:"blocklyResizeLine",x1:b/3,y1:b-1,x2:b-1,y2:b/3},this.resizeGroup_),(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.LINE,{class:"blocklyResizeLine",x1:2*b/3,y1:b-1,x2:b-1,y2:2*b/3},this.resizeGroup_)):this.resizeGroup_=null,this.workspace_.options.readOnly||(this.onMouseDownBubbleWrapper_=(0,module$exports$Blockly$browserEvents.conditionalBind)(this.bubbleBack_,"mousedown",this,this.bubbleMouseDown_),this.resizeGroup_&&(this.onMouseDownResizeWrapper_=(0,module$exports$Blockly$browserEvents.conditionalBind)(this.resizeGroup_,"mousedown",this,this.resizeMouseDown_))),this.bubbleGroup_.appendChild(a),this.bubbleGroup_},module$exports$Blockly$Bubble.Bubble.prototype.getSvgRoot=function(){return this.bubbleGroup_},module$exports$Blockly$Bubble.Bubble.prototype.setSvgId=function(a){this.bubbleGroup_.dataset&&(this.bubbleGroup_.dataset.blockId=a)},module$exports$Blockly$Bubble.Bubble.prototype.bubbleMouseDown_=function(a){var b=this.workspace_.getGesture(a);b&&b.handleBubbleStart(a,this)},module$exports$Blockly$Bubble.Bubble.prototype.showContextMenu=function(a){},module$exports$Blockly$Bubble.Bubble.prototype.isDeletable=function(){return!1},module$exports$Blockly$Bubble.Bubble.prototype.setDeleteStyle=function(a){},module$exports$Blockly$Bubble.Bubble.prototype.resizeMouseDown_=function(a){this.promote(),module$exports$Blockly$Bubble.Bubble.unbindDragEvents_(),(0,module$exports$Blockly$browserEvents.isRightButton)(a)||(this.workspace_.startDrag(a,new module$exports$Blockly$utils$Coordinate.Coordinate(this.workspace_.RTL?-this.width_:this.width_,this.height_)),module$exports$Blockly$Bubble.Bubble.onMouseUpWrapper_=(0,module$exports$Blockly$browserEvents.conditionalBind)(document,"mouseup",this,module$exports$Blockly$Bubble.Bubble.bubbleMouseUp_),module$exports$Blockly$Bubble.Bubble.onMouseMoveWrapper_=(0,module$exports$Blockly$browserEvents.conditionalBind)(document,"mousemove",this,this.resizeMouseMove_),this.workspace_.hideChaff()),a.stopPropagation()},module$exports$Blockly$Bubble.Bubble.prototype.resizeMouseMove_=function(a){this.autoLayout_=!1,a=this.workspace_.moveDrag(a),this.setBubbleSize(this.workspace_.RTL?-a.x:a.x,a.y),this.workspace_.RTL&&this.positionBubble_()},module$exports$Blockly$Bubble.Bubble.prototype.registerResizeEvent=function(a){this.resizeCallback_=a},module$exports$Blockly$Bubble.Bubble.prototype.registerMoveEvent=function(a){this.moveCallback_=a},module$exports$Blockly$Bubble.Bubble.prototype.promote=function(){var a=this.bubbleGroup_.parentNode;return a.lastChild!==this.bubbleGroup_&&(a.appendChild(this.bubbleGroup_),!0)},module$exports$Blockly$Bubble.Bubble.prototype.setAnchorLocation=function(a){this.anchorXY_=a,this.rendered_&&this.positionBubble_()},module$exports$Blockly$Bubble.Bubble.prototype.layoutBubble_=function(){var a=this.workspace_.getMetricsManager().getViewMetrics(!0),b=this.getOptimalRelativeLeft_(a),c=this.getOptimalRelativeTop_(a),d=this.shape_.getBBox(),e={x:b,y:-this.height_-this.workspace_.getRenderer().getConstants().MIN_BLOCK_HEIGHT},f={x:-this.width_-30,y:c};c={x:d.width,y:c};var g={x:b,y:d.height};b=d.width<d.height?c:g,d=d.width<d.height?g:c,c=this.getOverlap_(e,a),g=this.getOverlap_(f,a);var h=this.getOverlap_(b,a);a=this.getOverlap_(d,a),c===(a=Math.max(c,g,h,a))?(this.relativeLeft_=e.x,this.relativeTop_=e.y):g===a?(this.relativeLeft_=f.x,this.relativeTop_=f.y):h===a?(this.relativeLeft_=b.x,this.relativeTop_=b.y):(this.relativeLeft_=d.x,this.relativeTop_=d.y)},module$exports$Blockly$Bubble.Bubble.prototype.getOverlap_=function(a,b){var c=this.workspace_.RTL?this.anchorXY_.x-a.x-this.width_:a.x+this.anchorXY_.x;return a=a.y+this.anchorXY_.y,Math.max(0,Math.min(1,(Math.min(c+this.width_,b.left+b.width)-Math.max(c,b.left))*(Math.min(a+this.height_,b.top+b.height)-Math.max(a,b.top))/(this.width_*this.height_)))},module$exports$Blockly$Bubble.Bubble.prototype.getOptimalRelativeLeft_=function(a){var b=-this.width_/4;if(this.width_>a.width)return b;if(this.workspace_.RTL){var c=this.anchorXY_.x-b,d=a.left+a.width;a=a.left+module$exports$Blockly$Scrollbar.Scrollbar.scrollbarThickness/this.workspace_.scale,c-this.width_<a?b=-(a-this.anchorXY_.x+this.width_):c>d&&(b=-(d-this.anchorXY_.x))}else{d=(c=b+this.anchorXY_.x)+this.width_;var e=a.left;a=a.left+a.width-module$exports$Blockly$Scrollbar.Scrollbar.scrollbarThickness/this.workspace_.scale,c<e?b=e-this.anchorXY_.x:d>a&&(b=a-this.anchorXY_.x-this.width_)}return b},module$exports$Blockly$Bubble.Bubble.prototype.getOptimalRelativeTop_=function(a){var b=-this.height_/4;if(this.height_>a.height)return b;var c=this.anchorXY_.y+b,d=c+this.height_,e=a.top;a=a.top+a.height-module$exports$Blockly$Scrollbar.Scrollbar.scrollbarThickness/this.workspace_.scale;var f=this.anchorXY_.y;return c<e?b=e-f:d>a&&(b=a-f-this.height_),b},module$exports$Blockly$Bubble.Bubble.prototype.positionBubble_=function(){var a=this.anchorXY_.x;a=this.workspace_.RTL?a-(this.relativeLeft_+this.width_):a+this.relativeLeft_,this.moveTo(a,this.relativeTop_+this.anchorXY_.y)},module$exports$Blockly$Bubble.Bubble.prototype.moveTo=function(a,b){this.bubbleGroup_.setAttribute("transform","translate("+a+","+b+")")},module$exports$Blockly$Bubble.Bubble.prototype.setDragging=function(a){!a&&this.moveCallback_&&this.moveCallback_()},module$exports$Blockly$Bubble.Bubble.prototype.getBubbleSize=function(){return new module$exports$Blockly$utils$Size.Size(this.width_,this.height_)},module$exports$Blockly$Bubble.Bubble.prototype.setBubbleSize=function(a,b){var c=2*module$exports$Blockly$Bubble.Bubble.BORDER_WIDTH;a=Math.max(a,c+45),b=Math.max(b,c+20),this.width_=a,this.height_=b,this.bubbleBack_.setAttribute("width",a),this.bubbleBack_.setAttribute("height",b),this.resizeGroup_&&(this.workspace_.RTL?this.resizeGroup_.setAttribute("transform","translate("+2*module$exports$Blockly$Bubble.Bubble.BORDER_WIDTH+","+(b-c)+") scale(-1 1)"):this.resizeGroup_.setAttribute("transform","translate("+(a-c)+","+(b-c)+")")),this.autoLayout_&&this.layoutBubble_(),this.positionBubble_(),this.renderArrow_(),this.resizeCallback_&&this.resizeCallback_()},module$exports$Blockly$Bubble.Bubble.prototype.renderArrow_=function(){var a=[],b=this.width_/2,c=this.height_/2,d=-this.relativeLeft_,e=-this.relativeTop_;if(b===d&&c===e)a.push("M "+b+","+c);else{e-=c,d-=b,this.workspace_.RTL&&(d*=-1);var f=Math.sqrt(e*e+d*d),g=Math.acos(d/f);0>e&&(g=2*Math.PI-g);var h=g+Math.PI/2;h>2*Math.PI&&(h-=2*Math.PI);var k=Math.sin(h),l=Math.cos(h),m=this.getBubbleSize();h=(m.width+m.height)/module$exports$Blockly$Bubble.Bubble.ARROW_THICKNESS,h=Math.min(h,m.width,m.height)/4,d=b+(m=1-module$exports$Blockly$Bubble.Bubble.ANCHOR_RADIUS/f)*d,e=c+m*e,m=b+h*l;var n=c+h*k;b-=h*l,c-=h*k,(k=g+this.arrow_radians_)>2*Math.PI&&(k-=2*Math.PI),g=Math.sin(k)*f/module$exports$Blockly$Bubble.Bubble.ARROW_BEND,f=Math.cos(k)*f/module$exports$Blockly$Bubble.Bubble.ARROW_BEND,a.push("M"+m+","+n),a.push("C"+(m+f)+","+(n+g)+" "+d+","+e+" "+d+","+e),a.push("C"+d+","+e+" "+(b+f)+","+(c+g)+" "+b+","+c)}a.push("z"),this.bubbleArrow_.setAttribute("d",a.join(" "))},module$exports$Blockly$Bubble.Bubble.prototype.setColour=function(a){this.bubbleBack_.setAttribute("fill",a),this.bubbleArrow_.setAttribute("fill",a)},module$exports$Blockly$Bubble.Bubble.prototype.dispose=function(){this.onMouseDownBubbleWrapper_&&(0,module$exports$Blockly$browserEvents.unbind)(this.onMouseDownBubbleWrapper_),this.onMouseDownResizeWrapper_&&(0,module$exports$Blockly$browserEvents.unbind)(this.onMouseDownResizeWrapper_),module$exports$Blockly$Bubble.Bubble.unbindDragEvents_(),(0,module$exports$Blockly$utils$dom.removeNode)(this.bubbleGroup_),this.disposed=!0},module$exports$Blockly$Bubble.Bubble.prototype.moveDuringDrag=function(a,b){a?a.translateSurface(b.x,b.y):this.moveTo(b.x,b.y),this.relativeLeft_=this.workspace_.RTL?this.anchorXY_.x-b.x-this.width_:b.x-this.anchorXY_.x,this.relativeTop_=b.y-this.anchorXY_.y,this.renderArrow_()},module$exports$Blockly$Bubble.Bubble.prototype.getRelativeToSurfaceXY=function(){return new module$exports$Blockly$utils$Coordinate.Coordinate(this.workspace_.RTL?-this.relativeLeft_+this.anchorXY_.x-this.width_:this.anchorXY_.x+this.relativeLeft_,this.anchorXY_.y+this.relativeTop_)},module$exports$Blockly$Bubble.Bubble.prototype.setAutoLayout=function(a){this.autoLayout_=a},module$exports$Blockly$Bubble.Bubble.textToDom=function(a){var b=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.TEXT,{class:"blocklyText blocklyBubbleText blocklyNoPointerEvents",y:module$exports$Blockly$Bubble.Bubble.BORDER_WIDTH},null);a=a.split("\n");for(var c=0;c<a.length;c++){var d=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.TSPAN,{dy:"1em",x:module$exports$Blockly$Bubble.Bubble.BORDER_WIDTH},b),e=document.createTextNode(a[c]);d.appendChild(e)}return b},module$exports$Blockly$Bubble.Bubble.createNonEditableBubble=function(a,b,c){if((c=new module$exports$Blockly$Bubble.Bubble(b.workspace,a,b.pathObject.svgPath,c,null,null)).setSvgId(b.id),b.RTL){b=a.getBBox().width;for(var e,d=0;e=a.childNodes[d];d++)e.setAttribute("text-anchor","end"),e.setAttribute("x",b+module$exports$Blockly$Bubble.Bubble.BORDER_WIDTH)}return c};var module$exports$Blockly$Events$CommentBase={CommentBase:function(a){this.commentId=(this.isBlank=void 0===a)?"":a.id,this.workspaceId=this.isBlank?"":a.workspace.id,this.group=(0,module$exports$Blockly$Events$utils.getGroup)(),this.recordUndo=(0,module$exports$Blockly$Events$utils.getRecordUndo)()}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$Events$CommentBase.CommentBase,module$exports$Blockly$Events$Abstract),module$exports$Blockly$Events$CommentBase.CommentBase.prototype.toJson=function(){var a=module$exports$Blockly$Events$CommentBase.CommentBase.superClass_.toJson.call(this);return this.commentId&&(a.commentId=this.commentId),a},module$exports$Blockly$Events$CommentBase.CommentBase.prototype.fromJson=function(a){module$exports$Blockly$Events$CommentBase.CommentBase.superClass_.fromJson.call(this,a),this.commentId=a.commentId},module$exports$Blockly$Events$CommentBase.CommentBase.CommentCreateDeleteHelper=function(a,b){var c=a.getEventWorkspace_();b?((b=(0,$.module$exports$Blockly$utils$xml.createElement)("xml")).appendChild(a.xml),(0,$.module$exports$Blockly$Xml.domToWorkspace)(b,c)):(c=c.getCommentById(a.commentId))?c.dispose():console.warn("Can't uncreate non-existent comment: "+a.commentId)};var module$exports$Blockly$Events$CommentMove={CommentMove:function(a){module$exports$Blockly$Events$CommentMove.CommentMove.superClass_.constructor.call(this,a),a&&(this.comment_=a,this.oldCoordinate_=a.getXY(),this.newCoordinate_=null)}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$Events$CommentMove.CommentMove,module$exports$Blockly$Events$CommentBase.CommentBase),module$exports$Blockly$Events$CommentMove.CommentMove.prototype.recordNew=function(){if(!this.comment_)throw Error("Tried to record the new position of a comment on the same event twice.");this.newCoordinate_=this.comment_.getXY(),this.comment_=null},module$exports$Blockly$Events$CommentMove.CommentMove.prototype.type=module$exports$Blockly$Events$utils.COMMENT_MOVE,module$exports$Blockly$Events$CommentMove.CommentMove.prototype.setOldCoordinate=function(a){this.oldCoordinate_=a},module$exports$Blockly$Events$CommentMove.CommentMove.prototype.toJson=function(){var a=module$exports$Blockly$Events$CommentMove.CommentMove.superClass_.toJson.call(this);return this.oldCoordinate_&&(a.oldCoordinate=Math.round(this.oldCoordinate_.x)+","+Math.round(this.oldCoordinate_.y)),this.newCoordinate_&&(a.newCoordinate=Math.round(this.newCoordinate_.x)+","+Math.round(this.newCoordinate_.y)),a},module$exports$Blockly$Events$CommentMove.CommentMove.prototype.fromJson=function(a){if(module$exports$Blockly$Events$CommentMove.CommentMove.superClass_.fromJson.call(this,a),a.oldCoordinate){var b=a.oldCoordinate.split(",");this.oldCoordinate_=new module$exports$Blockly$utils$Coordinate.Coordinate(Number(b[0]),Number(b[1]))}a.newCoordinate&&(a=a.newCoordinate.split(","),this.newCoordinate_=new module$exports$Blockly$utils$Coordinate.Coordinate(Number(a[0]),Number(a[1])))},module$exports$Blockly$Events$CommentMove.CommentMove.prototype.isNull=function(){return module$exports$Blockly$utils$Coordinate.Coordinate.equals(this.oldCoordinate_,this.newCoordinate_)},module$exports$Blockly$Events$CommentMove.CommentMove.prototype.run=function(a){var b=this.getEventWorkspace_().getCommentById(this.commentId);if(b){a=a?this.newCoordinate_:this.oldCoordinate_;var c=b.getXY();b.moveBy(a.x-c.x,a.y-c.y)}else console.warn("Can't move non-existent comment: "+this.commentId)},(0,module$exports$Blockly$registry.register)(module$exports$Blockly$registry.Type.EVENT,module$exports$Blockly$Events$utils.COMMENT_MOVE,module$exports$Blockly$Events$CommentMove.CommentMove);var module$exports$Blockly$BubbleDragger={BubbleDragger:function(a,b){this.draggingBubble_=a,this.workspace_=b,this.dragTarget_=null,this.wouldDeleteBubble_=!1,this.startXY_=this.draggingBubble_.getRelativeToSurfaceXY(),this.dragSurface_=(0,module$exports$Blockly$utils$svgMath.is3dSupported)()&&b.getBlockDragSurface()?b.getBlockDragSurface():null}};module$exports$Blockly$BubbleDragger.BubbleDragger.prototype.dispose=function(){this.dragSurface_=this.workspace_=this.draggingBubble_=null},module$exports$Blockly$BubbleDragger.BubbleDragger.prototype.startBubbleDrag=function(){(0,module$exports$Blockly$Events$utils.getGroup)()||(0,module$exports$Blockly$Events$utils.setGroup)(!0),this.workspace_.setResizesEnabled(!1),this.draggingBubble_.setAutoLayout(!1),this.dragSurface_&&this.moveToDragSurface_(),this.draggingBubble_.setDragging&&this.draggingBubble_.setDragging(!0)},module$exports$Blockly$BubbleDragger.BubbleDragger.prototype.dragBubble=function(a,b){b=this.pixelsToWorkspaceUnits_(b),b=module$exports$Blockly$utils$Coordinate.Coordinate.sum(this.startXY_,b),this.draggingBubble_.moveDuringDrag(this.dragSurface_,b),b=this.dragTarget_,this.dragTarget_=this.workspace_.getDragTarget(a),a=this.wouldDeleteBubble_,this.wouldDeleteBubble_=this.shouldDelete_(this.dragTarget_),a!==this.wouldDeleteBubble_&&this.updateCursorDuringBubbleDrag_(),this.dragTarget_!==b&&(b&&b.onDragExit(this.draggingBubble_),this.dragTarget_&&this.dragTarget_.onDragEnter(this.draggingBubble_)),this.dragTarget_&&this.dragTarget_.onDragOver(this.draggingBubble_)},module$exports$Blockly$BubbleDragger.BubbleDragger.prototype.shouldDelete_=function(a){return!(!a||!this.workspace_.getComponentManager().hasCapability(a.id,module$exports$Blockly$ComponentManager.ComponentManager.Capability.DELETE_AREA))&&a.wouldDelete(this.draggingBubble_,!1)},module$exports$Blockly$BubbleDragger.BubbleDragger.prototype.updateCursorDuringBubbleDrag_=function(){this.draggingBubble_.setDeleteStyle(this.wouldDeleteBubble_)},module$exports$Blockly$BubbleDragger.BubbleDragger.prototype.endBubbleDrag=function(a,b){this.dragBubble(a,b),this.dragTarget_&&this.dragTarget_.shouldPreventMove(this.draggingBubble_)?a=this.startXY_:(a=this.pixelsToWorkspaceUnits_(b),a=module$exports$Blockly$utils$Coordinate.Coordinate.sum(this.startXY_,a)),this.draggingBubble_.moveTo(a.x,a.y),this.dragTarget_&&this.dragTarget_.onDrop(this.draggingBubble_),this.wouldDeleteBubble_?(this.fireMoveEvent_(),this.draggingBubble_.dispose(!1,!0)):(this.dragSurface_&&this.dragSurface_.clearAndHide(this.workspace_.getBubbleCanvas()),this.draggingBubble_.setDragging&&this.draggingBubble_.setDragging(!1),this.fireMoveEvent_()),this.workspace_.setResizesEnabled(!0),(0,module$exports$Blockly$Events$utils.setGroup)(!1)},module$exports$Blockly$BubbleDragger.BubbleDragger.prototype.fireMoveEvent_=function(){if(this.draggingBubble_.isComment){var a=new((0,module$exports$Blockly$Events$utils.get)(module$exports$Blockly$Events$utils.COMMENT_MOVE))(this.draggingBubble_);a.setOldCoordinate(this.startXY_),a.recordNew(),(0,module$exports$Blockly$Events$utils.fire)(a)}},module$exports$Blockly$BubbleDragger.BubbleDragger.prototype.pixelsToWorkspaceUnits_=function(a){return a=new module$exports$Blockly$utils$Coordinate.Coordinate(a.x/this.workspace_.scale,a.y/this.workspace_.scale),this.workspace_.isMutator&&a.scale(1/this.workspace_.options.parentWorkspace.scale),a},module$exports$Blockly$BubbleDragger.BubbleDragger.prototype.moveToDragSurface_=function(){this.draggingBubble_.moveTo(0,0),this.dragSurface_.translateSurface(this.startXY_.x,this.startXY_.y),this.dragSurface_.setBlocksAndShow(this.draggingBubble_.getSvgRoot())};var module$exports$Blockly$WorkspaceDragger={WorkspaceDragger:function(a){this.workspace_=a,this.horizontalScrollEnabled_=this.workspace_.isMovableHorizontally(),this.verticalScrollEnabled_=this.workspace_.isMovableVertically(),this.startScrollXY_=new module$exports$Blockly$utils$Coordinate.Coordinate(a.scrollX,a.scrollY)}};module$exports$Blockly$WorkspaceDragger.WorkspaceDragger.prototype.dispose=function(){this.workspace_=null},module$exports$Blockly$WorkspaceDragger.WorkspaceDragger.prototype.startDrag=function(){(0,$.module$exports$Blockly$common.getSelected)()&&(0,$.module$exports$Blockly$common.getSelected)().unselect(),this.workspace_.setupDragSurface()},module$exports$Blockly$WorkspaceDragger.WorkspaceDragger.prototype.endDrag=function(a){this.drag(a),this.workspace_.resetDragSurface()},module$exports$Blockly$WorkspaceDragger.WorkspaceDragger.prototype.drag=function(a){if(a=module$exports$Blockly$utils$Coordinate.Coordinate.sum(this.startScrollXY_,a),this.horizontalScrollEnabled_&&this.verticalScrollEnabled_)this.workspace_.scroll(a.x,a.y);else if(this.horizontalScrollEnabled_)this.workspace_.scroll(a.x,this.workspace_.scrollY);else{if(!this.verticalScrollEnabled_)throw new TypeError("Invalid state.");this.workspace_.scroll(this.workspace_.scrollX,a.y)}};var module$exports$Blockly$InsertionMarkerManager={InsertionMarkerManager:function(a){(0,$.module$exports$Blockly$common.setSelected)(a),this.topBlock_=a,this.workspace_=a.workspace,this.lastMarker_=this.lastOnStack_=null,this.firstMarker_=this.createMarkerBlock_(this.topBlock_),this.localConnection_=this.closestConnection_=null,this.wouldDeleteBlock_=!1,this.fadedBlock_=this.highlightedBlock_=this.markerConnection_=null,this.availableConnections_=this.initAvailableConnections_()}};module$exports$Blockly$InsertionMarkerManager.InsertionMarkerManager.PREVIEW_TYPE={INSERTION_MARKER:0,INPUT_OUTLINE:1,REPLACEMENT_FADE:2},module$exports$Blockly$InsertionMarkerManager.InsertionMarkerManager.DUPLICATE_BLOCK_ERROR="The insertion marker manager tried to create a marker but the result is missing %1. If you are using a mutator, make sure your domToMutation method is properly defined.",module$exports$Blockly$InsertionMarkerManager.InsertionMarkerManager.prototype.dispose=function(){this.availableConnections_.length=0,(0,module$exports$Blockly$Events$utils.disable)();try{this.firstMarker_&&this.firstMarker_.dispose(),this.lastMarker_&&this.lastMarker_.dispose()}finally{(0,module$exports$Blockly$Events$utils.enable)()}},module$exports$Blockly$InsertionMarkerManager.InsertionMarkerManager.prototype.updateAvailableConnections=function(){this.availableConnections_=this.initAvailableConnections_()},module$exports$Blockly$InsertionMarkerManager.InsertionMarkerManager.prototype.wouldDeleteBlock=function(){return this.wouldDeleteBlock_},module$exports$Blockly$InsertionMarkerManager.InsertionMarkerManager.prototype.wouldConnectBlock=function(){return!!this.closestConnection_},module$exports$Blockly$InsertionMarkerManager.InsertionMarkerManager.prototype.applyConnections=function(){if(this.closestConnection_&&((0,module$exports$Blockly$Events$utils.disable)(),this.hidePreview_(),(0,module$exports$Blockly$Events$utils.enable)(),this.localConnection_.connect(this.closestConnection_),this.topBlock_.rendered)){var a=this.localConnection_.isSuperior()?this.closestConnection_:this.localConnection_;(0,module$exports$Blockly$blockAnimations.connectionUiEffect)(a.getSourceBlock()),this.topBlock_.getRootBlock().bringToFront()}},module$exports$Blockly$InsertionMarkerManager.InsertionMarkerManager.prototype.update=function(a,b){var c=this.getCandidate_(a);((this.wouldDeleteBlock_=this.shouldDelete_(c,b))||this.shouldUpdatePreviews_(c,a))&&((0,module$exports$Blockly$Events$utils.disable)(),this.maybeHidePreview_(c),this.maybeShowPreview_(c),(0,module$exports$Blockly$Events$utils.enable)())},module$exports$Blockly$InsertionMarkerManager.InsertionMarkerManager.prototype.createMarkerBlock_=function(a){var b=a.type;(0,module$exports$Blockly$Events$utils.disable)();try{var c=this.workspace_.newBlock(b);if(c.setInsertionMarker(!0),a.saveExtraState){var d=a.saveExtraState();d&&c.loadExtraState(d)}else if(a.mutationToDom){var e=a.mutationToDom();e&&c.domToMutation(e)}for(b=0;b<a.inputList.length;b++){var f=a.inputList[b];if(f.name!==module$exports$Blockly$constants.COLLAPSED_INPUT_NAME){var g=c.inputList[b];if(!g)throw Error(module$exports$Blockly$InsertionMarkerManager.InsertionMarkerManager.DUPLICATE_BLOCK_ERROR.replace("%1","an input"));for(d=0;d<f.fieldRow.length;d++){var h=f.fieldRow[d],k=g.fieldRow[d];if(!k)throw Error(module$exports$Blockly$InsertionMarkerManager.InsertionMarkerManager.DUPLICATE_BLOCK_ERROR.replace("%1","a field"));k.setValue(h.getValue())}}}c.setCollapsed(a.isCollapsed()),c.setInputsInline(a.getInputsInline()),c.initSvg(),c.getSvgRoot().setAttribute("visibility","hidden")}finally{(0,module$exports$Blockly$Events$utils.enable)()}return c},module$exports$Blockly$InsertionMarkerManager.InsertionMarkerManager.prototype.initAvailableConnections_=function(){var a=this.topBlock_.getConnections_(!1),b=this.topBlock_.lastConnectionInStack(!0);if(b&&b!==this.topBlock_.nextConnection){if(a.push(b),this.lastOnStack_=b,this.lastMarker_){(0,module$exports$Blockly$Events$utils.disable)();try{this.lastMarker_.dispose()}finally{(0,module$exports$Blockly$Events$utils.enable)()}}this.lastMarker_=this.createMarkerBlock_(b.getSourceBlock())}return a},module$exports$Blockly$InsertionMarkerManager.InsertionMarkerManager.prototype.shouldUpdatePreviews_=function(a,b){var c=a.local,d=a.closest;return a=a.radius,c&&d?this.localConnection_&&this.closestConnection_?!(this.closestConnection_===d&&this.localConnection_===c||(c=this.localConnection_.x+b.x-this.closestConnection_.x,b=this.localConnection_.y+b.y-this.closestConnection_.y,b=Math.sqrt(c*c+b*b),d&&a>b-$.module$exports$Blockly$internalConstants.CURRENT_CONNECTION_PREFERENCE)):!this.localConnection_&&!this.closestConnection_||(console.error("Only one of localConnection_ and closestConnection_ was set."),console.error("Returning true from shouldUpdatePreviews, but it's not clear why."),!0):!(!this.localConnection_||!this.closestConnection_)},module$exports$Blockly$InsertionMarkerManager.InsertionMarkerManager.prototype.getCandidate_=function(a){for(var b=this.getStartRadius_(),c=null,d=null,e=0;e<this.availableConnections_.length;e++){var f=this.availableConnections_[e],g=f.closest(b,a);g.connection&&(c=g.connection,d=f,b=g.radius)}return{closest:c,local:d,radius:b}},module$exports$Blockly$InsertionMarkerManager.InsertionMarkerManager.prototype.getStartRadius_=function(){return $.module$exports$Blockly$internalConstants.SNAP_RADIUS},module$exports$Blockly$InsertionMarkerManager.InsertionMarkerManager.prototype.shouldDelete_=function(a,b){return!(!b||!this.workspace_.getComponentManager().hasCapability(b.id,module$exports$Blockly$ComponentManager.ComponentManager.Capability.DELETE_AREA))&&b.wouldDelete(this.topBlock_,a&&!!a.closest)},module$exports$Blockly$InsertionMarkerManager.InsertionMarkerManager.prototype.maybeShowPreview_=function(a){if(!this.wouldDeleteBlock_){var b=a.closest;a=a.local,b&&(b===this.closestConnection_||b.getSourceBlock().isInsertionMarker()?console.log("Trying to connect to an insertion marker"):(this.closestConnection_=b,this.localConnection_=a,this.showPreview_()))}},module$exports$Blockly$InsertionMarkerManager.InsertionMarkerManager.prototype.showPreview_=function(){var a=this.closestConnection_,b=this.workspace_.getRenderer();switch(b.getConnectionPreviewMethod(a,this.localConnection_,this.topBlock_)){case module$exports$Blockly$InsertionMarkerManager.InsertionMarkerManager.PREVIEW_TYPE.INPUT_OUTLINE:this.showInsertionInputOutline_();break;case module$exports$Blockly$InsertionMarkerManager.InsertionMarkerManager.PREVIEW_TYPE.INSERTION_MARKER:this.showInsertionMarker_();break;case module$exports$Blockly$InsertionMarkerManager.InsertionMarkerManager.PREVIEW_TYPE.REPLACEMENT_FADE:this.showReplacementFade_()}a&&b.shouldHighlightConnection(a)&&a.highlight()},module$exports$Blockly$InsertionMarkerManager.InsertionMarkerManager.prototype.maybeHidePreview_=function(a){if(a.closest){var b=this.closestConnection_!==a.closest;a=this.localConnection_!==a.local,this.closestConnection_&&this.localConnection_&&(b||a||this.wouldDeleteBlock_)&&this.hidePreview_()}else this.hidePreview_();this.localConnection_=this.closestConnection_=this.markerConnection_=null},module$exports$Blockly$InsertionMarkerManager.InsertionMarkerManager.prototype.hidePreview_=function(){this.closestConnection_&&this.closestConnection_.targetBlock()&&this.workspace_.getRenderer().shouldHighlightConnection(this.closestConnection_)&&this.closestConnection_.unhighlight(),this.fadedBlock_?this.hideReplacementFade_():this.highlightedBlock_?this.hideInsertionInputOutline_():this.markerConnection_&&this.hideInsertionMarker_()},module$exports$Blockly$InsertionMarkerManager.InsertionMarkerManager.prototype.showInsertionMarker_=function(){var a=this.localConnection_,b=this.closestConnection_,c=this.lastOnStack_&&a===this.lastOnStack_?this.lastMarker_:this.firstMarker_;if((a=c.getMatchingConnection(a.getSourceBlock(),a))===this.markerConnection_)throw Error("Made it to showInsertionMarker_ even though the marker isn't changing");c.render(),c.rendered=!0,c.getSvgRoot().setAttribute("visibility","visible"),a&&b&&c.positionNearConnection(a,b),b&&a.connect(b),this.markerConnection_=a},module$exports$Blockly$InsertionMarkerManager.InsertionMarkerManager.prototype.hideInsertionMarker_=function(){if(this.markerConnection_){var a=this.markerConnection_,b=a.getSourceBlock(),c=b.nextConnection,d=b.previousConnection,e=b.outputConnection;if(e=a.type===$.module$exports$Blockly$ConnectionType.ConnectionType.INPUT_VALUE&&!(e&&e.targetConnection),!(a!==c||d&&d.targetConnection)||e?a.targetBlock().unplug(!1):a.type===$.module$exports$Blockly$ConnectionType.ConnectionType.NEXT_STATEMENT&&a!==c?((c=a.targetConnection).getSourceBlock().unplug(!1),d=d?d.targetConnection:null,b.unplug(!0),d&&d.connect(c)):b.unplug(!0),a.targetConnection)throw Error("markerConnection_ still connected at the end of disconnectInsertionMarker");this.markerConnection_=null,(a=b.getSvgRoot())&&a.setAttribute("visibility","hidden")}else console.log("No insertion marker connection to disconnect")},module$exports$Blockly$InsertionMarkerManager.InsertionMarkerManager.prototype.showInsertionInputOutline_=function(){var a=this.closestConnection_;this.highlightedBlock_=a.getSourceBlock(),this.highlightedBlock_.highlightShapeForInput(a,!0)},module$exports$Blockly$InsertionMarkerManager.InsertionMarkerManager.prototype.hideInsertionInputOutline_=function(){this.highlightedBlock_.highlightShapeForInput(this.closestConnection_,!1),this.highlightedBlock_=null},module$exports$Blockly$InsertionMarkerManager.InsertionMarkerManager.prototype.showReplacementFade_=function(){this.fadedBlock_=this.closestConnection_.targetBlock(),this.fadedBlock_.fadeForReplacement(!0)},module$exports$Blockly$InsertionMarkerManager.InsertionMarkerManager.prototype.hideReplacementFade_=function(){this.fadedBlock_.fadeForReplacement(!1),this.fadedBlock_=null},module$exports$Blockly$InsertionMarkerManager.InsertionMarkerManager.prototype.getInsertionMarkers=function(){var a=[];return this.firstMarker_&&a.push(this.firstMarker_),this.lastMarker_&&a.push(this.lastMarker_),a};var module$exports$Blockly$Events$UiBase={UiBase:function(a){module$exports$Blockly$Events$UiBase.UiBase.superClass_.constructor.call(this),this.isBlank=void 0===a,this.workspaceId=a||"",this.recordUndo=!1}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$Events$UiBase.UiBase,module$exports$Blockly$Events$Abstract),module$exports$Blockly$Events$UiBase.UiBase.prototype.isUiEvent=!0;var module$exports$Blockly$Events$BlockDrag={BlockDrag:function(a,b,c){module$exports$Blockly$Events$BlockDrag.BlockDrag.superClass_.constructor.call(this,a?a.workspace.id:void 0),this.blockId=a?a.id:null,this.isStart=b,this.blocks=c}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$Events$BlockDrag.BlockDrag,module$exports$Blockly$Events$UiBase.UiBase),module$exports$Blockly$Events$BlockDrag.BlockDrag.prototype.type=module$exports$Blockly$Events$utils.BLOCK_DRAG,module$exports$Blockly$Events$BlockDrag.BlockDrag.prototype.toJson=function(){var a=module$exports$Blockly$Events$BlockDrag.BlockDrag.superClass_.toJson.call(this);return a.isStart=this.isStart,a.blockId=this.blockId,a.blocks=this.blocks,a},module$exports$Blockly$Events$BlockDrag.BlockDrag.prototype.fromJson=function(a){module$exports$Blockly$Events$BlockDrag.BlockDrag.superClass_.fromJson.call(this,a),this.isStart=a.isStart,this.blockId=a.blockId,this.blocks=a.blocks},(0,module$exports$Blockly$registry.register)(module$exports$Blockly$registry.Type.EVENT,module$exports$Blockly$Events$utils.BLOCK_DRAG,module$exports$Blockly$Events$BlockDrag.BlockDrag);var module$exports$Blockly$BlockDragger={BlockDragger:function(a,b){this.draggingBlock_=a,this.workspace_=b,this.draggedConnectionManager_=new module$exports$Blockly$InsertionMarkerManager.InsertionMarkerManager(this.draggingBlock_),this.dragTarget_=null,this.wouldDeleteBlock_=!1,this.startXY_=this.draggingBlock_.getRelativeToSurfaceXY(),this.dragIconData_=module$contents$Blockly$BlockDragger_initIconData(a)}};module$exports$Blockly$BlockDragger.BlockDragger.prototype.dispose=function(){this.dragIconData_.length=0,this.draggedConnectionManager_&&this.draggedConnectionManager_.dispose()};var module$contents$Blockly$BlockDragger_initIconData=function(a){var b=[];a=a.getDescendants(!1);for(var d,c=0;d=a[c];c++){d=d.getIcons();for(var e=0;e<d.length;e++){var f={location:d[e].getIconLocation(),icon:d[e]};b.push(f)}}return b};module$exports$Blockly$BlockDragger.BlockDragger.prototype.startDrag=function(a,b){(0,module$exports$Blockly$Events$utils.getGroup)()||(0,module$exports$Blockly$Events$utils.setGroup)(!0),this.fireDragStartEvent_(),this.workspace_.isMutator&&this.draggingBlock_.bringToFront(),(0,module$exports$Blockly$utils$dom.startTextWidthCache)(),this.workspace_.setResizesEnabled(!1),(0,module$exports$Blockly$blockAnimations.disconnectUiStop)(),this.shouldDisconnect_(b)&&this.disconnectBlock_(b,a),this.draggingBlock_.setDragging(!0),this.draggingBlock_.moveToDragSurface()},module$exports$Blockly$BlockDragger.BlockDragger.prototype.shouldDisconnect_=function(a){return!!(this.draggingBlock_.getParent()||a&&this.draggingBlock_.nextConnection&&this.draggingBlock_.nextConnection.targetBlock())},module$exports$Blockly$BlockDragger.BlockDragger.prototype.disconnectBlock_=function(a,b){this.draggingBlock_.unplug(a),a=this.pixelsToWorkspaceUnits_(b),a=module$exports$Blockly$utils$Coordinate.Coordinate.sum(this.startXY_,a),this.draggingBlock_.translate(a.x,a.y),(0,module$exports$Blockly$blockAnimations.disconnectUiEffect)(this.draggingBlock_),this.draggedConnectionManager_.updateAvailableConnections()},module$exports$Blockly$BlockDragger.BlockDragger.prototype.fireDragStartEvent_=function(){var a=new((0,module$exports$Blockly$Events$utils.get)(module$exports$Blockly$Events$utils.BLOCK_DRAG))(this.draggingBlock_,!0,this.draggingBlock_.getDescendants(!1));(0,module$exports$Blockly$Events$utils.fire)(a)},module$exports$Blockly$BlockDragger.BlockDragger.prototype.drag=function(a,b){b=this.pixelsToWorkspaceUnits_(b);var c=module$exports$Blockly$utils$Coordinate.Coordinate.sum(this.startXY_,b);this.draggingBlock_.moveDuringDrag(c),this.dragIcons_(b),c=this.dragTarget_,this.dragTarget_=this.workspace_.getDragTarget(a),this.draggedConnectionManager_.update(b,this.dragTarget_),a=this.wouldDeleteBlock_,this.wouldDeleteBlock_=this.draggedConnectionManager_.wouldDeleteBlock(),a!==this.wouldDeleteBlock_&&this.updateCursorDuringBlockDrag_(),this.dragTarget_!==c&&(c&&c.onDragExit(this.draggingBlock_),this.dragTarget_&&this.dragTarget_.onDragEnter(this.draggingBlock_)),this.dragTarget_&&this.dragTarget_.onDragOver(this.draggingBlock_)},module$exports$Blockly$BlockDragger.BlockDragger.prototype.endDrag=function(a,b){if(this.drag(a,b),this.dragIconData_=[],this.fireDragEndEvent_(),(0,module$exports$Blockly$utils$dom.stopTextWidthCache)(),(0,module$exports$Blockly$blockAnimations.disconnectUiStop)(),this.dragTarget_&&this.dragTarget_.shouldPreventMove(this.draggingBlock_))a=this.startXY_;else{var c=(a=this.getNewLocationAfterDrag_(b)).delta;a=a.newLocation}this.draggingBlock_.moveOffDragSurface(a),this.dragTarget_&&this.dragTarget_.onDrop(this.draggingBlock_),this.maybeDeleteBlock_()||(this.draggingBlock_.setDragging(!1),c?this.updateBlockAfterMove_(c):(0,module$exports$Blockly$bumpObjects.bumpIntoBounds)(this.draggingBlock_.workspace,this.workspace_.getMetricsManager().getScrollMetrics(!0),this.draggingBlock_)),this.workspace_.setResizesEnabled(!0),(0,module$exports$Blockly$Events$utils.setGroup)(!1)},module$exports$Blockly$BlockDragger.BlockDragger.prototype.getNewLocationAfterDrag_=function(a){var b={};return b.delta=this.pixelsToWorkspaceUnits_(a),b.newLocation=module$exports$Blockly$utils$Coordinate.Coordinate.sum(this.startXY_,b.delta),b},module$exports$Blockly$BlockDragger.BlockDragger.prototype.maybeDeleteBlock_=function(){return!!this.wouldDeleteBlock_&&(this.fireMoveEvent_(),this.draggingBlock_.dispose(!1,!0),$.module$exports$Blockly$common.draggingConnections.length=0,!0)},module$exports$Blockly$BlockDragger.BlockDragger.prototype.updateBlockAfterMove_=function(a){this.draggingBlock_.moveConnections(a.x,a.y),this.fireMoveEvent_(),this.draggedConnectionManager_.wouldConnectBlock()?this.draggedConnectionManager_.applyConnections():this.draggingBlock_.render(),this.draggingBlock_.scheduleSnapAndBump()},module$exports$Blockly$BlockDragger.BlockDragger.prototype.fireDragEndEvent_=function(){var a=new((0,module$exports$Blockly$Events$utils.get)(module$exports$Blockly$Events$utils.BLOCK_DRAG))(this.draggingBlock_,!1,this.draggingBlock_.getDescendants(!1));(0,module$exports$Blockly$Events$utils.fire)(a)},module$exports$Blockly$BlockDragger.BlockDragger.prototype.updateToolboxStyle_=function(a){var b=this.workspace_.getToolbox();if(b){var c=this.draggingBlock_.isDeletable()?"blocklyToolboxDelete":"blocklyToolboxGrab";a&&"function"==typeof b.removeStyle?b.removeStyle(c):a||"function"!=typeof b.addStyle||b.addStyle(c)}},module$exports$Blockly$BlockDragger.BlockDragger.prototype.fireMoveEvent_=function(){var a=new((0,module$exports$Blockly$Events$utils.get)(module$exports$Blockly$Events$utils.MOVE))(this.draggingBlock_);a.oldCoordinate=this.startXY_,a.recordNew(),(0,module$exports$Blockly$Events$utils.fire)(a)},module$exports$Blockly$BlockDragger.BlockDragger.prototype.updateCursorDuringBlockDrag_=function(){this.draggingBlock_.setDeleteStyle(this.wouldDeleteBlock_)},module$exports$Blockly$BlockDragger.BlockDragger.prototype.pixelsToWorkspaceUnits_=function(a){return a=new module$exports$Blockly$utils$Coordinate.Coordinate(a.x/this.workspace_.scale,a.y/this.workspace_.scale),this.workspace_.isMutator&&a.scale(1/this.workspace_.options.parentWorkspace.scale),a},module$exports$Blockly$BlockDragger.BlockDragger.prototype.dragIcons_=function(a){for(var b=0;b<this.dragIconData_.length;b++){var c=this.dragIconData_[b];c.icon.setIconLocation(module$exports$Blockly$utils$Coordinate.Coordinate.sum(c.location,a))}},module$exports$Blockly$BlockDragger.BlockDragger.prototype.getInsertionMarkers=function(){return this.draggedConnectionManager_&&this.draggedConnectionManager_.getInsertionMarkers?this.draggedConnectionManager_.getInsertionMarkers():[]},(0,module$exports$Blockly$registry.register)(module$exports$Blockly$registry.Type.BLOCK_DRAGGER,module$exports$Blockly$registry.DEFAULT,module$exports$Blockly$BlockDragger.BlockDragger);var module$exports$Blockly$Events$Click={Click:function(a,b,c){module$exports$Blockly$Events$Click.Click.superClass_.constructor.call(this,a?a.workspace.id:b),this.blockId=a?a.id:null,this.targetType=c}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$Events$Click.Click,module$exports$Blockly$Events$UiBase.UiBase),module$exports$Blockly$Events$Click.Click.prototype.type=module$exports$Blockly$Events$utils.CLICK,module$exports$Blockly$Events$Click.Click.prototype.toJson=function(){var a=module$exports$Blockly$Events$Click.Click.superClass_.toJson.call(this);return a.targetType=this.targetType,this.blockId&&(a.blockId=this.blockId),a},module$exports$Blockly$Events$Click.Click.prototype.fromJson=function(a){module$exports$Blockly$Events$Click.Click.superClass_.fromJson.call(this,a),this.targetType=a.targetType,this.blockId=a.blockId},(0,module$exports$Blockly$registry.register)(module$exports$Blockly$registry.Type.EVENT,module$exports$Blockly$Events$utils.CLICK,module$exports$Blockly$Events$Click.Click);var module$exports$Blockly$Gesture={Gesture:function(a,b){this.mouseDownXY_=null,this.currentDragDeltaXY_=new module$exports$Blockly$utils$Coordinate.Coordinate(0,0),this.startWorkspace_=this.targetBlock_=this.startBlock_=this.startField_=this.startBubble_=null,this.creatorWorkspace_=b,this.isDraggingBubble_=this.isDraggingBlock_=this.isDraggingWorkspace_=this.hasExceededDragRadius_=!1,this.mostRecentEvent_=a,this.flyout_=this.workspaceDragger_=this.blockDragger_=this.bubbleDragger_=this.onUpWrapper_=this.onMoveWrapper_=null,this.isEnding_=this.hasStarted_=this.calledUpdateIsDragging_=!1,this.healStack_=!$.module$exports$Blockly$internalConstants.DRAG_STACK}};module$exports$Blockly$Gesture.Gesture.prototype.dispose=function(){(0,module$exports$Blockly$Touch.clearTouchIdentifier)(),(0,module$exports$Blockly$Tooltip.unblock)(),this.creatorWorkspace_.clearGesture(),this.onMoveWrapper_&&(0,module$exports$Blockly$browserEvents.unbind)(this.onMoveWrapper_),this.onUpWrapper_&&(0,module$exports$Blockly$browserEvents.unbind)(this.onUpWrapper_),this.blockDragger_&&this.blockDragger_.dispose(),this.workspaceDragger_&&this.workspaceDragger_.dispose(),this.bubbleDragger_&&this.bubbleDragger_.dispose()},module$exports$Blockly$Gesture.Gesture.prototype.updateFromEvent_=function(a){var b=new module$exports$Blockly$utils$Coordinate.Coordinate(a.clientX,a.clientY);this.updateDragDelta_(b)&&(this.updateIsDragging_(),(0,module$exports$Blockly$Touch.longStop)()),this.mostRecentEvent_=a},module$exports$Blockly$Gesture.Gesture.prototype.updateDragDelta_=function(a){return this.currentDragDeltaXY_=module$exports$Blockly$utils$Coordinate.Coordinate.difference(a,this.mouseDownXY_),!this.hasExceededDragRadius_&&(this.hasExceededDragRadius_=module$exports$Blockly$utils$Coordinate.Coordinate.magnitude(this.currentDragDeltaXY_)>(this.flyout_?$.module$exports$Blockly$internalConstants.FLYOUT_DRAG_RADIUS:$.module$exports$Blockly$internalConstants.DRAG_RADIUS))},module$exports$Blockly$Gesture.Gesture.prototype.updateIsDraggingFromFlyout_=function(){return!(!this.targetBlock_||!this.flyout_.isBlockCreatable_(this.targetBlock_)||this.flyout_.isScrollable()&&!this.flyout_.isDragTowardWorkspace(this.currentDragDeltaXY_)||(this.startWorkspace_=this.flyout_.targetWorkspace,this.startWorkspace_.updateScreenCalculationsIfScrolled(),(0,module$exports$Blockly$Events$utils.getGroup)()||(0,module$exports$Blockly$Events$utils.setGroup)(!0),this.startBlock_=null,this.targetBlock_=this.flyout_.createBlock(this.targetBlock_),this.targetBlock_.select(),0))},module$exports$Blockly$Gesture.Gesture.prototype.updateIsDraggingBubble_=function(){return!!this.startBubble_&&(this.isDraggingBubble_=!0,this.startDraggingBubble_(),!0)},module$exports$Blockly$Gesture.Gesture.prototype.updateIsDraggingBlock_=function(){return!!this.targetBlock_&&(this.flyout_?this.isDraggingBlock_=this.updateIsDraggingFromFlyout_():this.targetBlock_.isMovable()&&(this.isDraggingBlock_=!0),!!this.isDraggingBlock_&&(this.startDraggingBlock_(),!0))},module$exports$Blockly$Gesture.Gesture.prototype.updateIsDraggingWorkspace_=function(){(this.flyout_?this.flyout_.isScrollable():this.startWorkspace_&&this.startWorkspace_.isDraggable())&&(this.workspaceDragger_=new module$exports$Blockly$WorkspaceDragger.WorkspaceDragger(this.startWorkspace_),this.isDraggingWorkspace_=!0,this.workspaceDragger_.startDrag())},module$exports$Blockly$Gesture.Gesture.prototype.updateIsDragging_=function(){if(this.calledUpdateIsDragging_)throw Error("updateIsDragging_ should only be called once per gesture.");this.calledUpdateIsDragging_=!0,this.updateIsDraggingBubble_()||this.updateIsDraggingBlock_()||this.updateIsDraggingWorkspace_()},module$exports$Blockly$Gesture.Gesture.prototype.startDraggingBlock_=function(){this.blockDragger_=new((0,module$exports$Blockly$registry.getClassFromOptions)(module$exports$Blockly$registry.Type.BLOCK_DRAGGER,this.creatorWorkspace_.options,!0))(this.targetBlock_,this.startWorkspace_),this.blockDragger_.startDrag(this.currentDragDeltaXY_,this.healStack_),this.blockDragger_.drag(this.mostRecentEvent_,this.currentDragDeltaXY_)},module$exports$Blockly$Gesture.Gesture.prototype.startDraggingBubble_=function(){this.bubbleDragger_=new module$exports$Blockly$BubbleDragger.BubbleDragger(this.startBubble_,this.startWorkspace_),this.bubbleDragger_.startBubbleDrag(),this.bubbleDragger_.dragBubble(this.mostRecentEvent_,this.currentDragDeltaXY_)},module$exports$Blockly$Gesture.Gesture.prototype.doStart=function(a){(0,module$exports$Blockly$browserEvents.isTargetInput)(a)?this.cancel():(this.hasStarted_=!0,(0,module$exports$Blockly$blockAnimations.disconnectUiStop)(),this.startWorkspace_.updateScreenCalculationsIfScrolled(),this.startWorkspace_.isMutator&&this.startWorkspace_.resize(),this.startWorkspace_.hideChaff(!!this.flyout_),this.startWorkspace_.markFocused(),this.mostRecentEvent_=a,(0,module$exports$Blockly$Tooltip.block)(),this.targetBlock_&&this.targetBlock_.select(),(0,module$exports$Blockly$browserEvents.isRightButton)(a)?this.handleRightClick(a):("touchstart"!==a.type.toLowerCase()&&"pointerdown"!==a.type.toLowerCase()||"mouse"===a.pointerType||(0,module$exports$Blockly$Touch.longStart)(a,this),this.mouseDownXY_=new module$exports$Blockly$utils$Coordinate.Coordinate(a.clientX,a.clientY),this.healStack_=a.altKey||a.ctrlKey||a.metaKey,this.bindMouseEvents(a)))},module$exports$Blockly$Gesture.Gesture.prototype.bindMouseEvents=function(a){this.onMoveWrapper_=(0,module$exports$Blockly$browserEvents.conditionalBind)(document,"mousemove",null,this.handleMove.bind(this)),this.onUpWrapper_=(0,module$exports$Blockly$browserEvents.conditionalBind)(document,"mouseup",null,this.handleUp.bind(this)),a.preventDefault(),a.stopPropagation()},module$exports$Blockly$Gesture.Gesture.prototype.handleMove=function(a){this.updateFromEvent_(a),this.isDraggingWorkspace_?this.workspaceDragger_.drag(this.currentDragDeltaXY_):this.isDraggingBlock_?this.blockDragger_.drag(this.mostRecentEvent_,this.currentDragDeltaXY_):this.isDraggingBubble_&&this.bubbleDragger_.dragBubble(this.mostRecentEvent_,this.currentDragDeltaXY_),a.preventDefault(),a.stopPropagation()},module$exports$Blockly$Gesture.Gesture.prototype.handleUp=function(a){this.updateFromEvent_(a),(0,module$exports$Blockly$Touch.longStop)(),this.isEnding_?console.log("Trying to end a gesture recursively."):(this.isEnding_=!0,this.isDraggingBubble_?this.bubbleDragger_.endBubbleDrag(a,this.currentDragDeltaXY_):this.isDraggingBlock_?this.blockDragger_.endDrag(a,this.currentDragDeltaXY_):this.isDraggingWorkspace_?this.workspaceDragger_.endDrag(this.currentDragDeltaXY_):this.isBubbleClick_()?this.doBubbleClick_():this.isFieldClick_()?this.doFieldClick_():this.isBlockClick_()?this.doBlockClick_():this.isWorkspaceClick_()&&this.doWorkspaceClick_(a),a.preventDefault(),a.stopPropagation(),this.dispose())},module$exports$Blockly$Gesture.Gesture.prototype.cancel=function(){this.isEnding_||((0,module$exports$Blockly$Touch.longStop)(),this.isDraggingBubble_?this.bubbleDragger_.endBubbleDrag(this.mostRecentEvent_,this.currentDragDeltaXY_):this.isDraggingBlock_?this.blockDragger_.endDrag(this.mostRecentEvent_,this.currentDragDeltaXY_):this.isDraggingWorkspace_&&this.workspaceDragger_.endDrag(this.currentDragDeltaXY_),this.dispose())},module$exports$Blockly$Gesture.Gesture.prototype.handleRightClick=function(a){this.targetBlock_?(this.bringBlockToFront_(),this.targetBlock_.workspace.hideChaff(!!this.flyout_),this.targetBlock_.showContextMenu(a)):this.startBubble_?this.startBubble_.showContextMenu(a):this.startWorkspace_&&!this.flyout_&&(this.startWorkspace_.hideChaff(),this.startWorkspace_.showContextMenu(a)),a.preventDefault(),a.stopPropagation(),this.dispose()},module$exports$Blockly$Gesture.Gesture.prototype.handleWsStart=function(a,b){if(this.hasStarted_)throw Error("Tried to call gesture.handleWsStart, but the gesture had already been started.");this.setStartWorkspace_(b),this.mostRecentEvent_=a,this.doStart(a)},module$exports$Blockly$Gesture.Gesture.prototype.fireWorkspaceClick_=function(a){(0,module$exports$Blockly$Events$utils.fire)(new((0,module$exports$Blockly$Events$utils.get)(module$exports$Blockly$Events$utils.CLICK))(null,a.id,"workspace"))},module$exports$Blockly$Gesture.Gesture.prototype.handleFlyoutStart=function(a,b){if(this.hasStarted_)throw Error("Tried to call gesture.handleFlyoutStart, but the gesture had already been started.");this.setStartFlyout_(b),this.handleWsStart(a,b.getWorkspace())},module$exports$Blockly$Gesture.Gesture.prototype.handleBlockStart=function(a,b){if(this.hasStarted_)throw Error("Tried to call gesture.handleBlockStart, but the gesture had already been started.");this.setStartBlock(b),this.mostRecentEvent_=a},module$exports$Blockly$Gesture.Gesture.prototype.handleBubbleStart=function(a,b){if(this.hasStarted_)throw Error("Tried to call gesture.handleBubbleStart, but the gesture had already been started.");this.setStartBubble(b),this.mostRecentEvent_=a},module$exports$Blockly$Gesture.Gesture.prototype.doBubbleClick_=function(){this.startBubble_.setFocus&&this.startBubble_.setFocus(),this.startBubble_.select&&this.startBubble_.select()},module$exports$Blockly$Gesture.Gesture.prototype.doFieldClick_=function(){this.startField_.showEditor(this.mostRecentEvent_),this.bringBlockToFront_()},module$exports$Blockly$Gesture.Gesture.prototype.doBlockClick_=function(){if(this.flyout_&&this.flyout_.autoClose)this.targetBlock_.isEnabled()&&((0,module$exports$Blockly$Events$utils.getGroup)()||(0,module$exports$Blockly$Events$utils.setGroup)(!0),this.flyout_.createBlock(this.targetBlock_).scheduleSnapAndBump());else{var a=new((0,module$exports$Blockly$Events$utils.get)(module$exports$Blockly$Events$utils.CLICK))(this.startBlock_,this.startWorkspace_.id,"block");(0,module$exports$Blockly$Events$utils.fire)(a)}this.bringBlockToFront_(),(0,module$exports$Blockly$Events$utils.setGroup)(!1)},module$exports$Blockly$Gesture.Gesture.prototype.doWorkspaceClick_=function(a){a=this.creatorWorkspace_,(0,$.module$exports$Blockly$common.getSelected)()&&(0,$.module$exports$Blockly$common.getSelected)().unselect(),this.fireWorkspaceClick_(this.startWorkspace_||a)},module$exports$Blockly$Gesture.Gesture.prototype.bringBlockToFront_=function(){this.targetBlock_&&!this.flyout_&&this.targetBlock_.bringToFront()},module$exports$Blockly$Gesture.Gesture.prototype.setStartField=function(a){if(this.hasStarted_)throw Error("Tried to call gesture.setStartField, but the gesture had already been started.");this.startField_||(this.startField_=a)},module$exports$Blockly$Gesture.Gesture.prototype.setStartBubble=function(a){this.startBubble_||(this.startBubble_=a)},module$exports$Blockly$Gesture.Gesture.prototype.setStartBlock=function(a){this.startBlock_||this.startBubble_||(this.startBlock_=a,a.isInFlyout&&a!==a.getRootBlock()?this.setTargetBlock_(a.getRootBlock()):this.setTargetBlock_(a))},module$exports$Blockly$Gesture.Gesture.prototype.setTargetBlock_=function(a){a.isShadow()?this.setTargetBlock_(a.getParent()):this.targetBlock_=a},module$exports$Blockly$Gesture.Gesture.prototype.setStartWorkspace_=function(a){this.startWorkspace_||(this.startWorkspace_=a)},module$exports$Blockly$Gesture.Gesture.prototype.setStartFlyout_=function(a){this.flyout_||(this.flyout_=a)},module$exports$Blockly$Gesture.Gesture.prototype.isBubbleClick_=function(){return!!this.startBubble_&&!this.hasExceededDragRadius_},module$exports$Blockly$Gesture.Gesture.prototype.isBlockClick_=function(){return!!this.startBlock_&&!this.hasExceededDragRadius_&&!this.isFieldClick_()},module$exports$Blockly$Gesture.Gesture.prototype.isFieldClick_=function(){return!!this.startField_&&this.startField_.isClickable()&&!this.hasExceededDragRadius_&&(!this.flyout_||!this.flyout_.autoClose)},module$exports$Blockly$Gesture.Gesture.prototype.isWorkspaceClick_=function(){return!(this.startBlock_||this.startBubble_||this.startField_||this.hasExceededDragRadius_)},module$exports$Blockly$Gesture.Gesture.prototype.isDragging=function(){return this.isDraggingWorkspace_||this.isDraggingBlock_||this.isDraggingBubble_},module$exports$Blockly$Gesture.Gesture.prototype.hasStarted=function(){return this.hasStarted_},module$exports$Blockly$Gesture.Gesture.prototype.getInsertionMarkers=function(){return this.blockDragger_?this.blockDragger_.getInsertionMarkers():[]},module$exports$Blockly$Gesture.Gesture.prototype.getCurrentDragger=function(){return this.isDraggingBlock_?this.blockDragger_:this.isDraggingWorkspace_?this.workspaceDragger_:this.isDraggingBubble_?this.bubbleDragger_:null},module$exports$Blockly$Gesture.Gesture.inProgress=function(){for(var c,a=module$exports$Blockly$Workspace.Workspace.getAll(),b=0;c=a[b];b++)if(c.currentGesture_)return!0;return!1};var module$exports$Blockly$Field={Field:function(a,b,c){this.value_=this.DEFAULT_VALUE,this.tooltip_=this.validator_=null,this.size_=new module$exports$Blockly$utils$Size.Size(0,0),this.constants_=this.mouseDownWrapper_=this.textContent_=this.textElement_=this.borderRect_=this.fieldGroup_=this.markerSvg_=this.cursorSvg_=null,c&&this.configure_(c),this.setValue(a),b&&this.setValidator(b)}};module$exports$Blockly$Field.Field.prototype.DEFAULT_VALUE=null,module$exports$Blockly$Field.Field.prototype.name=void 0,module$exports$Blockly$Field.Field.prototype.disposed=!1,module$exports$Blockly$Field.Field.prototype.maxDisplayLength=50,module$exports$Blockly$Field.Field.prototype.sourceBlock_=null,module$exports$Blockly$Field.Field.prototype.isDirty_=!0,module$exports$Blockly$Field.Field.prototype.visible_=!0,module$exports$Blockly$Field.Field.prototype.enabled_=!0,module$exports$Blockly$Field.Field.prototype.clickTarget_=null,module$exports$Blockly$Field.Field.NBSP="",module$exports$Blockly$Field.Field.prototype.EDITABLE=!0,module$exports$Blockly$Field.Field.prototype.SERIALIZABLE=!1,module$exports$Blockly$Field.Field.prototype.configure_=function(a){var b=a.tooltip;"string"==typeof b&&(b=(0,module$exports$Blockly$utils$parsing.replaceMessageReferences)(a.tooltip)),b&&this.setTooltip(b)},module$exports$Blockly$Field.Field.prototype.setSourceBlock=function(a){if(this.sourceBlock_)throw Error("Field already bound to a block");this.sourceBlock_=a},module$exports$Blockly$Field.Field.prototype.getConstants=function(){return!this.constants_&&this.sourceBlock_&&this.sourceBlock_.workspace&&this.sourceBlock_.workspace.rendered&&(this.constants_=this.sourceBlock_.workspace.getRenderer().getConstants()),this.constants_},module$exports$Blockly$Field.Field.prototype.getSourceBlock=function(){return this.sourceBlock_},module$exports$Blockly$Field.Field.prototype.init=function(){this.fieldGroup_||(this.fieldGroup_=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.G,{},null),this.isVisible()||(this.fieldGroup_.style.display="none"),this.sourceBlock_.getSvgRoot().appendChild(this.fieldGroup_),this.initView(),this.updateEditable(),this.setTooltip(this.tooltip_),this.bindEvents_(),this.initModel())},module$exports$Blockly$Field.Field.prototype.initView=function(){this.createBorderRect_(),this.createTextElement_()},module$exports$Blockly$Field.Field.prototype.initModel=function(){},module$exports$Blockly$Field.Field.prototype.createBorderRect_=function(){this.borderRect_=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.RECT,{rx:this.getConstants().FIELD_BORDER_RECT_RADIUS,ry:this.getConstants().FIELD_BORDER_RECT_RADIUS,x:0,y:0,height:this.size_.height,width:this.size_.width,class:"blocklyFieldRect"},this.fieldGroup_)},module$exports$Blockly$Field.Field.prototype.createTextElement_=function(){this.textElement_=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.TEXT,{class:"blocklyText"},this.fieldGroup_),this.getConstants().FIELD_TEXT_BASELINE_CENTER&&this.textElement_.setAttribute("dominant-baseline","central"),this.textContent_=document.createTextNode(""),this.textElement_.appendChild(this.textContent_)},module$exports$Blockly$Field.Field.prototype.bindEvents_=function(){(0,module$exports$Blockly$Tooltip.bindMouseEvents)(this.getClickTarget_()),this.mouseDownWrapper_=(0,module$exports$Blockly$browserEvents.conditionalBind)(this.getClickTarget_(),"mousedown",this,this.onMouseDown_)},module$exports$Blockly$Field.Field.prototype.fromXml=function(a){this.setValue(a.textContent)},module$exports$Blockly$Field.Field.prototype.toXml=function(a){return a.textContent=this.getValue(),a},module$exports$Blockly$Field.Field.prototype.saveState=function(a){return null!==(a=this.saveLegacyState(module$exports$Blockly$Field.Field))?a:this.getValue()},module$exports$Blockly$Field.Field.prototype.loadState=function(a){this.loadLegacyState(module$exports$Blockly$Field.Field,a)||this.setValue(a)},module$exports$Blockly$Field.Field.prototype.saveLegacyState=function(a){return a.prototype.saveState===this.saveState&&a.prototype.toXml!==this.toXml?((a=(0,$.module$exports$Blockly$utils$xml.createElement)("field")).setAttribute("name",this.name||""),(0,$.module$exports$Blockly$Xml.domToText)(this.toXml(a)).replace(' xmlns="https://developers.google.com/blockly/xml"',"")):null},module$exports$Blockly$Field.Field.prototype.loadLegacyState=function(a,b){return a.prototype.loadState===this.loadState&&a.prototype.fromXml!==this.fromXml&&(this.fromXml((0,$.module$exports$Blockly$Xml.textToDom)(b)),!0)},module$exports$Blockly$Field.Field.prototype.dispose=function(){module$exports$Blockly$DropDownDiv.DropDownDiv.hideIfOwner(this),(0,module$exports$Blockly$WidgetDiv.hideIfOwner)(this),(0,module$exports$Blockly$Tooltip.unbindMouseEvents)(this.getClickTarget_()),this.mouseDownWrapper_&&(0,module$exports$Blockly$browserEvents.unbind)(this.mouseDownWrapper_),(0,module$exports$Blockly$utils$dom.removeNode)(this.fieldGroup_),this.disposed=!0},module$exports$Blockly$Field.Field.prototype.updateEditable=function(){var a=this.fieldGroup_;this.EDITABLE&&a&&(this.enabled_&&this.sourceBlock_.isEditable()?((0,module$exports$Blockly$utils$dom.addClass)(a,"blocklyEditableText"),(0,module$exports$Blockly$utils$dom.removeClass)(a,"blocklyNonEditableText"),a.style.cursor=this.CURSOR):((0,module$exports$Blockly$utils$dom.addClass)(a,"blocklyNonEditableText"),(0,module$exports$Blockly$utils$dom.removeClass)(a,"blocklyEditableText"),a.style.cursor=""))},module$exports$Blockly$Field.Field.prototype.setEnabled=function(a){this.enabled_=a,this.updateEditable()},module$exports$Blockly$Field.Field.prototype.isEnabled=function(){return this.enabled_},module$exports$Blockly$Field.Field.prototype.isClickable=function(){return this.enabled_&&!!this.sourceBlock_&&this.sourceBlock_.isEditable()&&!!this.showEditor_&&"function"==typeof this.showEditor_},module$exports$Blockly$Field.Field.prototype.isCurrentlyEditable=function(){return this.enabled_&&this.EDITABLE&&!!this.sourceBlock_&&this.sourceBlock_.isEditable()},module$exports$Blockly$Field.Field.prototype.isSerializable=function(){var a=!1;return this.name&&(this.SERIALIZABLE?a=!0:this.EDITABLE&&(console.warn("Detected an editable field that was not serializable. Please define SERIALIZABLE property as true on all editable custom fields. Proceeding with serialization."),a=!0)),a},module$exports$Blockly$Field.Field.prototype.isVisible=function(){return this.visible_},module$exports$Blockly$Field.Field.prototype.setVisible=function(a){if(this.visible_!==a){this.visible_=a;var b=this.getSvgRoot();b&&(b.style.display=a?"block":"none")}},module$exports$Blockly$Field.Field.prototype.setValidator=function(a){this.validator_=a},module$exports$Blockly$Field.Field.prototype.getValidator=function(){return this.validator_},module$exports$Blockly$Field.Field.prototype.getSvgRoot=function(){return this.fieldGroup_},module$exports$Blockly$Field.Field.prototype.applyColour=function(){},module$exports$Blockly$Field.Field.prototype.render_=function(){this.textContent_&&(this.textContent_.nodeValue=this.getDisplayText_()),this.updateSize_()},module$exports$Blockly$Field.Field.prototype.showEditor=function(a){this.isClickable()&&this.showEditor_(a)},module$exports$Blockly$Field.Field.prototype.updateSize_=function(a){var b=this.getConstants(),c=2*(a=void 0!==a?a:this.borderRect_?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0),d=b.FIELD_TEXT_HEIGHT,e=0;this.textElement_&&(c+=e=(0,module$exports$Blockly$utils$dom.getFastTextWidth)(this.textElement_,b.FIELD_TEXT_FONTSIZE,b.FIELD_TEXT_FONTWEIGHT,b.FIELD_TEXT_FONTFAMILY)),this.borderRect_&&(d=Math.max(d,b.FIELD_BORDER_RECT_HEIGHT)),this.size_.height=d,this.size_.width=c,this.positionTextElement_(a,e),this.positionBorderRect_()},module$exports$Blockly$Field.Field.prototype.positionTextElement_=function(a,b){if(this.textElement_){var c=this.getConstants(),d=this.size_.height/2;this.textElement_.setAttribute("x",this.sourceBlock_.RTL?this.size_.width-b-a:a),this.textElement_.setAttribute("y",c.FIELD_TEXT_BASELINE_CENTER?d:d-c.FIELD_TEXT_HEIGHT/2+c.FIELD_TEXT_BASELINE)}},module$exports$Blockly$Field.Field.prototype.positionBorderRect_=function(){this.borderRect_&&(this.borderRect_.setAttribute("width",this.size_.width),this.borderRect_.setAttribute("height",this.size_.height),this.borderRect_.setAttribute("rx",this.getConstants().FIELD_BORDER_RECT_RADIUS),this.borderRect_.setAttribute("ry",this.getConstants().FIELD_BORDER_RECT_RADIUS))},module$exports$Blockly$Field.Field.prototype.getSize=function(){return this.isVisible()?(this.isDirty_?(this.render_(),this.isDirty_=!1):this.visible_&&0===this.size_.width&&(console.warn("Deprecated use of setting size_.width to 0 to rerender a field. Set field.isDirty_ to true instead."),this.render_()),this.size_):new module$exports$Blockly$utils$Size.Size(0,0)},module$exports$Blockly$Field.Field.prototype.getScaledBBox=function(){if(this.borderRect_)var a=this.borderRect_.getBoundingClientRect(),b=(0,module$exports$Blockly$utils$style.getPageOffset)(this.borderRect_),c=a.width,d=a.height;else d=this.sourceBlock_.getHeightWidth(),a=this.sourceBlock_.workspace.scale,b=this.getAbsoluteXY_(),c=d.width*a,d=d.height*a,module$exports$Blockly$utils$userAgent.GECKO?(b.x+=1.5*a,b.y+=1.5*a):module$exports$Blockly$utils$userAgent.EDGE||module$exports$Blockly$utils$userAgent.IE||(b.x-=.5*a,b.y-=.5*a),c+=1*a,d+=1*a;return new module$exports$Blockly$utils$Rect.Rect(b.y,b.y+d,b.x,b.x+c)},module$exports$Blockly$Field.Field.prototype.getDisplayText_=function(){var a=this.getText();return a?(a.length>this.maxDisplayLength&&(a=a.substring(0,this.maxDisplayLength-2)+""),a=a.replace(/\s/g,module$exports$Blockly$Field.Field.NBSP),this.sourceBlock_&&this.sourceBlock_.RTL&&(a+=""),a):module$exports$Blockly$Field.Field.NBSP},module$exports$Blockly$Field.Field.prototype.getText=function(){if(this.getText_){var a=this.getText_.call(this);if(null!==a)return String(a)}return String(this.getValue())},module$exports$Blockly$Field.Field.prototype.markDirty=function(){this.isDirty_=!0,this.constants_=null},module$exports$Blockly$Field.Field.prototype.forceRerender=function(){this.isDirty_=!0,this.sourceBlock_&&this.sourceBlock_.rendered&&(this.sourceBlock_.render(),this.sourceBlock_.bumpNeighbours(),this.updateMarkers_())},module$exports$Blockly$Field.Field.prototype.setValue=function(a){if(null!==a){var b=this.doClassValidation_(a);if(!((a=this.processValidation_(a,b))instanceof Error)){if((b=this.getValidator())&&(b=b.call(this,a),(a=this.processValidation_(a,b))instanceof Error))return;if(!(b=this.sourceBlock_)||!b.disposed){var c=this.getValue();c===a?this.doValueUpdate_(a):(this.doValueUpdate_(a),b&&(0,module$exports$Blockly$Events$utils.isEnabled)()&&(0,module$exports$Blockly$Events$utils.fire)(new((0,module$exports$Blockly$Events$utils.get)(module$exports$Blockly$Events$utils.CHANGE))(b,"field",this.name||null,c,a)),this.isDirty_&&this.forceRerender())}}}},module$exports$Blockly$Field.Field.prototype.processValidation_=function(a,b){return null===b?(this.doValueInvalid_(a),this.isDirty_&&this.forceRerender(),Error()):(void 0!==b&&(a=b),a)},module$exports$Blockly$Field.Field.prototype.getValue=function(){return this.value_},module$exports$Blockly$Field.Field.prototype.doClassValidation_=function(a){return null==a?null:a},module$exports$Blockly$Field.Field.prototype.doValueUpdate_=function(a){this.value_=a,this.isDirty_=!0},module$exports$Blockly$Field.Field.prototype.doValueInvalid_=function(a){},module$exports$Blockly$Field.Field.prototype.onMouseDown_=function(a){this.sourceBlock_&&this.sourceBlock_.workspace&&(a=this.sourceBlock_.workspace.getGesture(a))&&a.setStartField(this)},module$exports$Blockly$Field.Field.prototype.setTooltip=function(a){a||""===a||(a=this.sourceBlock_);var b=this.getClickTarget_();b?b.tooltip=a:this.tooltip_=a},module$exports$Blockly$Field.Field.prototype.getTooltip=function(){var a=this.getClickTarget_();return a?(0,module$exports$Blockly$Tooltip.getTooltipOfObject)(a):(0,module$exports$Blockly$Tooltip.getTooltipOfObject)({tooltip:this.tooltip_})},module$exports$Blockly$Field.Field.prototype.getClickTarget_=function(){return this.clickTarget_||this.getSvgRoot()},module$exports$Blockly$Field.Field.prototype.getAbsoluteXY_=function(){return(0,module$exports$Blockly$utils$style.getPageOffset)(this.getClickTarget_())},module$exports$Blockly$Field.Field.prototype.referencesVariables=function(){return!1},module$exports$Blockly$Field.Field.prototype.getParentInput=function(){for(var a=null,b=this.sourceBlock_,c=b.inputList,d=0;d<b.inputList.length;d++)for(var e=c[d],f=e.fieldRow,g=0;g<f.length;g++)if(f[g]===this){a=e;break}return a},module$exports$Blockly$Field.Field.prototype.getFlipRtl=function(){return!1},module$exports$Blockly$Field.Field.prototype.isTabNavigable=function(){return!1},module$exports$Blockly$Field.Field.prototype.onShortcut=function(a){return!1},module$exports$Blockly$Field.Field.prototype.setCursorSvg=function(a){a?(this.fieldGroup_.appendChild(a),this.cursorSvg_=a):this.cursorSvg_=null},module$exports$Blockly$Field.Field.prototype.setMarkerSvg=function(a){a?(this.fieldGroup_.appendChild(a),this.markerSvg_=a):this.markerSvg_=null},module$exports$Blockly$Field.Field.prototype.updateMarkers_=function(){var a=this.sourceBlock_.workspace;a.keyboardAccessibilityMode&&this.cursorSvg_&&a.getCursor().draw(),a.keyboardAccessibilityMode&&this.markerSvg_&&a.getMarker(module$exports$Blockly$MarkerManager.MarkerManager.LOCAL_MARKER).draw()},$.module$exports$Blockly$FieldLabel={FieldLabel:function(a,b,c){this.class_=null,$.module$exports$Blockly$FieldLabel.FieldLabel.superClass_.constructor.call(this,a,null,c),c||(this.class_=b||null)}},(0,$.module$exports$Blockly$utils$object.inherits)($.module$exports$Blockly$FieldLabel.FieldLabel,module$exports$Blockly$Field.Field),$.module$exports$Blockly$FieldLabel.FieldLabel.prototype.DEFAULT_VALUE="",$.module$exports$Blockly$FieldLabel.FieldLabel.fromJson=function(a){return new this((0,module$exports$Blockly$utils$parsing.replaceMessageReferences)(a.text),void 0,a)},$.module$exports$Blockly$FieldLabel.FieldLabel.prototype.EDITABLE=!1,$.module$exports$Blockly$FieldLabel.FieldLabel.prototype.configure_=function(a){$.module$exports$Blockly$FieldLabel.FieldLabel.superClass_.configure_.call(this,a),this.class_=a.class},$.module$exports$Blockly$FieldLabel.FieldLabel.prototype.initView=function(){this.createTextElement_(),this.class_&&(0,module$exports$Blockly$utils$dom.addClass)(this.textElement_,this.class_)},$.module$exports$Blockly$FieldLabel.FieldLabel.prototype.doClassValidation_=function(a){return null==a?null:String(a)},$.module$exports$Blockly$FieldLabel.FieldLabel.prototype.setClass=function(a){this.textElement_&&(this.class_&&(0,module$exports$Blockly$utils$dom.removeClass)(this.textElement_,this.class_),a&&(0,module$exports$Blockly$utils$dom.addClass)(this.textElement_,a)),this.class_=a},(0,module$exports$Blockly$fieldRegistry.register)("field_label",$.module$exports$Blockly$FieldLabel.FieldLabel);var module$exports$Blockly$blockRendering$Debug={Debug:function(a){this.debugElements_=[],this.svgRoot_=null,this.constants_=a}};module$exports$Blockly$blockRendering$Debug.Debug.config={rowSpacers:!0,elemSpacers:!0,rows:!0,elems:!0,connections:!0,blockBounds:!0,connectedBlockBounds:!0,render:!0},module$exports$Blockly$blockRendering$Debug.Debug.prototype.clearElems=function(){for(var a=0;a<this.debugElements_.length;a++)(0,module$exports$Blockly$utils$dom.removeNode)(this.debugElements_[a]);this.debugElements_=[]},module$exports$Blockly$blockRendering$Debug.Debug.prototype.drawSpacerRow=function(a,b,c){if(module$exports$Blockly$blockRendering$Debug.Debug.config.rowSpacers){var d=Math.abs(a.height),e=0>a.height;e&&(b-=d),this.debugElements_.push((0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.RECT,{class:"rowSpacerRect blockRenderDebug",x:c?-(a.xPos+a.width):a.xPos,y:b,width:a.width,height:d,stroke:e?"black":"blue",fill:"blue","fill-opacity":"0.5","stroke-width":"1px"},this.svgRoot_))}},module$exports$Blockly$blockRendering$Debug.Debug.prototype.drawSpacerElem=function(a,b,c){if(module$exports$Blockly$blockRendering$Debug.Debug.config.elemSpacers){b=Math.abs(a.width);var d=0>a.width,e=d?a.xPos-b:a.xPos;c&&(e=-(e+b)),this.debugElements_.push((0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.RECT,{class:"elemSpacerRect blockRenderDebug",x:e,y:a.centerline-a.height/2,width:b,height:a.height,stroke:"pink",fill:d?"black":"pink","fill-opacity":"0.5","stroke-width":"1px"},this.svgRoot_))}},module$exports$Blockly$blockRendering$Debug.Debug.prototype.drawRenderedElem=function(a,b){if(module$exports$Blockly$blockRendering$Debug.Debug.config.elems){var c=a.xPos;b&&(c=-(c+a.width)),b=a.centerline-a.height/2,this.debugElements_.push((0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.RECT,{class:"rowRenderingRect blockRenderDebug",x:c,y:b,width:a.width,height:a.height,stroke:"black",fill:"none","stroke-width":"1px"},this.svgRoot_)),module$exports$Blockly$blockRendering$Types.Types.isField(a)&&a.field instanceof $.module$exports$Blockly$FieldLabel.FieldLabel&&this.debugElements_.push((0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.RECT,{class:"rowRenderingRect blockRenderDebug",x:c,y:b+this.constants_.FIELD_TEXT_BASELINE,width:a.width,height:"0.1px",stroke:"red",fill:"none","stroke-width":"0.5px"},this.svgRoot_))}module$exports$Blockly$blockRendering$Types.Types.isInput(a)&&module$exports$Blockly$blockRendering$Debug.Debug.config.connections&&this.drawConnection(a.connectionModel)},module$exports$Blockly$blockRendering$Debug.Debug.prototype.drawConnection=function(a){if(module$exports$Blockly$blockRendering$Debug.Debug.config.connections){if(a.type===$.module$exports$Blockly$ConnectionType.ConnectionType.INPUT_VALUE)var b=4,c="magenta",d="none";else a.type===$.module$exports$Blockly$ConnectionType.ConnectionType.OUTPUT_VALUE?(b=2,d=c="magenta"):a.type===$.module$exports$Blockly$ConnectionType.ConnectionType.NEXT_STATEMENT?(b=4,c="goldenrod",d="none"):a.type===$.module$exports$Blockly$ConnectionType.ConnectionType.PREVIOUS_STATEMENT&&(b=2,d=c="goldenrod");this.debugElements_.push((0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.CIRCLE,{class:"blockRenderDebug",cx:a.offsetInBlock_.x,cy:a.offsetInBlock_.y,r:b,fill:d,stroke:c},this.svgRoot_))}},module$exports$Blockly$blockRendering$Debug.Debug.prototype.drawRenderedRow=function(a,b,c){module$exports$Blockly$blockRendering$Debug.Debug.config.rows&&(this.debugElements_.push((0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.RECT,{class:"elemRenderingRect blockRenderDebug",x:c?-(a.xPos+a.width):a.xPos,y:a.yPos,width:a.width,height:a.height,stroke:"red",fill:"none","stroke-width":"1px"},this.svgRoot_)),module$exports$Blockly$blockRendering$Types.Types.isTopOrBottomRow(a)||module$exports$Blockly$blockRendering$Debug.Debug.config.connectedBlockBounds&&this.debugElements_.push((0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.RECT,{class:"connectedBlockWidth blockRenderDebug",x:c?-(a.xPos+a.widthWithConnectedBlocks):a.xPos,y:a.yPos,width:a.widthWithConnectedBlocks,height:a.height,stroke:this.randomColour_,fill:"none","stroke-width":"1px","stroke-dasharray":"3,3"},this.svgRoot_)))},module$exports$Blockly$blockRendering$Debug.Debug.prototype.drawRowWithElements=function(a,b,c){for(var d=0;d<a.elements.length;d++){var e=a.elements[d];e?module$exports$Blockly$blockRendering$Types.Types.isSpacer(e)?this.drawSpacerElem(e,a.height,c):this.drawRenderedElem(e,c):console.warn("A row has an undefined or null element.",a,e)}this.drawRenderedRow(a,b,c)},module$exports$Blockly$blockRendering$Debug.Debug.prototype.drawBoundingBox=function(a){if(module$exports$Blockly$blockRendering$Debug.Debug.config.blockBounds){var b=a.RTL?-a.width:0;this.debugElements_.push((0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.RECT,{class:"blockBoundingBox blockRenderDebug",x:b,y:0,width:a.width,height:a.height,stroke:"black",fill:"none","stroke-width":"1px","stroke-dasharray":"5,5"},this.svgRoot_)),module$exports$Blockly$blockRendering$Debug.Debug.config.connectedBlockBounds&&(b=a.RTL?-a.widthWithChildren:0,this.debugElements_.push((0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.RECT,{class:"blockRenderDebug",x:b,y:0,width:a.widthWithChildren,height:a.height,stroke:"#DF57BC",fill:"none","stroke-width":"1px","stroke-dasharray":"3,3"},this.svgRoot_)))}},module$exports$Blockly$blockRendering$Debug.Debug.prototype.drawDebug=function(a,b){this.clearElems(),this.svgRoot_=a.getSvgRoot(),this.randomColour_="#"+Math.floor(16777215*Math.random()).toString(16);for(var c=0,d=0;d<b.rows.length;d++){var e=b.rows[d];module$exports$Blockly$blockRendering$Types.Types.isBetweenRowSpacer(e)?this.drawSpacerRow(e,c,b.RTL):this.drawRowWithElements(e,c,b.RTL),c+=e.height}a.previousConnection&&this.drawConnection(a.previousConnection),a.nextConnection&&this.drawConnection(a.nextConnection),a.outputConnection&&this.drawConnection(a.outputConnection),b.rightSide&&this.drawRenderedElem(b.rightSide,b.RTL),this.drawBoundingBox(b),this.drawRender(a.pathObject.svgPath)},module$exports$Blockly$blockRendering$Debug.Debug.prototype.drawRender=function(a){module$exports$Blockly$blockRendering$Debug.Debug.config.render&&(a.setAttribute("filter","url(#"+this.constants_.debugFilterId+")"),setTimeout((function(){a.setAttribute("filter","")}),100))};var module$exports$Blockly$blockRendering$Drawer={Drawer:function(a,b){this.block_=a,this.info_=b,this.topLeft_=a.getRelativeToSurfaceXY(),this.inlinePath_=this.outlinePath_="",this.constants_=b.getRenderer().getConstants()}};module$exports$Blockly$blockRendering$Drawer.Drawer.prototype.draw=function(){this.hideHiddenIcons_(),this.drawOutline_(),this.drawInternals_(),this.block_.pathObject.setPath(this.outlinePath_+"\n"+this.inlinePath_),this.info_.RTL&&this.block_.pathObject.flipRTL(),(0,module$exports$Blockly$blockRendering$debug.isDebuggerEnabled)()&&this.block_.renderingDebugger.drawDebug(this.block_,this.info_),this.recordSizeOnBlock_()},module$exports$Blockly$blockRendering$Drawer.Drawer.prototype.recordSizeOnBlock_=function(){this.block_.height=this.info_.height,this.block_.width=this.info_.widthWithChildren},module$exports$Blockly$blockRendering$Drawer.Drawer.prototype.hideHiddenIcons_=function(){for(var b,a=0;b=this.info_.hiddenIcons[a];a++)b.icon.iconGroup_.setAttribute("display","none")},module$exports$Blockly$blockRendering$Drawer.Drawer.prototype.drawOutline_=function(){this.drawTop_();for(var a=1;a<this.info_.rows.length-1;a++){var b=this.info_.rows[a];b.hasJaggedEdge?this.drawJaggedEdge_(b):b.hasStatement?this.drawStatementInput_(b):b.hasExternalInput?this.drawValueInput_(b):this.drawRightSideRow_(b)}this.drawBottom_(),this.drawLeft_()},module$exports$Blockly$blockRendering$Drawer.Drawer.prototype.drawTop_=function(){var a=this.info_.topRow,b=a.elements;this.positionPreviousConnection_(),this.outlinePath_+=(0,module$exports$Blockly$utils$svgPaths.moveBy)(a.xPos,this.info_.startY);for(var d,c=0;d=b[c];c++)module$exports$Blockly$blockRendering$Types.Types.isLeftRoundedCorner(d)?this.outlinePath_+=this.constants_.OUTSIDE_CORNERS.topLeft:module$exports$Blockly$blockRendering$Types.Types.isRightRoundedCorner(d)?this.outlinePath_+=this.constants_.OUTSIDE_CORNERS.topRight:module$exports$Blockly$blockRendering$Types.Types.isPreviousConnection(d)?this.outlinePath_+=d.shape.pathLeft:module$exports$Blockly$blockRendering$Types.Types.isHat(d)?this.outlinePath_+=this.constants_.START_HAT.path:module$exports$Blockly$blockRendering$Types.Types.isSpacer(d)&&(this.outlinePath_+=(0,module$exports$Blockly$utils$svgPaths.lineOnAxis)("h",d.width));this.outlinePath_+=(0,module$exports$Blockly$utils$svgPaths.lineOnAxis)("v",a.height)},module$exports$Blockly$blockRendering$Drawer.Drawer.prototype.drawJaggedEdge_=function(a){this.outlinePath_+=this.constants_.JAGGED_TEETH.path+(0,module$exports$Blockly$utils$svgPaths.lineOnAxis)("v",a.height-this.constants_.JAGGED_TEETH.height)},module$exports$Blockly$blockRendering$Drawer.Drawer.prototype.drawValueInput_=function(a){var b=a.getLastInput();this.positionExternalValueConnection_(a);var c="function"==typeof b.shape.pathDown?b.shape.pathDown(b.height):b.shape.pathDown;this.outlinePath_+=(0,module$exports$Blockly$utils$svgPaths.lineOnAxis)("H",b.xPos+b.width)+c+(0,module$exports$Blockly$utils$svgPaths.lineOnAxis)("v",a.height-b.connectionHeight)},module$exports$Blockly$blockRendering$Drawer.Drawer.prototype.drawStatementInput_=function(a){var b=a.getLastInput(),c=b.xPos+b.notchOffset+b.shape.width;b=b.shape.pathRight+(0,module$exports$Blockly$utils$svgPaths.lineOnAxis)("h",-(b.notchOffset-this.constants_.INSIDE_CORNERS.width))+this.constants_.INSIDE_CORNERS.pathTop;var d=a.height-2*this.constants_.INSIDE_CORNERS.height;this.outlinePath_+=(0,module$exports$Blockly$utils$svgPaths.lineOnAxis)("H",c)+b+(0,module$exports$Blockly$utils$svgPaths.lineOnAxis)("v",d)+this.constants_.INSIDE_CORNERS.pathBottom+(0,module$exports$Blockly$utils$svgPaths.lineOnAxis)("H",a.xPos+a.width),this.positionStatementInputConnection_(a)},module$exports$Blockly$blockRendering$Drawer.Drawer.prototype.drawRightSideRow_=function(a){this.outlinePath_+=(0,module$exports$Blockly$utils$svgPaths.lineOnAxis)("V",a.yPos+a.height)},module$exports$Blockly$blockRendering$Drawer.Drawer.prototype.drawBottom_=function(){var a=this.info_.bottomRow,b=a.elements;this.positionNextConnection_();for(var f,c=0,d="",e=b.length-1;f=b[e];e--)module$exports$Blockly$blockRendering$Types.Types.isNextConnection(f)?d+=f.shape.pathRight:module$exports$Blockly$blockRendering$Types.Types.isLeftSquareCorner(f)?d+=(0,module$exports$Blockly$utils$svgPaths.lineOnAxis)("H",a.xPos):module$exports$Blockly$blockRendering$Types.Types.isLeftRoundedCorner(f)?d+=this.constants_.OUTSIDE_CORNERS.bottomLeft:module$exports$Blockly$blockRendering$Types.Types.isRightRoundedCorner(f)?(d+=this.constants_.OUTSIDE_CORNERS.bottomRight,c=this.constants_.OUTSIDE_CORNERS.rightHeight):module$exports$Blockly$blockRendering$Types.Types.isSpacer(f)&&(d+=(0,module$exports$Blockly$utils$svgPaths.lineOnAxis)("h",-1*f.width));this.outlinePath_+=(0,module$exports$Blockly$utils$svgPaths.lineOnAxis)("V",a.baseline-c),this.outlinePath_+=d},module$exports$Blockly$blockRendering$Drawer.Drawer.prototype.drawLeft_=function(){var a=this.info_.outputConnection;if(this.positionOutputConnection_(),a){var b=a.connectionOffsetY+a.height;a="function"==typeof a.shape.pathUp?a.shape.pathUp(a.height):a.shape.pathUp,this.outlinePath_+=(0,module$exports$Blockly$utils$svgPaths.lineOnAxis)("V",b)+a}this.outlinePath_+="z"},module$exports$Blockly$blockRendering$Drawer.Drawer.prototype.drawInternals_=function(){for(var b,a=0;b=this.info_.rows[a];a++)for(var d,c=0;d=b.elements[c];c++)module$exports$Blockly$blockRendering$Types.Types.isInlineInput(d)?this.drawInlineInput_(d):(module$exports$Blockly$blockRendering$Types.Types.isIcon(d)||module$exports$Blockly$blockRendering$Types.Types.isField(d))&&this.layoutField_(d)},module$exports$Blockly$blockRendering$Drawer.Drawer.prototype.layoutField_=function(a){if(module$exports$Blockly$blockRendering$Types.Types.isField(a))var b=a.field.getSvgRoot();else module$exports$Blockly$blockRendering$Types.Types.isIcon(a)&&(b=a.icon.iconGroup_);var c=a.centerline-a.height/2,d=a.xPos,e="";this.info_.RTL&&(d=-(d+a.width),a.flipRtl&&(d+=a.width,e="scale(-1 1)")),module$exports$Blockly$blockRendering$Types.Types.isIcon(a)?(b.setAttribute("display","block"),b.setAttribute("transform","translate("+d+","+c+")"),a.icon.computeIconLocation()):b.setAttribute("transform","translate("+d+","+c+")"+e),this.info_.isInsertionMarker&&b.setAttribute("display","none")},module$exports$Blockly$blockRendering$Drawer.Drawer.prototype.drawInlineInput_=function(a){var b=a.width,c=a.height,d=a.connectionOffsetY,e=a.connectionHeight+d;this.inlinePath_+=(0,module$exports$Blockly$utils$svgPaths.moveTo)(a.xPos+a.connectionWidth,a.centerline-c/2)+(0,module$exports$Blockly$utils$svgPaths.lineOnAxis)("v",d)+a.shape.pathDown+(0,module$exports$Blockly$utils$svgPaths.lineOnAxis)("v",c-e)+(0,module$exports$Blockly$utils$svgPaths.lineOnAxis)("h",b-a.connectionWidth)+(0,module$exports$Blockly$utils$svgPaths.lineOnAxis)("v",-c)+"z",this.positionInlineInputConnection_(a)},module$exports$Blockly$blockRendering$Drawer.Drawer.prototype.positionInlineInputConnection_=function(a){var b=a.centerline-a.height/2;if(a.connectionModel){var c=a.xPos+a.connectionWidth+a.connectionOffsetX;this.info_.RTL&&(c*=-1),a.connectionModel.setOffsetInBlock(c,b+a.connectionOffsetY)}},module$exports$Blockly$blockRendering$Drawer.Drawer.prototype.positionStatementInputConnection_=function(a){var b=a.getLastInput();if(b.connectionModel){var c=a.xPos+a.statementEdge+b.notchOffset;this.info_.RTL&&(c*=-1),b.connectionModel.setOffsetInBlock(c,a.yPos)}},module$exports$Blockly$blockRendering$Drawer.Drawer.prototype.positionExternalValueConnection_=function(a){var b=a.getLastInput();if(b.connectionModel){var c=a.xPos+a.width;this.info_.RTL&&(c*=-1),b.connectionModel.setOffsetInBlock(c,a.yPos)}},module$exports$Blockly$blockRendering$Drawer.Drawer.prototype.positionPreviousConnection_=function(){var a=this.info_.topRow;if(a.connection){var b=a.xPos+a.notchOffset;a.connection.connectionModel.setOffsetInBlock(this.info_.RTL?-b:b,0)}},module$exports$Blockly$blockRendering$Drawer.Drawer.prototype.positionNextConnection_=function(){var a=this.info_.bottomRow;if(a.connection){var b=a.connection,c=b.xPos;b.connectionModel.setOffsetInBlock(this.info_.RTL?-c:c,a.baseline)}},module$exports$Blockly$blockRendering$Drawer.Drawer.prototype.positionOutputConnection_=function(){if(this.info_.outputConnection){var a=this.info_.startX+this.info_.outputConnection.connectionOffsetX;this.block_.outputConnection.setOffsetInBlock(this.info_.RTL?-a:a,this.info_.outputConnection.connectionOffsetY)}};var module$exports$Blockly$blockRendering$InputConnection={InputConnection:function(a,b){module$exports$Blockly$blockRendering$InputConnection.InputConnection.superClass_.constructor.call(this,a,b.connection),this.type|=module$exports$Blockly$blockRendering$Types.Types.INPUT,this.input=b,this.align=b.align,(this.connectedBlock=b.connection&&b.connection.targetBlock()?b.connection.targetBlock():null)?(a=this.connectedBlock.getHeightWidth(),this.connectedBlockWidth=a.width,this.connectedBlockHeight=a.height):this.connectedBlockHeight=this.connectedBlockWidth=0,this.connectionOffsetY=this.connectionOffsetX=0}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$blockRendering$InputConnection.InputConnection,module$exports$Blockly$blockRendering$Connection.Connection);var module$exports$Blockly$blockRendering$ExternalValueInput={ExternalValueInput:function(a,b){module$exports$Blockly$blockRendering$ExternalValueInput.ExternalValueInput.superClass_.constructor.call(this,a,b),this.type|=module$exports$Blockly$blockRendering$Types.Types.EXTERNAL_VALUE_INPUT,this.height=this.connectedBlock?this.connectedBlockHeight-this.constants_.TAB_OFFSET_FROM_TOP-this.constants_.MEDIUM_PADDING:this.shape.height,this.width=this.shape.width+this.constants_.EXTERNAL_VALUE_INPUT_PADDING,this.connectionOffsetY=this.constants_.TAB_OFFSET_FROM_TOP,this.connectionHeight=this.shape.height,this.connectionWidth=this.shape.width}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$blockRendering$ExternalValueInput.ExternalValueInput,module$exports$Blockly$blockRendering$InputConnection.InputConnection);var module$exports$Blockly$blockRendering$Field={Field:function(a,b,c){module$exports$Blockly$blockRendering$Field.Field.superClass_.constructor.call(this,a),this.field=b,this.isEditable=b.EDITABLE,this.flipRtl=b.getFlipRtl(),this.type|=module$exports$Blockly$blockRendering$Types.Types.FIELD,a=this.field.getSize(),this.height=a.height,this.width=a.width,this.parentInput=c}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$blockRendering$Field.Field,module$exports$Blockly$blockRendering$Measurable_Measurable);var module$exports$Blockly$blockRendering$Hat={Hat:function(a){module$exports$Blockly$blockRendering$Hat.Hat.superClass_.constructor.call(this,a),this.type|=module$exports$Blockly$blockRendering$Types.Types.HAT,this.height=this.constants_.START_HAT.height,this.width=this.constants_.START_HAT.width,this.ascenderHeight=this.height}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$blockRendering$Hat.Hat,module$exports$Blockly$blockRendering$Measurable_Measurable);var module$exports$Blockly$blockRendering$Icon={Icon:function(a,b){module$exports$Blockly$blockRendering$Icon.Icon.superClass_.constructor.call(this,a),this.icon=b,this.isVisible=b.isVisible(),this.type|=module$exports$Blockly$blockRendering$Types.Types.ICON,a=b.getCorrectedSize(),this.height=a.height,this.width=a.width}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$blockRendering$Icon.Icon,module$exports$Blockly$blockRendering$Measurable_Measurable);var module$exports$Blockly$blockRendering$InRowSpacer={InRowSpacer:function(a,b){module$exports$Blockly$blockRendering$InRowSpacer.InRowSpacer.superClass_.constructor.call(this,a),this.type=this.type|module$exports$Blockly$blockRendering$Types.Types.SPACER|module$exports$Blockly$blockRendering$Types.Types.IN_ROW_SPACER,this.width=b,this.height=this.constants_.SPACER_DEFAULT_HEIGHT}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$blockRendering$InRowSpacer.InRowSpacer,module$exports$Blockly$blockRendering$Measurable_Measurable);var module$exports$Blockly$blockRendering$InlineInput={InlineInput:function(a,b){module$exports$Blockly$blockRendering$InlineInput.InlineInput.superClass_.constructor.call(this,a,b),this.type|=module$exports$Blockly$blockRendering$Types.Types.INLINE_INPUT,this.connectedBlock?(this.width=this.connectedBlockWidth,this.height=this.connectedBlockHeight):(this.height=this.constants_.EMPTY_INLINE_INPUT_HEIGHT,this.width=this.constants_.EMPTY_INLINE_INPUT_PADDING),this.connectionHeight=this.isDynamicShape?this.shape.height(this.height):this.shape.height,this.connectionWidth=this.isDynamicShape?this.shape.width(this.height):this.shape.width,this.connectedBlock||(this.width+=this.connectionWidth*(this.isDynamicShape?2:1)),this.connectionOffsetY=this.isDynamicShape?this.shape.connectionOffsetY(this.connectionHeight):this.constants_.TAB_OFFSET_FROM_TOP,this.connectionOffsetX=this.isDynamicShape?this.shape.connectionOffsetX(this.connectionWidth):0}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$blockRendering$InlineInput.InlineInput,module$exports$Blockly$blockRendering$InputConnection.InputConnection);var module$exports$Blockly$blockRendering$InputRow={InputRow:function(a){module$exports$Blockly$blockRendering$InputRow.InputRow.superClass_.constructor.call(this,a),this.type|=module$exports$Blockly$blockRendering$Types.Types.INPUT_ROW,this.connectedBlockWidths=0}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$blockRendering$InputRow.InputRow,module$exports$Blockly$blockRendering$Row.Row),module$exports$Blockly$blockRendering$InputRow.InputRow.prototype.measure=function(){this.width=this.minWidth,this.height=this.minHeight;for(var a=0,b=0;b<this.elements.length;b++){var c=this.elements[b];this.width+=c.width,module$exports$Blockly$blockRendering$Types.Types.isInput(c)&&(module$exports$Blockly$blockRendering$Types.Types.isStatementInput(c)?a+=c.connectedBlockWidth:module$exports$Blockly$blockRendering$Types.Types.isExternalInput(c)&&0!==c.connectedBlockWidth&&(a+=c.connectedBlockWidth-c.connectionWidth)),module$exports$Blockly$blockRendering$Types.Types.isSpacer(c)||(this.height=Math.max(this.height,c.height))}this.connectedBlockWidths=a,this.widthWithConnectedBlocks=this.width+a},module$exports$Blockly$blockRendering$InputRow.InputRow.prototype.endsWithElemSpacer=function(){return!this.hasExternalInput&&!this.hasStatement};var module$exports$Blockly$blockRendering$JaggedEdge={JaggedEdge:function(a){module$exports$Blockly$blockRendering$JaggedEdge.JaggedEdge.superClass_.constructor.call(this,a),this.type|=module$exports$Blockly$blockRendering$Types.Types.JAGGED_EDGE,this.height=this.constants_.JAGGED_TEETH.height,this.width=this.constants_.JAGGED_TEETH.width}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$blockRendering$JaggedEdge.JaggedEdge,module$exports$Blockly$blockRendering$Measurable_Measurable);var module$exports$Blockly$ASTNode={ASTNode:function(a,b,c){if(!b)throw Error("Cannot create a node without a location.");this.type_=a,this.isConnection_=module$exports$Blockly$ASTNode.ASTNode.isConnectionType_(a),this.location_=b,this.wsCoordinate_=null,this.processParams_(c||null)}};module$exports$Blockly$ASTNode.ASTNode.types={FIELD:"field",BLOCK:"block",INPUT:"input",OUTPUT:"output",NEXT:"next",PREVIOUS:"previous",STACK:"stack",WORKSPACE:"workspace"},module$exports$Blockly$ASTNode.ASTNode.NAVIGATE_ALL_FIELDS=!1,module$exports$Blockly$ASTNode.ASTNode.DEFAULT_OFFSET_Y=-20,module$exports$Blockly$ASTNode.ASTNode.isConnectionType_=function(a){switch(a){case module$exports$Blockly$ASTNode.ASTNode.types.PREVIOUS:case module$exports$Blockly$ASTNode.ASTNode.types.NEXT:case module$exports$Blockly$ASTNode.ASTNode.types.INPUT:case module$exports$Blockly$ASTNode.ASTNode.types.OUTPUT:return!0}return!1},module$exports$Blockly$ASTNode.ASTNode.createFieldNode=function(a){return a?new module$exports$Blockly$ASTNode.ASTNode(module$exports$Blockly$ASTNode.ASTNode.types.FIELD,a):null},module$exports$Blockly$ASTNode.ASTNode.createConnectionNode=function(a){if(!a)return null;var b=a.type;return b===$.module$exports$Blockly$ConnectionType.ConnectionType.INPUT_VALUE||b===$.module$exports$Blockly$ConnectionType.ConnectionType.NEXT_STATEMENT&&a.getParentInput()?module$exports$Blockly$ASTNode.ASTNode.createInputNode(a.getParentInput()):b===$.module$exports$Blockly$ConnectionType.ConnectionType.NEXT_STATEMENT?new module$exports$Blockly$ASTNode.ASTNode(module$exports$Blockly$ASTNode.ASTNode.types.NEXT,a):b===$.module$exports$Blockly$ConnectionType.ConnectionType.OUTPUT_VALUE?new module$exports$Blockly$ASTNode.ASTNode(module$exports$Blockly$ASTNode.ASTNode.types.OUTPUT,a):b===$.module$exports$Blockly$ConnectionType.ConnectionType.PREVIOUS_STATEMENT?new module$exports$Blockly$ASTNode.ASTNode(module$exports$Blockly$ASTNode.ASTNode.types.PREVIOUS,a):null},module$exports$Blockly$ASTNode.ASTNode.createInputNode=function(a){return a&&a.connection?new module$exports$Blockly$ASTNode.ASTNode(module$exports$Blockly$ASTNode.ASTNode.types.INPUT,a.connection):null},module$exports$Blockly$ASTNode.ASTNode.createBlockNode=function(a){return a?new module$exports$Blockly$ASTNode.ASTNode(module$exports$Blockly$ASTNode.ASTNode.types.BLOCK,a):null},module$exports$Blockly$ASTNode.ASTNode.createStackNode=function(a){return a?new module$exports$Blockly$ASTNode.ASTNode(module$exports$Blockly$ASTNode.ASTNode.types.STACK,a):null},module$exports$Blockly$ASTNode.ASTNode.createWorkspaceNode=function(a,b){return b&&a?new module$exports$Blockly$ASTNode.ASTNode(module$exports$Blockly$ASTNode.ASTNode.types.WORKSPACE,a,{wsCoordinate:b}):null};var module$contents$Blockly$ASTNode_getParentConnection=function(a){var b=a.outputConnection;return(!b||a.previousConnection&&a.previousConnection.isConnected())&&(b=a.previousConnection),b};module$exports$Blockly$ASTNode.ASTNode.createTopNode=function(a){var b=module$contents$Blockly$ASTNode_getParentConnection(a);return b?module$exports$Blockly$ASTNode.ASTNode.createConnectionNode(b):module$exports$Blockly$ASTNode.ASTNode.createBlockNode(a)},module$exports$Blockly$ASTNode.ASTNode.prototype.processParams_=function(a){a&&a.wsCoordinate&&(this.wsCoordinate_=a.wsCoordinate)},module$exports$Blockly$ASTNode.ASTNode.prototype.getLocation=function(){return this.location_},module$exports$Blockly$ASTNode.ASTNode.prototype.getType=function(){return this.type_},module$exports$Blockly$ASTNode.ASTNode.prototype.getWsCoordinate=function(){return this.wsCoordinate_},module$exports$Blockly$ASTNode.ASTNode.prototype.isConnection=function(){return this.isConnection_},module$exports$Blockly$ASTNode.ASTNode.prototype.findNextForInput_=function(){var a=this.location_.getParentInput(),b=a.getSourceBlock();for(a=b.inputList.indexOf(a)+1;a<b.inputList.length;a++){for(var c=b.inputList[a],d=c.fieldRow,e=0;e<d.length;e++){var f=d[e];if(f.isClickable()||module$exports$Blockly$ASTNode.ASTNode.NAVIGATE_ALL_FIELDS)return module$exports$Blockly$ASTNode.ASTNode.createFieldNode(f)}if(c.connection)return module$exports$Blockly$ASTNode.ASTNode.createInputNode(c)}return null},module$exports$Blockly$ASTNode.ASTNode.prototype.findNextForField_=function(){var a=this.location_,b=a.getParentInput(),c=a.getSourceBlock(),d=c.inputList.indexOf(b);for(a=b.fieldRow.indexOf(a)+1;d<c.inputList.length;d++){for(var e=(b=c.inputList[d]).fieldRow;a<e.length;){if(e[a].isClickable()||module$exports$Blockly$ASTNode.ASTNode.NAVIGATE_ALL_FIELDS)return module$exports$Blockly$ASTNode.ASTNode.createFieldNode(e[a]);a++}if(a=0,b.connection)return module$exports$Blockly$ASTNode.ASTNode.createInputNode(b)}return null},module$exports$Blockly$ASTNode.ASTNode.prototype.findPrevForInput_=function(){for(var a=this.location_.getParentInput(),b=a.getSourceBlock(),c=b.inputList.indexOf(a);0<=c;c--){var d=b.inputList[c];if(d.connection&&d!==a)return module$exports$Blockly$ASTNode.ASTNode.createInputNode(d);for(var e=(d=d.fieldRow).length-1;0<=e;e--){var f=d[e];if(f.isClickable()||module$exports$Blockly$ASTNode.ASTNode.NAVIGATE_ALL_FIELDS)return module$exports$Blockly$ASTNode.ASTNode.createFieldNode(f)}}return null},module$exports$Blockly$ASTNode.ASTNode.prototype.findPrevForField_=function(){var a=this.location_,b=a.getParentInput(),c=a.getSourceBlock(),d=c.inputList.indexOf(b);for(a=b.fieldRow.indexOf(a)-1;0<=d;d--){var e=c.inputList[d];if(e.connection&&e!==b)return module$exports$Blockly$ASTNode.ASTNode.createInputNode(e);for(e=e.fieldRow;-1<a;){if(e[a].isClickable()||module$exports$Blockly$ASTNode.ASTNode.NAVIGATE_ALL_FIELDS)return module$exports$Blockly$ASTNode.ASTNode.createFieldNode(e[a]);a--}0<=d-1&&(a=c.inputList[d-1].fieldRow.length-1)}return null},module$exports$Blockly$ASTNode.ASTNode.prototype.navigateBetweenStacks_=function(a){var b=this.getLocation();if(b.getSourceBlock&&(b=b.getSourceBlock()),!b||!b.workspace)return null;var c=b.getRootBlock();b=c.workspace.getTopBlocks(!0);for(var d=0;d<b.length;d++)if(c.id===b[d].id)return-1===(a=d+(a?1:-1))||a===b.length?null:module$exports$Blockly$ASTNode.ASTNode.createStackNode(b[a]);throw Error("Couldn't find "+(a?"next":"previous")+" stack?!")},module$exports$Blockly$ASTNode.ASTNode.prototype.findTopASTNodeForBlock_=function(a){var b=module$contents$Blockly$ASTNode_getParentConnection(a);return b?module$exports$Blockly$ASTNode.ASTNode.createConnectionNode(b):module$exports$Blockly$ASTNode.ASTNode.createBlockNode(a)},module$exports$Blockly$ASTNode.ASTNode.prototype.getOutAstNodeForBlock_=function(a){if(!a)return null;a=a.getTopStackBlock();var b=module$contents$Blockly$ASTNode_getParentConnection(a);return b&&b.targetConnection&&b.targetConnection.getParentInput()?module$exports$Blockly$ASTNode.ASTNode.createInputNode(b.targetConnection.getParentInput()):module$exports$Blockly$ASTNode.ASTNode.createStackNode(a)},module$exports$Blockly$ASTNode.ASTNode.prototype.findFirstFieldOrInput_=function(a){a=a.inputList;for(var b=0;b<a.length;b++){for(var c=a[b],d=c.fieldRow,e=0;e<d.length;e++){var f=d[e];if(f.isClickable()||module$exports$Blockly$ASTNode.ASTNode.NAVIGATE_ALL_FIELDS)return module$exports$Blockly$ASTNode.ASTNode.createFieldNode(f)}if(c.connection)return module$exports$Blockly$ASTNode.ASTNode.createInputNode(c)}return null},module$exports$Blockly$ASTNode.ASTNode.prototype.getSourceBlock=function(){return this.getType()===module$exports$Blockly$ASTNode.ASTNode.types.BLOCK||this.getType()===module$exports$Blockly$ASTNode.ASTNode.types.STACK?this.getLocation():this.getType()===module$exports$Blockly$ASTNode.ASTNode.types.WORKSPACE?null:this.getLocation().getSourceBlock()},module$exports$Blockly$ASTNode.ASTNode.prototype.next=function(){switch(this.type_){case module$exports$Blockly$ASTNode.ASTNode.types.STACK:return this.navigateBetweenStacks_(!0);case module$exports$Blockly$ASTNode.ASTNode.types.OUTPUT:return module$exports$Blockly$ASTNode.ASTNode.createBlockNode(this.location_.getSourceBlock());case module$exports$Blockly$ASTNode.ASTNode.types.FIELD:return this.findNextForField_();case module$exports$Blockly$ASTNode.ASTNode.types.INPUT:return this.findNextForInput_();case module$exports$Blockly$ASTNode.ASTNode.types.BLOCK:return module$exports$Blockly$ASTNode.ASTNode.createConnectionNode(this.location_.nextConnection);case module$exports$Blockly$ASTNode.ASTNode.types.PREVIOUS:return module$exports$Blockly$ASTNode.ASTNode.createBlockNode(this.location_.getSourceBlock());case module$exports$Blockly$ASTNode.ASTNode.types.NEXT:return module$exports$Blockly$ASTNode.ASTNode.createConnectionNode(this.location_.targetConnection)}return null},module$exports$Blockly$ASTNode.ASTNode.prototype.in=function(){switch(this.type_){case module$exports$Blockly$ASTNode.ASTNode.types.WORKSPACE:var a=this.location_.getTopBlocks(!0);if(0<a.length)return module$exports$Blockly$ASTNode.ASTNode.createStackNode(a[0]);break;case module$exports$Blockly$ASTNode.ASTNode.types.STACK:return this.findTopASTNodeForBlock_(this.location_);case module$exports$Blockly$ASTNode.ASTNode.types.BLOCK:return this.findFirstFieldOrInput_(this.location_);case module$exports$Blockly$ASTNode.ASTNode.types.INPUT:return module$exports$Blockly$ASTNode.ASTNode.createConnectionNode(this.location_.targetConnection)}return null},module$exports$Blockly$ASTNode.ASTNode.prototype.prev=function(){switch(this.type_){case module$exports$Blockly$ASTNode.ASTNode.types.STACK:return this.navigateBetweenStacks_(!1);case module$exports$Blockly$ASTNode.ASTNode.types.FIELD:return this.findPrevForField_();case module$exports$Blockly$ASTNode.ASTNode.types.INPUT:return this.findPrevForInput_();case module$exports$Blockly$ASTNode.ASTNode.types.BLOCK:var a=module$contents$Blockly$ASTNode_getParentConnection(this.location_);return module$exports$Blockly$ASTNode.ASTNode.createConnectionNode(a);case module$exports$Blockly$ASTNode.ASTNode.types.PREVIOUS:if((a=this.location_.targetConnection)&&!a.getParentInput())return module$exports$Blockly$ASTNode.ASTNode.createConnectionNode(a);break;case module$exports$Blockly$ASTNode.ASTNode.types.NEXT:return module$exports$Blockly$ASTNode.ASTNode.createBlockNode(this.location_.getSourceBlock())}return null},module$exports$Blockly$ASTNode.ASTNode.prototype.out=function(){switch(this.type_){case module$exports$Blockly$ASTNode.ASTNode.types.STACK:var a=this.location_,b=a.getRelativeToSurfaceXY();return b=new module$exports$Blockly$utils$Coordinate.Coordinate(b.x,b.y+module$exports$Blockly$ASTNode.ASTNode.DEFAULT_OFFSET_Y),module$exports$Blockly$ASTNode.ASTNode.createWorkspaceNode(a.workspace,b);case module$exports$Blockly$ASTNode.ASTNode.types.OUTPUT:return(b=(a=this.location_).targetConnection)?module$exports$Blockly$ASTNode.ASTNode.createConnectionNode(b):module$exports$Blockly$ASTNode.ASTNode.createStackNode(a.getSourceBlock());case module$exports$Blockly$ASTNode.ASTNode.types.FIELD:case module$exports$Blockly$ASTNode.ASTNode.types.INPUT:return module$exports$Blockly$ASTNode.ASTNode.createBlockNode(this.location_.getSourceBlock());case module$exports$Blockly$ASTNode.ASTNode.types.BLOCK:return this.getOutAstNodeForBlock_(this.location_);case module$exports$Blockly$ASTNode.ASTNode.types.PREVIOUS:case module$exports$Blockly$ASTNode.ASTNode.types.NEXT:return this.getOutAstNodeForBlock_(this.location_.getSourceBlock())}return null};var module$exports$Blockly$Events$MarkerMove={MarkerMove:function(a,b,c,d){var e=a?a.workspace.id:void 0;d&&d.getType()===module$exports$Blockly$ASTNode.ASTNode.types.WORKSPACE&&(e=d.getLocation().id),module$exports$Blockly$Events$MarkerMove.MarkerMove.superClass_.constructor.call(this,e),this.blockId=a?a.id:null,this.oldNode=c,this.newNode=d,this.isCursor=b}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$Events$MarkerMove.MarkerMove,module$exports$Blockly$Events$UiBase.UiBase),module$exports$Blockly$Events$MarkerMove.MarkerMove.prototype.type=module$exports$Blockly$Events$utils.MARKER_MOVE,module$exports$Blockly$Events$MarkerMove.MarkerMove.prototype.toJson=function(){var a=module$exports$Blockly$Events$MarkerMove.MarkerMove.superClass_.toJson.call(this);return a.isCursor=this.isCursor,a.blockId=this.blockId,a.oldNode=this.oldNode,a.newNode=this.newNode,a},module$exports$Blockly$Events$MarkerMove.MarkerMove.prototype.fromJson=function(a){module$exports$Blockly$Events$MarkerMove.MarkerMove.superClass_.fromJson.call(this,a),this.isCursor=a.isCursor,this.blockId=a.blockId,this.oldNode=a.oldNode,this.newNode=a.newNode},(0,module$exports$Blockly$registry.register)(module$exports$Blockly$registry.Type.EVENT,module$exports$Blockly$Events$utils.MARKER_MOVE,module$exports$Blockly$Events$MarkerMove.MarkerMove);var module$exports$Blockly$blockRendering$MarkerSvg={MarkerSvg:function(a,b,c){this.workspace_=a,this.marker_=c,this.parent_=null,this.constants_=b,this.currentMarkerSvg=null,a=this.isCursor()?this.constants_.CURSOR_COLOUR:this.constants_.MARKER_COLOUR,this.colour_=c.colour||a}};module$exports$Blockly$blockRendering$MarkerSvg.MarkerSvg.prototype.getSvgRoot=function(){return this.svgGroup_},module$exports$Blockly$blockRendering$MarkerSvg.MarkerSvg.prototype.getMarker=function(){return this.marker_},module$exports$Blockly$blockRendering$MarkerSvg.MarkerSvg.prototype.isCursor=function(){return"cursor"===this.marker_.type},module$exports$Blockly$blockRendering$MarkerSvg.MarkerSvg.prototype.createDom=function(){var a=this.isCursor()?"blocklyCursor":"blocklyMarker";return this.svgGroup_=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.G,{class:a},null),this.createDomInternal_(),this.svgGroup_},module$exports$Blockly$blockRendering$MarkerSvg.MarkerSvg.prototype.setParent_=function(a){this.isCursor()?(this.parent_&&this.parent_.setCursorSvg(null),a.setCursorSvg(this.getSvgRoot())):(this.parent_&&this.parent_.setMarkerSvg(null),a.setMarkerSvg(this.getSvgRoot())),this.parent_=a},module$exports$Blockly$blockRendering$MarkerSvg.MarkerSvg.prototype.draw=function(a,b){if(b){this.constants_=this.workspace_.getRenderer().getConstants();var c=this.isCursor()?this.constants_.CURSOR_COLOUR:this.constants_.MARKER_COLOUR;this.colour_=this.marker_.colour||c,this.applyColour_(b),this.showAtLocation_(b),this.fireMarkerEvent_(a,b),void 0!==(a=this.currentMarkerSvg.childNodes[0])&&a.beginElement&&a.beginElement()}else this.hide()},module$exports$Blockly$blockRendering$MarkerSvg.MarkerSvg.prototype.showAtLocation_=function(a){var b=a.getLocation().type;a.getType()===module$exports$Blockly$ASTNode.ASTNode.types.BLOCK?this.showWithBlock_(a):a.getType()===module$exports$Blockly$ASTNode.ASTNode.types.OUTPUT?this.showWithOutput_(a):b===$.module$exports$Blockly$ConnectionType.ConnectionType.INPUT_VALUE?this.showWithInput_(a):b===$.module$exports$Blockly$ConnectionType.ConnectionType.NEXT_STATEMENT?this.showWithNext_(a):a.getType()===module$exports$Blockly$ASTNode.ASTNode.types.PREVIOUS?this.showWithPrevious_(a):a.getType()===module$exports$Blockly$ASTNode.ASTNode.types.FIELD?this.showWithField_(a):a.getType()===module$exports$Blockly$ASTNode.ASTNode.types.WORKSPACE?this.showWithCoordinates_(a):a.getType()===module$exports$Blockly$ASTNode.ASTNode.types.STACK&&this.showWithStack_(a)},module$exports$Blockly$blockRendering$MarkerSvg.MarkerSvg.prototype.showWithBlockPrevOutput_=function(a){var b=(a=a.getSourceBlock()).width,c=a.height,d=.75*c,e=this.constants_.CURSOR_BLOCK_PADDING;a.previousConnection?(c=this.constants_.shapeFor(a.previousConnection),this.positionPrevious_(b,e,d,c)):a.outputConnection?(d=this.constants_.shapeFor(a.outputConnection),this.positionOutput_(b,c,d)):this.positionBlock_(b,e,d),this.setParent_(a),this.showCurrent_()},module$exports$Blockly$blockRendering$MarkerSvg.MarkerSvg.prototype.showWithBlock_=function(a){this.showWithBlockPrevOutput_(a)},module$exports$Blockly$blockRendering$MarkerSvg.MarkerSvg.prototype.showWithPrevious_=function(a){this.showWithBlockPrevOutput_(a)},module$exports$Blockly$blockRendering$MarkerSvg.MarkerSvg.prototype.showWithOutput_=function(a){this.showWithBlockPrevOutput_(a)},module$exports$Blockly$blockRendering$MarkerSvg.MarkerSvg.prototype.showWithCoordinates_=function(a){var b=a.getWsCoordinate();a=b.x,b=b.y,this.workspace_.RTL&&(a-=this.constants_.CURSOR_WS_WIDTH),this.positionLine_(a,b,this.constants_.CURSOR_WS_WIDTH),this.setParent_(this.workspace_),this.showCurrent_()},module$exports$Blockly$blockRendering$MarkerSvg.MarkerSvg.prototype.showWithField_=function(a){var b=(a=a.getLocation()).getSize().width,c=a.getSize().height;this.positionRect_(0,0,b,c),this.setParent_(a),this.showCurrent_()},module$exports$Blockly$blockRendering$MarkerSvg.MarkerSvg.prototype.showWithInput_=function(a){var b=(a=a.getLocation()).getSourceBlock();this.positionInput_(a),this.setParent_(b),this.showCurrent_()},module$exports$Blockly$blockRendering$MarkerSvg.MarkerSvg.prototype.showWithNext_=function(a){var b=a.getLocation();a=b.getSourceBlock();var c=0;b=b.getOffsetInBlock().y;var d=a.getHeightWidth().width;this.workspace_.RTL&&(c=-d),this.positionLine_(c,b,d),this.setParent_(a),this.showCurrent_()},module$exports$Blockly$blockRendering$MarkerSvg.MarkerSvg.prototype.showWithStack_=function(a){var b=(a=a.getLocation()).getHeightWidth(),c=b.width+this.constants_.CURSOR_STACK_PADDING;b=b.height+this.constants_.CURSOR_STACK_PADDING;var d=-this.constants_.CURSOR_STACK_PADDING/2,e=-this.constants_.CURSOR_STACK_PADDING/2,f=d;this.workspace_.RTL&&(f=-(c+d)),this.positionRect_(f,e,c,b),this.setParent_(a),this.showCurrent_()},module$exports$Blockly$blockRendering$MarkerSvg.MarkerSvg.prototype.showCurrent_=function(){this.hide(),this.currentMarkerSvg.style.display=""},module$exports$Blockly$blockRendering$MarkerSvg.MarkerSvg.prototype.positionBlock_=function(a,b,c){a=(0,module$exports$Blockly$utils$svgPaths.moveBy)(-b,c)+(0,module$exports$Blockly$utils$svgPaths.lineOnAxis)("V",-b)+(0,module$exports$Blockly$utils$svgPaths.lineOnAxis)("H",a+2*b)+(0,module$exports$Blockly$utils$svgPaths.lineOnAxis)("V",c),this.markerBlock_.setAttribute("d",a),this.workspace_.RTL&&this.flipRtl_(this.markerBlock_),this.currentMarkerSvg=this.markerBlock_},module$exports$Blockly$blockRendering$MarkerSvg.MarkerSvg.prototype.positionInput_=function(a){var b=a.getOffsetInBlock().x,c=a.getOffsetInBlock().y;a=(0,module$exports$Blockly$utils$svgPaths.moveTo)(0,0)+this.constants_.shapeFor(a).pathDown,this.markerInput_.setAttribute("d",a),this.markerInput_.setAttribute("transform","translate("+b+","+c+")"+(this.workspace_.RTL?" scale(-1 1)":"")),this.currentMarkerSvg=this.markerInput_},module$exports$Blockly$blockRendering$MarkerSvg.MarkerSvg.prototype.positionLine_=function(a,b,c){this.markerSvgLine_.setAttribute("x",a),this.markerSvgLine_.setAttribute("y",b),this.markerSvgLine_.setAttribute("width",c),this.currentMarkerSvg=this.markerSvgLine_},module$exports$Blockly$blockRendering$MarkerSvg.MarkerSvg.prototype.positionOutput_=function(a,b,c){a=(0,module$exports$Blockly$utils$svgPaths.moveBy)(a,0)+(0,module$exports$Blockly$utils$svgPaths.lineOnAxis)("h",-(a-c.width))+(0,module$exports$Blockly$utils$svgPaths.lineOnAxis)("v",this.constants_.TAB_OFFSET_FROM_TOP)+c.pathDown+(0,module$exports$Blockly$utils$svgPaths.lineOnAxis)("V",b)+(0,module$exports$Blockly$utils$svgPaths.lineOnAxis)("H",a),this.markerBlock_.setAttribute("d",a),this.workspace_.RTL&&this.flipRtl_(this.markerBlock_),this.currentMarkerSvg=this.markerBlock_},module$exports$Blockly$blockRendering$MarkerSvg.MarkerSvg.prototype.positionPrevious_=function(a,b,c,d){a=(0,module$exports$Blockly$utils$svgPaths.moveBy)(-b,c)+(0,module$exports$Blockly$utils$svgPaths.lineOnAxis)("V",-b)+(0,module$exports$Blockly$utils$svgPaths.lineOnAxis)("H",this.constants_.NOTCH_OFFSET_LEFT)+d.pathLeft+(0,module$exports$Blockly$utils$svgPaths.lineOnAxis)("H",a+2*b)+(0,module$exports$Blockly$utils$svgPaths.lineOnAxis)("V",c),this.markerBlock_.setAttribute("d",a),this.workspace_.RTL&&this.flipRtl_(this.markerBlock_),this.currentMarkerSvg=this.markerBlock_},module$exports$Blockly$blockRendering$MarkerSvg.MarkerSvg.prototype.positionRect_=function(a,b,c,d){this.markerSvgRect_.setAttribute("x",a),this.markerSvgRect_.setAttribute("y",b),this.markerSvgRect_.setAttribute("width",c),this.markerSvgRect_.setAttribute("height",d),this.currentMarkerSvg=this.markerSvgRect_},module$exports$Blockly$blockRendering$MarkerSvg.MarkerSvg.prototype.flipRtl_=function(a){a.setAttribute("transform","scale(-1 1)")},module$exports$Blockly$blockRendering$MarkerSvg.MarkerSvg.prototype.hide=function(){this.markerSvgLine_.style.display="none",this.markerSvgRect_.style.display="none",this.markerInput_.style.display="none",this.markerBlock_.style.display="none"},module$exports$Blockly$blockRendering$MarkerSvg.MarkerSvg.prototype.fireMarkerEvent_=function(a,b){var c=b.getSourceBlock();a=new((0,module$exports$Blockly$Events$utils.get)(module$exports$Blockly$Events$utils.MARKER_MOVE))(c,this.isCursor(),a,b),(0,module$exports$Blockly$Events$utils.fire)(a)},module$exports$Blockly$blockRendering$MarkerSvg.MarkerSvg.prototype.getBlinkProperties_=function(){return{attributeType:"XML",attributeName:"fill",dur:"1s",values:this.colour_+";transparent;transparent;",repeatCount:"indefinite"}},module$exports$Blockly$blockRendering$MarkerSvg.MarkerSvg.prototype.createDomInternal_=function(){if(this.markerSvg_=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.G,{width:this.constants_.CURSOR_WS_WIDTH,height:this.constants_.WS_CURSOR_HEIGHT},this.svgGroup_),this.markerSvgLine_=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.RECT,{width:this.constants_.CURSOR_WS_WIDTH,height:this.constants_.WS_CURSOR_HEIGHT,style:"display: none"},this.markerSvg_),this.markerSvgRect_=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.RECT,{class:"blocklyVerticalMarker",rx:10,ry:10,style:"display: none"},this.markerSvg_),this.markerInput_=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.PATH,{transform:"",style:"display: none"},this.markerSvg_),this.markerBlock_=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.PATH,{transform:"",style:"display: none",fill:"none","stroke-width":this.constants_.CURSOR_STROKE_WIDTH},this.markerSvg_),this.isCursor()){var a=this.getBlinkProperties_();(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.ANIMATE,a,this.markerSvgLine_),(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.ANIMATE,a,this.markerInput_),a.attributeName="stroke",(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.ANIMATE,a,this.markerBlock_)}return this.markerSvg_},module$exports$Blockly$blockRendering$MarkerSvg.MarkerSvg.prototype.applyColour_=function(a){this.markerSvgLine_.setAttribute("fill",this.colour_),this.markerSvgRect_.setAttribute("stroke",this.colour_),this.markerInput_.setAttribute("fill",this.colour_),this.markerBlock_.setAttribute("stroke",this.colour_),this.isCursor()&&(a=this.colour_+";transparent;transparent;",this.markerSvgLine_.firstChild.setAttribute("values",a),this.markerInput_.firstChild.setAttribute("values",a),this.markerBlock_.firstChild.setAttribute("values",a))},module$exports$Blockly$blockRendering$MarkerSvg.MarkerSvg.prototype.dispose=function(){this.svgGroup_&&(0,module$exports$Blockly$utils$dom.removeNode)(this.svgGroup_)};var module$exports$Blockly$blockRendering$NextConnection={NextConnection:function(a,b){module$exports$Blockly$blockRendering$NextConnection.NextConnection.superClass_.constructor.call(this,a,b),this.type|=module$exports$Blockly$blockRendering$Types.Types.NEXT_CONNECTION,this.height=this.shape.height,this.width=this.shape.width}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$blockRendering$NextConnection.NextConnection,module$exports$Blockly$blockRendering$Connection.Connection);var module$exports$Blockly$blockRendering$OutputConnection={OutputConnection:function(a,b){module$exports$Blockly$blockRendering$OutputConnection.OutputConnection.superClass_.constructor.call(this,a,b),this.type|=module$exports$Blockly$blockRendering$Types.Types.OUTPUT_CONNECTION,this.height=this.isDynamicShape?0:this.shape.height,this.startX=this.width=this.isDynamicShape?0:this.shape.width,this.connectionOffsetY=this.constants_.TAB_OFFSET_FROM_TOP,this.connectionOffsetX=0}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$blockRendering$OutputConnection.OutputConnection,module$exports$Blockly$blockRendering$Connection.Connection);var module$exports$Blockly$blockRendering$PathObject={PathObject:function(a,b,c){this.constants=c,this.svgRoot=a,this.svgPath=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.PATH,{class:"blocklyPath"},this.svgRoot),this.style=b,this.markerSvg=this.cursorSvg=null}};module$exports$Blockly$blockRendering$PathObject.PathObject.prototype.setPath=function(a){this.svgPath.setAttribute("d",a)},module$exports$Blockly$blockRendering$PathObject.PathObject.prototype.flipRTL=function(){this.svgPath.setAttribute("transform","scale(-1 1)")},module$exports$Blockly$blockRendering$PathObject.PathObject.prototype.setCursorSvg=function(a){a?(this.svgRoot.appendChild(a),this.cursorSvg=a):this.cursorSvg=null},module$exports$Blockly$blockRendering$PathObject.PathObject.prototype.setMarkerSvg=function(a){a?(this.cursorSvg?this.svgRoot.insertBefore(a,this.cursorSvg):this.svgRoot.appendChild(a),this.markerSvg=a):this.markerSvg=null},module$exports$Blockly$blockRendering$PathObject.PathObject.prototype.applyColour=function(a){this.svgPath.setAttribute("stroke",this.style.colourTertiary),this.svgPath.setAttribute("fill",this.style.colourPrimary),this.updateShadow_(a.isShadow()),this.updateDisabled_(!a.isEnabled()||a.getInheritedDisabled())},module$exports$Blockly$blockRendering$PathObject.PathObject.prototype.setStyle=function(a){this.style=a},module$exports$Blockly$blockRendering$PathObject.PathObject.prototype.setClass_=function(a,b){b?(0,module$exports$Blockly$utils$dom.addClass)(this.svgRoot,a):(0,module$exports$Blockly$utils$dom.removeClass)(this.svgRoot,a)},module$exports$Blockly$blockRendering$PathObject.PathObject.prototype.updateHighlighted=function(a){a?this.svgPath.setAttribute("filter","url(#"+this.constants.embossFilterId+")"):this.svgPath.setAttribute("filter","none")},module$exports$Blockly$blockRendering$PathObject.PathObject.prototype.updateShadow_=function(a){a&&(this.svgPath.setAttribute("stroke","none"),this.svgPath.setAttribute("fill",this.style.colourSecondary))},module$exports$Blockly$blockRendering$PathObject.PathObject.prototype.updateDisabled_=function(a){this.setClass_("blocklyDisabled",a),a&&this.svgPath.setAttribute("fill","url(#"+this.constants.disabledPatternId+")")},module$exports$Blockly$blockRendering$PathObject.PathObject.prototype.updateSelected=function(a){this.setClass_("blocklySelected",a)},module$exports$Blockly$blockRendering$PathObject.PathObject.prototype.updateDraggingDelete=function(a){this.setClass_("blocklyDraggingDelete",a)},module$exports$Blockly$blockRendering$PathObject.PathObject.prototype.updateInsertionMarker=function(a){this.setClass_("blocklyInsertionMarker",a)},module$exports$Blockly$blockRendering$PathObject.PathObject.prototype.updateMovable=function(a){this.setClass_("blocklyDraggable",a)},module$exports$Blockly$blockRendering$PathObject.PathObject.prototype.updateReplacementFade=function(a){this.setClass_("blocklyReplaceable",a)},module$exports$Blockly$blockRendering$PathObject.PathObject.prototype.updateShapeForInputHighlight=function(a,b){};var module$exports$Blockly$blockRendering$PreviousConnection={PreviousConnection:function(a,b){module$exports$Blockly$blockRendering$PreviousConnection.PreviousConnection.superClass_.constructor.call(this,a,b),this.type|=module$exports$Blockly$blockRendering$Types.Types.PREVIOUS_CONNECTION,this.height=this.shape.height,this.width=this.shape.width}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$blockRendering$PreviousConnection.PreviousConnection,module$exports$Blockly$blockRendering$Connection.Connection),$.module$exports$Blockly$Input={Align:{LEFT:-1,CENTRE:0,RIGHT:1},Input:function(a,b,c,d){if(a!==$.module$exports$Blockly$inputTypes.inputTypes.DUMMY&&!b)throw Error("Value inputs and statement inputs must have non-empty name.");this.type=a,this.name=b,this.sourceBlock_=c,this.connection=d,this.fieldRow=[]}},$.module$exports$Blockly$Input.Input.prototype.align=$.module$exports$Blockly$Input.Align.LEFT,$.module$exports$Blockly$Input.Input.prototype.visible_=!0,$.module$exports$Blockly$Input.Input.prototype.getSourceBlock=function(){return this.sourceBlock_},$.module$exports$Blockly$Input.Input.prototype.appendField=function(a,b){return this.insertFieldAt(this.fieldRow.length,a,b),this},$.module$exports$Blockly$Input.Input.prototype.insertFieldAt=function(a,b,c){if(0>a||a>this.fieldRow.length)throw Error("index "+a+" out of bounds.");return b||""===b&&c?("string"==typeof b&&(b=(0,module$exports$Blockly$fieldRegistry.fromJson)({type:"field_label",text:b})),b.setSourceBlock(this.sourceBlock_),this.sourceBlock_.rendered&&(b.init(),b.applyColour()),b.name=c,b.setVisible(this.isVisible()),b.prefixField&&(a=this.insertFieldAt(a,b.prefixField)),this.fieldRow.splice(a,0,b),a++,b.suffixField&&(a=this.insertFieldAt(a,b.suffixField)),this.sourceBlock_.rendered&&(this.sourceBlock_=this.sourceBlock_,this.sourceBlock_.render(),this.sourceBlock_.bumpNeighbours()),a):a},$.module$exports$Blockly$Input.Input.prototype.removeField=function(a,b){for(var d,c=0;d=this.fieldRow[c];c++)if(d.name===a)return d.dispose(),this.fieldRow.splice(c,1),this.sourceBlock_.rendered&&(this.sourceBlock_=this.sourceBlock_,this.sourceBlock_.render(),this.sourceBlock_.bumpNeighbours()),!0;if(b)return!1;throw Error('Field "'+a+'" not found.')},$.module$exports$Blockly$Input.Input.prototype.isVisible=function(){return this.visible_},$.module$exports$Blockly$Input.Input.prototype.setVisible=function(a){var b=[];if(this.visible_===a)return b;this.visible_=a;for(var d,c=0;d=this.fieldRow[c];c++)d.setVisible(a);return this.connection&&(this.connection=this.connection,a?b=this.connection.startTrackingAll():this.connection.stopTrackingAll(),c=this.connection.targetBlock())&&(c.getSvgRoot().style.display=a?"block":"none"),b},$.module$exports$Blockly$Input.Input.prototype.markDirty=function(){for(var b,a=0;b=this.fieldRow[a];a++)b.markDirty()},$.module$exports$Blockly$Input.Input.prototype.setCheck=function(a){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.setCheck(a),this},$.module$exports$Blockly$Input.Input.prototype.setAlign=function(a){return this.align=a,this.sourceBlock_.rendered&&(this.sourceBlock_=this.sourceBlock_,this.sourceBlock_.render()),this},$.module$exports$Blockly$Input.Input.prototype.setShadowDom=function(a){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.setShadowDom(a),this},$.module$exports$Blockly$Input.Input.prototype.getShadowDom=function(){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.getShadowDom()},$.module$exports$Blockly$Input.Input.prototype.init=function(){if(this.sourceBlock_.workspace.rendered)for(var a=0;a<this.fieldRow.length;a++)this.fieldRow[a].init()},$.module$exports$Blockly$Input.Input.prototype.dispose=function(){for(var b,a=0;b=this.fieldRow[a];a++)b.dispose();this.connection&&this.connection.dispose(),this.sourceBlock_=null};var module$exports$Blockly$blockRendering$RoundCorner={RoundCorner:function(a,b){module$exports$Blockly$blockRendering$RoundCorner.RoundCorner.superClass_.constructor.call(this,a),this.type=(b&&"left"!==b?module$exports$Blockly$blockRendering$Types.Types.RIGHT_ROUND_CORNER:module$exports$Blockly$blockRendering$Types.Types.LEFT_ROUND_CORNER)|module$exports$Blockly$blockRendering$Types.Types.CORNER,this.width=this.constants_.CORNER_RADIUS,this.height=this.constants_.CORNER_RADIUS/2}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$blockRendering$RoundCorner.RoundCorner,module$exports$Blockly$blockRendering$Measurable_Measurable);var module$exports$Blockly$blockRendering$SpacerRow={SpacerRow:function(a,b,c){module$exports$Blockly$blockRendering$SpacerRow.SpacerRow.superClass_.constructor.call(this,a),this.type=this.type|module$exports$Blockly$blockRendering$Types.Types.SPACER|module$exports$Blockly$blockRendering$Types.Types.BETWEEN_ROW_SPACER,this.width=c,this.height=b,this.followsStatement=!1,this.widthWithConnectedBlocks=0,this.elements=[new module$exports$Blockly$blockRendering$InRowSpacer.InRowSpacer(this.constants_,c)]}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$blockRendering$SpacerRow.SpacerRow,module$exports$Blockly$blockRendering$Row.Row),module$exports$Blockly$blockRendering$SpacerRow.SpacerRow.prototype.measure=function(){};var module$exports$Blockly$blockRendering$SquareCorner={SquareCorner:function(a,b){module$exports$Blockly$blockRendering$SquareCorner.SquareCorner.superClass_.constructor.call(this,a),this.type=(b&&"left"!==b?module$exports$Blockly$blockRendering$Types.Types.RIGHT_SQUARE_CORNER:module$exports$Blockly$blockRendering$Types.Types.LEFT_SQUARE_CORNER)|module$exports$Blockly$blockRendering$Types.Types.CORNER,this.width=this.height=this.constants_.NO_PADDING}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$blockRendering$SquareCorner.SquareCorner,module$exports$Blockly$blockRendering$Measurable_Measurable);var module$exports$Blockly$blockRendering$StatementInput={StatementInput:function(a,b){module$exports$Blockly$blockRendering$StatementInput.StatementInput.superClass_.constructor.call(this,a,b),this.type|=module$exports$Blockly$blockRendering$Types.Types.STATEMENT_INPUT,this.height=this.connectedBlock?this.connectedBlockHeight+this.constants_.STATEMENT_BOTTOM_SPACER:this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT,this.width=this.constants_.STATEMENT_INPUT_NOTCH_OFFSET+this.shape.width}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$blockRendering$StatementInput.StatementInput,module$exports$Blockly$blockRendering$InputConnection.InputConnection);var module$exports$Blockly$blockRendering$TopRow={TopRow:function(a){module$exports$Blockly$blockRendering$TopRow.TopRow.superClass_.constructor.call(this,a),this.type|=module$exports$Blockly$blockRendering$Types.Types.TOP_ROW,this.ascenderHeight=this.capline=0,this.hasPreviousConnection=!1,this.connection=null}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$blockRendering$TopRow.TopRow,module$exports$Blockly$blockRendering$Row.Row),module$exports$Blockly$blockRendering$TopRow.TopRow.prototype.hasLeftSquareCorner=function(a){var b=(a.hat?"cap"===a.hat:this.constants_.ADD_START_HATS)&&!a.outputConnection&&!a.previousConnection,c=a.getPreviousBlock();return!!a.outputConnection||b||!!c&&c.getNextBlock()===a},module$exports$Blockly$blockRendering$TopRow.TopRow.prototype.hasRightSquareCorner=function(a){return!0},module$exports$Blockly$blockRendering$TopRow.TopRow.prototype.measure=function(){for(var a=0,b=0,c=0,d=0;d<this.elements.length;d++){var e=this.elements[d];b+=e.width,module$exports$Blockly$blockRendering$Types.Types.isSpacer(e)||(module$exports$Blockly$blockRendering$Types.Types.isHat(e)?c=Math.max(c,e.ascenderHeight):a=Math.max(a,e.height))}this.width=Math.max(this.minWidth,b),this.height=Math.max(this.minHeight,a)+c,this.capline=this.ascenderHeight=c,this.widthWithConnectedBlocks=this.width},module$exports$Blockly$blockRendering$TopRow.TopRow.prototype.startsWithElemSpacer=function(){return!1},module$exports$Blockly$blockRendering$TopRow.TopRow.prototype.endsWithElemSpacer=function(){return!1};var module$exports$Blockly$blockRendering$RenderInfo={RenderInfo:function(a,b){this.block_=b,this.renderer_=a,this.constants_=this.renderer_.getConstants(),this.outputConnection=b.outputConnection?new module$exports$Blockly$blockRendering$OutputConnection.OutputConnection(this.constants_,b.outputConnection):null,this.isInline=b.getInputsInline()&&!b.isCollapsed(),this.isCollapsed=b.isCollapsed(),this.isInsertionMarker=b.isInsertionMarker(),this.RTL=b.RTL,this.statementEdge=this.width=this.widthWithChildren=this.height=0,this.rows=[],this.inputRows=[],this.hiddenIcons=[],this.topRow=new module$exports$Blockly$blockRendering$TopRow.TopRow(this.constants_),this.bottomRow=new module$exports$Blockly$blockRendering$BottomRow.BottomRow(this.constants_),this.startY=this.startX=0}};module$exports$Blockly$blockRendering$RenderInfo.RenderInfo.prototype.getRenderer=function(){return this.renderer_},module$exports$Blockly$blockRendering$RenderInfo.RenderInfo.prototype.measure=function(){this.createRows_(),this.addElemSpacing_(),this.addRowSpacing_(),this.computeBounds_(),this.alignRowElements_(),this.finalize_()},module$exports$Blockly$blockRendering$RenderInfo.RenderInfo.prototype.createRows_=function(){this.populateTopRow_(),this.rows.push(this.topRow);var a=new module$exports$Blockly$blockRendering$InputRow.InputRow(this.constants_);this.inputRows.push(a);for(var d,b=this.block_.getIcons(),c=0;d=b[c];c++){var e=new module$exports$Blockly$blockRendering$Icon.Icon(this.constants_,d);this.isCollapsed&&d.collapseHidden?this.hiddenIcons.push(e):a.elements.push(e)}for(d=null,b=0;c=this.block_.inputList[b];b++)if(c.isVisible()){for(this.shouldStartNewRow_(c,d)&&(this.rows.push(a),a=new module$exports$Blockly$blockRendering$InputRow.InputRow(this.constants_),this.inputRows.push(a)),d=0;e=c.fieldRow[d];d++)a.elements.push(new module$exports$Blockly$blockRendering$Field.Field(this.constants_,e,c));this.addInput_(c,a),d=c}this.isCollapsed&&(a.hasJaggedEdge=!0,a.elements.push(new module$exports$Blockly$blockRendering$JaggedEdge.JaggedEdge(this.constants_))),(a.elements.length||a.hasDummyInput)&&this.rows.push(a),this.populateBottomRow_(),this.rows.push(this.bottomRow)},module$exports$Blockly$blockRendering$RenderInfo.RenderInfo.prototype.populateTopRow_=function(){var a=!!this.block_.previousConnection,b=(this.block_.hat?"cap"===this.block_.hat:this.constants_.ADD_START_HATS)&&!this.outputConnection&&!a,c=this.topRow.hasLeftSquareCorner(this.block_)?module$exports$Blockly$blockRendering$SquareCorner.SquareCorner:module$exports$Blockly$blockRendering$RoundCorner.RoundCorner;this.topRow.elements.push(new c(this.constants_)),b?(a=new module$exports$Blockly$blockRendering$Hat.Hat(this.constants_),this.topRow.elements.push(a),this.topRow.capline=a.ascenderHeight):a&&(this.topRow.hasPreviousConnection=!0,this.topRow.connection=new module$exports$Blockly$blockRendering$PreviousConnection.PreviousConnection(this.constants_,this.block_.previousConnection),this.topRow.elements.push(this.topRow.connection)),this.block_.inputList.length&&this.block_.inputList[0].type===$.module$exports$Blockly$inputTypes.inputTypes.STATEMENT&&!this.block_.isCollapsed()?this.topRow.minHeight=this.constants_.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT:this.topRow.minHeight=this.constants_.TOP_ROW_MIN_HEIGHT,c=this.topRow.hasRightSquareCorner(this.block_)?module$exports$Blockly$blockRendering$SquareCorner.SquareCorner:module$exports$Blockly$blockRendering$RoundCorner.RoundCorner,this.topRow.elements.push(new c(this.constants_,"right"))},module$exports$Blockly$blockRendering$RenderInfo.RenderInfo.prototype.populateBottomRow_=function(){this.bottomRow.hasNextConnection=!!this.block_.nextConnection,this.bottomRow.minHeight=this.block_.inputList.length&&this.block_.inputList[this.block_.inputList.length-1].type===$.module$exports$Blockly$inputTypes.inputTypes.STATEMENT?this.constants_.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT:this.constants_.BOTTOM_ROW_MIN_HEIGHT,this.bottomRow.hasLeftSquareCorner(this.block_)?this.bottomRow.elements.push(new module$exports$Blockly$blockRendering$SquareCorner.SquareCorner(this.constants_)):this.bottomRow.elements.push(new module$exports$Blockly$blockRendering$RoundCorner.RoundCorner(this.constants_)),this.bottomRow.hasNextConnection&&(this.bottomRow.connection=new module$exports$Blockly$blockRendering$NextConnection.NextConnection(this.constants_,this.block_.nextConnection),this.bottomRow.elements.push(this.bottomRow.connection)),this.bottomRow.hasRightSquareCorner(this.block_)?this.bottomRow.elements.push(new module$exports$Blockly$blockRendering$SquareCorner.SquareCorner(this.constants_,"right")):this.bottomRow.elements.push(new module$exports$Blockly$blockRendering$RoundCorner.RoundCorner(this.constants_,"right"))},module$exports$Blockly$blockRendering$RenderInfo.RenderInfo.prototype.addInput_=function(a,b){this.isInline&&a.type===$.module$exports$Blockly$inputTypes.inputTypes.VALUE?(b.elements.push(new module$exports$Blockly$blockRendering$InlineInput.InlineInput(this.constants_,a)),b.hasInlineInput=!0):a.type===$.module$exports$Blockly$inputTypes.inputTypes.STATEMENT?(b.elements.push(new module$exports$Blockly$blockRendering$StatementInput.StatementInput(this.constants_,a)),b.hasStatement=!0):a.type===$.module$exports$Blockly$inputTypes.inputTypes.VALUE?(b.elements.push(new module$exports$Blockly$blockRendering$ExternalValueInput.ExternalValueInput(this.constants_,a)),b.hasExternalInput=!0):a.type===$.module$exports$Blockly$inputTypes.inputTypes.DUMMY&&(b.minHeight=Math.max(b.minHeight,a.getSourceBlock()&&a.getSourceBlock().isShadow()?this.constants_.DUMMY_INPUT_SHADOW_MIN_HEIGHT:this.constants_.DUMMY_INPUT_MIN_HEIGHT),b.hasDummyInput=!0),null===b.align&&(b.align=a.align)},module$exports$Blockly$blockRendering$RenderInfo.RenderInfo.prototype.shouldStartNewRow_=function(a,b){return!(!b||a.type!==$.module$exports$Blockly$inputTypes.inputTypes.STATEMENT&&b.type!==$.module$exports$Blockly$inputTypes.inputTypes.STATEMENT&&(a.type!==$.module$exports$Blockly$inputTypes.inputTypes.VALUE&&a.type!==$.module$exports$Blockly$inputTypes.inputTypes.DUMMY||this.isInline))},module$exports$Blockly$blockRendering$RenderInfo.RenderInfo.prototype.addElemSpacing_=function(){for(var b,a=0;b=this.rows[a];a++){var c=b.elements;if(b.elements=[],b.startsWithElemSpacer()&&b.elements.push(new module$exports$Blockly$blockRendering$InRowSpacer.InRowSpacer(this.constants_,this.getInRowSpacing_(null,c[0]))),c.length){for(var d=0;d<c.length-1;d++){b.elements.push(c[d]);var e=this.getInRowSpacing_(c[d],c[d+1]);b.elements.push(new module$exports$Blockly$blockRendering$InRowSpacer.InRowSpacer(this.constants_,e))}b.elements.push(c[c.length-1]),b.endsWithElemSpacer()&&b.elements.push(new module$exports$Blockly$blockRendering$InRowSpacer.InRowSpacer(this.constants_,this.getInRowSpacing_(c[c.length-1],null)))}}},module$exports$Blockly$blockRendering$RenderInfo.RenderInfo.prototype.getInRowSpacing_=function(a,b){if(!a&&b&&module$exports$Blockly$blockRendering$Types.Types.isStatementInput(b))return this.constants_.STATEMENT_INPUT_PADDING_LEFT;if(a&&module$exports$Blockly$blockRendering$Types.Types.isInput(a)&&!b){if(module$exports$Blockly$blockRendering$Types.Types.isExternalInput(a))return this.constants_.NO_PADDING;if(module$exports$Blockly$blockRendering$Types.Types.isInlineInput(a))return this.constants_.LARGE_PADDING;if(module$exports$Blockly$blockRendering$Types.Types.isStatementInput(a))return this.constants_.NO_PADDING}return a&&module$exports$Blockly$blockRendering$Types.Types.isLeftSquareCorner(a)&&b&&(module$exports$Blockly$blockRendering$Types.Types.isPreviousConnection(b)||module$exports$Blockly$blockRendering$Types.Types.isNextConnection(b))?b.notchOffset:a&&module$exports$Blockly$blockRendering$Types.Types.isLeftRoundedCorner(a)&&b&&(module$exports$Blockly$blockRendering$Types.Types.isPreviousConnection(b)||module$exports$Blockly$blockRendering$Types.Types.isNextConnection(b))?b.notchOffset-this.constants_.CORNER_RADIUS:this.constants_.MEDIUM_PADDING},module$exports$Blockly$blockRendering$RenderInfo.RenderInfo.prototype.computeBounds_=function(){for(var e,a=0,b=0,c=0,d=0;e=this.rows[d];d++){if(e.measure(),b=Math.max(b,e.width),e.hasStatement){var f=e.getLastInput();a=Math.max(a,e.width-f.width)}c=Math.max(c,e.widthWithConnectedBlocks)}for(this.statementEdge=a,this.width=b,a=0;d=this.rows[a];a++)d.hasStatement&&(d.statementEdge=this.statementEdge);this.widthWithChildren=Math.max(b,c),this.outputConnection&&(this.startX=this.outputConnection.width,this.width+=this.outputConnection.width,this.widthWithChildren+=this.outputConnection.width)},module$exports$Blockly$blockRendering$RenderInfo.RenderInfo.prototype.alignRowElements_=function(){for(var b,a=0;b=this.rows[a];a++)if(b.hasStatement)this.alignStatementRow_(b);else{var c=b.width;0<(c=this.getDesiredRowWidth_(b)-c)&&this.addAlignmentPadding_(b,c),module$exports$Blockly$blockRendering$Types.Types.isTopOrBottomRow(b)&&(b.widthWithConnectedBlocks=b.width)}},module$exports$Blockly$blockRendering$RenderInfo.RenderInfo.prototype.getDesiredRowWidth_=function(a){return this.width-this.startX},module$exports$Blockly$blockRendering$RenderInfo.RenderInfo.prototype.addAlignmentPadding_=function(a,b){var c=a.getFirstSpacer(),d=a.getLastSpacer();(a.hasExternalInput||a.hasStatement)&&(a.widthWithConnectedBlocks+=b),a.align===$.module$exports$Blockly$Input.Align.LEFT?d.width+=b:a.align===$.module$exports$Blockly$Input.Align.CENTRE?(c.width+=b/2,d.width+=b/2):a.align===$.module$exports$Blockly$Input.Align.RIGHT?c.width+=b:d.width+=b,a.width+=b},module$exports$Blockly$blockRendering$RenderInfo.RenderInfo.prototype.alignStatementRow_=function(a){var b=a.getLastInput(),c=a.width-b.width,d=this.statementEdge;0<(c=d-c)&&this.addAlignmentPadding_(a,c),c=a.width,d=this.getDesiredRowWidth_(a),b.width+=d-c,b.height=Math.max(b.height,a.height),a.width+=d-c,a.widthWithConnectedBlocks=Math.max(a.width,this.statementEdge+a.connectedBlockWidths)},module$exports$Blockly$blockRendering$RenderInfo.RenderInfo.prototype.addRowSpacing_=function(){var a=this.rows;this.rows=[];for(var b=0;b<a.length;b++)this.rows.push(a[b]),b!==a.length-1&&this.rows.push(this.makeSpacerRow_(a[b],a[b+1]))},module$exports$Blockly$blockRendering$RenderInfo.RenderInfo.prototype.makeSpacerRow_=function(a,b){var c=this.getSpacerRowHeight_(a,b),d=this.getSpacerRowWidth_(a,b);return c=new module$exports$Blockly$blockRendering$SpacerRow.SpacerRow(this.constants_,c,d),a.hasStatement&&(c.followsStatement=!0),b.hasStatement&&(c.precedesStatement=!0),c},module$exports$Blockly$blockRendering$RenderInfo.RenderInfo.prototype.getSpacerRowWidth_=function(a,b){return this.width-this.startX},module$exports$Blockly$blockRendering$RenderInfo.RenderInfo.prototype.getSpacerRowHeight_=function(a,b){return this.constants_.MEDIUM_PADDING},module$exports$Blockly$blockRendering$RenderInfo.RenderInfo.prototype.getElemCenterline_=function(a,b){return module$exports$Blockly$blockRendering$Types.Types.isSpacer(b)?a.yPos+b.height/2:module$exports$Blockly$blockRendering$Types.Types.isBottomRow(a)?(a=a.yPos+a.height-a.descenderHeight,module$exports$Blockly$blockRendering$Types.Types.isNextConnection(b)?a+b.height/2:a-b.height/2):module$exports$Blockly$blockRendering$Types.Types.isTopRow(a)?module$exports$Blockly$blockRendering$Types.Types.isHat(b)?a.capline-b.height/2:a.capline+b.height/2:a.yPos+a.height/2},module$exports$Blockly$blockRendering$RenderInfo.RenderInfo.prototype.recordElemPositions_=function(a){for(var d,b=a.xPos,c=0;d=a.elements[c];c++)module$exports$Blockly$blockRendering$Types.Types.isSpacer(d)&&(d.height=a.height),d.xPos=b,d.centerline=this.getElemCenterline_(a,d),b+=d.width},module$exports$Blockly$blockRendering$RenderInfo.RenderInfo.prototype.finalize_=function(){for(var d,a=0,b=0,c=0;d=this.rows[c];c++)d.yPos=b,d.xPos=this.startX,b+=d.height,a=Math.max(a,d.widthWithConnectedBlocks),this.recordElemPositions_(d);this.outputConnection&&this.block_.nextConnection&&this.block_.nextConnection.isConnected()&&(a=Math.max(a,this.block_.nextConnection.targetBlock().getHeightWidth().width)),this.widthWithChildren=a+this.startX,this.height=b,this.startY=this.topRow.capline,this.bottomRow.baseline=b-this.bottomRow.descenderHeight};var module$exports$Blockly$blockRendering$Renderer={Renderer:function(a){this.name=a,this.overrides=this.constants_=null}};module$exports$Blockly$blockRendering$Renderer.Renderer.prototype.getClassName=function(){return this.name+"-renderer"},module$exports$Blockly$blockRendering$Renderer.Renderer.prototype.init=function(a,b){this.constants_=this.makeConstants_(),b&&(this.overrides=b,(0,$.module$exports$Blockly$utils$object.mixin)(this.constants_,b)),this.constants_.setTheme(a),this.constants_.init()},module$exports$Blockly$blockRendering$Renderer.Renderer.prototype.createDom=function(a,b){this.constants_.createDom(a,this.name+"-"+b.name,"."+this.getClassName()+"."+b.getClassName())},module$exports$Blockly$blockRendering$Renderer.Renderer.prototype.refreshDom=function(a,b){var c=this.getConstants();c.dispose(),this.constants_=this.makeConstants_(),this.overrides&&(0,$.module$exports$Blockly$utils$object.mixin)(this.constants_,this.overrides),this.constants_.randomIdentifier=c.randomIdentifier,this.constants_.setTheme(b),this.constants_.init(),this.createDom(a,b)},module$exports$Blockly$blockRendering$Renderer.Renderer.prototype.dispose=function(){this.constants_&&this.constants_.dispose()},module$exports$Blockly$blockRendering$Renderer.Renderer.prototype.makeConstants_=function(){return new module$exports$Blockly$blockRendering$ConstantProvider.ConstantProvider},module$exports$Blockly$blockRendering$Renderer.Renderer.prototype.makeRenderInfo_=function(a){return new module$exports$Blockly$blockRendering$RenderInfo.RenderInfo(this,a)},module$exports$Blockly$blockRendering$Renderer.Renderer.prototype.makeDrawer_=function(a,b){return new module$exports$Blockly$blockRendering$Drawer.Drawer(a,b)},module$exports$Blockly$blockRendering$Renderer.Renderer.prototype.makeDebugger_=function(){var a=module$exports$Blockly$blockRendering$Debug.Debug;if(!a)throw Error("Missing require for Blockly.blockRendering.Debug");return new a(this.getConstants())},module$exports$Blockly$blockRendering$Renderer.Renderer.prototype.makeMarkerDrawer=function(a,b){return new module$exports$Blockly$blockRendering$MarkerSvg.MarkerSvg(a,this.getConstants(),b)},module$exports$Blockly$blockRendering$Renderer.Renderer.prototype.makePathObject=function(a,b){return new module$exports$Blockly$blockRendering$PathObject.PathObject(a,b,this.constants_)},module$exports$Blockly$blockRendering$Renderer.Renderer.prototype.getConstants=function(){return this.constants_},module$exports$Blockly$blockRendering$Renderer.Renderer.prototype.shouldHighlightConnection=function(a){return!0},module$exports$Blockly$blockRendering$Renderer.Renderer.prototype.orphanCanConnectAtEnd=function(a,b,c){return!!module$exports$Blockly$Connection.Connection.getConnectionForOrphanedConnection(a,c===$.module$exports$Blockly$ConnectionType.ConnectionType.OUTPUT_VALUE?b.outputConnection:b.previousConnection)},module$exports$Blockly$blockRendering$Renderer.Renderer.prototype.getConnectionPreviewMethod=function(a,b,c){return b.type===$.module$exports$Blockly$ConnectionType.ConnectionType.OUTPUT_VALUE||b.type===$.module$exports$Blockly$ConnectionType.ConnectionType.PREVIOUS_STATEMENT?!a.isConnected()||this.orphanCanConnectAtEnd(c,a.targetBlock(),b.type)?module$exports$Blockly$InsertionMarkerManager.InsertionMarkerManager.PREVIEW_TYPE.INSERTION_MARKER:module$exports$Blockly$InsertionMarkerManager.InsertionMarkerManager.PREVIEW_TYPE.REPLACEMENT_FADE:module$exports$Blockly$InsertionMarkerManager.InsertionMarkerManager.PREVIEW_TYPE.INSERTION_MARKER},module$exports$Blockly$blockRendering$Renderer.Renderer.prototype.render=function(a){(0,module$exports$Blockly$blockRendering$debug.isDebuggerEnabled)()&&!a.renderingDebugger&&(a.renderingDebugger=this.makeDebugger_());var b=this.makeRenderInfo_(a);b.measure(),this.makeDrawer_(a,b).draw()};var module$contents$Blockly$Extensions_allExtensions,module$exports$Blockly$blockRendering={isDebuggerEnabled:function(){return(0,module$exports$Blockly$utils$deprecation.warn)("Blockly.blockRendering.isDebuggerEnabled()","September 2021","September 2022","Blockly.blockRendering.debug.isDebuggerEnabled()"),(0,module$exports$Blockly$blockRendering$debug.isDebuggerEnabled)()},register:function(a,b){(0,module$exports$Blockly$registry.register)(module$exports$Blockly$registry.Type.RENDERER,a,b)},unregister:function(a){(0,module$exports$Blockly$registry.unregister)(module$exports$Blockly$registry.Type.RENDERER,a)},startDebugger:function(){(0,module$exports$Blockly$utils$deprecation.warn)("Blockly.blockRendering.startDebugger()","September 2021","September 2022","Blockly.blockRendering.debug.startDebugger()"),(0,module$exports$Blockly$blockRendering$debug.startDebugger)()},stopDebugger:function(){(0,module$exports$Blockly$utils$deprecation.warn)("Blockly.blockRendering.stopDebugger()","September 2021","September 2022","Blockly.blockRendering.debug.stopDebugger()"),(0,module$exports$Blockly$blockRendering$debug.stopDebugger)()},init:function(a,b,c){return(a=new((0,module$exports$Blockly$registry.getClass)(module$exports$Blockly$registry.Type.RENDERER,a))(a)).init(b,c),a}};module$exports$Blockly$blockRendering.BottomRow=module$exports$Blockly$blockRendering$BottomRow.BottomRow,module$exports$Blockly$blockRendering.Connection=module$exports$Blockly$blockRendering$Connection.Connection,module$exports$Blockly$blockRendering.ConstantProvider=module$exports$Blockly$blockRendering$ConstantProvider.ConstantProvider,module$exports$Blockly$blockRendering.Debug=module$exports$Blockly$blockRendering$Debug.Debug,module$exports$Blockly$blockRendering.Drawer=module$exports$Blockly$blockRendering$Drawer.Drawer,module$exports$Blockly$blockRendering.ExternalValueInput=module$exports$Blockly$blockRendering$ExternalValueInput.ExternalValueInput,module$exports$Blockly$blockRendering.Field=module$exports$Blockly$blockRendering$Field.Field,module$exports$Blockly$blockRendering.Hat=module$exports$Blockly$blockRendering$Hat.Hat,module$exports$Blockly$blockRendering.Icon=module$exports$Blockly$blockRendering$Icon.Icon,module$exports$Blockly$blockRendering.InRowSpacer=module$exports$Blockly$blockRendering$InRowSpacer.InRowSpacer,module$exports$Blockly$blockRendering.InlineInput=module$exports$Blockly$blockRendering$InlineInput.InlineInput,module$exports$Blockly$blockRendering.InputConnection=module$exports$Blockly$blockRendering$InputConnection.InputConnection,module$exports$Blockly$blockRendering.InputRow=module$exports$Blockly$blockRendering$InputRow.InputRow,module$exports$Blockly$blockRendering.IPathObject=function(a,b){},module$exports$Blockly$blockRendering.JaggedEdge=module$exports$Blockly$blockRendering$JaggedEdge.JaggedEdge,module$exports$Blockly$blockRendering.MarkerSvg=module$exports$Blockly$blockRendering$MarkerSvg.MarkerSvg,module$exports$Blockly$blockRendering.Measurable=module$exports$Blockly$blockRendering$Measurable_Measurable,module$exports$Blockly$blockRendering.NextConnection=module$exports$Blockly$blockRendering$NextConnection.NextConnection,module$exports$Blockly$blockRendering.OutputConnection=module$exports$Blockly$blockRendering$OutputConnection.OutputConnection,module$exports$Blockly$blockRendering.PathObject=module$exports$Blockly$blockRendering$PathObject.PathObject,module$exports$Blockly$blockRendering.PreviousConnection=module$exports$Blockly$blockRendering$PreviousConnection.PreviousConnection,module$exports$Blockly$blockRendering.Renderer=module$exports$Blockly$blockRendering$Renderer.Renderer,module$exports$Blockly$blockRendering.RenderInfo=module$exports$Blockly$blockRendering$RenderInfo.RenderInfo,module$exports$Blockly$blockRendering.RoundCorner=module$exports$Blockly$blockRendering$RoundCorner.RoundCorner,module$exports$Blockly$blockRendering.Row=module$exports$Blockly$blockRendering$Row.Row,module$exports$Blockly$blockRendering.SpacerRow=module$exports$Blockly$blockRendering$SpacerRow.SpacerRow,module$exports$Blockly$blockRendering.SquareCorner=module$exports$Blockly$blockRendering$SquareCorner.SquareCorner,module$exports$Blockly$blockRendering.StatementInput=module$exports$Blockly$blockRendering$StatementInput.StatementInput,module$exports$Blockly$blockRendering.TopRow=module$exports$Blockly$blockRendering$TopRow.TopRow,module$exports$Blockly$blockRendering.Types=module$exports$Blockly$blockRendering$Types.Types,module$exports$Blockly$blockRendering.debug=module$exports$Blockly$blockRendering$debug,$.module$exports$Blockly$Extensions={},module$contents$Blockly$Extensions_allExtensions=Object.create(null),$.module$exports$Blockly$Extensions.TEST_ONLY={allExtensions:module$contents$Blockly$Extensions_allExtensions},$.module$exports$Blockly$Extensions.register=function(a,b){if("string"!=typeof a||""===a.trim())throw Error('Error: Invalid extension name "'+a+'"');if(module$contents$Blockly$Extensions_allExtensions[a])throw Error('Error: Extension "'+a+'" is already registered.');if("function"!=typeof b)throw Error('Error: Extension "'+a+'" must be a function');module$contents$Blockly$Extensions_allExtensions[a]=b},$.module$exports$Blockly$Extensions.registerMixin=function(a,b){if(!b||"object"!=typeof b)throw Error('Error: Mixin "'+a+'" must be a object');(0,$.module$exports$Blockly$Extensions.register)(a,(function(){this.mixin(b)}))},$.module$exports$Blockly$Extensions.registerMutator=function(a,b,c,d){var e='Error when registering mutator "'+a+'": ';module$contents$Blockly$Extensions_checkHasMutatorProperties(e,b);var f=module$contents$Blockly$Extensions_checkMutatorDialog(b,e);if(c&&"function"!=typeof c)throw Error(e+'Extension "'+a+'" is not a function');(0,$.module$exports$Blockly$Extensions.register)(a,(function(){if(f){var g=$.module$exports$Blockly$Mutator.Mutator;if(!g)throw Error(e+"Missing require for Blockly.Mutator");this.setMutator(new g(d||[]))}this.mixin(b),c&&c.apply(this)}))},$.module$exports$Blockly$Extensions.unregister=function(a){(0,$.module$exports$Blockly$Extensions.isRegistered)(a)?delete module$contents$Blockly$Extensions_allExtensions[a]:console.warn('No extension mapping for name "'+a+'" found to unregister')},$.module$exports$Blockly$Extensions.isRegistered=function(a){return!!module$contents$Blockly$Extensions_allExtensions[a]},$.module$exports$Blockly$Extensions.apply=function(a,b,c){var e,d=module$contents$Blockly$Extensions_allExtensions[a];if("function"!=typeof d)throw Error('Error: Extension "'+a+'" not found.');if(c?module$contents$Blockly$Extensions_checkNoMutatorProperties(a,b):e=module$contents$Blockly$Extensions_getMutatorProperties(b),d.apply(b),c)module$contents$Blockly$Extensions_checkHasMutatorProperties('Error after applying mutator "'+a+'": ',b);else if(!module$contents$Blockly$Extensions_mutatorPropertiesMatch(e,b))throw Error('Error when applying extension "'+a+'": mutation properties changed when applying a non-mutator extension.')};var module$contents$Blockly$Extensions_checkNoMutatorProperties=function(a,b){if(module$contents$Blockly$Extensions_getMutatorProperties(b).length)throw Error('Error: tried to apply mutation "'+a+'" to a block that already has mutator functions.  Block id: '+b.id)},module$contents$Blockly$Extensions_checkMutatorDialog=function(a,b){return module$contents$Blockly$Extensions_checkHasFunctionPair(a.compose,a.decompose,b+" compose/decompose")},module$contents$Blockly$Extensions_checkHasFunctionPair=function(a,b,c){if(a&&b){if("function"!=typeof a||"function"!=typeof b)throw Error(c+" must be a function");return!0}if(!a&&!b)return!1;throw Error(c+"Must have both or neither functions")},module$contents$Blockly$Extensions_checkHasMutatorProperties=function(a,b){var c=function(a,b){return module$contents$Blockly$Extensions_checkHasFunctionPair(a.mutationToDom,a.domToMutation,b+" mutationToDom/domToMutation")}(b,a),d=function(a,b){return module$contents$Blockly$Extensions_checkHasFunctionPair(a.saveExtraState,a.loadExtraState,b+" saveExtraState/loadExtraState")}(b,a);if(!c&&!d)throw Error(a+"Mutations must contain either XML hooks, or JSON hooks, or both");module$contents$Blockly$Extensions_checkMutatorDialog(b,a)},module$contents$Blockly$Extensions_getMutatorProperties=function(a){var b=[];return void 0!==a.domToMutation&&b.push(a.domToMutation),void 0!==a.mutationToDom&&b.push(a.mutationToDom),void 0!==a.saveExtraState&&b.push(a.saveExtraState),void 0!==a.loadExtraState&&b.push(a.loadExtraState),void 0!==a.compose&&b.push(a.compose),void 0!==a.decompose&&b.push(a.decompose),b},module$contents$Blockly$Extensions_mutatorPropertiesMatch=function(a,b){if((b=module$contents$Blockly$Extensions_getMutatorProperties(b)).length!==a.length)return!1;for(var c=0;c<b.length;c++)if(a[c]!==b[c])return!1;return!0};$.module$exports$Blockly$Extensions.runAfterPageLoad=function(a){if("object"!=typeof document)throw Error("runAfterPageLoad() requires browser document.");if("complete"===document.readyState)a();else var b=setInterval((function(){"complete"===document.readyState&&(clearInterval(b),a())}),10)},$.module$exports$Blockly$Extensions.buildTooltipForDropdown=function(a,b){var c=[];return"object"==typeof document&&(0,$.module$exports$Blockly$Extensions.runAfterPageLoad)((function(){for(var d in b)(0,module$exports$Blockly$utils$parsing.checkMessageReferences)(b[d])})),function(){this.type&&-1===c.indexOf(this.type)&&(module$contents$Blockly$Extensions_checkDropdownOptionsInTable(this,a,b),c.push(this.type)),this.setTooltip(function(){var d=String(this.getFieldValue(a)),e=b[d];return null===e?-1===c.indexOf(this.type)&&(d="No tooltip mapping for value "+d+" of field "+a,null!==this.type&&(d+=" of block type "+this.type),console.warn(d+".")):e=(0,module$exports$Blockly$utils$parsing.replaceMessageReferences)(e),e}.bind(this))}};var module$contents$Blockly$Extensions_checkDropdownOptionsInTable=function(a,b,c){var d=a.getField(b);if(!d.isOptionListDynamic()){d=d.getOptions();for(var e=0;e<d.length;e++){var f=d[e][1];null===c[f]&&console.warn("No tooltip mapping for value "+f+" of field "+b+" of block type "+a.type)}}};$.module$exports$Blockly$Extensions.buildTooltipWithFieldText=function(a,b){return"object"==typeof document&&(0,$.module$exports$Blockly$Extensions.runAfterPageLoad)((function(){(0,module$exports$Blockly$utils$parsing.checkMessageReferences)(a)})),function(){this.setTooltip(function(){var c=this.getField(b);return(0,module$exports$Blockly$utils$parsing.replaceMessageReferences)(a).replace("%1",c?c.getText():"")}.bind(this))}},(0,$.module$exports$Blockly$Extensions.register)("parent_tooltip_when_inline",(function(){this.tooltipWhenNotConnected=this.tooltip,this.setTooltip(function(){var a=this.getParent();return a&&a.getInputsInline()&&a.tooltip||this.tooltipWhenNotConnected}.bind(this))}));var module$exports$Blockly$utils={aria:module$exports$Blockly$utils$aria,colour:module$exports$Blockly$utils$colour};module$exports$Blockly$utils.Coordinate=module$exports$Blockly$utils$Coordinate.Coordinate,module$exports$Blockly$utils.deprecation=module$exports$Blockly$utils$deprecation,module$exports$Blockly$utils.dom=module$exports$Blockly$utils$dom,module$exports$Blockly$utils.global=$.module$exports$Blockly$utils$global.globalThis,module$exports$Blockly$utils.idGenerator=module$exports$Blockly$utils$idGenerator,module$exports$Blockly$utils.KeyCodes=module$exports$Blockly$utils$KeyCodes_KeyCodes,module$exports$Blockly$utils.math=module$exports$Blockly$utils$math,module$exports$Blockly$utils.Metrics=function(){},module$exports$Blockly$utils.object=$.module$exports$Blockly$utils$object,module$exports$Blockly$utils.parsing=module$exports$Blockly$utils$parsing,module$exports$Blockly$utils.Rect=module$exports$Blockly$utils$Rect.Rect,module$exports$Blockly$utils.Size=module$exports$Blockly$utils$Size.Size,module$exports$Blockly$utils.string=$.module$exports$Blockly$utils$string,module$exports$Blockly$utils.style=module$exports$Blockly$utils$style,module$exports$Blockly$utils.Svg=module$exports$Blockly$utils$Svg.Svg,module$exports$Blockly$utils.svgPaths=module$exports$Blockly$utils$svgPaths,module$exports$Blockly$utils.svgMath=module$exports$Blockly$utils$svgMath,module$exports$Blockly$utils.toolbox=module$exports$Blockly$utils$toolbox,module$exports$Blockly$utils.userAgent=module$exports$Blockly$utils$userAgent,module$exports$Blockly$utils.xml=$.module$exports$Blockly$utils$xml,module$exports$Blockly$utils.noEvent=function(a){(0,module$exports$Blockly$utils$deprecation.warn)("Blockly.utils.noEvent","September 2021","September 2022"),a.preventDefault(),a.stopPropagation()},module$exports$Blockly$utils.isTargetInput=function(a){return(0,module$exports$Blockly$utils$deprecation.warn)("Blockly.utils.isTargetInput","September 2021","September 2022","Blockly.browserEvents.isTargetInput"),(0,module$exports$Blockly$browserEvents.isTargetInput)(a)},module$exports$Blockly$utils.getRelativeXY=function(a){return(0,module$exports$Blockly$utils$deprecation.warn)("Blockly.utils.getRelativeXY","December 2021","December 2022","Blockly.utils.svgMath.getRelativeXY"),(0,module$exports$Blockly$utils$svgMath.getRelativeXY)(a)},module$exports$Blockly$utils.getInjectionDivXY_=function(a){return(0,module$exports$Blockly$utils$deprecation.warn)("Blockly.utils.getInjectionDivXY_","December 2021","December 2022","Blockly.utils.svgMath.getInjectionDivXY"),(0,module$exports$Blockly$utils$svgMath.getInjectionDivXY)(a)},module$exports$Blockly$utils.isRightButton=function(a){return(0,module$exports$Blockly$utils$deprecation.warn)("Blockly.utils.isRightButton","September 2021","September 2022","Blockly.browserEvents.isRightButton"),(0,module$exports$Blockly$browserEvents.isRightButton)(a)},module$exports$Blockly$utils.mouseToSvg=function(a,b,c){return(0,module$exports$Blockly$utils$deprecation.warn)("Blockly.utils.mouseToSvg","September 2021","September 2022","Blockly.browserEvents.mouseToSvg"),(0,module$exports$Blockly$browserEvents.mouseToSvg)(a,b,c)},module$exports$Blockly$utils.getScrollDeltaPixels=function(a){return(0,module$exports$Blockly$utils$deprecation.warn)("Blockly.utils.getScrollDeltaPixels","September 2021","September 2022","Blockly.browserEvents.getScrollDeltaPixels"),(0,module$exports$Blockly$browserEvents.getScrollDeltaPixels)(a)},module$exports$Blockly$utils.tokenizeInterpolation=function(a){return(0,module$exports$Blockly$utils$deprecation.warn)("Blockly.utils.tokenizeInterpolation","December 2021","December 2022","Blockly.utils.parsing.tokenizeInterpolation"),(0,module$exports$Blockly$utils$parsing.tokenizeInterpolation)(a)},module$exports$Blockly$utils.replaceMessageReferences=function(a){return(0,module$exports$Blockly$utils$deprecation.warn)("Blockly.utils.replaceMessageReferences","December 2021","December 2022","Blockly.utils.parsing.replaceMessageReferences"),(0,module$exports$Blockly$utils$parsing.replaceMessageReferences)(a)},module$exports$Blockly$utils.checkMessageReferences=function(a){return(0,module$exports$Blockly$utils$deprecation.warn)("Blockly.utils.checkMessageReferences","December 2021","December 2022","Blockly.utils.parsing.checkMessageReferences"),(0,module$exports$Blockly$utils$parsing.checkMessageReferences)(a)},module$exports$Blockly$utils.genUid=function(){return(0,module$exports$Blockly$utils$deprecation.warn)("Blockly.utils.genUid","September 2021","September 2022","Blockly.utils.idGenerator.genUid"),(0,module$exports$Blockly$utils$idGenerator.genUid)()},module$exports$Blockly$utils.is3dSupported=function(){return(0,module$exports$Blockly$utils$deprecation.warn)("Blockly.utils.is3dSupported","December 2021","December 2022","Blockly.utils.svgMath.is3dSupported"),(0,module$exports$Blockly$utils$svgMath.is3dSupported)()},module$exports$Blockly$utils.getViewportBBox=function(){return(0,module$exports$Blockly$utils$deprecation.warn)("Blockly.utils.getViewportBBox","December 2021","December 2022","Blockly.utils.svgMath.getViewportBBox"),(0,module$exports$Blockly$utils$svgMath.getViewportBBox)()},module$exports$Blockly$utils.arrayRemove=function(a,b){return(0,module$exports$Blockly$utils$deprecation.warn)("Blockly.utils.arrayRemove","December 2021","December 2022"),module$exports$Blockly$utils$array_removeElem(a,b)},module$exports$Blockly$utils.getDocumentScroll=function(){return(0,module$exports$Blockly$utils$deprecation.warn)("Blockly.utils.getDocumentScroll","December 2021","December 2022","Blockly.utils.svgMath.getDocumentScroll"),(0,module$exports$Blockly$utils$svgMath.getDocumentScroll)()},module$exports$Blockly$utils.getBlockTypeCounts=function(a,b){return(0,module$exports$Blockly$utils$deprecation.warn)("Blockly.utils.getBlockTypeCounts","December 2021","December 2022","Blockly.common.getBlockTypeCounts"),(0,$.module$exports$Blockly$common.getBlockTypeCounts)(a,b)},module$exports$Blockly$utils.screenToWsCoordinates=function(a,b){return(0,module$exports$Blockly$utils$deprecation.warn)("Blockly.utils.screenToWsCoordinates","December 2021","December 2022","Blockly.utils.svgMath.screenToWsCoordinates"),(0,module$exports$Blockly$utils$svgMath.screenToWsCoordinates)(a,b)},module$exports$Blockly$utils.parseBlockColour=function(a){return(0,module$exports$Blockly$utils$deprecation.warn)("Blockly.utils.parseBlockColour","December 2021","December 2022","Blockly.utils.parsing.parseBlockColour"),(0,module$exports$Blockly$utils$parsing.parseBlockColour)(a)},module$exports$Blockly$utils.runAfterPageLoad=function(a){(0,module$exports$Blockly$utils$deprecation.warn)("Blockly.utils.runAfterPageLoad","December 2021","December 2022"),(0,$.module$exports$Blockly$Extensions.runAfterPageLoad)(a)};var module$exports$Blockly$Events$BlockDelete={BlockDelete:function(a){if(module$exports$Blockly$Events$BlockDelete.BlockDelete.superClass_.constructor.call(this,a),a){if(a.getParent())throw Error("Connected blocks cannot be deleted.");a.isShadow()&&(this.recordUndo=!1),this.oldXml=(0,$.module$exports$Blockly$Xml.blockToDomWithXY)(a),this.ids=(0,module$exports$Blockly$Events$utils.getDescendantIds)(a),this.wasShadow=a.isShadow(),this.oldJson=(0,module$exports$Blockly$serialization$blocks.save)(a,{addCoordinates:!0})}}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$Events$BlockDelete.BlockDelete,module$exports$Blockly$Events$BlockBase.BlockBase),module$exports$Blockly$Events$BlockDelete.BlockDelete.prototype.type=module$exports$Blockly$Events$utils.DELETE,module$exports$Blockly$Events$BlockDelete.BlockDelete.prototype.toJson=function(){var a=module$exports$Blockly$Events$BlockDelete.BlockDelete.superClass_.toJson.call(this);return a.oldXml=(0,$.module$exports$Blockly$Xml.domToText)(this.oldXml),a.ids=this.ids,a.wasShadow=this.wasShadow,a.oldJson=this.oldJson,this.recordUndo||(a.recordUndo=this.recordUndo),a},module$exports$Blockly$Events$BlockDelete.BlockDelete.prototype.fromJson=function(a){module$exports$Blockly$Events$BlockDelete.BlockDelete.superClass_.fromJson.call(this,a),this.oldXml=(0,$.module$exports$Blockly$Xml.textToDom)(a.oldXml),this.ids=a.ids,this.wasShadow=a.wasShadow||"shadow"===this.oldXml.tagName.toLowerCase(),this.oldJson=a.oldJson,void 0!==a.recordUndo&&(this.recordUndo=a.recordUndo)},module$exports$Blockly$Events$BlockDelete.BlockDelete.prototype.run=function(a){var b=this.getEventWorkspace_();if(a)for(a=0;a<this.ids.length;a++){var c=this.ids[a],d=b.getBlockById(c);d?d.dispose(!1):c===this.blockId&&console.warn("Can't delete non-existent block: "+c)}else(0,module$exports$Blockly$serialization$blocks.append)(this.oldJson,b)},(0,module$exports$Blockly$registry.register)(module$exports$Blockly$registry.Type.EVENT,module$exports$Blockly$Events$utils.DELETE,module$exports$Blockly$Events$BlockDelete.BlockDelete);var module$exports$Blockly$Block={Block:function(a,b,c){var d=$.module$exports$Blockly$Generator.Generator;if(d&&void 0!==d.prototype[b])throw Error('Block prototypeName "'+b+'" conflicts with Blockly.Generator members.');if(this.id=c&&!a.getBlockById(c)?c:(0,module$exports$Blockly$utils$idGenerator.genUid)(),a.setBlockById(this.id,this),this.previousConnection=this.nextConnection=this.outputConnection=null,this.inputList=[],this.inputsInline=void 0,this.disabled=!1,this.tooltip="",this.contextMenu=!0,this.parentBlock_=null,this.childBlocks_=[],this.editable_=this.movable_=this.deletable_=!0,this.collapsed_=this.isShadow_=!1,this.comment=this.outputShape_=null,this.commentModel={text:null,pinned:!1,size:new module$exports$Blockly$utils$Size.Size(160,80)},this.xy_=new module$exports$Blockly$utils$Coordinate.Coordinate(0,0),this.workspace=a,this.isInFlyout=a.isFlyout,this.isInMutator=a.isMutator,this.RTL=a.RTL,this.isInsertionMarker_=!1,this.hat=void 0,this.rendered=null,this.statementInputCount=0,b){if(this.type=b,!(c=$.module$exports$Blockly$blocks.Blocks[b])||"object"!=typeof c)throw TypeError("Unknown block type: "+b);(0,$.module$exports$Blockly$utils$object.mixin)(this,c)}a.addTopBlock(this),a.addTypedBlock(this),(a=(0,module$exports$Blockly$Events$utils.getGroup)())||(0,module$exports$Blockly$Events$utils.setGroup)(!0),b=(0,module$exports$Blockly$Events$utils.getRecordUndo)();try{"function"==typeof this.init&&((0,module$exports$Blockly$Events$utils.setRecordUndo)(!1),this.init(),(0,module$exports$Blockly$Events$utils.setRecordUndo)(b)),(0,module$exports$Blockly$Events$utils.isEnabled)()&&(0,module$exports$Blockly$Events$utils.fire)(new((0,module$exports$Blockly$Events$utils.get)(module$exports$Blockly$Events$utils.CREATE))(this))}finally{a||(0,module$exports$Blockly$Events$utils.setGroup)(!1),(0,module$exports$Blockly$Events$utils.setRecordUndo)(b)}this.inputsInlineDefault=this.inputsInline,"function"==typeof this.onchange&&this.setOnChange(this.onchange)}};module$exports$Blockly$Block.Block.COLLAPSED_INPUT_NAME=module$exports$Blockly$constants.COLLAPSED_INPUT_NAME,module$exports$Blockly$Block.Block.COLLAPSED_FIELD_NAME=module$exports$Blockly$constants.COLLAPSED_FIELD_NAME,module$exports$Blockly$Block.Block.prototype.data=null,module$exports$Blockly$Block.Block.prototype.disposed=!1,module$exports$Blockly$Block.Block.prototype.hue_=null,module$exports$Blockly$Block.Block.prototype.colour_="#000000",module$exports$Blockly$Block.Block.prototype.styleName_="",module$exports$Blockly$Block.Block.prototype.dispose=function(a){if(this.workspace){this.onchangeWrapper_&&this.workspace.removeChangeListener(this.onchangeWrapper_),this.unplug(a),(0,module$exports$Blockly$Events$utils.isEnabled)()&&(0,module$exports$Blockly$Events$utils.fire)(new((0,module$exports$Blockly$Events$utils.get)(module$exports$Blockly$Events$utils.DELETE))(this)),(0,module$exports$Blockly$Events$utils.disable)();try{this.workspace&&(this.workspace.removeTopBlock(this),this.workspace.removeTypedBlock(this),this.workspace.removeBlockById(this.id),this.workspace=null),(0,$.module$exports$Blockly$common.getSelected)()===this&&(0,$.module$exports$Blockly$common.setSelected)(null);for(var b=this.childBlocks_.length-1;0<=b;b--)this.childBlocks_[b].dispose(!1);for(a=0,b=void 0;b=this.inputList[a];a++)b.dispose();this.inputList.length=0;var c=this.getConnections_(!0);for(a=0,b=void 0;b=c[a];a++)b.dispose()}finally{(0,module$exports$Blockly$Events$utils.enable)(),this.disposed=!0}}},module$exports$Blockly$Block.Block.prototype.initModel=function(){for(var b,a=0;b=this.inputList[a];a++)for(var d,c=0;d=b.fieldRow[c];c++)d.initModel&&d.initModel()},module$exports$Blockly$Block.Block.prototype.unplug=function(a){this.outputConnection&&this.unplugFromRow_(a),this.previousConnection&&this.unplugFromStack_(a)},module$exports$Blockly$Block.Block.prototype.unplugFromRow_=function(a){var b=null;this.outputConnection.isConnected()&&(b=this.outputConnection.targetConnection,this.outputConnection.disconnect()),b&&a&&(a=this.getOnlyValueConnection_())&&a.isConnected()&&!a.targetBlock().isShadow()&&((a=a.targetConnection).disconnect(),this.workspace.connectionChecker.canConnect(a,b,!1)?b.connect(a):a.onFailedConnect(b))},module$exports$Blockly$Block.Block.prototype.getOnlyValueConnection_=function(){for(var a=null,b=0;b<this.inputList.length;b++){var c=this.inputList[b].connection;if(c&&c.type===$.module$exports$Blockly$ConnectionType.ConnectionType.INPUT_VALUE&&c.targetConnection){if(a)return null;a=c}}return a},module$exports$Blockly$Block.Block.prototype.unplugFromStack_=function(a){var b=null;this.previousConnection.isConnected()&&(b=this.previousConnection.targetConnection,this.previousConnection.disconnect());var c=this.getNextBlock();a&&c&&!c.isShadow()&&((a=this.nextConnection.targetConnection).disconnect(),b&&this.workspace.connectionChecker.canConnect(b,a,!1)&&b.connect(a))},module$exports$Blockly$Block.Block.prototype.getConnections_=function(a){a=[],this.outputConnection&&a.push(this.outputConnection),this.previousConnection&&a.push(this.previousConnection),this.nextConnection&&a.push(this.nextConnection);for(var c,b=0;c=this.inputList[b];b++)c.connection&&a.push(c.connection);return a},module$exports$Blockly$Block.Block.prototype.lastConnectionInStack=function(a){for(var b=this.nextConnection;b;){var c=b.targetBlock();if(!c||a&&c.isShadow())return b;b=c.nextConnection}return null},module$exports$Blockly$Block.Block.prototype.bumpNeighbours=function(){},module$exports$Blockly$Block.Block.prototype.getParent=function(){return this.parentBlock_},module$exports$Blockly$Block.Block.prototype.getInputWithBlock=function(a){for(var c,b=0;c=this.inputList[b];b++)if(c.connection&&c.connection.targetBlock()===a)return c;return null},module$exports$Blockly$Block.Block.prototype.getSurroundParent=function(){var a=this;do{var b=a;if(!(a=a.getParent()))return null}while(a.getNextBlock()===b);return a},module$exports$Blockly$Block.Block.prototype.getNextBlock=function(){return this.nextConnection&&this.nextConnection.targetBlock()},module$exports$Blockly$Block.Block.prototype.getPreviousBlock=function(){return this.previousConnection&&this.previousConnection.targetBlock()},module$exports$Blockly$Block.Block.prototype.getFirstStatementConnection=function(){for(var b,a=0;b=this.inputList[a];a++)if(b.connection&&b.connection.type===$.module$exports$Blockly$ConnectionType.ConnectionType.NEXT_STATEMENT)return b.connection;return null},module$exports$Blockly$Block.Block.prototype.getRootBlock=function(){var a=this;do{var b=a;a=b.parentBlock_}while(a);return b},module$exports$Blockly$Block.Block.prototype.getTopStackBlock=function(){var a=this;do{var b=a.getPreviousBlock()}while(b&&b.getNextBlock()===a&&(a=b));return a},module$exports$Blockly$Block.Block.prototype.getChildren=function(a){if(!a)return this.childBlocks_;a=[];for(var c,b=0;c=this.inputList[b];b++)c.connection&&(c=c.connection.targetBlock())&&a.push(c);return(b=this.getNextBlock())&&a.push(b),a},module$exports$Blockly$Block.Block.prototype.setParent=function(a){if(a!==this.parentBlock_){var b=this.previousConnection&&this.previousConnection.targetBlock()||this.outputConnection&&this.outputConnection.targetBlock(),c=!!b;if(c&&a&&b!==a)throw Error("Block connected to superior one that is not new parent.");if(!c&&a)throw Error("Block not connected to new parent.");if(c&&!a)throw Error("Cannot set parent to null while block is still connected to superior block.");this.parentBlock_?module$exports$Blockly$utils$array_removeElem(this.parentBlock_.childBlocks_,this):this.workspace.removeTopBlock(this),(this.parentBlock_=a)?a.childBlocks_.push(this):this.workspace.addTopBlock(this)}},module$exports$Blockly$Block.Block.prototype.getDescendants=function(a){for(var d,b=[this],c=this.getChildren(a),e=0;d=c[e];e++)b.push.apply(b,d.getDescendants(a));return b},module$exports$Blockly$Block.Block.prototype.isDeletable=function(){return this.deletable_&&!this.isShadow_&&!(this.workspace&&this.workspace.options.readOnly)},module$exports$Blockly$Block.Block.prototype.setDeletable=function(a){this.deletable_=a},module$exports$Blockly$Block.Block.prototype.isMovable=function(){return this.movable_&&!this.isShadow_&&!(this.workspace&&this.workspace.options.readOnly)},module$exports$Blockly$Block.Block.prototype.setMovable=function(a){this.movable_=a},module$exports$Blockly$Block.Block.prototype.isDuplicatable=function(){return!this.workspace.hasBlockLimits()||this.workspace.isCapacityAvailable((0,$.module$exports$Blockly$common.getBlockTypeCounts)(this,!0))},module$exports$Blockly$Block.Block.prototype.isShadow=function(){return this.isShadow_},module$exports$Blockly$Block.Block.prototype.setShadow=function(a){this.isShadow_=a},module$exports$Blockly$Block.Block.prototype.isInsertionMarker=function(){return this.isInsertionMarker_},module$exports$Blockly$Block.Block.prototype.setInsertionMarker=function(a){this.isInsertionMarker_=a},module$exports$Blockly$Block.Block.prototype.isEditable=function(){return this.editable_&&!(this.workspace&&this.workspace.options.readOnly)},module$exports$Blockly$Block.Block.prototype.setEditable=function(a){this.editable_=a,a=0;for(var b;b=this.inputList[a];a++)for(var d,c=0;d=b.fieldRow[c];c++)d.updateEditable()},module$exports$Blockly$Block.Block.prototype.isDisposed=function(){return this.disposed},module$exports$Blockly$Block.Block.prototype.getMatchingConnection=function(a,b){var c=this.getConnections_(!0);if(a=a.getConnections_(!0),c.length!==a.length)throw Error("Connection lists did not match in length.");for(var d=0;d<a.length;d++)if(a[d]===b)return c[d];return null},module$exports$Blockly$Block.Block.prototype.setHelpUrl=function(a){this.helpUrl=a},module$exports$Blockly$Block.Block.prototype.setTooltip=function(a){this.tooltip=a},module$exports$Blockly$Block.Block.prototype.getTooltip=function(){return(0,module$exports$Blockly$Tooltip.getTooltipOfObject)(this)},module$exports$Blockly$Block.Block.prototype.getColour=function(){return this.colour_},module$exports$Blockly$Block.Block.prototype.getStyleName=function(){return this.styleName_},module$exports$Blockly$Block.Block.prototype.getHue=function(){return this.hue_},module$exports$Blockly$Block.Block.prototype.setColour=function(a){a=(0,module$exports$Blockly$utils$parsing.parseBlockColour)(a),this.hue_=a.hue,this.colour_=a.hex},module$exports$Blockly$Block.Block.prototype.setStyle=function(a){this.styleName_=a},module$exports$Blockly$Block.Block.prototype.setOnChange=function(a){if(a&&"function"!=typeof a)throw Error("onchange must be a function.");this.onchangeWrapper_&&this.workspace.removeChangeListener(this.onchangeWrapper_),(this.onchange=a)&&(this.onchangeWrapper_=a.bind(this),this.workspace.addChangeListener(this.onchangeWrapper_))},module$exports$Blockly$Block.Block.prototype.getField=function(a){if("string"!=typeof a)throw TypeError("Block.prototype.getField expects a string with the field name but received "+(void 0===a?"nothing":a+" of type "+typeof a)+" instead");for(var c,b=0;c=this.inputList[b];b++)for(var e,d=0;e=c.fieldRow[d];d++)if(e.name===a)return e;return null},module$exports$Blockly$Block.Block.prototype.getVars=function(){for(var c,a=[],b=0;c=this.inputList[b];b++)for(var e,d=0;e=c.fieldRow[d];d++)e.referencesVariables()&&a.push(e.getValue());return a},module$exports$Blockly$Block.Block.prototype.getVarModels=function(){for(var c,a=[],b=0;c=this.inputList[b];b++)for(var e,d=0;e=c.fieldRow[d];d++)e.referencesVariables()&&(e=this.workspace.getVariableById(e.getValue()))&&a.push(e);return a},module$exports$Blockly$Block.Block.prototype.updateVarName=function(a){for(var c,b=0;c=this.inputList[b];b++)for(var e,d=0;e=c.fieldRow[d];d++)e.referencesVariables()&&a.getId()===e.getValue()&&e.refreshVariableName()},module$exports$Blockly$Block.Block.prototype.renameVarById=function(a,b){for(var d,c=0;d=this.inputList[c];c++)for(var f,e=0;f=d.fieldRow[e];e++)f.referencesVariables()&&a===f.getValue()&&f.setValue(b)},module$exports$Blockly$Block.Block.prototype.getFieldValue=function(a){return(a=this.getField(a))?a.getValue():null},module$exports$Blockly$Block.Block.prototype.setFieldValue=function(a,b){var c=this.getField(b);if(!c)throw Error('Field "'+b+'" not found.');c.setValue(a)},module$exports$Blockly$Block.Block.prototype.setPreviousStatement=function(a,b){if(a)void 0===b&&(b=null),this.previousConnection||(this.previousConnection=this.makeConnection_($.module$exports$Blockly$ConnectionType.ConnectionType.PREVIOUS_STATEMENT)),this.previousConnection.setCheck(b);else if(this.previousConnection){if(this.previousConnection.isConnected())throw Error("Must disconnect previous statement before removing connection.");this.previousConnection.dispose(),this.previousConnection=null}},module$exports$Blockly$Block.Block.prototype.setNextStatement=function(a,b){if(a)void 0===b&&(b=null),this.nextConnection||(this.nextConnection=this.makeConnection_($.module$exports$Blockly$ConnectionType.ConnectionType.NEXT_STATEMENT)),this.nextConnection.setCheck(b);else if(this.nextConnection){if(this.nextConnection.isConnected())throw Error("Must disconnect next statement before removing connection.");this.nextConnection.dispose(),this.nextConnection=null}},module$exports$Blockly$Block.Block.prototype.setOutput=function(a,b){if(a)void 0===b&&(b=null),this.outputConnection||(this.outputConnection=this.makeConnection_($.module$exports$Blockly$ConnectionType.ConnectionType.OUTPUT_VALUE)),this.outputConnection.setCheck(b);else if(this.outputConnection){if(this.outputConnection.isConnected())throw Error("Must disconnect output value before removing connection.");this.outputConnection.dispose(),this.outputConnection=null}},module$exports$Blockly$Block.Block.prototype.setInputsInline=function(a){this.inputsInline!==a&&((0,module$exports$Blockly$Events$utils.fire)(new((0,module$exports$Blockly$Events$utils.get)(module$exports$Blockly$Events$utils.CHANGE))(this,"inline",null,this.inputsInline,a)),this.inputsInline=a)},module$exports$Blockly$Block.Block.prototype.getInputsInline=function(){if(void 0!==this.inputsInline)return this.inputsInline;for(var a=1;a<this.inputList.length;a++)if(this.inputList[a-1].type===$.module$exports$Blockly$inputTypes.inputTypes.DUMMY&&this.inputList[a].type===$.module$exports$Blockly$inputTypes.inputTypes.DUMMY)return!1;for(a=1;a<this.inputList.length;a++)if(this.inputList[a-1].type===$.module$exports$Blockly$inputTypes.inputTypes.VALUE&&this.inputList[a].type===$.module$exports$Blockly$inputTypes.inputTypes.DUMMY)return!0;return!1},module$exports$Blockly$Block.Block.prototype.setOutputShape=function(a){this.outputShape_=a},module$exports$Blockly$Block.Block.prototype.getOutputShape=function(){return this.outputShape_},module$exports$Blockly$Block.Block.prototype.isEnabled=function(){return!this.disabled},module$exports$Blockly$Block.Block.prototype.setEnabled=function(a){if(this.isEnabled()!==a){var b=this.disabled;this.disabled=!a,(0,module$exports$Blockly$Events$utils.fire)(new((0,module$exports$Blockly$Events$utils.get)(module$exports$Blockly$Events$utils.CHANGE))(this,"disabled",null,b,!a))}},module$exports$Blockly$Block.Block.prototype.getInheritedDisabled=function(){for(var a=this.getSurroundParent();a;){if(a.disabled)return!0;a=a.getSurroundParent()}return!1},module$exports$Blockly$Block.Block.prototype.isCollapsed=function(){return this.collapsed_},module$exports$Blockly$Block.Block.prototype.setCollapsed=function(a){this.collapsed_!==a&&((0,module$exports$Blockly$Events$utils.fire)(new((0,module$exports$Blockly$Events$utils.get)(module$exports$Blockly$Events$utils.CHANGE))(this,"collapsed",null,this.collapsed_,a)),this.collapsed_=a)},module$exports$Blockly$Block.Block.prototype.toString=function(a,b){function c(l){var m=l.getCheck();return!m&&l.targetConnection&&(m=l.targetConnection.getCheck()),!!m&&(-1!==m.indexOf("Boolean")||-1!==m.indexOf("Number"))}function d(){g&&g.getType()===h.getType()&&g.getLocation()===h.getLocation()&&(g=null)}var e=[];b=b||"?";var f=module$exports$Blockly$ASTNode.ASTNode.NAVIGATE_ALL_FIELDS;module$exports$Blockly$ASTNode.ASTNode.NAVIGATE_ALL_FIELDS=!0;for(var g=module$exports$Blockly$ASTNode.ASTNode.createBlockNode(this),h=g;g;){switch(g.getType()){case module$exports$Blockly$ASTNode.ASTNode.types.INPUT:var k=g.getLocation();g.in()?c(k)&&e.push("("):e.push(b);break;case module$exports$Blockly$ASTNode.ASTNode.types.FIELD:(k=g.getLocation()).name!==module$exports$Blockly$constants.COLLAPSED_FIELD_NAME&&e.push(k.getText())}if(!(g=(k=g).in()||k.next())){for(g=k.out(),d();g&&!g.next();)g=g.out(),d(),g&&g.getType()===module$exports$Blockly$ASTNode.ASTNode.types.INPUT&&c(g.getLocation())&&e.push(")");g&&(g=g.next())}}for(module$exports$Blockly$ASTNode.ASTNode.NAVIGATE_ALL_FIELDS=f,b=2;b<e.length;b++)"("===e[b-2]&&")"===e[b]&&(e[b-2]=e[b-1],e.splice(b-1,2));return e=(e=e.reduce((function(l,m){return l+("("===l.substr(-1)||")"===m?"":" ")+m}),"")).trim()||"???",a&&e.length>a&&(e=e.substring(0,a-3)+"..."),e},module$exports$Blockly$Block.Block.prototype.appendValueInput=function(a){return this.appendInput_($.module$exports$Blockly$inputTypes.inputTypes.VALUE,a)},module$exports$Blockly$Block.Block.prototype.appendStatementInput=function(a){return this.appendInput_($.module$exports$Blockly$inputTypes.inputTypes.STATEMENT,a)},module$exports$Blockly$Block.Block.prototype.appendDummyInput=function(a){return this.appendInput_($.module$exports$Blockly$inputTypes.inputTypes.DUMMY,a||"")},module$exports$Blockly$Block.Block.prototype.jsonInit=function(a){var b=a.type?'Block "'+a.type+'": ':"";if(a.output&&a.previousStatement)throw Error(b+"Must not have both an output and a previousStatement.");if(a.style&&a.style.hat&&(this.hat=a.style.hat,a.style=null),a.style&&a.colour)throw Error(b+"Must not have both a colour and a style.");a.style?this.jsonInitStyle_(a,b):this.jsonInitColour_(a,b);for(var c=0;void 0!==a["message"+c];)this.interpolate_(a["message"+c],a["args"+c]||[],a["lastDummyAlign"+c],b),c++;if(void 0!==a.inputsInline&&this.setInputsInline(a.inputsInline),void 0!==a.output&&this.setOutput(!0,a.output),void 0!==a.outputShape&&this.setOutputShape(a.outputShape),void 0!==a.previousStatement&&this.setPreviousStatement(!0,a.previousStatement),void 0!==a.nextStatement&&this.setNextStatement(!0,a.nextStatement),void 0!==a.tooltip&&(c=(0,module$exports$Blockly$utils$parsing.replaceMessageReferences)(a.tooltip),this.setTooltip(c)),void 0!==a.enableContextMenu&&(this.contextMenu=!!a.enableContextMenu),void 0!==a.suppressPrefixSuffix&&(this.suppressPrefixSuffix=!!a.suppressPrefixSuffix),void 0!==a.helpUrl&&(c=(0,module$exports$Blockly$utils$parsing.replaceMessageReferences)(a.helpUrl),this.setHelpUrl(c)),"string"==typeof a.extensions&&(console.warn(b+"JSON attribute 'extensions' should be an array of strings. Found raw string in JSON for '"+a.type+"' block."),a.extensions=[a.extensions]),void 0!==a.mutator&&(0,$.module$exports$Blockly$Extensions.apply)(a.mutator,this,!0),a=a.extensions,Array.isArray(a))for(b=0;b<a.length;b++)(0,$.module$exports$Blockly$Extensions.apply)(a[b],this,!1)},module$exports$Blockly$Block.Block.prototype.jsonInitColour_=function(a,b){if("colour"in a)if(void 0===a.colour)console.warn(b+"Undefined colour value.");else{a=a.colour;try{this.setColour(a)}catch(c){console.warn(b+"Illegal colour value: ",a)}}},module$exports$Blockly$Block.Block.prototype.jsonInitStyle_=function(a,b){a=a.style;try{this.setStyle(a)}catch(c){console.warn(b+"Style does not exist: ",a)}},module$exports$Blockly$Block.Block.prototype.mixin=function(a,b){if(void 0!==b&&"boolean"!=typeof b)throw Error("opt_disableCheck must be a boolean if provided");if(!b){for(var c in b=[],a)void 0!==this[c]&&b.push(c);if(b.length)throw Error("Mixin will overwrite block members: "+JSON.stringify(b))}(0,$.module$exports$Blockly$utils$object.mixin)(this,a)},module$exports$Blockly$Block.Block.prototype.interpolate_=function(a,b,c,d){a=(0,module$exports$Blockly$utils$parsing.tokenizeInterpolation)(a),this.validateTokens_(a,b.length),b=this.interpolateArguments_(a,b,c),c=[],a=0;for(var e;e=b[a];a++)if(this.isInputKeyword_(e.type)){if(e=this.inputFromJson_(e,d)){for(var g,f=0;g=c[f];f++)e.appendField(g[0],g[1]);c.length=0}}else(f=this.fieldFromJson_(e))&&c.push([f,e.name])},module$exports$Blockly$Block.Block.prototype.validateTokens_=function(a,b){for(var c=[],d=0,e=0;e<a.length;e++){var f=a[e];if("number"==typeof f){if(1>f||f>b)throw Error('Block "'+this.type+'": Message index %'+f+" out of range.");if(c[f])throw Error('Block "'+this.type+'": Message index %'+f+" duplicated.");c[f]=!0,d++}}if(d!==b)throw Error('Block "'+this.type+'": Message does not reference all '+b+" arg(s).")},module$exports$Blockly$Block.Block.prototype.interpolateArguments_=function(a,b,c){for(var d=[],e=0;e<a.length;e++){var f=a[e];"number"==typeof f&&(f=b[f-1]),("string"!=typeof f||(f=this.stringToFieldJson_(f)))&&d.push(f)}return(a=d.length)&&!this.isInputKeyword_(d[a-1].type)&&(a={type:"input_dummy"},c&&(a.align=c),d.push(a)),d},module$exports$Blockly$Block.Block.prototype.fieldFromJson_=function(a){var b=(0,module$exports$Blockly$fieldRegistry.fromJson)(a);return!b&&a.alt?"string"==typeof a.alt?(a=this.stringToFieldJson_(a.alt))?this.fieldFromJson_(a):null:this.fieldFromJson_(a.alt):b},module$exports$Blockly$Block.Block.prototype.inputFromJson_=function(a,b){var c={LEFT:$.module$exports$Blockly$Input.Align.LEFT,RIGHT:$.module$exports$Blockly$Input.Align.RIGHT,CENTRE:$.module$exports$Blockly$Input.Align.CENTRE,CENTER:$.module$exports$Blockly$Input.Align.CENTRE},d=null;switch(a.type){case"input_value":d=this.appendValueInput(a.name);break;case"input_statement":d=this.appendStatementInput(a.name);break;case"input_dummy":d=this.appendDummyInput(a.name)}return d?(a.check&&d.setCheck(a.check),a.align&&(void 0===(c=c[a.align.toUpperCase()])?console.warn(b+"Illegal align value: ",a.align):d.setAlign(c)),d):null},module$exports$Blockly$Block.Block.prototype.isInputKeyword_=function(a){return"input_value"===a||"input_statement"===a||"input_dummy"===a},module$exports$Blockly$Block.Block.prototype.stringToFieldJson_=function(a){return(a=a.trim())?{type:"field_label",text:a}:null},module$exports$Blockly$Block.Block.prototype.appendInput_=function(a,b){var c=null;return a!==$.module$exports$Blockly$inputTypes.inputTypes.VALUE&&a!==$.module$exports$Blockly$inputTypes.inputTypes.STATEMENT||(c=this.makeConnection_(a)),a===$.module$exports$Blockly$inputTypes.inputTypes.STATEMENT&&this.statementInputCount++,a=new $.module$exports$Blockly$Input.Input(a,b,this,c),this.inputList.push(a),a},module$exports$Blockly$Block.Block.prototype.moveInputBefore=function(a,b){if(a!==b){for(var f,c=-1,d=b?-1:this.inputList.length,e=0;f=this.inputList[e];e++)if(f.name===a){if(c=e,-1!==d)break}else if(b&&f.name===b&&(d=e,-1!==c))break;if(-1===c)throw Error('Named input "'+a+'" not found.');if(-1===d)throw Error('Reference input "'+b+'" not found.');this.moveNumberedInputBefore(c,d)}},module$exports$Blockly$Block.Block.prototype.moveNumberedInputBefore=function(a,b){if(a===b)throw Error("Can't move input to itself.");if(a>=this.inputList.length)throw RangeError("Input index "+a+" out of bounds.");if(b>this.inputList.length)throw RangeError("Reference input "+b+" out of bounds.");var c=this.inputList[a];this.inputList.splice(a,1),a<b&&b--,this.inputList.splice(b,0,c)},module$exports$Blockly$Block.Block.prototype.removeInput=function(a,b){for(var d,c=0;d=this.inputList[c];c++)if(d.name===a)return d.type===$.module$exports$Blockly$inputTypes.inputTypes.STATEMENT&&this.statementInputCount--,d.dispose(),this.inputList.splice(c,1),!0;if(b)return!1;throw Error("Input not found: "+a)},module$exports$Blockly$Block.Block.prototype.getInput=function(a){for(var c,b=0;c=this.inputList[b];b++)if(c.name===a)return c;return null},module$exports$Blockly$Block.Block.prototype.getInputTargetBlock=function(a){return(a=this.getInput(a))&&a.connection&&a.connection.targetBlock()},module$exports$Blockly$Block.Block.prototype.getCommentText=function(){return this.commentModel.text},module$exports$Blockly$Block.Block.prototype.setCommentText=function(a){this.commentModel.text!==a&&((0,module$exports$Blockly$Events$utils.fire)(new((0,module$exports$Blockly$Events$utils.get)(module$exports$Blockly$Events$utils.CHANGE))(this,"comment",null,this.commentModel.text,a)),this.comment=this.commentModel.text=a)},module$exports$Blockly$Block.Block.prototype.setWarningText=function(a,b){},module$exports$Blockly$Block.Block.prototype.setMutator=function(a){},module$exports$Blockly$Block.Block.prototype.getRelativeToSurfaceXY=function(){return this.xy_},module$exports$Blockly$Block.Block.prototype.moveBy=function(a,b){if(this.parentBlock_)throw Error("Block has parent.");var c=new((0,module$exports$Blockly$Events$utils.get)(module$exports$Blockly$Events$utils.MOVE))(this);this.xy_.translate(a,b),c.recordNew(),(0,module$exports$Blockly$Events$utils.fire)(c)},module$exports$Blockly$Block.Block.prototype.makeConnection_=function(a){return new module$exports$Blockly$Connection.Connection(this,a)},module$exports$Blockly$Block.Block.prototype.allInputsFilled=function(a){if(void 0===a&&(a=!0),!a&&this.isShadow())return!1;for(var c,b=0;c=this.inputList[b];b++)if(c.connection&&(!(c=c.connection.targetBlock())||!c.allInputsFilled(a)))return!1;return!(b=this.getNextBlock())||b.allInputsFilled(a)},module$exports$Blockly$Block.Block.prototype.toDevString=function(){var a=this.type?'"'+this.type+'" block':"Block";return this.id&&(a+=' (id="'+this.id+'")'),a};var module$exports$Blockly$ContextMenuRegistry={ContextMenuRegistry:function(){module$exports$Blockly$ContextMenuRegistry.ContextMenuRegistry.registry=this,this.registry_=Object.create(null)}};module$exports$Blockly$ContextMenuRegistry.ContextMenuRegistry.ScopeType={BLOCK:"block",WORKSPACE:"workspace"},module$exports$Blockly$ContextMenuRegistry.ContextMenuRegistry.registry=null,module$exports$Blockly$ContextMenuRegistry.ContextMenuRegistry.prototype.register=function(a){if(this.registry_[a.id])throw Error('Menu item with ID "'+a.id+'" is already registered.');this.registry_[a.id]=a},module$exports$Blockly$ContextMenuRegistry.ContextMenuRegistry.prototype.unregister=function(a){if(!this.registry_[a])throw Error('Menu item with ID "'+a+'" not found.');delete this.registry_[a]},module$exports$Blockly$ContextMenuRegistry.ContextMenuRegistry.prototype.getItem=function(a){return this.registry_[a]||null},module$exports$Blockly$ContextMenuRegistry.ContextMenuRegistry.prototype.getContextMenuOptions=function(a,b){var c=[],d=this.registry_;return Object.keys(d).forEach((function(e){if(e=d[e],a===e.scopeType){var f=e.preconditionFn(b);"hidden"!==f&&(e={text:"function"==typeof e.displayText?e.displayText(b):e.displayText,enabled:"enabled"===f,callback:e.callback,scope:b,weight:e.weight},c.push(e))}})),c.sort((function(e,f){return e.weight-f.weight})),c},new module$exports$Blockly$ContextMenuRegistry.ContextMenuRegistry;var module$exports$Blockly$RenderedConnection={RenderedConnection:function(a,b){module$exports$Blockly$RenderedConnection.RenderedConnection.superClass_.constructor.call(this,a,b),this.db_=a.workspace.connectionDBList[b],this.dbOpposite_=a.workspace.connectionDBList[$.module$exports$Blockly$internalConstants.OPPOSITE_TYPE[b]],this.offsetInBlock_=new module$exports$Blockly$utils$Coordinate.Coordinate(0,0),this.trackedState_=module$exports$Blockly$RenderedConnection.RenderedConnection.TrackedState.WILL_TRACK,this.targetConnection=null}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$RenderedConnection.RenderedConnection,module$exports$Blockly$Connection.Connection),module$exports$Blockly$RenderedConnection.RenderedConnection.TrackedState={WILL_TRACK:-1,UNTRACKED:0,TRACKED:1},module$exports$Blockly$RenderedConnection.RenderedConnection.prototype.dispose=function(){module$exports$Blockly$RenderedConnection.RenderedConnection.superClass_.dispose.call(this),this.trackedState_===module$exports$Blockly$RenderedConnection.RenderedConnection.TrackedState.TRACKED&&this.db_.removeConnection(this,this.y)},module$exports$Blockly$RenderedConnection.RenderedConnection.prototype.getSourceBlock=function(){return module$exports$Blockly$RenderedConnection.RenderedConnection.superClass_.getSourceBlock.call(this)},module$exports$Blockly$RenderedConnection.RenderedConnection.prototype.targetBlock=function(){return module$exports$Blockly$RenderedConnection.RenderedConnection.superClass_.targetBlock.call(this)},module$exports$Blockly$RenderedConnection.RenderedConnection.prototype.distanceFrom=function(a){var b=this.x-a.x;return a=this.y-a.y,Math.sqrt(b*b+a*a)},module$exports$Blockly$RenderedConnection.RenderedConnection.prototype.bumpAwayFrom=function(a){if(!this.sourceBlock_.workspace.isDragging()){var b=this.sourceBlock_.getRootBlock();if(!b.isInFlyout){var c=!1;if(!b.isMovable()){if(!(b=a.getSourceBlock().getRootBlock()).isMovable())return;a=this,c=!0}var d=(0,$.module$exports$Blockly$common.getSelected)()==b;d||b.addSelect();var e=a.x+$.module$exports$Blockly$internalConstants.SNAP_RADIUS+Math.floor(Math.random()*$.module$exports$Blockly$internalConstants.BUMP_RANDOMNESS)-this.x,f=a.y+$.module$exports$Blockly$internalConstants.SNAP_RADIUS+Math.floor(Math.random()*$.module$exports$Blockly$internalConstants.BUMP_RANDOMNESS)-this.y;c&&(f=-f),b.RTL&&(e=a.x-$.module$exports$Blockly$internalConstants.SNAP_RADIUS-Math.floor(Math.random()*$.module$exports$Blockly$internalConstants.BUMP_RANDOMNESS)-this.x),b.moveBy(e,f),d||b.removeSelect()}}},module$exports$Blockly$RenderedConnection.RenderedConnection.prototype.moveTo=function(a,b){this.trackedState_===module$exports$Blockly$RenderedConnection.RenderedConnection.TrackedState.WILL_TRACK?(this.db_.addConnection(this,b),this.trackedState_=module$exports$Blockly$RenderedConnection.RenderedConnection.TrackedState.TRACKED):this.trackedState_===module$exports$Blockly$RenderedConnection.RenderedConnection.TrackedState.TRACKED&&(this.db_.removeConnection(this,this.y),this.db_.addConnection(this,b)),this.x=a,this.y=b},module$exports$Blockly$RenderedConnection.RenderedConnection.prototype.moveBy=function(a,b){this.moveTo(this.x+a,this.y+b)},module$exports$Blockly$RenderedConnection.RenderedConnection.prototype.moveToOffset=function(a){this.moveTo(a.x+this.offsetInBlock_.x,a.y+this.offsetInBlock_.y)},module$exports$Blockly$RenderedConnection.RenderedConnection.prototype.setOffsetInBlock=function(a,b){this.offsetInBlock_.x=a,this.offsetInBlock_.y=b},module$exports$Blockly$RenderedConnection.RenderedConnection.prototype.getOffsetInBlock=function(){return this.offsetInBlock_},module$exports$Blockly$RenderedConnection.RenderedConnection.prototype.tighten=function(){var a=this.targetConnection.x-this.x,b=this.targetConnection.y-this.y;if(0!==a||0!==b){var c=this.targetBlock(),d=c.getSvgRoot();if(!d)throw Error("block is not rendered.");d=(0,module$exports$Blockly$utils$svgMath.getRelativeXY)(d),c.getSvgRoot().setAttribute("transform","translate("+(d.x-a)+","+(d.y-b)+")"),c.moveConnections(-a,-b)}},module$exports$Blockly$RenderedConnection.RenderedConnection.prototype.closest=function(a,b){return this.dbOpposite_.searchForClosest(this,a,b)},module$exports$Blockly$RenderedConnection.RenderedConnection.prototype.highlight=function(){var a=this.sourceBlock_.workspace.getRenderer().getConstants(),b=a.shapeFor(this);this.type===$.module$exports$Blockly$ConnectionType.ConnectionType.INPUT_VALUE||this.type===$.module$exports$Blockly$ConnectionType.ConnectionType.OUTPUT_VALUE?(a=a.TAB_OFFSET_FROM_TOP,b=(0,module$exports$Blockly$utils$svgPaths.moveBy)(0,-a)+(0,module$exports$Blockly$utils$svgPaths.lineOnAxis)("v",a)+b.pathDown+(0,module$exports$Blockly$utils$svgPaths.lineOnAxis)("v",a)):(a=a.NOTCH_OFFSET_LEFT-a.CORNER_RADIUS,b=(0,module$exports$Blockly$utils$svgPaths.moveBy)(-a,0)+(0,module$exports$Blockly$utils$svgPaths.lineOnAxis)("h",a)+b.pathLeft+(0,module$exports$Blockly$utils$svgPaths.lineOnAxis)("h",a)),a=this.sourceBlock_.getRelativeToSurfaceXY(),module$exports$Blockly$Connection.Connection.highlightedPath_=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.PATH,{class:"blocklyHighlightedConnectionPath",d:b,transform:"translate("+(this.x-a.x)+","+(this.y-a.y)+")"+(this.sourceBlock_.RTL?" scale(-1 1)":"")},this.sourceBlock_.getSvgRoot())},module$exports$Blockly$RenderedConnection.RenderedConnection.prototype.unhighlight=function(){(0,module$exports$Blockly$utils$dom.removeNode)(module$exports$Blockly$Connection.Connection.highlightedPath_),delete module$exports$Blockly$Connection.Connection.highlightedPath_},module$exports$Blockly$RenderedConnection.RenderedConnection.prototype.setTracking=function(a){a&&this.trackedState_===module$exports$Blockly$RenderedConnection.RenderedConnection.TrackedState.TRACKED||!a&&this.trackedState_===module$exports$Blockly$RenderedConnection.RenderedConnection.TrackedState.UNTRACKED||this.sourceBlock_.isInFlyout||(a?(this.db_.addConnection(this,this.y),this.trackedState_=module$exports$Blockly$RenderedConnection.RenderedConnection.TrackedState.TRACKED):(this.trackedState_===module$exports$Blockly$RenderedConnection.RenderedConnection.TrackedState.TRACKED&&this.db_.removeConnection(this,this.y),this.trackedState_=module$exports$Blockly$RenderedConnection.RenderedConnection.TrackedState.UNTRACKED))},module$exports$Blockly$RenderedConnection.RenderedConnection.prototype.stopTrackingAll=function(){if(this.setTracking(!1),this.targetConnection)for(var a=this.targetBlock().getDescendants(!1),b=0;b<a.length;b++){for(var c=a[b],d=c.getConnections_(!0),e=0;e<d.length;e++)d[e].setTracking(!1);for(c=c.getIcons(),d=0;d<c.length;d++)c[d].setVisible(!1)}},module$exports$Blockly$RenderedConnection.RenderedConnection.prototype.startTrackingAll=function(){this.setTracking(!0);var a=[];if(this.type!==$.module$exports$Blockly$ConnectionType.ConnectionType.INPUT_VALUE&&this.type!==$.module$exports$Blockly$ConnectionType.ConnectionType.NEXT_STATEMENT)return a;var b=this.targetBlock();if(b){if(b.isCollapsed()){var c=[];b.outputConnection&&c.push(b.outputConnection),b.nextConnection&&c.push(b.nextConnection),b.previousConnection&&c.push(b.previousConnection)}else c=b.getConnections_(!0);for(var d=0;d<c.length;d++)a.push.apply(a,c[d].startTrackingAll());a.length||(a=[b])}return a},module$exports$Blockly$RenderedConnection.RenderedConnection.prototype.onFailedConnect=function(a){var b=this.getSourceBlock();if((0,module$exports$Blockly$Events$utils.getRecordUndo)()){var c=(0,module$exports$Blockly$Events$utils.getGroup)();setTimeout(function(){b.isDisposed()||b.getParent()||((0,module$exports$Blockly$Events$utils.setGroup)(c),this.bumpAwayFrom(a),(0,module$exports$Blockly$Events$utils.setGroup)(!1))}.bind(this),$.module$exports$Blockly$internalConstants.BUMP_DELAY)}},module$exports$Blockly$RenderedConnection.RenderedConnection.prototype.disconnectInternal_=function(a,b){module$exports$Blockly$RenderedConnection.RenderedConnection.superClass_.disconnectInternal_.call(this,a,b),a.rendered&&a.render(),b.rendered&&(b.updateDisabled(),b.render(),b.getSvgRoot().style.display="block")},module$exports$Blockly$RenderedConnection.RenderedConnection.prototype.respawnShadow_=function(){module$exports$Blockly$RenderedConnection.RenderedConnection.superClass_.respawnShadow_.call(this);var a=this.targetBlock();a&&(a.initSvg(),a.render(!1),(a=this.getSourceBlock()).rendered&&a.render())},module$exports$Blockly$RenderedConnection.RenderedConnection.prototype.neighbours=function(a){return this.dbOpposite_.getNeighbours(this,a)},module$exports$Blockly$RenderedConnection.RenderedConnection.prototype.connect_=function(a){module$exports$Blockly$RenderedConnection.RenderedConnection.superClass_.connect_.call(this,a);var b=this.getSourceBlock();a=a.getSourceBlock();var c=b.rendered,d=a.rendered;c&&b.updateDisabled(),d&&a.updateDisabled(),c&&d&&(this.type===$.module$exports$Blockly$ConnectionType.ConnectionType.NEXT_STATEMENT||this.type===$.module$exports$Blockly$ConnectionType.ConnectionType.PREVIOUS_STATEMENT?a.render():b.render()),(b=b.getInputWithBlock(a))&&(b=b.isVisible(),a.getSvgRoot().style.display=b?"block":"none")},module$exports$Blockly$RenderedConnection.RenderedConnection.prototype.onCheckChanged_=function(){!this.isConnected()||this.targetConnection&&this.getConnectionChecker().canConnect(this,this.targetConnection,!1)||((this.isSuperior()?this.targetBlock():this.sourceBlock_).unplug(),this.sourceBlock_.bumpNeighbours())};var module$exports$Blockly$Marker={Marker:function(){this.drawer_=this.curNode_=this.colour=null,this.type="marker"}};module$exports$Blockly$Marker.Marker.prototype.setDrawer=function(a){this.drawer_=a},module$exports$Blockly$Marker.Marker.prototype.getDrawer=function(){return this.drawer_},module$exports$Blockly$Marker.Marker.prototype.getCurNode=function(){return this.curNode_},module$exports$Blockly$Marker.Marker.prototype.setCurNode=function(a){var b=this.curNode_;this.curNode_=a,this.drawer_&&this.drawer_.draw(b,this.curNode_)},module$exports$Blockly$Marker.Marker.prototype.draw=function(){this.drawer_&&this.drawer_.draw(this.curNode_,this.curNode_)},module$exports$Blockly$Marker.Marker.prototype.hide=function(){this.drawer_&&this.drawer_.hide()},module$exports$Blockly$Marker.Marker.prototype.dispose=function(){this.getDrawer()&&this.getDrawer().dispose()};var module$exports$Blockly$Cursor={Cursor:function(){module$exports$Blockly$Cursor.Cursor.superClass_.constructor.call(this),this.type="cursor"}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$Cursor.Cursor,module$exports$Blockly$Marker.Marker),module$exports$Blockly$Cursor.Cursor.prototype.next=function(){var a=this.getCurNode();if(!a)return null;for(a=a.next();a&&a.next()&&(a.getType()===module$exports$Blockly$ASTNode.ASTNode.types.NEXT||a.getType()===module$exports$Blockly$ASTNode.ASTNode.types.BLOCK);)a=a.next();return a&&this.setCurNode(a),a},module$exports$Blockly$Cursor.Cursor.prototype.in=function(){var a=this.getCurNode();return a?(a.getType()!==module$exports$Blockly$ASTNode.ASTNode.types.PREVIOUS&&a.getType()!==module$exports$Blockly$ASTNode.ASTNode.types.OUTPUT||(a=a.next()),(a=a.in())&&this.setCurNode(a),a):null},module$exports$Blockly$Cursor.Cursor.prototype.prev=function(){var a=this.getCurNode();if(!a)return null;for(a=a.prev();a&&a.prev()&&(a.getType()===module$exports$Blockly$ASTNode.ASTNode.types.NEXT||a.getType()===module$exports$Blockly$ASTNode.ASTNode.types.BLOCK);)a=a.prev();return a&&this.setCurNode(a),a},module$exports$Blockly$Cursor.Cursor.prototype.out=function(){var a=this.getCurNode();return a?((a=a.out())&&a.getType()===module$exports$Blockly$ASTNode.ASTNode.types.BLOCK&&(a=a.prev()||a),a&&this.setCurNode(a),a):null},(0,module$exports$Blockly$registry.register)(module$exports$Blockly$registry.Type.CURSOR,module$exports$Blockly$registry.DEFAULT,module$exports$Blockly$Cursor.Cursor);var module$exports$Blockly$BasicCursor={BasicCursor:function(){module$exports$Blockly$BasicCursor.BasicCursor.superClass_.constructor.call(this)}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$BasicCursor.BasicCursor,module$exports$Blockly$Cursor.Cursor),module$exports$Blockly$BasicCursor.BasicCursor.registrationName="basicCursor",module$exports$Blockly$BasicCursor.BasicCursor.prototype.next=function(){var a=this.getCurNode();return a?((a=this.getNextNode_(a,this.validNode_))&&this.setCurNode(a),a):null},module$exports$Blockly$BasicCursor.BasicCursor.prototype.in=function(){return this.next()},module$exports$Blockly$BasicCursor.BasicCursor.prototype.prev=function(){var a=this.getCurNode();return a?((a=this.getPreviousNode_(a,this.validNode_))&&this.setCurNode(a),a):null},module$exports$Blockly$BasicCursor.BasicCursor.prototype.out=function(){return this.prev()},module$exports$Blockly$BasicCursor.BasicCursor.prototype.getNextNode_=function(a,b){if(!a)return null;var c=a.in()||a.next();return b(c)?c:c?this.getNextNode_(c,b):b(a=this.findSiblingOrParent_(a.out()))?a:a?this.getNextNode_(a,b):null},module$exports$Blockly$BasicCursor.BasicCursor.prototype.getPreviousNode_=function(a,b){if(!a)return null;var c=a.prev();return b(c=c?this.getRightMostChild_(c):a.out())?c:c?this.getPreviousNode_(c,b):null},module$exports$Blockly$BasicCursor.BasicCursor.prototype.validNode_=function(a){var b=!1;return(a=a&&a.getType())!==module$exports$Blockly$ASTNode.ASTNode.types.OUTPUT&&a!==module$exports$Blockly$ASTNode.ASTNode.types.INPUT&&a!==module$exports$Blockly$ASTNode.ASTNode.types.FIELD&&a!==module$exports$Blockly$ASTNode.ASTNode.types.NEXT&&a!==module$exports$Blockly$ASTNode.ASTNode.types.PREVIOUS&&a!==module$exports$Blockly$ASTNode.ASTNode.types.WORKSPACE||(b=!0),b},module$exports$Blockly$BasicCursor.BasicCursor.prototype.findSiblingOrParent_=function(a){if(!a)return null;var b=a.next();return b||this.findSiblingOrParent_(a.out())},module$exports$Blockly$BasicCursor.BasicCursor.prototype.getRightMostChild_=function(a){if(!a.in())return a;for(a=a.in();a.next();)a=a.next();return this.getRightMostChild_(a)},(0,module$exports$Blockly$registry.register)(module$exports$Blockly$registry.Type.CURSOR,module$exports$Blockly$BasicCursor.BasicCursor.registrationName,module$exports$Blockly$BasicCursor.BasicCursor);var module$exports$Blockly$TabNavigateCursor={TabNavigateCursor:function(){module$exports$Blockly$TabNavigateCursor.TabNavigateCursor.superClass_.constructor.call(this)}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$TabNavigateCursor.TabNavigateCursor,module$exports$Blockly$BasicCursor.BasicCursor),module$exports$Blockly$TabNavigateCursor.TabNavigateCursor.prototype.validNode_=function(a){var b=!1,c=a&&a.getType();return a&&(a=a.getLocation(),c===module$exports$Blockly$ASTNode.ASTNode.types.FIELD&&a&&a.isTabNavigable()&&a.isClickable()&&(b=!0)),b};var module$exports$Blockly$Events$Selected={Selected:function(a,b,c){module$exports$Blockly$Events$Selected.Selected.superClass_.constructor.call(this,c),this.oldElementId=a,this.newElementId=b}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$Events$Selected.Selected,module$exports$Blockly$Events$UiBase.UiBase),module$exports$Blockly$Events$Selected.Selected.prototype.type=module$exports$Blockly$Events$utils.SELECTED,module$exports$Blockly$Events$Selected.Selected.prototype.toJson=function(){var a=module$exports$Blockly$Events$Selected.Selected.superClass_.toJson.call(this);return a.oldElementId=this.oldElementId,a.newElementId=this.newElementId,a},module$exports$Blockly$Events$Selected.Selected.prototype.fromJson=function(a){module$exports$Blockly$Events$Selected.Selected.superClass_.fromJson.call(this,a),this.oldElementId=a.oldElementId,this.newElementId=a.newElementId},(0,module$exports$Blockly$registry.register)(module$exports$Blockly$registry.Type.EVENT,module$exports$Blockly$Events$utils.SELECTED,module$exports$Blockly$Events$Selected.Selected);var module$exports$Blockly$BlockSvg={BlockSvg:function(a,b,c){this.svgGroup_=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.G,{},null),this.svgGroup_.translate_="",this.style=a.getRenderer().getConstants().getBlockStyle(null),this.pathObject=a.getRenderer().makePathObject(this.svgGroup_,this.style),this.renderIsInProgress_=this.rendered=!1,this.workspace=a,this.previousConnection=this.nextConnection=this.outputConnection=null,this.useDragSurface_=(0,module$exports$Blockly$utils$svgMath.is3dSupported)()&&!!a.getBlockDragSurface();var d=this.pathObject.svgPath;d.tooltip=this,(0,module$exports$Blockly$Tooltip.bindMouseEvents)(d),module$exports$Blockly$BlockSvg.BlockSvg.superClass_.constructor.call(this,a,b,c),this.svgGroup_.dataset?this.svgGroup_.dataset.id=this.id:module$exports$Blockly$utils$userAgent.IE&&this.svgGroup_.setAttribute("data-id",this.id)}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$BlockSvg.BlockSvg,module$exports$Blockly$Block.Block),module$exports$Blockly$BlockSvg.BlockSvg.prototype.height=0,module$exports$Blockly$BlockSvg.BlockSvg.prototype.width=0,module$exports$Blockly$BlockSvg.BlockSvg.prototype.warningTextDb_=null,module$exports$Blockly$BlockSvg.BlockSvg.INLINE=-1,module$exports$Blockly$BlockSvg.BlockSvg.COLLAPSED_WARNING_ID="TEMP_COLLAPSED_WARNING_",module$exports$Blockly$BlockSvg.BlockSvg.prototype.initSvg=function(){if(!this.workspace.rendered)throw TypeError("Workspace is headless.");for(var b,a=0;b=this.inputList[a];a++)b.init();for(a=this.getIcons(),b=0;b<a.length;b++)a[b].createIcon();this.applyColour(),this.pathObject.updateMovable(this.isMovable()),a=this.getSvgRoot(),this.workspace.options.readOnly||this.eventsInit_||!a||(0,module$exports$Blockly$browserEvents.conditionalBind)(a,"mousedown",this,this.onMouseDown_),this.eventsInit_=!0,a.parentNode||this.workspace.getCanvas().appendChild(a)},module$exports$Blockly$BlockSvg.BlockSvg.prototype.getColourSecondary=function(){return this.style.colourSecondary},module$exports$Blockly$BlockSvg.BlockSvg.prototype.getColourTertiary=function(){return this.style.colourTertiary},module$exports$Blockly$BlockSvg.BlockSvg.prototype.select=function(){if(this.isShadow()&&this.getParent())this.getParent().select();else if((0,$.module$exports$Blockly$common.getSelected)()!==this){var a=null;if((0,$.module$exports$Blockly$common.getSelected)()){a=(0,$.module$exports$Blockly$common.getSelected)().id,(0,module$exports$Blockly$Events$utils.disable)();try{(0,$.module$exports$Blockly$common.getSelected)().unselect()}finally{(0,module$exports$Blockly$Events$utils.enable)()}}a=new((0,module$exports$Blockly$Events$utils.get)(module$exports$Blockly$Events$utils.SELECTED))(a,this.id,this.workspace.id),(0,module$exports$Blockly$Events$utils.fire)(a),(0,$.module$exports$Blockly$common.setSelected)(this),this.addSelect()}},module$exports$Blockly$BlockSvg.BlockSvg.prototype.unselect=function(){if((0,$.module$exports$Blockly$common.getSelected)()===this){var a=new((0,module$exports$Blockly$Events$utils.get)(module$exports$Blockly$Events$utils.SELECTED))(this.id,null,this.workspace.id);a.workspaceId=this.workspace.id,(0,module$exports$Blockly$Events$utils.fire)(a),(0,$.module$exports$Blockly$common.setSelected)(null),this.removeSelect()}},module$exports$Blockly$BlockSvg.BlockSvg.prototype.mutator=null,module$exports$Blockly$BlockSvg.BlockSvg.prototype.comment=null,module$exports$Blockly$BlockSvg.BlockSvg.prototype.commentIcon_=null,module$exports$Blockly$BlockSvg.BlockSvg.prototype.warning=null,module$exports$Blockly$BlockSvg.BlockSvg.prototype.getIcons=function(){var a=[];return this.mutator&&a.push(this.mutator),this.commentIcon_&&a.push(this.commentIcon_),this.warning&&a.push(this.warning),a},module$exports$Blockly$BlockSvg.BlockSvg.prototype.setParent=function(a){var b=this.parentBlock_;if(a!==b){(0,module$exports$Blockly$utils$dom.startTextWidthCache)(),module$exports$Blockly$BlockSvg.BlockSvg.superClass_.setParent.call(this,a),(0,module$exports$Blockly$utils$dom.stopTextWidthCache)();var c=this.getSvgRoot();if(!this.workspace.isClearing&&c){var d=this.getRelativeToSurfaceXY();a?(a.getSvgRoot().appendChild(c),a=this.getRelativeToSurfaceXY(),this.moveConnections(a.x-d.x,a.y-d.y)):b&&(this.workspace.getCanvas().appendChild(c),this.translate(d.x,d.y)),this.applyColour()}}},module$exports$Blockly$BlockSvg.BlockSvg.prototype.getRelativeToSurfaceXY=function(){var a=0,b=0,c=this.useDragSurface_?this.workspace.getBlockDragSurface().getGroup():null,d=this.getSvgRoot();if(d)do{var e=(0,module$exports$Blockly$utils$svgMath.getRelativeXY)(d);a+=e.x,b+=e.y,this.useDragSurface_&&this.workspace.getBlockDragSurface().getCurrentBlock()===d&&(a+=(e=this.workspace.getBlockDragSurface().getSurfaceTranslation()).x,b+=e.y),d=d.parentNode}while(d&&d!==this.workspace.getCanvas()&&d!==c);return new module$exports$Blockly$utils$Coordinate.Coordinate(a,b)},module$exports$Blockly$BlockSvg.BlockSvg.prototype.moveBy=function(a,b){if(this.parentBlock_)throw Error("Block has parent.");var d,c=(0,module$exports$Blockly$Events$utils.isEnabled)();c&&(d=new((0,module$exports$Blockly$Events$utils.get)(module$exports$Blockly$Events$utils.MOVE))(this));var e=this.getRelativeToSurfaceXY();this.translate(e.x+a,e.y+b),this.moveConnections(a,b),c&&(d.recordNew(),(0,module$exports$Blockly$Events$utils.fire)(d)),this.workspace.resizeContents()},module$exports$Blockly$BlockSvg.BlockSvg.prototype.translate=function(a,b){this.getSvgRoot().setAttribute("transform","translate("+a+","+b+")")},module$exports$Blockly$BlockSvg.BlockSvg.prototype.moveToDragSurface=function(){if(this.useDragSurface_){var a=this.getRelativeToSurfaceXY();this.clearTransformAttributes_(),this.workspace.getBlockDragSurface().translateSurface(a.x,a.y),(a=this.getSvgRoot())&&this.workspace.getBlockDragSurface().setBlocksAndShow(a)}},module$exports$Blockly$BlockSvg.BlockSvg.prototype.moveTo=function(a){var b=this.getRelativeToSurfaceXY();this.moveBy(a.x-b.x,a.y-b.y)},module$exports$Blockly$BlockSvg.BlockSvg.prototype.moveOffDragSurface=function(a){this.useDragSurface_&&(this.translate(a.x,a.y),this.workspace.getBlockDragSurface().clearAndHide(this.workspace.getCanvas()))},module$exports$Blockly$BlockSvg.BlockSvg.prototype.moveDuringDrag=function(a){this.useDragSurface_?this.workspace.getBlockDragSurface().translateSurface(a.x,a.y):(this.svgGroup_.translate_="translate("+a.x+","+a.y+")",this.svgGroup_.setAttribute("transform",this.svgGroup_.translate_+this.svgGroup_.skew_))},module$exports$Blockly$BlockSvg.BlockSvg.prototype.clearTransformAttributes_=function(){this.getSvgRoot().removeAttribute("transform")},module$exports$Blockly$BlockSvg.BlockSvg.prototype.snapToGrid=function(){if(this.workspace&&!this.workspace.isDragging()&&!this.getParent()&&!this.isInFlyout){var a=this.workspace.getGrid();if(a&&a.shouldSnap()){var b=a.getSpacing(),c=b/2,d=this.getRelativeToSurfaceXY();a=Math.round(Math.round((d.x-c)/b)*b+c-d.x),b=Math.round(Math.round((d.y-c)/b)*b+c-d.y),(a||b)&&this.moveBy(a,b)}}},module$exports$Blockly$BlockSvg.BlockSvg.prototype.getBoundingRectangle=function(){var a=this.getRelativeToSurfaceXY(),b=this.getHeightWidth();if(this.RTL)var c=a.x-b.width,d=a.x;else c=a.x,d=a.x+b.width;return new module$exports$Blockly$utils$Rect.Rect(a.y,a.y+b.height,c,d)},module$exports$Blockly$BlockSvg.BlockSvg.prototype.markDirty=function(){this.pathObject.constants=this.workspace.getRenderer().getConstants();for(var b,a=0;b=this.inputList[a];a++)b.markDirty()},module$exports$Blockly$BlockSvg.BlockSvg.prototype.setCollapsed=function(a){this.collapsed_!==a&&(module$exports$Blockly$BlockSvg.BlockSvg.superClass_.setCollapsed.call(this,a),a?this.rendered&&this.render():this.updateCollapsed_())},module$exports$Blockly$BlockSvg.BlockSvg.prototype.updateCollapsed_=function(){for(var e,a=this.isCollapsed(),b=module$exports$Blockly$constants.COLLAPSED_INPUT_NAME,c=module$exports$Blockly$constants.COLLAPSED_FIELD_NAME,d=0;e=this.inputList[d];d++)e.name!==b&&e.setVisible(!a);if(a){for(a=this.getIcons(),d=0;e=a[d];d++)e.setVisible(!1);a=this.toString($.module$exports$Blockly$internalConstants.COLLAPSE_CHARS),(d=this.getField(c))?d.setValue(a):(this.getInput(b)||this.appendDummyInput(b)).appendField(new $.module$exports$Blockly$FieldLabel.FieldLabel(a),c)}else this.updateDisabled(),this.removeInput(b)},module$exports$Blockly$BlockSvg.BlockSvg.prototype.tab=function(a,b){var c=new module$exports$Blockly$TabNavigateCursor.TabNavigateCursor;c.setCurNode(module$exports$Blockly$ASTNode.ASTNode.createFieldNode(a)),a=c.getCurNode(),b?c.next():c.prev(),(b=c.getCurNode())&&b!==a&&(b.getLocation().showEditor(),this.workspace.keyboardAccessibilityMode&&this.workspace.getCursor().setCurNode(b))},module$exports$Blockly$BlockSvg.BlockSvg.prototype.onMouseDown_=function(a){var b=this.workspace&&this.workspace.getGesture(a);b&&b.handleBlockStart(a,this)},module$exports$Blockly$BlockSvg.BlockSvg.prototype.showHelp=function(){var a="function"==typeof this.helpUrl?this.helpUrl():this.helpUrl;a&&window.open(a)},module$exports$Blockly$BlockSvg.BlockSvg.prototype.generateContextMenu=function(){if(this.workspace.options.readOnly||!this.contextMenu)return null;var a=module$exports$Blockly$ContextMenuRegistry.ContextMenuRegistry.registry.getContextMenuOptions(module$exports$Blockly$ContextMenuRegistry.ContextMenuRegistry.ScopeType.BLOCK,{block:this});return this.customContextMenu&&this.customContextMenu(a),a},module$exports$Blockly$BlockSvg.BlockSvg.prototype.showContextMenu=function(a){var b=this.generateContextMenu();b&&b.length&&((0,$.module$exports$Blockly$ContextMenu.show)(a,b,this.RTL),(0,$.module$exports$Blockly$ContextMenu.setCurrentBlock)(this))},module$exports$Blockly$BlockSvg.BlockSvg.prototype.moveConnections=function(a,b){if(this.rendered){for(var c=this.getConnections_(!1),d=0;d<c.length;d++)c[d].moveBy(a,b);for(c=this.getIcons(),d=0;d<c.length;d++)c[d].computeIconLocation();for(c=0;c<this.childBlocks_.length;c++)this.childBlocks_[c].moveConnections(a,b)}},module$exports$Blockly$BlockSvg.BlockSvg.prototype.setDragging=function(a){if(a){var b=this.getSvgRoot();b.translate_="",b.skew_="",$.module$exports$Blockly$common.draggingConnections.push.apply($.module$exports$Blockly$common.draggingConnections,$jscomp.arrayFromIterable(this.getConnections_(!0))),(0,module$exports$Blockly$utils$dom.addClass)(this.svgGroup_,"blocklyDragging")}else $.module$exports$Blockly$common.draggingConnections.length=0,(0,module$exports$Blockly$utils$dom.removeClass)(this.svgGroup_,"blocklyDragging");for(b=0;b<this.childBlocks_.length;b++)this.childBlocks_[b].setDragging(a)},module$exports$Blockly$BlockSvg.BlockSvg.prototype.setMovable=function(a){module$exports$Blockly$BlockSvg.BlockSvg.superClass_.setMovable.call(this,a),this.pathObject.updateMovable(a)},module$exports$Blockly$BlockSvg.BlockSvg.prototype.setEditable=function(a){module$exports$Blockly$BlockSvg.BlockSvg.superClass_.setEditable.call(this,a),a=this.getIcons();for(var b=0;b<a.length;b++)a[b].updateEditable()},module$exports$Blockly$BlockSvg.BlockSvg.prototype.setShadow=function(a){module$exports$Blockly$BlockSvg.BlockSvg.superClass_.setShadow.call(this,a),this.applyColour()},module$exports$Blockly$BlockSvg.BlockSvg.prototype.setInsertionMarker=function(a){this.isInsertionMarker_!==a&&(this.isInsertionMarker_=a)&&(this.setColour(this.workspace.getRenderer().getConstants().INSERTION_MARKER_COLOUR),this.pathObject.updateInsertionMarker(!0))},module$exports$Blockly$BlockSvg.BlockSvg.prototype.getSvgRoot=function(){return this.svgGroup_},module$exports$Blockly$BlockSvg.BlockSvg.prototype.dispose=function(a,b){if(this.workspace){(0,module$exports$Blockly$Tooltip.dispose)(),(0,module$exports$Blockly$Tooltip.unbindMouseEvents)(this.pathObject.svgPath),(0,module$exports$Blockly$utils$dom.startTextWidthCache)();var c=this.workspace;if((0,$.module$exports$Blockly$common.getSelected)()===this&&(this.unselect(),this.workspace.cancelCurrentGesture()),(0,$.module$exports$Blockly$ContextMenu.getCurrentBlock)()===this&&(0,$.module$exports$Blockly$ContextMenu.hide)(),b&&this.rendered&&(this.unplug(a),(0,module$exports$Blockly$blockAnimations.disposeUiEffect)(this)),this.rendered=!1,this.warningTextDb_){for(var d in this.warningTextDb_)clearTimeout(this.warningTextDb_[d]);this.warningTextDb_=null}for(b=this.getIcons(),d=0;d<b.length;d++)b[d].dispose();module$exports$Blockly$BlockSvg.BlockSvg.superClass_.dispose.call(this,!!a),(0,module$exports$Blockly$utils$dom.removeNode)(this.svgGroup_),c.resizeContents(),this.svgGroup_=null,(0,module$exports$Blockly$utils$dom.stopTextWidthCache)()}},module$exports$Blockly$BlockSvg.BlockSvg.prototype.checkAndDelete=function(){this.workspace.isFlyout||((0,module$exports$Blockly$Events$utils.setGroup)(!0),this.workspace.hideChaff(),this.outputConnection?this.dispose(!1,!0):this.dispose(!0,!0),(0,module$exports$Blockly$Events$utils.setGroup)(!1))},module$exports$Blockly$BlockSvg.BlockSvg.prototype.toCopyData=function(){return this.isInsertionMarker_?null:{saveInfo:(0,module$exports$Blockly$serialization$blocks.save)(this,{addCoordinates:!0,addNextBlocks:!1}),source:this.workspace,typeCounts:(0,$.module$exports$Blockly$common.getBlockTypeCounts)(this,!0)}},module$exports$Blockly$BlockSvg.BlockSvg.prototype.applyColour=function(){this.pathObject.applyColour(this);for(var a=this.getIcons(),b=0;b<a.length;b++)a[b].applyColour();for(a=0;b=this.inputList[a];a++)for(var d,c=0;d=b.fieldRow[c];c++)d.applyColour()},module$exports$Blockly$BlockSvg.BlockSvg.prototype.updateDisabled=function(){var a=this.getChildren(!1);if(this.applyColour(),!this.isCollapsed())for(var c,b=0;c=a[b];b++)c.rendered&&c.updateDisabled()},module$exports$Blockly$BlockSvg.BlockSvg.prototype.getCommentIcon=function(){return this.commentIcon_},module$exports$Blockly$BlockSvg.BlockSvg.prototype.setCommentText=function(a){var b=module$exports$Blockly$Comment.Comment;if(!b)throw Error("Missing require for Blockly.Comment");this.commentModel.text!==a&&(module$exports$Blockly$BlockSvg.BlockSvg.superClass_.setCommentText.call(this,a),a=null!==a,!!this.commentIcon_===a?this.commentIcon_.updateText():(a?this.comment=this.commentIcon_=new b(this):(this.commentIcon_.dispose(),this.comment=this.commentIcon_=null),this.rendered&&(this.render(),this.bumpNeighbours())))},module$exports$Blockly$BlockSvg.BlockSvg.prototype.setWarningText=function(a,b){var c=module$exports$Blockly$Warning.Warning;if(!c)throw Error("Missing require for Blockly.Warning");this.warningTextDb_||(this.warningTextDb_=Object.create(null));var d=b||"";if(d)this.warningTextDb_[d]&&(clearTimeout(this.warningTextDb_[d]),delete this.warningTextDb_[d]);else for(var e=(b=$jscomp.makeIterator(Object.keys(this.warningTextDb_))).next();!e.done;e=b.next())e=e.value,clearTimeout(this.warningTextDb_[e]),delete this.warningTextDb_[e];if(this.workspace.isDragging()){var f=this;this.warningTextDb_[d]=setTimeout((function(){f.workspace&&(delete f.warningTextDb_[d],f.setWarningText(a,d))}),100)}else{if(this.isInFlyout&&(a=null),b=!1,"string"==typeof a){e=this.getSurroundParent();for(var g=null;e;)e.isCollapsed()&&(g=e),e=e.getSurroundParent();g&&g.setWarningText($.module$exports$Blockly$Msg.Msg.COLLAPSED_WARNINGS_WARNING,module$exports$Blockly$BlockSvg.BlockSvg.COLLAPSED_WARNING_ID),this.warning||(this.warning=new c(this),b=!0),this.warning.setText(a,d)}else this.warning&&!d?(this.warning.dispose(),b=!0):this.warning&&(c=this.warning.getText(),this.warning.setText("",d),(b=this.warning.getText())||this.warning.dispose(),b=c!==b);b&&this.rendered&&(this.render(),this.bumpNeighbours())}},module$exports$Blockly$BlockSvg.BlockSvg.prototype.setMutator=function(a){this.mutator&&this.mutator!==a&&this.mutator.dispose(),a&&(a.setBlock(this),this.mutator=a,a.createIcon()),this.rendered&&(this.render(),this.bumpNeighbours())},module$exports$Blockly$BlockSvg.BlockSvg.prototype.setEnabled=function(a){this.isEnabled()!==a&&(module$exports$Blockly$BlockSvg.BlockSvg.superClass_.setEnabled.call(this,a),this.rendered&&!this.getInheritedDisabled()&&this.updateDisabled())},module$exports$Blockly$BlockSvg.BlockSvg.prototype.setHighlighted=function(a){this.rendered&&this.pathObject.updateHighlighted(a)},module$exports$Blockly$BlockSvg.BlockSvg.prototype.addSelect=function(){this.pathObject.updateSelected(!0)},module$exports$Blockly$BlockSvg.BlockSvg.prototype.removeSelect=function(){this.pathObject.updateSelected(!1)},module$exports$Blockly$BlockSvg.BlockSvg.prototype.setDeleteStyle=function(a){this.pathObject.updateDraggingDelete(a)},module$exports$Blockly$BlockSvg.BlockSvg.prototype.getColour=function(){return this.style.colourPrimary},module$exports$Blockly$BlockSvg.BlockSvg.prototype.setColour=function(a){module$exports$Blockly$BlockSvg.BlockSvg.superClass_.setColour.call(this,a),a=this.workspace.getRenderer().getConstants().getBlockStyleForColour(this.colour_),this.pathObject.setStyle(a.style),this.style=a.style,this.styleName_=a.name,this.applyColour()},module$exports$Blockly$BlockSvg.BlockSvg.prototype.setStyle=function(a){var b=this.workspace.getRenderer().getConstants().getBlockStyle(a);if(this.styleName_=a,!b)throw Error("Invalid style name: "+a);this.hat=b.hat,this.pathObject.setStyle(b),this.colour_=b.colourPrimary,this.style=b,this.applyColour()},module$exports$Blockly$BlockSvg.BlockSvg.prototype.bringToFront=function(){var a=this;do{var b=a.getSvgRoot(),c=b.parentNode,d=c.childNodes;d[d.length-1]!==b&&c.appendChild(b),a=a.getParent()}while(a)},module$exports$Blockly$BlockSvg.BlockSvg.prototype.setPreviousStatement=function(a,b){module$exports$Blockly$BlockSvg.BlockSvg.superClass_.setPreviousStatement.call(this,a,b),this.rendered&&(this.render(),this.bumpNeighbours())},module$exports$Blockly$BlockSvg.BlockSvg.prototype.setNextStatement=function(a,b){module$exports$Blockly$BlockSvg.BlockSvg.superClass_.setNextStatement.call(this,a,b),this.rendered&&(this.render(),this.bumpNeighbours())},module$exports$Blockly$BlockSvg.BlockSvg.prototype.setOutput=function(a,b){module$exports$Blockly$BlockSvg.BlockSvg.superClass_.setOutput.call(this,a,b),this.rendered&&(this.render(),this.bumpNeighbours())},module$exports$Blockly$BlockSvg.BlockSvg.prototype.setInputsInline=function(a){module$exports$Blockly$BlockSvg.BlockSvg.superClass_.setInputsInline.call(this,a),this.rendered&&(this.render(),this.bumpNeighbours())},module$exports$Blockly$BlockSvg.BlockSvg.prototype.removeInput=function(a,b){return a=module$exports$Blockly$BlockSvg.BlockSvg.superClass_.removeInput.call(this,a,b),this.rendered&&(this.render(),this.bumpNeighbours()),a},module$exports$Blockly$BlockSvg.BlockSvg.prototype.moveNumberedInputBefore=function(a,b){module$exports$Blockly$BlockSvg.BlockSvg.superClass_.moveNumberedInputBefore.call(this,a,b),this.rendered&&(this.render(),this.bumpNeighbours())},module$exports$Blockly$BlockSvg.BlockSvg.prototype.appendInput_=function(a,b){return a=module$exports$Blockly$BlockSvg.BlockSvg.superClass_.appendInput_.call(this,a,b),this.rendered&&(this.render(),this.bumpNeighbours()),a},module$exports$Blockly$BlockSvg.BlockSvg.prototype.setConnectionTracking=function(a){if(this.previousConnection&&this.previousConnection.setTracking(a),this.outputConnection&&this.outputConnection.setTracking(a),this.nextConnection){this.nextConnection.setTracking(a);var b=this.nextConnection.targetBlock();b&&b.setConnectionTracking(a)}if(!this.collapsed_)for(b=0;b<this.inputList.length;b++){var c=this.inputList[b].connection;c&&(c.setTracking(a),(c=c.targetBlock())&&c.setConnectionTracking(a))}},module$exports$Blockly$BlockSvg.BlockSvg.prototype.getConnections_=function(a){var b=[];if((a||this.rendered)&&(this.outputConnection&&b.push(this.outputConnection),this.previousConnection&&b.push(this.previousConnection),this.nextConnection&&b.push(this.nextConnection),a||!this.collapsed_)){a=0;for(var c;c=this.inputList[a];a++)c.connection&&b.push(c.connection)}return b},module$exports$Blockly$BlockSvg.BlockSvg.prototype.lastConnectionInStack=function(a){return module$exports$Blockly$BlockSvg.BlockSvg.superClass_.lastConnectionInStack.call(this,a)},module$exports$Blockly$BlockSvg.BlockSvg.prototype.getMatchingConnection=function(a,b){return module$exports$Blockly$BlockSvg.BlockSvg.superClass_.getMatchingConnection.call(this,a,b)},module$exports$Blockly$BlockSvg.BlockSvg.prototype.makeConnection_=function(a){return new module$exports$Blockly$RenderedConnection.RenderedConnection(this,a)},module$exports$Blockly$BlockSvg.BlockSvg.prototype.bumpNeighbours=function(){if(this.workspace&&!this.workspace.isDragging()){var a=this.getRootBlock();if(!a.isInFlyout)for(var d,b=this.getConnections_(!1),c=0;d=b[c];c++){d.isConnected()&&d.isSuperior()&&d.targetBlock().bumpNeighbours();for(var g,e=d.neighbours($.module$exports$Blockly$internalConstants.SNAP_RADIUS),f=0;g=e[f];f++)d.isConnected()&&g.isConnected()||g.getSourceBlock().getRootBlock()!==a&&(d.isSuperior()?g.bumpAwayFrom(d):d.bumpAwayFrom(g))}}},module$exports$Blockly$BlockSvg.BlockSvg.prototype.scheduleSnapAndBump=function(){var a=this,b=(0,module$exports$Blockly$Events$utils.getGroup)();setTimeout((function(){(0,module$exports$Blockly$Events$utils.setGroup)(b),a.snapToGrid(),(0,module$exports$Blockly$Events$utils.setGroup)(!1)}),$.module$exports$Blockly$internalConstants.BUMP_DELAY/2),setTimeout((function(){(0,module$exports$Blockly$Events$utils.setGroup)(b),a.bumpNeighbours(),(0,module$exports$Blockly$Events$utils.setGroup)(!1)}),$.module$exports$Blockly$internalConstants.BUMP_DELAY)},module$exports$Blockly$BlockSvg.BlockSvg.prototype.positionNearConnection=function(a,b){a.type!==$.module$exports$Blockly$ConnectionType.ConnectionType.NEXT_STATEMENT&&a.type!==$.module$exports$Blockly$ConnectionType.ConnectionType.INPUT_VALUE||this.moveBy(b.x-a.x,b.y-a.y)},module$exports$Blockly$BlockSvg.BlockSvg.prototype.getParent=function(){return module$exports$Blockly$BlockSvg.BlockSvg.superClass_.getParent.call(this)},module$exports$Blockly$BlockSvg.BlockSvg.prototype.getRootBlock=function(){return module$exports$Blockly$BlockSvg.BlockSvg.superClass_.getRootBlock.call(this)},module$exports$Blockly$BlockSvg.BlockSvg.prototype.render=function(a){if(!this.renderIsInProgress_){this.renderIsInProgress_=!0;try{if(this.rendered=!0,(0,module$exports$Blockly$utils$dom.startTextWidthCache)(),this.isCollapsed()&&this.updateCollapsed_(),this.workspace.getRenderer().render(this),this.updateConnectionLocations_(),!1!==a){var b=this.getParent();b?b.render(!0):this.workspace.resizeContents()}(0,module$exports$Blockly$utils$dom.stopTextWidthCache)(),this.updateMarkers_()}finally{this.renderIsInProgress_=!1}}},module$exports$Blockly$BlockSvg.BlockSvg.prototype.updateMarkers_=function(){this.workspace.keyboardAccessibilityMode&&this.pathObject.cursorSvg&&this.workspace.getCursor().draw(),this.workspace.keyboardAccessibilityMode&&this.pathObject.markerSvg&&this.workspace.getMarker(module$exports$Blockly$MarkerManager.MarkerManager.LOCAL_MARKER).draw()},module$exports$Blockly$BlockSvg.BlockSvg.prototype.updateConnectionLocations_=function(){var a=this.getRelativeToSurfaceXY();this.previousConnection&&this.previousConnection.moveToOffset(a),this.outputConnection&&this.outputConnection.moveToOffset(a);for(var b=0;b<this.inputList.length;b++){var c=this.inputList[b].connection;c&&(c.moveToOffset(a),c.isConnected()&&c.tighten())}this.nextConnection&&(this.nextConnection.moveToOffset(a),this.nextConnection.isConnected()&&this.nextConnection.tighten())},module$exports$Blockly$BlockSvg.BlockSvg.prototype.setCursorSvg=function(a){this.pathObject.setCursorSvg(a)},module$exports$Blockly$BlockSvg.BlockSvg.prototype.setMarkerSvg=function(a){this.pathObject.setMarkerSvg(a)},module$exports$Blockly$BlockSvg.BlockSvg.prototype.getHeightWidth=function(){var a=this.height,b=this.width,c=this.getNextBlock();if(c){c=c.getHeightWidth();var d=this.workspace.getRenderer().getConstants().NOTCH_HEIGHT;a+=c.height-d,b=Math.max(b,c.width)}return{height:a,width:b}},module$exports$Blockly$BlockSvg.BlockSvg.prototype.fadeForReplacement=function(a){this.pathObject.updateReplacementFade(a)},module$exports$Blockly$BlockSvg.BlockSvg.prototype.highlightShapeForInput=function(a,b){this.pathObject.updateShapeForInputHighlight(a,b)};var module$exports$Blockly$ConnectionDB={ConnectionDB:function(a){this.connections_=[],this.connectionChecker_=a}};module$exports$Blockly$ConnectionDB.ConnectionDB.prototype.addConnection=function(a,b){b=this.calculateIndexForYPos_(b),this.connections_.splice(b,0,a)},module$exports$Blockly$ConnectionDB.ConnectionDB.prototype.findIndexOfConnection_=function(a,b){if(!this.connections_.length)return-1;var c=this.calculateIndexForYPos_(b);if(c>=this.connections_.length)return-1;b=a.y;for(var d=c;0<=d&&this.connections_[d].y===b;){if(this.connections_[d]===a)return d;d--}for(d=c;d<this.connections_.length&&this.connections_[d].y===b;){if(this.connections_[d]===a)return d;d++}return-1},module$exports$Blockly$ConnectionDB.ConnectionDB.prototype.calculateIndexForYPos_=function(a){if(!this.connections_.length)return 0;for(var b=0,c=this.connections_.length;b<c;){var d=Math.floor((b+c)/2);if(this.connections_[d].y<a)b=d+1;else{if(!(this.connections_[d].y>a)){b=d;break}c=d}}return b},module$exports$Blockly$ConnectionDB.ConnectionDB.prototype.removeConnection=function(a,b){if(-1===(a=this.findIndexOfConnection_(a,b)))throw Error("Unable to find connection in connectionDB.");this.connections_.splice(a,1)},module$exports$Blockly$ConnectionDB.ConnectionDB.prototype.getNeighbours=function(a,b){function c(l){var m=e-d[l].x,n=f-d[l].y;return Math.sqrt(m*m+n*n)<=b&&k.push(d[l]),n<b}var d=this.connections_,e=a.x,f=a.y;a=0;for(var g=d.length-2,h=g;a<h;)d[h].y<f?a=h:g=h,h=Math.floor((a+g)/2);var k=[];if(g=a=h,d.length){for(;0<=a&&c(a);)a--;do{g++}while(g<d.length&&c(g))}return k},module$exports$Blockly$ConnectionDB.ConnectionDB.prototype.isInYRange_=function(a,b,c){return Math.abs(this.connections_[a].y-b)<=c},module$exports$Blockly$ConnectionDB.ConnectionDB.prototype.searchForClosest=function(a,b,c){if(!this.connections_.length)return{connection:null,radius:b};var d=a.y,e=a.x;a.x=e+c.x,a.y=d+c.y;var f=this.calculateIndexForYPos_(a.y);c=null;for(var h,g=b,k=f-1;0<=k&&this.isInYRange_(k,a.y,b);)h=this.connections_[k],this.connectionChecker_.canConnect(a,h,!0,g)&&(c=h,g=h.distanceFrom(a)),k--;for(;f<this.connections_.length&&this.isInYRange_(f,a.y,b);)h=this.connections_[f],this.connectionChecker_.canConnect(a,h,!0,g)&&(c=h,g=h.distanceFrom(a)),f++;return a.x=e,a.y=d,{connection:c,radius:g}},module$exports$Blockly$ConnectionDB.ConnectionDB.init=function(a){var b=[];return b[$.module$exports$Blockly$ConnectionType.ConnectionType.INPUT_VALUE]=new module$exports$Blockly$ConnectionDB.ConnectionDB(a),b[$.module$exports$Blockly$ConnectionType.ConnectionType.OUTPUT_VALUE]=new module$exports$Blockly$ConnectionDB.ConnectionDB(a),b[$.module$exports$Blockly$ConnectionType.ConnectionType.NEXT_STATEMENT]=new module$exports$Blockly$ConnectionDB.ConnectionDB(a),b[$.module$exports$Blockly$ConnectionType.ConnectionType.PREVIOUS_STATEMENT]=new module$exports$Blockly$ConnectionDB.ConnectionDB(a),b};var module$exports$Blockly$ThemeManager={ThemeManager:function(a,b){this.workspace_=a,this.theme_=b,this.subscribedWorkspaces_=[],this.componentDB_=Object.create(null)}};module$exports$Blockly$ThemeManager.ThemeManager.prototype.getTheme=function(){return this.theme_},module$exports$Blockly$ThemeManager.ThemeManager.prototype.setTheme=function(a){var c,b=this.theme_;for(this.theme_=a,(a=this.workspace_.getInjectionDiv())&&(b&&(0,module$exports$Blockly$utils$dom.removeClass)(a,b.getClassName()),(0,module$exports$Blockly$utils$dom.addClass)(a,this.theme_.getClassName())),b=0;a=this.subscribedWorkspaces_[b];b++)a.refreshTheme();for(b=0,a=Object.keys(this.componentDB_);c=a[b];b++)for(var e,d=0;e=this.componentDB_[c][d];d++){var f=e.element;e=e.propertyName;var g=this.theme_&&this.theme_.getComponentStyle(c);f.style[e]=g||""}for(a=(b=$jscomp.makeIterator(this.subscribedWorkspaces_)).next();!a.done;a=b.next())a.value.hideChaff()},module$exports$Blockly$ThemeManager.ThemeManager.prototype.subscribeWorkspace=function(a){this.subscribedWorkspaces_.push(a)},module$exports$Blockly$ThemeManager.ThemeManager.prototype.unsubscribeWorkspace=function(a){if(!module$exports$Blockly$utils$array_removeElem(this.subscribedWorkspaces_,a))throw Error("Cannot unsubscribe a workspace that hasn't been subscribed.")},module$exports$Blockly$ThemeManager.ThemeManager.prototype.subscribe=function(a,b,c){this.componentDB_[b]||(this.componentDB_[b]=[]),this.componentDB_[b].push({element:a,propertyName:c}),b=this.theme_&&this.theme_.getComponentStyle(b),a.style[c]=b||""},module$exports$Blockly$ThemeManager.ThemeManager.prototype.unsubscribe=function(a){if(a)for(var d,b=Object.keys(this.componentDB_),c=0;d=b[c];c++){for(var e=this.componentDB_[d],f=e.length-1;0<=f;f--)e[f].element===a&&e.splice(f,1);this.componentDB_[d].length||delete this.componentDB_[d]}},module$exports$Blockly$ThemeManager.ThemeManager.prototype.dispose=function(){this.componentDB_=this.subscribedWorkspaces_=this.theme_=this.owner_=null};var module$exports$Blockly$TouchGesture={TouchGesture:function(a,b){module$exports$Blockly$TouchGesture.TouchGesture.superClass_.constructor.call(this,a,b),this.isMultiTouch_=!1,this.cachedPoints_=Object.create(null),this.startDistance_=this.previousScale_=0,this.isPinchZoomEnabled_=this.onStartWrapper_=null}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$TouchGesture.TouchGesture,module$exports$Blockly$Gesture.Gesture),module$exports$Blockly$TouchGesture.TouchGesture.ZOOM_IN_MULTIPLIER=5,module$exports$Blockly$TouchGesture.TouchGesture.ZOOM_OUT_MULTIPLIER=6,module$exports$Blockly$TouchGesture.TouchGesture.prototype.doStart=function(a){this.isPinchZoomEnabled_=this.startWorkspace_.options.zoomOptions&&this.startWorkspace_.options.zoomOptions.pinch,module$exports$Blockly$TouchGesture.TouchGesture.superClass_.doStart.call(this,a),!this.isEnding_&&(0,module$exports$Blockly$Touch.isTouchEvent)(a)&&this.handleTouchStart(a)},module$exports$Blockly$TouchGesture.TouchGesture.prototype.bindMouseEvents=function(a){this.onStartWrapper_=(0,module$exports$Blockly$browserEvents.conditionalBind)(document,"mousedown",null,this.handleStart.bind(this),!0),this.onMoveWrapper_=(0,module$exports$Blockly$browserEvents.conditionalBind)(document,"mousemove",null,this.handleMove.bind(this),!0),this.onUpWrapper_=(0,module$exports$Blockly$browserEvents.conditionalBind)(document,"mouseup",null,this.handleUp.bind(this),!0),a.preventDefault(),a.stopPropagation()},module$exports$Blockly$TouchGesture.TouchGesture.prototype.handleStart=function(a){!this.isDragging()&&(0,module$exports$Blockly$Touch.isTouchEvent)(a)&&(this.handleTouchStart(a),this.isMultiTouch()&&(0,module$exports$Blockly$Touch.longStop)())},module$exports$Blockly$TouchGesture.TouchGesture.prototype.handleMove=function(a){this.isDragging()?(0,module$exports$Blockly$Touch.shouldHandleEvent)(a)&&module$exports$Blockly$TouchGesture.TouchGesture.superClass_.handleMove.call(this,a):this.isMultiTouch()?((0,module$exports$Blockly$Touch.isTouchEvent)(a)&&this.handleTouchMove(a),(0,module$exports$Blockly$Touch.longStop)()):module$exports$Blockly$TouchGesture.TouchGesture.superClass_.handleMove.call(this,a)},module$exports$Blockly$TouchGesture.TouchGesture.prototype.handleUp=function(a){(0,module$exports$Blockly$Touch.isTouchEvent)(a)&&!this.isDragging()&&this.handleTouchEnd(a),!this.isMultiTouch()||this.isDragging()?(0,module$exports$Blockly$Touch.shouldHandleEvent)(a)&&module$exports$Blockly$TouchGesture.TouchGesture.superClass_.handleUp.call(this,a):(a.preventDefault(),a.stopPropagation(),this.dispose())},module$exports$Blockly$TouchGesture.TouchGesture.prototype.isMultiTouch=function(){return this.isMultiTouch_},module$exports$Blockly$TouchGesture.TouchGesture.prototype.dispose=function(){module$exports$Blockly$TouchGesture.TouchGesture.superClass_.dispose.call(this),this.onStartWrapper_&&(0,module$exports$Blockly$browserEvents.unbind)(this.onStartWrapper_)},module$exports$Blockly$TouchGesture.TouchGesture.prototype.handleTouchStart=function(a){var b=(0,module$exports$Blockly$Touch.getTouchIdentifierFromEvent)(a);this.cachedPoints_[b]=this.getTouchPoint(a),2===(b=Object.keys(this.cachedPoints_)).length&&(this.startDistance_=module$exports$Blockly$utils$Coordinate.Coordinate.distance(this.cachedPoints_[b[0]],this.cachedPoints_[b[1]]),this.isMultiTouch_=!0,a.preventDefault())},module$exports$Blockly$TouchGesture.TouchGesture.prototype.handleTouchMove=function(a){var b=(0,module$exports$Blockly$Touch.getTouchIdentifierFromEvent)(a);this.cachedPoints_[b]=this.getTouchPoint(a),b=Object.keys(this.cachedPoints_),this.isPinchZoomEnabled_&&2===b.length?this.handlePinch_(a):module$exports$Blockly$TouchGesture.TouchGesture.superClass_.handleMove.call(this,a)},module$exports$Blockly$TouchGesture.TouchGesture.prototype.handlePinch_=function(a){var b=Object.keys(this.cachedPoints_);if(b=module$exports$Blockly$utils$Coordinate.Coordinate.distance(this.cachedPoints_[b[0]],this.cachedPoints_[b[1]])/this.startDistance_,0<this.previousScale_&&1/0>this.previousScale_){var c=b-this.previousScale_;c=0<c?c*module$exports$Blockly$TouchGesture.TouchGesture.ZOOM_IN_MULTIPLIER:c*module$exports$Blockly$TouchGesture.TouchGesture.ZOOM_OUT_MULTIPLIER;var d=this.startWorkspace_,e=(0,module$exports$Blockly$browserEvents.mouseToSvg)(a,d.getParentSvg(),d.getInverseScreenCTM());d.zoom(e.x,e.y,c)}this.previousScale_=b,a.preventDefault()},module$exports$Blockly$TouchGesture.TouchGesture.prototype.handleTouchEnd=function(a){a=(0,module$exports$Blockly$Touch.getTouchIdentifierFromEvent)(a),this.cachedPoints_[a]&&delete this.cachedPoints_[a],2>Object.keys(this.cachedPoints_).length&&(this.cachedPoints_=Object.create(null),this.previousScale_=0)},module$exports$Blockly$TouchGesture.TouchGesture.prototype.getTouchPoint=function(a){return this.startWorkspace_?new module$exports$Blockly$utils$Coordinate.Coordinate(a.changedTouches?a.changedTouches[0].pageX:a.pageX,a.changedTouches?a.changedTouches[0].pageY:a.pageY):null};var module$exports$Blockly$WorkspaceAudio={WorkspaceAudio:function(a){this.parentWorkspace_=a,this.SOUNDS_=Object.create(null)}};module$exports$Blockly$WorkspaceAudio.WorkspaceAudio.prototype.lastSound_=null,module$exports$Blockly$WorkspaceAudio.WorkspaceAudio.prototype.dispose=function(){this.SOUNDS_=this.parentWorkspace_=null},module$exports$Blockly$WorkspaceAudio.WorkspaceAudio.prototype.load=function(a,b){if(a.length){try{var c=new $.module$exports$Blockly$utils$global.globalThis.Audio}catch(h){return}for(var d,e=0;e<a.length;e++){var f=a[e],g=f.match(/\.(\w+)$/);if(g&&c.canPlayType("audio/"+g[1])){d=new $.module$exports$Blockly$utils$global.globalThis.Audio(f);break}}d&&d.play&&(this.SOUNDS_[b]=d)}},module$exports$Blockly$WorkspaceAudio.WorkspaceAudio.prototype.preload=function(){for(var a in this.SOUNDS_){var b=this.SOUNDS_[a];b.volume=.01;var c=b.play();if(void 0!==c?c.then(b.pause).catch((function(){})):b.pause(),module$exports$Blockly$utils$userAgent.IPAD||module$exports$Blockly$utils$userAgent.IPHONE)break}},module$exports$Blockly$WorkspaceAudio.WorkspaceAudio.prototype.play=function(a,b){var c=this.SOUNDS_[a];c?(a=new Date,null!==this.lastSound_&&a-this.lastSound_<$.module$exports$Blockly$internalConstants.SOUND_LIMIT||(this.lastSound_=a,(c=module$exports$Blockly$utils$userAgent.IPAD||module$exports$Blockly$utils$userAgent.ANDROID?c:c.cloneNode()).volume=void 0===b?1:b,c.play())):this.parentWorkspace_&&this.parentWorkspace_.getAudioManager().play(a,b)};var module$exports$Blockly$Events$ThemeChange={ThemeChange:function(a,b){module$exports$Blockly$Events$ThemeChange.ThemeChange.superClass_.constructor.call(this,b),this.themeName=a}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$Events$ThemeChange.ThemeChange,module$exports$Blockly$Events$UiBase.UiBase),module$exports$Blockly$Events$ThemeChange.ThemeChange.prototype.type=module$exports$Blockly$Events$utils.THEME_CHANGE,module$exports$Blockly$Events$ThemeChange.ThemeChange.prototype.toJson=function(){var a=module$exports$Blockly$Events$ThemeChange.ThemeChange.superClass_.toJson.call(this);return a.themeName=this.themeName,a},module$exports$Blockly$Events$ThemeChange.ThemeChange.prototype.fromJson=function(a){module$exports$Blockly$Events$ThemeChange.ThemeChange.superClass_.fromJson.call(this,a),this.themeName=a.themeName},(0,module$exports$Blockly$registry.register)(module$exports$Blockly$registry.Type.EVENT,module$exports$Blockly$Events$utils.THEME_CHANGE,module$exports$Blockly$Events$ThemeChange.ThemeChange);var module$exports$Blockly$Events$ViewportChange={ViewportChange:function(a,b,c,d,e){module$exports$Blockly$Events$ViewportChange.ViewportChange.superClass_.constructor.call(this,d),this.viewTop=a,this.viewLeft=b,this.scale=c,this.oldScale=e}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$Events$ViewportChange.ViewportChange,module$exports$Blockly$Events$UiBase.UiBase),module$exports$Blockly$Events$ViewportChange.ViewportChange.prototype.type=module$exports$Blockly$Events$utils.VIEWPORT_CHANGE,module$exports$Blockly$Events$ViewportChange.ViewportChange.prototype.toJson=function(){var a=module$exports$Blockly$Events$ViewportChange.ViewportChange.superClass_.toJson.call(this);return a.viewTop=this.viewTop,a.viewLeft=this.viewLeft,a.scale=this.scale,a.oldScale=this.oldScale,a},module$exports$Blockly$Events$ViewportChange.ViewportChange.prototype.fromJson=function(a){module$exports$Blockly$Events$ViewportChange.ViewportChange.superClass_.fromJson.call(this,a),this.viewTop=a.viewTop,this.viewLeft=a.viewLeft,this.scale=a.scale,this.oldScale=a.oldScale},(0,module$exports$Blockly$registry.register)(module$exports$Blockly$registry.Type.EVENT,module$exports$Blockly$Events$utils.VIEWPORT_CHANGE,module$exports$Blockly$Events$ViewportChange.ViewportChange);var module$exports$Blockly$MetricsManager={MetricsManager:function(a){this.workspace_=a}};module$exports$Blockly$MetricsManager.MetricsManager.prototype.getDimensionsPx_=function(a){var b=0,c=0;return a&&(b=a.getWidth(),c=a.getHeight()),new module$exports$Blockly$utils$Size.Size(b,c)},module$exports$Blockly$MetricsManager.MetricsManager.prototype.getFlyoutMetrics=function(a){return{width:(a=this.getDimensionsPx_(this.workspace_.getFlyout(a))).width,height:a.height,position:this.workspace_.toolboxPosition}},module$exports$Blockly$MetricsManager.MetricsManager.prototype.getToolboxMetrics=function(){var a=this.getDimensionsPx_(this.workspace_.getToolbox());return{width:a.width,height:a.height,position:this.workspace_.toolboxPosition}},module$exports$Blockly$MetricsManager.MetricsManager.prototype.getSvgMetrics=function(){return this.workspace_.getCachedParentSvgSize()},module$exports$Blockly$MetricsManager.MetricsManager.prototype.getAbsoluteMetrics=function(){var a=0,b=this.getToolboxMetrics(),c=this.getFlyoutMetrics(!0),d=!!this.workspace_.getToolbox(),e=!!this.workspace_.getFlyout(!0),f=d?b.position:c.position,g=f===module$exports$Blockly$utils$toolbox.Position.LEFT;return f=f===module$exports$Blockly$utils$toolbox.Position.TOP,d&&g?a=b.width:e&&g&&(a=c.width),g=0,d&&f?g=b.height:e&&f&&(g=c.height),{top:g,left:a}},module$exports$Blockly$MetricsManager.MetricsManager.prototype.getViewMetrics=function(a){a=a?this.workspace_.scale:1;var b=this.getSvgMetrics(),c=this.getToolboxMetrics(),d=this.getFlyoutMetrics(!0),e=this.workspace_.getToolbox()?c.position:d.position;return this.workspace_.getToolbox()?e===module$exports$Blockly$utils$toolbox.Position.TOP||e===module$exports$Blockly$utils$toolbox.Position.BOTTOM?b.height-=c.height:e!==module$exports$Blockly$utils$toolbox.Position.LEFT&&e!==module$exports$Blockly$utils$toolbox.Position.RIGHT||(b.width-=c.width):this.workspace_.getFlyout(!0)&&(e===module$exports$Blockly$utils$toolbox.Position.TOP||e===module$exports$Blockly$utils$toolbox.Position.BOTTOM?b.height-=d.height:e!==module$exports$Blockly$utils$toolbox.Position.LEFT&&e!==module$exports$Blockly$utils$toolbox.Position.RIGHT||(b.width-=d.width)),{height:b.height/a,width:b.width/a,top:-this.workspace_.scrollY/a,left:-this.workspace_.scrollX/a}},module$exports$Blockly$MetricsManager.MetricsManager.prototype.getContentMetrics=function(a){a=a?1:this.workspace_.scale;var b=this.workspace_.getBlocksBoundingBox();return{height:(b.bottom-b.top)*a,width:(b.right-b.left)*a,top:b.top*a,left:b.left*a}},module$exports$Blockly$MetricsManager.MetricsManager.prototype.hasFixedEdges=function(){return!this.workspace_.isMovableHorizontally()||!this.workspace_.isMovableVertically()},module$exports$Blockly$MetricsManager.MetricsManager.prototype.getComputedFixedEdges_=function(a){if(!this.hasFixedEdges())return{};var b=this.workspace_.isMovableHorizontally(),c=this.workspace_.isMovableVertically();a=a||this.getViewMetrics(!1);var d={};return c||(d.top=a.top,d.bottom=a.top+a.height),b||(d.left=a.left,d.right=a.left+a.width),d},module$exports$Blockly$MetricsManager.MetricsManager.prototype.getPaddedContent_=function(a,b){var c=b.top+b.height,d=b.left+b.width,e=a.width,f=e/2,g=(a=a.height)/2;return{top:Math.min(b.top-g,c-a),bottom:Math.max(c+g,b.top+a),left:Math.min(b.left-f,d-e),right:Math.max(d+f,b.left+e)}},module$exports$Blockly$MetricsManager.MetricsManager.prototype.getScrollMetrics=function(a,b,c){a=a?this.workspace_.scale:1,b=b||this.getViewMetrics(!1);var d=c||this.getContentMetrics();c=this.getComputedFixedEdges_(b),b=this.getPaddedContent_(b,d),d=void 0!==c.top?c.top:b.top;var e=void 0!==c.left?c.left:b.left;return{top:d/a,left:e/a,width:((void 0!==c.right?c.right:b.right)-e)/a,height:((void 0!==c.bottom?c.bottom:b.bottom)-d)/a}},module$exports$Blockly$MetricsManager.MetricsManager.prototype.getUiMetrics=function(){return{viewMetrics:this.getViewMetrics(),absoluteMetrics:this.getAbsoluteMetrics(),toolboxMetrics:this.getToolboxMetrics()}},module$exports$Blockly$MetricsManager.MetricsManager.prototype.getMetrics=function(){var a=this.getToolboxMetrics(),b=this.getFlyoutMetrics(!0),c=this.getSvgMetrics(),d=this.getAbsoluteMetrics(),e=this.getViewMetrics(),f=this.getContentMetrics(),g=this.getScrollMetrics(!1,e,f);return{contentHeight:f.height,contentWidth:f.width,contentTop:f.top,contentLeft:f.left,scrollHeight:g.height,scrollWidth:g.width,scrollTop:g.top,scrollLeft:g.left,viewHeight:e.height,viewWidth:e.width,viewTop:e.top,viewLeft:e.left,absoluteTop:d.top,absoluteLeft:d.left,svgHeight:c.height,svgWidth:c.width,toolboxWidth:a.width,toolboxHeight:a.height,toolboxPosition:a.position,flyoutWidth:b.width,flyoutHeight:b.height}},(0,module$exports$Blockly$registry.register)(module$exports$Blockly$registry.Type.METRICS_MANAGER,module$exports$Blockly$registry.DEFAULT,module$exports$Blockly$MetricsManager.MetricsManager);var module$exports$Blockly$WorkspaceSvg={WorkspaceSvg:function(a,b,c){module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.superClass_.constructor.call(this,a),this.metricsManager_=new((0,module$exports$Blockly$registry.getClassFromOptions)(module$exports$Blockly$registry.Type.METRICS_MANAGER,a,!0))(this),this.getMetrics=a.getMetrics||this.metricsManager_.getMetrics.bind(this.metricsManager_),this.setMetrics=a.setMetrics||module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.setTopLevelWorkspaceMetrics_,this.componentManager_=new module$exports$Blockly$ComponentManager.ComponentManager,this.connectionDBList=module$exports$Blockly$ConnectionDB.ConnectionDB.init(this.connectionChecker),b&&(this.blockDragSurface_=b),c&&(this.workspaceDragSurface_=c),this.useWorkspaceDragSurface_=!!this.workspaceDragSurface_&&(0,module$exports$Blockly$utils$svgMath.is3dSupported)(),this.highlightedBlocks_=[],this.audioManager_=new module$exports$Blockly$WorkspaceAudio.WorkspaceAudio(a.parentWorkspace),this.grid_=this.options.gridPattern?new module$exports$Blockly$Grid.Grid(this.options.gridPattern,a.gridOptions):null,this.markerManager_=new module$exports$Blockly$MarkerManager.MarkerManager(this),this.toolboxCategoryCallbacks_=Object.create(null),this.flyoutButtonCallbacks_=Object.create(null),(a=$.module$exports$Blockly$Variables)&&a.flyoutCategory&&this.registerToolboxCategoryCallback(a.CATEGORY_NAME,a.flyoutCategory),(a=module$exports$Blockly$VariablesDynamic)&&a.flyoutCategory&&this.registerToolboxCategoryCallback(a.CATEGORY_NAME,a.flyoutCategory),(a=$.module$exports$Blockly$Procedures)&&a.flyoutCategory&&(this.registerToolboxCategoryCallback(a.CATEGORY_NAME,a.flyoutCategory),this.addChangeListener(a.mutatorOpenListener)),this.themeManager_=this.options.parentWorkspace?this.options.parentWorkspace.getThemeManager():new module$exports$Blockly$ThemeManager.ThemeManager(this,this.options.theme||module$exports$Blockly$Themes$Classic.Classic),this.themeManager_.subscribeWorkspace(this),this.renderer_=(0,module$exports$Blockly$blockRendering.init)(this.options.renderer||"geras",this.getTheme(),this.options.rendererOverrides),this.cachedParentSvg_=null,this.keyboardAccessibilityMode=!1,this.topBoundedElements_=[],this.dragTargetAreas_=[],this.cachedParentSvgSize_=new module$exports$Blockly$utils$Size.Size(0,0)}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$WorkspaceSvg.WorkspaceSvg,module$exports$Blockly$Workspace.Workspace),module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.resizeHandlerWrapper_=null,module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.rendered=!0,module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.isVisible_=!0,module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.isFlyout=!1,module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.isMutator=!1,module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.resizesEnabled_=!0,module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.scrollX=0,module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.scrollY=0,module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.startScrollX=0,module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.startScrollY=0,module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.dragDeltaXY_=null,module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.scale=1,module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.oldScale_=1,module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.oldTop_=0,module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.oldLeft_=0,module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.trashcan=null,module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.scrollbar=null,module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.flyout_=null,module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.toolbox_=null,module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.currentGesture_=null,module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.blockDragSurface_=null,module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.workspaceDragSurface_=null,module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.useWorkspaceDragSurface_=!1,module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.isDragSurfaceActive_=!1,module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.injectionDiv_=null,module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.lastRecordedPageScroll_=null,module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.targetWorkspace=null,module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.inverseScreenCTM_=null,module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.inverseScreenCTMDirty_=!0,module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.getMarkerManager=function(){return this.markerManager_},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.getMetricsManager=function(){return this.metricsManager_},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.setMetricsManager=function(a){this.metricsManager_=a,this.getMetrics=this.metricsManager_.getMetrics.bind(this.metricsManager_)},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.getComponentManager=function(){return this.componentManager_},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.setCursorSvg=function(a){this.markerManager_.setCursorSvg(a)},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.setMarkerSvg=function(a){this.markerManager_.setMarkerSvg(a)},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.getMarker=function(a){return this.markerManager_?this.markerManager_.getMarker(a):null},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.getCursor=function(){return this.markerManager_?this.markerManager_.getCursor():null},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.getRenderer=function(){return this.renderer_},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.getThemeManager=function(){return this.themeManager_},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.getTheme=function(){return this.themeManager_.getTheme()},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.setTheme=function(a){a||(a=module$exports$Blockly$Themes$Classic.Classic),this.themeManager_.setTheme(a)},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.refreshTheme=function(){this.svgGroup_&&this.renderer_.refreshDom(this.svgGroup_,this.getTheme()),this.updateBlockStyles_(this.getAllBlocks(!1).filter((function(b){return!!b.getStyleName()}))),this.refreshToolboxSelection(),this.toolbox_&&this.toolbox_.refreshTheme(),this.isVisible()&&this.setVisible(!0);var a=new((0,module$exports$Blockly$Events$utils.get)(module$exports$Blockly$Events$utils.THEME_CHANGE))(this.getTheme().name,this.id);(0,module$exports$Blockly$Events$utils.fire)(a)},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.updateBlockStyles_=function(a){for(var c,b=0;c=a[b];b++){var d=c.getStyleName();d&&(c.setStyle(d),c.mutator&&c.mutator.updateBlockStyle())}},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.getInverseScreenCTM=function(){if(this.inverseScreenCTMDirty_){var a=this.getParentSvg().getScreenCTM();a&&(this.inverseScreenCTM_=a.inverse(),this.inverseScreenCTMDirty_=!1)}return this.inverseScreenCTM_},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.updateInverseScreenCTM=function(){this.inverseScreenCTMDirty_=!0},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.isVisible=function(){return this.isVisible_},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.getSvgXY=function(a){var b=0,c=0,d=1;((0,module$exports$Blockly$utils$dom.containsNode)(this.getCanvas(),a)||(0,module$exports$Blockly$utils$dom.containsNode)(this.getBubbleCanvas(),a))&&(d=this.scale);do{var e=(0,module$exports$Blockly$utils$svgMath.getRelativeXY)(a);a!==this.getCanvas()&&a!==this.getBubbleCanvas()||(d=1),b+=e.x*d,c+=e.y*d,a=a.parentNode}while(a&&a!==this.getParentSvg());return new module$exports$Blockly$utils$Coordinate.Coordinate(b,c)},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.getCachedParentSvgSize=function(){var a=this.cachedParentSvgSize_;return new module$exports$Blockly$utils$Size.Size(a.width,a.height)},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.getOriginOffsetInPixels=function(){return(0,module$exports$Blockly$utils$svgMath.getInjectionDivXY)(this.getCanvas())},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.getInjectionDiv=function(){if(!this.injectionDiv_)for(var a=this.svgGroup_;a;){if(-1!==(" "+(a.getAttribute("class")||"")+" ").indexOf(" injectionDiv ")){this.injectionDiv_=a;break}a=a.parentNode}return this.injectionDiv_},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.getBlockCanvas=function(){return this.svgBlockCanvas_},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.setResizeHandlerWrapper=function(a){this.resizeHandlerWrapper_=a},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.createDom=function(a){return this.svgGroup_=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.G,{class:"blocklyWorkspace"},null),a&&(this.svgBackground_=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.RECT,{height:"100%",width:"100%",class:a},this.svgGroup_),"blocklyMainBackground"===a&&this.grid_?this.svgBackground_.style.fill="url(#"+this.grid_.getPatternId()+")":this.themeManager_.subscribe(this.svgBackground_,"workspaceBackgroundColour","fill")),this.svgBlockCanvas_=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.G,{class:"blocklyBlockCanvas"},this.svgGroup_),this.svgBubbleCanvas_=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.G,{class:"blocklyBubbleCanvas"},this.svgGroup_),this.isFlyout||((0,module$exports$Blockly$browserEvents.conditionalBind)(this.svgGroup_,"mousedown",this,this.onMouseDown_,!1,!0),document.body.addEventListener("wheel",(function(){})),(0,module$exports$Blockly$browserEvents.conditionalBind)(this.svgGroup_,"wheel",this,this.onMouseWheel_)),this.options.hasCategories&&(this.toolbox_=new((0,module$exports$Blockly$registry.getClassFromOptions)(module$exports$Blockly$registry.Type.TOOLBOX,this.options,!0))(this)),this.grid_&&this.grid_.update(this.scale),this.recordDragTargets(),(a=(0,module$exports$Blockly$registry.getClassFromOptions)(module$exports$Blockly$registry.Type.CURSOR,this.options))&&this.markerManager_.setCursor(new a),this.renderer_.createDom(this.svgGroup_,this.getTheme()),this.svgGroup_},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.dispose=function(){if(this.rendered=!1,this.currentGesture_&&this.currentGesture_.cancel(),this.svgGroup_&&((0,module$exports$Blockly$utils$dom.removeNode)(this.svgGroup_),this.svgGroup_=null),this.svgBubbleCanvas_=this.svgBlockCanvas_=null,this.toolbox_&&(this.toolbox_.dispose(),this.toolbox_=null),this.flyout_&&(this.flyout_.dispose(),this.flyout_=null),this.trashcan&&(this.trashcan.dispose(),this.trashcan=null),this.scrollbar&&(this.scrollbar.dispose(),this.scrollbar=null),this.zoomControls_&&(this.zoomControls_.dispose(),this.zoomControls_=null),this.audioManager_&&(this.audioManager_.dispose(),this.audioManager_=null),this.grid_&&(this.grid_.dispose(),this.grid_=null),this.renderer_.dispose(),this.markerManager_&&(this.markerManager_.dispose(),this.markerManager_=null),module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.superClass_.dispose.call(this),this.themeManager_&&(this.themeManager_.unsubscribeWorkspace(this),this.themeManager_.unsubscribe(this.svgBackground_),this.options.parentWorkspace||(this.themeManager_.dispose(),this.themeManager_=null)),this.flyoutButtonCallbacks_=this.toolboxCategoryCallbacks_=this.connectionDBList=null,!this.options.parentWorkspace){var a=this.getParentSvg();a&&a.parentNode&&(0,module$exports$Blockly$utils$dom.removeNode)(a.parentNode)}this.resizeHandlerWrapper_&&((0,module$exports$Blockly$browserEvents.unbind)(this.resizeHandlerWrapper_),this.resizeHandlerWrapper_=null)},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.newBlock=function(a,b){return new module$exports$Blockly$BlockSvg.BlockSvg(this,a,b)},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.addTrashcan=function(){var a=module$exports$Blockly$Trashcan.Trashcan;if(!a)throw Error("Missing require for Blockly.Trashcan");this.trashcan=new a(this),a=this.trashcan.createDom(),this.svgGroup_.insertBefore(a,this.svgBlockCanvas_)},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.addZoomControls=function(){var a=module$exports$Blockly$ZoomControls.ZoomControls;if(!a)throw Error("Missing require for Blockly.ZoomControls");this.zoomControls_=new a(this),a=this.zoomControls_.createDom(),this.svgGroup_.appendChild(a)},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.addFlyout=function(a){var b=new module$exports$Blockly$Options.Options({parentWorkspace:this,rtl:this.RTL,oneBasedIndex:this.options.oneBasedIndex,horizontalLayout:this.horizontalLayout,renderer:this.options.renderer,rendererOverrides:this.options.rendererOverrides,move:{scrollbars:!0}});return b.toolboxPosition=this.options.toolboxPosition,this.flyout_=this.horizontalLayout?new((0,module$exports$Blockly$registry.getClassFromOptions)(module$exports$Blockly$registry.Type.FLYOUTS_HORIZONTAL_TOOLBOX,this.options,!0))(b):new((0,module$exports$Blockly$registry.getClassFromOptions)(module$exports$Blockly$registry.Type.FLYOUTS_VERTICAL_TOOLBOX,this.options,!0))(b),this.flyout_.autoClose=!1,this.flyout_.getWorkspace().setVisible(!0),this.flyout_.createDom(a)},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.getFlyout=function(a){return this.flyout_||a?this.flyout_:this.toolbox_?this.toolbox_.getFlyout():null},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.getToolbox=function(){return this.toolbox_},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.updateScreenCalculations_=function(){this.updateInverseScreenCTM(),this.recordDragTargets()},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.resizeContents=function(){this.resizesEnabled_&&this.rendered&&(this.scrollbar&&this.scrollbar.resize(),this.updateInverseScreenCTM())},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.resize=function(){this.toolbox_&&this.toolbox_.position(),this.flyout_&&this.flyout_.position();for(var e,a=this.componentManager_.getComponents(module$exports$Blockly$ComponentManager.ComponentManager.Capability.POSITIONABLE,!0),b=this.getMetricsManager().getUiMetrics(),c=[],d=0;e=a[d];d++)e.position(b,c),(e=e.getBoundingRectangle())&&c.push(e);this.scrollbar&&this.scrollbar.resize(),this.updateScreenCalculations_()},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.updateScreenCalculationsIfScrolled=function(){var a=(0,module$exports$Blockly$utils$svgMath.getDocumentScroll)();module$exports$Blockly$utils$Coordinate.Coordinate.equals(this.lastRecordedPageScroll_,a)||(this.lastRecordedPageScroll_=a,this.updateScreenCalculations_())},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.getCanvas=function(){return this.svgBlockCanvas_},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.setCachedParentSvgSize=function(a,b){var c=this.getParentSvg();a&&(this.cachedParentSvgSize_.width=a,c.cachedWidth_=a),b&&(this.cachedParentSvgSize_.height=b,c.cachedHeight_=b)},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.getBubbleCanvas=function(){return this.svgBubbleCanvas_},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.getParentSvg=function(){if(!this.cachedParentSvg_)for(var a=this.svgGroup_;a;){if("svg"===a.tagName){this.cachedParentSvg_=a;break}a=a.parentNode}return this.cachedParentSvg_},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.maybeFireViewportChangeEvent=function(){if((0,module$exports$Blockly$Events$utils.isEnabled)()){var a=this.scale,b=-this.scrollY,c=-this.scrollX;if(!(a===this.oldScale_&&1>Math.abs(b-this.oldTop_)&&1>Math.abs(c-this.oldLeft_))){var d=new((0,module$exports$Blockly$Events$utils.get)(module$exports$Blockly$Events$utils.VIEWPORT_CHANGE))(b,c,a,this.id,this.oldScale_);this.oldScale_=a,this.oldTop_=b,this.oldLeft_=c,(0,module$exports$Blockly$Events$utils.fire)(d)}}},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.translate=function(a,b){if(this.useWorkspaceDragSurface_&&this.isDragSurfaceActive_)this.workspaceDragSurface_.translateSurface(a,b);else{var c="translate("+a+","+b+") scale("+this.scale+")";this.svgBlockCanvas_.setAttribute("transform",c),this.svgBubbleCanvas_.setAttribute("transform",c)}this.blockDragSurface_&&this.blockDragSurface_.translateAndScaleGroup(a,b,this.scale),this.grid_&&this.grid_.moveTo(a,b),this.maybeFireViewportChangeEvent()},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.resetDragSurface=function(){if(this.useWorkspaceDragSurface_){this.isDragSurfaceActive_=!1;var a=this.workspaceDragSurface_.getSurfaceTranslation();this.workspaceDragSurface_.clearAndHide(this.svgGroup_),a="translate("+a.x+","+a.y+") scale("+this.scale+")",this.svgBlockCanvas_.setAttribute("transform",a),this.svgBubbleCanvas_.setAttribute("transform",a)}},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.setupDragSurface=function(){if(this.useWorkspaceDragSurface_&&!this.isDragSurfaceActive_){this.isDragSurfaceActive_=!0;var a=this.svgBlockCanvas_.previousSibling,b=parseInt(this.getParentSvg().getAttribute("width"),10),c=parseInt(this.getParentSvg().getAttribute("height"),10),d=(0,module$exports$Blockly$utils$svgMath.getRelativeXY)(this.getCanvas());this.workspaceDragSurface_.setContentsAndShow(this.getCanvas(),this.getBubbleCanvas(),a,b,c,this.scale),this.workspaceDragSurface_.translateSurface(d.x,d.y)}},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.getBlockDragSurface=function(){return this.blockDragSurface_},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.getWidth=function(){var a=this.getMetrics();return a?a.viewWidth/this.scale:0},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.setVisible=function(a){if(this.isVisible_=a,this.svgGroup_)if(this.scrollbar&&this.scrollbar.setContainerVisible(a),this.getFlyout()&&this.getFlyout().setContainerVisible(a),this.getParentSvg().style.display=a?"block":"none",this.toolbox_&&this.toolbox_.setVisible(a),a){for(var b=(a=this.getAllBlocks(!1)).length-1;0<=b;b--)a[b].markDirty();this.render(),this.toolbox_&&this.toolbox_.position()}else this.hideChaff(!0)},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.render=function(){for(var a=this.getAllBlocks(!1),b=a.length-1;0<=b;b--)a[b].render(!1);if(this.currentGesture_)for(a=this.currentGesture_.getInsertionMarkers(),b=0;b<a.length;b++)a[b].render(!1);this.markerManager_.updateMarkers()},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.highlightBlock=function(a,b){if(void 0===b){for(var d,c=0;d=this.highlightedBlocks_[c];c++)d.setHighlighted(!1);this.highlightedBlocks_.length=0}(a=a?this.getBlockById(a):null)&&((b=void 0===b||b)?-1===this.highlightedBlocks_.indexOf(a)&&this.highlightedBlocks_.push(a):module$exports$Blockly$utils$array_removeElem(this.highlightedBlocks_,a),a.setHighlighted(b))},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.paste=function(a){this.rendered&&(a.type||a.tagName)&&(this.currentGesture_&&this.currentGesture_.cancel(),a.type?this.pasteBlock_(null,a):"comment"===a.tagName.toLowerCase()?this.pasteWorkspaceComment_(a):this.pasteBlock_(a,null))},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.pasteBlock_=function(a,b){(0,module$exports$Blockly$Events$utils.disable)();try{var c=0,d=0;if(a){var e=(0,$.module$exports$Blockly$Xml.domToBlock)(a,this);c=parseInt(a.getAttribute("x"),10),this.RTL&&(c=-c),d=parseInt(a.getAttribute("y"),10)}else b&&(e=(0,module$exports$Blockly$serialization$blocks.append)(b,this),c=b.x||10,this.RTL&&(c=this.getWidth()-c),d=b.y||10);if(!isNaN(c)&&!isNaN(d)){do{var f=!1,g=this.getAllBlocks(!1);for(a=0,b=void 0;b=g[a];a++){var h=b.getRelativeToSurfaceXY();if(1>=Math.abs(c-h.x)&&1>=Math.abs(d-h.y)){f=!0;break}}if(!f){var k=e.getConnections_(!1);for(a=0,b=void 0;b=k[a];a++)if(b.closest($.module$exports$Blockly$internalConstants.SNAP_RADIUS,new module$exports$Blockly$utils$Coordinate.Coordinate(c,d)).connection){f=!0;break}}f&&(c=this.RTL?c-$.module$exports$Blockly$internalConstants.SNAP_RADIUS:c+$.module$exports$Blockly$internalConstants.SNAP_RADIUS,d+=2*$.module$exports$Blockly$internalConstants.SNAP_RADIUS)}while(f);e.moveTo(new module$exports$Blockly$utils$Coordinate.Coordinate(c,d))}}finally{(0,module$exports$Blockly$Events$utils.enable)()}(0,module$exports$Blockly$Events$utils.isEnabled)()&&!e.isShadow()&&(0,module$exports$Blockly$Events$utils.fire)(new((0,module$exports$Blockly$Events$utils.get)(module$exports$Blockly$Events$utils.CREATE))(e)),e.select()},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.pasteWorkspaceComment_=function(a){(0,module$exports$Blockly$Events$utils.disable)();try{var b=module$exports$Blockly$WorkspaceCommentSvg.fromXml(a,this),c=parseInt(a.getAttribute("x"),10),d=parseInt(a.getAttribute("y"),10);isNaN(c)||isNaN(d)||(this.RTL&&(c=-c),b.moveBy(c+50,d+50))}finally{(0,module$exports$Blockly$Events$utils.enable)()}(0,module$exports$Blockly$Events$utils.isEnabled)()&&module$exports$Blockly$WorkspaceComment.fireCreateEvent(b),b.select()},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.refreshToolboxSelection=function(){var a=this.isFlyout?this.targetWorkspace:this;a&&!a.currentGesture_&&a.toolbox_&&a.toolbox_.getFlyout()&&a.toolbox_.refreshSelection()},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.renameVariableById=function(a,b){module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.superClass_.renameVariableById.call(this,a,b),this.refreshToolboxSelection()},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.deleteVariableById=function(a){module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.superClass_.deleteVariableById.call(this,a),this.refreshToolboxSelection()},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.createVariable=function(a,b,c){return a=module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.superClass_.createVariable.call(this,a,b,c),this.refreshToolboxSelection(),a},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.recordDeleteAreas=function(){module$exports$Blockly$utils.deprecation.warn("WorkspaceSvg.prototype.recordDeleteAreas","June 2021","June 2022","WorkspaceSvg.prototype.recordDragTargets"),this.recordDragTargets()},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.recordDragTargets=function(){var a=this.componentManager_.getComponents(module$exports$Blockly$ComponentManager.ComponentManager.Capability.DRAG_TARGET,!0);this.dragTargetAreas_=[];for(var c,b=0;c=a[b];b++){var d=c.getClientRect();d&&this.dragTargetAreas_.push({component:c,clientRect:d})}},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.getDragTarget=function(a){for(var c,b=0;c=this.dragTargetAreas_[b];b++)if(c.clientRect.contains(a.clientX,a.clientY))return c.component;return null},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.onMouseDown_=function(a){var b=this.getGesture(a);b&&b.handleWsStart(a,this)},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.startDrag=function(a,b){(a=(0,module$exports$Blockly$browserEvents.mouseToSvg)(a,this.getParentSvg(),this.getInverseScreenCTM())).x/=this.scale,a.y/=this.scale,this.dragDeltaXY_=module$exports$Blockly$utils$Coordinate.Coordinate.difference(b,a)},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.moveDrag=function(a){return(a=(0,module$exports$Blockly$browserEvents.mouseToSvg)(a,this.getParentSvg(),this.getInverseScreenCTM())).x/=this.scale,a.y/=this.scale,module$exports$Blockly$utils$Coordinate.Coordinate.sum(this.dragDeltaXY_,a)},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.isDragging=function(){return null!==this.currentGesture_&&this.currentGesture_.isDragging()},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.isDraggable=function(){return this.options.moveOptions&&this.options.moveOptions.drag},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.isMovable=function(){return this.options.moveOptions&&!!this.options.moveOptions.scrollbars||this.options.moveOptions&&this.options.moveOptions.wheel||this.options.moveOptions&&this.options.moveOptions.drag||this.options.zoomOptions&&this.options.zoomOptions.wheel||this.options.zoomOptions&&this.options.zoomOptions.pinch},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.isMovableHorizontally=function(){var a=!!this.scrollbar;return this.isMovable()&&(!a||a&&this.scrollbar.canScrollHorizontally())},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.isMovableVertically=function(){var a=!!this.scrollbar;return this.isMovable()&&(!a||a&&this.scrollbar.canScrollVertically())},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.onMouseWheel_=function(a){if(module$exports$Blockly$Gesture.Gesture.inProgress())a.preventDefault(),a.stopPropagation();else{var b=this.options.zoomOptions&&this.options.zoomOptions.wheel,c=this.options.moveOptions&&this.options.moveOptions.wheel;if(b||c){var d=(0,module$exports$Blockly$browserEvents.getScrollDeltaPixels)(a);if(module$exports$Blockly$utils$userAgent.MAC)var e=a.metaKey;b&&(a.ctrlKey||e||!c)?(d=-d.y/50,b=(0,module$exports$Blockly$browserEvents.mouseToSvg)(a,this.getParentSvg(),this.getInverseScreenCTM()),this.zoom(b.x,b.y,d)):(b=this.scrollX-d.x,c=this.scrollY-d.y,a.shiftKey&&!d.x&&(b=this.scrollX-d.y,c=this.scrollY),this.scroll(b,c)),a.preventDefault()}}},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.getBlocksBoundingBox=function(){var a=this.getTopBoundedElements();if(!a.length)return new module$exports$Blockly$utils$Rect.Rect(0,0,0,0);for(var b=a[0].getBoundingRectangle(),c=1;c<a.length;c++){var d=a[c];d.isInsertionMarker&&d.isInsertionMarker()||((d=d.getBoundingRectangle()).top<b.top&&(b.top=d.top),d.bottom>b.bottom&&(b.bottom=d.bottom),d.left<b.left&&(b.left=d.left),d.right>b.right&&(b.right=d.right))}return b},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.cleanUp=function(){this.setResizesEnabled(!1),(0,module$exports$Blockly$Events$utils.setGroup)(!0);for(var d,a=this.getTopBlocks(!0),b=0,c=0;d=a[c];c++)if(d.isMovable()){var e=d.getRelativeToSurfaceXY();d.moveBy(-e.x,b-e.y),d.snapToGrid(),b=d.getRelativeToSurfaceXY().y+d.getHeightWidth().height+this.renderer_.getConstants().MIN_BLOCK_HEIGHT}(0,module$exports$Blockly$Events$utils.setGroup)(!1),this.setResizesEnabled(!0)},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.showContextMenu=function(a){if(!this.options.readOnly&&!this.isFlyout){var b=module$exports$Blockly$ContextMenuRegistry.ContextMenuRegistry.registry.getContextMenuOptions(module$exports$Blockly$ContextMenuRegistry.ContextMenuRegistry.ScopeType.WORKSPACE,{workspace:this});this.configureContextMenu&&this.configureContextMenu(b,a),(0,$.module$exports$Blockly$ContextMenu.show)(a,b,this.RTL)}},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.updateToolbox=function(a){if(a=(0,module$exports$Blockly$utils$toolbox.convertToolboxDefToJson)(a)){if(!this.options.languageTree)throw Error("Existing toolbox is null.  Can't create new toolbox.");if((0,module$exports$Blockly$utils$toolbox.hasCategories)(a)){if(!this.toolbox_)throw Error("Existing toolbox has no categories.  Can't change mode.");this.options.languageTree=a,this.toolbox_.render(a)}else{if(!this.flyout_)throw Error("Existing toolbox has categories.  Can't change mode.");this.options.languageTree=a,this.flyout_.show(a)}}else if(this.options.languageTree)throw Error("Can't nullify an existing toolbox.")},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.markFocused=function(){this.options.parentWorkspace?this.options.parentWorkspace.markFocused():((0,$.module$exports$Blockly$common.setMainWorkspace)(this),this.setBrowserFocus())},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.setBrowserFocus=function(){document.activeElement&&document.activeElement.blur&&document.activeElement.blur();try{this.getParentSvg().focus({preventScroll:!0})}catch(a){try{this.getParentSvg().parentNode.setActive()}catch(b){this.getParentSvg().parentNode.focus({preventScroll:!0})}}},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.zoom=function(a,b,c){c=Math.pow(this.options.zoomOptions.scaleSpeed,c);var d=this.scale*c;if(this.scale!==d){d>this.options.zoomOptions.maxScale?c=this.options.zoomOptions.maxScale/this.scale:d<this.options.zoomOptions.minScale&&(c=this.options.zoomOptions.minScale/this.scale);var e=this.getCanvas().getCTM(),f=this.getParentSvg().createSVGPoint();f.x=a,f.y=b,a=(f=f.matrixTransform(e.inverse())).x,b=f.y,e=e.translate(a*(1-c),b*(1-c)).scale(c),this.scrollX=e.e,this.scrollY=e.f,this.setScale(d)}},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.zoomCenter=function(a){var b=this.getMetrics();if(this.flyout_){var c=b.svgWidth?b.svgWidth/2:0;b=b.svgHeight?b.svgHeight/2:0}else c=b.viewWidth/2+b.absoluteLeft,b=b.viewHeight/2+b.absoluteTop;this.zoom(c,b,a)},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.zoomToFit=function(){if(this.isMovable()){var a=this.getMetrics(),b=a.viewWidth;a=a.viewHeight;var c=this.getBlocksBoundingBox(),d=c.right-c.left;if(c=c.bottom-c.top,d){this.flyout_&&(this.horizontalLayout?(a+=this.flyout_.getHeight(),c+=this.flyout_.getHeight()/this.scale):(b+=this.flyout_.getWidth(),d+=this.flyout_.getWidth()/this.scale)),b/=d,a/=c,(0,module$exports$Blockly$Events$utils.disable)();try{this.setScale(Math.min(b,a)),this.scrollCenter()}finally{(0,module$exports$Blockly$Events$utils.enable)()}this.maybeFireViewportChangeEvent()}}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.beginCanvasTransition=function(){(0,module$exports$Blockly$utils$dom.addClass)(this.svgBlockCanvas_,"blocklyCanvasTransitioning"),(0,module$exports$Blockly$utils$dom.addClass)(this.svgBubbleCanvas_,"blocklyCanvasTransitioning")},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.endCanvasTransition=function(){(0,module$exports$Blockly$utils$dom.removeClass)(this.svgBlockCanvas_,"blocklyCanvasTransitioning"),(0,module$exports$Blockly$utils$dom.removeClass)(this.svgBubbleCanvas_,"blocklyCanvasTransitioning")},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.scrollCenter=function(){if(this.isMovable()){var a=this.getMetrics(),b=(a.scrollWidth-a.viewWidth)/2,c=(a.scrollHeight-a.viewHeight)/2;b=-b-a.scrollLeft,c=-c-a.scrollTop,this.scroll(b,c)}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.centerOnBlock=function(a){if(this.isMovable()){if(a=a?this.getBlockById(a):null){var b=a.getRelativeToSurfaceXY(),c=a.getHeightWidth(),d=this.scale;a=(b.x+(this.RTL?-1:1)*c.width/2)*d,b=(b.y+c.height/2)*d,c=this.getMetrics(),this.scroll(-(a-c.viewWidth/2),-(b-c.viewHeight/2))}}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.setScale=function(a){this.options.zoomOptions.maxScale&&a>this.options.zoomOptions.maxScale?a=this.options.zoomOptions.maxScale:this.options.zoomOptions.minScale&&a<this.options.zoomOptions.minScale&&(a=this.options.zoomOptions.minScale),this.scale=a,this.hideChaff(!1),(a=this.getFlyout(!1))&&a.isVisible()&&(a.reflow(),this.recordDragTargets()),this.grid_&&this.grid_.update(this.scale),a=this.getMetrics(),this.scrollX-=a.absoluteLeft,this.scrollY-=a.absoluteTop,a.viewLeft+=a.absoluteLeft,a.viewTop+=a.absoluteTop,this.scroll(this.scrollX,this.scrollY),this.scrollbar&&(this.flyout_?this.scrollbar.resizeView(a):this.scrollbar.resizeContent(a))},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.getScale=function(){return this.options.parentWorkspace?this.options.parentWorkspace.getScale():this.scale},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.scroll=function(a,b){this.hideChaff(!0);var c=this.getMetrics();a=Math.min(a,-c.scrollLeft),b=Math.min(b,-c.scrollTop);var d=c.scrollTop+Math.max(0,c.scrollHeight-c.viewHeight);a=Math.max(a,-(c.scrollLeft+Math.max(0,c.scrollWidth-c.viewWidth))),b=Math.max(b,-d),this.scrollX=a,this.scrollY=b,this.scrollbar&&this.scrollbar.set(-(a+c.scrollLeft),-(b+c.scrollTop),!1),a+=c.absoluteLeft,b+=c.absoluteTop,this.translate(a,b)},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.setTopLevelWorkspaceMetrics_=function(a){var b=this.getMetrics();"number"==typeof a.x&&(this.scrollX=-(b.scrollLeft+(b.scrollWidth-b.viewWidth)*a.x)),"number"==typeof a.y&&(this.scrollY=-(b.scrollTop+(b.scrollHeight-b.viewHeight)*a.y)),this.translate(this.scrollX+b.absoluteLeft,this.scrollY+b.absoluteTop)},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.getBlockById=function(a){return module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.superClass_.getBlockById.call(this,a)},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.getTopBlocks=function(a){return module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.superClass_.getTopBlocks.call(this,a)},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.addTopBlock=function(a){this.addTopBoundedElement(a),module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.superClass_.addTopBlock.call(this,a)},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.removeTopBlock=function(a){this.removeTopBoundedElement(a),module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.superClass_.removeTopBlock.call(this,a)},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.addTopComment=function(a){this.addTopBoundedElement(a),module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.superClass_.addTopComment.call(this,a)},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.removeTopComment=function(a){this.removeTopBoundedElement(a),module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.superClass_.removeTopComment.call(this,a)},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.addTopBoundedElement=function(a){this.topBoundedElements_.push(a)},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.removeTopBoundedElement=function(a){module$exports$Blockly$utils$array_removeElem(this.topBoundedElements_,a)},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.getTopBoundedElements=function(){return[].concat(this.topBoundedElements_)},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.setResizesEnabled=function(a){var b=!this.resizesEnabled_&&a;this.resizesEnabled_=a,b&&this.resizeContents()},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.clear=function(){this.setResizesEnabled(!1),module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.superClass_.clear.call(this),this.topBoundedElements_=[],this.setResizesEnabled(!0)},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.registerButtonCallback=function(a,b){if("function"!=typeof b)throw TypeError("Button callbacks must be functions.");this.flyoutButtonCallbacks_[a]=b},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.getButtonCallback=function(a){return(a=this.flyoutButtonCallbacks_[a])?a:null},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.removeButtonCallback=function(a){this.flyoutButtonCallbacks_[a]=null},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.registerToolboxCategoryCallback=function(a,b){if("function"!=typeof b)throw TypeError("Toolbox category callbacks must be functions.");this.toolboxCategoryCallbacks_[a]=b},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.getToolboxCategoryCallback=function(a){return this.toolboxCategoryCallbacks_[a]||null},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.removeToolboxCategoryCallback=function(a){this.toolboxCategoryCallbacks_[a]=null},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.getGesture=function(a){var b="mousedown"===a.type||"touchstart"===a.type||"pointerdown"===a.type,c=this.currentGesture_;return c?b&&c.hasStarted()?(console.warn("Tried to start the same gesture twice."),c.cancel(),null):c:b?this.currentGesture_=new module$exports$Blockly$TouchGesture.TouchGesture(a,this):null},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.clearGesture=function(){this.currentGesture_=null},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.cancelCurrentGesture=function(){this.currentGesture_&&this.currentGesture_.cancel()},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.getAudioManager=function(){return this.audioManager_},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.getGrid=function(){return this.grid_},module$exports$Blockly$WorkspaceSvg.WorkspaceSvg.prototype.hideChaff=function(a){(0,module$exports$Blockly$Tooltip.hide)(),(0,module$exports$Blockly$WidgetDiv.hide)(),module$exports$Blockly$DropDownDiv.DropDownDiv.hideWithoutAnimation();var b=!!a;this.getComponentManager().getComponents(module$exports$Blockly$ComponentManager.ComponentManager.Capability.AUTOHIDEABLE,!0).forEach((function(c){return c.autoHide(b)}))},module$exports$Blockly$WorkspaceSvg.resizeSvgContents=function(a){a.resizeContents()};var module$exports$Blockly$inject_inject=function(a,b){if("string"==typeof a&&(a=document.getElementById(a)||document.querySelector(a)),!a||!(0,module$exports$Blockly$utils$dom.containsNode)(document,a))throw Error("Error: container is not in current document.");b=new module$exports$Blockly$Options.Options(b||{});var c=document.createElement("div");c.className="injectionDiv",c.tabIndex=0,(0,module$exports$Blockly$utils$aria.setState)(c,module$exports$Blockly$utils$aria.State.LABEL,$.module$exports$Blockly$Msg.Msg.WORKSPACE_ARIA_LABEL),a.appendChild(c),a=module$contents$Blockly$inject_createDom(c,b);var d=new module$exports$Blockly$BlockDragSurfaceSvg.BlockDragSurfaceSvg(c),e=new module$exports$Blockly$WorkspaceDragSurfaceSvg.WorkspaceDragSurfaceSvg(c),f=module$contents$Blockly$inject_createMainWorkspace(a,b,d,e);return module$contents$Blockly$inject_init(f),(0,$.module$exports$Blockly$common.setMainWorkspace)(f),(0,$.module$exports$Blockly$common.svgResize)(f),c.addEventListener("focusin",(function(){(0,$.module$exports$Blockly$common.setMainWorkspace)(f)})),f},module$contents$Blockly$inject_createDom=function(a,b){a.setAttribute("dir","LTR"),(0,module$exports$Blockly$Css.inject)(b.hasCss,b.pathToMedia),a=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.SVG,{xmlns:module$exports$Blockly$utils$dom.SVG_NS,"xmlns:html":module$exports$Blockly$utils$dom.HTML_NS,"xmlns:xlink":module$exports$Blockly$utils$dom.XLINK_NS,version:"1.1",class:"blocklySvg",tabindex:"0"},a);var c=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.DEFS,{},a),d=String(Math.random()).substring(2);return b.gridPattern=module$exports$Blockly$Grid.Grid.createDom(d,b.gridOptions,c),a},module$contents$Blockly$inject_createMainWorkspace=function(a,b,c,d){return b.parentWorkspace=null,c=(b=new module$exports$Blockly$WorkspaceSvg.WorkspaceSvg(b,c,d)).options,b.scale=c.zoomOptions.startScale,a.appendChild(b.createDom("blocklyMainBackground")),(0,module$exports$Blockly$utils$dom.addClass)(b.getInjectionDiv(),b.getRenderer().getClassName()),(0,module$exports$Blockly$utils$dom.addClass)(b.getInjectionDiv(),b.getTheme().getClassName()),!c.hasCategories&&c.languageTree&&(d=b.addFlyout(module$exports$Blockly$utils$Svg.Svg.SVG),(0,module$exports$Blockly$utils$dom.insertAfter)(d,a)),c.hasTrashcan&&b.addTrashcan(),c.zoomOptions&&c.zoomOptions.controls&&b.addZoomControls(),b.getThemeManager().subscribe(a,"workspaceBackgroundColour","background-color"),b.translate(0,0),b.addChangeListener((0,module$exports$Blockly$bumpObjects.bumpIntoBoundsHandler)(b)),(0,$.module$exports$Blockly$common.svgResize)(b),(0,module$exports$Blockly$WidgetDiv.createDom)(),module$exports$Blockly$DropDownDiv.DropDownDiv.createDom(),(0,module$exports$Blockly$Tooltip.createDom)(),b},module$contents$Blockly$inject_init=function(a){var b=a.options,c=a.getParentSvg();if((0,module$exports$Blockly$browserEvents.conditionalBind)(c.parentNode,"contextmenu",null,(function(e){(0,module$exports$Blockly$browserEvents.isTargetInput)(e)||e.preventDefault()})),c=(0,module$exports$Blockly$browserEvents.conditionalBind)(window,"resize",null,(function(){a.hideChaff(!0),(0,$.module$exports$Blockly$common.svgResize)(a),module$exports$Blockly$bumpObjects.bumpTopObjectsIntoBounds(a)})),a.setResizeHandlerWrapper(c),module$contents$Blockly$inject_bindDocumentEvents(),b.languageTree){c=a.getToolbox();var d=a.getFlyout(!0);c?c.init():d&&(d.init(a),d.show(b.languageTree),"function"==typeof d.scrollToStart&&d.scrollToStart())}b.hasTrashcan&&a.trashcan.init(),b.zoomOptions&&b.zoomOptions.controls&&a.zoomControls_.init(),b.moveOptions&&b.moveOptions.scrollbars?(a.scrollbar=new module$exports$Blockly$ScrollbarPair.ScrollbarPair(a,!0===b.moveOptions.scrollbars||!!b.moveOptions.scrollbars.horizontal,!0===b.moveOptions.scrollbars||!!b.moveOptions.scrollbars.vertical,"blocklyMainWorkspaceScrollbar"),a.scrollbar.resize()):a.setMetrics({x:.5,y:.5}),b.hasSounds&&module$contents$Blockly$inject_loadSounds(b.pathToMedia,a)},module$contents$Blockly$inject_onKeyDown=function(a){var b=(0,$.module$exports$Blockly$common.getMainWorkspace)();b&&!((0,module$exports$Blockly$browserEvents.isTargetInput)(a)||b.rendered&&!b.isVisible())&&module$exports$Blockly$ShortcutRegistry.ShortcutRegistry.registry.onKeyDown(b,a)},module$contents$Blockly$inject_documentEventsBound=!1,module$contents$Blockly$inject_bindDocumentEvents=function(){module$contents$Blockly$inject_documentEventsBound||((0,module$exports$Blockly$browserEvents.conditionalBind)(document,"scroll",null,(function(){for(var c,a=module$exports$Blockly$Workspace.Workspace.getAll(),b=0;c=a[b];b++)c.updateInverseScreenCTM&&c.updateInverseScreenCTM()})),(0,module$exports$Blockly$browserEvents.conditionalBind)(document,"keydown",null,module$contents$Blockly$inject_onKeyDown),(0,module$exports$Blockly$browserEvents.bind)(document,"touchend",null,module$exports$Blockly$Touch.longStop),(0,module$exports$Blockly$browserEvents.bind)(document,"touchcancel",null,module$exports$Blockly$Touch.longStop),module$exports$Blockly$utils$userAgent.IPAD&&(0,module$exports$Blockly$browserEvents.conditionalBind)(window,"orientationchange",document,(function(){(0,$.module$exports$Blockly$common.svgResize)((0,$.module$exports$Blockly$common.getMainWorkspace)())}))),module$contents$Blockly$inject_documentEventsBound=!0},module$contents$Blockly$inject_loadSounds=function(a,b){var c=b.getAudioManager();c.load([a+"click.mp3",a+"click.wav",a+"click.ogg"],"click"),c.load([a+"disconnect.wav",a+"disconnect.mp3",a+"disconnect.ogg"],"disconnect"),c.load([a+"delete.mp3",a+"delete.ogg",a+"delete.wav"],"delete");var d=[];a=function(){for(;d.length;)(0,module$exports$Blockly$browserEvents.unbind)(d.pop());c.preload()},d.push((0,module$exports$Blockly$browserEvents.conditionalBind)(document,"mousemove",null,a,!0)),d.push((0,module$exports$Blockly$browserEvents.conditionalBind)(document,"touchstart",null,a,!0))},module$exports$Blockly$DragTarget={DragTarget:function(){}};module$exports$Blockly$DragTarget.DragTarget.prototype.onDragEnter=function(a){},module$exports$Blockly$DragTarget.DragTarget.prototype.onDragOver=function(a){},module$exports$Blockly$DragTarget.DragTarget.prototype.onDragExit=function(a){},module$exports$Blockly$DragTarget.DragTarget.prototype.onDrop=function(a){},module$exports$Blockly$DragTarget.DragTarget.prototype.shouldPreventMove=function(a){return!1};var module$exports$Blockly$DeleteArea={DeleteArea:function(){module$exports$Blockly$DeleteArea.DeleteArea.superClass_.constructor.call(this),this.wouldDelete_=!1}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$DeleteArea.DeleteArea,module$exports$Blockly$DragTarget.DragTarget),module$exports$Blockly$DeleteArea.DeleteArea.prototype.wouldDelete=function(a,b){return a instanceof module$exports$Blockly$BlockSvg.BlockSvg?(a=!a.getParent()&&a.isDeletable(),this.updateWouldDelete_(a&&!b)):this.updateWouldDelete_(a.isDeletable()),this.wouldDelete_},module$exports$Blockly$DeleteArea.DeleteArea.prototype.updateWouldDelete_=function(a){this.wouldDelete_=a};var module$exports$Blockly$FlyoutMetricsManager={FlyoutMetricsManager:function(a,b){this.flyout_=b,module$exports$Blockly$FlyoutMetricsManager.FlyoutMetricsManager.superClass_.constructor.call(this,a)}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$FlyoutMetricsManager.FlyoutMetricsManager,module$exports$Blockly$MetricsManager.MetricsManager),module$exports$Blockly$FlyoutMetricsManager.FlyoutMetricsManager.prototype.getBoundingBox_=function(){try{var a=this.workspace_.getCanvas().getBBox()}catch(b){a={height:0,y:0,width:0,x:0}}return a},module$exports$Blockly$FlyoutMetricsManager.FlyoutMetricsManager.prototype.getContentMetrics=function(a){var b=this.getBoundingBox_();return a=a?1:this.workspace_.scale,{height:b.height*a,width:b.width*a,top:b.y*a,left:b.x*a}},module$exports$Blockly$FlyoutMetricsManager.FlyoutMetricsManager.prototype.getScrollMetrics=function(a,b,c){return b=c||this.getContentMetrics(),c=this.flyout_.MARGIN*this.workspace_.scale,a=a?this.workspace_.scale:1,{height:(b.height+2*c)/a,width:(b.width+b.left+c)/a,top:0,left:0}};var module$exports$Blockly$Flyout={Flyout:function(a){module$exports$Blockly$Flyout.Flyout.superClass_.constructor.call(this),a.setMetrics=this.setMetrics_.bind(this),this.workspace_=new module$exports$Blockly$WorkspaceSvg.WorkspaceSvg(a),this.workspace_.setMetricsManager(new module$exports$Blockly$FlyoutMetricsManager.FlyoutMetricsManager(this.workspace_,this)),this.workspace_.isFlyout=!0,this.workspace_.setVisible(this.isVisible_),this.id=(0,module$exports$Blockly$utils$idGenerator.genUid)(),this.RTL=!!a.RTL,this.horizontalLayout=!1,this.toolboxPosition_=a.toolboxPosition,this.eventWrappers_=[],this.mats_=[],this.buttons_=[],this.listeners_=[],this.permanentlyDisabled_=[],this.tabWidth_=this.workspace_.getRenderer().getConstants().TAB_WIDTH,this.targetWorkspace=null,this.recycledBlocks_=[]}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$Flyout.Flyout,module$exports$Blockly$DeleteArea.DeleteArea),module$exports$Blockly$Flyout.Flyout.prototype.autoClose=!0,module$exports$Blockly$Flyout.Flyout.prototype.isVisible_=!1,module$exports$Blockly$Flyout.Flyout.prototype.containerVisible_=!0,module$exports$Blockly$Flyout.Flyout.prototype.CORNER_RADIUS=8,module$exports$Blockly$Flyout.Flyout.prototype.MARGIN=module$exports$Blockly$Flyout.Flyout.prototype.CORNER_RADIUS,module$exports$Blockly$Flyout.Flyout.prototype.GAP_X=3*module$exports$Blockly$Flyout.Flyout.prototype.MARGIN,module$exports$Blockly$Flyout.Flyout.prototype.GAP_Y=3*module$exports$Blockly$Flyout.Flyout.prototype.MARGIN,module$exports$Blockly$Flyout.Flyout.prototype.SCROLLBAR_MARGIN=2.5,module$exports$Blockly$Flyout.Flyout.prototype.width_=0,module$exports$Blockly$Flyout.Flyout.prototype.height_=0,module$exports$Blockly$Flyout.Flyout.prototype.dragAngleRange_=70,module$exports$Blockly$Flyout.Flyout.prototype.createDom=function(a){return this.svgGroup_=(0,module$exports$Blockly$utils$dom.createSvgElement)(a,{class:"blocklyFlyout",style:"display: none"},null),this.svgBackground_=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.PATH,{class:"blocklyFlyoutBackground"},this.svgGroup_),this.svgGroup_.appendChild(this.workspace_.createDom()),this.workspace_.getThemeManager().subscribe(this.svgBackground_,"flyoutBackgroundColour","fill"),this.workspace_.getThemeManager().subscribe(this.svgBackground_,"flyoutOpacity","fill-opacity"),this.svgGroup_},module$exports$Blockly$Flyout.Flyout.prototype.init=function(a){this.targetWorkspace=a,this.workspace_.targetWorkspace=a,this.workspace_.scrollbar=new module$exports$Blockly$ScrollbarPair.ScrollbarPair(this.workspace_,this.horizontalLayout,!this.horizontalLayout,"blocklyFlyoutScrollbar",this.SCROLLBAR_MARGIN),this.hide(),Array.prototype.push.apply(this.eventWrappers_,(0,module$exports$Blockly$browserEvents.conditionalBind)(this.svgGroup_,"wheel",this,this.wheel_)),this.autoClose||(this.filterWrapper_=this.filterForCapacity_.bind(this),this.targetWorkspace.addChangeListener(this.filterWrapper_)),Array.prototype.push.apply(this.eventWrappers_,(0,module$exports$Blockly$browserEvents.conditionalBind)(this.svgBackground_,"mousedown",this,this.onMouseDown_)),this.workspace_.getGesture=this.targetWorkspace.getGesture.bind(this.targetWorkspace),this.workspace_.setVariableMap(this.targetWorkspace.getVariableMap()),this.workspace_.createPotentialVariableMap(),a.getComponentManager().addComponent({component:this,weight:1,capabilities:[module$exports$Blockly$ComponentManager.ComponentManager.Capability.DELETE_AREA,module$exports$Blockly$ComponentManager.ComponentManager.Capability.DRAG_TARGET]})},module$exports$Blockly$Flyout.Flyout.prototype.dispose=function(){this.hide(),this.workspace_.getComponentManager().removeComponent(this.id),(0,module$exports$Blockly$browserEvents.unbind)(this.eventWrappers_),this.filterWrapper_&&(this.targetWorkspace.removeChangeListener(this.filterWrapper_),this.filterWrapper_=null),this.workspace_&&(this.workspace_.getThemeManager().unsubscribe(this.svgBackground_),this.workspace_.targetWorkspace=null,this.workspace_.dispose(),this.workspace_=null),this.svgGroup_&&((0,module$exports$Blockly$utils$dom.removeNode)(this.svgGroup_),this.svgGroup_=null),this.targetWorkspace=this.svgBackground_=null},module$exports$Blockly$Flyout.Flyout.prototype.getWidth=function(){return this.width_},module$exports$Blockly$Flyout.Flyout.prototype.getHeight=function(){return this.height_},module$exports$Blockly$Flyout.Flyout.prototype.getFlyoutScale=function(){return this.targetWorkspace.scale},module$exports$Blockly$Flyout.Flyout.prototype.getWorkspace=function(){return this.workspace_},module$exports$Blockly$Flyout.Flyout.prototype.isVisible=function(){return this.isVisible_},module$exports$Blockly$Flyout.Flyout.prototype.setVisible=function(a){var b=a!==this.isVisible();this.isVisible_=a,b&&(this.autoClose||this.workspace_.recordDragTargets(),this.updateDisplay_())},module$exports$Blockly$Flyout.Flyout.prototype.setContainerVisible=function(a){var b=a!==this.containerVisible_;this.containerVisible_=a,b&&this.updateDisplay_()},module$exports$Blockly$Flyout.Flyout.prototype.updateDisplay_=function(){var a=!!this.containerVisible_&&this.isVisible();this.svgGroup_.style.display=a?"block":"none",this.workspace_.scrollbar.setContainerVisible(a)},module$exports$Blockly$Flyout.Flyout.prototype.positionAt_=function(a,b,c,d){this.svgGroup_.setAttribute("width",a),this.svgGroup_.setAttribute("height",b),this.workspace_.setCachedParentSvgSize(a,b),"svg"===this.svgGroup_.tagName?(0,module$exports$Blockly$utils$dom.setCssTransform)(this.svgGroup_,"translate("+c+"px,"+d+"px)"):this.svgGroup_.setAttribute("transform","translate("+c+","+d+")"),(a=this.workspace_.scrollbar)&&(a.setOrigin(c,d),a.resize(),a.hScroll&&a.hScroll.setPosition(a.hScroll.position.x,a.hScroll.position.y),a.vScroll&&a.vScroll.setPosition(a.vScroll.position.x,a.vScroll.position.y))},module$exports$Blockly$Flyout.Flyout.prototype.hide=function(){if(this.isVisible()){this.setVisible(!1);for(var b,a=0;b=this.listeners_[a];a++)(0,module$exports$Blockly$browserEvents.unbind)(b);this.listeners_.length=0,this.reflowWrapper_&&(this.workspace_.removeChangeListener(this.reflowWrapper_),this.reflowWrapper_=null)}},module$exports$Blockly$Flyout.Flyout.prototype.show=function(a){this.workspace_.setResizesEnabled(!1),this.hide(),this.clearOldBlocks_(),"string"==typeof a&&(a=this.getDynamicCategoryContents_(a)),this.setVisible(!0),a=(0,module$exports$Blockly$utils$toolbox.convertFlyoutDefToJsonArray)(a),a=this.createFlyoutInfo_(a),this.layout_(a.contents,a.gaps),this.listeners_.push((0,module$exports$Blockly$browserEvents.conditionalBind)(this.svgBackground_,"mouseover",this,(function(){for(var d,b=this.workspace_.getTopBlocks(!1),c=0;d=b[c];c++)d.removeSelect()}))),this.horizontalLayout?this.height_=0:this.width_=0,this.workspace_.setResizesEnabled(!0),this.reflow(),this.filterForCapacity_(),this.position(),this.reflowWrapper_=this.reflow.bind(this),this.workspace_.addChangeListener(this.reflowWrapper_),this.emptyRecycledBlocks_()},module$exports$Blockly$Flyout.Flyout.prototype.createFlyoutInfo_=function(a){var b=[],c=[];this.permanentlyDisabled_.length=0;for(var f,d=this.horizontalLayout?this.GAP_X:this.GAP_Y,e=0;f=a[e];e++)switch(f.custom&&(f=this.getDynamicCategoryContents_(f.custom),f=(0,module$exports$Blockly$utils$toolbox.convertFlyoutDefToJsonArray)(f),a.splice.apply(a,[e,1].concat(f)),f=a[e]),f.kind.toUpperCase()){case"BLOCK":var g=this.createFlyoutBlock_(f);b.push({type:"block",block:g}),this.addBlockGap_(f,c,d);break;case"SEP":this.addSeparatorGap_(f,c,d);break;case"LABEL":f=this.createButton_(f,!0),b.push({type:"button",button:f}),c.push(d);break;case"BUTTON":f=this.createButton_(f,!1),b.push({type:"button",button:f}),c.push(d)}return{contents:b,gaps:c}},module$exports$Blockly$Flyout.Flyout.prototype.getDynamicCategoryContents_=function(a){if("function"!=typeof(a=this.workspace_.targetWorkspace.getToolboxCategoryCallback(a)))throw TypeError("Couldn't find a callback function when opening a toolbox category.");return a(this.workspace_.targetWorkspace)},module$exports$Blockly$Flyout.Flyout.prototype.createButton_=function(a,b){var c=module$exports$Blockly$FlyoutButton.FlyoutButton;if(!c)throw Error("Missing require for Blockly.FlyoutButton");return new c(this.workspace_,this.targetWorkspace,a,b)},module$exports$Blockly$Flyout.Flyout.prototype.createFlyoutBlock_=function(a){var b;return a.blockxml?(a="string"==typeof a.blockxml?(0,$.module$exports$Blockly$Xml.textToDom)(a.blockxml):a.blockxml,(b=this.getRecycledBlock_(a.getAttribute("type")))||(b=(0,$.module$exports$Blockly$Xml.domToBlock)(a,this.workspace_))):(b=this.getRecycledBlock_(a.type))||(void 0===a.enabled&&(a.enabled="true"!==a.disabled&&!0!==a.disabled),b=(0,module$exports$Blockly$serialization$blocks.append)(a,this.workspace_)),b.isEnabled()||this.permanentlyDisabled_.push(b),b},module$exports$Blockly$Flyout.Flyout.prototype.getRecycledBlock_=function(a){for(var b=-1,c=0;c<this.recycledBlocks_.length;c++)if(this.recycledBlocks_[c].type===a){b=c;break}return-1===b?void 0:this.recycledBlocks_.splice(b,1)[0]},module$exports$Blockly$Flyout.Flyout.prototype.addBlockGap_=function(a,b,c){if(a.gap)var d=parseInt(a.gap,10);else a.blockxml&&(a="string"==typeof a.blockxml?(0,$.module$exports$Blockly$Xml.textToDom)(a.blockxml):a.blockxml,d=parseInt(a.getAttribute("gap"),10));b.push(isNaN(d)?c:d)},module$exports$Blockly$Flyout.Flyout.prototype.addSeparatorGap_=function(a,b,c){a=parseInt(a.gap,10),!isNaN(a)&&0<b.length?b[b.length-1]=a:b.push(c)},module$exports$Blockly$Flyout.Flyout.prototype.clearOldBlocks_=function(){for(var c,a=this.workspace_.getTopBlocks(!1),b=0;c=a[b];b++)this.blockIsRecyclable_(c)?this.recycleBlock_(c):c.dispose(!1,!1);for(a=0;a<this.mats_.length;a++)(b=this.mats_[a])&&((0,module$exports$Blockly$Tooltip.unbindMouseEvents)(b),(0,module$exports$Blockly$utils$dom.removeNode)(b));for(a=this.mats_.length=0;b=this.buttons_[a];a++)b.dispose();this.buttons_.length=0,this.workspace_.getPotentialVariableMap().clear()},module$exports$Blockly$Flyout.Flyout.prototype.emptyRecycledBlocks_=function(){for(var a=0;a<this.recycledBlocks_.length;a++)this.recycledBlocks_[a].dispose();this.recycledBlocks_=[]},module$exports$Blockly$Flyout.Flyout.prototype.blockIsRecyclable_=function(a){return!1},module$exports$Blockly$Flyout.Flyout.prototype.recycleBlock_=function(a){var b=a.getRelativeToSurfaceXY();a.moveBy(-b.x,-b.y),this.recycledBlocks_.push(a)},module$exports$Blockly$Flyout.Flyout.prototype.addBlockListeners_=function(a,b,c){this.listeners_.push((0,module$exports$Blockly$browserEvents.conditionalBind)(a,"mousedown",null,this.blockMouseDown_(b))),this.listeners_.push((0,module$exports$Blockly$browserEvents.conditionalBind)(c,"mousedown",null,this.blockMouseDown_(b))),this.listeners_.push((0,module$exports$Blockly$browserEvents.bind)(a,"mouseenter",b,b.addSelect)),this.listeners_.push((0,module$exports$Blockly$browserEvents.bind)(a,"mouseleave",b,b.removeSelect)),this.listeners_.push((0,module$exports$Blockly$browserEvents.bind)(c,"mouseenter",b,b.addSelect)),this.listeners_.push((0,module$exports$Blockly$browserEvents.bind)(c,"mouseleave",b,b.removeSelect))},module$exports$Blockly$Flyout.Flyout.prototype.blockMouseDown_=function(a){var b=this;return function(c){var d=b.targetWorkspace.getGesture(c);d&&(d.setStartBlock(a),d.handleFlyoutStart(c,b))}},module$exports$Blockly$Flyout.Flyout.prototype.onMouseDown_=function(a){var b=this.targetWorkspace.getGesture(a);b&&b.handleFlyoutStart(a,this)},module$exports$Blockly$Flyout.Flyout.prototype.isBlockCreatable_=function(a){return a.isEnabled()},module$exports$Blockly$Flyout.Flyout.prototype.createBlock=function(a){var b=null;(0,module$exports$Blockly$Events$utils.disable)();var c=this.targetWorkspace.getAllVariables();this.targetWorkspace.setResizesEnabled(!1);try{b=this.placeNewBlock_(a)}finally{(0,module$exports$Blockly$Events$utils.enable)()}if(this.targetWorkspace.hideChaff(),a=(0,$.module$exports$Blockly$Variables.getAddedVariables)(this.targetWorkspace,c),(0,module$exports$Blockly$Events$utils.isEnabled)()){for((0,module$exports$Blockly$Events$utils.setGroup)(!0),c=0;c<a.length;c++){var d=a[c];(0,module$exports$Blockly$Events$utils.fire)(new((0,module$exports$Blockly$Events$utils.get)(module$exports$Blockly$Events$utils.VAR_CREATE))(d))}(0,module$exports$Blockly$Events$utils.fire)(new((0,module$exports$Blockly$Events$utils.get)(module$exports$Blockly$Events$utils.CREATE))(b))}return this.autoClose?this.hide():this.filterForCapacity_(),b},module$exports$Blockly$Flyout.Flyout.prototype.initFlyoutButton_=function(a,b,c){var d=a.createDom();a.moveTo(b,c),a.show(),this.listeners_.push((0,module$exports$Blockly$browserEvents.conditionalBind)(d,"mousedown",this,this.onMouseDown_)),this.buttons_.push(a)},module$exports$Blockly$Flyout.Flyout.prototype.createRect_=function(a,b,c,d,e){return(b=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.RECT,{"fill-opacity":0,x:b,y:c,height:d.height,width:d.width},null)).tooltip=a,(0,module$exports$Blockly$Tooltip.bindMouseEvents)(b),this.workspace_.getCanvas().insertBefore(b,a.getSvgRoot()),a.flyoutRect_=b,this.mats_[e]=b},module$exports$Blockly$Flyout.Flyout.prototype.moveRectToBlock_=function(a,b){var c=b.getHeightWidth();a.setAttribute("width",c.width),a.setAttribute("height",c.height),b=b.getRelativeToSurfaceXY(),a.setAttribute("y",b.y),a.setAttribute("x",this.RTL?b.x-c.width:b.x)},module$exports$Blockly$Flyout.Flyout.prototype.filterForCapacity_=function(){for(var c,a=this.workspace_.getTopBlocks(!1),b=0;c=a[b];b++)if(-1===this.permanentlyDisabled_.indexOf(c))for(var d=this.targetWorkspace.isCapacityAvailable((0,$.module$exports$Blockly$common.getBlockTypeCounts)(c));c;)c.setEnabled(d),c=c.getNextBlock()},module$exports$Blockly$Flyout.Flyout.prototype.reflow=function(){this.reflowWrapper_&&this.workspace_.removeChangeListener(this.reflowWrapper_),this.reflowInternal_(),this.reflowWrapper_&&this.workspace_.addChangeListener(this.reflowWrapper_)},module$exports$Blockly$Flyout.Flyout.prototype.isScrollable=function(){return!!this.workspace_.scrollbar&&this.workspace_.scrollbar.isVisible()},module$exports$Blockly$Flyout.Flyout.prototype.placeNewBlock_=function(a){var b=this.targetWorkspace;if(!a.getSvgRoot())throw Error("oldBlock is not rendered.");var c=(0,module$exports$Blockly$serialization$blocks.save)(a);return b.setResizesEnabled(!1),b=(0,module$exports$Blockly$serialization$blocks.append)(c,b),this.positionNewBlock_(a,b),b},module$exports$Blockly$Flyout.Flyout.prototype.positionNewBlock_=function(a,b){var c=this.targetWorkspace,d=c.getOriginOffsetInPixels(),e=this.workspace_.getOriginOffsetInPixels();(a=a.getRelativeToSurfaceXY()).scale(this.workspace_.scale),e=module$exports$Blockly$utils$Coordinate.Coordinate.sum(e,a),(d=module$exports$Blockly$utils$Coordinate.Coordinate.difference(e,d)).scale(1/c.scale),b.moveTo(new module$exports$Blockly$utils$Coordinate.Coordinate(d.x,d.y))};var module$exports$Blockly$VerticalFlyout={VerticalFlyout:function(a){module$exports$Blockly$VerticalFlyout.VerticalFlyout.superClass_.constructor.call(this,a)}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$VerticalFlyout.VerticalFlyout,module$exports$Blockly$Flyout.Flyout),module$exports$Blockly$VerticalFlyout.VerticalFlyout.registryName="verticalFlyout",module$exports$Blockly$VerticalFlyout.VerticalFlyout.prototype.setMetrics_=function(a){if(this.isVisible()){var b=this.workspace_.getMetricsManager(),c=b.getScrollMetrics(),d=b.getViewMetrics();b=b.getAbsoluteMetrics(),"number"==typeof a.y&&(this.workspace_.scrollY=-(c.top+(c.height-d.height)*a.y)),this.workspace_.translate(this.workspace_.scrollX+b.left,this.workspace_.scrollY+b.top)}},module$exports$Blockly$VerticalFlyout.VerticalFlyout.prototype.getX=function(){if(!this.isVisible())return 0;var a=this.targetWorkspace.getMetricsManager(),b=a.getAbsoluteMetrics(),c=a.getViewMetrics();return a=a.getToolboxMetrics(),this.targetWorkspace.toolboxPosition===this.toolboxPosition_?this.targetWorkspace.getToolbox()?this.toolboxPosition_===module$exports$Blockly$utils$toolbox.Position.LEFT?a.width:c.width-this.width_:this.toolboxPosition_===module$exports$Blockly$utils$toolbox.Position.LEFT?0:c.width:this.toolboxPosition_===module$exports$Blockly$utils$toolbox.Position.LEFT?0:c.width+b.left-this.width_},module$exports$Blockly$VerticalFlyout.VerticalFlyout.prototype.getY=function(){return 0},module$exports$Blockly$VerticalFlyout.VerticalFlyout.prototype.position=function(){if(this.isVisible()&&this.targetWorkspace.isVisible()){var a=this.targetWorkspace.getMetricsManager().getViewMetrics();this.height_=a.height,this.setBackgroundPath_(this.width_-this.CORNER_RADIUS,a.height-2*this.CORNER_RADIUS),a=this.getX();var b=this.getY();this.positionAt_(this.width_,this.height_,a,b)}},module$exports$Blockly$VerticalFlyout.VerticalFlyout.prototype.setBackgroundPath_=function(a,b){var c=this.toolboxPosition_===module$exports$Blockly$utils$toolbox.Position.RIGHT,d=a+this.CORNER_RADIUS;(d=["M "+(c?d:0)+",0"]).push("h",c?-a:a),d.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,c?0:1,c?-this.CORNER_RADIUS:this.CORNER_RADIUS,this.CORNER_RADIUS),d.push("v",Math.max(0,b)),d.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,c?0:1,c?this.CORNER_RADIUS:-this.CORNER_RADIUS,this.CORNER_RADIUS),d.push("h",c?a:-a),d.push("z"),this.svgBackground_.setAttribute("d",d.join(" "))},module$exports$Blockly$VerticalFlyout.VerticalFlyout.prototype.scrollToStart=function(){this.workspace_.scrollbar.setY(0)},module$exports$Blockly$VerticalFlyout.VerticalFlyout.prototype.wheel_=function(a){var b=(0,module$exports$Blockly$browserEvents.getScrollDeltaPixels)(a);if(b.y){var c=this.workspace_.getMetricsManager(),d=c.getScrollMetrics();b=c.getViewMetrics().top-d.top+b.y,this.workspace_.scrollbar.setY(b),(0,module$exports$Blockly$WidgetDiv.hide)(),module$exports$Blockly$DropDownDiv.DropDownDiv.hideWithoutAnimation()}a.preventDefault(),a.stopPropagation()},module$exports$Blockly$VerticalFlyout.VerticalFlyout.prototype.layout_=function(a,b){this.workspace_.scale=this.targetWorkspace.scale;for(var f,c=this.MARGIN,d=this.RTL?c:c+this.tabWidth_,e=0;f=a[e];e++)if("block"===f.type){for(var k,g=(f=f.block).getDescendants(!1),h=0;k=g[h];h++)k.isInFlyout=!0;f.render(),g=f.getSvgRoot(),h=f.getHeightWidth(),k=f.outputConnection?d-this.tabWidth_:d,f.moveBy(k,c),k=this.createRect_(f,this.RTL?k-h.width:k,c,h,e),this.addBlockListeners_(g,f,k),c+=h.height+b[e]}else"button"===f.type&&(this.initFlyoutButton_(f.button,d,c),c+=f.button.height+b[e])},module$exports$Blockly$VerticalFlyout.VerticalFlyout.prototype.isDragTowardWorkspace=function(a){a=Math.atan2(a.y,a.x)/Math.PI*180;var b=this.dragAngleRange_;return a<b&&a>-b||a<-180+b||a>180-b},module$exports$Blockly$VerticalFlyout.VerticalFlyout.prototype.getClientRect=function(){if(!this.svgGroup_||this.autoClose||!this.isVisible())return null;var a=this.svgGroup_.getBoundingClientRect(),b=a.left;return this.toolboxPosition_===module$exports$Blockly$utils$toolbox.Position.LEFT?new module$exports$Blockly$utils$Rect.Rect(-1e9,1e9,-1e9,b+a.width):new module$exports$Blockly$utils$Rect.Rect(-1e9,1e9,b,1e9)},module$exports$Blockly$VerticalFlyout.VerticalFlyout.prototype.reflowInternal_=function(){this.workspace_.scale=this.getFlyoutScale();for(var d,a=0,b=this.workspace_.getTopBlocks(!1),c=0;d=b[c];c++){var e=d.getHeightWidth().width;d.outputConnection&&(e-=this.tabWidth_),a=Math.max(a,e)}for(c=0;d=this.buttons_[c];c++)a=Math.max(a,d.width);if(a+=1.5*this.MARGIN+this.tabWidth_,a*=this.workspace_.scale,a+=module$exports$Blockly$Scrollbar.Scrollbar.scrollbarThickness,this.width_!==a){for(c=0;d=b[c];c++){if(this.RTL){e=d.getRelativeToSurfaceXY().x;var f=a/this.workspace_.scale-this.MARGIN;d.outputConnection||(f-=this.tabWidth_),d.moveBy(f-e,0)}d.flyoutRect_&&this.moveRectToBlock_(d.flyoutRect_,d)}if(this.RTL)for(b=0;c=this.buttons_[b];b++)d=c.getPosition().y,c.moveTo(a/this.workspace_.scale-c.width-this.MARGIN-this.tabWidth_,d);this.targetWorkspace.toolboxPosition!==this.toolboxPosition_||this.toolboxPosition_!==module$exports$Blockly$utils$toolbox.Position.LEFT||this.targetWorkspace.getToolbox()||this.targetWorkspace.translate(this.targetWorkspace.scrollX+a,this.targetWorkspace.scrollY),this.width_=a,this.position(),this.targetWorkspace.recordDragTargets()}},(0,module$exports$Blockly$registry.register)(module$exports$Blockly$registry.Type.FLYOUTS_VERTICAL_TOOLBOX,module$exports$Blockly$registry.DEFAULT,module$exports$Blockly$VerticalFlyout.VerticalFlyout);var module$exports$Blockly$ToolboxItem={ToolboxItem:function(a,b,c){this.id_=a.toolboxitemid||(0,module$exports$Blockly$utils$idGenerator.getNextUniqueId)(),this.level_=(this.parent_=c||null)?this.parent_.getLevel()+1:0,this.toolboxItemDef_=a,this.parentToolbox_=b,this.workspace_=this.parentToolbox_.getWorkspace()}};module$exports$Blockly$ToolboxItem.ToolboxItem.prototype.init=function(){},module$exports$Blockly$ToolboxItem.ToolboxItem.prototype.getDiv=function(){return null},module$exports$Blockly$ToolboxItem.ToolboxItem.prototype.getId=function(){return this.id_},module$exports$Blockly$ToolboxItem.ToolboxItem.prototype.getParent=function(){return null},module$exports$Blockly$ToolboxItem.ToolboxItem.prototype.getLevel=function(){return this.level_},module$exports$Blockly$ToolboxItem.ToolboxItem.prototype.isSelectable=function(){return!1},module$exports$Blockly$ToolboxItem.ToolboxItem.prototype.isCollapsible=function(){return!1},module$exports$Blockly$ToolboxItem.ToolboxItem.prototype.dispose=function(){};var module$exports$Blockly$ToolboxCategory={ToolboxCategory:function(a,b,c){module$exports$Blockly$ToolboxCategory.ToolboxCategory.superClass_.constructor.call(this,a,b,c),this.name_=(0,module$exports$Blockly$utils$parsing.replaceMessageReferences)(a.name),this.colour_=this.getColour_(a),this.labelDom_=this.iconDom_=this.rowContents_=this.rowDiv_=this.htmlDiv_=null,this.cssConfig_=this.makeDefaultCssConfig_(),(0,$.module$exports$Blockly$utils$object.mixin)(this.cssConfig_,a.cssconfig||a.cssConfig),this.isDisabled_=this.isHidden_=!1,this.flyoutItems_=[],this.parseContents_(a)}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$ToolboxCategory.ToolboxCategory,module$exports$Blockly$ToolboxItem.ToolboxItem),module$exports$Blockly$ToolboxCategory.ToolboxCategory.registrationName="category",module$exports$Blockly$ToolboxCategory.ToolboxCategory.nestedPadding=19,module$exports$Blockly$ToolboxCategory.ToolboxCategory.borderWidth=8,module$exports$Blockly$ToolboxCategory.ToolboxCategory.defaultBackgroundColour="#57e",module$exports$Blockly$ToolboxCategory.ToolboxCategory.prototype.makeDefaultCssConfig_=function(){return{container:"blocklyToolboxCategory",row:"blocklyTreeRow",rowcontentcontainer:"blocklyTreeRowContentContainer",icon:"blocklyTreeIcon",label:"blocklyTreeLabel",contents:"blocklyToolboxContents",selected:"blocklyTreeSelected",openicon:"blocklyTreeIconOpen",closedicon:"blocklyTreeIconClosed"}},module$exports$Blockly$ToolboxCategory.ToolboxCategory.prototype.parseContents_=function(a){var b=a.contents;if(a.custom)this.flyoutItems_=a.custom;else if(b)for(a=0;a<b.length;a++)this.flyoutItems_.push(b[a])},module$exports$Blockly$ToolboxCategory.ToolboxCategory.prototype.init=function(){this.createDom_(),"true"===this.toolboxItemDef_.hidden&&this.hide()},module$exports$Blockly$ToolboxCategory.ToolboxCategory.prototype.createDom_=function(){return this.htmlDiv_=this.createContainer_(),(0,module$exports$Blockly$utils$aria.setRole)(this.htmlDiv_,module$exports$Blockly$utils$aria.Role.TREEITEM),(0,module$exports$Blockly$utils$aria.setState)(this.htmlDiv_,module$exports$Blockly$utils$aria.State.SELECTED,!1),(0,module$exports$Blockly$utils$aria.setState)(this.htmlDiv_,module$exports$Blockly$utils$aria.State.LEVEL,this.level_),this.rowDiv_=this.createRowContainer_(),this.rowDiv_.style.pointerEvents="auto",this.htmlDiv_.appendChild(this.rowDiv_),this.rowContents_=this.createRowContentsContainer_(),this.rowContents_.style.pointerEvents="none",this.rowDiv_.appendChild(this.rowContents_),this.iconDom_=this.createIconDom_(),(0,module$exports$Blockly$utils$aria.setRole)(this.iconDom_,module$exports$Blockly$utils$aria.Role.PRESENTATION),this.rowContents_.appendChild(this.iconDom_),this.labelDom_=this.createLabelDom_(this.name_),this.rowContents_.appendChild(this.labelDom_),(0,module$exports$Blockly$utils$aria.setState)(this.htmlDiv_,module$exports$Blockly$utils$aria.State.LABELLEDBY,this.labelDom_.getAttribute("id")),this.addColourBorder_(this.colour_),this.htmlDiv_},module$exports$Blockly$ToolboxCategory.ToolboxCategory.prototype.createContainer_=function(){var a=document.createElement("div");return(0,module$exports$Blockly$utils$dom.addClass)(a,this.cssConfig_.container),a},module$exports$Blockly$ToolboxCategory.ToolboxCategory.prototype.createRowContainer_=function(){var a=document.createElement("div");(0,module$exports$Blockly$utils$dom.addClass)(a,this.cssConfig_.row);var b=module$exports$Blockly$ToolboxCategory.ToolboxCategory.nestedPadding*this.getLevel();return b=b.toString()+"px",this.workspace_.RTL?a.style.paddingRight=b:a.style.paddingLeft=b,a},module$exports$Blockly$ToolboxCategory.ToolboxCategory.prototype.createRowContentsContainer_=function(){var a=document.createElement("div");return(0,module$exports$Blockly$utils$dom.addClass)(a,this.cssConfig_.rowcontentcontainer),a},module$exports$Blockly$ToolboxCategory.ToolboxCategory.prototype.createIconDom_=function(){var a=document.createElement("span");return this.parentToolbox_.isHorizontal()||(0,module$exports$Blockly$utils$dom.addClass)(a,this.cssConfig_.icon),a.style.display="inline-block",a},module$exports$Blockly$ToolboxCategory.ToolboxCategory.prototype.createLabelDom_=function(a){var b=document.createElement("span");return b.setAttribute("id",this.getId()+".label"),b.textContent=a,(0,module$exports$Blockly$utils$dom.addClass)(b,this.cssConfig_.label),b},module$exports$Blockly$ToolboxCategory.ToolboxCategory.prototype.refreshTheme=function(){this.colour_=this.getColour_(this.toolboxItemDef_),this.addColourBorder_(this.colour_)},module$exports$Blockly$ToolboxCategory.ToolboxCategory.prototype.addColourBorder_=function(a){a&&(a=module$exports$Blockly$ToolboxCategory.ToolboxCategory.borderWidth+"px solid "+(a||"#ddd"),this.workspace_.RTL?this.rowDiv_.style.borderRight=a:this.rowDiv_.style.borderLeft=a)},module$exports$Blockly$ToolboxCategory.ToolboxCategory.prototype.getColour_=function(a){var b=a.categorystyle||a.categoryStyle;return(a=a.colour)&&b?(console.warn('Toolbox category "'+this.name_+'" must not have both a style and a colour'),""):b?this.getColourfromStyle_(b):this.parseColour_(a)},module$exports$Blockly$ToolboxCategory.ToolboxCategory.prototype.getColourfromStyle_=function(a){var b=this.workspace_.getTheme();if(a&&b){if((b=b.categoryStyles[a])&&b.colour)return this.parseColour_(b.colour);console.warn('Style "'+a+'" must exist and contain a colour value')}return""},module$exports$Blockly$ToolboxCategory.ToolboxCategory.prototype.getClickTarget=function(){return this.rowDiv_},module$exports$Blockly$ToolboxCategory.ToolboxCategory.prototype.parseColour_=function(a){if(null==(a=(0,module$exports$Blockly$utils$parsing.replaceMessageReferences)(a))||""===a)return"";var b=Number(a);return isNaN(b)?(b=(0,module$exports$Blockly$utils$colour.parse)(a))?b:(console.warn('Toolbox category "'+this.name_+'" has unrecognized colour attribute: '+a),""):(0,module$exports$Blockly$utils$colour.hueToHex)(b)},module$exports$Blockly$ToolboxCategory.ToolboxCategory.prototype.openIcon_=function(a){a&&((0,module$exports$Blockly$utils$dom.removeClasses)(a,this.cssConfig_.closedicon),(0,module$exports$Blockly$utils$dom.addClass)(a,this.cssConfig_.openicon))},module$exports$Blockly$ToolboxCategory.ToolboxCategory.prototype.closeIcon_=function(a){a&&((0,module$exports$Blockly$utils$dom.removeClasses)(a,this.cssConfig_.openicon),(0,module$exports$Blockly$utils$dom.addClass)(a,this.cssConfig_.closedicon))},module$exports$Blockly$ToolboxCategory.ToolboxCategory.prototype.setVisible_=function(a){this.htmlDiv_.style.display=a?"block":"none",this.isHidden_=!a,this.parentToolbox_.getSelectedItem()===this&&this.parentToolbox_.clearSelection()},module$exports$Blockly$ToolboxCategory.ToolboxCategory.prototype.hide=function(){this.setVisible_(!1)},module$exports$Blockly$ToolboxCategory.ToolboxCategory.prototype.show=function(){this.setVisible_(!0)},module$exports$Blockly$ToolboxCategory.ToolboxCategory.prototype.isVisible=function(){return!this.isHidden_&&this.allAncestorsExpanded_()},module$exports$Blockly$ToolboxCategory.ToolboxCategory.prototype.allAncestorsExpanded_=function(){for(var a=this;a.getParent();)if(!(a=a.getParent()).isExpanded())return!1;return!0},module$exports$Blockly$ToolboxCategory.ToolboxCategory.prototype.isSelectable=function(){return this.isVisible()&&!this.isDisabled_},module$exports$Blockly$ToolboxCategory.ToolboxCategory.prototype.onClick=function(a){},module$exports$Blockly$ToolboxCategory.ToolboxCategory.prototype.setSelected=function(a){if(a){var b=this.parseColour_(module$exports$Blockly$ToolboxCategory.ToolboxCategory.defaultBackgroundColour);this.rowDiv_.style.backgroundColor=this.colour_||b,(0,module$exports$Blockly$utils$dom.addClass)(this.rowDiv_,this.cssConfig_.selected)}else this.rowDiv_.style.backgroundColor="",(0,module$exports$Blockly$utils$dom.removeClass)(this.rowDiv_,this.cssConfig_.selected);(0,module$exports$Blockly$utils$aria.setState)(this.htmlDiv_,module$exports$Blockly$utils$aria.State.SELECTED,a)},module$exports$Blockly$ToolboxCategory.ToolboxCategory.prototype.setDisabled=function(a){this.isDisabled_=a,this.getDiv().setAttribute("disabled",a),a?this.getDiv().setAttribute("disabled","true"):this.getDiv().removeAttribute("disabled")},module$exports$Blockly$ToolboxCategory.ToolboxCategory.prototype.getName=function(){return this.name_},module$exports$Blockly$ToolboxCategory.ToolboxCategory.prototype.getParent=function(){return this.parent_},module$exports$Blockly$ToolboxCategory.ToolboxCategory.prototype.getDiv=function(){return this.htmlDiv_},module$exports$Blockly$ToolboxCategory.ToolboxCategory.prototype.getContents=function(){return this.flyoutItems_},module$exports$Blockly$ToolboxCategory.ToolboxCategory.prototype.updateFlyoutContents=function(a){this.flyoutItems_=[],"string"==typeof a?this.toolboxItemDef_.custom=a:(delete this.toolboxItemDef_.custom,this.toolboxItemDef_.contents=(0,module$exports$Blockly$utils$toolbox.convertFlyoutDefToJsonArray)(a)),this.parseContents_(this.toolboxItemDef_)},module$exports$Blockly$ToolboxCategory.ToolboxCategory.prototype.dispose=function(){(0,module$exports$Blockly$utils$dom.removeNode)(this.htmlDiv_)},(0,module$exports$Blockly$Css.register)('\n  .blocklyTreeRow:not(.blocklyTreeSelected):hover {\n    background-color: rgba(255, 255, 255, 0.2);\n  }\n\n  .blocklyToolboxDiv[layout="h"] .blocklyToolboxCategory {\n    margin: 1px 5px 1px 0;\n  }\n\n  .blocklyToolboxDiv[dir="RTL"][layout="h"] .blocklyToolboxCategory {\n    margin: 1px 0 1px 5px;\n  }\n\n  .blocklyTreeRow {\n    height: 22px;\n    line-height: 22px;\n    margin-bottom: 3px;\n    padding-right: 8px;\n    white-space: nowrap;\n  }\n\n  .blocklyToolboxDiv[dir="RTL"] .blocklyTreeRow {\n    margin-left: 8px;\n    padding-right: 0;\n  }\n\n  .blocklyTreeIcon {\n    background-image: url(<<<PATH>>>/sprites.png);\n    height: 16px;\n    vertical-align: middle;\n    visibility: hidden;\n    width: 16px;\n  }\n\n  .blocklyTreeIconClosed {\n    background-position: -32px -1px;\n  }\n\n  .blocklyToolboxDiv[dir="RTL"] .blocklyTreeIconClosed {\n    background-position: 0 -1px;\n  }\n\n  .blocklyTreeSelected>.blocklyTreeIconClosed {\n    background-position: -32px -17px;\n  }\n\n  .blocklyToolboxDiv[dir="RTL"] .blocklyTreeSelected>.blocklyTreeIconClosed {\n    background-position: 0 -17px;\n  }\n\n  .blocklyTreeIconOpen {\n    background-position: -16px -1px;\n  }\n\n  .blocklyTreeSelected>.blocklyTreeIconOpen {\n    background-position: -16px -17px;\n  }\n\n  .blocklyTreeLabel {\n    cursor: default;\n    font: 16px sans-serif;\n    padding: 0 3px;\n    vertical-align: middle;\n  }\n\n  .blocklyToolboxDelete .blocklyTreeLabel {\n    cursor: url("<<<PATH>>>/handdelete.cur"), auto;\n  }\n\n  .blocklyTreeSelected .blocklyTreeLabel {\n    color: #fff;\n  }\n'),(0,module$exports$Blockly$registry.register)(module$exports$Blockly$registry.Type.TOOLBOX_ITEM,module$exports$Blockly$ToolboxCategory.ToolboxCategory.registrationName,module$exports$Blockly$ToolboxCategory.ToolboxCategory);var module$exports$Blockly$ToolboxSeparator={ToolboxSeparator:function(a,b){module$exports$Blockly$ToolboxSeparator.ToolboxSeparator.superClass_.constructor.call(this,a,b),this.cssConfig_={container:"blocklyTreeSeparator"},(0,$.module$exports$Blockly$utils$object.mixin)(this.cssConfig_,a.cssconfig||a.cssConfig)}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$ToolboxSeparator.ToolboxSeparator,module$exports$Blockly$ToolboxItem.ToolboxItem),module$exports$Blockly$ToolboxSeparator.ToolboxSeparator.registrationName="sep",module$exports$Blockly$ToolboxSeparator.ToolboxSeparator.prototype.init=function(){this.createDom_()},module$exports$Blockly$ToolboxSeparator.ToolboxSeparator.prototype.createDom_=function(){var a=document.createElement("div");return(0,module$exports$Blockly$utils$dom.addClass)(a,this.cssConfig_.container),this.htmlDiv_=a},module$exports$Blockly$ToolboxSeparator.ToolboxSeparator.prototype.getDiv=function(){return this.htmlDiv_},module$exports$Blockly$ToolboxSeparator.ToolboxSeparator.prototype.dispose=function(){(0,module$exports$Blockly$utils$dom.removeNode)(this.htmlDiv_)},(0,module$exports$Blockly$Css.register)('\n  .blocklyTreeSeparator {\n    border-bottom: solid #e5e5e5 1px;\n    height: 0;\n    margin: 5px 0;\n  }\n\n  .blocklyToolboxDiv[layout="h"] .blocklyTreeSeparator {\n    border-right: solid #e5e5e5 1px;\n    border-bottom: none;\n    height: auto;\n    margin: 0 5px 0 5px;\n    padding: 5px 0;\n    width: 0;\n  }\n'),(0,module$exports$Blockly$registry.register)(module$exports$Blockly$registry.Type.TOOLBOX_ITEM,module$exports$Blockly$ToolboxSeparator.ToolboxSeparator.registrationName,module$exports$Blockly$ToolboxSeparator.ToolboxSeparator);var module$exports$Blockly$CollapsibleToolboxCategory={CollapsibleToolboxCategory:function(a,b,c){this.subcategoriesDiv_=null,this.expanded_=!1,this.toolboxItems_=[],module$exports$Blockly$CollapsibleToolboxCategory.CollapsibleToolboxCategory.superClass_.constructor.call(this,a,b,c)}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$CollapsibleToolboxCategory.CollapsibleToolboxCategory,module$exports$Blockly$ToolboxCategory.ToolboxCategory),module$exports$Blockly$CollapsibleToolboxCategory.CollapsibleToolboxCategory.registrationName="collapsibleCategory",module$exports$Blockly$CollapsibleToolboxCategory.CollapsibleToolboxCategory.prototype.makeDefaultCssConfig_=function(){var a=module$exports$Blockly$CollapsibleToolboxCategory.CollapsibleToolboxCategory.superClass_.makeDefaultCssConfig_.call(this);return a.contents="blocklyToolboxContents",a},module$exports$Blockly$CollapsibleToolboxCategory.CollapsibleToolboxCategory.prototype.parseContents_=function(a){var b=a.contents,c=!0;if(a.custom)this.flyoutItems_=a.custom;else if(b)for(a=0;a<b.length;a++){var d=b[a];!(0,module$exports$Blockly$registry.hasItem)(module$exports$Blockly$registry.Type.TOOLBOX_ITEM,d.kind)||d.kind.toLowerCase()===module$exports$Blockly$ToolboxSeparator.ToolboxSeparator.registrationName&&c?(this.flyoutItems_.push(d),c=!0):(this.createToolboxItem_(d),c=!1)}},module$exports$Blockly$CollapsibleToolboxCategory.CollapsibleToolboxCategory.prototype.createToolboxItem_=function(a){var b=a.kind;"CATEGORY"==b.toUpperCase()&&(0,module$exports$Blockly$utils$toolbox.isCategoryCollapsible)(a)&&(b=module$exports$Blockly$CollapsibleToolboxCategory.CollapsibleToolboxCategory.registrationName),a=new((0,module$exports$Blockly$registry.getClass)(module$exports$Blockly$registry.Type.TOOLBOX_ITEM,b))(a,this.parentToolbox_,this),this.toolboxItems_.push(a)},module$exports$Blockly$CollapsibleToolboxCategory.CollapsibleToolboxCategory.prototype.init=function(){module$exports$Blockly$CollapsibleToolboxCategory.CollapsibleToolboxCategory.superClass_.init.call(this),this.setExpanded("true"===this.toolboxItemDef_.expanded||this.toolboxItemDef_.expanded)},module$exports$Blockly$CollapsibleToolboxCategory.CollapsibleToolboxCategory.prototype.createDom_=function(){module$exports$Blockly$CollapsibleToolboxCategory.CollapsibleToolboxCategory.superClass_.createDom_.call(this);var a=this.getChildToolboxItems();return this.subcategoriesDiv_=this.createSubCategoriesDom_(a),(0,module$exports$Blockly$utils$aria.setRole)(this.subcategoriesDiv_,module$exports$Blockly$utils$aria.Role.GROUP),this.htmlDiv_.appendChild(this.subcategoriesDiv_),this.htmlDiv_},module$exports$Blockly$CollapsibleToolboxCategory.CollapsibleToolboxCategory.prototype.createIconDom_=function(){var a=document.createElement("span");return this.parentToolbox_.isHorizontal()||((0,module$exports$Blockly$utils$dom.addClass)(a,this.cssConfig_.icon),a.style.visibility="visible"),a.style.display="inline-block",a},module$exports$Blockly$CollapsibleToolboxCategory.CollapsibleToolboxCategory.prototype.createSubCategoriesDom_=function(a){var b=document.createElement("div");(0,module$exports$Blockly$utils$dom.addClass)(b,this.cssConfig_.contents);for(var c=0;c<a.length;c++){var d=a[c];d.init();var e=d.getDiv();b.appendChild(e),d.getClickTarget&&d.getClickTarget().setAttribute("id",d.getId())}return b},module$exports$Blockly$CollapsibleToolboxCategory.CollapsibleToolboxCategory.prototype.setExpanded=function(a){this.expanded_!==a&&((this.expanded_=a)?(this.subcategoriesDiv_.style.display="block",this.openIcon_(this.iconDom_)):(this.subcategoriesDiv_.style.display="none",this.closeIcon_(this.iconDom_)),(0,module$exports$Blockly$utils$aria.setState)(this.htmlDiv_,module$exports$Blockly$utils$aria.State.EXPANDED,a),this.parentToolbox_.handleToolboxItemResize())},module$exports$Blockly$CollapsibleToolboxCategory.CollapsibleToolboxCategory.prototype.setVisible_=function(a){this.htmlDiv_.style.display=a?"block":"none";for(var b=this.getChildToolboxItems(),c=0;c<b.length;c++)b[c].setVisible_(a);this.isHidden_=!a,this.parentToolbox_.getSelectedItem()===this&&this.parentToolbox_.clearSelection()},module$exports$Blockly$CollapsibleToolboxCategory.CollapsibleToolboxCategory.prototype.isExpanded=function(){return this.expanded_},module$exports$Blockly$CollapsibleToolboxCategory.CollapsibleToolboxCategory.prototype.isCollapsible=function(){return!0},module$exports$Blockly$CollapsibleToolboxCategory.CollapsibleToolboxCategory.prototype.onClick=function(a){this.toggleExpanded()},module$exports$Blockly$CollapsibleToolboxCategory.CollapsibleToolboxCategory.prototype.toggleExpanded=function(){this.setExpanded(!this.expanded_)},module$exports$Blockly$CollapsibleToolboxCategory.CollapsibleToolboxCategory.prototype.getDiv=function(){return this.htmlDiv_},module$exports$Blockly$CollapsibleToolboxCategory.CollapsibleToolboxCategory.prototype.getChildToolboxItems=function(){return this.toolboxItems_},(0,module$exports$Blockly$registry.register)(module$exports$Blockly$registry.Type.TOOLBOX_ITEM,module$exports$Blockly$CollapsibleToolboxCategory.CollapsibleToolboxCategory.registrationName,module$exports$Blockly$CollapsibleToolboxCategory.CollapsibleToolboxCategory);var module$exports$Blockly$Events$ToolboxItemSelect={ToolboxItemSelect:function(a,b,c){module$exports$Blockly$Events$ToolboxItemSelect.ToolboxItemSelect.superClass_.constructor.call(this,c),this.oldItem=a,this.newItem=b}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$Events$ToolboxItemSelect.ToolboxItemSelect,module$exports$Blockly$Events$UiBase.UiBase),module$exports$Blockly$Events$ToolboxItemSelect.ToolboxItemSelect.prototype.type=module$exports$Blockly$Events$utils.TOOLBOX_ITEM_SELECT,module$exports$Blockly$Events$ToolboxItemSelect.ToolboxItemSelect.prototype.toJson=function(){var a=module$exports$Blockly$Events$ToolboxItemSelect.ToolboxItemSelect.superClass_.toJson.call(this);return a.oldItem=this.oldItem,a.newItem=this.newItem,a},module$exports$Blockly$Events$ToolboxItemSelect.ToolboxItemSelect.prototype.fromJson=function(a){module$exports$Blockly$Events$ToolboxItemSelect.ToolboxItemSelect.superClass_.fromJson.call(this,a),this.oldItem=a.oldItem,this.newItem=a.newItem},(0,module$exports$Blockly$registry.register)(module$exports$Blockly$registry.Type.EVENT,module$exports$Blockly$Events$utils.TOOLBOX_ITEM_SELECT,module$exports$Blockly$Events$ToolboxItemSelect.ToolboxItemSelect);var module$exports$Blockly$Toolbox={Toolbox:function(a){module$exports$Blockly$Toolbox.Toolbox.superClass_.constructor.call(this),this.workspace_=a,this.id="toolbox",this.toolboxDef_=a.options.languageTree||{contents:[]},this.horizontalLayout_=a.options.horizontalLayout,this.contentsDiv_=this.HtmlDiv=null,this.isVisible_=!1,this.contents_=[],this.height_=this.width_=0,this.RTL=a.options.RTL,this.flyout_=null,this.contentMap_=Object.create(null),this.toolboxPosition=a.options.toolboxPosition,this.previouslySelectedItem_=this.selectedItem_=null,this.boundEvents_=[]}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$Toolbox.Toolbox,module$exports$Blockly$DeleteArea.DeleteArea),module$exports$Blockly$Toolbox.Toolbox.prototype.onShortcut=function(a){return!1},module$exports$Blockly$Toolbox.Toolbox.prototype.init=function(){var a=this.workspace_,b=a.getParentSvg();this.flyout_=this.createFlyout_(),this.HtmlDiv=this.createDom_(this.workspace_),(0,module$exports$Blockly$utils$dom.insertAfter)(this.flyout_.createDom("svg"),b),this.setVisible(!0),this.flyout_.init(a),this.render(this.toolboxDef_),(a=a.getThemeManager()).subscribe(this.HtmlDiv,"toolboxBackgroundColour","background-color"),a.subscribe(this.HtmlDiv,"toolboxForegroundColour","color"),this.workspace_.getComponentManager().addComponent({component:this,weight:1,capabilities:[module$exports$Blockly$ComponentManager.ComponentManager.Capability.AUTOHIDEABLE,module$exports$Blockly$ComponentManager.ComponentManager.Capability.DELETE_AREA,module$exports$Blockly$ComponentManager.ComponentManager.Capability.DRAG_TARGET]})},module$exports$Blockly$Toolbox.Toolbox.prototype.createDom_=function(a){a=a.getParentSvg();var b=this.createContainer_();return this.contentsDiv_=this.createContentsContainer_(),this.contentsDiv_.tabIndex=0,(0,module$exports$Blockly$utils$aria.setRole)(this.contentsDiv_,module$exports$Blockly$utils$aria.Role.TREE),b.appendChild(this.contentsDiv_),a.parentNode.insertBefore(b,a),this.attachEvents_(b,this.contentsDiv_),b},module$exports$Blockly$Toolbox.Toolbox.prototype.createContainer_=function(){var a=document.createElement("div");return a.setAttribute("layout",this.isHorizontal()?"h":"v"),(0,module$exports$Blockly$utils$dom.addClass)(a,"blocklyToolboxDiv"),(0,module$exports$Blockly$utils$dom.addClass)(a,"blocklyNonSelectable"),a.setAttribute("dir",this.RTL?"RTL":"LTR"),a},module$exports$Blockly$Toolbox.Toolbox.prototype.createContentsContainer_=function(){var a=document.createElement("div");return(0,module$exports$Blockly$utils$dom.addClass)(a,"blocklyToolboxContents"),this.isHorizontal()&&(a.style.flexDirection="row"),a},module$exports$Blockly$Toolbox.Toolbox.prototype.attachEvents_=function(a,b){a=(0,module$exports$Blockly$browserEvents.conditionalBind)(a,"click",this,this.onClick_,!1,!0),this.boundEvents_.push(a),b=(0,module$exports$Blockly$browserEvents.conditionalBind)(b,"keydown",this,this.onKeyDown_,!1,!0),this.boundEvents_.push(b)},module$exports$Blockly$Toolbox.Toolbox.prototype.onClick_=function(a){if((0,module$exports$Blockly$browserEvents.isRightButton)(a)||a.target===this.HtmlDiv)(0,$.module$exports$Blockly$common.getMainWorkspace)().hideChaff(!1);else{var b=a.target.getAttribute("id");b&&(b=this.getToolboxItemById(b)).isSelectable()&&(this.setSelectedItem(b),b.onClick(a)),(0,$.module$exports$Blockly$common.getMainWorkspace)().hideChaff(!0)}(0,module$exports$Blockly$Touch.clearTouchIdentifier)()},module$exports$Blockly$Toolbox.Toolbox.prototype.onKeyDown_=function(a){var b=!1;switch(a.keyCode){case module$exports$Blockly$utils$KeyCodes_KeyCodes.DOWN:b=this.selectNext_();break;case module$exports$Blockly$utils$KeyCodes_KeyCodes.UP:b=this.selectPrevious_();break;case module$exports$Blockly$utils$KeyCodes_KeyCodes.LEFT:b=this.selectParent_();break;case module$exports$Blockly$utils$KeyCodes_KeyCodes.RIGHT:b=this.selectChild_();break;case module$exports$Blockly$utils$KeyCodes_KeyCodes.ENTER:case module$exports$Blockly$utils$KeyCodes_KeyCodes.SPACE:this.selectedItem_&&this.selectedItem_.isCollapsible()&&(this.selectedItem_.toggleExpanded(),b=!0);break;default:b=!1}!b&&this.selectedItem_&&this.selectedItem_.onKeyDown&&(b=this.selectedItem_.onKeyDown(a)),b&&a.preventDefault()},module$exports$Blockly$Toolbox.Toolbox.prototype.createFlyout_=function(){var a=this.workspace_,b=new module$exports$Blockly$Options.Options({parentWorkspace:a,rtl:a.RTL,oneBasedIndex:a.options.oneBasedIndex,horizontalLayout:a.horizontalLayout,renderer:a.options.renderer,rendererOverrides:a.options.rendererOverrides,move:{scrollbars:!0}});return b.toolboxPosition=a.options.toolboxPosition,new(a.horizontalLayout?(0,module$exports$Blockly$registry.getClassFromOptions)(module$exports$Blockly$registry.Type.FLYOUTS_HORIZONTAL_TOOLBOX,a.options,!0):(0,module$exports$Blockly$registry.getClassFromOptions)(module$exports$Blockly$registry.Type.FLYOUTS_VERTICAL_TOOLBOX,a.options,!0))(b)},module$exports$Blockly$Toolbox.Toolbox.prototype.render=function(a){this.toolboxDef_=a;for(var b=0;b<this.contents_.length;b++){var c=this.contents_[b];c&&c.dispose()}this.contents_=[],this.contentMap_=Object.create(null),this.renderContents_(a.contents),this.position(),this.handleToolboxItemResize()},module$exports$Blockly$Toolbox.Toolbox.prototype.renderContents_=function(a){for(var b=document.createDocumentFragment(),c=0;c<a.length;c++)this.createToolboxItem_(a[c],b);this.contentsDiv_.appendChild(b)},module$exports$Blockly$Toolbox.Toolbox.prototype.createToolboxItem_=function(a,b){var c=a.kind;"CATEGORY"===c.toUpperCase()&&(0,module$exports$Blockly$utils$toolbox.isCategoryCollapsible)(a)&&(c=module$exports$Blockly$CollapsibleToolboxCategory.CollapsibleToolboxCategory.registrationName),(c=(0,module$exports$Blockly$registry.getClass)(module$exports$Blockly$registry.Type.TOOLBOX_ITEM,c.toLowerCase()))&&(a=new c(a,this),this.addToolboxItem_(a),a.init(),(c=a.getDiv())&&b.appendChild(c),a.getClickTarget&&a.getClickTarget().setAttribute("id",a.getId()))},module$exports$Blockly$Toolbox.Toolbox.prototype.addToolboxItem_=function(a){if(this.contents_.push(a),this.contentMap_[a.getId()]=a,a.isCollapsible()){a=a.getChildToolboxItems();for(var b=0;b<a.length;b++)this.addToolboxItem_(a[b])}},module$exports$Blockly$Toolbox.Toolbox.prototype.getToolboxItems=function(){return this.contents_},module$exports$Blockly$Toolbox.Toolbox.prototype.addStyle=function(a){(0,module$exports$Blockly$utils$dom.addClass)(this.HtmlDiv,a)},module$exports$Blockly$Toolbox.Toolbox.prototype.removeStyle=function(a){(0,module$exports$Blockly$utils$dom.removeClass)(this.HtmlDiv,a)},module$exports$Blockly$Toolbox.Toolbox.prototype.getClientRect=function(){if(!this.HtmlDiv||!this.isVisible_)return null;var a=this.HtmlDiv.getBoundingClientRect(),b=a.top,c=b+a.height,d=a.left;return a=d+a.width,this.toolboxPosition===module$exports$Blockly$utils$toolbox.Position.TOP?new module$exports$Blockly$utils$Rect.Rect(-1e7,c,-1e7,1e7):this.toolboxPosition===module$exports$Blockly$utils$toolbox.Position.BOTTOM?new module$exports$Blockly$utils$Rect.Rect(b,1e7,-1e7,1e7):this.toolboxPosition===module$exports$Blockly$utils$toolbox.Position.LEFT?new module$exports$Blockly$utils$Rect.Rect(-1e7,1e7,-1e7,a):new module$exports$Blockly$utils$Rect.Rect(-1e7,1e7,d,1e7)},module$exports$Blockly$Toolbox.Toolbox.prototype.wouldDelete=function(a,b){return a instanceof module$exports$Blockly$BlockSvg.BlockSvg?this.updateWouldDelete_(!a.getParent()&&a.isDeletable()):this.updateWouldDelete_(a.isDeletable()),this.wouldDelete_},module$exports$Blockly$Toolbox.Toolbox.prototype.onDragEnter=function(a){this.updateCursorDeleteStyle_(!0)},module$exports$Blockly$Toolbox.Toolbox.prototype.onDragExit=function(a){this.updateCursorDeleteStyle_(!1)},module$exports$Blockly$Toolbox.Toolbox.prototype.onDrop=function(a){this.updateCursorDeleteStyle_(!1)},module$exports$Blockly$Toolbox.Toolbox.prototype.updateWouldDelete_=function(a){a!==this.wouldDelete_&&(this.updateCursorDeleteStyle_(!1),this.wouldDelete_=a,this.updateCursorDeleteStyle_(!0))},module$exports$Blockly$Toolbox.Toolbox.prototype.updateCursorDeleteStyle_=function(a){var b=this.wouldDelete_?"blocklyToolboxDelete":"blocklyToolboxGrab";a?this.addStyle(b):this.removeStyle(b)},module$exports$Blockly$Toolbox.Toolbox.prototype.getToolboxItemById=function(a){return this.contentMap_[a]||null},module$exports$Blockly$Toolbox.Toolbox.prototype.getWidth=function(){return this.width_},module$exports$Blockly$Toolbox.Toolbox.prototype.getHeight=function(){return this.height_},module$exports$Blockly$Toolbox.Toolbox.prototype.getFlyout=function(){return this.flyout_},module$exports$Blockly$Toolbox.Toolbox.prototype.getWorkspace=function(){return this.workspace_},module$exports$Blockly$Toolbox.Toolbox.prototype.getSelectedItem=function(){return this.selectedItem_},module$exports$Blockly$Toolbox.Toolbox.prototype.getPreviouslySelectedItem=function(){return this.previouslySelectedItem_},module$exports$Blockly$Toolbox.Toolbox.prototype.isHorizontal=function(){return this.horizontalLayout_},module$exports$Blockly$Toolbox.Toolbox.prototype.position=function(){var a=this.workspace_.getMetrics(),b=this.HtmlDiv;b&&(this.horizontalLayout_?(b.style.left="0",b.style.height="auto",b.style.width="100%",this.height_=b.offsetHeight,this.width_=a.viewWidth,this.toolboxPosition===module$exports$Blockly$utils$toolbox.Position.TOP?b.style.top="0":b.style.bottom="0"):(this.toolboxPosition===module$exports$Blockly$utils$toolbox.Position.RIGHT?b.style.right="0":b.style.left="0",b.style.height="100%",this.width_=b.offsetWidth,this.height_=a.viewHeight),this.flyout_.position())},module$exports$Blockly$Toolbox.Toolbox.prototype.handleToolboxItemResize=function(){var a=this.workspace_,b=this.HtmlDiv.getBoundingClientRect();a.translate(this.toolboxPosition===module$exports$Blockly$utils$toolbox.Position.LEFT?a.scrollX+b.width:a.scrollX,this.toolboxPosition===module$exports$Blockly$utils$toolbox.Position.TOP?a.scrollY+b.height:a.scrollY),(0,$.module$exports$Blockly$common.svgResize)(a)},module$exports$Blockly$Toolbox.Toolbox.prototype.clearSelection=function(){this.setSelectedItem(null)},module$exports$Blockly$Toolbox.Toolbox.prototype.refreshTheme=function(){for(var a=0;a<this.contents_.length;a++){var b=this.contents_[a];b.refreshTheme&&b.refreshTheme()}},module$exports$Blockly$Toolbox.Toolbox.prototype.refreshSelection=function(){this.selectedItem_&&this.selectedItem_.isSelectable()&&this.selectedItem_.getContents().length&&this.flyout_.show(this.selectedItem_.getContents())},module$exports$Blockly$Toolbox.Toolbox.prototype.setVisible=function(a){this.isVisible_!==a&&(this.HtmlDiv.style.display=a?"block":"none",this.isVisible_=a,this.workspace_.recordDragTargets())},module$exports$Blockly$Toolbox.Toolbox.prototype.autoHide=function(a){!a&&this.flyout_&&this.flyout_.autoClose&&this.clearSelection()},module$exports$Blockly$Toolbox.Toolbox.prototype.setSelectedItem=function(a){var b=this.selectedItem_;!a&&!b||a&&!a.isSelectable()||(this.shouldDeselectItem_(b,a)&&null!==b&&this.deselectItem_(b),this.shouldSelectItem_(b,a)&&null!==a&&this.selectItem_(b,a),this.updateFlyout_(b,a),this.fireSelectEvent_(b,a))},module$exports$Blockly$Toolbox.Toolbox.prototype.shouldDeselectItem_=function(a,b){return null!==a&&(!a.isCollapsible()||a!==b)},module$exports$Blockly$Toolbox.Toolbox.prototype.shouldSelectItem_=function(a,b){return null!==b&&b!==a},module$exports$Blockly$Toolbox.Toolbox.prototype.deselectItem_=function(a){this.selectedItem_=null,this.previouslySelectedItem_=a,a.setSelected(!1),(0,module$exports$Blockly$utils$aria.setState)(this.contentsDiv_,module$exports$Blockly$utils$aria.State.ACTIVEDESCENDANT,"")},module$exports$Blockly$Toolbox.Toolbox.prototype.selectItem_=function(a,b){this.selectedItem_=b,this.previouslySelectedItem_=a,b.setSelected(!0),(0,module$exports$Blockly$utils$aria.setState)(this.contentsDiv_,module$exports$Blockly$utils$aria.State.ACTIVEDESCENDANT,b.getId())},module$exports$Blockly$Toolbox.Toolbox.prototype.selectItemByPosition=function(a){-1<a&&a<this.contents_.length&&(a=this.contents_[a]).isSelectable()&&this.setSelectedItem(a)},module$exports$Blockly$Toolbox.Toolbox.prototype.updateFlyout_=function(a,b){b&&(a!==b||b.isCollapsible())&&b.getContents().length?(this.flyout_.show(b.getContents()),this.flyout_.scrollToStart()):this.flyout_.hide()},module$exports$Blockly$Toolbox.Toolbox.prototype.fireSelectEvent_=function(a,b){var c=a&&a.getName(),d=b&&b.getName();a===b&&(d=null),a=new((0,module$exports$Blockly$Events$utils.get)(module$exports$Blockly$Events$utils.TOOLBOX_ITEM_SELECT))(c,d,this.workspace_.id),(0,module$exports$Blockly$Events$utils.fire)(a)},module$exports$Blockly$Toolbox.Toolbox.prototype.selectParent_=function(){return!(!this.selectedItem_||(this.selectedItem_.isCollapsible()&&this.selectedItem_.isExpanded()?(this.selectedItem_.setExpanded(!1),0):!this.selectedItem_.getParent()||!this.selectedItem_.getParent().isSelectable()||(this.setSelectedItem(this.selectedItem_.getParent()),0)))},module$exports$Blockly$Toolbox.Toolbox.prototype.selectChild_=function(){if(!this.selectedItem_||!this.selectedItem_.isCollapsible())return!1;var a=this.selectedItem_;return a.isExpanded()?this.selectNext_():a.setExpanded(!0),!0},module$exports$Blockly$Toolbox.Toolbox.prototype.selectNext_=function(){if(!this.selectedItem_)return!1;var a=this.contents_.indexOf(this.selectedItem_)+1;if(-1<a&&a<this.contents_.length){for(var b=this.contents_[a];b&&!b.isSelectable();)b=this.contents_[++a];if(b&&b.isSelectable())return this.setSelectedItem(b),!0}return!1},module$exports$Blockly$Toolbox.Toolbox.prototype.selectPrevious_=function(){if(!this.selectedItem_)return!1;var a=this.contents_.indexOf(this.selectedItem_)-1;if(-1<a&&a<this.contents_.length){for(var b=this.contents_[a];b&&!b.isSelectable();)b=this.contents_[--a];if(b&&b.isSelectable())return this.setSelectedItem(b),!0}return!1},module$exports$Blockly$Toolbox.Toolbox.prototype.dispose=function(){this.workspace_.getComponentManager().removeComponent("toolbox"),this.flyout_.dispose();for(var a=0;a<this.contents_.length;a++)this.contents_[a].dispose();for(a=0;a<this.boundEvents_.length;a++)(0,module$exports$Blockly$browserEvents.unbind)(this.boundEvents_[a]);this.boundEvents_=[],this.contents_=[],this.workspace_.getThemeManager().unsubscribe(this.HtmlDiv),(0,module$exports$Blockly$utils$dom.removeNode)(this.HtmlDiv)},(0,module$exports$Blockly$Css.register)('\n  .blocklyToolboxDelete {\n    cursor: url("<<<PATH>>>/handdelete.cur"), auto;\n  }\n\n  .blocklyToolboxGrab {\n    cursor: url("<<<PATH>>>/handclosed.cur"), auto;\n    cursor: grabbing;\n    cursor: -webkit-grabbing;\n  }\n\n  /* Category tree in Toolbox. */\n  .blocklyToolboxDiv {\n    background-color: #ddd;\n    overflow-x: visible;\n    overflow-y: auto;\n    padding: 4px 0 4px 0;\n    position: absolute;\n    z-index: 70;  /* so blocks go under toolbox when dragging */\n    -webkit-tap-highlight-color: transparent;  /* issue #1345 */\n  }\n\n  .blocklyToolboxContents {\n    display: flex;\n    flex-wrap: wrap;\n    flex-direction: column;\n  }\n\n  .blocklyToolboxContents:focus {\n    outline: none;\n  }\n'),(0,module$exports$Blockly$registry.register)(module$exports$Blockly$registry.Type.TOOLBOX,module$exports$Blockly$registry.DEFAULT,module$exports$Blockly$Toolbox.Toolbox);var module$exports$Blockly$HorizontalFlyout={HorizontalFlyout:function(a){module$exports$Blockly$HorizontalFlyout.HorizontalFlyout.superClass_.constructor.call(this,a),this.horizontalLayout=!0}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$HorizontalFlyout.HorizontalFlyout,module$exports$Blockly$Flyout.Flyout),module$exports$Blockly$HorizontalFlyout.HorizontalFlyout.prototype.setMetrics_=function(a){if(this.isVisible()){var b=this.workspace_.getMetricsManager(),c=b.getScrollMetrics(),d=b.getViewMetrics();b=b.getAbsoluteMetrics(),"number"==typeof a.x&&(this.workspace_.scrollX=-(c.left+(c.width-d.width)*a.x)),this.workspace_.translate(this.workspace_.scrollX+b.left,this.workspace_.scrollY+b.top)}},module$exports$Blockly$HorizontalFlyout.HorizontalFlyout.prototype.getX=function(){return 0},module$exports$Blockly$HorizontalFlyout.HorizontalFlyout.prototype.getY=function(){if(!this.isVisible())return 0;var a=this.targetWorkspace.getMetricsManager(),b=a.getAbsoluteMetrics(),c=a.getViewMetrics();a=a.getToolboxMetrics();var d=this.toolboxPosition_===module$exports$Blockly$utils$toolbox.Position.TOP;return this.targetWorkspace.toolboxPosition===this.toolboxPosition_?this.targetWorkspace.getToolbox()?d?a.height:c.height-this.height_:d?0:c.height:d?0:c.height+b.top-this.height_},module$exports$Blockly$HorizontalFlyout.HorizontalFlyout.prototype.position=function(){if(this.isVisible()&&this.targetWorkspace.isVisible()){var a=this.targetWorkspace.getMetricsManager().getViewMetrics();this.width_=a.width,this.setBackgroundPath_(a.width-2*this.CORNER_RADIUS,this.height_-this.CORNER_RADIUS),a=this.getX();var b=this.getY();this.positionAt_(this.width_,this.height_,a,b)}},module$exports$Blockly$HorizontalFlyout.HorizontalFlyout.prototype.setBackgroundPath_=function(a,b){var c=this.toolboxPosition_===module$exports$Blockly$utils$toolbox.Position.TOP,d=["M 0,"+(c?0:this.CORNER_RADIUS)];c?(d.push("h",a+2*this.CORNER_RADIUS),d.push("v",b),d.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,-this.CORNER_RADIUS,this.CORNER_RADIUS),d.push("h",-a),d.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,-this.CORNER_RADIUS,-this.CORNER_RADIUS)):(d.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,this.CORNER_RADIUS,-this.CORNER_RADIUS),d.push("h",a),d.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,this.CORNER_RADIUS,this.CORNER_RADIUS),d.push("v",b),d.push("h",-a-2*this.CORNER_RADIUS)),d.push("z"),this.svgBackground_.setAttribute("d",d.join(" "))},module$exports$Blockly$HorizontalFlyout.HorizontalFlyout.prototype.scrollToStart=function(){this.workspace_.scrollbar.setX(this.RTL?1/0:0)},module$exports$Blockly$HorizontalFlyout.HorizontalFlyout.prototype.wheel_=function(a){var b=(0,module$exports$Blockly$browserEvents.getScrollDeltaPixels)(a);if(b=b.x||b.y){var c=this.workspace_.getMetricsManager(),d=c.getScrollMetrics();b=c.getViewMetrics().left-d.left+b,this.workspace_.scrollbar.setX(b),(0,module$exports$Blockly$WidgetDiv.hide)(),module$exports$Blockly$DropDownDiv.DropDownDiv.hideWithoutAnimation()}a.preventDefault(),a.stopPropagation()},module$exports$Blockly$HorizontalFlyout.HorizontalFlyout.prototype.layout_=function(a,b){this.workspace_.scale=this.targetWorkspace.scale;var c=this.MARGIN,d=c+this.tabWidth_;this.RTL&&(a=a.reverse());for(var f,e=0;f=a[e];e++)if("block"===f.type){for(var k,g=(f=f.block).getDescendants(!1),h=0;k=g[h];h++)k.isInFlyout=!0;f.render(),g=f.getSvgRoot(),h=f.getHeightWidth(),k=f.outputConnection?this.tabWidth_:0,k=this.RTL?d+h.width:d-k,f.moveBy(k,c),k=this.createRect_(f,k,c,h,e),d+=h.width+b[e],this.addBlockListeners_(g,f,k)}else"button"===f.type&&(this.initFlyoutButton_(f.button,d,c),d+=f.button.width+b[e])},module$exports$Blockly$HorizontalFlyout.HorizontalFlyout.prototype.isDragTowardWorkspace=function(a){a=Math.atan2(a.y,a.x)/Math.PI*180;var b=this.dragAngleRange_;return a<90+b&&a>90-b||a>-90-b&&a<-90+b},module$exports$Blockly$HorizontalFlyout.HorizontalFlyout.prototype.getClientRect=function(){if(!this.svgGroup_||this.autoClose||!this.isVisible())return null;var a=this.svgGroup_.getBoundingClientRect(),b=a.top;return this.toolboxPosition_===module$exports$Blockly$utils$toolbox.Position.TOP?new module$exports$Blockly$utils$Rect.Rect(-1e9,b+a.height,-1e9,1e9):new module$exports$Blockly$utils$Rect.Rect(b,1e9,-1e9,1e9)},module$exports$Blockly$HorizontalFlyout.HorizontalFlyout.prototype.reflowInternal_=function(){this.workspace_.scale=this.getFlyoutScale();for(var d,a=0,b=this.workspace_.getTopBlocks(!1),c=0;d=b[c];c++)a=Math.max(a,d.getHeightWidth().height);c=this.buttons_,d=0;for(var e;e=c[d];d++)a=Math.max(a,e.height);if(a+=1.5*this.MARGIN,a*=this.workspace_.scale,a+=module$exports$Blockly$Scrollbar.Scrollbar.scrollbarThickness,this.height_!==a){for(c=0;d=b[c];c++)d.flyoutRect_&&this.moveRectToBlock_(d.flyoutRect_,d);this.targetWorkspace.toolboxPosition!==this.toolboxPosition_||this.toolboxPosition_!==module$exports$Blockly$utils$toolbox.Position.TOP||this.targetWorkspace.getToolbox()||this.targetWorkspace.translate(this.targetWorkspace.scrollX,this.targetWorkspace.scrollY+a),this.height_=a,this.position(),this.targetWorkspace.recordDragTargets()}},(0,module$exports$Blockly$registry.register)(module$exports$Blockly$registry.Type.FLYOUTS_HORIZONTAL_TOOLBOX,module$exports$Blockly$registry.DEFAULT,module$exports$Blockly$HorizontalFlyout.HorizontalFlyout),$.module$exports$Blockly$Generator={Generator:function(a){this.name_=a,this.FUNCTION_NAME_PLACEHOLDER_REGEXP_=new RegExp(this.FUNCTION_NAME_PLACEHOLDER_,"g")}},$.module$exports$Blockly$Generator.Generator.prototype.INFINITE_LOOP_TRAP=null,$.module$exports$Blockly$Generator.Generator.prototype.STATEMENT_PREFIX=null,$.module$exports$Blockly$Generator.Generator.prototype.STATEMENT_SUFFIX=null,$.module$exports$Blockly$Generator.Generator.prototype.INDENT="  ",$.module$exports$Blockly$Generator.Generator.prototype.COMMENT_WRAP=60,$.module$exports$Blockly$Generator.Generator.prototype.ORDER_OVERRIDES=[],$.module$exports$Blockly$Generator.Generator.prototype.isInitialized=null,$.module$exports$Blockly$Generator.Generator.prototype.workspaceToCode=function(a){a||(console.warn("No workspace specified in workspaceToCode call.  Guessing."),a=(0,$.module$exports$Blockly$common.getMainWorkspace)());var b=[];this.init(a),a=a.getTopBlocks(!0);for(var d,c=0;d=a[c];c++){var e=this.blockToCode(d);Array.isArray(e)&&(e=e[0]),e&&(d.outputConnection&&(e=this.scrubNakedValue(e),this.STATEMENT_PREFIX&&!d.suppressPrefixSuffix&&(e=this.injectId(this.STATEMENT_PREFIX,d)+e),this.STATEMENT_SUFFIX&&!d.suppressPrefixSuffix&&(e+=this.injectId(this.STATEMENT_SUFFIX,d))),b.push(e))}return b=b.join("\n"),(b=(b=(b=this.finish(b)).replace(/^\s+\n/,"")).replace(/\n\s+$/,"\n")).replace(/[ \t]+\n/g,"\n")},$.module$exports$Blockly$Generator.Generator.prototype.prefixLines=function(a,b){return b+a.replace(/(?!\n$)\n/g,"\n"+b)},$.module$exports$Blockly$Generator.Generator.prototype.allNestedComments=function(a){var b=[];a=a.getDescendants(!0);for(var c=0;c<a.length;c++){var d=a[c].getCommentText();d&&b.push(d)}return b.length&&b.push(""),b.join("\n")},$.module$exports$Blockly$Generator.Generator.prototype.blockToCode=function(a,b){if(!1===this.isInitialized&&console.warn("Generator init was not called before blockToCode was called."),!a)return"";if(!a.isEnabled())return b?"":this.blockToCode(a.getNextBlock());if(a.isInsertionMarker())return b?"":this.blockToCode(a.getChildren(!1)[0]);var c=this[a.type];if("function"!=typeof c)throw Error('Language "'+this.name_+'" does not know how to generate code for block type "'+a.type+'".');if(c=c.call(a,a),Array.isArray(c)){if(!a.outputConnection)throw TypeError("Expecting string from statement block: "+a.type);return[this.scrub_(a,c[0],b),c[1]]}if("string"==typeof c)return this.STATEMENT_PREFIX&&!a.suppressPrefixSuffix&&(c=this.injectId(this.STATEMENT_PREFIX,a)+c),this.STATEMENT_SUFFIX&&!a.suppressPrefixSuffix&&(c+=this.injectId(this.STATEMENT_SUFFIX,a)),this.scrub_(a,c,b);if(null===c)return"";throw SyntaxError("Invalid code generated: "+c)},$.module$exports$Blockly$Generator.Generator.prototype.valueToCode=function(a,b,c){if(isNaN(c))throw TypeError("Expecting valid order from block: "+a.type);var d=a.getInputTargetBlock(b);if(!d)return"";if(""===(b=this.blockToCode(d)))return"";if(!Array.isArray(b))throw TypeError("Expecting tuple from value block: "+d.type);if(a=b[0],b=b[1],isNaN(b))throw TypeError("Expecting valid order from value block: "+d.type);if(!a)return"";d=!1;var e=Math.floor(c),f=Math.floor(b);if(e<=f&&(e!==f||0!==e&&99!==e))for(d=!0,e=0;e<this.ORDER_OVERRIDES.length;e++)if(this.ORDER_OVERRIDES[e][0]===c&&this.ORDER_OVERRIDES[e][1]===b){d=!1;break}return d&&(a="("+a+")"),a},$.module$exports$Blockly$Generator.Generator.prototype.statementToCode=function(a,b){if(a=a.getInputTargetBlock(b),"string"!=typeof(b=this.blockToCode(a)))throw TypeError("Expecting code from statement block: "+(a&&a.type));return b&&(b=this.prefixLines(b,this.INDENT)),b},$.module$exports$Blockly$Generator.Generator.prototype.addLoopTrap=function(a,b){return this.INFINITE_LOOP_TRAP&&(a=this.prefixLines(this.injectId(this.INFINITE_LOOP_TRAP,b),this.INDENT)+a),this.STATEMENT_SUFFIX&&!b.suppressPrefixSuffix&&(a=this.prefixLines(this.injectId(this.STATEMENT_SUFFIX,b),this.INDENT)+a),this.STATEMENT_PREFIX&&!b.suppressPrefixSuffix&&(a+=this.prefixLines(this.injectId(this.STATEMENT_PREFIX,b),this.INDENT)),a},$.module$exports$Blockly$Generator.Generator.prototype.injectId=function(a,b){return b=b.id.replace(/\$/g,"$$$$"),a.replace(/%1/g,"'"+b+"'")},$.module$exports$Blockly$Generator.Generator.prototype.RESERVED_WORDS_="",$.module$exports$Blockly$Generator.Generator.prototype.addReservedWords=function(a){this.RESERVED_WORDS_+=a+","},$.module$exports$Blockly$Generator.Generator.prototype.FUNCTION_NAME_PLACEHOLDER_="{leCUI8hutHZI4480Dc}",Object.defineProperties($.module$exports$Blockly$Generator.Generator.prototype,{variableDB_:{get:function(){return(0,module$exports$Blockly$utils$deprecation.warn)("variableDB_","May 2021","May 2026","nameDB_"),this.nameDB_},set:function(a){(0,module$exports$Blockly$utils$deprecation.warn)("variableDB_","May 2021","May 2026","nameDB_"),this.nameDB_=a}}}),$.module$exports$Blockly$Generator.Generator.prototype.provideFunction_=function(a,b){if(!this.definitions_[a]){var d,c=this.nameDB_.getDistinctName(a,$.module$exports$Blockly$Names.NameType.PROCEDURE);for(this.functionNames_[a]=c,b=b.join("\n").replace(this.FUNCTION_NAME_PLACEHOLDER_REGEXP_,c);d!==b;)d=b,b=b.replace(/^(( {2})*) {2}/gm,"$1\0");b=b.replace(/\0/g,this.INDENT),this.definitions_[a]=b}return this.functionNames_[a]},$.module$exports$Blockly$Generator.Generator.prototype.init=function(a){this.definitions_=Object.create(null),this.functionNames_=Object.create(null)},$.module$exports$Blockly$Generator.Generator.prototype.scrub_=function(a,b,c){return b},$.module$exports$Blockly$Generator.Generator.prototype.finish=function(a){return delete this.definitions_,delete this.functionNames_,a},$.module$exports$Blockly$Generator.Generator.prototype.scrubNakedValue=function(a){return a},$.module$exports$Blockly$FieldDropdown={FieldDropdown:function(a,b,c){"function"!=typeof a&&module$contents$Blockly$FieldDropdown_validateOptions(a),this.menuGenerator_=a,this.suffixField=this.prefixField=this.generatedOptions_=null,this.trimOptions_(),this.selectedOption_=this.getOptions(!1)[0],$.module$exports$Blockly$FieldDropdown.FieldDropdown.superClass_.constructor.call(this,this.selectedOption_[1],b,c),this.svgArrow_=this.arrow_=this.imageElement_=this.menu_=this.selectedMenuItem_=null}},(0,$.module$exports$Blockly$utils$object.inherits)($.module$exports$Blockly$FieldDropdown.FieldDropdown,module$exports$Blockly$Field.Field),$.module$exports$Blockly$FieldDropdown.FieldDropdown.fromJson=function(a){return new this(a.options,void 0,a)},$.module$exports$Blockly$FieldDropdown.FieldDropdown.prototype.fromXml=function(a){this.isOptionListDynamic()&&this.getOptions(!1),this.setValue(a.textContent)},$.module$exports$Blockly$FieldDropdown.FieldDropdown.prototype.loadState=function(a){this.loadLegacyState($.module$exports$Blockly$FieldDropdown.FieldDropdown,a)||(this.isOptionListDynamic()&&this.getOptions(!1),this.setValue(a))},$.module$exports$Blockly$FieldDropdown.FieldDropdown.prototype.SERIALIZABLE=!0,$.module$exports$Blockly$FieldDropdown.FieldDropdown.CHECKMARK_OVERHANG=25,$.module$exports$Blockly$FieldDropdown.FieldDropdown.MAX_MENU_HEIGHT_VH=.45,$.module$exports$Blockly$FieldDropdown.FieldDropdown.ARROW_CHAR=module$exports$Blockly$utils$userAgent.ANDROID?"":"",$.module$exports$Blockly$FieldDropdown.FieldDropdown.prototype.CURSOR="default",$.module$exports$Blockly$FieldDropdown.FieldDropdown.prototype.initView=function(){this.shouldAddBorderRect_()?this.createBorderRect_():this.clickTarget_=this.sourceBlock_.getSvgRoot(),this.createTextElement_(),this.imageElement_=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.IMAGE,{},this.fieldGroup_),this.getConstants().FIELD_DROPDOWN_SVG_ARROW?this.createSVGArrow_():this.createTextArrow_(),this.borderRect_&&(0,module$exports$Blockly$utils$dom.addClass)(this.borderRect_,"blocklyDropdownRect")},$.module$exports$Blockly$FieldDropdown.FieldDropdown.prototype.shouldAddBorderRect_=function(){return!this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW||this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW&&!this.sourceBlock_.isShadow()},$.module$exports$Blockly$FieldDropdown.FieldDropdown.prototype.createTextArrow_=function(){this.arrow_=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.TSPAN,{},this.textElement_),this.arrow_.appendChild(document.createTextNode(this.sourceBlock_.RTL?$.module$exports$Blockly$FieldDropdown.FieldDropdown.ARROW_CHAR+" ":" "+$.module$exports$Blockly$FieldDropdown.FieldDropdown.ARROW_CHAR)),this.sourceBlock_.RTL?this.textElement_.insertBefore(this.arrow_,this.textContent_):this.textElement_.appendChild(this.arrow_)},$.module$exports$Blockly$FieldDropdown.FieldDropdown.prototype.createSVGArrow_=function(){this.svgArrow_=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.IMAGE,{height:this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE+"px",width:this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE+"px"},this.fieldGroup_),this.svgArrow_.setAttributeNS(module$exports$Blockly$utils$dom.XLINK_NS,"xlink:href",this.getConstants().FIELD_DROPDOWN_SVG_ARROW_DATAURI)},$.module$exports$Blockly$FieldDropdown.FieldDropdown.prototype.showEditor_=function(a){if(this.dropdownCreate_(),this.menu_.openingCoords=a&&"number"==typeof a.clientX?new module$exports$Blockly$utils$Coordinate.Coordinate(a.clientX,a.clientY):null,module$exports$Blockly$DropDownDiv.DropDownDiv.clearContent(),this.menu_.render(module$exports$Blockly$DropDownDiv.DropDownDiv.getContentDiv()),a=this.menu_.getElement(),(0,module$exports$Blockly$utils$dom.addClass)(a,"blocklyDropdownMenu"),this.getConstants().FIELD_DROPDOWN_COLOURED_DIV){a=this.sourceBlock_.isShadow()?this.sourceBlock_.getParent().getColour():this.sourceBlock_.getColour();var b=this.sourceBlock_.isShadow()?this.sourceBlock_.getParent().style.colourTertiary:this.sourceBlock_.style.colourTertiary;module$exports$Blockly$DropDownDiv.DropDownDiv.setColour(a,b)}module$exports$Blockly$DropDownDiv.DropDownDiv.showPositionedByField(this,this.dropdownDispose_.bind(this)),this.menu_.focus(),this.selectedMenuItem_&&this.menu_.setHighlighted(this.selectedMenuItem_),this.applyColour()},$.module$exports$Blockly$FieldDropdown.FieldDropdown.prototype.dropdownCreate_=function(){var a=new module$exports$Blockly$Menu.Menu;a.setRole(module$exports$Blockly$utils$aria.Role.LISTBOX),this.menu_=a;var b=this.getOptions(!1);this.selectedMenuItem_=null;for(var c=0;c<b.length;c++){var d=b[c][0],e=b[c][1];if("object"==typeof d){var f=new Image(d.width,d.height);f.src=d.src,f.alt=d.alt||"",d=f}(d=new module$exports$Blockly$MenuItem.MenuItem(d,e)).setRole(module$exports$Blockly$utils$aria.Role.OPTION),d.setRightToLeft(this.sourceBlock_.RTL),d.setCheckable(!0),a.addChild(d),d.setChecked(e===this.value_),e===this.value_&&(this.selectedMenuItem_=d),d.onAction(this.handleMenuActionEvent_,this)}},$.module$exports$Blockly$FieldDropdown.FieldDropdown.prototype.dropdownDispose_=function(){this.menu_&&this.menu_.dispose(),this.selectedMenuItem_=this.menu_=null,this.applyColour()},$.module$exports$Blockly$FieldDropdown.FieldDropdown.prototype.handleMenuActionEvent_=function(a){module$exports$Blockly$DropDownDiv.DropDownDiv.hideIfOwner(this,!0),this.onItemSelected_(this.menu_,a)},$.module$exports$Blockly$FieldDropdown.FieldDropdown.prototype.onItemSelected_=function(a,b){this.setValue(b.getValue())},$.module$exports$Blockly$FieldDropdown.FieldDropdown.prototype.trimOptions_=function(){var a=this.menuGenerator_;if(Array.isArray(a)){for(var b=!1,c=0;c<a.length;c++){var d=a[c][0];"string"==typeof d?a[c][0]=(0,module$exports$Blockly$utils$parsing.replaceMessageReferences)(d):(null!==d.alt&&(a[c][0].alt=(0,module$exports$Blockly$utils$parsing.replaceMessageReferences)(d.alt)),b=!0)}if(!(b||2>a.length)){for(b=[],c=0;c<a.length;c++)b.push(a[c][0]);c=(0,$.module$exports$Blockly$utils$string.shortestStringLength)(b),d=(0,$.module$exports$Blockly$utils$string.commonWordPrefix)(b,c);var e=(0,$.module$exports$Blockly$utils$string.commonWordSuffix)(b,c);!d&&!e||c<=d+e||(d&&(this.prefixField=b[0].substring(0,d-1)),e&&(this.suffixField=b[0].substr(1-e)),this.menuGenerator_=$.module$exports$Blockly$FieldDropdown.FieldDropdown.applyTrim_(a,d,e))}}},$.module$exports$Blockly$FieldDropdown.FieldDropdown.applyTrim_=function(a,b,c){for(var d=[],e=0;e<a.length;e++){var f=a[e][0],g=a[e][1];f=f.substring(b,f.length-c),d[e]=[f,g]}return d},$.module$exports$Blockly$FieldDropdown.FieldDropdown.prototype.isOptionListDynamic=function(){return"function"==typeof this.menuGenerator_},$.module$exports$Blockly$FieldDropdown.FieldDropdown.prototype.getOptions=function(a){return this.isOptionListDynamic()?(this.generatedOptions_&&a||(this.generatedOptions_=this.menuGenerator_.call(this),module$contents$Blockly$FieldDropdown_validateOptions(this.generatedOptions_)),this.generatedOptions_):this.menuGenerator_},$.module$exports$Blockly$FieldDropdown.FieldDropdown.prototype.doClassValidation_=function(a){for(var e,b=!1,c=this.getOptions(!0),d=0;e=c[d];d++)if(e[1]===a){b=!0;break}return b?a:(this.sourceBlock_&&console.warn("Cannot set the dropdown's value to an unavailable option. Block type: "+this.sourceBlock_.type+", Field name: "+this.name+", Value: "+a),null)},$.module$exports$Blockly$FieldDropdown.FieldDropdown.prototype.doValueUpdate_=function(a){$.module$exports$Blockly$FieldDropdown.FieldDropdown.superClass_.doValueUpdate_.call(this,a),a=this.getOptions(!0);for(var c,b=0;c=a[b];b++)c[1]===this.value_&&(this.selectedOption_=c)},$.module$exports$Blockly$FieldDropdown.FieldDropdown.prototype.applyColour=function(){this.borderRect_&&(this.borderRect_.setAttribute("stroke",this.sourceBlock_.style.colourTertiary),this.menu_?this.borderRect_.setAttribute("fill",this.sourceBlock_.style.colourTertiary):this.borderRect_.setAttribute("fill","transparent")),this.sourceBlock_&&this.arrow_&&(this.sourceBlock_.isShadow()?this.arrow_.style.fill=this.sourceBlock_.style.colourSecondary:this.arrow_.style.fill=this.sourceBlock_.style.colourPrimary)},$.module$exports$Blockly$FieldDropdown.FieldDropdown.prototype.render_=function(){this.textContent_.nodeValue="",this.imageElement_.style.display="none";var a=this.selectedOption_&&this.selectedOption_[0];a&&"object"==typeof a?this.renderSelectedImage_(a):this.renderSelectedText_(),this.positionBorderRect_()},$.module$exports$Blockly$FieldDropdown.FieldDropdown.prototype.renderSelectedImage_=function(a){this.imageElement_.style.display="",this.imageElement_.setAttributeNS(module$exports$Blockly$utils$dom.XLINK_NS,"xlink:href",a.src),this.imageElement_.setAttribute("height",a.height),this.imageElement_.setAttribute("width",a.width);var b=Number(a.height);a=Number(a.width);var c=!!this.borderRect_,d=Math.max(c?this.getConstants().FIELD_DROPDOWN_BORDER_RECT_HEIGHT:0,b+10);c=c?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0;var e=this.svgArrow_?this.positionSVGArrow_(a+c,d/2-this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE/2):(0,module$exports$Blockly$utils$dom.getFastTextWidth)(this.arrow_,this.getConstants().FIELD_TEXT_FONTSIZE,this.getConstants().FIELD_TEXT_FONTWEIGHT,this.getConstants().FIELD_TEXT_FONTFAMILY);this.size_.width=a+e+2*c,this.size_.height=d;var f=0;this.sourceBlock_.RTL?this.imageElement_.setAttribute("x",c+e):(f=a+e,this.textElement_.setAttribute("text-anchor","end"),this.imageElement_.setAttribute("x",c)),this.imageElement_.setAttribute("y",d/2-b/2),this.positionTextElement_(f+c,a+e)},$.module$exports$Blockly$FieldDropdown.FieldDropdown.prototype.renderSelectedText_=function(){this.textContent_.nodeValue=this.getDisplayText_(),(0,module$exports$Blockly$utils$dom.addClass)(this.textElement_,"blocklyDropdownText"),this.textElement_.setAttribute("text-anchor","start");var a=!!this.borderRect_,b=Math.max(a?this.getConstants().FIELD_DROPDOWN_BORDER_RECT_HEIGHT:0,this.getConstants().FIELD_TEXT_HEIGHT),c=(0,module$exports$Blockly$utils$dom.getFastTextWidth)(this.textElement_,this.getConstants().FIELD_TEXT_FONTSIZE,this.getConstants().FIELD_TEXT_FONTWEIGHT,this.getConstants().FIELD_TEXT_FONTFAMILY);a=a?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0;var d=0;this.svgArrow_&&(d=this.positionSVGArrow_(c+a,b/2-this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE/2)),this.size_.width=c+d+2*a,this.size_.height=b,this.positionTextElement_(a,c)},$.module$exports$Blockly$FieldDropdown.FieldDropdown.prototype.positionSVGArrow_=function(a,b){if(!this.svgArrow_)return 0;var c=this.borderRect_?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0,d=this.getConstants().FIELD_DROPDOWN_SVG_ARROW_PADDING,e=this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE;return this.svgArrow_.setAttribute("transform","translate("+(this.sourceBlock_.RTL?c:a+d)+","+b+")"),e+d},$.module$exports$Blockly$FieldDropdown.FieldDropdown.prototype.getText_=function(){if(!this.selectedOption_)return null;var a=this.selectedOption_[0];return"object"==typeof a?a.alt:a};var module$contents$Blockly$FieldDropdown_validateOptions=function(a){if(!Array.isArray(a))throw TypeError("FieldDropdown options must be an array.");if(!a.length)throw TypeError("FieldDropdown options must not be an empty array.");for(var b=!1,c=0;c<a.length;c++){var d=a[c];Array.isArray(d)?"string"!=typeof d[1]?(b=!0,console.error("Invalid option["+c+"]: Each FieldDropdown option id must be a string. Found "+d[1]+" in: ",d)):d[0]&&"string"!=typeof d[0]&&"string"!=typeof d[0].src&&(b=!0,console.error("Invalid option["+c+"]: Each FieldDropdown option must have a string label or image description. Found"+d[0]+" in: ",d)):(b=!0,console.error("Invalid option["+c+"]: Each FieldDropdown option must be an array. Found: ",d))}if(b)throw TypeError("Found invalid FieldDropdown options.")};(0,module$exports$Blockly$fieldRegistry.register)("field_dropdown",$.module$exports$Blockly$FieldDropdown.FieldDropdown);var module$exports$Blockly$FieldVariable={FieldVariable:function(a,b,c,d,e){this.menuGenerator_=module$exports$Blockly$FieldVariable.FieldVariable.dropdownCreate,this.defaultVariableName="string"==typeof a?a:"",this.size_=new module$exports$Blockly$utils$Size.Size(0,0),e&&this.configure_(e),b&&this.setValidator(b),e||this.setTypes_(c,d)}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$FieldVariable.FieldVariable,$.module$exports$Blockly$FieldDropdown.FieldDropdown),module$exports$Blockly$FieldVariable.FieldVariable.fromJson=function(a){return new this((0,module$exports$Blockly$utils$parsing.replaceMessageReferences)(a.variable),void 0,void 0,void 0,a)},module$exports$Blockly$FieldVariable.FieldVariable.prototype.SERIALIZABLE=!0,module$exports$Blockly$FieldVariable.FieldVariable.prototype.configure_=function(a){module$exports$Blockly$FieldVariable.FieldVariable.superClass_.configure_.call(this,a),this.setTypes_(a.variableTypes,a.defaultType)},module$exports$Blockly$FieldVariable.FieldVariable.prototype.initModel=function(){if(!this.variable_){var a=(0,$.module$exports$Blockly$Variables.getOrCreateVariablePackage)(this.sourceBlock_.workspace,null,this.defaultVariableName,this.defaultType_);this.doValueUpdate_(a.getId())}},module$exports$Blockly$FieldVariable.FieldVariable.prototype.shouldAddBorderRect_=function(){return module$exports$Blockly$FieldVariable.FieldVariable.superClass_.shouldAddBorderRect_.call(this)&&(!this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW||"variables_get"!==this.sourceBlock_.type)},module$exports$Blockly$FieldVariable.FieldVariable.prototype.fromXml=function(a){var b=a.getAttribute("id"),c=a.textContent,d=a.getAttribute("variabletype")||a.getAttribute("variableType")||"";if(b=(0,$.module$exports$Blockly$Variables.getOrCreateVariablePackage)(this.sourceBlock_.workspace,b,c,d),null!==d&&d!==b.type)throw Error("Serialized variable type with id '"+b.getId()+"' had type "+b.type+", and does not match variable field that references it: "+(0,$.module$exports$Blockly$Xml.domToText)(a)+".");this.setValue(b.getId())},module$exports$Blockly$FieldVariable.FieldVariable.prototype.toXml=function(a){return this.initModel(),a.id=this.variable_.getId(),a.textContent=this.variable_.name,this.variable_.type&&a.setAttribute("variabletype",this.variable_.type),a},module$exports$Blockly$FieldVariable.FieldVariable.prototype.saveState=function(a){var b=this.saveLegacyState(module$exports$Blockly$FieldVariable.FieldVariable);return null!==b||(this.initModel(),b={id:this.variable_.getId()},a&&(b.name=this.variable_.name,b.type=this.variable_.type)),b},module$exports$Blockly$FieldVariable.FieldVariable.prototype.loadState=function(a){this.loadLegacyState(module$exports$Blockly$FieldVariable.FieldVariable,a)||(a=(0,$.module$exports$Blockly$Variables.getOrCreateVariablePackage)(this.sourceBlock_.workspace,a.id||null,a.name,a.type||""),this.setValue(a.getId()))},module$exports$Blockly$FieldVariable.FieldVariable.prototype.setSourceBlock=function(a){if(a.isShadow())throw Error("Variable fields are not allowed to exist on shadow blocks.");module$exports$Blockly$FieldVariable.FieldVariable.superClass_.setSourceBlock.call(this,a)},module$exports$Blockly$FieldVariable.FieldVariable.prototype.getValue=function(){return this.variable_?this.variable_.getId():null},module$exports$Blockly$FieldVariable.FieldVariable.prototype.getText=function(){return this.variable_?this.variable_.name:""},module$exports$Blockly$FieldVariable.FieldVariable.prototype.getVariable=function(){return this.variable_},module$exports$Blockly$FieldVariable.FieldVariable.prototype.getValidator=function(){return this.variable_?this.validator_:null},module$exports$Blockly$FieldVariable.FieldVariable.prototype.doClassValidation_=function(a){if(null===a)return null;var b=(0,$.module$exports$Blockly$Variables.getVariable)(this.sourceBlock_.workspace,a);return b?(b=b.type,this.typeIsAllowed_(b)?a:(console.warn("Variable type doesn't match this field!  Type was "+b),null)):(console.warn("Variable id doesn't point to a real variable! ID was "+a),null)},module$exports$Blockly$FieldVariable.FieldVariable.prototype.doValueUpdate_=function(a){this.variable_=(0,$.module$exports$Blockly$Variables.getVariable)(this.sourceBlock_.workspace,a),module$exports$Blockly$FieldVariable.FieldVariable.superClass_.doValueUpdate_.call(this,a)},module$exports$Blockly$FieldVariable.FieldVariable.prototype.typeIsAllowed_=function(a){var b=this.getVariableTypes_();if(!b)return!0;for(var c=0;c<b.length;c++)if(a===b[c])return!0;return!1},module$exports$Blockly$FieldVariable.FieldVariable.prototype.getVariableTypes_=function(){var a=this.variableTypes;if(null===a&&this.sourceBlock_&&this.sourceBlock_.workspace)return this.sourceBlock_.workspace.getVariableTypes();if(0===(a=a||[""]).length)throw a=this.getText(),Error("'variableTypes' of field variable "+a+" was an empty list");return a},module$exports$Blockly$FieldVariable.FieldVariable.prototype.setTypes_=function(a,b){if(b=b||"",null==a)a=null;else{if(!Array.isArray(a))throw Error("'variableTypes' was not an array in the definition of a FieldVariable");for(var c=!1,d=0;d<a.length;d++)a[d]===b&&(c=!0);if(!c)throw Error("Invalid default type '"+b+"' in the definition of a FieldVariable")}this.defaultType_=b,this.variableTypes=a},module$exports$Blockly$FieldVariable.FieldVariable.prototype.refreshVariableName=function(){this.forceRerender()},module$exports$Blockly$FieldVariable.FieldVariable.dropdownCreate=function(){if(!this.variable_)throw Error("Tried to call dropdownCreate on a variable field with no variable selected.");var a=this.getText(),b=[];if(this.sourceBlock_&&this.sourceBlock_.workspace)for(var c=this.getVariableTypes_(),d=0;d<c.length;d++){var e=this.sourceBlock_.workspace.getVariablesOfType(c[d]);b=b.concat(e)}for(b.sort(module$exports$Blockly$VariableModel.VariableModel.compareByName),c=[],d=0;d<b.length;d++)c[d]=[b[d].name,b[d].getId()];return c.push([$.module$exports$Blockly$Msg.Msg.RENAME_VARIABLE,$.module$exports$Blockly$internalConstants.RENAME_VARIABLE_ID]),$.module$exports$Blockly$Msg.Msg.DELETE_VARIABLE&&c.push([$.module$exports$Blockly$Msg.Msg.DELETE_VARIABLE.replace("%1",a),$.module$exports$Blockly$internalConstants.DELETE_VARIABLE_ID]),c},module$exports$Blockly$FieldVariable.FieldVariable.prototype.onItemSelected_=function(a,b){if(a=b.getValue(),this.sourceBlock_&&this.sourceBlock_.workspace){if(a===$.module$exports$Blockly$internalConstants.RENAME_VARIABLE_ID)return void(0,$.module$exports$Blockly$Variables.renameVariable)(this.sourceBlock_.workspace,this.variable_);if(a===$.module$exports$Blockly$internalConstants.DELETE_VARIABLE_ID)return void this.sourceBlock_.workspace.deleteVariableById(this.variable_.getId())}this.setValue(a)},module$exports$Blockly$FieldVariable.FieldVariable.prototype.referencesVariables=function(){return!0},(0,module$exports$Blockly$fieldRegistry.register)("field_variable",module$exports$Blockly$FieldVariable.FieldVariable),$.module$exports$Blockly$FieldTextInput={FieldTextInput:function(a,b,c){this.spellcheck_=!0,$.module$exports$Blockly$FieldTextInput.FieldTextInput.superClass_.constructor.call(this,a,b,c),this.onKeyInputWrapper_=this.onKeyDownWrapper_=this.htmlInput_=null,this.fullBlockClickTarget_=!1,this.workspace_=null}},(0,$.module$exports$Blockly$utils$object.inherits)($.module$exports$Blockly$FieldTextInput.FieldTextInput,module$exports$Blockly$Field.Field),$.module$exports$Blockly$FieldTextInput.FieldTextInput.prototype.DEFAULT_VALUE="",$.module$exports$Blockly$FieldTextInput.FieldTextInput.fromJson=function(a){return new this((0,module$exports$Blockly$utils$parsing.replaceMessageReferences)(a.text),void 0,a)},$.module$exports$Blockly$FieldTextInput.FieldTextInput.prototype.SERIALIZABLE=!0,$.module$exports$Blockly$FieldTextInput.FieldTextInput.BORDERRADIUS=4,$.module$exports$Blockly$FieldTextInput.FieldTextInput.prototype.CURSOR="text",$.module$exports$Blockly$FieldTextInput.FieldTextInput.prototype.configure_=function(a){$.module$exports$Blockly$FieldTextInput.FieldTextInput.superClass_.configure_.call(this,a),"boolean"==typeof a.spellcheck&&(this.spellcheck_=a.spellcheck)},$.module$exports$Blockly$FieldTextInput.FieldTextInput.prototype.initView=function(){if(this.getConstants().FULL_BLOCK_FIELDS){for(var d,a=0,b=0,c=0;d=this.sourceBlock_.inputList[c];c++){for(var e=0;d.fieldRow[e];e++)a++;d.connection&&b++}this.fullBlockClickTarget_=1>=a&&this.sourceBlock_.outputConnection&&!b}else this.fullBlockClickTarget_=!1;this.fullBlockClickTarget_?this.clickTarget_=this.sourceBlock_.getSvgRoot():this.createBorderRect_(),this.createTextElement_()},$.module$exports$Blockly$FieldTextInput.FieldTextInput.prototype.doClassValidation_=function(a){return null==a?null:String(a)},$.module$exports$Blockly$FieldTextInput.FieldTextInput.prototype.doValueInvalid_=function(a){this.isBeingEdited_&&(this.isTextValid_=!1,a=this.value_,this.value_=this.htmlInput_.untypedDefaultValue_,this.sourceBlock_&&(0,module$exports$Blockly$Events$utils.isEnabled)()&&(0,module$exports$Blockly$Events$utils.fire)(new((0,module$exports$Blockly$Events$utils.get)(module$exports$Blockly$Events$utils.CHANGE))(this.sourceBlock_,"field",this.name||null,a,this.value_)))},$.module$exports$Blockly$FieldTextInput.FieldTextInput.prototype.doValueUpdate_=function(a){this.isTextValid_=!0,this.value_=a,this.isBeingEdited_||(this.isDirty_=!0)},$.module$exports$Blockly$FieldTextInput.FieldTextInput.prototype.applyColour=function(){this.sourceBlock_&&this.getConstants().FULL_BLOCK_FIELDS&&(this.borderRect_?this.borderRect_.setAttribute("stroke",this.sourceBlock_.style.colourTertiary):this.sourceBlock_.pathObject.svgPath.setAttribute("fill",this.getConstants().FIELD_BORDER_RECT_COLOUR))},$.module$exports$Blockly$FieldTextInput.FieldTextInput.prototype.render_=function(){if($.module$exports$Blockly$FieldTextInput.FieldTextInput.superClass_.render_.call(this),this.isBeingEdited_){this.resizeEditor_();var a=this.htmlInput_;this.isTextValid_?((0,module$exports$Blockly$utils$dom.removeClass)(a,"blocklyInvalidInput"),(0,module$exports$Blockly$utils$aria.setState)(a,module$exports$Blockly$utils$aria.State.INVALID,!1)):((0,module$exports$Blockly$utils$dom.addClass)(a,"blocklyInvalidInput"),(0,module$exports$Blockly$utils$aria.setState)(a,module$exports$Blockly$utils$aria.State.INVALID,!0))}},$.module$exports$Blockly$FieldTextInput.FieldTextInput.prototype.setSpellcheck=function(a){a!==this.spellcheck_&&(this.spellcheck_=a,this.htmlInput_&&this.htmlInput_.setAttribute("spellcheck",this.spellcheck_))},$.module$exports$Blockly$FieldTextInput.FieldTextInput.prototype.showEditor_=function(a,b){this.workspace_=this.sourceBlock_.workspace,!(a=b||!1)&&(module$exports$Blockly$utils$userAgent.MOBILE||module$exports$Blockly$utils$userAgent.ANDROID||module$exports$Blockly$utils$userAgent.IPAD)?this.showPromptEditor_():this.showInlineEditor_(a)},$.module$exports$Blockly$FieldTextInput.FieldTextInput.prototype.showPromptEditor_=function(){(0,module$exports$Blockly$dialog.prompt)($.module$exports$Blockly$Msg.Msg.CHANGE_VALUE_TITLE,this.getText(),function(a){null!==a&&this.setValue(this.getValueFromEditorText_(a))}.bind(this))},$.module$exports$Blockly$FieldTextInput.FieldTextInput.prototype.showInlineEditor_=function(a){(0,module$exports$Blockly$WidgetDiv.show)(this,this.sourceBlock_.RTL,this.widgetDispose_.bind(this)),this.htmlInput_=this.widgetCreate_(),this.isBeingEdited_=!0,a||(this.htmlInput_.focus({preventScroll:!0}),this.htmlInput_.select())},$.module$exports$Blockly$FieldTextInput.FieldTextInput.prototype.widgetCreate_=function(){(0,module$exports$Blockly$Events$utils.setGroup)(!0);var a=(0,module$exports$Blockly$WidgetDiv.getDiv)();(0,module$exports$Blockly$utils$dom.addClass)(this.getClickTarget_(),"editing");var b=document.createElement("input");b.className="blocklyHtmlInput",b.setAttribute("spellcheck",this.spellcheck_);var c=this.workspace_.getScale(),d=this.getConstants().FIELD_TEXT_FONTSIZE*c+"pt";if(a.style.fontSize=d,b.style.fontSize=d,d=$.module$exports$Blockly$FieldTextInput.FieldTextInput.BORDERRADIUS*c+"px",this.fullBlockClickTarget_){d=((d=this.getScaledBBox()).bottom-d.top)/2+"px";var e=this.sourceBlock_.getParent()?this.sourceBlock_.getParent().style.colourTertiary:this.sourceBlock_.style.colourTertiary;b.style.border=1*c+"px solid "+e,a.style.borderRadius=d,a.style.transition="box-shadow 0.25s ease 0s",this.getConstants().FIELD_TEXTINPUT_BOX_SHADOW&&(a.style.boxShadow="rgba(255, 255, 255, 0.3) 0 0 0 "+4*c+"px")}return b.style.borderRadius=d,a.appendChild(b),b.value=b.defaultValue=this.getEditorText_(this.value_),b.untypedDefaultValue_=this.value_,b.oldValue_=null,this.resizeEditor_(),this.bindInputEvents_(b),b},$.module$exports$Blockly$FieldTextInput.FieldTextInput.prototype.widgetDispose_=function(){this.isBeingEdited_=!1,this.isTextValid_=!0,this.forceRerender(),this.onFinishEditing_&&this.onFinishEditing_(this.value_),(0,module$exports$Blockly$Events$utils.setGroup)(!1),this.unbindInputEvents_();var a=(0,module$exports$Blockly$WidgetDiv.getDiv)().style;a.width="auto",a.height="auto",a.fontSize="",a.transition="",a.boxShadow="",this.htmlInput_=null,(0,module$exports$Blockly$utils$dom.removeClass)(this.getClickTarget_(),"editing")},$.module$exports$Blockly$FieldTextInput.FieldTextInput.prototype.bindInputEvents_=function(a){this.onKeyDownWrapper_=(0,module$exports$Blockly$browserEvents.conditionalBind)(a,"keydown",this,this.onHtmlInputKeyDown_),this.onKeyInputWrapper_=(0,module$exports$Blockly$browserEvents.conditionalBind)(a,"input",this,this.onHtmlInputChange_)},$.module$exports$Blockly$FieldTextInput.FieldTextInput.prototype.unbindInputEvents_=function(){this.onKeyDownWrapper_&&((0,module$exports$Blockly$browserEvents.unbind)(this.onKeyDownWrapper_),this.onKeyDownWrapper_=null),this.onKeyInputWrapper_&&((0,module$exports$Blockly$browserEvents.unbind)(this.onKeyInputWrapper_),this.onKeyInputWrapper_=null)},$.module$exports$Blockly$FieldTextInput.FieldTextInput.prototype.onHtmlInputKeyDown_=function(a){a.keyCode===module$exports$Blockly$utils$KeyCodes_KeyCodes.ENTER?((0,module$exports$Blockly$WidgetDiv.hide)(),module$exports$Blockly$DropDownDiv.DropDownDiv.hideWithoutAnimation()):a.keyCode===module$exports$Blockly$utils$KeyCodes_KeyCodes.ESC?(this.setValue(this.htmlInput_.untypedDefaultValue_),(0,module$exports$Blockly$WidgetDiv.hide)(),module$exports$Blockly$DropDownDiv.DropDownDiv.hideWithoutAnimation()):a.keyCode===module$exports$Blockly$utils$KeyCodes_KeyCodes.TAB&&((0,module$exports$Blockly$WidgetDiv.hide)(),module$exports$Blockly$DropDownDiv.DropDownDiv.hideWithoutAnimation(),this.sourceBlock_.tab(this,!a.shiftKey),a.preventDefault())},$.module$exports$Blockly$FieldTextInput.FieldTextInput.prototype.onHtmlInputChange_=function(a){(a=this.htmlInput_.value)!==this.htmlInput_.oldValue_&&(this.htmlInput_.oldValue_=a,a=this.getValueFromEditorText_(a),this.setValue(a),this.forceRerender(),this.resizeEditor_())},$.module$exports$Blockly$FieldTextInput.FieldTextInput.prototype.setEditorValue_=function(a){this.isDirty_=!0,this.isBeingEdited_&&(this.htmlInput_.value=this.getEditorText_(a)),this.setValue(a)},$.module$exports$Blockly$FieldTextInput.FieldTextInput.prototype.resizeEditor_=function(){var a=(0,module$exports$Blockly$WidgetDiv.getDiv)(),b=this.getScaledBBox();a.style.width=b.right-b.left+"px",a.style.height=b.bottom-b.top+"px",b=new module$exports$Blockly$utils$Coordinate.Coordinate(this.sourceBlock_.RTL?b.right-a.offsetWidth:b.left,b.top),a.style.left=b.x+"px",a.style.top=b.y+"px"},$.module$exports$Blockly$FieldTextInput.FieldTextInput.prototype.isTabNavigable=function(){return!0},$.module$exports$Blockly$FieldTextInput.FieldTextInput.prototype.getText_=function(){return this.isBeingEdited_&&this.htmlInput_?this.htmlInput_.value:null},$.module$exports$Blockly$FieldTextInput.FieldTextInput.prototype.getEditorText_=function(a){return String(a)},$.module$exports$Blockly$FieldTextInput.FieldTextInput.prototype.getValueFromEditorText_=function(a){return a},(0,module$exports$Blockly$fieldRegistry.register)("field_input",$.module$exports$Blockly$FieldTextInput.FieldTextInput);var module$exports$Blockly$FieldNumber={FieldNumber:function(a,b,c,d,e,f){this.min_=-1/0,this.max_=1/0,this.precision_=0,this.decimalPlaces_=null,module$exports$Blockly$FieldNumber.FieldNumber.superClass_.constructor.call(this,a,e,f),f||this.setConstraints(b,c,d)}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$FieldNumber.FieldNumber,$.module$exports$Blockly$FieldTextInput.FieldTextInput),module$exports$Blockly$FieldNumber.FieldNumber.prototype.DEFAULT_VALUE=0,module$exports$Blockly$FieldNumber.FieldNumber.fromJson=function(a){return new this(a.value,void 0,void 0,void 0,void 0,a)},module$exports$Blockly$FieldNumber.FieldNumber.prototype.SERIALIZABLE=!0,module$exports$Blockly$FieldNumber.FieldNumber.prototype.configure_=function(a){module$exports$Blockly$FieldNumber.FieldNumber.superClass_.configure_.call(this,a),this.setMinInternal_(a.min),this.setMaxInternal_(a.max),this.setPrecisionInternal_(a.precision)},module$exports$Blockly$FieldNumber.FieldNumber.prototype.setConstraints=function(a,b,c){this.setMinInternal_(a),this.setMaxInternal_(b),this.setPrecisionInternal_(c),this.setValue(this.getValue())},module$exports$Blockly$FieldNumber.FieldNumber.prototype.setMin=function(a){this.setMinInternal_(a),this.setValue(this.getValue())},module$exports$Blockly$FieldNumber.FieldNumber.prototype.setMinInternal_=function(a){null==a?this.min_=-1/0:(a=Number(a),isNaN(a)||(this.min_=a))},module$exports$Blockly$FieldNumber.FieldNumber.prototype.getMin=function(){return this.min_},module$exports$Blockly$FieldNumber.FieldNumber.prototype.setMax=function(a){this.setMaxInternal_(a),this.setValue(this.getValue())},module$exports$Blockly$FieldNumber.FieldNumber.prototype.setMaxInternal_=function(a){null==a?this.max_=1/0:(a=Number(a),isNaN(a)||(this.max_=a))},module$exports$Blockly$FieldNumber.FieldNumber.prototype.getMax=function(){return this.max_},module$exports$Blockly$FieldNumber.FieldNumber.prototype.setPrecision=function(a){this.setPrecisionInternal_(a),this.setValue(this.getValue())},module$exports$Blockly$FieldNumber.FieldNumber.prototype.setPrecisionInternal_=function(a){this.precision_=Number(a)||0;var b=String(this.precision_);-1!==b.indexOf("e")&&(b=this.precision_.toLocaleString("en-US",{maximumFractionDigits:20}));var c=b.indexOf(".");this.decimalPlaces_=-1===c?a?0:null:b.length-c-1},module$exports$Blockly$FieldNumber.FieldNumber.prototype.getPrecision=function(){return this.precision_},module$exports$Blockly$FieldNumber.FieldNumber.prototype.doClassValidation_=function(a){return null===a?null:(a=(a=(a=(a=String(a)).replace(/O/gi,"0")).replace(/,/g,"")).replace(/infinity/i,"Infinity"),a=Number(a||0),isNaN(a)?null:(a=Math.min(Math.max(a,this.min_),this.max_),this.precision_&&isFinite(a)&&(a=Math.round(a/this.precision_)*this.precision_),null!==this.decimalPlaces_&&(a=Number(a.toFixed(this.decimalPlaces_))),a))},module$exports$Blockly$FieldNumber.FieldNumber.prototype.widgetCreate_=function(){var a=module$exports$Blockly$FieldNumber.FieldNumber.superClass_.widgetCreate_.call(this);return-1/0<this.min_&&(0,module$exports$Blockly$utils$aria.setState)(a,module$exports$Blockly$utils$aria.State.VALUEMIN,this.min_),1/0>this.max_&&(0,module$exports$Blockly$utils$aria.setState)(a,module$exports$Blockly$utils$aria.State.VALUEMAX,this.max_),a},(0,module$exports$Blockly$fieldRegistry.register)("field_number",module$exports$Blockly$FieldNumber.FieldNumber);var module$exports$Blockly$FieldMultilineInput={FieldMultilineInput:function(a,b,c){module$exports$Blockly$FieldMultilineInput.FieldMultilineInput.superClass_.constructor.call(this,a,b,c),this.textGroup_=null,this.maxLines_=1/0,this.isOverflowedY_=!1}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$FieldMultilineInput.FieldMultilineInput,$.module$exports$Blockly$FieldTextInput.FieldTextInput),module$exports$Blockly$FieldMultilineInput.FieldMultilineInput.prototype.configure_=function(a){module$exports$Blockly$FieldMultilineInput.FieldMultilineInput.superClass_.configure_.call(this,a),a.maxLines&&this.setMaxLines(a.maxLines)},module$exports$Blockly$FieldMultilineInput.FieldMultilineInput.fromJson=function(a){return new this((0,module$exports$Blockly$utils$parsing.replaceMessageReferences)(a.text),void 0,a)},module$exports$Blockly$FieldMultilineInput.FieldMultilineInput.prototype.toXml=function(a){return a.textContent=this.getValue().replace(/\n/g,"&#10;"),a},module$exports$Blockly$FieldMultilineInput.FieldMultilineInput.prototype.fromXml=function(a){this.setValue(a.textContent.replace(/&#10;/g,"\n"))},module$exports$Blockly$FieldMultilineInput.FieldMultilineInput.prototype.saveState=function(){var a=this.saveLegacyState(module$exports$Blockly$FieldMultilineInput.FieldMultilineInput);return null!==a?a:this.getValue()},module$exports$Blockly$FieldMultilineInput.FieldMultilineInput.prototype.loadState=function(a){this.loadLegacyState(module$exports$Blockly$Field.Field,a)||this.setValue(a)},module$exports$Blockly$FieldMultilineInput.FieldMultilineInput.prototype.initView=function(){this.createBorderRect_(),this.textGroup_=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.G,{class:"blocklyEditableText"},this.fieldGroup_)},module$exports$Blockly$FieldMultilineInput.FieldMultilineInput.prototype.getDisplayText_=function(){var a=this.getText();if(!a)return module$exports$Blockly$Field.Field.NBSP;var b=a.split("\n");a="";for(var c=this.isOverflowedY_?this.maxLines_:b.length,d=0;d<c;d++){var e=b[d];e.length>this.maxDisplayLength?e=e.substring(0,this.maxDisplayLength-4)+"...":this.isOverflowedY_&&d===c-1&&(e=e.substring(0,e.length-3)+"..."),a+=e=e.replace(/\s/g,module$exports$Blockly$Field.Field.NBSP),d!==c-1&&(a+="\n")}return this.sourceBlock_.RTL&&(a+=""),a},module$exports$Blockly$FieldMultilineInput.FieldMultilineInput.prototype.doValueUpdate_=function(a){module$exports$Blockly$FieldMultilineInput.FieldMultilineInput.superClass_.doValueUpdate_.call(this,a),this.isOverflowedY_=this.value_.split("\n").length>this.maxLines_},module$exports$Blockly$FieldMultilineInput.FieldMultilineInput.prototype.render_=function(){for(var a;a=this.textGroup_.firstChild;)this.textGroup_.removeChild(a);a=this.getDisplayText_().split("\n");for(var b=0,c=0;c<a.length;c++){var d=this.getConstants().FIELD_TEXT_HEIGHT+this.getConstants().FIELD_BORDER_RECT_Y_PADDING;(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.TEXT,{class:"blocklyText blocklyMultilineText",x:this.getConstants().FIELD_BORDER_RECT_X_PADDING,y:b+this.getConstants().FIELD_BORDER_RECT_Y_PADDING,dy:this.getConstants().FIELD_TEXT_BASELINE},this.textGroup_).appendChild(document.createTextNode(a[c])),b+=d}this.isBeingEdited_&&(a=this.htmlInput_,this.isOverflowedY_?(0,module$exports$Blockly$utils$dom.addClass)(a,"blocklyHtmlTextAreaInputOverflowedY"):(0,module$exports$Blockly$utils$dom.removeClass)(a,"blocklyHtmlTextAreaInputOverflowedY")),this.updateSize_(),this.isBeingEdited_&&(this.sourceBlock_.RTL?setTimeout(this.resizeEditor_.bind(this),0):this.resizeEditor_(),a=this.htmlInput_,this.isTextValid_?((0,module$exports$Blockly$utils$dom.removeClass)(a,"blocklyInvalidInput"),(0,module$exports$Blockly$utils$aria.setState)(a,module$exports$Blockly$utils$aria.State.INVALID,!1)):((0,module$exports$Blockly$utils$dom.addClass)(a,"blocklyInvalidInput"),(0,module$exports$Blockly$utils$aria.setState)(a,module$exports$Blockly$utils$aria.State.INVALID,!0)))},module$exports$Blockly$FieldMultilineInput.FieldMultilineInput.prototype.updateSize_=function(){for(var a=this.textGroup_.childNodes,b=0,c=0,d=0;d<a.length;d++){var e=(0,module$exports$Blockly$utils$dom.getTextWidth)(a[d]);e>b&&(b=e),c+=this.getConstants().FIELD_TEXT_HEIGHT+(0<d?this.getConstants().FIELD_BORDER_RECT_Y_PADDING:0)}if(this.isBeingEdited_){a=this.value_.split("\n"),d=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.TEXT,{class:"blocklyText blocklyMultilineText"}),e=this.getConstants().FIELD_TEXT_FONTSIZE;for(var f=this.getConstants().FIELD_TEXT_FONTWEIGHT,g=this.getConstants().FIELD_TEXT_FONTFAMILY,h=0;h<a.length;h++){a[h].length>this.maxDisplayLength&&(a[h]=a[h].substring(0,this.maxDisplayLength)),d.textContent=a[h];var k=(0,module$exports$Blockly$utils$dom.getFastTextWidth)(d,e,f,g);k>b&&(b=k)}b+=this.htmlInput_.offsetWidth-this.htmlInput_.clientWidth}this.borderRect_&&(c+=2*this.getConstants().FIELD_BORDER_RECT_Y_PADDING,b+=2*this.getConstants().FIELD_BORDER_RECT_X_PADDING,this.borderRect_.setAttribute("width",b),this.borderRect_.setAttribute("height",c)),this.size_.width=b,this.size_.height=c,this.positionBorderRect_()},module$exports$Blockly$FieldMultilineInput.FieldMultilineInput.prototype.showEditor_=function(a,b){module$exports$Blockly$FieldMultilineInput.FieldMultilineInput.superClass_.showEditor_.call(this,a,b),this.forceRerender()},module$exports$Blockly$FieldMultilineInput.FieldMultilineInput.prototype.widgetCreate_=function(){var a=(0,module$exports$Blockly$WidgetDiv.getDiv)(),b=this.workspace_.getScale(),c=document.createElement("textarea");c.className="blocklyHtmlInput blocklyHtmlTextAreaInput",c.setAttribute("spellcheck",this.spellcheck_);var d=this.getConstants().FIELD_TEXT_FONTSIZE*b+"pt";a.style.fontSize=d,c.style.fontSize=d,c.style.borderRadius=$.module$exports$Blockly$FieldTextInput.FieldTextInput.BORDERRADIUS*b+"px",d=this.getConstants().FIELD_BORDER_RECT_X_PADDING*b;var e=this.getConstants().FIELD_BORDER_RECT_Y_PADDING*b/2;return c.style.padding=e+"px "+d+"px "+e+"px "+d+"px",d=this.getConstants().FIELD_TEXT_HEIGHT+this.getConstants().FIELD_BORDER_RECT_Y_PADDING,c.style.lineHeight=d*b+"px",a.appendChild(c),c.value=c.defaultValue=this.getEditorText_(this.value_),c.untypedDefaultValue_=this.value_,c.oldValue_=null,module$exports$Blockly$utils$userAgent.GECKO?setTimeout(this.resizeEditor_.bind(this),0):this.resizeEditor_(),this.bindInputEvents_(c),c},module$exports$Blockly$FieldMultilineInput.FieldMultilineInput.prototype.setMaxLines=function(a){"number"==typeof a&&0<a&&a!==this.maxLines_&&(this.maxLines_=a,this.forceRerender())},module$exports$Blockly$FieldMultilineInput.FieldMultilineInput.prototype.getMaxLines=function(){return this.maxLines_},module$exports$Blockly$FieldMultilineInput.FieldMultilineInput.prototype.onHtmlInputKeyDown_=function(a){a.keyCode!==module$exports$Blockly$utils$KeyCodes_KeyCodes.ENTER&&module$exports$Blockly$FieldMultilineInput.FieldMultilineInput.superClass_.onHtmlInputKeyDown_.call(this,a)},(0,module$exports$Blockly$Css.register)("\n  .blocklyHtmlTextAreaInput {\n    font-family: monospace;\n    resize: none;\n    overflow: hidden;\n    height: 100%;\n    text-align: left;\n  }\n\n  .blocklyHtmlTextAreaInputOverflowedY {\n    overflow-y: scroll;\n  }\n"),(0,module$exports$Blockly$fieldRegistry.register)("field_multilinetext",module$exports$Blockly$FieldMultilineInput.FieldMultilineInput);var module$exports$Blockly$FieldLabelSerializable={FieldLabelSerializable:function(a,b,c){module$exports$Blockly$FieldLabelSerializable.FieldLabelSerializable.superClass_.constructor.call(this,a,b,c)}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$FieldLabelSerializable.FieldLabelSerializable,$.module$exports$Blockly$FieldLabel.FieldLabel),module$exports$Blockly$FieldLabelSerializable.FieldLabelSerializable.fromJson=function(a){return new this((0,module$exports$Blockly$utils$parsing.replaceMessageReferences)(a.text),void 0,a)},module$exports$Blockly$FieldLabelSerializable.FieldLabelSerializable.prototype.EDITABLE=!1,module$exports$Blockly$FieldLabelSerializable.FieldLabelSerializable.prototype.SERIALIZABLE=!0,(0,module$exports$Blockly$fieldRegistry.register)("field_label_serializable",module$exports$Blockly$FieldLabelSerializable.FieldLabelSerializable);var module$exports$Blockly$FieldColour={FieldColour:function(a,b,c){module$exports$Blockly$FieldColour.FieldColour.superClass_.constructor.call(this,a,b,c),this.onKeyDownWrapper_=this.onMouseLeaveWrapper_=this.onMouseEnterWrapper_=this.onMouseMoveWrapper_=this.onClickWrapper_=this.highlightedIndex_=this.picker_=null}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$FieldColour.FieldColour,module$exports$Blockly$Field.Field),module$exports$Blockly$FieldColour.FieldColour.fromJson=function(a){return new this(a.colour,void 0,a)},module$exports$Blockly$FieldColour.FieldColour.prototype.SERIALIZABLE=!0,module$exports$Blockly$FieldColour.FieldColour.prototype.CURSOR="default",module$exports$Blockly$FieldColour.FieldColour.prototype.isDirty_=!1,module$exports$Blockly$FieldColour.FieldColour.prototype.colours_=null,module$exports$Blockly$FieldColour.FieldColour.prototype.titles_=null,module$exports$Blockly$FieldColour.FieldColour.prototype.columns_=0,module$exports$Blockly$FieldColour.FieldColour.prototype.configure_=function(a){module$exports$Blockly$FieldColour.FieldColour.superClass_.configure_.call(this,a),a.colourOptions&&(this.colours_=a.colourOptions,this.titles_=a.colourTitles),a.columns&&(this.columns_=a.columns)},module$exports$Blockly$FieldColour.FieldColour.prototype.initView=function(){this.size_=new module$exports$Blockly$utils$Size.Size(this.getConstants().FIELD_COLOUR_DEFAULT_WIDTH,this.getConstants().FIELD_COLOUR_DEFAULT_HEIGHT),this.getConstants().FIELD_COLOUR_FULL_BLOCK?this.clickTarget_=this.sourceBlock_.getSvgRoot():(this.createBorderRect_(),this.borderRect_.style.fillOpacity="1")},module$exports$Blockly$FieldColour.FieldColour.prototype.applyColour=function(){this.getConstants().FIELD_COLOUR_FULL_BLOCK?(this.sourceBlock_.pathObject.svgPath.setAttribute("fill",this.getValue()),this.sourceBlock_.pathObject.svgPath.setAttribute("stroke","#fff")):this.borderRect_&&(this.borderRect_.style.fill=this.getValue())},module$exports$Blockly$FieldColour.FieldColour.prototype.doClassValidation_=function(a){return"string"!=typeof a?null:(0,module$exports$Blockly$utils$colour.parse)(a)},module$exports$Blockly$FieldColour.FieldColour.prototype.doValueUpdate_=function(a){this.value_=a,this.borderRect_?this.borderRect_.style.fill=a:this.sourceBlock_&&this.sourceBlock_.rendered&&(this.sourceBlock_.pathObject.svgPath.setAttribute("fill",a),this.sourceBlock_.pathObject.svgPath.setAttribute("stroke","#fff"))},module$exports$Blockly$FieldColour.FieldColour.prototype.getText=function(){var a=this.value_;return/^#(.)\1(.)\2(.)\3$/.test(a)&&(a="#"+a[1]+a[3]+a[5]),a},module$exports$Blockly$FieldColour.FieldColour.COLOURS="#ffffff #cccccc #c0c0c0 #999999 #666666 #333333 #000000 #ffcccc #ff6666 #ff0000 #cc0000 #990000 #660000 #330000 #ffcc99 #ff9966 #ff9900 #ff6600 #cc6600 #993300 #663300 #ffff99 #ffff66 #ffcc66 #ffcc33 #cc9933 #996633 #663333 #ffffcc #ffff33 #ffff00 #ffcc00 #999900 #666600 #333300 #99ff99 #66ff99 #33ff33 #33cc00 #009900 #006600 #003300 #99ffff #33ffff #66cccc #00cccc #339999 #336666 #003333 #ccffff #66ffff #33ccff #3366ff #3333ff #000099 #000066 #ccccff #9999ff #6666cc #6633ff #6600cc #333399 #330099 #ffccff #ff99ff #cc66cc #cc33cc #993399 #663366 #330033".split(" "),module$exports$Blockly$FieldColour.FieldColour.prototype.DEFAULT_VALUE=module$exports$Blockly$FieldColour.FieldColour.COLOURS[0],module$exports$Blockly$FieldColour.FieldColour.TITLES=[],module$exports$Blockly$FieldColour.FieldColour.COLUMNS=7,module$exports$Blockly$FieldColour.FieldColour.prototype.setColours=function(a,b){return this.colours_=a,b&&(this.titles_=b),this},module$exports$Blockly$FieldColour.FieldColour.prototype.setColumns=function(a){return this.columns_=a,this},module$exports$Blockly$FieldColour.FieldColour.prototype.showEditor_=function(){this.dropdownCreate_(),module$exports$Blockly$DropDownDiv.DropDownDiv.getContentDiv().appendChild(this.picker_),module$exports$Blockly$DropDownDiv.DropDownDiv.showPositionedByField(this,this.dropdownDispose_.bind(this)),this.picker_.focus({preventScroll:!0})},module$exports$Blockly$FieldColour.FieldColour.prototype.onClick_=function(a){null!==(a=(a=a.target)&&a.label)&&(this.setValue(a),module$exports$Blockly$DropDownDiv.DropDownDiv.hideIfOwner(this))},module$exports$Blockly$FieldColour.FieldColour.prototype.onKeyDown_=function(a){var b=!1;a.keyCode===module$exports$Blockly$utils$KeyCodes_KeyCodes.UP?(this.moveHighlightBy_(0,-1),b=!0):a.keyCode===module$exports$Blockly$utils$KeyCodes_KeyCodes.DOWN?(this.moveHighlightBy_(0,1),b=!0):a.keyCode===module$exports$Blockly$utils$KeyCodes_KeyCodes.LEFT?(this.moveHighlightBy_(-1,0),b=!0):a.keyCode===module$exports$Blockly$utils$KeyCodes_KeyCodes.RIGHT?(this.moveHighlightBy_(1,0),b=!0):a.keyCode===module$exports$Blockly$utils$KeyCodes_KeyCodes.ENTER&&((b=this.getHighlighted_())&&null!==(b=b&&b.label)&&this.setValue(b),module$exports$Blockly$DropDownDiv.DropDownDiv.hideWithoutAnimation(),b=!0),b&&a.stopPropagation()},module$exports$Blockly$FieldColour.FieldColour.prototype.moveHighlightBy_=function(a,b){var c=this.colours_||module$exports$Blockly$FieldColour.FieldColour.COLOURS,d=this.columns_||module$exports$Blockly$FieldColour.FieldColour.COLUMNS,e=this.highlightedIndex_%d,f=Math.floor(this.highlightedIndex_/d);e+=a,f+=b,0>a?0>e&&0<f?(e=d-1,f--):0>e&&(e=0):0<a?e>d-1&&f<Math.floor(c.length/d)-1?(e=0,f++):e>d-1&&e--:0>b?0>f&&(f=0):0<b&&f>Math.floor(c.length/d)-1&&(f=Math.floor(c.length/d)-1),this.setHighlightedCell_(this.picker_.childNodes[f].childNodes[e],f*d+e)},module$exports$Blockly$FieldColour.FieldColour.prototype.onMouseMove_=function(a){var b=(a=a.target)&&Number(a.getAttribute("data-index"));null!==b&&b!==this.highlightedIndex_&&this.setHighlightedCell_(a,b)},module$exports$Blockly$FieldColour.FieldColour.prototype.onMouseEnter_=function(){this.picker_.focus({preventScroll:!0})},module$exports$Blockly$FieldColour.FieldColour.prototype.onMouseLeave_=function(){this.picker_.blur();var a=this.getHighlighted_();a&&(0,module$exports$Blockly$utils$dom.removeClass)(a,"blocklyColourHighlighted")},module$exports$Blockly$FieldColour.FieldColour.prototype.getHighlighted_=function(){var a=this.columns_||module$exports$Blockly$FieldColour.FieldColour.COLUMNS,b=this.picker_.childNodes[Math.floor(this.highlightedIndex_/a)];return b?b.childNodes[this.highlightedIndex_%a]:null},module$exports$Blockly$FieldColour.FieldColour.prototype.setHighlightedCell_=function(a,b){var c=this.getHighlighted_();c&&(0,module$exports$Blockly$utils$dom.removeClass)(c,"blocklyColourHighlighted"),(0,module$exports$Blockly$utils$dom.addClass)(a,"blocklyColourHighlighted"),this.highlightedIndex_=b,(0,module$exports$Blockly$utils$aria.setState)(this.picker_,module$exports$Blockly$utils$aria.State.ACTIVEDESCENDANT,a.getAttribute("id"))},module$exports$Blockly$FieldColour.FieldColour.prototype.dropdownCreate_=function(){var a=this.columns_||module$exports$Blockly$FieldColour.FieldColour.COLUMNS,b=this.colours_||module$exports$Blockly$FieldColour.FieldColour.COLOURS,c=this.titles_||module$exports$Blockly$FieldColour.FieldColour.TITLES,d=this.getValue(),e=document.createElement("table");e.className="blocklyColourTable",e.tabIndex=0,e.dir="ltr",(0,module$exports$Blockly$utils$aria.setRole)(e,module$exports$Blockly$utils$aria.Role.GRID),(0,module$exports$Blockly$utils$aria.setState)(e,module$exports$Blockly$utils$aria.State.EXPANDED,!0),(0,module$exports$Blockly$utils$aria.setState)(e,module$exports$Blockly$utils$aria.State.ROWCOUNT,Math.floor(b.length/a)),(0,module$exports$Blockly$utils$aria.setState)(e,module$exports$Blockly$utils$aria.State.COLCOUNT,a);for(var f,g=0;g<b.length;g++){0==g%a&&(f=document.createElement("tr"),(0,module$exports$Blockly$utils$aria.setRole)(f,module$exports$Blockly$utils$aria.Role.ROW),e.appendChild(f));var h=document.createElement("td");f.appendChild(h),h.label=b[g],h.title=c[g]||b[g],h.id=(0,module$exports$Blockly$utils$idGenerator.getNextUniqueId)(),h.setAttribute("data-index",g),(0,module$exports$Blockly$utils$aria.setRole)(h,module$exports$Blockly$utils$aria.Role.GRIDCELL),(0,module$exports$Blockly$utils$aria.setState)(h,module$exports$Blockly$utils$aria.State.LABEL,b[g]),(0,module$exports$Blockly$utils$aria.setState)(h,module$exports$Blockly$utils$aria.State.SELECTED,b[g]===d),h.style.backgroundColor=b[g],b[g]===d&&(h.className="blocklyColourSelected",this.highlightedIndex_=g)}this.onClickWrapper_=(0,module$exports$Blockly$browserEvents.conditionalBind)(e,"click",this,this.onClick_,!0),this.onMouseMoveWrapper_=(0,module$exports$Blockly$browserEvents.conditionalBind)(e,"mousemove",this,this.onMouseMove_,!0),this.onMouseEnterWrapper_=(0,module$exports$Blockly$browserEvents.conditionalBind)(e,"mouseenter",this,this.onMouseEnter_,!0),this.onMouseLeaveWrapper_=(0,module$exports$Blockly$browserEvents.conditionalBind)(e,"mouseleave",this,this.onMouseLeave_,!0),this.onKeyDownWrapper_=(0,module$exports$Blockly$browserEvents.conditionalBind)(e,"keydown",this,this.onKeyDown_),this.picker_=e},module$exports$Blockly$FieldColour.FieldColour.prototype.dropdownDispose_=function(){this.onClickWrapper_&&((0,module$exports$Blockly$browserEvents.unbind)(this.onClickWrapper_),this.onClickWrapper_=null),this.onMouseMoveWrapper_&&((0,module$exports$Blockly$browserEvents.unbind)(this.onMouseMoveWrapper_),this.onMouseMoveWrapper_=null),this.onMouseEnterWrapper_&&((0,module$exports$Blockly$browserEvents.unbind)(this.onMouseEnterWrapper_),this.onMouseEnterWrapper_=null),this.onMouseLeaveWrapper_&&((0,module$exports$Blockly$browserEvents.unbind)(this.onMouseLeaveWrapper_),this.onMouseLeaveWrapper_=null),this.onKeyDownWrapper_&&((0,module$exports$Blockly$browserEvents.unbind)(this.onKeyDownWrapper_),this.onKeyDownWrapper_=null),this.highlightedIndex_=this.picker_=null},(0,module$exports$Blockly$Css.register)("\n  .blocklyColourTable {\n    border-collapse: collapse;\n    display: block;\n    outline: none;\n    padding: 1px;\n  }\n\n  .blocklyColourTable>tr>td {\n    border: .5px solid #888;\n    box-sizing: border-box;\n    cursor: pointer;\n    display: inline-block;\n    height: 20px;\n    padding: 0;\n    width: 20px;\n  }\n\n  .blocklyColourTable>tr>td.blocklyColourHighlighted {\n    border-color: #eee;\n    box-shadow: 2px 2px 7px 2px rgba(0,0,0,.3);\n    position: relative;\n  }\n\n  .blocklyColourSelected, .blocklyColourSelected:hover {\n    border-color: #eee !important;\n    outline: 1px solid #333;\n    position: relative;\n  }\n"),(0,module$exports$Blockly$fieldRegistry.register)("field_colour",module$exports$Blockly$FieldColour.FieldColour),$.module$exports$Blockly$FieldCheckbox={FieldCheckbox:function(a,b,c){this.checkChar_=null,$.module$exports$Blockly$FieldCheckbox.FieldCheckbox.superClass_.constructor.call(this,a,b,c)}},(0,$.module$exports$Blockly$utils$object.inherits)($.module$exports$Blockly$FieldCheckbox.FieldCheckbox,module$exports$Blockly$Field.Field),$.module$exports$Blockly$FieldCheckbox.FieldCheckbox.prototype.DEFAULT_VALUE=!1,$.module$exports$Blockly$FieldCheckbox.FieldCheckbox.fromJson=function(a){return new this(a.checked,void 0,a)},$.module$exports$Blockly$FieldCheckbox.FieldCheckbox.CHECK_CHAR="",$.module$exports$Blockly$FieldCheckbox.FieldCheckbox.prototype.SERIALIZABLE=!0,$.module$exports$Blockly$FieldCheckbox.FieldCheckbox.prototype.CURSOR="default",$.module$exports$Blockly$FieldCheckbox.FieldCheckbox.prototype.configure_=function(a){$.module$exports$Blockly$FieldCheckbox.FieldCheckbox.superClass_.configure_.call(this,a),a.checkCharacter&&(this.checkChar_=a.checkCharacter)},$.module$exports$Blockly$FieldCheckbox.FieldCheckbox.prototype.saveState=function(){var a=this.saveLegacyState($.module$exports$Blockly$FieldCheckbox.FieldCheckbox);return null!==a?a:this.getValueBoolean()},$.module$exports$Blockly$FieldCheckbox.FieldCheckbox.prototype.initView=function(){$.module$exports$Blockly$FieldCheckbox.FieldCheckbox.superClass_.initView.call(this),(0,module$exports$Blockly$utils$dom.addClass)(this.textElement_,"blocklyCheckbox"),this.textElement_.style.display=this.value_?"block":"none"},$.module$exports$Blockly$FieldCheckbox.FieldCheckbox.prototype.render_=function(){this.textContent_&&(this.textContent_.nodeValue=this.getDisplayText_()),this.updateSize_(this.getConstants().FIELD_CHECKBOX_X_OFFSET)},$.module$exports$Blockly$FieldCheckbox.FieldCheckbox.prototype.getDisplayText_=function(){return this.checkChar_||$.module$exports$Blockly$FieldCheckbox.FieldCheckbox.CHECK_CHAR},$.module$exports$Blockly$FieldCheckbox.FieldCheckbox.prototype.setCheckCharacter=function(a){this.checkChar_=a,this.forceRerender()},$.module$exports$Blockly$FieldCheckbox.FieldCheckbox.prototype.showEditor_=function(){this.setValue(!this.value_)},$.module$exports$Blockly$FieldCheckbox.FieldCheckbox.prototype.doClassValidation_=function(a){return!0===a||"TRUE"===a?"TRUE":!1===a||"FALSE"===a?"FALSE":null},$.module$exports$Blockly$FieldCheckbox.FieldCheckbox.prototype.doValueUpdate_=function(a){this.value_=this.convertValueToBool_(a),this.textElement_&&(this.textElement_.style.display=this.value_?"block":"none")},$.module$exports$Blockly$FieldCheckbox.FieldCheckbox.prototype.getValue=function(){return this.value_?"TRUE":"FALSE"},$.module$exports$Blockly$FieldCheckbox.FieldCheckbox.prototype.getValueBoolean=function(){return this.value_},$.module$exports$Blockly$FieldCheckbox.FieldCheckbox.prototype.getText=function(){return String(this.convertValueToBool_(this.value_))},$.module$exports$Blockly$FieldCheckbox.FieldCheckbox.prototype.convertValueToBool_=function(a){return"string"==typeof a?"TRUE"===a:!!a},(0,module$exports$Blockly$fieldRegistry.register)("field_checkbox",$.module$exports$Blockly$FieldCheckbox.FieldCheckbox);var module$exports$Blockly$FieldAngle={FieldAngle:function(a,b,c){this.clockwise_=module$exports$Blockly$FieldAngle.FieldAngle.CLOCKWISE,this.offset_=module$exports$Blockly$FieldAngle.FieldAngle.OFFSET,this.wrap_=module$exports$Blockly$FieldAngle.FieldAngle.WRAP,this.round_=module$exports$Blockly$FieldAngle.FieldAngle.ROUND,module$exports$Blockly$FieldAngle.FieldAngle.superClass_.constructor.call(this,a,b,c),this.moveSurfaceWrapper_=this.clickSurfaceWrapper_=this.clickWrapper_=this.line_=this.gauge_=this.editor_=null}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$FieldAngle.FieldAngle,$.module$exports$Blockly$FieldTextInput.FieldTextInput),module$exports$Blockly$FieldAngle.FieldAngle.prototype.DEFAULT_VALUE=0,module$exports$Blockly$FieldAngle.FieldAngle.fromJson=function(a){return new this(a.angle,void 0,a)},module$exports$Blockly$FieldAngle.FieldAngle.prototype.SERIALIZABLE=!0,module$exports$Blockly$FieldAngle.FieldAngle.ROUND=15,module$exports$Blockly$FieldAngle.FieldAngle.HALF=50,module$exports$Blockly$FieldAngle.FieldAngle.CLOCKWISE=!1,module$exports$Blockly$FieldAngle.FieldAngle.OFFSET=0,module$exports$Blockly$FieldAngle.FieldAngle.WRAP=360,module$exports$Blockly$FieldAngle.FieldAngle.RADIUS=module$exports$Blockly$FieldAngle.FieldAngle.HALF-1,module$exports$Blockly$FieldAngle.FieldAngle.prototype.configure_=function(a){switch(module$exports$Blockly$FieldAngle.FieldAngle.superClass_.configure_.call(this,a),a.mode){case"compass":this.clockwise_=!0,this.offset_=90;break;case"protractor":this.clockwise_=!1,this.offset_=0}var b=a.clockwise;"boolean"==typeof b&&(this.clockwise_=b),null!==(b=a.offset)&&(b=Number(b),isNaN(b)||(this.offset_=b)),null!==(b=a.wrap)&&(b=Number(b),isNaN(b)||(this.wrap_=b)),null!==(a=a.round)&&(a=Number(a),isNaN(a)||(this.round_=a))},module$exports$Blockly$FieldAngle.FieldAngle.prototype.initView=function(){module$exports$Blockly$FieldAngle.FieldAngle.superClass_.initView.call(this),this.symbol_=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.TSPAN,{},null),this.symbol_.appendChild(document.createTextNode("")),this.textElement_.appendChild(this.symbol_)},module$exports$Blockly$FieldAngle.FieldAngle.prototype.render_=function(){module$exports$Blockly$FieldAngle.FieldAngle.superClass_.render_.call(this),this.updateGraph_()},module$exports$Blockly$FieldAngle.FieldAngle.prototype.showEditor_=function(a){module$exports$Blockly$FieldAngle.FieldAngle.superClass_.showEditor_.call(this,a,module$exports$Blockly$utils$userAgent.MOBILE||module$exports$Blockly$utils$userAgent.ANDROID||module$exports$Blockly$utils$userAgent.IPAD),this.dropdownCreate_(),module$exports$Blockly$DropDownDiv.DropDownDiv.getContentDiv().appendChild(this.editor_),module$exports$Blockly$DropDownDiv.DropDownDiv.setColour(this.sourceBlock_.style.colourPrimary,this.sourceBlock_.style.colourTertiary),module$exports$Blockly$DropDownDiv.DropDownDiv.showPositionedByField(this,this.dropdownDispose_.bind(this)),this.updateGraph_()},module$exports$Blockly$FieldAngle.FieldAngle.prototype.dropdownCreate_=function(){var a=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.SVG,{xmlns:module$exports$Blockly$utils$dom.SVG_NS,"xmlns:html":module$exports$Blockly$utils$dom.HTML_NS,"xmlns:xlink":module$exports$Blockly$utils$dom.XLINK_NS,version:"1.1",height:2*module$exports$Blockly$FieldAngle.FieldAngle.HALF+"px",width:2*module$exports$Blockly$FieldAngle.FieldAngle.HALF+"px",style:"touch-action: none"},null),b=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.CIRCLE,{cx:module$exports$Blockly$FieldAngle.FieldAngle.HALF,cy:module$exports$Blockly$FieldAngle.FieldAngle.HALF,r:module$exports$Blockly$FieldAngle.FieldAngle.RADIUS,class:"blocklyAngleCircle"},a);this.gauge_=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.PATH,{class:"blocklyAngleGauge"},a),this.line_=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.LINE,{x1:module$exports$Blockly$FieldAngle.FieldAngle.HALF,y1:module$exports$Blockly$FieldAngle.FieldAngle.HALF,class:"blocklyAngleLine"},a);for(var c=0;360>c;c+=15)(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.LINE,{x1:module$exports$Blockly$FieldAngle.FieldAngle.HALF+module$exports$Blockly$FieldAngle.FieldAngle.RADIUS,y1:module$exports$Blockly$FieldAngle.FieldAngle.HALF,x2:module$exports$Blockly$FieldAngle.FieldAngle.HALF+module$exports$Blockly$FieldAngle.FieldAngle.RADIUS-(0==c%45?10:5),y2:module$exports$Blockly$FieldAngle.FieldAngle.HALF,class:"blocklyAngleMarks",transform:"rotate("+c+","+module$exports$Blockly$FieldAngle.FieldAngle.HALF+","+module$exports$Blockly$FieldAngle.FieldAngle.HALF+")"},a);this.clickWrapper_=(0,module$exports$Blockly$browserEvents.conditionalBind)(a,"click",this,this.hide_),this.clickSurfaceWrapper_=(0,module$exports$Blockly$browserEvents.conditionalBind)(b,"click",this,this.onMouseMove_,!0,!0),this.moveSurfaceWrapper_=(0,module$exports$Blockly$browserEvents.conditionalBind)(b,"mousemove",this,this.onMouseMove_,!0,!0),this.editor_=a},module$exports$Blockly$FieldAngle.FieldAngle.prototype.dropdownDispose_=function(){this.clickWrapper_&&((0,module$exports$Blockly$browserEvents.unbind)(this.clickWrapper_),this.clickWrapper_=null),this.clickSurfaceWrapper_&&((0,module$exports$Blockly$browserEvents.unbind)(this.clickSurfaceWrapper_),this.clickSurfaceWrapper_=null),this.moveSurfaceWrapper_&&((0,module$exports$Blockly$browserEvents.unbind)(this.moveSurfaceWrapper_),this.moveSurfaceWrapper_=null),this.line_=this.gauge_=null},module$exports$Blockly$FieldAngle.FieldAngle.prototype.hide_=function(){module$exports$Blockly$DropDownDiv.DropDownDiv.hideIfOwner(this),(0,module$exports$Blockly$WidgetDiv.hide)()},module$exports$Blockly$FieldAngle.FieldAngle.prototype.onMouseMove_=function(a){var b=this.gauge_.ownerSVGElement.getBoundingClientRect(),c=a.clientX-b.left-module$exports$Blockly$FieldAngle.FieldAngle.HALF;a=a.clientY-b.top-module$exports$Blockly$FieldAngle.FieldAngle.HALF,b=Math.atan(-a/c),isNaN(b)||(b=(0,module$exports$Blockly$utils$math.toDegrees)(b),0>c?b+=180:0<a&&(b+=360),b=this.clockwise_?this.offset_+360-b:360-(this.offset_-b),this.displayMouseOrKeyboardValue_(b))},module$exports$Blockly$FieldAngle.FieldAngle.prototype.displayMouseOrKeyboardValue_=function(a){this.round_&&(a=Math.round(a/this.round_)*this.round_),(a=this.wrapValue_(a))!==this.value_&&this.setEditorValue_(a)},module$exports$Blockly$FieldAngle.FieldAngle.prototype.updateGraph_=function(){if(this.gauge_){var a=Number(this.getText())+this.offset_,b=(0,module$exports$Blockly$utils$math.toRadians)(a%360);a=["M ",module$exports$Blockly$FieldAngle.FieldAngle.HALF,",",module$exports$Blockly$FieldAngle.FieldAngle.HALF];var c=module$exports$Blockly$FieldAngle.FieldAngle.HALF,d=module$exports$Blockly$FieldAngle.FieldAngle.HALF;if(!isNaN(b)){var e=Number(this.clockwise_),f=(0,module$exports$Blockly$utils$math.toRadians)(this.offset_),g=Math.cos(f)*module$exports$Blockly$FieldAngle.FieldAngle.RADIUS,h=Math.sin(f)*-module$exports$Blockly$FieldAngle.FieldAngle.RADIUS;e&&(b=2*f-b),c+=Math.cos(b)*module$exports$Blockly$FieldAngle.FieldAngle.RADIUS,d-=Math.sin(b)*module$exports$Blockly$FieldAngle.FieldAngle.RADIUS,b=Math.abs(Math.floor((b-f)/Math.PI)%2),e&&(b=1-b),a.push(" l ",g,",",h," A ",module$exports$Blockly$FieldAngle.FieldAngle.RADIUS,",",module$exports$Blockly$FieldAngle.FieldAngle.RADIUS," 0 ",b," ",e," ",c,",",d," z")}this.gauge_.setAttribute("d",a.join("")),this.line_.setAttribute("x2",c),this.line_.setAttribute("y2",d)}},module$exports$Blockly$FieldAngle.FieldAngle.prototype.onHtmlInputKeyDown_=function(a){var b;if(module$exports$Blockly$FieldAngle.FieldAngle.superClass_.onHtmlInputKeyDown_.call(this,a),a.keyCode===module$exports$Blockly$utils$KeyCodes_KeyCodes.LEFT?b=this.sourceBlock_.RTL?1:-1:a.keyCode===module$exports$Blockly$utils$KeyCodes_KeyCodes.RIGHT?b=this.sourceBlock_.RTL?-1:1:a.keyCode===module$exports$Blockly$utils$KeyCodes_KeyCodes.DOWN?b=-1:a.keyCode===module$exports$Blockly$utils$KeyCodes_KeyCodes.UP&&(b=1),b){var c=this.getValue();this.displayMouseOrKeyboardValue_(c+b*this.round_),a.preventDefault(),a.stopPropagation()}},module$exports$Blockly$FieldAngle.FieldAngle.prototype.doClassValidation_=function(a){return a=Number(a),isNaN(a)||!isFinite(a)?null:this.wrapValue_(a)},module$exports$Blockly$FieldAngle.FieldAngle.prototype.wrapValue_=function(a){return 0>(a%=360)&&(a+=360),a>this.wrap_&&(a-=360),a},(0,module$exports$Blockly$Css.register)("\n  .blocklyAngleCircle {\n    stroke: #444;\n    stroke-width: 1;\n    fill: #ddd;\n    fill-opacity: .8;\n  }\n\n  .blocklyAngleMarks {\n    stroke: #444;\n    stroke-width: 1;\n  }\n\n  .blocklyAngleGauge {\n    fill: #f88;\n    fill-opacity: .8;\n    pointer-events: none;\n  }\n\n  .blocklyAngleLine {\n    stroke: #f00;\n    stroke-width: 2;\n    stroke-linecap: round;\n    pointer-events: none;\n  }\n"),(0,module$exports$Blockly$fieldRegistry.register)("field_angle",module$exports$Blockly$FieldAngle.FieldAngle);var module$exports$Blockly$zelos$TopRow={TopRow:function(a){module$exports$Blockly$zelos$TopRow.TopRow.superClass_.constructor.call(this,a)}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$zelos$TopRow.TopRow,module$exports$Blockly$blockRendering$TopRow.TopRow),module$exports$Blockly$zelos$TopRow.TopRow.prototype.endsWithElemSpacer=function(){return!1},module$exports$Blockly$zelos$TopRow.TopRow.prototype.hasLeftSquareCorner=function(a){var b=(a.hat?"cap"===a.hat:this.constants_.ADD_START_HATS)&&!a.outputConnection&&!a.previousConnection;return!!a.outputConnection||b},module$exports$Blockly$zelos$TopRow.TopRow.prototype.hasRightSquareCorner=function(a){return!!a.outputConnection&&!a.statementInputCount&&!a.nextConnection};var module$exports$Blockly$zelos$StatementInput={StatementInput:function(a,b){if(module$exports$Blockly$zelos$StatementInput.StatementInput.superClass_.constructor.call(this,a,b),this.connectedBlock){for(a=this.connectedBlock;b=a.getNextBlock();)a=b;a.nextConnection||(this.height=this.connectedBlockHeight,this.connectedBottomNextConnection=!0)}}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$zelos$StatementInput.StatementInput,module$exports$Blockly$blockRendering$StatementInput.StatementInput);var module$exports$Blockly$zelos$RightConnectionShape={RightConnectionShape:function(a){module$exports$Blockly$zelos$RightConnectionShape.RightConnectionShape.superClass_.constructor.call(this,a),this.type|=module$exports$Blockly$blockRendering$Types.Types.getType("RIGHT_CONNECTION"),this.width=this.height=0}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$zelos$RightConnectionShape.RightConnectionShape,module$exports$Blockly$blockRendering$Measurable_Measurable);var module$exports$Blockly$zelos$MarkerSvg={MarkerSvg:function(a,b,c){module$exports$Blockly$zelos$MarkerSvg.MarkerSvg.superClass_.constructor.call(this,a,b,c)}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$zelos$MarkerSvg.MarkerSvg,module$exports$Blockly$blockRendering$MarkerSvg.MarkerSvg),module$exports$Blockly$zelos$MarkerSvg.MarkerSvg.prototype.showWithInputOutput_=function(a){var b=a.getSourceBlock();a=a.getLocation().getOffsetInBlock(),this.positionCircle_(a.x,a.y),this.setParent_(b),this.showCurrent_()},module$exports$Blockly$zelos$MarkerSvg.MarkerSvg.prototype.showWithOutput_=function(a){this.showWithInputOutput_(a)},module$exports$Blockly$zelos$MarkerSvg.MarkerSvg.prototype.showWithInput_=function(a){this.showWithInputOutput_(a)},module$exports$Blockly$zelos$MarkerSvg.MarkerSvg.prototype.showWithBlock_=function(a){var b=(a=a.getLocation()).getHeightWidth();this.positionRect_(0,0,b.width,b.height),this.setParent_(a),this.showCurrent_()},module$exports$Blockly$zelos$MarkerSvg.MarkerSvg.prototype.positionCircle_=function(a,b){this.markerCircle_.setAttribute("cx",a),this.markerCircle_.setAttribute("cy",b),this.currentMarkerSvg=this.markerCircle_},module$exports$Blockly$zelos$MarkerSvg.MarkerSvg.prototype.hide=function(){module$exports$Blockly$zelos$MarkerSvg.MarkerSvg.superClass_.hide.call(this),this.markerCircle_.style.display="none"},module$exports$Blockly$zelos$MarkerSvg.MarkerSvg.prototype.createDomInternal_=function(){if(module$exports$Blockly$zelos$MarkerSvg.MarkerSvg.superClass_.createDomInternal_.call(this),this.markerCircle_=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.CIRCLE,{r:this.constants_.CURSOR_RADIUS,style:"display: none","stroke-width":this.constants_.CURSOR_STROKE_WIDTH},this.markerSvg_),this.isCursor()){var a=this.getBlinkProperties_();(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.ANIMATE,a,this.markerCircle_)}return this.markerSvg_},module$exports$Blockly$zelos$MarkerSvg.MarkerSvg.prototype.applyColour_=function(a){module$exports$Blockly$zelos$MarkerSvg.MarkerSvg.superClass_.applyColour_.call(this,a),this.markerCircle_.setAttribute("fill",this.colour_),this.markerCircle_.setAttribute("stroke",this.colour_),this.isCursor()&&this.markerCircle_.firstChild.setAttribute("values",this.colour_+";transparent;transparent;")};var module$exports$Blockly$zelos$ConstantProvider={ConstantProvider:function(){module$exports$Blockly$zelos$ConstantProvider.ConstantProvider.superClass_.constructor.call(this),this.SMALL_PADDING=this.GRID_UNIT=4,this.MEDIUM_PADDING=2*this.GRID_UNIT,this.MEDIUM_LARGE_PADDING=3*this.GRID_UNIT,this.LARGE_PADDING=4*this.GRID_UNIT,this.CORNER_RADIUS=1*this.GRID_UNIT,this.NOTCH_WIDTH=9*this.GRID_UNIT,this.NOTCH_HEIGHT=2*this.GRID_UNIT,this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT=3*this.GRID_UNIT,this.MIN_BLOCK_WIDTH=2*this.GRID_UNIT,this.MIN_BLOCK_HEIGHT=12*this.GRID_UNIT,this.EMPTY_STATEMENT_INPUT_HEIGHT=6*this.GRID_UNIT,this.TAB_OFFSET_FROM_TOP=0,this.TOP_ROW_MIN_HEIGHT=this.CORNER_RADIUS,this.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.BOTTOM_ROW_MIN_HEIGHT=this.CORNER_RADIUS,this.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT=6*this.GRID_UNIT,this.STATEMENT_BOTTOM_SPACER=-this.NOTCH_HEIGHT,this.STATEMENT_INPUT_SPACER_MIN_WIDTH=40*this.GRID_UNIT,this.STATEMENT_INPUT_PADDING_LEFT=4*this.GRID_UNIT,this.EMPTY_INLINE_INPUT_PADDING=4*this.GRID_UNIT,this.EMPTY_INLINE_INPUT_HEIGHT=8*this.GRID_UNIT,this.DUMMY_INPUT_MIN_HEIGHT=8*this.GRID_UNIT,this.DUMMY_INPUT_SHADOW_MIN_HEIGHT=6*this.GRID_UNIT,this.CURSOR_WS_WIDTH=20*this.GRID_UNIT,this.CURSOR_COLOUR="#ffa200",this.CURSOR_RADIUS=5,this.JAGGED_TEETH_WIDTH=this.JAGGED_TEETH_HEIGHT=0,this.START_HAT_HEIGHT=22,this.START_HAT_WIDTH=96,this.SHAPES={HEXAGONAL:1,ROUND:2,SQUARE:3,PUZZLE:4,NOTCH:5},this.SHAPE_IN_SHAPE_PADDING={1:{0:5*this.GRID_UNIT,1:2*this.GRID_UNIT,2:5*this.GRID_UNIT,3:5*this.GRID_UNIT},2:{0:3*this.GRID_UNIT,1:3*this.GRID_UNIT,2:1*this.GRID_UNIT,3:2*this.GRID_UNIT},3:{0:2*this.GRID_UNIT,1:2*this.GRID_UNIT,2:2*this.GRID_UNIT,3:2*this.GRID_UNIT}},this.FULL_BLOCK_FIELDS=!0,this.FIELD_TEXT_FONTSIZE=3*this.GRID_UNIT,this.FIELD_TEXT_FONTWEIGHT="bold",this.FIELD_TEXT_FONTFAMILY='"Helvetica Neue", "Segoe UI", Helvetica, sans-serif',this.FIELD_BORDER_RECT_RADIUS=this.CORNER_RADIUS,this.FIELD_BORDER_RECT_X_PADDING=2*this.GRID_UNIT,this.FIELD_BORDER_RECT_Y_PADDING=1.625*this.GRID_UNIT,this.FIELD_BORDER_RECT_HEIGHT=8*this.GRID_UNIT,this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=8*this.GRID_UNIT,this.FIELD_DROPDOWN_SVG_ARROW=this.FIELD_DROPDOWN_COLOURED_DIV=this.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW=!0,this.FIELD_DROPDOWN_SVG_ARROW_PADDING=this.FIELD_BORDER_RECT_X_PADDING,this.FIELD_COLOUR_FULL_BLOCK=this.FIELD_TEXTINPUT_BOX_SHADOW=!0,this.FIELD_COLOUR_DEFAULT_WIDTH=2*this.GRID_UNIT,this.FIELD_COLOUR_DEFAULT_HEIGHT=4*this.GRID_UNIT,this.FIELD_CHECKBOX_X_OFFSET=1*this.GRID_UNIT,this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH=12*this.GRID_UNIT,this.SELECTED_GLOW_COLOUR="#fff200",this.SELECTED_GLOW_SIZE=.5,this.REPLACEMENT_GLOW_COLOUR="#fff200",this.REPLACEMENT_GLOW_SIZE=2,this.selectedGlowFilterId="",this.selectedGlowFilter_=null,this.replacementGlowFilterId="",this.replacementGlowFilter_=null}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$zelos$ConstantProvider.ConstantProvider,module$exports$Blockly$blockRendering$ConstantProvider.ConstantProvider),module$exports$Blockly$zelos$ConstantProvider.ConstantProvider.prototype.setFontConstants_=function(a){module$exports$Blockly$zelos$ConstantProvider.ConstantProvider.superClass_.setFontConstants_.call(this,a),this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT=this.FIELD_TEXT_HEIGHT+2*this.FIELD_BORDER_RECT_Y_PADDING},module$exports$Blockly$zelos$ConstantProvider.ConstantProvider.prototype.init=function(){module$exports$Blockly$zelos$ConstantProvider.ConstantProvider.superClass_.init.call(this),this.HEXAGONAL=this.makeHexagonal(),this.ROUNDED=this.makeRounded(),this.SQUARED=this.makeSquared(),this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT+this.INSIDE_CORNERS.rightWidth},module$exports$Blockly$zelos$ConstantProvider.ConstantProvider.prototype.setDynamicProperties_=function(a){module$exports$Blockly$zelos$ConstantProvider.ConstantProvider.superClass_.setDynamicProperties_.call(this,a),this.SELECTED_GLOW_COLOUR=a.getComponentStyle("selectedGlowColour")||this.SELECTED_GLOW_COLOUR;var b=Number(a.getComponentStyle("selectedGlowSize"));this.SELECTED_GLOW_SIZE=b&&!isNaN(b)?b:this.SELECTED_GLOW_SIZE,this.REPLACEMENT_GLOW_COLOUR=a.getComponentStyle("replacementGlowColour")||this.REPLACEMENT_GLOW_COLOUR,this.REPLACEMENT_GLOW_SIZE=(a=Number(a.getComponentStyle("replacementGlowSize")))&&!isNaN(a)?a:this.REPLACEMENT_GLOW_SIZE},module$exports$Blockly$zelos$ConstantProvider.ConstantProvider.prototype.dispose=function(){module$exports$Blockly$zelos$ConstantProvider.ConstantProvider.superClass_.dispose.call(this),this.selectedGlowFilter_&&(0,module$exports$Blockly$utils$dom.removeNode)(this.selectedGlowFilter_),this.replacementGlowFilter_&&(0,module$exports$Blockly$utils$dom.removeNode)(this.replacementGlowFilter_)},module$exports$Blockly$zelos$ConstantProvider.ConstantProvider.prototype.makeStartHat=function(){var a=this.START_HAT_HEIGHT,b=this.START_HAT_WIDTH;return{height:a,width:b,path:(0,module$exports$Blockly$utils$svgPaths.curve)("c",[(0,module$exports$Blockly$utils$svgPaths.point)(25,-a),(0,module$exports$Blockly$utils$svgPaths.point)(71,-a),(0,module$exports$Blockly$utils$svgPaths.point)(b,0)])}},module$exports$Blockly$zelos$ConstantProvider.ConstantProvider.prototype.makeHexagonal=function(){function a(c,d,e){var f=c/2;return(0,module$exports$Blockly$utils$svgPaths.lineTo)(-(e=e?-1:1)*(f=f>b?b:f),c=(d?-1:1)*c/2)+(0,module$exports$Blockly$utils$svgPaths.lineTo)(e*f,c)}var b=this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH;return{type:this.SHAPES.HEXAGONAL,isDynamic:!0,width:function(c){return(c/=2)>b?b:c},height:function(c){return c},connectionOffsetY:function(c){return c/2},connectionOffsetX:function(c){return-c},pathDown:function(c){return a(c,!1,!1)},pathUp:function(c){return a(c,!0,!1)},pathRightDown:function(c){return a(c,!1,!0)},pathRightUp:function(c){return a(c,!1,!0)}}},module$exports$Blockly$zelos$ConstantProvider.ConstantProvider.prototype.makeRounded=function(){function a(d,e,f){var g=d>c?d-c:0;return(0,module$exports$Blockly$utils$svgPaths.arc)("a","0 0,1",d=(d>c?c:d)/2,(0,module$exports$Blockly$utils$svgPaths.point)((e?-1:1)*d,(e?-1:1)*d))+(0,module$exports$Blockly$utils$svgPaths.lineOnAxis)("v",(f?1:-1)*g)+(0,module$exports$Blockly$utils$svgPaths.arc)("a","0 0,1",d,(0,module$exports$Blockly$utils$svgPaths.point)((e?1:-1)*d,(e?-1:1)*d))}var b=this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH,c=2*b;return{type:this.SHAPES.ROUND,isDynamic:!0,width:function(d){return(d/=2)>b?b:d},height:function(d){return d},connectionOffsetY:function(d){return d/2},connectionOffsetX:function(d){return-d},pathDown:function(d){return a(d,!1,!1)},pathUp:function(d){return a(d,!0,!1)},pathRightDown:function(d){return a(d,!1,!0)},pathRightUp:function(d){return a(d,!1,!0)}}},module$exports$Blockly$zelos$ConstantProvider.ConstantProvider.prototype.makeSquared=function(){function a(c,d,e){return c-=2*b,(0,module$exports$Blockly$utils$svgPaths.arc)("a","0 0,1",b,(0,module$exports$Blockly$utils$svgPaths.point)((d?-1:1)*b,(d?-1:1)*b))+(0,module$exports$Blockly$utils$svgPaths.lineOnAxis)("v",(e?1:-1)*c)+(0,module$exports$Blockly$utils$svgPaths.arc)("a","0 0,1",b,(0,module$exports$Blockly$utils$svgPaths.point)((d?1:-1)*b,(d?-1:1)*b))}var b=this.CORNER_RADIUS;return{type:this.SHAPES.SQUARE,isDynamic:!0,width:function(c){return b},height:function(c){return c},connectionOffsetY:function(c){return c/2},connectionOffsetX:function(c){return-c},pathDown:function(c){return a(c,!1,!1)},pathUp:function(c){return a(c,!0,!1)},pathRightDown:function(c){return a(c,!1,!0)},pathRightUp:function(c){return a(c,!1,!0)}}},module$exports$Blockly$zelos$ConstantProvider.ConstantProvider.prototype.shapeFor=function(a){var b=a.getCheck();switch(!b&&a.targetConnection&&(b=a.targetConnection.getCheck()),a.type){case $.module$exports$Blockly$ConnectionType.ConnectionType.INPUT_VALUE:case $.module$exports$Blockly$ConnectionType.ConnectionType.OUTPUT_VALUE:if(null!==(a=a.getSourceBlock().getOutputShape()))switch(a){case this.SHAPES.HEXAGONAL:return this.HEXAGONAL;case this.SHAPES.ROUND:return this.ROUNDED;case this.SHAPES.SQUARE:return this.SQUARED}return b&&-1!==b.indexOf("Boolean")?this.HEXAGONAL:(b&&-1!==b.indexOf("Number")||b&&b.indexOf("String"),this.ROUNDED);case $.module$exports$Blockly$ConnectionType.ConnectionType.PREVIOUS_STATEMENT:case $.module$exports$Blockly$ConnectionType.ConnectionType.NEXT_STATEMENT:return this.NOTCH;default:throw Error("Unknown type")}},module$exports$Blockly$zelos$ConstantProvider.ConstantProvider.prototype.makeNotch=function(){function a(l){return(0,module$exports$Blockly$utils$svgPaths.curve)("c",[(0,module$exports$Blockly$utils$svgPaths.point)(l*e/2,0),(0,module$exports$Blockly$utils$svgPaths.point)(l*e*3/4,g/2),(0,module$exports$Blockly$utils$svgPaths.point)(l*e,g)])+(0,module$exports$Blockly$utils$svgPaths.line)([(0,module$exports$Blockly$utils$svgPaths.point)(l*e,f)])+(0,module$exports$Blockly$utils$svgPaths.curve)("c",[(0,module$exports$Blockly$utils$svgPaths.point)(l*e/4,g/2),(0,module$exports$Blockly$utils$svgPaths.point)(l*e/2,g),(0,module$exports$Blockly$utils$svgPaths.point)(l*e,g)])+(0,module$exports$Blockly$utils$svgPaths.lineOnAxis)("h",l*d)+(0,module$exports$Blockly$utils$svgPaths.curve)("c",[(0,module$exports$Blockly$utils$svgPaths.point)(l*e/2,0),(0,module$exports$Blockly$utils$svgPaths.point)(l*e*3/4,-g/2),(0,module$exports$Blockly$utils$svgPaths.point)(l*e,-g)])+(0,module$exports$Blockly$utils$svgPaths.line)([(0,module$exports$Blockly$utils$svgPaths.point)(l*e,-f)])+(0,module$exports$Blockly$utils$svgPaths.curve)("c",[(0,module$exports$Blockly$utils$svgPaths.point)(l*e/4,-g/2),(0,module$exports$Blockly$utils$svgPaths.point)(l*e/2,-g),(0,module$exports$Blockly$utils$svgPaths.point)(l*e,-g)])}var b=this.NOTCH_WIDTH,c=this.NOTCH_HEIGHT,d=b/3,e=d/3,f=c/2,g=f/2,h=a(1),k=a(-1);return{type:this.SHAPES.NOTCH,width:b,height:c,pathLeft:h,pathRight:k}},module$exports$Blockly$zelos$ConstantProvider.ConstantProvider.prototype.makeInsideCorners=function(){var a=this.CORNER_RADIUS,b=(0,module$exports$Blockly$utils$svgPaths.arc)("a","0 0,0",a,(0,module$exports$Blockly$utils$svgPaths.point)(-a,a)),c=(0,module$exports$Blockly$utils$svgPaths.arc)("a","0 0,1",a,(0,module$exports$Blockly$utils$svgPaths.point)(-a,a));return{width:a,height:a,pathTop:b,pathBottom:(0,module$exports$Blockly$utils$svgPaths.arc)("a","0 0,0",a,(0,module$exports$Blockly$utils$svgPaths.point)(a,a)),rightWidth:a,rightHeight:a,pathTopRight:c,pathBottomRight:(0,module$exports$Blockly$utils$svgPaths.arc)("a","0 0,1",a,(0,module$exports$Blockly$utils$svgPaths.point)(a,a))}},module$exports$Blockly$zelos$ConstantProvider.ConstantProvider.prototype.generateSecondaryColour_=function(a){return(0,module$exports$Blockly$utils$colour.blend)("#000",a,.15)||a},module$exports$Blockly$zelos$ConstantProvider.ConstantProvider.prototype.generateTertiaryColour_=function(a){return(0,module$exports$Blockly$utils$colour.blend)("#000",a,.25)||a},module$exports$Blockly$zelos$ConstantProvider.ConstantProvider.prototype.createDom=function(a,b,c){module$exports$Blockly$zelos$ConstantProvider.ConstantProvider.superClass_.createDom.call(this,a,b,c),a=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.DEFS,{},a),b=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.FILTER,{id:"blocklySelectedGlowFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},a),(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.FEGAUSSIANBLUR,{in:"SourceGraphic",stdDeviation:this.SELECTED_GLOW_SIZE},b),c=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.FECOMPONENTTRANSFER,{result:"outBlur"},b),(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},c),(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.FEFLOOD,{"flood-color":this.SELECTED_GLOW_COLOUR,"flood-opacity":1,result:"outColor"},b),(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},b),this.selectedGlowFilterId=b.id,this.selectedGlowFilter_=b,a=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.FILTER,{id:"blocklyReplacementGlowFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},a),(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.FEGAUSSIANBLUR,{in:"SourceGraphic",stdDeviation:this.REPLACEMENT_GLOW_SIZE},a),b=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.FECOMPONENTTRANSFER,{result:"outBlur"},a),(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},b),(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.FEFLOOD,{"flood-color":this.REPLACEMENT_GLOW_COLOUR,"flood-opacity":1,result:"outColor"},a),(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},a),(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.FECOMPOSITE,{in:"SourceGraphic",in2:"outGlow",operator:"over"},a),this.replacementGlowFilterId=a.id,this.replacementGlowFilter_=a},module$exports$Blockly$zelos$ConstantProvider.ConstantProvider.prototype.getCSS_=function(a){return[a+" .blocklyText,",a+" .blocklyFlyoutLabelText {","font: "+this.FIELD_TEXT_FONTWEIGHT+" "+this.FIELD_TEXT_FONTSIZE+"pt "+this.FIELD_TEXT_FONTFAMILY+";","}",a+" .blocklyText {","fill: #fff;","}",a+" .blocklyNonEditableText>rect:not(.blocklyDropdownRect),",a+" .blocklyEditableText>rect:not(.blocklyDropdownRect) {","fill: "+this.FIELD_BORDER_RECT_COLOUR+";","}",a+" .blocklyNonEditableText>text,",a+" .blocklyEditableText>text,",a+" .blocklyNonEditableText>g>text,",a+" .blocklyEditableText>g>text {","fill: #575E75;","}",a+" .blocklyFlyoutLabelText {","fill: #575E75;","}",a+" .blocklyText.blocklyBubbleText {","fill: #575E75;","}",a+" .blocklyDraggable:not(.blocklyDisabled)"," .blocklyEditableText:not(.editing):hover>rect,",a+" .blocklyDraggable:not(.blocklyDisabled)"," .blocklyEditableText:not(.editing):hover>.blocklyPath {","stroke: #fff;","stroke-width: 2;","}",a+" .blocklyHtmlInput {","font-family: "+this.FIELD_TEXT_FONTFAMILY+";","font-weight: "+this.FIELD_TEXT_FONTWEIGHT+";","color: #575E75;","}",a+" .blocklyDropdownText {","fill: #fff !important;","}",a+".blocklyWidgetDiv .goog-menuitem,",a+".blocklyDropDownDiv .goog-menuitem {","font-family: "+this.FIELD_TEXT_FONTFAMILY+";","}",a+".blocklyDropDownDiv .goog-menuitem-content {","color: #fff;","}",a+" .blocklyHighlightedConnectionPath {","stroke: "+this.SELECTED_GLOW_COLOUR+";","}",a+" .blocklyDisabled > .blocklyOutlinePath {","fill: url(#blocklyDisabledPattern"+this.randomIdentifier+")","}",a+" .blocklyInsertionMarker>.blocklyPath {","fill-opacity: "+this.INSERTION_MARKER_OPACITY+";","stroke: none;","}"]};var module$exports$Blockly$zelos$Drawer={Drawer:function(a,b){module$exports$Blockly$zelos$Drawer.Drawer.superClass_.constructor.call(this,a,b)}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$zelos$Drawer.Drawer,module$exports$Blockly$blockRendering$Drawer.Drawer),module$exports$Blockly$zelos$Drawer.Drawer.prototype.draw=function(){var a=this.block_.pathObject;a.beginDrawing(),this.hideHiddenIcons_(),this.drawOutline_(),this.drawInternals_(),a.setPath(this.outlinePath_+"\n"+this.inlinePath_),this.info_.RTL&&a.flipRTL(),(0,module$exports$Blockly$blockRendering$debug.isDebuggerEnabled)()&&this.block_.renderingDebugger.drawDebug(this.block_,this.info_),this.recordSizeOnBlock_(),this.info_.outputConnection&&(a.outputShapeType=this.info_.outputConnection.shape.type),a.endDrawing()},module$exports$Blockly$zelos$Drawer.Drawer.prototype.drawOutline_=function(){this.info_.outputConnection&&this.info_.outputConnection.isDynamicShape&&!this.info_.hasStatementInput&&!this.info_.bottomRow.hasNextConnection?(this.drawFlatTop_(),this.drawRightDynamicConnection_(),this.drawFlatBottom_(),this.drawLeftDynamicConnection_()):module$exports$Blockly$zelos$Drawer.Drawer.superClass_.drawOutline_.call(this)},module$exports$Blockly$zelos$Drawer.Drawer.prototype.drawLeft_=function(){this.info_.outputConnection&&this.info_.outputConnection.isDynamicShape?this.drawLeftDynamicConnection_():module$exports$Blockly$zelos$Drawer.Drawer.superClass_.drawLeft_.call(this)},module$exports$Blockly$zelos$Drawer.Drawer.prototype.drawRightSideRow_=function(a){if(!(0>=a.height))if(a.precedesStatement||a.followsStatement){var b=this.constants_.INSIDE_CORNERS.rightHeight;b=a.height-(a.precedesStatement?b:0),this.outlinePath_+=(a.followsStatement?this.constants_.INSIDE_CORNERS.pathBottomRight:"")+(0<b?(0,module$exports$Blockly$utils$svgPaths.lineOnAxis)("V",a.yPos+b):"")+(a.precedesStatement?this.constants_.INSIDE_CORNERS.pathTopRight:"")}else this.outlinePath_+=(0,module$exports$Blockly$utils$svgPaths.lineOnAxis)("V",a.yPos+a.height)},module$exports$Blockly$zelos$Drawer.Drawer.prototype.drawRightDynamicConnection_=function(){this.outlinePath_+=this.info_.outputConnection.shape.pathRightDown(this.info_.outputConnection.height)},module$exports$Blockly$zelos$Drawer.Drawer.prototype.drawLeftDynamicConnection_=function(){this.positionOutputConnection_(),this.outlinePath_+=this.info_.outputConnection.shape.pathUp(this.info_.outputConnection.height),this.outlinePath_+="z"},module$exports$Blockly$zelos$Drawer.Drawer.prototype.drawFlatTop_=function(){var a=this.info_.topRow;this.positionPreviousConnection_(),this.outlinePath_+=(0,module$exports$Blockly$utils$svgPaths.moveBy)(a.xPos,this.info_.startY),this.outlinePath_+=(0,module$exports$Blockly$utils$svgPaths.lineOnAxis)("h",a.width)},module$exports$Blockly$zelos$Drawer.Drawer.prototype.drawFlatBottom_=function(){var a=this.info_.bottomRow;this.positionNextConnection_(),this.outlinePath_+=(0,module$exports$Blockly$utils$svgPaths.lineOnAxis)("V",a.baseline),this.outlinePath_+=(0,module$exports$Blockly$utils$svgPaths.lineOnAxis)("h",-a.width)},module$exports$Blockly$zelos$Drawer.Drawer.prototype.drawInlineInput_=function(a){this.positionInlineInputConnection_(a);var b=a.input.name;if(!a.connectedBlock&&!this.info_.isInsertionMarker){var c=a.width-2*a.connectionWidth;a=(0,module$exports$Blockly$utils$svgPaths.moveTo)(a.xPos+a.connectionWidth,a.centerline-a.height/2)+(0,module$exports$Blockly$utils$svgPaths.lineOnAxis)("h",c)+a.shape.pathRightDown(a.height)+(0,module$exports$Blockly$utils$svgPaths.lineOnAxis)("h",-c)+a.shape.pathUp(a.height)+"z",this.block_.pathObject.setOutlinePath(b,a)}},module$exports$Blockly$zelos$Drawer.Drawer.prototype.drawStatementInput_=function(a){var b=a.getLastInput(),c=b.xPos+b.notchOffset+b.shape.width,d=b.shape.pathRight+(0,module$exports$Blockly$utils$svgPaths.lineOnAxis)("h",-(b.notchOffset-this.constants_.INSIDE_CORNERS.width))+this.constants_.INSIDE_CORNERS.pathTop,e=a.height-2*this.constants_.INSIDE_CORNERS.height;b=this.constants_.INSIDE_CORNERS.pathBottom+(0,module$exports$Blockly$utils$svgPaths.lineOnAxis)("h",b.notchOffset-this.constants_.INSIDE_CORNERS.width)+(b.connectedBottomNextConnection?"":b.shape.pathLeft),this.outlinePath_+=(0,module$exports$Blockly$utils$svgPaths.lineOnAxis)("H",c)+d+(0,module$exports$Blockly$utils$svgPaths.lineOnAxis)("v",e)+b+(0,module$exports$Blockly$utils$svgPaths.lineOnAxis)("H",a.xPos+a.width),this.positionStatementInputConnection_(a)};var module$exports$Blockly$zelos$PathObject={PathObject:function(a,b,c){module$exports$Blockly$zelos$PathObject.PathObject.superClass_.constructor.call(this,a,b,c),this.constants=c,this.svgPathSelected_=null,this.outlines_=Object.create(null),this.outputShapeType=this.remainingOutlines_=null}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$zelos$PathObject.PathObject,module$exports$Blockly$blockRendering$PathObject.PathObject),module$exports$Blockly$zelos$PathObject.PathObject.prototype.setPath=function(a){module$exports$Blockly$zelos$PathObject.PathObject.superClass_.setPath.call(this,a),this.svgPathSelected_&&this.svgPathSelected_.setAttribute("d",a)},module$exports$Blockly$zelos$PathObject.PathObject.prototype.applyColour=function(a){for(var b in module$exports$Blockly$zelos$PathObject.PathObject.superClass_.applyColour.call(this,a),a.isShadow()&&a.getParent()&&this.svgPath.setAttribute("stroke",a.getParent().style.colourTertiary),this.outlines_)this.outlines_[b].setAttribute("fill",this.style.colourTertiary)},module$exports$Blockly$zelos$PathObject.PathObject.prototype.flipRTL=function(){for(var a in module$exports$Blockly$zelos$PathObject.PathObject.superClass_.flipRTL.call(this),this.outlines_)this.outlines_[a].setAttribute("transform","scale(-1 1)")},module$exports$Blockly$zelos$PathObject.PathObject.prototype.updateSelected=function(a){this.setClass_("blocklySelected",a),a?this.svgPathSelected_||(this.svgPathSelected_=this.svgPath.cloneNode(!0),this.svgPathSelected_.setAttribute("fill","none"),this.svgPathSelected_.setAttribute("filter","url(#"+this.constants.selectedGlowFilterId+")"),this.svgRoot.appendChild(this.svgPathSelected_)):this.svgPathSelected_&&(this.svgRoot.removeChild(this.svgPathSelected_),this.svgPathSelected_=null)},module$exports$Blockly$zelos$PathObject.PathObject.prototype.updateReplacementFade=function(a){this.setClass_("blocklyReplaceable",a),a?this.svgPath.setAttribute("filter","url(#"+this.constants.replacementGlowFilterId+")"):this.svgPath.removeAttribute("filter")},module$exports$Blockly$zelos$PathObject.PathObject.prototype.updateShapeForInputHighlight=function(a,b){a=a.getParentInput().name,(a=this.getOutlinePath_(a))&&(b?a.setAttribute("filter","url(#"+this.constants.replacementGlowFilterId+")"):a.removeAttribute("filter"))},module$exports$Blockly$zelos$PathObject.PathObject.prototype.beginDrawing=function(){for(var a in this.remainingOutlines_=Object.create(null),this.outlines_)this.remainingOutlines_[a]=1},module$exports$Blockly$zelos$PathObject.PathObject.prototype.endDrawing=function(){if(this.remainingOutlines_)for(var a in this.remainingOutlines_)this.removeOutlinePath_(a);this.remainingOutlines_=null},module$exports$Blockly$zelos$PathObject.PathObject.prototype.setOutlinePath=function(a,b){(a=this.getOutlinePath_(a)).setAttribute("d",b),a.setAttribute("fill",this.style.colourTertiary)},module$exports$Blockly$zelos$PathObject.PathObject.prototype.getOutlinePath_=function(a){return this.outlines_[a]||(this.outlines_[a]=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.PATH,{class:"blocklyOutlinePath",d:""},this.svgRoot)),this.remainingOutlines_&&delete this.remainingOutlines_[a],this.outlines_[a]},module$exports$Blockly$zelos$PathObject.PathObject.prototype.removeOutlinePath_=function(a){this.outlines_[a].parentNode.removeChild(this.outlines_[a]),delete this.outlines_[a]};var module$exports$Blockly$zelos$BottomRow={BottomRow:function(a){module$exports$Blockly$zelos$BottomRow.BottomRow.superClass_.constructor.call(this,a)}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$zelos$BottomRow.BottomRow,module$exports$Blockly$blockRendering$BottomRow.BottomRow),module$exports$Blockly$zelos$BottomRow.BottomRow.prototype.endsWithElemSpacer=function(){return!1},module$exports$Blockly$zelos$BottomRow.BottomRow.prototype.hasLeftSquareCorner=function(a){return!!a.outputConnection},module$exports$Blockly$zelos$BottomRow.BottomRow.prototype.hasRightSquareCorner=function(a){return!!a.outputConnection&&!a.statementInputCount&&!a.nextConnection},$.module$exports$Blockly$FieldImage={FieldImage:function(a,b,c,d,e,f,g){if(!a)throw Error("Src value of an image field is required");if(a=(0,module$exports$Blockly$utils$parsing.replaceMessageReferences)(a),c=Number((0,module$exports$Blockly$utils$parsing.replaceMessageReferences)(c)),b=Number((0,module$exports$Blockly$utils$parsing.replaceMessageReferences)(b)),isNaN(c)||isNaN(b))throw Error("Height and width values of an image field must cast to numbers.");if(0>=c||0>=b)throw Error("Height and width values of an image field must be greater than 0.");this.flipRtl_=!1,this.altText_="",$.module$exports$Blockly$FieldImage.FieldImage.superClass_.constructor.call(this,a,null,g),g||(this.flipRtl_=!!f,this.altText_=(0,module$exports$Blockly$utils$parsing.replaceMessageReferences)(d)||""),this.size_=new module$exports$Blockly$utils$Size.Size(b,c+$.module$exports$Blockly$FieldImage.FieldImage.Y_PADDING),this.imageHeight_=c,this.clickHandler_=null,"function"==typeof e&&(this.clickHandler_=e),this.imageElement_=null}},(0,$.module$exports$Blockly$utils$object.inherits)($.module$exports$Blockly$FieldImage.FieldImage,module$exports$Blockly$Field.Field),$.module$exports$Blockly$FieldImage.FieldImage.prototype.DEFAULT_VALUE="",$.module$exports$Blockly$FieldImage.FieldImage.fromJson=function(a){return new this(a.src,a.width,a.height,void 0,void 0,void 0,a)},$.module$exports$Blockly$FieldImage.FieldImage.Y_PADDING=1,$.module$exports$Blockly$FieldImage.FieldImage.prototype.EDITABLE=!1,$.module$exports$Blockly$FieldImage.FieldImage.prototype.isDirty_=!1,$.module$exports$Blockly$FieldImage.FieldImage.prototype.configure_=function(a){$.module$exports$Blockly$FieldImage.FieldImage.superClass_.configure_.call(this,a),this.flipRtl_=!!a.flipRtl,this.altText_=(0,module$exports$Blockly$utils$parsing.replaceMessageReferences)(a.alt)||""},$.module$exports$Blockly$FieldImage.FieldImage.prototype.initView=function(){this.imageElement_=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.IMAGE,{height:this.imageHeight_+"px",width:this.size_.width+"px",alt:this.altText_},this.fieldGroup_),this.imageElement_.setAttributeNS(module$exports$Blockly$utils$dom.XLINK_NS,"xlink:href",this.value_),this.clickHandler_&&(this.imageElement_.style.cursor="pointer")},$.module$exports$Blockly$FieldImage.FieldImage.prototype.updateSize_=function(){},$.module$exports$Blockly$FieldImage.FieldImage.prototype.doClassValidation_=function(a){return"string"!=typeof a?null:a},$.module$exports$Blockly$FieldImage.FieldImage.prototype.doValueUpdate_=function(a){this.value_=a,this.imageElement_&&this.imageElement_.setAttributeNS(module$exports$Blockly$utils$dom.XLINK_NS,"xlink:href",String(this.value_))},$.module$exports$Blockly$FieldImage.FieldImage.prototype.getFlipRtl=function(){return this.flipRtl_},$.module$exports$Blockly$FieldImage.FieldImage.prototype.setAlt=function(a){a!==this.altText_&&(this.altText_=a||"",this.imageElement_&&this.imageElement_.setAttribute("alt",this.altText_))},$.module$exports$Blockly$FieldImage.FieldImage.prototype.showEditor_=function(){this.clickHandler_&&this.clickHandler_(this)},$.module$exports$Blockly$FieldImage.FieldImage.prototype.setOnClickHandler=function(a){this.clickHandler_=a},$.module$exports$Blockly$FieldImage.FieldImage.prototype.getText_=function(){return this.altText_},(0,module$exports$Blockly$fieldRegistry.register)("field_image",$.module$exports$Blockly$FieldImage.FieldImage);var module$exports$Blockly$zelos$RenderInfo={RenderInfo:function(a,b){module$exports$Blockly$zelos$RenderInfo.RenderInfo.superClass_.constructor.call(this,a,b),this.topRow=new module$exports$Blockly$zelos$TopRow.TopRow(this.constants_),this.bottomRow=new module$exports$Blockly$zelos$BottomRow.BottomRow(this.constants_),this.isInline=!0,this.isMultiRow=!b.getInputsInline()||b.isCollapsed(),this.hasStatementInput=0<b.statementInputCount,this.rightSide=this.outputConnection?new module$exports$Blockly$zelos$RightConnectionShape.RightConnectionShape(this.constants_):null}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$zelos$RenderInfo.RenderInfo,module$exports$Blockly$blockRendering$RenderInfo.RenderInfo),module$exports$Blockly$zelos$RenderInfo.RenderInfo.prototype.getRenderer=function(){return this.renderer_},module$exports$Blockly$zelos$RenderInfo.RenderInfo.prototype.measure=function(){this.createRows_(),this.addElemSpacing_(),this.addRowSpacing_(),this.adjustXPosition_(),this.computeBounds_(),this.alignRowElements_(),this.finalize_()},module$exports$Blockly$zelos$RenderInfo.RenderInfo.prototype.shouldStartNewRow_=function(a,b){return!!b&&(a.type===$.module$exports$Blockly$inputTypes.inputTypes.STATEMENT||b.type===$.module$exports$Blockly$inputTypes.inputTypes.STATEMENT||(a.type===$.module$exports$Blockly$inputTypes.inputTypes.VALUE||a.type===$.module$exports$Blockly$inputTypes.inputTypes.DUMMY)&&(!this.isInline||this.isMultiRow))},module$exports$Blockly$zelos$RenderInfo.RenderInfo.prototype.getDesiredRowWidth_=function(a){return a.hasStatement?this.width-this.startX-(this.constants_.INSIDE_CORNERS.rightWidth||0):module$exports$Blockly$zelos$RenderInfo.RenderInfo.superClass_.getDesiredRowWidth_.call(this,a)},module$exports$Blockly$zelos$RenderInfo.RenderInfo.prototype.getInRowSpacing_=function(a,b){return a&&b||!this.outputConnection||!this.outputConnection.isDynamicShape||this.hasStatementInput||this.bottomRow.hasNextConnection?!a&&b&&module$exports$Blockly$blockRendering$Types.Types.isStatementInput(b)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:a&&module$exports$Blockly$blockRendering$Types.Types.isLeftRoundedCorner(a)&&b&&(module$exports$Blockly$blockRendering$Types.Types.isPreviousConnection(b)||module$exports$Blockly$blockRendering$Types.Types.isNextConnection(b))?b.notchOffset-this.constants_.CORNER_RADIUS:a&&module$exports$Blockly$blockRendering$Types.Types.isLeftSquareCorner(a)&&b&&module$exports$Blockly$blockRendering$Types.Types.isHat(b)?this.constants_.NO_PADDING:this.constants_.MEDIUM_PADDING:this.constants_.NO_PADDING},module$exports$Blockly$zelos$RenderInfo.RenderInfo.prototype.getSpacerRowHeight_=function(a,b){if(module$exports$Blockly$blockRendering$Types.Types.isTopRow(a)&&module$exports$Blockly$blockRendering$Types.Types.isBottomRow(b))return this.constants_.EMPTY_BLOCK_SPACER_HEIGHT;var c=module$exports$Blockly$blockRendering$Types.Types.isInputRow(a)&&a.hasStatement,d=module$exports$Blockly$blockRendering$Types.Types.isInputRow(b)&&b.hasStatement;return d||c?(a=Math.max(this.constants_.NOTCH_HEIGHT,this.constants_.INSIDE_CORNERS.rightHeight||0),d&&c?Math.max(a,this.constants_.DUMMY_INPUT_MIN_HEIGHT):a):module$exports$Blockly$blockRendering$Types.Types.isTopRow(a)?a.hasPreviousConnection||this.outputConnection&&!this.hasStatementInput?this.constants_.NO_PADDING:Math.abs(this.constants_.NOTCH_HEIGHT-this.constants_.CORNER_RADIUS):module$exports$Blockly$blockRendering$Types.Types.isBottomRow(b)?this.outputConnection?!b.hasNextConnection&&this.hasStatementInput?Math.abs(this.constants_.NOTCH_HEIGHT-this.constants_.CORNER_RADIUS):this.constants_.NO_PADDING:Math.max(this.topRow.minHeight,Math.max(this.constants_.NOTCH_HEIGHT,this.constants_.CORNER_RADIUS))-this.constants_.CORNER_RADIUS:this.constants_.MEDIUM_PADDING},module$exports$Blockly$zelos$RenderInfo.RenderInfo.prototype.getSpacerRowWidth_=function(a,b){var c=this.width-this.startX;return module$exports$Blockly$blockRendering$Types.Types.isInputRow(a)&&a.hasStatement||module$exports$Blockly$blockRendering$Types.Types.isInputRow(b)&&b.hasStatement?Math.max(c,this.constants_.STATEMENT_INPUT_SPACER_MIN_WIDTH):c},module$exports$Blockly$zelos$RenderInfo.RenderInfo.prototype.getElemCenterline_=function(a,b){if(a.hasStatement&&!module$exports$Blockly$blockRendering$Types.Types.isSpacer(b)&&!module$exports$Blockly$blockRendering$Types.Types.isStatementInput(b))return a.yPos+this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT/2;if(module$exports$Blockly$blockRendering$Types.Types.isInlineInput(b)){var c=b.connectedBlock;if(c&&c.outputConnection&&c.nextConnection)return a.yPos+c.height/2}return module$exports$Blockly$zelos$RenderInfo.RenderInfo.superClass_.getElemCenterline_.call(this,a,b)},module$exports$Blockly$zelos$RenderInfo.RenderInfo.prototype.addInput_=function(a,b){if(a.type===$.module$exports$Blockly$inputTypes.inputTypes.DUMMY&&b.hasDummyInput&&b.align===$.module$exports$Blockly$Input.Align.LEFT&&a.align===$.module$exports$Blockly$Input.Align.RIGHT)b.rightAlignedDummyInput=a;else if(a.type===$.module$exports$Blockly$inputTypes.inputTypes.STATEMENT)return b.elements.push(new module$exports$Blockly$zelos$StatementInput.StatementInput(this.constants_,a)),b.hasStatement=!0,void(null===b.align&&(b.align=a.align));module$exports$Blockly$zelos$RenderInfo.RenderInfo.superClass_.addInput_.call(this,a,b)},module$exports$Blockly$zelos$RenderInfo.RenderInfo.prototype.addAlignmentPadding_=function(a,b){if(a.rightAlignedDummyInput){for(var c,d=0;d<a.elements.length;d++){var e=a.elements[d];if(module$exports$Blockly$blockRendering$Types.Types.isSpacer(e)&&(c=e),module$exports$Blockly$blockRendering$Types.Types.isField(e)&&e.parentInput===a.rightAlignedDummyInput)break}if(c)return c.width+=b,void(a.width+=b)}module$exports$Blockly$zelos$RenderInfo.RenderInfo.superClass_.addAlignmentPadding_.call(this,a,b)},module$exports$Blockly$zelos$RenderInfo.RenderInfo.prototype.adjustXPosition_=function(){for(var a=this.constants_.NOTCH_OFFSET_LEFT+this.constants_.NOTCH_WIDTH,b=a,c=2;c<this.rows.length-1;c+=2){var d=this.rows[c-1],e=this.rows[c],f=this.rows[c+1];if(d=2===c?!!this.topRow.hasPreviousConnection:!!d.followsStatement,f=c+2>=this.rows.length-1?!!this.bottomRow.hasNextConnection:!!f.precedesStatement,module$exports$Blockly$blockRendering$Types.Types.isInputRow(e)&&e.hasStatement)e.measure(),b=e.width-e.getLastInput().width+a;else if(d&&(2===c||f)&&module$exports$Blockly$blockRendering$Types.Types.isInputRow(e)&&!e.hasStatement){f=e.xPos,d=null;for(var g=0;g<e.elements.length;g++){var h=e.elements[g];module$exports$Blockly$blockRendering$Types.Types.isSpacer(h)&&(d=h),!(d&&(module$exports$Blockly$blockRendering$Types.Types.isField(h)||module$exports$Blockly$blockRendering$Types.Types.isInput(h))&&f<b)||module$exports$Blockly$blockRendering$Types.Types.isField(h)&&(h.field instanceof $.module$exports$Blockly$FieldLabel.FieldLabel||h.field instanceof $.module$exports$Blockly$FieldImage.FieldImage)||(d.width+=b-f),f+=h.width}}}},module$exports$Blockly$zelos$RenderInfo.RenderInfo.prototype.finalizeOutputConnection_=function(){if(this.outputConnection&&this.outputConnection.isDynamicShape){for(var a=0,b=0;b<this.rows.length;b++){var c=this.rows[b];c.yPos=a,a+=c.height}this.height=a,b=this.bottomRow.hasNextConnection?this.height-this.bottomRow.descenderHeight:this.height,a=this.outputConnection.shape.height(b),b=this.outputConnection.shape.width(b),this.outputConnection.height=a,this.outputConnection.width=b,this.outputConnection.startX=b,this.outputConnection.connectionOffsetY=this.outputConnection.shape.connectionOffsetY(a),this.outputConnection.connectionOffsetX=this.outputConnection.shape.connectionOffsetX(b),c=0,this.hasStatementInput||this.bottomRow.hasNextConnection||(c=b,this.rightSide.height=a,this.rightSide.width=c,this.rightSide.centerline=a/2,this.rightSide.xPos=this.width+c),this.startX=b,this.width+=b+c,this.widthWithChildren+=b+c}},module$exports$Blockly$zelos$RenderInfo.RenderInfo.prototype.finalizeHorizontalAlignment_=function(){if(this.outputConnection&&!this.hasStatementInput&&!this.bottomRow.hasNextConnection){for(var a=0,b=0;b<this.rows.length;b++){var c=this.rows[b];if(module$exports$Blockly$blockRendering$Types.Types.isInputRow(c)){a=c.elements[c.elements.length-2];var d=this.getNegativeSpacing_(c.elements[1]),e=this.getNegativeSpacing_(a);a=d+e;var f=this.constants_.MIN_BLOCK_WIDTH+2*this.outputConnection.width;this.width-a<f&&(d=(a=this.width-f)/2,e=a/2),c.elements.unshift(new module$exports$Blockly$blockRendering$InRowSpacer.InRowSpacer(this.constants_,-d)),c.elements.push(new module$exports$Blockly$blockRendering$InRowSpacer.InRowSpacer(this.constants_,-e))}}if(a)for(this.width-=a,this.widthWithChildren-=a,this.rightSide.xPos-=a,b=0;b<this.rows.length;b++)c=this.rows[b],module$exports$Blockly$blockRendering$Types.Types.isTopOrBottomRow(c)&&(c.elements[1].width-=a,c.elements[1].widthWithConnectedBlocks-=a),c.width-=a,c.widthWithConnectedBlocks-=a}},module$exports$Blockly$zelos$RenderInfo.RenderInfo.prototype.getNegativeSpacing_=function(a){if(!a)return 0;var b=this.outputConnection.width,c=this.outputConnection.shape.type,d=this.constants_;if(this.isMultiRow&&1<this.inputRows.length)return c===d.SHAPES.ROUND?(c=this.constants_.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH,b-(c=this.height/2>c?c:this.height/2)*(1-Math.sin(Math.acos((c-this.constants_.SMALL_PADDING)/c)))):0;if(module$exports$Blockly$blockRendering$Types.Types.isInlineInput(a)){var e=a.connectedBlock;return a=e?e.pathObject.outputShapeType:a.shape.type,e&&e.outputConnection&&(e.statementInputCount||e.nextConnection)||c===d.SHAPES.HEXAGONAL&&c!==a?0:b-this.constants_.SHAPE_IN_SHAPE_PADDING[c][a]}return module$exports$Blockly$blockRendering$Types.Types.isField(a)?c===d.SHAPES.ROUND&&a.field instanceof $.module$exports$Blockly$FieldTextInput.FieldTextInput?b-2.75*d.GRID_UNIT:b-this.constants_.SHAPE_IN_SHAPE_PADDING[c][0]:module$exports$Blockly$blockRendering$Types.Types.isIcon(a)?this.constants_.SMALL_PADDING:0},module$exports$Blockly$zelos$RenderInfo.RenderInfo.prototype.finalizeVerticalAlignment_=function(){if(!this.outputConnection)for(var a=2;a<this.rows.length-1;a+=2){var b=this.rows[a-1],c=this.rows[a],d=this.rows[a+1],e=2===a,f=a+2>=this.rows.length-1?!!this.bottomRow.hasNextConnection:!!d.precedesStatement;if(e?this.topRow.hasPreviousConnection:b.followsStatement){var g=3===c.elements.length&&(c.elements[1].field instanceof $.module$exports$Blockly$FieldLabel.FieldLabel||c.elements[1].field instanceof $.module$exports$Blockly$FieldImage.FieldImage);if(!e&&g)b.height-=this.constants_.SMALL_PADDING,d.height-=this.constants_.SMALL_PADDING,c.height-=this.constants_.MEDIUM_PADDING;else if(e||f){if(f){for(e=!1,f=0;f<c.elements.length;f++)if(g=c.elements[f],module$exports$Blockly$blockRendering$Types.Types.isInlineInput(g)&&g.connectedBlock&&!g.connectedBlock.isShadow()&&40<=g.connectedBlock.getHeightWidth().height){e=!0;break}e&&(b.height-=this.constants_.SMALL_PADDING,d.height-=this.constants_.SMALL_PADDING)}}else b.height+=this.constants_.SMALL_PADDING}}},module$exports$Blockly$zelos$RenderInfo.RenderInfo.prototype.finalize_=function(){this.finalizeOutputConnection_(),this.finalizeHorizontalAlignment_(),this.finalizeVerticalAlignment_(),module$exports$Blockly$zelos$RenderInfo.RenderInfo.superClass_.finalize_.call(this),this.rightSide&&(this.widthWithChildren+=this.rightSide.width)};var module$exports$Blockly$zelos$Renderer={Renderer:function(a){module$exports$Blockly$zelos$Renderer.Renderer.superClass_.constructor.call(this,a)}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$zelos$Renderer.Renderer,module$exports$Blockly$blockRendering$Renderer.Renderer),module$exports$Blockly$zelos$Renderer.Renderer.prototype.makeConstants_=function(){return new module$exports$Blockly$zelos$ConstantProvider.ConstantProvider},module$exports$Blockly$zelos$Renderer.Renderer.prototype.makeRenderInfo_=function(a){return new module$exports$Blockly$zelos$RenderInfo.RenderInfo(this,a)},module$exports$Blockly$zelos$Renderer.Renderer.prototype.makeDrawer_=function(a,b){return new module$exports$Blockly$zelos$Drawer.Drawer(a,b)},module$exports$Blockly$zelos$Renderer.Renderer.prototype.makeMarkerDrawer=function(a,b){return new module$exports$Blockly$zelos$MarkerSvg.MarkerSvg(a,this.getConstants(),b)},module$exports$Blockly$zelos$Renderer.Renderer.prototype.makePathObject=function(a,b){return new module$exports$Blockly$zelos$PathObject.PathObject(a,b,this.getConstants())},module$exports$Blockly$zelos$Renderer.Renderer.prototype.shouldHighlightConnection=function(a){return a.type!==$.module$exports$Blockly$ConnectionType.ConnectionType.INPUT_VALUE&&a.type!==$.module$exports$Blockly$ConnectionType.ConnectionType.OUTPUT_VALUE},module$exports$Blockly$zelos$Renderer.Renderer.prototype.getConnectionPreviewMethod=function(a,b,c){return b.type===$.module$exports$Blockly$ConnectionType.ConnectionType.OUTPUT_VALUE?a.isConnected()?module$exports$Blockly$InsertionMarkerManager.InsertionMarkerManager.PREVIEW_TYPE.REPLACEMENT_FADE:module$exports$Blockly$InsertionMarkerManager.InsertionMarkerManager.PREVIEW_TYPE.INPUT_OUTLINE:module$exports$Blockly$zelos$Renderer.Renderer.superClass_.getConnectionPreviewMethod(a,b,c)},(0,module$exports$Blockly$blockRendering.register)("zelos",module$exports$Blockly$zelos$Renderer.Renderer);var module$exports$Blockly$zelos={};module$exports$Blockly$zelos.BottomRow=module$exports$Blockly$zelos$BottomRow.BottomRow,module$exports$Blockly$zelos.ConstantProvider=module$exports$Blockly$zelos$ConstantProvider.ConstantProvider,module$exports$Blockly$zelos.Drawer=module$exports$Blockly$zelos$Drawer.Drawer,module$exports$Blockly$zelos.MarkerSvg=module$exports$Blockly$zelos$MarkerSvg.MarkerSvg,module$exports$Blockly$zelos.PathObject=module$exports$Blockly$zelos$PathObject.PathObject,module$exports$Blockly$zelos.RenderInfo=module$exports$Blockly$zelos$RenderInfo.RenderInfo,module$exports$Blockly$zelos.Renderer=module$exports$Blockly$zelos$Renderer.Renderer,module$exports$Blockly$zelos.RightConnectionShape=module$exports$Blockly$zelos$RightConnectionShape.RightConnectionShape,module$exports$Blockly$zelos.StatementInput=module$exports$Blockly$zelos$StatementInput.StatementInput,module$exports$Blockly$zelos.TopRow=module$exports$Blockly$zelos$TopRow.TopRow;var module$exports$Blockly$thrasos$RenderInfo={RenderInfo:function(a,b){module$exports$Blockly$thrasos$RenderInfo.RenderInfo.superClass_.constructor.call(this,a,b)}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$thrasos$RenderInfo.RenderInfo,module$exports$Blockly$blockRendering$RenderInfo.RenderInfo),module$exports$Blockly$thrasos$RenderInfo.RenderInfo.prototype.getRenderer=function(){return this.renderer_},module$exports$Blockly$thrasos$RenderInfo.RenderInfo.prototype.addElemSpacing_=function(){for(var a=!1,b=0;b<this.rows.length;b++)if(this.rows[b].hasExternalInput){a=!0;break}for(b=0;b<this.rows.length;b++){var c=this.rows[b],d=c.elements;c.elements=[],c.startsWithElemSpacer()&&c.elements.push(new module$exports$Blockly$blockRendering$InRowSpacer.InRowSpacer(this.constants_,this.getInRowSpacing_(null,d[0])));for(var e=0;e<d.length-1;e++){c.elements.push(d[e]);var f=this.getInRowSpacing_(d[e],d[e+1]);c.elements.push(new module$exports$Blockly$blockRendering$InRowSpacer.InRowSpacer(this.constants_,f))}c.elements.push(d[d.length-1]),c.endsWithElemSpacer()&&(d=this.getInRowSpacing_(d[d.length-1],null),a&&c.hasDummyInput&&(d+=this.constants_.TAB_WIDTH),c.elements.push(new module$exports$Blockly$blockRendering$InRowSpacer.InRowSpacer(this.constants_,d)))}},module$exports$Blockly$thrasos$RenderInfo.RenderInfo.prototype.getInRowSpacing_=function(a,b){if(!a)return b&&module$exports$Blockly$blockRendering$Types.Types.isField(b)&&b.isEditable?this.constants_.MEDIUM_PADDING:b&&module$exports$Blockly$blockRendering$Types.Types.isInlineInput(b)?this.constants_.MEDIUM_LARGE_PADDING:b&&module$exports$Blockly$blockRendering$Types.Types.isStatementInput(b)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:this.constants_.LARGE_PADDING;if(!module$exports$Blockly$blockRendering$Types.Types.isInput(a)&&!b)return module$exports$Blockly$blockRendering$Types.Types.isField(a)&&a.isEditable?this.constants_.MEDIUM_PADDING:module$exports$Blockly$blockRendering$Types.Types.isIcon(a)?2*this.constants_.LARGE_PADDING+1:module$exports$Blockly$blockRendering$Types.Types.isHat(a)?this.constants_.NO_PADDING:module$exports$Blockly$blockRendering$Types.Types.isPreviousOrNextConnection(a)?this.constants_.LARGE_PADDING:module$exports$Blockly$blockRendering$Types.Types.isLeftRoundedCorner(a)?this.constants_.MIN_BLOCK_WIDTH:module$exports$Blockly$blockRendering$Types.Types.isJaggedEdge(a)?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING;if(module$exports$Blockly$blockRendering$Types.Types.isInput(a)&&!b){if(module$exports$Blockly$blockRendering$Types.Types.isExternalInput(a))return this.constants_.NO_PADDING;if(module$exports$Blockly$blockRendering$Types.Types.isInlineInput(a))return this.constants_.LARGE_PADDING;if(module$exports$Blockly$blockRendering$Types.Types.isStatementInput(a))return this.constants_.NO_PADDING}if(!module$exports$Blockly$blockRendering$Types.Types.isInput(a)&&b&&module$exports$Blockly$blockRendering$Types.Types.isInput(b)){if(module$exports$Blockly$blockRendering$Types.Types.isField(a)&&a.isEditable){if(module$exports$Blockly$blockRendering$Types.Types.isInlineInput(b)||module$exports$Blockly$blockRendering$Types.Types.isExternalInput(b))return this.constants_.SMALL_PADDING}else{if(module$exports$Blockly$blockRendering$Types.Types.isInlineInput(b)||module$exports$Blockly$blockRendering$Types.Types.isExternalInput(b))return this.constants_.MEDIUM_LARGE_PADDING;if(module$exports$Blockly$blockRendering$Types.Types.isStatementInput(b))return this.constants_.LARGE_PADDING}return this.constants_.LARGE_PADDING-1}if(module$exports$Blockly$blockRendering$Types.Types.isIcon(a)&&b&&!module$exports$Blockly$blockRendering$Types.Types.isInput(b))return this.constants_.LARGE_PADDING;if(module$exports$Blockly$blockRendering$Types.Types.isInlineInput(a)&&b&&module$exports$Blockly$blockRendering$Types.Types.isField(b))return b.isEditable?this.constants_.MEDIUM_PADDING:this.constants_.LARGE_PADDING;if(module$exports$Blockly$blockRendering$Types.Types.isLeftSquareCorner(a)&&b){if(module$exports$Blockly$blockRendering$Types.Types.isHat(b))return this.constants_.NO_PADDING;if(module$exports$Blockly$blockRendering$Types.Types.isPreviousConnection(b)||module$exports$Blockly$blockRendering$Types.Types.isNextConnection(b))return b.notchOffset}return module$exports$Blockly$blockRendering$Types.Types.isLeftRoundedCorner(a)&&b?b.notchOffset-this.constants_.CORNER_RADIUS:module$exports$Blockly$blockRendering$Types.Types.isField(a)&&b&&module$exports$Blockly$blockRendering$Types.Types.isField(b)&&a.isEditable===b.isEditable||b&&module$exports$Blockly$blockRendering$Types.Types.isJaggedEdge(b)?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING},module$exports$Blockly$thrasos$RenderInfo.RenderInfo.prototype.getSpacerRowHeight_=function(a,b){return module$exports$Blockly$blockRendering$Types.Types.isTopRow(a)&&module$exports$Blockly$blockRendering$Types.Types.isBottomRow(b)?this.constants_.EMPTY_BLOCK_SPACER_HEIGHT:module$exports$Blockly$blockRendering$Types.Types.isTopRow(a)||module$exports$Blockly$blockRendering$Types.Types.isBottomRow(b)?this.constants_.NO_PADDING:a.hasExternalInput&&b.hasExternalInput?this.constants_.LARGE_PADDING:!a.hasStatement&&b.hasStatement?this.constants_.BETWEEN_STATEMENT_PADDING_Y:a.hasStatement&&b.hasStatement||a.hasDummyInput||b.hasDummyInput?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING},module$exports$Blockly$thrasos$RenderInfo.RenderInfo.prototype.getElemCenterline_=function(a,b){if(module$exports$Blockly$blockRendering$Types.Types.isSpacer(b))return a.yPos+b.height/2;if(module$exports$Blockly$blockRendering$Types.Types.isBottomRow(a))return a=a.yPos+a.height-a.descenderHeight,module$exports$Blockly$blockRendering$Types.Types.isNextConnection(b)?a+b.height/2:a-b.height/2;if(module$exports$Blockly$blockRendering$Types.Types.isTopRow(a))return module$exports$Blockly$blockRendering$Types.Types.isHat(b)?a.capline-b.height/2:a.capline+b.height/2;var c=a.yPos;return module$exports$Blockly$blockRendering$Types.Types.isField(b)&&a.hasStatement?c+(this.constants_.TALL_INPUT_FIELD_OFFSET_Y+b.height/2):c+a.height/2},module$exports$Blockly$thrasos$RenderInfo.RenderInfo.prototype.finalize_=function(){for(var a=0,b=0,c=0;c<this.rows.length;c++){var d=this.rows[c];d.yPos=b,d.xPos=this.startX,b+=d.height,a=Math.max(a,d.widthWithConnectedBlocks);var e=b-this.topRow.ascenderHeight;d===this.bottomRow&&e<this.constants_.MIN_BLOCK_HEIGHT&&(e=this.constants_.MIN_BLOCK_HEIGHT-e,this.bottomRow.height+=e,b+=e),this.recordElemPositions_(d)}this.outputConnection&&this.block_.nextConnection&&this.block_.nextConnection.isConnected()&&(a=Math.max(a,this.block_.nextConnection.targetBlock().getHeightWidth().width)),this.bottomRow.baseline=b-this.bottomRow.descenderHeight,this.widthWithChildren=a+this.startX,this.height=b,this.startY=this.topRow.capline};var module$exports$Blockly$thrasos$Renderer={Renderer:function(a){module$exports$Blockly$thrasos$Renderer.Renderer.superClass_.constructor.call(this,a)}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$thrasos$Renderer.Renderer,module$exports$Blockly$blockRendering$Renderer.Renderer),module$exports$Blockly$thrasos$Renderer.Renderer.prototype.makeRenderInfo_=function(a){return new module$exports$Blockly$thrasos$RenderInfo.RenderInfo(this,a)},(0,module$exports$Blockly$blockRendering.register)("thrasos",module$exports$Blockly$thrasos$Renderer.Renderer);var module$exports$Blockly$thrasos={};module$exports$Blockly$thrasos.RenderInfo=module$exports$Blockly$thrasos$RenderInfo.RenderInfo,module$exports$Blockly$thrasos.Renderer=module$exports$Blockly$thrasos$Renderer.Renderer;var module$exports$Blockly$serialization$workspaces={save:function(a){var d,b=Object.create(null),c=(0,module$exports$Blockly$registry.getAllItems)(module$exports$Blockly$registry.Type.SERIALIZER,!0);for(d in c){var e=c[d].save(a);e&&(b[d]=e)}return b},load:function(a,b,c){var d=void 0!==(c=void 0===c?{}:c).recordUndo&&c.recordUndo;if(c=(0,module$exports$Blockly$registry.getAllItems)(module$exports$Blockly$registry.Type.SERIALIZER,!0)){var e=Object.entries(c).sort((function(h,k){return k[1].priority-h[1].priority}));c=(0,module$exports$Blockly$Events$utils.getRecordUndo)(),(0,module$exports$Blockly$Events$utils.setRecordUndo)(d),(d=(0,module$exports$Blockly$Events$utils.getGroup)())||(0,module$exports$Blockly$Events$utils.setGroup)(!0),(0,module$exports$Blockly$utils$dom.startTextWidthCache)(),b.setResizesEnabled&&b.setResizesEnabled(!1);for(var f=$jscomp.makeIterator(e.reverse()),g=f.next();!g.done;g=f.next())(g=$jscomp.makeIterator(g.value)).next(),g.next().value.clear(b);for(f=(e=$jscomp.makeIterator(e.reverse())).next();!f.done;f=e.next())f=(g=$jscomp.makeIterator(f.value)).next().value,g=g.next().value,a[f]&&g.load(a[f],b);b.setResizesEnabled&&b.setResizesEnabled(!0),(0,module$exports$Blockly$utils$dom.stopTextWidthCache)(),(0,module$exports$Blockly$Events$utils.fire)(new((0,module$exports$Blockly$Events$utils.get)(module$exports$Blockly$Events$utils.FINISHED_LOADING))(b)),(0,module$exports$Blockly$Events$utils.setGroup)(d),(0,module$exports$Blockly$Events$utils.setRecordUndo)(c)}}},module$contents$Blockly$serialization$variables_VariableSerializer=function(){this.priority=module$exports$Blockly$serialization$priorities.VARIABLES};module$contents$Blockly$serialization$variables_VariableSerializer.prototype.save=function(a){for(var b=[],c=(a=$jscomp.makeIterator(a.getAllVariables())).next();!c.done;c=a.next()){var d={name:(c=c.value).name,id:c.getId()};c.type&&(d.type=c.type),b.push(d)}return b.length?b:null},module$contents$Blockly$serialization$variables_VariableSerializer.prototype.load=function(a,b){for(var c=(a=$jscomp.makeIterator(a)).next();!c.done;c=a.next())c=c.value,b.createVariable(c.name,c.type,c.id)},module$contents$Blockly$serialization$variables_VariableSerializer.prototype.clear=function(a){a.getVariableMap().clear()},(0,module$exports$Blockly$serialization$registry.register)("variables",new module$contents$Blockly$serialization$variables_VariableSerializer);var module$exports$Blockly$minimalist$ConstantProvider={ConstantProvider:function(){module$exports$Blockly$minimalist$ConstantProvider.ConstantProvider.superClass_.constructor.call(this)}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$minimalist$ConstantProvider.ConstantProvider,module$exports$Blockly$blockRendering$ConstantProvider.ConstantProvider);var module$exports$Blockly$minimalist$Drawer={Drawer:function(a,b){module$exports$Blockly$minimalist$Drawer.Drawer.superClass_.constructor.call(this,a,b)}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$minimalist$Drawer.Drawer,module$exports$Blockly$blockRendering$Drawer.Drawer);var module$exports$Blockly$minimalist$RenderInfo={RenderInfo:function(a,b){module$exports$Blockly$minimalist$RenderInfo.RenderInfo.superClass_.constructor.call(this,a,b)}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$minimalist$RenderInfo.RenderInfo,module$exports$Blockly$blockRendering$RenderInfo.RenderInfo),module$exports$Blockly$minimalist$RenderInfo.RenderInfo.prototype.getRenderer=function(){return this.renderer_};var module$exports$Blockly$minimalist$Renderer={Renderer:function(a){module$exports$Blockly$minimalist$Renderer.Renderer.superClass_.constructor.call(this,a)}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$minimalist$Renderer.Renderer,module$exports$Blockly$blockRendering$Renderer.Renderer),module$exports$Blockly$minimalist$Renderer.Renderer.prototype.makeConstants_=function(){return new module$exports$Blockly$minimalist$ConstantProvider.ConstantProvider},module$exports$Blockly$minimalist$Renderer.Renderer.prototype.makeRenderInfo_=function(a){return new module$exports$Blockly$minimalist$RenderInfo.RenderInfo(this,a)},module$exports$Blockly$minimalist$Renderer.Renderer.prototype.makeDrawer_=function(a,b){return new module$exports$Blockly$minimalist$Drawer.Drawer(a,b)},(0,module$exports$Blockly$blockRendering.register)("minimalist",module$exports$Blockly$minimalist$Renderer.Renderer);var module$exports$Blockly$minimalist={};module$exports$Blockly$minimalist.ConstantProvider=module$exports$Blockly$minimalist$ConstantProvider.ConstantProvider,module$exports$Blockly$minimalist.Drawer=module$exports$Blockly$minimalist$Drawer.Drawer,module$exports$Blockly$minimalist.RenderInfo=module$exports$Blockly$minimalist$RenderInfo.RenderInfo,module$exports$Blockly$minimalist.Renderer=module$exports$Blockly$minimalist$Renderer.Renderer;var module$exports$Blockly$geras$StatementInput={StatementInput:function(a,b){module$exports$Blockly$geras$StatementInput.StatementInput.superClass_.constructor.call(this,a,b),this.connectedBlock&&(this.height+=this.constants_.DARK_PATH_OFFSET)}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$geras$StatementInput.StatementInput,module$exports$Blockly$blockRendering$StatementInput.StatementInput);var module$exports$Blockly$geras$PathObject={PathObject:function(a,b,c){this.constants=c,this.svgRoot=a,this.svgPathDark=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.PATH,{class:"blocklyPathDark",transform:"translate(1,1)"},this.svgRoot),this.svgPath=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.PATH,{class:"blocklyPath"},this.svgRoot),this.svgPathLight=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.PATH,{class:"blocklyPathLight"},this.svgRoot),this.colourDark="#000000",this.style=b}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$geras$PathObject.PathObject,module$exports$Blockly$blockRendering$PathObject.PathObject),module$exports$Blockly$geras$PathObject.PathObject.prototype.setPath=function(a){this.svgPath.setAttribute("d",a),this.svgPathDark.setAttribute("d",a)},module$exports$Blockly$geras$PathObject.PathObject.prototype.setHighlightPath=function(a){this.svgPathLight.setAttribute("d",a)},module$exports$Blockly$geras$PathObject.PathObject.prototype.flipRTL=function(){this.svgPath.setAttribute("transform","scale(-1 1)"),this.svgPathLight.setAttribute("transform","scale(-1 1)"),this.svgPathDark.setAttribute("transform","translate(1,1) scale(-1 1)")},module$exports$Blockly$geras$PathObject.PathObject.prototype.applyColour=function(a){this.svgPathLight.style.display="",this.svgPathDark.style.display="",this.svgPathLight.setAttribute("stroke",this.style.colourTertiary),this.svgPathDark.setAttribute("fill",this.colourDark),module$exports$Blockly$geras$PathObject.PathObject.superClass_.applyColour.call(this,a),this.svgPath.setAttribute("stroke","none")},module$exports$Blockly$geras$PathObject.PathObject.prototype.setStyle=function(a){this.style=a,this.colourDark=(0,module$exports$Blockly$utils$colour.blend)("#000",this.style.colourPrimary,.2)||this.colourDark},module$exports$Blockly$geras$PathObject.PathObject.prototype.updateHighlighted=function(a){a?(this.svgPath.setAttribute("filter","url(#"+this.constants.embossFilterId+")"),this.svgPathLight.style.display="none"):(this.svgPath.setAttribute("filter","none"),this.svgPathLight.style.display="inline")},module$exports$Blockly$geras$PathObject.PathObject.prototype.updateShadow_=function(a){a&&(this.svgPathLight.style.display="none",this.svgPathDark.setAttribute("fill",this.style.colourSecondary),this.svgPath.setAttribute("stroke","none"),this.svgPath.setAttribute("fill",this.style.colourSecondary))},module$exports$Blockly$geras$PathObject.PathObject.prototype.updateDisabled_=function(a){module$exports$Blockly$geras$PathObject.PathObject.superClass_.updateDisabled_.call(this,a),a&&this.svgPath.setAttribute("stroke","none")};var module$exports$Blockly$geras$ConstantProvider={ConstantProvider:function(){module$exports$Blockly$geras$ConstantProvider.ConstantProvider.superClass_.constructor.call(this),this.FIELD_TEXT_BASELINE_CENTER=!1,this.DARK_PATH_OFFSET=1,this.MAX_BOTTOM_WIDTH=30,this.STATEMENT_BOTTOM_SPACER=-this.NOTCH_HEIGHT/2}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$geras$ConstantProvider.ConstantProvider,module$exports$Blockly$blockRendering$ConstantProvider.ConstantProvider),module$exports$Blockly$geras$ConstantProvider.ConstantProvider.prototype.getCSS_=function(a){return module$exports$Blockly$geras$ConstantProvider.ConstantProvider.superClass_.getCSS_.call(this,a).concat([a+" .blocklyInsertionMarker>.blocklyPathLight,",a+" .blocklyInsertionMarker>.blocklyPathDark {","fill-opacity: "+this.INSERTION_MARKER_OPACITY+";","stroke: none;","}"])};var module$exports$Blockly$geras$Highlighter={Highlighter:function(a){this.info_=a,this.inlineSteps_=this.steps_="",this.RTL_=this.info_.RTL,a=a.getRenderer(),this.constants_=a.getConstants(),this.highlightConstants_=a.getHighlightConstants(),this.highlightOffset_=this.highlightConstants_.OFFSET,this.outsideCornerPaths_=this.highlightConstants_.OUTSIDE_CORNER,this.insideCornerPaths_=this.highlightConstants_.INSIDE_CORNER,this.puzzleTabPaths_=this.highlightConstants_.PUZZLE_TAB,this.notchPaths_=this.highlightConstants_.NOTCH,this.startPaths_=this.highlightConstants_.START_HAT,this.jaggedTeethPaths_=this.highlightConstants_.JAGGED_TEETH}};module$exports$Blockly$geras$Highlighter.Highlighter.prototype.getPath=function(){return this.steps_+"\n"+this.inlineSteps_},module$exports$Blockly$geras$Highlighter.Highlighter.prototype.drawTopCorner=function(a){this.steps_+=(0,module$exports$Blockly$utils$svgPaths.moveBy)(a.xPos,this.info_.startY);for(var c,b=0;c=a.elements[b];b++)module$exports$Blockly$blockRendering$Types.Types.isLeftSquareCorner(c)?this.steps_+=this.highlightConstants_.START_POINT:module$exports$Blockly$blockRendering$Types.Types.isLeftRoundedCorner(c)?this.steps_+=this.outsideCornerPaths_.topLeft(this.RTL_):module$exports$Blockly$blockRendering$Types.Types.isPreviousConnection(c)?this.steps_+=this.notchPaths_.pathLeft:module$exports$Blockly$blockRendering$Types.Types.isHat(c)?this.steps_+=this.startPaths_.path(this.RTL_):module$exports$Blockly$blockRendering$Types.Types.isSpacer(c)&&0!==c.width&&(this.steps_+=(0,module$exports$Blockly$utils$svgPaths.lineOnAxis)("H",c.xPos+c.width-this.highlightOffset_));this.steps_+=(0,module$exports$Blockly$utils$svgPaths.lineOnAxis)("H",a.xPos+a.width-this.highlightOffset_)},module$exports$Blockly$geras$Highlighter.Highlighter.prototype.drawJaggedEdge_=function(a){this.info_.RTL&&(this.steps_+=this.jaggedTeethPaths_.pathLeft+(0,module$exports$Blockly$utils$svgPaths.lineOnAxis)("v",a.height-this.jaggedTeethPaths_.height-this.highlightOffset_))},module$exports$Blockly$geras$Highlighter.Highlighter.prototype.drawValueInput=function(a){var b=a.getLastInput();if(this.RTL_){var c=a.height-b.connectionHeight;this.steps_+=(0,module$exports$Blockly$utils$svgPaths.moveTo)(b.xPos+b.width-this.highlightOffset_,a.yPos)+this.puzzleTabPaths_.pathDown(this.RTL_)+(0,module$exports$Blockly$utils$svgPaths.lineOnAxis)("v",c)}else this.steps_+=(0,module$exports$Blockly$utils$svgPaths.moveTo)(b.xPos+b.width,a.yPos)+this.puzzleTabPaths_.pathDown(this.RTL_)},module$exports$Blockly$geras$Highlighter.Highlighter.prototype.drawStatementInput=function(a){var b=a.getLastInput();if(this.RTL_){var c=a.height-2*this.insideCornerPaths_.height;this.steps_+=(0,module$exports$Blockly$utils$svgPaths.moveTo)(b.xPos,a.yPos)+this.insideCornerPaths_.pathTop(this.RTL_)+(0,module$exports$Blockly$utils$svgPaths.lineOnAxis)("v",c)+this.insideCornerPaths_.pathBottom(this.RTL_)+(0,module$exports$Blockly$utils$svgPaths.lineTo)(a.width-b.xPos-this.insideCornerPaths_.width,0)}else this.steps_+=(0,module$exports$Blockly$utils$svgPaths.moveTo)(b.xPos,a.yPos+a.height)+this.insideCornerPaths_.pathBottom(this.RTL_)+(0,module$exports$Blockly$utils$svgPaths.lineTo)(a.width-b.xPos-this.insideCornerPaths_.width,0)},module$exports$Blockly$geras$Highlighter.Highlighter.prototype.drawRightSideRow=function(a){var b=a.xPos+a.width-this.highlightOffset_;a.followsStatement&&(this.steps_+=(0,module$exports$Blockly$utils$svgPaths.lineOnAxis)("H",b)),this.RTL_&&(this.steps_+=(0,module$exports$Blockly$utils$svgPaths.lineOnAxis)("H",b),a.height>this.highlightOffset_&&(this.steps_+=(0,module$exports$Blockly$utils$svgPaths.lineOnAxis)("V",a.yPos+a.height-this.highlightOffset_)))},module$exports$Blockly$geras$Highlighter.Highlighter.prototype.drawBottomRow=function(a){if(this.RTL_)this.steps_+=(0,module$exports$Blockly$utils$svgPaths.lineOnAxis)("V",a.baseline-this.highlightOffset_);else{var b=this.info_.bottomRow.elements[0];module$exports$Blockly$blockRendering$Types.Types.isLeftSquareCorner(b)?this.steps_+=(0,module$exports$Blockly$utils$svgPaths.moveTo)(a.xPos+this.highlightOffset_,a.baseline-this.highlightOffset_):module$exports$Blockly$blockRendering$Types.Types.isLeftRoundedCorner(b)&&(this.steps_+=(0,module$exports$Blockly$utils$svgPaths.moveTo)(a.xPos,a.baseline),this.steps_+=this.outsideCornerPaths_.bottomLeft())}},module$exports$Blockly$geras$Highlighter.Highlighter.prototype.drawLeft=function(){var a=this.info_.outputConnection;a&&(a=a.connectionOffsetY+a.height,this.RTL_?this.steps_+=(0,module$exports$Blockly$utils$svgPaths.moveTo)(this.info_.startX,a):(this.steps_+=(0,module$exports$Blockly$utils$svgPaths.moveTo)(this.info_.startX+this.highlightOffset_,this.info_.bottomRow.baseline-this.highlightOffset_),this.steps_+=(0,module$exports$Blockly$utils$svgPaths.lineOnAxis)("V",a)),this.steps_+=this.puzzleTabPaths_.pathUp(this.RTL_)),this.RTL_||(a=this.info_.topRow,module$exports$Blockly$blockRendering$Types.Types.isLeftRoundedCorner(a.elements[0])?this.steps_+=(0,module$exports$Blockly$utils$svgPaths.lineOnAxis)("V",this.outsideCornerPaths_.height):this.steps_+=(0,module$exports$Blockly$utils$svgPaths.lineOnAxis)("V",a.capline+this.highlightOffset_))},module$exports$Blockly$geras$Highlighter.Highlighter.prototype.drawInlineInput=function(a){var b=this.highlightOffset_,c=a.xPos+a.connectionWidth,d=a.centerline-a.height/2,e=a.width-a.connectionWidth,f=d+b;this.RTL_?(d=a.connectionOffsetY-b,a=a.height-(a.connectionOffsetY+a.connectionHeight)+b,this.inlineSteps_+=(0,module$exports$Blockly$utils$svgPaths.moveTo)(c-b,f)+(0,module$exports$Blockly$utils$svgPaths.lineOnAxis)("v",d)+this.puzzleTabPaths_.pathDown(this.RTL_)+(0,module$exports$Blockly$utils$svgPaths.lineOnAxis)("v",a)+(0,module$exports$Blockly$utils$svgPaths.lineOnAxis)("h",e)):this.inlineSteps_+=(0,module$exports$Blockly$utils$svgPaths.moveTo)(a.xPos+a.width+b,f)+(0,module$exports$Blockly$utils$svgPaths.lineOnAxis)("v",a.height)+(0,module$exports$Blockly$utils$svgPaths.lineOnAxis)("h",-e)+(0,module$exports$Blockly$utils$svgPaths.moveTo)(c,d+a.connectionOffsetY)+this.puzzleTabPaths_.pathDown(this.RTL_)};var module$exports$Blockly$geras$Drawer={Drawer:function(a,b){module$exports$Blockly$geras$Drawer.Drawer.superClass_.constructor.call(this,a,b),this.highlighter_=new module$exports$Blockly$geras$Highlighter.Highlighter(b)}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$geras$Drawer.Drawer,module$exports$Blockly$blockRendering$Drawer.Drawer),module$exports$Blockly$geras$Drawer.Drawer.prototype.draw=function(){this.hideHiddenIcons_(),this.drawOutline_(),this.drawInternals_();var a=this.block_.pathObject;a.setPath(this.outlinePath_+"\n"+this.inlinePath_),a.setHighlightPath(this.highlighter_.getPath()),this.info_.RTL&&a.flipRTL(),(0,module$exports$Blockly$blockRendering$debug.isDebuggerEnabled)()&&this.block_.renderingDebugger.drawDebug(this.block_,this.info_),this.recordSizeOnBlock_()},module$exports$Blockly$geras$Drawer.Drawer.prototype.drawTop_=function(){this.highlighter_.drawTopCorner(this.info_.topRow),this.highlighter_.drawRightSideRow(this.info_.topRow),module$exports$Blockly$geras$Drawer.Drawer.superClass_.drawTop_.call(this)},module$exports$Blockly$geras$Drawer.Drawer.prototype.drawJaggedEdge_=function(a){this.highlighter_.drawJaggedEdge_(a),module$exports$Blockly$geras$Drawer.Drawer.superClass_.drawJaggedEdge_.call(this,a)},module$exports$Blockly$geras$Drawer.Drawer.prototype.drawValueInput_=function(a){this.highlighter_.drawValueInput(a),module$exports$Blockly$geras$Drawer.Drawer.superClass_.drawValueInput_.call(this,a)},module$exports$Blockly$geras$Drawer.Drawer.prototype.drawStatementInput_=function(a){this.highlighter_.drawStatementInput(a),module$exports$Blockly$geras$Drawer.Drawer.superClass_.drawStatementInput_.call(this,a)},module$exports$Blockly$geras$Drawer.Drawer.prototype.drawRightSideRow_=function(a){this.highlighter_.drawRightSideRow(a),this.outlinePath_+=(0,module$exports$Blockly$utils$svgPaths.lineOnAxis)("H",a.xPos+a.width)+(0,module$exports$Blockly$utils$svgPaths.lineOnAxis)("V",a.yPos+a.height)},module$exports$Blockly$geras$Drawer.Drawer.prototype.drawBottom_=function(){this.highlighter_.drawBottomRow(this.info_.bottomRow),module$exports$Blockly$geras$Drawer.Drawer.superClass_.drawBottom_.call(this)},module$exports$Blockly$geras$Drawer.Drawer.prototype.drawLeft_=function(){this.highlighter_.drawLeft(),module$exports$Blockly$geras$Drawer.Drawer.superClass_.drawLeft_.call(this)},module$exports$Blockly$geras$Drawer.Drawer.prototype.drawInlineInput_=function(a){this.highlighter_.drawInlineInput(a),module$exports$Blockly$geras$Drawer.Drawer.superClass_.drawInlineInput_.call(this,a)},module$exports$Blockly$geras$Drawer.Drawer.prototype.positionInlineInputConnection_=function(a){var b=a.centerline-a.height/2;if(a.connectionModel){var c=a.xPos+a.connectionWidth+this.constants_.DARK_PATH_OFFSET;this.info_.RTL&&(c*=-1),a.connectionModel.setOffsetInBlock(c,b+a.connectionOffsetY+this.constants_.DARK_PATH_OFFSET)}},module$exports$Blockly$geras$Drawer.Drawer.prototype.positionStatementInputConnection_=function(a){var b=a.getLastInput();if(b.connectionModel){var c=a.xPos+a.statementEdge+b.notchOffset;c=this.info_.RTL?-1*c:c+this.constants_.DARK_PATH_OFFSET,b.connectionModel.setOffsetInBlock(c,a.yPos+this.constants_.DARK_PATH_OFFSET)}},module$exports$Blockly$geras$Drawer.Drawer.prototype.positionExternalValueConnection_=function(a){var b=a.getLastInput();if(b.connectionModel){var c=a.xPos+a.width+this.constants_.DARK_PATH_OFFSET;this.info_.RTL&&(c*=-1),b.connectionModel.setOffsetInBlock(c,a.yPos)}},module$exports$Blockly$geras$Drawer.Drawer.prototype.positionNextConnection_=function(){var a=this.info_.bottomRow;if(a.connection){var b=a.connection,c=b.xPos;b.connectionModel.setOffsetInBlock((this.info_.RTL?-c:c)+this.constants_.DARK_PATH_OFFSET/2,a.baseline+this.constants_.DARK_PATH_OFFSET)}};var module$exports$Blockly$geras$HighlightConstantProvider={HighlightConstantProvider:function(a){this.constantProvider=a,this.OFFSET=.5,this.START_POINT=(0,module$exports$Blockly$utils$svgPaths.moveBy)(this.OFFSET,this.OFFSET)}};module$exports$Blockly$geras$HighlightConstantProvider.HighlightConstantProvider.prototype.init=function(){this.INSIDE_CORNER=this.makeInsideCorner(),this.OUTSIDE_CORNER=this.makeOutsideCorner(),this.PUZZLE_TAB=this.makePuzzleTab(),this.NOTCH=this.makeNotch(),this.JAGGED_TEETH=this.makeJaggedTeeth(),this.START_HAT=this.makeStartHat()},module$exports$Blockly$geras$HighlightConstantProvider.HighlightConstantProvider.prototype.makeInsideCorner=function(){var a=this.constantProvider.CORNER_RADIUS,b=this.OFFSET,c=(1-Math.SQRT1_2)*(a+b)-b,d=(0,module$exports$Blockly$utils$svgPaths.moveBy)(c,c)+(0,module$exports$Blockly$utils$svgPaths.arc)("a","0 0,0",a,(0,module$exports$Blockly$utils$svgPaths.point)(-c-b,a-c)),e=(0,module$exports$Blockly$utils$svgPaths.arc)("a","0 0,0",a+b,(0,module$exports$Blockly$utils$svgPaths.point)(a+b,a+b)),f=(0,module$exports$Blockly$utils$svgPaths.moveBy)(c,-c)+(0,module$exports$Blockly$utils$svgPaths.arc)("a","0 0,0",a+b,(0,module$exports$Blockly$utils$svgPaths.point)(a-c,c+b));return{width:a+b,height:a,pathTop:function(g){return g?d:""},pathBottom:function(g){return g?e:f}}},module$exports$Blockly$geras$HighlightConstantProvider.HighlightConstantProvider.prototype.makeOutsideCorner=function(){var a=this.constantProvider.CORNER_RADIUS,b=this.OFFSET,c=(1-Math.SQRT1_2)*(a-b)+b,d=(0,module$exports$Blockly$utils$svgPaths.moveBy)(c,c)+(0,module$exports$Blockly$utils$svgPaths.arc)("a","0 0,1",a-b,(0,module$exports$Blockly$utils$svgPaths.point)(a-c,-c+b)),e=(0,module$exports$Blockly$utils$svgPaths.moveBy)(b,a)+(0,module$exports$Blockly$utils$svgPaths.arc)("a","0 0,1",a-b,(0,module$exports$Blockly$utils$svgPaths.point)(a,-a+b)),f=-c,g=(0,module$exports$Blockly$utils$svgPaths.moveBy)(c,f)+(0,module$exports$Blockly$utils$svgPaths.arc)("a","0 0,1",a-b,(0,module$exports$Blockly$utils$svgPaths.point)(-c+b,-f-a));return{height:a,topLeft:function(h){return h?d:e},bottomLeft:function(){return g}}},module$exports$Blockly$geras$HighlightConstantProvider.HighlightConstantProvider.prototype.makePuzzleTab=function(){var a=this.constantProvider.TAB_WIDTH,b=this.constantProvider.TAB_HEIGHT,c=(0,module$exports$Blockly$utils$svgPaths.moveBy)(-2,3.4-b)+(0,module$exports$Blockly$utils$svgPaths.lineTo)(-.45*a,-2.1),d=(0,module$exports$Blockly$utils$svgPaths.lineOnAxis)("v",2.5)+(0,module$exports$Blockly$utils$svgPaths.moveBy)(.97*-a,2.5)+(0,module$exports$Blockly$utils$svgPaths.curve)("q",[(0,module$exports$Blockly$utils$svgPaths.point)(.05*-a,10),(0,module$exports$Blockly$utils$svgPaths.point)(.3*a,9.5)])+(0,module$exports$Blockly$utils$svgPaths.moveBy)(.67*a,-1.9)+(0,module$exports$Blockly$utils$svgPaths.lineOnAxis)("v",2.5),e=(0,module$exports$Blockly$utils$svgPaths.lineOnAxis)("v",-1.5)+(0,module$exports$Blockly$utils$svgPaths.moveBy)(-.92*a,-.5)+(0,module$exports$Blockly$utils$svgPaths.curve)("q",[(0,module$exports$Blockly$utils$svgPaths.point)(-.19*a,-5.5),(0,module$exports$Blockly$utils$svgPaths.point)(0,-11)])+(0,module$exports$Blockly$utils$svgPaths.moveBy)(.92*a,1),f=(0,module$exports$Blockly$utils$svgPaths.moveBy)(-5,b-.7)+(0,module$exports$Blockly$utils$svgPaths.lineTo)(.46*a,-2.1);return{width:a,height:b,pathUp:function(g){return g?c:e},pathDown:function(g){return g?d:f}}},module$exports$Blockly$geras$HighlightConstantProvider.HighlightConstantProvider.prototype.makeNotch=function(){return{pathLeft:(0,module$exports$Blockly$utils$svgPaths.lineOnAxis)("h",this.OFFSET)+this.constantProvider.NOTCH.pathLeft}},module$exports$Blockly$geras$HighlightConstantProvider.HighlightConstantProvider.prototype.makeJaggedTeeth=function(){return{pathLeft:(0,module$exports$Blockly$utils$svgPaths.lineTo)(5.1,2.6)+(0,module$exports$Blockly$utils$svgPaths.moveBy)(-10.2,6.8)+(0,module$exports$Blockly$utils$svgPaths.lineTo)(5.1,2.6),height:12,width:10.2}},module$exports$Blockly$geras$HighlightConstantProvider.HighlightConstantProvider.prototype.makeStartHat=function(){var a=this.constantProvider.START_HAT.height,b=(0,module$exports$Blockly$utils$svgPaths.moveBy)(25,-8.7)+(0,module$exports$Blockly$utils$svgPaths.curve)("c",[(0,module$exports$Blockly$utils$svgPaths.point)(29.7,-6.2),(0,module$exports$Blockly$utils$svgPaths.point)(57.2,-.5),(0,module$exports$Blockly$utils$svgPaths.point)(75,8.7)]),c=(0,module$exports$Blockly$utils$svgPaths.curve)("c",[(0,module$exports$Blockly$utils$svgPaths.point)(17.8,-9.2),(0,module$exports$Blockly$utils$svgPaths.point)(45.3,-14.9),(0,module$exports$Blockly$utils$svgPaths.point)(75,-8.7)])+(0,module$exports$Blockly$utils$svgPaths.moveTo)(100.5,a+.5);return{path:function(d){return d?b:c}}};var module$exports$Blockly$geras$InlineInput={InlineInput:function(a,b){module$exports$Blockly$geras$InlineInput.InlineInput.superClass_.constructor.call(this,a,b),this.connectedBlock&&(this.width+=this.constants_.DARK_PATH_OFFSET,this.height+=this.constants_.DARK_PATH_OFFSET)}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$geras$InlineInput.InlineInput,module$exports$Blockly$blockRendering$InlineInput.InlineInput);var module$exports$Blockly$geras$RenderInfo={RenderInfo:function(a,b){module$exports$Blockly$geras$RenderInfo.RenderInfo.superClass_.constructor.call(this,a,b)}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$geras$RenderInfo.RenderInfo,module$exports$Blockly$blockRendering$RenderInfo.RenderInfo),module$exports$Blockly$geras$RenderInfo.RenderInfo.prototype.getRenderer=function(){return this.renderer_},module$exports$Blockly$geras$RenderInfo.RenderInfo.prototype.populateBottomRow_=function(){module$exports$Blockly$geras$RenderInfo.RenderInfo.superClass_.populateBottomRow_.call(this),this.block_.inputList.length&&this.block_.inputList[this.block_.inputList.length-1].type===$.module$exports$Blockly$inputTypes.inputTypes.STATEMENT||(this.bottomRow.minHeight=this.constants_.MEDIUM_PADDING-this.constants_.DARK_PATH_OFFSET)},module$exports$Blockly$geras$RenderInfo.RenderInfo.prototype.addInput_=function(a,b){this.isInline&&a.type===$.module$exports$Blockly$inputTypes.inputTypes.VALUE?(b.elements.push(new module$exports$Blockly$geras$InlineInput.InlineInput(this.constants_,a)),b.hasInlineInput=!0):a.type===$.module$exports$Blockly$inputTypes.inputTypes.STATEMENT?(b.elements.push(new module$exports$Blockly$geras$StatementInput.StatementInput(this.constants_,a)),b.hasStatement=!0):a.type===$.module$exports$Blockly$inputTypes.inputTypes.VALUE?(b.elements.push(new module$exports$Blockly$blockRendering$ExternalValueInput.ExternalValueInput(this.constants_,a)),b.hasExternalInput=!0):a.type===$.module$exports$Blockly$inputTypes.inputTypes.DUMMY&&(b.minHeight=Math.max(b.minHeight,this.constants_.DUMMY_INPUT_MIN_HEIGHT),b.hasDummyInput=!0),this.isInline||null!==b.align||(b.align=a.align)},module$exports$Blockly$geras$RenderInfo.RenderInfo.prototype.addElemSpacing_=function(){for(var c,a=!1,b=0;c=this.rows[b];b++)c.hasExternalInput&&(a=!0);for(b=0;c=this.rows[b];b++){var d=c.elements;if(c.elements=[],c.startsWithElemSpacer()&&c.elements.push(new module$exports$Blockly$blockRendering$InRowSpacer.InRowSpacer(this.constants_,this.getInRowSpacing_(null,d[0]))),d.length){for(var e=0;e<d.length-1;e++){c.elements.push(d[e]);var f=this.getInRowSpacing_(d[e],d[e+1]);c.elements.push(new module$exports$Blockly$blockRendering$InRowSpacer.InRowSpacer(this.constants_,f))}c.elements.push(d[d.length-1]),c.endsWithElemSpacer()&&(d=this.getInRowSpacing_(d[d.length-1],null),a&&c.hasDummyInput&&(d+=this.constants_.TAB_WIDTH),c.elements.push(new module$exports$Blockly$blockRendering$InRowSpacer.InRowSpacer(this.constants_,d)))}}},module$exports$Blockly$geras$RenderInfo.RenderInfo.prototype.getInRowSpacing_=function(a,b){if(!a)return b&&module$exports$Blockly$blockRendering$Types.Types.isField(b)&&b.isEditable?this.constants_.MEDIUM_PADDING:b&&module$exports$Blockly$blockRendering$Types.Types.isInlineInput(b)?this.constants_.MEDIUM_LARGE_PADDING:b&&module$exports$Blockly$blockRendering$Types.Types.isStatementInput(b)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:this.constants_.LARGE_PADDING;if(!module$exports$Blockly$blockRendering$Types.Types.isInput(a)&&(!b||module$exports$Blockly$blockRendering$Types.Types.isStatementInput(b)))return module$exports$Blockly$blockRendering$Types.Types.isField(a)&&a.isEditable?this.constants_.MEDIUM_PADDING:module$exports$Blockly$blockRendering$Types.Types.isIcon(a)?2*this.constants_.LARGE_PADDING+1:module$exports$Blockly$blockRendering$Types.Types.isHat(a)?this.constants_.NO_PADDING:module$exports$Blockly$blockRendering$Types.Types.isPreviousOrNextConnection(a)?this.constants_.LARGE_PADDING:module$exports$Blockly$blockRendering$Types.Types.isLeftRoundedCorner(a)?this.constants_.MIN_BLOCK_WIDTH:module$exports$Blockly$blockRendering$Types.Types.isJaggedEdge(a)?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING;if(module$exports$Blockly$blockRendering$Types.Types.isInput(a)&&!b){if(module$exports$Blockly$blockRendering$Types.Types.isExternalInput(a))return this.constants_.NO_PADDING;if(module$exports$Blockly$blockRendering$Types.Types.isInlineInput(a))return this.constants_.LARGE_PADDING;if(module$exports$Blockly$blockRendering$Types.Types.isStatementInput(a))return this.constants_.NO_PADDING}if(!module$exports$Blockly$blockRendering$Types.Types.isInput(a)&&b&&module$exports$Blockly$blockRendering$Types.Types.isInput(b)){if(module$exports$Blockly$blockRendering$Types.Types.isField(a)&&a.isEditable){if(module$exports$Blockly$blockRendering$Types.Types.isInlineInput(b)||module$exports$Blockly$blockRendering$Types.Types.isExternalInput(b))return this.constants_.SMALL_PADDING}else{if(module$exports$Blockly$blockRendering$Types.Types.isInlineInput(b)||module$exports$Blockly$blockRendering$Types.Types.isExternalInput(b))return this.constants_.MEDIUM_LARGE_PADDING;if(module$exports$Blockly$blockRendering$Types.Types.isStatementInput(b))return this.constants_.LARGE_PADDING}return this.constants_.LARGE_PADDING-1}if(module$exports$Blockly$blockRendering$Types.Types.isIcon(a)&&b&&!module$exports$Blockly$blockRendering$Types.Types.isInput(b))return this.constants_.LARGE_PADDING;if(module$exports$Blockly$blockRendering$Types.Types.isInlineInput(a)&&b&&module$exports$Blockly$blockRendering$Types.Types.isField(b))return b.isEditable?this.constants_.MEDIUM_PADDING:this.constants_.LARGE_PADDING;if(module$exports$Blockly$blockRendering$Types.Types.isLeftSquareCorner(a)&&b){if(module$exports$Blockly$blockRendering$Types.Types.isHat(b))return this.constants_.NO_PADDING;if(module$exports$Blockly$blockRendering$Types.Types.isPreviousConnection(b))return b.notchOffset;if(module$exports$Blockly$blockRendering$Types.Types.isNextConnection(b))return b.notchOffset+(this.RTL?1:-1)*this.constants_.DARK_PATH_OFFSET/2}if(module$exports$Blockly$blockRendering$Types.Types.isLeftRoundedCorner(a)&&b){if(module$exports$Blockly$blockRendering$Types.Types.isPreviousConnection(b))return b.notchOffset-this.constants_.CORNER_RADIUS;if(module$exports$Blockly$blockRendering$Types.Types.isNextConnection(b))return b.notchOffset-this.constants_.CORNER_RADIUS+(this.RTL?1:-1)*this.constants_.DARK_PATH_OFFSET/2}return module$exports$Blockly$blockRendering$Types.Types.isField(a)&&b&&module$exports$Blockly$blockRendering$Types.Types.isField(b)&&a.isEditable===b.isEditable||b&&module$exports$Blockly$blockRendering$Types.Types.isJaggedEdge(b)?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING},module$exports$Blockly$geras$RenderInfo.RenderInfo.prototype.getSpacerRowHeight_=function(a,b){return module$exports$Blockly$blockRendering$Types.Types.isTopRow(a)&&module$exports$Blockly$blockRendering$Types.Types.isBottomRow(b)?this.constants_.EMPTY_BLOCK_SPACER_HEIGHT:module$exports$Blockly$blockRendering$Types.Types.isTopRow(a)||module$exports$Blockly$blockRendering$Types.Types.isBottomRow(b)?this.constants_.NO_PADDING:a.hasExternalInput&&b.hasExternalInput?this.constants_.LARGE_PADDING:!a.hasStatement&&b.hasStatement?this.constants_.BETWEEN_STATEMENT_PADDING_Y:a.hasStatement&&b.hasStatement||!a.hasStatement&&b.hasDummyInput||a.hasDummyInput?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING},module$exports$Blockly$geras$RenderInfo.RenderInfo.prototype.getElemCenterline_=function(a,b){if(module$exports$Blockly$blockRendering$Types.Types.isSpacer(b))return a.yPos+b.height/2;if(module$exports$Blockly$blockRendering$Types.Types.isBottomRow(a))return a=a.yPos+a.height-a.descenderHeight,module$exports$Blockly$blockRendering$Types.Types.isNextConnection(b)?a+b.height/2:a-b.height/2;if(module$exports$Blockly$blockRendering$Types.Types.isTopRow(a))return module$exports$Blockly$blockRendering$Types.Types.isHat(b)?a.capline-b.height/2:a.capline+b.height/2;var c=a.yPos;return module$exports$Blockly$blockRendering$Types.Types.isField(b)||module$exports$Blockly$blockRendering$Types.Types.isIcon(b)?(c+=b.height/2,(a.hasInlineInput||a.hasStatement)&&b.height+this.constants_.TALL_INPUT_FIELD_OFFSET_Y<=a.height&&(c+=this.constants_.TALL_INPUT_FIELD_OFFSET_Y)):c=module$exports$Blockly$blockRendering$Types.Types.isInlineInput(b)?c+b.height/2:c+a.height/2,c},module$exports$Blockly$geras$RenderInfo.RenderInfo.prototype.alignRowElements_=function(){if(this.isInline){for(var d,a=0,b=null,c=this.rows.length-1;d=this.rows[c];c--)d.nextRightEdge=a,module$exports$Blockly$blockRendering$Types.Types.isInputRow(d)&&(d.hasStatement&&this.alignStatementRow_(d),b&&b.hasStatement&&d.width<b.width?d.nextRightEdge=b.width:a=d.width,b=d);for(a=c=0;b=this.rows[a];a++)b.hasStatement?c=this.getDesiredRowWidth_(b):module$exports$Blockly$blockRendering$Types.Types.isSpacer(b)?b.width=Math.max(c,b.nextRightEdge):(0<(c=Math.max(c,b.nextRightEdge)-b.width)&&this.addAlignmentPadding_(b,c),c=b.width)}else module$exports$Blockly$geras$RenderInfo.RenderInfo.superClass_.alignRowElements_.call(this)},module$exports$Blockly$geras$RenderInfo.RenderInfo.prototype.getDesiredRowWidth_=function(a){return this.isInline&&a.hasStatement?this.statementEdge+this.constants_.MAX_BOTTOM_WIDTH+this.startX:module$exports$Blockly$geras$RenderInfo.RenderInfo.superClass_.getDesiredRowWidth_.call(this,a)},module$exports$Blockly$geras$RenderInfo.RenderInfo.prototype.finalize_=function(){for(var d,a=0,b=0,c=0;d=this.rows[c];c++){d.yPos=b,d.xPos=this.startX,b+=d.height,a=Math.max(a,d.widthWithConnectedBlocks);var e=b-this.topRow.ascenderHeight;d===this.bottomRow&&e<this.constants_.MIN_BLOCK_HEIGHT&&(e=this.constants_.MIN_BLOCK_HEIGHT-e,this.bottomRow.height+=e,b+=e),this.recordElemPositions_(d)}this.outputConnection&&this.block_.nextConnection&&this.block_.nextConnection.isConnected()&&(a=Math.max(a,this.block_.nextConnection.targetBlock().getHeightWidth().width-this.constants_.DARK_PATH_OFFSET)),this.bottomRow.baseline=b-this.bottomRow.descenderHeight,this.widthWithChildren=a+this.startX+this.constants_.DARK_PATH_OFFSET,this.width+=this.constants_.DARK_PATH_OFFSET,this.height=b+this.constants_.DARK_PATH_OFFSET,this.startY=this.topRow.capline};var module$exports$Blockly$geras$Renderer={Renderer:function(a){module$exports$Blockly$geras$Renderer.Renderer.superClass_.constructor.call(this,a),this.highlightConstants_=null}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$geras$Renderer.Renderer,module$exports$Blockly$blockRendering$Renderer.Renderer),module$exports$Blockly$geras$Renderer.Renderer.prototype.init=function(a,b){module$exports$Blockly$geras$Renderer.Renderer.superClass_.init.call(this,a,b),this.highlightConstants_=this.makeHighlightConstants_(),this.highlightConstants_.init()},module$exports$Blockly$geras$Renderer.Renderer.prototype.refreshDom=function(a,b){module$exports$Blockly$geras$Renderer.Renderer.superClass_.refreshDom.call(this,a,b),this.getHighlightConstants().init()},module$exports$Blockly$geras$Renderer.Renderer.prototype.makeConstants_=function(){return new module$exports$Blockly$geras$ConstantProvider.ConstantProvider},module$exports$Blockly$geras$Renderer.Renderer.prototype.makeRenderInfo_=function(a){return new module$exports$Blockly$geras$RenderInfo.RenderInfo(this,a)},module$exports$Blockly$geras$Renderer.Renderer.prototype.makeDrawer_=function(a,b){return new module$exports$Blockly$geras$Drawer.Drawer(a,b)},module$exports$Blockly$geras$Renderer.Renderer.prototype.makePathObject=function(a,b){return new module$exports$Blockly$geras$PathObject.PathObject(a,b,this.getConstants())},module$exports$Blockly$geras$Renderer.Renderer.prototype.makeHighlightConstants_=function(){return new module$exports$Blockly$geras$HighlightConstantProvider.HighlightConstantProvider(this.getConstants())},module$exports$Blockly$geras$Renderer.Renderer.prototype.getHighlightConstants=function(){return this.highlightConstants_},(0,module$exports$Blockly$blockRendering.register)("geras",module$exports$Blockly$geras$Renderer.Renderer);var module$exports$Blockly$geras={};module$exports$Blockly$geras.ConstantProvider=module$exports$Blockly$geras$ConstantProvider.ConstantProvider,module$exports$Blockly$geras.Drawer=module$exports$Blockly$geras$Drawer.Drawer,module$exports$Blockly$geras.HighlightConstantProvider=module$exports$Blockly$geras$HighlightConstantProvider.HighlightConstantProvider,module$exports$Blockly$geras.Highlighter=module$exports$Blockly$geras$Highlighter.Highlighter,module$exports$Blockly$geras.InlineInput=module$exports$Blockly$geras$InlineInput.InlineInput,module$exports$Blockly$geras.PathObject=module$exports$Blockly$geras$PathObject.PathObject,module$exports$Blockly$geras.RenderInfo=module$exports$Blockly$geras$RenderInfo.RenderInfo,module$exports$Blockly$geras.Renderer=module$exports$Blockly$geras$Renderer.Renderer,module$exports$Blockly$geras.StatementInput=module$exports$Blockly$geras$StatementInput.StatementInput;var module$exports$Blockly$Themes$Zelos={};module$exports$Blockly$Themes$Zelos.Zelos=new module$exports$Blockly$Theme.Theme("zelos",{colour_blocks:{colourPrimary:"#CF63CF",colourSecondary:"#C94FC9",colourTertiary:"#BD42BD"},list_blocks:{colourPrimary:"#9966FF",colourSecondary:"#855CD6",colourTertiary:"#774DCB"},logic_blocks:{colourPrimary:"#4C97FF",colourSecondary:"#4280D7",colourTertiary:"#3373CC"},loop_blocks:{colourPrimary:"#0fBD8C",colourSecondary:"#0DA57A",colourTertiary:"#0B8E69"},math_blocks:{colourPrimary:"#59C059",colourSecondary:"#46B946",colourTertiary:"#389438"},procedure_blocks:{colourPrimary:"#FF6680",colourSecondary:"#FF4D6A",colourTertiary:"#FF3355"},text_blocks:{colourPrimary:"#FFBF00",colourSecondary:"#E6AC00",colourTertiary:"#CC9900"},variable_blocks:{colourPrimary:"#FF8C1A",colourSecondary:"#FF8000",colourTertiary:"#DB6E00"},variable_dynamic_blocks:{colourPrimary:"#FF8C1A",colourSecondary:"#FF8000",colourTertiary:"#DB6E00"},hat_blocks:{colourPrimary:"#4C97FF",colourSecondary:"#4280D7",colourTertiary:"#3373CC",hat:"cap"}},{colour_category:{colour:"#CF63CF"},list_category:{colour:"#9966FF"},logic_category:{colour:"#4C97FF"},loop_category:{colour:"#0fBD8C"},math_category:{colour:"#59C059"},procedure_category:{colour:"#FF6680"},text_category:{colour:"#FFBF00"},variable_category:{colour:"#FF8C1A"},variable_dynamic_category:{colour:"#FF8C1A"}});var module$exports$Blockly$Themes={};module$exports$Blockly$Themes.Classic=module$exports$Blockly$Themes$Classic.Classic,module$exports$Blockly$Themes.Zelos=module$exports$Blockly$Themes$Zelos.Zelos;var module$exports$Blockly$ShortcutItems={names:{ESCAPE:"escape",DELETE:"delete",COPY:"copy",CUT:"cut",PASTE:"paste",UNDO:"undo",REDO:"redo"},registerEscape:function(){var a={name:module$exports$Blockly$ShortcutItems.names.ESCAPE,preconditionFn:function(b){return!b.options.readOnly},callback:function(b){return b.hideChaff(),!0}};module$exports$Blockly$ShortcutRegistry.ShortcutRegistry.registry.register(a),module$exports$Blockly$ShortcutRegistry.ShortcutRegistry.registry.addKeyMapping(module$exports$Blockly$utils$KeyCodes_KeyCodes.ESC,a.name)},registerDelete:function(){var a={name:module$exports$Blockly$ShortcutItems.names.DELETE,preconditionFn:function(b){var c=(0,$.module$exports$Blockly$common.getSelected)();return!b.options.readOnly&&c&&c.isDeletable()},callback:function(b,c){return c.preventDefault(),!module$exports$Blockly$Gesture.Gesture.inProgress()&&((0,$.module$exports$Blockly$common.getSelected)().checkAndDelete(),!0)}};module$exports$Blockly$ShortcutRegistry.ShortcutRegistry.registry.register(a),module$exports$Blockly$ShortcutRegistry.ShortcutRegistry.registry.addKeyMapping(module$exports$Blockly$utils$KeyCodes_KeyCodes.DELETE,a.name),module$exports$Blockly$ShortcutRegistry.ShortcutRegistry.registry.addKeyMapping(module$exports$Blockly$utils$KeyCodes_KeyCodes.BACKSPACE,a.name)},registerCopy:function(){var a={name:module$exports$Blockly$ShortcutItems.names.COPY,preconditionFn:function(c){var d=(0,$.module$exports$Blockly$common.getSelected)();return!c.options.readOnly&&!module$exports$Blockly$Gesture.Gesture.inProgress()&&d&&d.isDeletable()&&d.isMovable()},callback:function(c,d){return d.preventDefault(),c.hideChaff(),(0,module$exports$Blockly$clipboard.copy)((0,$.module$exports$Blockly$common.getSelected)()),!0}};module$exports$Blockly$ShortcutRegistry.ShortcutRegistry.registry.register(a);var b=module$exports$Blockly$ShortcutRegistry.ShortcutRegistry.registry.createSerializedKey(module$exports$Blockly$utils$KeyCodes_KeyCodes.C,[module$exports$Blockly$utils$KeyCodes_KeyCodes.CTRL]);module$exports$Blockly$ShortcutRegistry.ShortcutRegistry.registry.addKeyMapping(b,a.name),b=module$exports$Blockly$ShortcutRegistry.ShortcutRegistry.registry.createSerializedKey(module$exports$Blockly$utils$KeyCodes_KeyCodes.C,[module$exports$Blockly$utils$KeyCodes_KeyCodes.ALT]),module$exports$Blockly$ShortcutRegistry.ShortcutRegistry.registry.addKeyMapping(b,a.name),b=module$exports$Blockly$ShortcutRegistry.ShortcutRegistry.registry.createSerializedKey(module$exports$Blockly$utils$KeyCodes_KeyCodes.C,[module$exports$Blockly$utils$KeyCodes_KeyCodes.META]),module$exports$Blockly$ShortcutRegistry.ShortcutRegistry.registry.addKeyMapping(b,a.name)},registerCut:function(){var a={name:module$exports$Blockly$ShortcutItems.names.CUT,preconditionFn:function(c){var d=(0,$.module$exports$Blockly$common.getSelected)();return!c.options.readOnly&&!module$exports$Blockly$Gesture.Gesture.inProgress()&&d&&d.isDeletable()&&d.isMovable()&&!d.workspace.isFlyout},callback:function(){var c=(0,$.module$exports$Blockly$common.getSelected)();return!!c&&((0,module$exports$Blockly$clipboard.copy)(c),c.checkAndDelete(),!0)}};module$exports$Blockly$ShortcutRegistry.ShortcutRegistry.registry.register(a);var b=module$exports$Blockly$ShortcutRegistry.ShortcutRegistry.registry.createSerializedKey(module$exports$Blockly$utils$KeyCodes_KeyCodes.X,[module$exports$Blockly$utils$KeyCodes_KeyCodes.CTRL]);module$exports$Blockly$ShortcutRegistry.ShortcutRegistry.registry.addKeyMapping(b,a.name),b=module$exports$Blockly$ShortcutRegistry.ShortcutRegistry.registry.createSerializedKey(module$exports$Blockly$utils$KeyCodes_KeyCodes.X,[module$exports$Blockly$utils$KeyCodes_KeyCodes.ALT]),module$exports$Blockly$ShortcutRegistry.ShortcutRegistry.registry.addKeyMapping(b,a.name),b=module$exports$Blockly$ShortcutRegistry.ShortcutRegistry.registry.createSerializedKey(module$exports$Blockly$utils$KeyCodes_KeyCodes.X,[module$exports$Blockly$utils$KeyCodes_KeyCodes.META]),module$exports$Blockly$ShortcutRegistry.ShortcutRegistry.registry.addKeyMapping(b,a.name)},registerPaste:function(){var a={name:module$exports$Blockly$ShortcutItems.names.PASTE,preconditionFn:function(c){return!c.options.readOnly&&!module$exports$Blockly$Gesture.Gesture.inProgress()},callback:function(){return(0,module$exports$Blockly$clipboard.paste)()}};module$exports$Blockly$ShortcutRegistry.ShortcutRegistry.registry.register(a);var b=module$exports$Blockly$ShortcutRegistry.ShortcutRegistry.registry.createSerializedKey(module$exports$Blockly$utils$KeyCodes_KeyCodes.V,[module$exports$Blockly$utils$KeyCodes_KeyCodes.CTRL]);module$exports$Blockly$ShortcutRegistry.ShortcutRegistry.registry.addKeyMapping(b,a.name),b=module$exports$Blockly$ShortcutRegistry.ShortcutRegistry.registry.createSerializedKey(module$exports$Blockly$utils$KeyCodes_KeyCodes.V,[module$exports$Blockly$utils$KeyCodes_KeyCodes.ALT]),module$exports$Blockly$ShortcutRegistry.ShortcutRegistry.registry.addKeyMapping(b,a.name),b=module$exports$Blockly$ShortcutRegistry.ShortcutRegistry.registry.createSerializedKey(module$exports$Blockly$utils$KeyCodes_KeyCodes.V,[module$exports$Blockly$utils$KeyCodes_KeyCodes.META]),module$exports$Blockly$ShortcutRegistry.ShortcutRegistry.registry.addKeyMapping(b,a.name)},registerUndo:function(){var a={name:module$exports$Blockly$ShortcutItems.names.UNDO,preconditionFn:function(c){return!c.options.readOnly&&!module$exports$Blockly$Gesture.Gesture.inProgress()},callback:function(c){return c.hideChaff(),c.undo(!1),!0}};module$exports$Blockly$ShortcutRegistry.ShortcutRegistry.registry.register(a);var b=module$exports$Blockly$ShortcutRegistry.ShortcutRegistry.registry.createSerializedKey(module$exports$Blockly$utils$KeyCodes_KeyCodes.Z,[module$exports$Blockly$utils$KeyCodes_KeyCodes.CTRL]);module$exports$Blockly$ShortcutRegistry.ShortcutRegistry.registry.addKeyMapping(b,a.name),b=module$exports$Blockly$ShortcutRegistry.ShortcutRegistry.registry.createSerializedKey(module$exports$Blockly$utils$KeyCodes_KeyCodes.Z,[module$exports$Blockly$utils$KeyCodes_KeyCodes.ALT]),module$exports$Blockly$ShortcutRegistry.ShortcutRegistry.registry.addKeyMapping(b,a.name),b=module$exports$Blockly$ShortcutRegistry.ShortcutRegistry.registry.createSerializedKey(module$exports$Blockly$utils$KeyCodes_KeyCodes.Z,[module$exports$Blockly$utils$KeyCodes_KeyCodes.META]),module$exports$Blockly$ShortcutRegistry.ShortcutRegistry.registry.addKeyMapping(b,a.name)},registerRedo:function(){var a={name:module$exports$Blockly$ShortcutItems.names.REDO,preconditionFn:function(c){return!module$exports$Blockly$Gesture.Gesture.inProgress()&&!c.options.readOnly},callback:function(c){return c.hideChaff(),c.undo(!0),!0}};module$exports$Blockly$ShortcutRegistry.ShortcutRegistry.registry.register(a);var b=module$exports$Blockly$ShortcutRegistry.ShortcutRegistry.registry.createSerializedKey(module$exports$Blockly$utils$KeyCodes_KeyCodes.Z,[module$exports$Blockly$utils$KeyCodes_KeyCodes.SHIFT,module$exports$Blockly$utils$KeyCodes_KeyCodes.CTRL]);module$exports$Blockly$ShortcutRegistry.ShortcutRegistry.registry.addKeyMapping(b,a.name),b=module$exports$Blockly$ShortcutRegistry.ShortcutRegistry.registry.createSerializedKey(module$exports$Blockly$utils$KeyCodes_KeyCodes.Z,[module$exports$Blockly$utils$KeyCodes_KeyCodes.SHIFT,module$exports$Blockly$utils$KeyCodes_KeyCodes.ALT]),module$exports$Blockly$ShortcutRegistry.ShortcutRegistry.registry.addKeyMapping(b,a.name),b=module$exports$Blockly$ShortcutRegistry.ShortcutRegistry.registry.createSerializedKey(module$exports$Blockly$utils$KeyCodes_KeyCodes.Z,[module$exports$Blockly$utils$KeyCodes_KeyCodes.SHIFT,module$exports$Blockly$utils$KeyCodes_KeyCodes.META]),module$exports$Blockly$ShortcutRegistry.ShortcutRegistry.registry.addKeyMapping(b,a.name),b=module$exports$Blockly$ShortcutRegistry.ShortcutRegistry.registry.createSerializedKey(module$exports$Blockly$utils$KeyCodes_KeyCodes.Y,[module$exports$Blockly$utils$KeyCodes_KeyCodes.CTRL]),module$exports$Blockly$ShortcutRegistry.ShortcutRegistry.registry.addKeyMapping(b,a.name)},registerDefaultShortcuts:function(){(0,module$exports$Blockly$ShortcutItems.registerEscape)(),(0,module$exports$Blockly$ShortcutItems.registerDelete)(),(0,module$exports$Blockly$ShortcutItems.registerCopy)(),(0,module$exports$Blockly$ShortcutItems.registerCut)(),(0,module$exports$Blockly$ShortcutItems.registerPaste)(),(0,module$exports$Blockly$ShortcutItems.registerUndo)(),(0,module$exports$Blockly$ShortcutItems.registerRedo)()}};(0,module$exports$Blockly$ShortcutItems.registerDefaultShortcuts)();var module$exports$Blockly$Events$FinishedLoading={FinishedLoading:function(a){this.isBlank=void 0===a,this.workspaceId=a?a.id:"",this.group=(0,module$exports$Blockly$Events$utils.getGroup)(),this.recordUndo=!1}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$Events$FinishedLoading.FinishedLoading,module$exports$Blockly$Events$Abstract),module$exports$Blockly$Events$FinishedLoading.FinishedLoading.prototype.type=module$exports$Blockly$Events$utils.FINISHED_LOADING,module$exports$Blockly$Events$FinishedLoading.FinishedLoading.prototype.toJson=function(){var a={type:this.type};return this.group&&(a.group=this.group),this.workspaceId&&(a.workspaceId=this.workspaceId),a},module$exports$Blockly$Events$FinishedLoading.FinishedLoading.prototype.fromJson=function(a){this.isBlank=!1,this.workspaceId=a.workspaceId,this.group=a.group},(0,module$exports$Blockly$registry.register)(module$exports$Blockly$registry.Type.EVENT,module$exports$Blockly$Events$utils.FINISHED_LOADING,module$exports$Blockly$Events$FinishedLoading.FinishedLoading);var module$exports$Blockly$Events$Ui={Ui:function(a,b,c,d){module$exports$Blockly$Events$Ui.Ui.superClass_.constructor.call(this,a?a.workspace.id:void 0),this.blockId=a?a.id:null,this.element=void 0===b?"":b,this.oldValue=void 0===c?"":c,this.newValue=void 0===d?"":d}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$Events$Ui.Ui,module$exports$Blockly$Events$UiBase.UiBase),module$exports$Blockly$Events$Ui.Ui.prototype.type=module$exports$Blockly$Events$utils.UI,module$exports$Blockly$Events$Ui.Ui.prototype.toJson=function(){var a=module$exports$Blockly$Events$Ui.Ui.superClass_.toJson.call(this);return a.element=this.element,void 0!==this.newValue&&(a.newValue=this.newValue),this.blockId&&(a.blockId=this.blockId),a},module$exports$Blockly$Events$Ui.Ui.prototype.fromJson=function(a){module$exports$Blockly$Events$Ui.Ui.superClass_.fromJson.call(this,a),this.element=a.element,this.newValue=a.newValue,this.blockId=a.blockId},(0,module$exports$Blockly$registry.register)(module$exports$Blockly$registry.Type.EVENT,module$exports$Blockly$Events$utils.UI,module$exports$Blockly$Events$Ui.Ui);var module$exports$Blockly$Events$BubbleOpen={BubbleOpen:function(a,b,c){module$exports$Blockly$Events$BubbleOpen.BubbleOpen.superClass_.constructor.call(this,a?a.workspace.id:void 0),this.blockId=a?a.id:null,this.isOpen=b,this.bubbleType=c}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$Events$BubbleOpen.BubbleOpen,module$exports$Blockly$Events$UiBase.UiBase),module$exports$Blockly$Events$BubbleOpen.BubbleOpen.prototype.type=module$exports$Blockly$Events$utils.BUBBLE_OPEN,module$exports$Blockly$Events$BubbleOpen.BubbleOpen.prototype.toJson=function(){var a=module$exports$Blockly$Events$BubbleOpen.BubbleOpen.superClass_.toJson.call(this);return a.isOpen=this.isOpen,a.bubbleType=this.bubbleType,a.blockId=this.blockId,a},module$exports$Blockly$Events$BubbleOpen.BubbleOpen.prototype.fromJson=function(a){module$exports$Blockly$Events$BubbleOpen.BubbleOpen.superClass_.fromJson.call(this,a),this.isOpen=a.isOpen,this.bubbleType=a.bubbleType,this.blockId=a.blockId},(0,module$exports$Blockly$registry.register)(module$exports$Blockly$registry.Type.EVENT,module$exports$Blockly$Events$utils.BUBBLE_OPEN,module$exports$Blockly$Events$BubbleOpen.BubbleOpen);var module$exports$Blockly$Events$CommentChange={CommentChange:function(a,b,c){module$exports$Blockly$Events$CommentChange.CommentChange.superClass_.constructor.call(this,a),a&&(this.oldContents_=void 0===b?"":b,this.newContents_=void 0===c?"":c)}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$Events$CommentChange.CommentChange,module$exports$Blockly$Events$CommentBase.CommentBase),module$exports$Blockly$Events$CommentChange.CommentChange.prototype.type=module$exports$Blockly$Events$utils.COMMENT_CHANGE,module$exports$Blockly$Events$CommentChange.CommentChange.prototype.toJson=function(){var a=module$exports$Blockly$Events$CommentChange.CommentChange.superClass_.toJson.call(this);return a.oldContents=this.oldContents_,a.newContents=this.newContents_,a},module$exports$Blockly$Events$CommentChange.CommentChange.prototype.fromJson=function(a){module$exports$Blockly$Events$CommentChange.CommentChange.superClass_.fromJson.call(this,a),this.oldContents_=a.oldContents,this.newContents_=a.newContents},module$exports$Blockly$Events$CommentChange.CommentChange.prototype.isNull=function(){return this.oldContents_===this.newContents_},module$exports$Blockly$Events$CommentChange.CommentChange.prototype.run=function(a){var b=this.getEventWorkspace_().getCommentById(this.commentId);b?b.setContent(a?this.newContents_:this.oldContents_):console.warn("Can't change non-existent comment: "+this.commentId)},(0,module$exports$Blockly$registry.register)(module$exports$Blockly$registry.Type.EVENT,module$exports$Blockly$Events$utils.COMMENT_CHANGE,module$exports$Blockly$Events$CommentChange.CommentChange);var module$exports$Blockly$Events$CommentCreate={CommentCreate:function(a){module$exports$Blockly$Events$CommentCreate.CommentCreate.superClass_.constructor.call(this,a),a&&(this.xml=a.toXmlWithXY())}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$Events$CommentCreate.CommentCreate,module$exports$Blockly$Events$CommentBase.CommentBase),module$exports$Blockly$Events$CommentCreate.CommentCreate.prototype.type=module$exports$Blockly$Events$utils.COMMENT_CREATE,module$exports$Blockly$Events$CommentCreate.CommentCreate.prototype.toJson=function(){var a=module$exports$Blockly$Events$CommentCreate.CommentCreate.superClass_.toJson.call(this);return a.xml=(0,$.module$exports$Blockly$Xml.domToText)(this.xml),a},module$exports$Blockly$Events$CommentCreate.CommentCreate.prototype.fromJson=function(a){module$exports$Blockly$Events$CommentCreate.CommentCreate.superClass_.fromJson.call(this,a),this.xml=(0,$.module$exports$Blockly$Xml.textToDom)(a.xml)},module$exports$Blockly$Events$CommentCreate.CommentCreate.prototype.run=function(a){module$exports$Blockly$Events$CommentBase.CommentBase.CommentCreateDeleteHelper(this,a)},(0,module$exports$Blockly$registry.register)(module$exports$Blockly$registry.Type.EVENT,module$exports$Blockly$Events$utils.COMMENT_CREATE,module$exports$Blockly$Events$CommentCreate.CommentCreate);var module$exports$Blockly$Events$CommentDelete={CommentDelete:function(a){module$exports$Blockly$Events$CommentDelete.CommentDelete.superClass_.constructor.call(this,a),a&&(this.xml=a.toXmlWithXY())}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$Events$CommentDelete.CommentDelete,module$exports$Blockly$Events$CommentBase.CommentBase),module$exports$Blockly$Events$CommentDelete.CommentDelete.prototype.type=module$exports$Blockly$Events$utils.COMMENT_DELETE,module$exports$Blockly$Events$CommentDelete.CommentDelete.prototype.toJson=function(){return module$exports$Blockly$Events$CommentDelete.CommentDelete.superClass_.toJson.call(this)},module$exports$Blockly$Events$CommentDelete.CommentDelete.prototype.fromJson=function(a){module$exports$Blockly$Events$CommentDelete.CommentDelete.superClass_.fromJson.call(this,a)},module$exports$Blockly$Events$CommentDelete.CommentDelete.prototype.run=function(a){module$exports$Blockly$Events$CommentBase.CommentBase.CommentCreateDeleteHelper(this,!a)},(0,module$exports$Blockly$registry.register)(module$exports$Blockly$registry.Type.EVENT,module$exports$Blockly$Events$utils.COMMENT_DELETE,module$exports$Blockly$Events$CommentDelete.CommentDelete);var module$exports$Blockly$Events$TrashcanOpen={TrashcanOpen:function(a,b){module$exports$Blockly$Events$TrashcanOpen.TrashcanOpen.superClass_.constructor.call(this,b),this.isOpen=a}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$Events$TrashcanOpen.TrashcanOpen,module$exports$Blockly$Events$UiBase.UiBase),module$exports$Blockly$Events$TrashcanOpen.TrashcanOpen.prototype.type=module$exports$Blockly$Events$utils.TRASHCAN_OPEN,module$exports$Blockly$Events$TrashcanOpen.TrashcanOpen.prototype.toJson=function(){var a=module$exports$Blockly$Events$TrashcanOpen.TrashcanOpen.superClass_.toJson.call(this);return a.isOpen=this.isOpen,a},module$exports$Blockly$Events$TrashcanOpen.TrashcanOpen.prototype.fromJson=function(a){module$exports$Blockly$Events$TrashcanOpen.TrashcanOpen.superClass_.fromJson.call(this,a),this.isOpen=a.isOpen},(0,module$exports$Blockly$registry.register)(module$exports$Blockly$registry.Type.EVENT,module$exports$Blockly$Events$utils.TRASHCAN_OPEN,module$exports$Blockly$Events$TrashcanOpen.TrashcanOpen),$.module$exports$Blockly$Events={Abstract:module$exports$Blockly$Events$Abstract},$.module$exports$Blockly$Events.BubbleOpen=module$exports$Blockly$Events$BubbleOpen.BubbleOpen,$.module$exports$Blockly$Events.BlockBase=module$exports$Blockly$Events$BlockBase.BlockBase,$.module$exports$Blockly$Events.BlockChange=module$exports$Blockly$Events$BlockChange.BlockChange,$.module$exports$Blockly$Events.BlockCreate=module$exports$Blockly$Events$BlockCreate.BlockCreate,$.module$exports$Blockly$Events.BlockDelete=module$exports$Blockly$Events$BlockDelete.BlockDelete,$.module$exports$Blockly$Events.BlockDrag=module$exports$Blockly$Events$BlockDrag.BlockDrag,$.module$exports$Blockly$Events.BlockMove=module$exports$Blockly$Events$BlockMove.BlockMove,$.module$exports$Blockly$Events.Click=module$exports$Blockly$Events$Click.Click,$.module$exports$Blockly$Events.CommentBase=module$exports$Blockly$Events$CommentBase.CommentBase,$.module$exports$Blockly$Events.CommentChange=module$exports$Blockly$Events$CommentChange.CommentChange,$.module$exports$Blockly$Events.CommentCreate=module$exports$Blockly$Events$CommentCreate.CommentCreate,$.module$exports$Blockly$Events.CommentDelete=module$exports$Blockly$Events$CommentDelete.CommentDelete,$.module$exports$Blockly$Events.CommentMove=module$exports$Blockly$Events$CommentMove.CommentMove,$.module$exports$Blockly$Events.FinishedLoading=module$exports$Blockly$Events$FinishedLoading.FinishedLoading,$.module$exports$Blockly$Events.MarkerMove=module$exports$Blockly$Events$MarkerMove.MarkerMove,$.module$exports$Blockly$Events.Selected=module$exports$Blockly$Events$Selected.Selected,$.module$exports$Blockly$Events.ThemeChange=module$exports$Blockly$Events$ThemeChange.ThemeChange,$.module$exports$Blockly$Events.ToolboxItemSelect=module$exports$Blockly$Events$ToolboxItemSelect.ToolboxItemSelect,$.module$exports$Blockly$Events.TrashcanOpen=module$exports$Blockly$Events$TrashcanOpen.TrashcanOpen,$.module$exports$Blockly$Events.Ui=module$exports$Blockly$Events$Ui.Ui,$.module$exports$Blockly$Events.UiBase=module$exports$Blockly$Events$UiBase.UiBase,$.module$exports$Blockly$Events.VarBase=module$exports$Blockly$Events$VarBase.VarBase,$.module$exports$Blockly$Events.VarCreate=module$exports$Blockly$Events$VarCreate.VarCreate,$.module$exports$Blockly$Events.VarDelete=module$exports$Blockly$Events$VarDelete.VarDelete,$.module$exports$Blockly$Events.VarRename=module$exports$Blockly$Events$VarRename.VarRename,$.module$exports$Blockly$Events.ViewportChange=module$exports$Blockly$Events$ViewportChange.ViewportChange,$.module$exports$Blockly$Events.BLOCK_CHANGE=module$exports$Blockly$Events$utils.CHANGE,$.module$exports$Blockly$Events.BLOCK_CREATE=module$exports$Blockly$Events$utils.CREATE,$.module$exports$Blockly$Events.BLOCK_DELETE=module$exports$Blockly$Events$utils.DELETE,$.module$exports$Blockly$Events.BLOCK_DRAG=module$exports$Blockly$Events$utils.BLOCK_DRAG,$.module$exports$Blockly$Events.BLOCK_MOVE=module$exports$Blockly$Events$utils.MOVE,$.module$exports$Blockly$Events.BUBBLE_OPEN=module$exports$Blockly$Events$utils.BUBBLE_OPEN,$.module$exports$Blockly$Events.BumpEvent=module$exports$Blockly$Events$utils.BumpEvent,$.module$exports$Blockly$Events.BUMP_EVENTS=module$exports$Blockly$Events$utils.BUMP_EVENTS,$.module$exports$Blockly$Events.CHANGE=module$exports$Blockly$Events$utils.CHANGE,$.module$exports$Blockly$Events.CLICK=module$exports$Blockly$Events$utils.CLICK,$.module$exports$Blockly$Events.COMMENT_CHANGE=module$exports$Blockly$Events$utils.COMMENT_CHANGE,$.module$exports$Blockly$Events.COMMENT_CREATE=module$exports$Blockly$Events$utils.COMMENT_CREATE,$.module$exports$Blockly$Events.COMMENT_DELETE=module$exports$Blockly$Events$utils.COMMENT_DELETE,$.module$exports$Blockly$Events.COMMENT_MOVE=module$exports$Blockly$Events$utils.COMMENT_MOVE,$.module$exports$Blockly$Events.CREATE=module$exports$Blockly$Events$utils.CREATE,$.module$exports$Blockly$Events.DELETE=module$exports$Blockly$Events$utils.DELETE,$.module$exports$Blockly$Events.FINISHED_LOADING=module$exports$Blockly$Events$utils.FINISHED_LOADING,$.module$exports$Blockly$Events.MARKER_MOVE=module$exports$Blockly$Events$utils.MARKER_MOVE,$.module$exports$Blockly$Events.MOVE=module$exports$Blockly$Events$utils.MOVE,$.module$exports$Blockly$Events.SELECTED=module$exports$Blockly$Events$utils.SELECTED,$.module$exports$Blockly$Events.THEME_CHANGE=module$exports$Blockly$Events$utils.THEME_CHANGE,$.module$exports$Blockly$Events.TOOLBOX_ITEM_SELECT=module$exports$Blockly$Events$utils.TOOLBOX_ITEM_SELECT,$.module$exports$Blockly$Events.TRASHCAN_OPEN=module$exports$Blockly$Events$utils.TRASHCAN_OPEN,$.module$exports$Blockly$Events.UI=module$exports$Blockly$Events$utils.UI,$.module$exports$Blockly$Events.VAR_CREATE=module$exports$Blockly$Events$utils.VAR_CREATE,$.module$exports$Blockly$Events.VAR_DELETE=module$exports$Blockly$Events$utils.VAR_DELETE,$.module$exports$Blockly$Events.VAR_RENAME=module$exports$Blockly$Events$utils.VAR_RENAME,$.module$exports$Blockly$Events.VIEWPORT_CHANGE=module$exports$Blockly$Events$utils.VIEWPORT_CHANGE,$.module$exports$Blockly$Events.clearPendingUndo=module$exports$Blockly$Events$utils.clearPendingUndo,$.module$exports$Blockly$Events.disable=module$exports$Blockly$Events$utils.disable,$.module$exports$Blockly$Events.enable=module$exports$Blockly$Events$utils.enable,$.module$exports$Blockly$Events.filter=module$exports$Blockly$Events$utils.filter,$.module$exports$Blockly$Events.fire=module$exports$Blockly$Events$utils.fire,$.module$exports$Blockly$Events.fromJson=module$exports$Blockly$Events$utils.fromJson,$.module$exports$Blockly$Events.getDescendantIds=module$exports$Blockly$Events$utils.getDescendantIds,$.module$exports$Blockly$Events.get=module$exports$Blockly$Events$utils.get,$.module$exports$Blockly$Events.getGroup=module$exports$Blockly$Events$utils.getGroup,$.module$exports$Blockly$Events.getRecordUndo=module$exports$Blockly$Events$utils.getRecordUndo,$.module$exports$Blockly$Events.isEnabled=module$exports$Blockly$Events$utils.isEnabled,$.module$exports$Blockly$Events.setGroup=module$exports$Blockly$Events$utils.setGroup,$.module$exports$Blockly$Events.setRecordUndo=module$exports$Blockly$Events$utils.setRecordUndo,$.module$exports$Blockly$Events.disableOrphans=module$exports$Blockly$Events$utils.disableOrphans,Object.defineProperties($.module$exports$Blockly$Events,{recordUndo:{get:function(){return(0,module$exports$Blockly$utils$deprecation.warn)("Blockly.Events.recordUndo","September 2021","September 2022","Blockly.Events.getRecordUndo()"),(0,module$exports$Blockly$Events$utils.getRecordUndo)()},set:function(a){(0,module$exports$Blockly$utils$deprecation.warn)("Blockly.Events.recordUndo","September 2021","September 2022","Blockly.Events.setRecordUndo()"),(0,module$exports$Blockly$Events$utils.setRecordUndo)(a)}}});var module$exports$Blockly$ContextMenuItems={registerUndo:function(){module$exports$Blockly$ContextMenuRegistry.ContextMenuRegistry.registry.register({displayText:function(){return $.module$exports$Blockly$Msg.Msg.UNDO},preconditionFn:function(a){return 0<a.workspace.getUndoStack().length?"enabled":"disabled"},callback:function(a){a.workspace.undo(!1)},scopeType:module$exports$Blockly$ContextMenuRegistry.ContextMenuRegistry.ScopeType.WORKSPACE,id:"undoWorkspace",weight:1})},registerRedo:function(){module$exports$Blockly$ContextMenuRegistry.ContextMenuRegistry.registry.register({displayText:function(){return $.module$exports$Blockly$Msg.Msg.REDO},preconditionFn:function(a){return 0<a.workspace.getRedoStack().length?"enabled":"disabled"},callback:function(a){a.workspace.undo(!0)},scopeType:module$exports$Blockly$ContextMenuRegistry.ContextMenuRegistry.ScopeType.WORKSPACE,id:"redoWorkspace",weight:2})},registerCleanup:function(){module$exports$Blockly$ContextMenuRegistry.ContextMenuRegistry.registry.register({displayText:function(){return $.module$exports$Blockly$Msg.Msg.CLEAN_UP},preconditionFn:function(a){return a.workspace.isMovable()?1<a.workspace.getTopBlocks(!1).length?"enabled":"disabled":"hidden"},callback:function(a){a.workspace.cleanUp()},scopeType:module$exports$Blockly$ContextMenuRegistry.ContextMenuRegistry.ScopeType.WORKSPACE,id:"cleanWorkspace",weight:3})}},module$contents$Blockly$ContextMenuItems_toggleOption_=function(a,b){var c=0,d=0,e=function(h){d--,h.setCollapsed(a),0===d&&(0,$.module$exports$Blockly$Events.setGroup)(!1)};(0,$.module$exports$Blockly$Events.setGroup)(!0);for(var f=0;f<b.length;f++)for(var g=b[f];g;)d++,setTimeout(e.bind(null,g),c),g=g.getNextBlock(),c+=10};module$exports$Blockly$ContextMenuItems.registerCollapse=function(){module$exports$Blockly$ContextMenuRegistry.ContextMenuRegistry.registry.register({displayText:function(){return $.module$exports$Blockly$Msg.Msg.COLLAPSE_ALL},preconditionFn:function(a){if(a.workspace.options.collapse){a=a.workspace.getTopBlocks(!1);for(var b=0;b<a.length;b++)for(var c=a[b];c;){if(!c.isCollapsed())return"enabled";c=c.getNextBlock()}return"disabled"}return"hidden"},callback:function(a){module$contents$Blockly$ContextMenuItems_toggleOption_(!0,a.workspace.getTopBlocks(!0))},scopeType:module$exports$Blockly$ContextMenuRegistry.ContextMenuRegistry.ScopeType.WORKSPACE,id:"collapseWorkspace",weight:4})},module$exports$Blockly$ContextMenuItems.registerExpand=function(){module$exports$Blockly$ContextMenuRegistry.ContextMenuRegistry.registry.register({displayText:function(){return $.module$exports$Blockly$Msg.Msg.EXPAND_ALL},preconditionFn:function(a){if(a.workspace.options.collapse){a=a.workspace.getTopBlocks(!1);for(var b=0;b<a.length;b++)for(var c=a[b];c;){if(c.isCollapsed())return"enabled";c=c.getNextBlock()}return"disabled"}return"hidden"},callback:function(a){module$contents$Blockly$ContextMenuItems_toggleOption_(!1,a.workspace.getTopBlocks(!0))},scopeType:module$exports$Blockly$ContextMenuRegistry.ContextMenuRegistry.ScopeType.WORKSPACE,id:"expandWorkspace",weight:5})};var module$contents$Blockly$ContextMenuItems_addDeletableBlocks_=function(a,b){if(a.isDeletable())Array.prototype.push.apply(b,a.getDescendants(!1));else{a=a.getChildren(!1);for(var c=0;c<a.length;c++)module$contents$Blockly$ContextMenuItems_addDeletableBlocks_(a[c],b)}},module$contents$Blockly$ContextMenuItems_getDeletableBlocks_=function(a){var b=[];a=a.getTopBlocks(!0);for(var c=0;c<a.length;c++)module$contents$Blockly$ContextMenuItems_addDeletableBlocks_(a[c],b);return b},module$contents$Blockly$ContextMenuItems_deleteNext_=function(a,b){(0,module$exports$Blockly$Events$utils.setGroup)(b);var c=a.shift();c&&(c.workspace?(c.dispose(!1,!0),setTimeout(module$contents$Blockly$ContextMenuItems_deleteNext_,10,a,b)):module$contents$Blockly$ContextMenuItems_deleteNext_(a,b)),(0,module$exports$Blockly$Events$utils.setGroup)(!1)};module$exports$Blockly$ContextMenuItems.registerDeleteAll=function(){module$exports$Blockly$ContextMenuRegistry.ContextMenuRegistry.registry.register({displayText:function(a){if(a.workspace)return 1===(a=module$contents$Blockly$ContextMenuItems_getDeletableBlocks_(a.workspace).length)?$.module$exports$Blockly$Msg.Msg.DELETE_BLOCK:$.module$exports$Blockly$Msg.Msg.DELETE_X_BLOCKS.replace("%1",String(a))},preconditionFn:function(a){if(a.workspace)return 0<module$contents$Blockly$ContextMenuItems_getDeletableBlocks_(a.workspace).length?"enabled":"disabled"},callback:function(a){if(a.workspace){a.workspace.cancelCurrentGesture();var b=module$contents$Blockly$ContextMenuItems_getDeletableBlocks_(a.workspace),c=(0,module$exports$Blockly$utils$idGenerator.genUid)();2>b.length?module$contents$Blockly$ContextMenuItems_deleteNext_(b,c):(0,module$exports$Blockly$dialog.confirm)($.module$exports$Blockly$Msg.Msg.DELETE_ALL_BLOCKS.replace("%1",String(b.length)),(function(d){d&&module$contents$Blockly$ContextMenuItems_deleteNext_(b,c)}))}},scopeType:module$exports$Blockly$ContextMenuRegistry.ContextMenuRegistry.ScopeType.WORKSPACE,id:"workspaceDelete",weight:6})},module$exports$Blockly$ContextMenuItems.registerDuplicate=function(){module$exports$Blockly$ContextMenuRegistry.ContextMenuRegistry.registry.register({displayText:function(){return $.module$exports$Blockly$Msg.Msg.DUPLICATE_BLOCK},preconditionFn:function(a){return!(a=a.block).isInFlyout&&a.isDeletable()&&a.isMovable()?a.isDuplicatable()?"enabled":"disabled":"hidden"},callback:function(a){a.block&&(0,module$exports$Blockly$clipboard.duplicate)(a.block)},scopeType:module$exports$Blockly$ContextMenuRegistry.ContextMenuRegistry.ScopeType.BLOCK,id:"blockDuplicate",weight:1})},module$exports$Blockly$ContextMenuItems.registerComment=function(){module$exports$Blockly$ContextMenuRegistry.ContextMenuRegistry.registry.register({displayText:function(a){return a.block.getCommentIcon()?$.module$exports$Blockly$Msg.Msg.REMOVE_COMMENT:$.module$exports$Blockly$Msg.Msg.ADD_COMMENT},preconditionFn:function(a){return a=a.block,module$exports$Blockly$utils$userAgent.IE||a.isInFlyout||!a.workspace.options.comments||a.isCollapsed()||!a.isEditable()?"hidden":"enabled"},callback:function(a){(a=a.block).getCommentIcon()?a.setCommentText(null):a.setCommentText("")},scopeType:module$exports$Blockly$ContextMenuRegistry.ContextMenuRegistry.ScopeType.BLOCK,id:"blockComment",weight:2})},module$exports$Blockly$ContextMenuItems.registerInline=function(){module$exports$Blockly$ContextMenuRegistry.ContextMenuRegistry.registry.register({displayText:function(a){return a.block.getInputsInline()?$.module$exports$Blockly$Msg.Msg.EXTERNAL_INPUTS:$.module$exports$Blockly$Msg.Msg.INLINE_INPUTS},preconditionFn:function(a){if(!(a=a.block).isInFlyout&&a.isMovable()&&!a.isCollapsed())for(var b=1;b<a.inputList.length;b++)if(a.inputList[b-1].type!==$.module$exports$Blockly$inputTypes.inputTypes.STATEMENT&&a.inputList[b].type!==$.module$exports$Blockly$inputTypes.inputTypes.STATEMENT)return"enabled";return"hidden"},callback:function(a){a.block.setInputsInline(!a.block.getInputsInline())},scopeType:module$exports$Blockly$ContextMenuRegistry.ContextMenuRegistry.ScopeType.BLOCK,id:"blockInline",weight:3})},module$exports$Blockly$ContextMenuItems.registerCollapseExpandBlock=function(){module$exports$Blockly$ContextMenuRegistry.ContextMenuRegistry.registry.register({displayText:function(a){return a.block.isCollapsed()?$.module$exports$Blockly$Msg.Msg.EXPAND_BLOCK:$.module$exports$Blockly$Msg.Msg.COLLAPSE_BLOCK},preconditionFn:function(a){return!(a=a.block).isInFlyout&&a.isMovable()&&a.workspace.options.collapse?"enabled":"hidden"},callback:function(a){a.block.setCollapsed(!a.block.isCollapsed())},scopeType:module$exports$Blockly$ContextMenuRegistry.ContextMenuRegistry.ScopeType.BLOCK,id:"blockCollapseExpand",weight:4})},module$exports$Blockly$ContextMenuItems.registerDisable=function(){module$exports$Blockly$ContextMenuRegistry.ContextMenuRegistry.registry.register({displayText:function(a){return a.block.isEnabled()?$.module$exports$Blockly$Msg.Msg.DISABLE_BLOCK:$.module$exports$Blockly$Msg.Msg.ENABLE_BLOCK},preconditionFn:function(a){return!(a=a.block).isInFlyout&&a.workspace.options.disable&&a.isEditable()?a.getInheritedDisabled()?"disabled":"enabled":"hidden"},callback:function(a){a=a.block;var b=(0,module$exports$Blockly$Events$utils.getGroup)();b||(0,module$exports$Blockly$Events$utils.setGroup)(!0),a.setEnabled(!a.isEnabled()),b||(0,module$exports$Blockly$Events$utils.setGroup)(!1)},scopeType:module$exports$Blockly$ContextMenuRegistry.ContextMenuRegistry.ScopeType.BLOCK,id:"blockDisable",weight:5})},module$exports$Blockly$ContextMenuItems.registerDelete=function(){module$exports$Blockly$ContextMenuRegistry.ContextMenuRegistry.registry.register({displayText:function(a){var b=a.block;return a=b.getDescendants(!1).length,(b=b.getNextBlock())&&(a-=b.getDescendants(!1).length),1===a?$.module$exports$Blockly$Msg.Msg.DELETE_BLOCK:$.module$exports$Blockly$Msg.Msg.DELETE_X_BLOCKS.replace("%1",String(a))},preconditionFn:function(a){return!a.block.isInFlyout&&a.block.isDeletable()?"enabled":"hidden"},callback:function(a){a.block&&a.block.checkAndDelete()},scopeType:module$exports$Blockly$ContextMenuRegistry.ContextMenuRegistry.ScopeType.BLOCK,id:"blockDelete",weight:6})},module$exports$Blockly$ContextMenuItems.registerHelp=function(){module$exports$Blockly$ContextMenuRegistry.ContextMenuRegistry.registry.register({displayText:function(){return $.module$exports$Blockly$Msg.Msg.HELP},preconditionFn:function(a){return("function"==typeof(a=a.block).helpUrl?a.helpUrl():a.helpUrl)?"enabled":"hidden"},callback:function(a){a.block.showHelp()},scopeType:module$exports$Blockly$ContextMenuRegistry.ContextMenuRegistry.ScopeType.BLOCK,id:"blockHelp",weight:7})},module$exports$Blockly$ContextMenuItems.registerDefaultOptions=function(){(0,module$exports$Blockly$ContextMenuItems.registerUndo)(),(0,module$exports$Blockly$ContextMenuItems.registerRedo)(),(0,module$exports$Blockly$ContextMenuItems.registerCleanup)(),(0,module$exports$Blockly$ContextMenuItems.registerCollapse)(),(0,module$exports$Blockly$ContextMenuItems.registerExpand)(),(0,module$exports$Blockly$ContextMenuItems.registerDeleteAll)(),(0,module$exports$Blockly$ContextMenuItems.registerDuplicate)(),(0,module$exports$Blockly$ContextMenuItems.registerComment)(),(0,module$exports$Blockly$ContextMenuItems.registerInline)(),(0,module$exports$Blockly$ContextMenuItems.registerCollapseExpandBlock)(),(0,module$exports$Blockly$ContextMenuItems.registerDisable)(),(0,module$exports$Blockly$ContextMenuItems.registerDelete)(),(0,module$exports$Blockly$ContextMenuItems.registerHelp)()},(0,module$exports$Blockly$ContextMenuItems.registerDefaultOptions)();var module$exports$Blockly$Icon={Icon:function(a){this.block_=a,this.iconGroup_=null}};module$exports$Blockly$Icon.Icon.prototype.collapseHidden=!0,module$exports$Blockly$Icon.Icon.prototype.SIZE=17,module$exports$Blockly$Icon.Icon.prototype.bubble_=null,module$exports$Blockly$Icon.Icon.prototype.iconXY_=null,module$exports$Blockly$Icon.Icon.prototype.createIcon=function(){this.iconGroup_||(this.iconGroup_=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.G,{class:"blocklyIconGroup"},null),this.block_.isInFlyout&&(0,module$exports$Blockly$utils$dom.addClass)(this.iconGroup_,"blocklyIconGroupReadonly"),this.drawIcon_(this.iconGroup_),this.block_.getSvgRoot().appendChild(this.iconGroup_),(0,module$exports$Blockly$browserEvents.conditionalBind)(this.iconGroup_,"mouseup",this,this.iconClick_),this.updateEditable())},module$exports$Blockly$Icon.Icon.prototype.dispose=function(){(0,module$exports$Blockly$utils$dom.removeNode)(this.iconGroup_),this.iconGroup_=null,this.setVisible(!1),this.block_=null},module$exports$Blockly$Icon.Icon.prototype.updateEditable=function(){},module$exports$Blockly$Icon.Icon.prototype.isVisible=function(){return!!this.bubble_},module$exports$Blockly$Icon.Icon.prototype.iconClick_=function(a){this.block_.workspace.isDragging()||this.block_.isInFlyout||(0,module$exports$Blockly$browserEvents.isRightButton)(a)||this.setVisible(!this.isVisible())},module$exports$Blockly$Icon.Icon.prototype.applyColour=function(){this.isVisible()&&this.bubble_.setColour(this.block_.style.colourPrimary)},module$exports$Blockly$Icon.Icon.prototype.setIconLocation=function(a){this.iconXY_=a,this.isVisible()&&this.bubble_.setAnchorLocation(a)},module$exports$Blockly$Icon.Icon.prototype.computeIconLocation=function(){var a=this.block_.getRelativeToSurfaceXY(),b=(0,module$exports$Blockly$utils$svgMath.getRelativeXY)(this.iconGroup_);a=new module$exports$Blockly$utils$Coordinate.Coordinate(a.x+b.x+this.SIZE/2,a.y+b.y+this.SIZE/2),module$exports$Blockly$utils$Coordinate.Coordinate.equals(this.getIconLocation(),a)||this.setIconLocation(a)},module$exports$Blockly$Icon.Icon.prototype.getIconLocation=function(){return this.iconXY_},module$exports$Blockly$Icon.Icon.prototype.getCorrectedSize=function(){return new module$exports$Blockly$utils$Size.Size(module$exports$Blockly$Icon.Icon.prototype.SIZE,module$exports$Blockly$Icon.Icon.prototype.SIZE-2)};var module$exports$Blockly$Warning={Warning:function(a){module$exports$Blockly$Warning.Warning.superClass_.constructor.call(this,a),this.createIcon(),this.text_=Object.create(null)}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$Warning.Warning,module$exports$Blockly$Icon.Icon),module$exports$Blockly$Warning.Warning.prototype.collapseHidden=!1,module$exports$Blockly$Warning.Warning.prototype.drawIcon_=function(a){(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.PATH,{class:"blocklyIconShape",d:"M2,15Q-1,15 0.5,12L6.5,1.7Q8,-1 9.5,1.7L15.5,12Q17,15 14,15z"},a),(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.PATH,{class:"blocklyIconSymbol",d:"m7,4.8v3.16l0.27,2.27h1.46l0.27,-2.27v-3.16z"},a),(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.RECT,{class:"blocklyIconSymbol",x:"7",y:"11",height:"2",width:"2"},a)},module$exports$Blockly$Warning.Warning.prototype.setVisible=function(a){a!==this.isVisible()&&((0,module$exports$Blockly$Events$utils.fire)(new((0,module$exports$Blockly$Events$utils.get)(module$exports$Blockly$Events$utils.BUBBLE_OPEN))(this.block_,a,"warning")),a?this.createBubble_():this.disposeBubble_())},module$exports$Blockly$Warning.Warning.prototype.createBubble_=function(){this.paragraphElement_=module$exports$Blockly$Bubble.Bubble.textToDom(this.getText()),this.bubble_=module$exports$Blockly$Bubble.Bubble.createNonEditableBubble(this.paragraphElement_,this.block_,this.iconXY_),this.applyColour()},module$exports$Blockly$Warning.Warning.prototype.disposeBubble_=function(){this.bubble_.dispose(),this.paragraphElement_=this.bubble_=null},module$exports$Blockly$Warning.Warning.prototype.setText=function(a,b){this.text_[b]!==a&&(a?this.text_[b]=a:delete this.text_[b],this.isVisible()&&(this.setVisible(!1),this.setVisible(!0)))},module$exports$Blockly$Warning.Warning.prototype.getText=function(){var b,a=[];for(b in this.text_)a.push(this.text_[b]);return a.join("\n")},module$exports$Blockly$Warning.Warning.prototype.dispose=function(){this.block_.warning=null,module$exports$Blockly$Icon.Icon.prototype.dispose.call(this)};var module$exports$Blockly$Comment={Comment:function(a){module$exports$Blockly$Comment.Comment.superClass_.constructor.call(this,a),this.model_=a.commentModel,this.model_.text=this.model_.text||"",this.cachedText_="",this.onInputWrapper_=this.onChangeWrapper_=this.onWheelWrapper_=this.onMouseUpWrapper_=null,this.createIcon()}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$Comment.Comment,module$exports$Blockly$Icon.Icon),module$exports$Blockly$Comment.Comment.prototype.drawIcon_=function(a){(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.CIRCLE,{class:"blocklyIconShape",r:"8",cx:"8",cy:"8"},a),(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.PATH,{class:"blocklyIconSymbol",d:"m6.8,10h2c0.003,-0.617 0.271,-0.962 0.633,-1.266 2.875,-2.4050.607,-5.534 -3.765,-3.874v1.7c3.12,-1.657 3.698,0.118 2.336,1.25-1.201,0.998 -1.201,1.528 -1.204,2.19z"},a),(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.RECT,{class:"blocklyIconSymbol",x:"6.8",y:"10.78",height:"2",width:"2"},a)},module$exports$Blockly$Comment.Comment.prototype.createEditor_=function(){this.foreignObject_=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.FOREIGNOBJECT,{x:module$exports$Blockly$Bubble.Bubble.BORDER_WIDTH,y:module$exports$Blockly$Bubble.Bubble.BORDER_WIDTH},null);var a=document.createElementNS(module$exports$Blockly$utils$dom.HTML_NS,"body");a.setAttribute("xmlns",module$exports$Blockly$utils$dom.HTML_NS),a.className="blocklyMinimalBody";var b=this.textarea_=document.createElementNS(module$exports$Blockly$utils$dom.HTML_NS,"textarea");return b.className="blocklyCommentTextarea",b.setAttribute("dir",this.block_.RTL?"RTL":"LTR"),b.value=this.model_.text,this.resizeTextarea_(),a.appendChild(b),this.foreignObject_.appendChild(a),this.onMouseUpWrapper_=(0,module$exports$Blockly$browserEvents.conditionalBind)(b,"mouseup",this,this.startEdit_,!0,!0),this.onWheelWrapper_=(0,module$exports$Blockly$browserEvents.conditionalBind)(b,"wheel",this,(function(c){c.stopPropagation()})),this.onChangeWrapper_=(0,module$exports$Blockly$browserEvents.conditionalBind)(b,"change",this,(function(c){this.cachedText_!==this.model_.text&&(0,module$exports$Blockly$Events$utils.fire)(new((0,module$exports$Blockly$Events$utils.get)(module$exports$Blockly$Events$utils.CHANGE))(this.block_,"comment",null,this.cachedText_,this.model_.text))})),this.onInputWrapper_=(0,module$exports$Blockly$browserEvents.conditionalBind)(b,"input",this,(function(c){this.model_.text=b.value})),setTimeout(b.focus.bind(b),0),this.foreignObject_},module$exports$Blockly$Comment.Comment.prototype.updateEditable=function(){module$exports$Blockly$Comment.Comment.superClass_.updateEditable.call(this),this.isVisible()&&(this.disposeBubble_(),this.createBubble_())},module$exports$Blockly$Comment.Comment.prototype.onBubbleResize_=function(){this.isVisible()&&(this.model_.size=this.bubble_.getBubbleSize(),this.resizeTextarea_())},module$exports$Blockly$Comment.Comment.prototype.resizeTextarea_=function(){var a=this.model_.size,b=2*module$exports$Blockly$Bubble.Bubble.BORDER_WIDTH,c=a.width-b;a=a.height-b,this.foreignObject_.setAttribute("width",c),this.foreignObject_.setAttribute("height",a),this.textarea_.style.width=c-4+"px",this.textarea_.style.height=a-4+"px"},module$exports$Blockly$Comment.Comment.prototype.setVisible=function(a){a!==this.isVisible()&&((0,module$exports$Blockly$Events$utils.fire)(new((0,module$exports$Blockly$Events$utils.get)(module$exports$Blockly$Events$utils.BUBBLE_OPEN))(this.block_,a,"comment")),(this.model_.pinned=a)?this.createBubble_():this.disposeBubble_())},module$exports$Blockly$Comment.Comment.prototype.createBubble_=function(){!this.block_.isEditable()||module$exports$Blockly$utils$userAgent.IE?this.createNonEditableBubble_():this.createEditableBubble_()},module$exports$Blockly$Comment.Comment.prototype.createEditableBubble_=function(){this.bubble_=new module$exports$Blockly$Bubble.Bubble(this.block_.workspace,this.createEditor_(),this.block_.pathObject.svgPath,this.iconXY_,this.model_.size.width,this.model_.size.height),this.bubble_.setSvgId(this.block_.id),this.bubble_.registerResizeEvent(this.onBubbleResize_.bind(this)),this.applyColour()},module$exports$Blockly$Comment.Comment.prototype.createNonEditableBubble_=function(){this.paragraphElement_=module$exports$Blockly$Bubble.Bubble.textToDom(this.block_.getCommentText()),this.bubble_=module$exports$Blockly$Bubble.Bubble.createNonEditableBubble(this.paragraphElement_,this.block_,this.iconXY_),this.applyColour()},module$exports$Blockly$Comment.Comment.prototype.disposeBubble_=function(){this.onMouseUpWrapper_&&((0,module$exports$Blockly$browserEvents.unbind)(this.onMouseUpWrapper_),this.onMouseUpWrapper_=null),this.onWheelWrapper_&&((0,module$exports$Blockly$browserEvents.unbind)(this.onWheelWrapper_),this.onWheelWrapper_=null),this.onChangeWrapper_&&((0,module$exports$Blockly$browserEvents.unbind)(this.onChangeWrapper_),this.onChangeWrapper_=null),this.onInputWrapper_&&((0,module$exports$Blockly$browserEvents.unbind)(this.onInputWrapper_),this.onInputWrapper_=null),this.bubble_.dispose(),this.paragraphElement_=this.foreignObject_=this.textarea_=this.bubble_=null},module$exports$Blockly$Comment.Comment.prototype.startEdit_=function(a){this.bubble_.promote()&&this.textarea_.focus(),this.cachedText_=this.model_.text},module$exports$Blockly$Comment.Comment.prototype.getBubbleSize=function(){return this.model_.size},module$exports$Blockly$Comment.Comment.prototype.setBubbleSize=function(a,b){this.bubble_?this.bubble_.setBubbleSize(a,b):(this.model_.size.width=a,this.model_.size.height=b)},module$exports$Blockly$Comment.Comment.prototype.updateText=function(){this.textarea_?this.textarea_.value=this.model_.text:this.paragraphElement_&&(this.paragraphElement_.firstChild.textContent=this.model_.text)},module$exports$Blockly$Comment.Comment.prototype.dispose=function(){this.block_.comment=null,module$exports$Blockly$Icon.Icon.prototype.dispose.call(this)},(0,module$exports$Blockly$Css.register)("\n  .blocklyCommentTextarea {\n    background-color: #fef49c;\n    border: 0;\n    display: block;\n    margin: 0;\n    outline: 0;\n    padding: 3px;\n    resize: none;\n    text-overflow: hidden;\n  }\n");var module$exports$Blockly$uiPosition={verticalPosition:{TOP:0,BOTTOM:1},horizontalPosition:{LEFT:0,RIGHT:1},bumpDirection:{UP:0,DOWN:1},getStartPositionRect:function(a,b,c,d,e,f){var g=f.scrollbar&&f.scrollbar.canScrollVertically();return a.horizontal===module$exports$Blockly$uiPosition.horizontalPosition.LEFT?(c=e.absoluteMetrics.left+c,g&&f.RTL&&(c+=module$exports$Blockly$Scrollbar.Scrollbar.scrollbarThickness)):(c=e.absoluteMetrics.left+e.viewMetrics.width-b.width-c,g&&!f.RTL&&(c-=module$exports$Blockly$Scrollbar.Scrollbar.scrollbarThickness)),a.vertical===module$exports$Blockly$uiPosition.verticalPosition.TOP?a=e.absoluteMetrics.top+d:(a=e.absoluteMetrics.top+e.viewMetrics.height-b.height-d,f.scrollbar&&f.scrollbar.canScrollHorizontally()&&(a-=module$exports$Blockly$Scrollbar.Scrollbar.scrollbarThickness)),new module$exports$Blockly$utils$Rect.Rect(a,a+b.height,c,c+b.width)},getCornerOppositeToolbox:function(a,b){return{horizontal:b.toolboxMetrics.position===module$exports$Blockly$utils$toolbox.Position.LEFT||a.horizontalLayout&&!a.RTL?module$exports$Blockly$uiPosition.horizontalPosition.RIGHT:module$exports$Blockly$uiPosition.horizontalPosition.LEFT,vertical:b.toolboxMetrics.position===module$exports$Blockly$utils$toolbox.Position.BOTTOM?module$exports$Blockly$uiPosition.verticalPosition.TOP:module$exports$Blockly$uiPosition.verticalPosition.BOTTOM}},bumpPositionRect:function(a,b,c,d){for(var e=a.left,f=a.right-a.left,g=a.bottom-a.top,h=0;h<d.length;h++){var k=d[h];a.intersects(k)&&(a=c===module$exports$Blockly$uiPosition.bumpDirection.UP?k.top-g-b:k.bottom+b,a=new module$exports$Blockly$utils$Rect.Rect(a,a+g,e,e+f),h=-1)}return a}},module$exports$Blockly$ZoomControls={ZoomControls:function(a){this.workspace_=a,this.id="zoomControls",this.zoomResetGroup_=this.zoomOutGroup_=this.zoomInGroup_=this.onZoomOutWrapper_=this.onZoomInWrapper_=this.onZoomResetWrapper_=null}};module$exports$Blockly$ZoomControls.ZoomControls.prototype.WIDTH_=32,module$exports$Blockly$ZoomControls.ZoomControls.prototype.HEIGHT_=32,module$exports$Blockly$ZoomControls.ZoomControls.prototype.SMALL_SPACING_=2,module$exports$Blockly$ZoomControls.ZoomControls.prototype.LARGE_SPACING_=11,module$exports$Blockly$ZoomControls.ZoomControls.prototype.MARGIN_VERTICAL_=20,module$exports$Blockly$ZoomControls.ZoomControls.prototype.MARGIN_HORIZONTAL_=20,module$exports$Blockly$ZoomControls.ZoomControls.prototype.svgGroup_=null,module$exports$Blockly$ZoomControls.ZoomControls.prototype.left_=0,module$exports$Blockly$ZoomControls.ZoomControls.prototype.top_=0,module$exports$Blockly$ZoomControls.ZoomControls.prototype.initialized_=!1,module$exports$Blockly$ZoomControls.ZoomControls.prototype.createDom=function(){this.svgGroup_=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.G,{},null);var a=String(Math.random()).substring(2);return this.createZoomOutSvg_(a),this.createZoomInSvg_(a),this.workspace_.isMovable()&&this.createZoomResetSvg_(a),this.svgGroup_},module$exports$Blockly$ZoomControls.ZoomControls.prototype.init=function(){this.workspace_.getComponentManager().addComponent({component:this,weight:2,capabilities:[module$exports$Blockly$ComponentManager.ComponentManager.Capability.POSITIONABLE]}),this.initialized_=!0},module$exports$Blockly$ZoomControls.ZoomControls.prototype.dispose=function(){this.workspace_.getComponentManager().removeComponent("zoomControls"),this.svgGroup_&&(0,module$exports$Blockly$utils$dom.removeNode)(this.svgGroup_),this.onZoomResetWrapper_&&(0,module$exports$Blockly$browserEvents.unbind)(this.onZoomResetWrapper_),this.onZoomInWrapper_&&(0,module$exports$Blockly$browserEvents.unbind)(this.onZoomInWrapper_),this.onZoomOutWrapper_&&(0,module$exports$Blockly$browserEvents.unbind)(this.onZoomOutWrapper_)},module$exports$Blockly$ZoomControls.ZoomControls.prototype.getBoundingRectangle=function(){var a=this.SMALL_SPACING_+2*this.HEIGHT_;return this.zoomResetGroup_&&(a+=this.LARGE_SPACING_+this.HEIGHT_),new module$exports$Blockly$utils$Rect.Rect(this.top_,this.top_+a,this.left_,this.left_+this.WIDTH_)},module$exports$Blockly$ZoomControls.ZoomControls.prototype.position=function(a,b){if(this.initialized_){var c=(0,module$exports$Blockly$uiPosition.getCornerOppositeToolbox)(this.workspace_,a),d=this.SMALL_SPACING_+2*this.HEIGHT_;this.zoomResetGroup_&&(d+=this.LARGE_SPACING_+this.HEIGHT_),a=(0,module$exports$Blockly$uiPosition.getStartPositionRect)(c,new module$exports$Blockly$utils$Size.Size(this.WIDTH_,d),this.MARGIN_HORIZONTAL_,this.MARGIN_VERTICAL_,a,this.workspace_),c=c.vertical,b=(0,module$exports$Blockly$uiPosition.bumpPositionRect)(a,this.MARGIN_VERTICAL_,c===module$exports$Blockly$uiPosition.verticalPosition.TOP?module$exports$Blockly$uiPosition.bumpDirection.DOWN:module$exports$Blockly$uiPosition.bumpDirection.UP,b),c===module$exports$Blockly$uiPosition.verticalPosition.TOP?(c=this.SMALL_SPACING_+this.HEIGHT_,this.zoomInGroup_.setAttribute("transform","translate(0, "+c+")"),this.zoomResetGroup_&&this.zoomResetGroup_.setAttribute("transform","translate(0, "+(c+this.LARGE_SPACING_+this.HEIGHT_)+")")):(c=this.zoomResetGroup_?this.LARGE_SPACING_+this.HEIGHT_:0,this.zoomInGroup_.setAttribute("transform","translate(0, "+c+")"),this.zoomOutGroup_.setAttribute("transform","translate(0, "+(c+this.SMALL_SPACING_+this.HEIGHT_)+")")),this.top_=b.top,this.left_=b.left,this.svgGroup_.setAttribute("transform","translate("+this.left_+","+this.top_+")")}},module$exports$Blockly$ZoomControls.ZoomControls.prototype.createZoomOutSvg_=function(a){this.zoomOutGroup_=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.G,{class:"blocklyZoom"},this.svgGroup_);var b=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.CLIPPATH,{id:"blocklyZoomoutClipPath"+a},this.zoomOutGroup_);(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.RECT,{width:32,height:32},b),(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.IMAGE,{width:$.module$exports$Blockly$internalConstants.SPRITE.width,height:$.module$exports$Blockly$internalConstants.SPRITE.height,x:-64,y:-92,"clip-path":"url(#blocklyZoomoutClipPath"+a+")"},this.zoomOutGroup_).setAttributeNS(module$exports$Blockly$utils$dom.XLINK_NS,"xlink:href",this.workspace_.options.pathToMedia+$.module$exports$Blockly$internalConstants.SPRITE.url),this.onZoomOutWrapper_=(0,module$exports$Blockly$browserEvents.conditionalBind)(this.zoomOutGroup_,"mousedown",null,this.zoom_.bind(this,-1))},module$exports$Blockly$ZoomControls.ZoomControls.prototype.createZoomInSvg_=function(a){this.zoomInGroup_=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.G,{class:"blocklyZoom"},this.svgGroup_);var b=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.CLIPPATH,{id:"blocklyZoominClipPath"+a},this.zoomInGroup_);(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.RECT,{width:32,height:32},b),(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.IMAGE,{width:$.module$exports$Blockly$internalConstants.SPRITE.width,height:$.module$exports$Blockly$internalConstants.SPRITE.height,x:-32,y:-92,"clip-path":"url(#blocklyZoominClipPath"+a+")"},this.zoomInGroup_).setAttributeNS(module$exports$Blockly$utils$dom.XLINK_NS,"xlink:href",this.workspace_.options.pathToMedia+$.module$exports$Blockly$internalConstants.SPRITE.url),this.onZoomInWrapper_=(0,module$exports$Blockly$browserEvents.conditionalBind)(this.zoomInGroup_,"mousedown",null,this.zoom_.bind(this,1))},module$exports$Blockly$ZoomControls.ZoomControls.prototype.zoom_=function(a,b){this.workspace_.markFocused(),this.workspace_.zoomCenter(a),this.fireZoomEvent_(),(0,module$exports$Blockly$Touch.clearTouchIdentifier)(),b.stopPropagation(),b.preventDefault()},module$exports$Blockly$ZoomControls.ZoomControls.prototype.createZoomResetSvg_=function(a){this.zoomResetGroup_=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.G,{class:"blocklyZoom"},this.svgGroup_);var b=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.CLIPPATH,{id:"blocklyZoomresetClipPath"+a},this.zoomResetGroup_);(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.RECT,{width:32,height:32},b),(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.IMAGE,{width:$.module$exports$Blockly$internalConstants.SPRITE.width,height:$.module$exports$Blockly$internalConstants.SPRITE.height,y:-92,"clip-path":"url(#blocklyZoomresetClipPath"+a+")"},this.zoomResetGroup_).setAttributeNS(module$exports$Blockly$utils$dom.XLINK_NS,"xlink:href",this.workspace_.options.pathToMedia+$.module$exports$Blockly$internalConstants.SPRITE.url),this.onZoomResetWrapper_=(0,module$exports$Blockly$browserEvents.conditionalBind)(this.zoomResetGroup_,"mousedown",null,this.resetZoom_.bind(this))},module$exports$Blockly$ZoomControls.ZoomControls.prototype.resetZoom_=function(a){this.workspace_.markFocused();var b=Math.log(this.workspace_.options.zoomOptions.startScale/this.workspace_.scale)/Math.log(this.workspace_.options.zoomOptions.scaleSpeed);this.workspace_.beginCanvasTransition(),this.workspace_.zoomCenter(b),this.workspace_.scrollCenter(),setTimeout(this.workspace_.endCanvasTransition.bind(this.workspace_),500),this.fireZoomEvent_(),(0,module$exports$Blockly$Touch.clearTouchIdentifier)(),a.stopPropagation(),a.preventDefault()},module$exports$Blockly$ZoomControls.ZoomControls.prototype.fireZoomEvent_=function(){var a=new((0,module$exports$Blockly$Events$utils.get)(module$exports$Blockly$Events$utils.CLICK))(null,this.workspace_.id,"zoom_controls");(0,module$exports$Blockly$Events$utils.fire)(a)},(0,module$exports$Blockly$Css.register)("\n  .blocklyZoom>image, .blocklyZoom>svg>image {\n    opacity: .4;\n  }\n\n  .blocklyZoom>image:hover, .blocklyZoom>svg>image:hover {\n    opacity: .6;\n  }\n\n  .blocklyZoom>image:active, .blocklyZoom>svg>image:active {\n    opacity: .8;\n  }\n");var module$exports$Blockly$WorkspaceComment={WorkspaceComment:function(a,b,c,d,e){this.id=e&&!a.getCommentById(e)?e:(0,module$exports$Blockly$utils$idGenerator.genUid)(),a.addTopComment(this),this.xy_=new module$exports$Blockly$utils$Coordinate.Coordinate(0,0),this.height_=c,this.width_=d,this.workspace=a,this.RTL=a.RTL,this.editable_=this.movable_=this.deletable_=!0,this.content_=b,this.disposed_=!1,this.isComment=!0,module$exports$Blockly$WorkspaceComment.WorkspaceComment.fireCreateEvent(this)}};module$exports$Blockly$WorkspaceComment.WorkspaceComment.prototype.dispose=function(){this.disposed_||((0,module$exports$Blockly$Events$utils.isEnabled)()&&(0,module$exports$Blockly$Events$utils.fire)(new((0,module$exports$Blockly$Events$utils.get)(module$exports$Blockly$Events$utils.COMMENT_DELETE))(this)),this.workspace.removeTopComment(this),this.disposed_=!0)},module$exports$Blockly$WorkspaceComment.WorkspaceComment.prototype.getHeight=function(){return this.height_},module$exports$Blockly$WorkspaceComment.WorkspaceComment.prototype.setHeight=function(a){this.height_=a},module$exports$Blockly$WorkspaceComment.WorkspaceComment.prototype.getWidth=function(){return this.width_},module$exports$Blockly$WorkspaceComment.WorkspaceComment.prototype.setWidth=function(a){this.width_=a},module$exports$Blockly$WorkspaceComment.WorkspaceComment.prototype.getXY=function(){return new module$exports$Blockly$utils$Coordinate.Coordinate(this.xy_.x,this.xy_.y)},module$exports$Blockly$WorkspaceComment.WorkspaceComment.prototype.moveBy=function(a,b){var c=new((0,module$exports$Blockly$Events$utils.get)(module$exports$Blockly$Events$utils.COMMENT_MOVE))(this);this.xy_.translate(a,b),c.recordNew(),(0,module$exports$Blockly$Events$utils.fire)(c)},module$exports$Blockly$WorkspaceComment.WorkspaceComment.prototype.isDeletable=function(){return this.deletable_&&!(this.workspace&&this.workspace.options.readOnly)},module$exports$Blockly$WorkspaceComment.WorkspaceComment.prototype.setDeletable=function(a){this.deletable_=a},module$exports$Blockly$WorkspaceComment.WorkspaceComment.prototype.isMovable=function(){return this.movable_&&!(this.workspace&&this.workspace.options.readOnly)},module$exports$Blockly$WorkspaceComment.WorkspaceComment.prototype.setMovable=function(a){this.movable_=a},module$exports$Blockly$WorkspaceComment.WorkspaceComment.prototype.isEditable=function(){return this.editable_&&!(this.workspace&&this.workspace.options.readOnly)},module$exports$Blockly$WorkspaceComment.WorkspaceComment.prototype.setEditable=function(a){this.editable_=a},module$exports$Blockly$WorkspaceComment.WorkspaceComment.prototype.getContent=function(){return this.content_},module$exports$Blockly$WorkspaceComment.WorkspaceComment.prototype.setContent=function(a){this.content_!==a&&((0,module$exports$Blockly$Events$utils.fire)(new((0,module$exports$Blockly$Events$utils.get)(module$exports$Blockly$Events$utils.COMMENT_CHANGE))(this,this.content_,a)),this.content_=a)},module$exports$Blockly$WorkspaceComment.WorkspaceComment.prototype.toXmlWithXY=function(a){return(a=this.toXml(a)).setAttribute("x",Math.round(this.xy_.x)),a.setAttribute("y",Math.round(this.xy_.y)),a.setAttribute("h",this.height_),a.setAttribute("w",this.width_),a},module$exports$Blockly$WorkspaceComment.WorkspaceComment.prototype.toXml=function(a){var b=(0,$.module$exports$Blockly$utils$xml.createElement)("comment");return a||(b.id=this.id),b.textContent=this.getContent(),b},module$exports$Blockly$WorkspaceComment.WorkspaceComment.fireCreateEvent=function(a){if((0,module$exports$Blockly$Events$utils.isEnabled)()){var b=(0,module$exports$Blockly$Events$utils.getGroup)();b||(0,module$exports$Blockly$Events$utils.setGroup)(!0);try{(0,module$exports$Blockly$Events$utils.fire)(new((0,module$exports$Blockly$Events$utils.get)(module$exports$Blockly$Events$utils.COMMENT_CREATE))(a))}finally{b||(0,module$exports$Blockly$Events$utils.setGroup)(!1)}}},module$exports$Blockly$WorkspaceComment.WorkspaceComment.fromXml=function(a,b){var c=module$exports$Blockly$WorkspaceComment.WorkspaceComment.parseAttributes(a);return b=new module$exports$Blockly$WorkspaceComment.WorkspaceComment(b,c.content,c.h,c.w,c.id),c=parseInt(a.getAttribute("x"),10),a=parseInt(a.getAttribute("y"),10),isNaN(c)||isNaN(a)||b.moveBy(c,a),module$exports$Blockly$WorkspaceComment.WorkspaceComment.fireCreateEvent(b),b},module$exports$Blockly$WorkspaceComment.WorkspaceComment.parseAttributes=function(a){var b=a.getAttribute("h"),c=a.getAttribute("w");return{id:a.getAttribute("id"),h:b?parseInt(b,10):100,w:c?parseInt(c,10):100,x:parseInt(a.getAttribute("x"),10),y:parseInt(a.getAttribute("y"),10),content:a.textContent}};var module$exports$Blockly$WorkspaceCommentSvg={WorkspaceCommentSvg:function(a,b,c,d,e){this.onMouseMoveWrapper_=this.onMouseUpWrapper_=null,this.svgGroup_=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.G,{class:"blocklyComment"},null),this.svgGroup_.translate_="",this.svgRect_=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.RECT,{class:"blocklyCommentRect",x:0,y:0,rx:3,ry:3}),this.svgGroup_.appendChild(this.svgRect_),this.rendered_=!1,this.useDragSurface_=(0,module$exports$Blockly$utils$svgMath.is3dSupported)()&&!!a.getBlockDragSurface(),module$exports$Blockly$WorkspaceCommentSvg.WorkspaceCommentSvg.superClass_.constructor.call(this,a,b,c,d,e),this.render()}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$WorkspaceCommentSvg.WorkspaceCommentSvg,module$exports$Blockly$WorkspaceComment.WorkspaceComment),module$exports$Blockly$WorkspaceCommentSvg.WorkspaceCommentSvg.DEFAULT_SIZE=100,module$exports$Blockly$WorkspaceCommentSvg.WorkspaceCommentSvg.TOP_OFFSET=10,module$exports$Blockly$WorkspaceCommentSvg.WorkspaceCommentSvg.prototype.dispose=function(){this.disposed_||((0,$.module$exports$Blockly$common.getSelected)()===this&&(this.unselect(),this.workspace.cancelCurrentGesture()),(0,module$exports$Blockly$Events$utils.isEnabled)()&&(0,module$exports$Blockly$Events$utils.fire)(new((0,module$exports$Blockly$Events$utils.get)(module$exports$Blockly$Events$utils.COMMENT_DELETE))(this)),(0,module$exports$Blockly$utils$dom.removeNode)(this.svgGroup_),this.disposeInternal_(),(0,module$exports$Blockly$Events$utils.disable)(),module$exports$Blockly$WorkspaceCommentSvg.WorkspaceCommentSvg.superClass_.dispose.call(this),(0,module$exports$Blockly$Events$utils.enable)())},module$exports$Blockly$WorkspaceCommentSvg.WorkspaceCommentSvg.prototype.initSvg=function(a){if(!this.workspace.rendered)throw TypeError("Workspace is headless.");this.workspace.options.readOnly||this.eventsInit_||((0,module$exports$Blockly$browserEvents.conditionalBind)(this.svgRectTarget_,"mousedown",this,this.pathMouseDown_),(0,module$exports$Blockly$browserEvents.conditionalBind)(this.svgHandleTarget_,"mousedown",this,this.pathMouseDown_)),this.eventsInit_=!0,this.updateMovable(),this.getSvgRoot().parentNode||this.workspace.getBubbleCanvas().appendChild(this.getSvgRoot()),!a&&this.textarea_&&this.textarea_.select()},module$exports$Blockly$WorkspaceCommentSvg.WorkspaceCommentSvg.prototype.pathMouseDown_=function(a){var b=this.workspace.getGesture(a);b&&b.handleBubbleStart(a,this)},module$exports$Blockly$WorkspaceCommentSvg.WorkspaceCommentSvg.prototype.showContextMenu=function(a){if(!this.workspace.options.readOnly){var b=[];this.isDeletable()&&this.isMovable()&&(b.push((0,$.module$exports$Blockly$ContextMenu.commentDuplicateOption)(this)),b.push((0,$.module$exports$Blockly$ContextMenu.commentDeleteOption)(this))),(0,$.module$exports$Blockly$ContextMenu.show)(a,b,this.RTL)}},module$exports$Blockly$WorkspaceCommentSvg.WorkspaceCommentSvg.prototype.select=function(){if((0,$.module$exports$Blockly$common.getSelected)()!==this){var a=null;if((0,$.module$exports$Blockly$common.getSelected)()){a=(0,$.module$exports$Blockly$common.getSelected)().id,(0,module$exports$Blockly$Events$utils.disable)();try{(0,$.module$exports$Blockly$common.getSelected)().unselect()}finally{(0,module$exports$Blockly$Events$utils.enable)()}}a=new((0,module$exports$Blockly$Events$utils.get)(module$exports$Blockly$Events$utils.SELECTED))(a,this.id,this.workspace.id),(0,module$exports$Blockly$Events$utils.fire)(a),(0,$.module$exports$Blockly$common.setSelected)(this),this.addSelect()}},module$exports$Blockly$WorkspaceCommentSvg.WorkspaceCommentSvg.prototype.unselect=function(){if((0,$.module$exports$Blockly$common.getSelected)()===this){var a=new((0,module$exports$Blockly$Events$utils.get)(module$exports$Blockly$Events$utils.SELECTED))(this.id,null,this.workspace.id);(0,module$exports$Blockly$Events$utils.fire)(a),(0,$.module$exports$Blockly$common.setSelected)(null),this.removeSelect(),this.blurFocus()}},module$exports$Blockly$WorkspaceCommentSvg.WorkspaceCommentSvg.prototype.addSelect=function(){(0,module$exports$Blockly$utils$dom.addClass)(this.svgGroup_,"blocklySelected"),this.setFocus()},module$exports$Blockly$WorkspaceCommentSvg.WorkspaceCommentSvg.prototype.removeSelect=function(){(0,module$exports$Blockly$utils$dom.removeClass)(this.svgGroup_,"blocklySelected"),this.blurFocus()},module$exports$Blockly$WorkspaceCommentSvg.WorkspaceCommentSvg.prototype.addFocus=function(){(0,module$exports$Blockly$utils$dom.addClass)(this.svgGroup_,"blocklyFocused")},module$exports$Blockly$WorkspaceCommentSvg.WorkspaceCommentSvg.prototype.removeFocus=function(){(0,module$exports$Blockly$utils$dom.removeClass)(this.svgGroup_,"blocklyFocused")},module$exports$Blockly$WorkspaceCommentSvg.WorkspaceCommentSvg.prototype.getRelativeToSurfaceXY=function(){var a=0,b=0,c=this.useDragSurface_?this.workspace.getBlockDragSurface().getGroup():null,d=this.getSvgRoot();if(d)do{var e=(0,module$exports$Blockly$utils$svgMath.getRelativeXY)(d);a+=e.x,b+=e.y,this.useDragSurface_&&this.workspace.getBlockDragSurface().getCurrentBlock()===d&&(a+=(e=this.workspace.getBlockDragSurface().getSurfaceTranslation()).x,b+=e.y),d=d.parentNode}while(d&&d!==this.workspace.getBubbleCanvas()&&d!==c);return this.xy_=new module$exports$Blockly$utils$Coordinate.Coordinate(a,b)},module$exports$Blockly$WorkspaceCommentSvg.WorkspaceCommentSvg.prototype.moveBy=function(a,b){var c=new((0,module$exports$Blockly$Events$utils.get)(module$exports$Blockly$Events$utils.COMMENT_MOVE))(this),d=this.getRelativeToSurfaceXY();this.translate(d.x+a,d.y+b),this.xy_=new module$exports$Blockly$utils$Coordinate.Coordinate(d.x+a,d.y+b),c.recordNew(),(0,module$exports$Blockly$Events$utils.fire)(c),this.workspace.resizeContents()},module$exports$Blockly$WorkspaceCommentSvg.WorkspaceCommentSvg.prototype.translate=function(a,b){this.xy_=new module$exports$Blockly$utils$Coordinate.Coordinate(a,b),this.getSvgRoot().setAttribute("transform","translate("+a+","+b+")")},module$exports$Blockly$WorkspaceCommentSvg.WorkspaceCommentSvg.prototype.moveToDragSurface=function(){if(this.useDragSurface_){var a=this.getRelativeToSurfaceXY();this.clearTransformAttributes_(),this.workspace.getBlockDragSurface().translateSurface(a.x,a.y),this.workspace.getBlockDragSurface().setBlocksAndShow(this.getSvgRoot())}},module$exports$Blockly$WorkspaceCommentSvg.WorkspaceCommentSvg.prototype.moveDuringDrag=function(a,b){a?a.translateSurface(b.x,b.y):(this.svgGroup_.translate_="translate("+b.x+","+b.y+")",this.svgGroup_.setAttribute("transform",this.svgGroup_.translate_+this.svgGroup_.skew_))},module$exports$Blockly$WorkspaceCommentSvg.WorkspaceCommentSvg.prototype.moveTo=function(a,b){this.translate(a,b)},module$exports$Blockly$WorkspaceCommentSvg.WorkspaceCommentSvg.prototype.clearTransformAttributes_=function(){this.getSvgRoot().removeAttribute("transform")},module$exports$Blockly$WorkspaceCommentSvg.WorkspaceCommentSvg.prototype.getBoundingRectangle=function(){var a=this.getRelativeToSurfaceXY(),b=this.getHeightWidth(),c=a.y,d=a.y+b.height;if(this.RTL){var e=a.x-b.width;a=a.x}else e=a.x,a=a.x+b.width;return new module$exports$Blockly$utils$Rect.Rect(c,d,e,a)},module$exports$Blockly$WorkspaceCommentSvg.WorkspaceCommentSvg.prototype.updateMovable=function(){this.isMovable()?(0,module$exports$Blockly$utils$dom.addClass)(this.svgGroup_,"blocklyDraggable"):(0,module$exports$Blockly$utils$dom.removeClass)(this.svgGroup_,"blocklyDraggable")},module$exports$Blockly$WorkspaceCommentSvg.WorkspaceCommentSvg.prototype.setMovable=function(a){module$exports$Blockly$WorkspaceCommentSvg.WorkspaceCommentSvg.superClass_.setMovable.call(this,a),this.updateMovable()},module$exports$Blockly$WorkspaceCommentSvg.WorkspaceCommentSvg.prototype.setEditable=function(a){module$exports$Blockly$WorkspaceCommentSvg.WorkspaceCommentSvg.superClass_.setEditable.call(this,a),this.textarea_&&(this.textarea_.readOnly=!a)},module$exports$Blockly$WorkspaceCommentSvg.WorkspaceCommentSvg.prototype.setDragging=function(a){a?((a=this.getSvgRoot()).translate_="",a.skew_="",(0,module$exports$Blockly$utils$dom.addClass)(this.svgGroup_,"blocklyDragging")):(0,module$exports$Blockly$utils$dom.removeClass)(this.svgGroup_,"blocklyDragging")},module$exports$Blockly$WorkspaceCommentSvg.WorkspaceCommentSvg.prototype.getSvgRoot=function(){return this.svgGroup_},module$exports$Blockly$WorkspaceCommentSvg.WorkspaceCommentSvg.prototype.getContent=function(){return this.textarea_?this.textarea_.value:this.content_},module$exports$Blockly$WorkspaceCommentSvg.WorkspaceCommentSvg.prototype.setContent=function(a){module$exports$Blockly$WorkspaceCommentSvg.WorkspaceCommentSvg.superClass_.setContent.call(this,a),this.textarea_&&(this.textarea_.value=a)},module$exports$Blockly$WorkspaceCommentSvg.WorkspaceCommentSvg.prototype.setDeleteStyle=function(a){a?(0,module$exports$Blockly$utils$dom.addClass)(this.svgGroup_,"blocklyDraggingDelete"):(0,module$exports$Blockly$utils$dom.removeClass)(this.svgGroup_,"blocklyDraggingDelete")},module$exports$Blockly$WorkspaceCommentSvg.WorkspaceCommentSvg.prototype.setAutoLayout=function(a){},module$exports$Blockly$WorkspaceCommentSvg.WorkspaceCommentSvg.fromXml=function(a,b,c){(0,module$exports$Blockly$Events$utils.disable)();try{var d=module$exports$Blockly$WorkspaceComment.WorkspaceComment.parseAttributes(a),e=new module$exports$Blockly$WorkspaceCommentSvg.WorkspaceCommentSvg(b,d.content,d.h,d.w,d.id);if(b.rendered&&(e.initSvg(!0),e.render()),!isNaN(d.x)&&!isNaN(d.y))if(b.RTL){var f=c||b.getWidth();e.moveBy(f-d.x,d.y)}else e.moveBy(d.x,d.y)}finally{(0,module$exports$Blockly$Events$utils.enable)()}return module$exports$Blockly$WorkspaceComment.WorkspaceComment.fireCreateEvent(e),e},module$exports$Blockly$WorkspaceCommentSvg.WorkspaceCommentSvg.prototype.toXmlWithXY=function(a){var b;this.workspace.RTL&&(b=this.workspace.getWidth()),a=this.toXml(a);var c=this.getRelativeToSurfaceXY();return a.setAttribute("x",Math.round(this.workspace.RTL?b-c.x:c.x)),a.setAttribute("y",Math.round(c.y)),a.setAttribute("h",this.getHeight()),a.setAttribute("w",this.getWidth()),a},module$exports$Blockly$WorkspaceCommentSvg.WorkspaceCommentSvg.prototype.toCopyData=function(){return{saveInfo:this.toXmlWithXY(),source:this.workspace,typeCounts:null}},module$exports$Blockly$WorkspaceCommentSvg.WorkspaceCommentSvg.prototype.getHeightWidth=function(){return{width:this.getWidth(),height:this.getHeight()}},module$exports$Blockly$WorkspaceCommentSvg.WorkspaceCommentSvg.prototype.render=function(){if(!this.rendered_){var a=this.getHeightWidth();this.createEditor_(),this.svgGroup_.appendChild(this.foreignObject_),this.svgHandleTarget_=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.RECT,{class:"blocklyCommentHandleTarget",x:0,y:0}),this.svgGroup_.appendChild(this.svgHandleTarget_),this.svgRectTarget_=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.RECT,{class:"blocklyCommentTarget",x:0,y:0,rx:3,ry:3}),this.svgGroup_.appendChild(this.svgRectTarget_),this.addResizeDom_(),this.isDeletable()&&this.addDeleteDom_(),this.setSize_(a.width,a.height),this.textarea_.value=this.content_,this.rendered_=!0,this.resizeGroup_&&(0,module$exports$Blockly$browserEvents.conditionalBind)(this.resizeGroup_,"mousedown",this,this.resizeMouseDown_),this.isDeletable()&&((0,module$exports$Blockly$browserEvents.conditionalBind)(this.deleteGroup_,"mousedown",this,this.deleteMouseDown_),(0,module$exports$Blockly$browserEvents.conditionalBind)(this.deleteGroup_,"mouseout",this,this.deleteMouseOut_),(0,module$exports$Blockly$browserEvents.conditionalBind)(this.deleteGroup_,"mouseup",this,this.deleteMouseUp_))}},module$exports$Blockly$WorkspaceCommentSvg.WorkspaceCommentSvg.prototype.createEditor_=function(){this.foreignObject_=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.FOREIGNOBJECT,{x:0,y:module$exports$Blockly$WorkspaceCommentSvg.WorkspaceCommentSvg.TOP_OFFSET,class:"blocklyCommentForeignObject"},null);var a=document.createElementNS(module$exports$Blockly$utils$dom.HTML_NS,"body");a.setAttribute("xmlns",module$exports$Blockly$utils$dom.HTML_NS),a.className="blocklyMinimalBody";var b=document.createElementNS(module$exports$Blockly$utils$dom.HTML_NS,"textarea");return b.className="blocklyCommentTextarea",b.setAttribute("dir",this.RTL?"RTL":"LTR"),b.readOnly=!this.isEditable(),a.appendChild(b),this.textarea_=b,this.foreignObject_.appendChild(a),(0,module$exports$Blockly$browserEvents.conditionalBind)(b,"wheel",this,(function(c){c.stopPropagation()})),(0,module$exports$Blockly$browserEvents.conditionalBind)(b,"change",this,(function(c){this.setContent(b.value)})),this.foreignObject_},module$exports$Blockly$WorkspaceCommentSvg.WorkspaceCommentSvg.prototype.addResizeDom_=function(){this.resizeGroup_=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.G,{class:this.RTL?"blocklyResizeSW":"blocklyResizeSE"},this.svgGroup_),(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.POLYGON,{points:"0,x x,x x,0".replace(/x/g,8..toString())},this.resizeGroup_),(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.LINE,{class:"blocklyResizeLine",x1:8/3,y1:7,x2:7,y2:8/3},this.resizeGroup_),(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.LINE,{class:"blocklyResizeLine",x1:16/3,y1:7,x2:7,y2:16/3},this.resizeGroup_)},module$exports$Blockly$WorkspaceCommentSvg.WorkspaceCommentSvg.prototype.addDeleteDom_=function(){this.deleteGroup_=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.G,{class:"blocklyCommentDeleteIcon"},this.svgGroup_),this.deleteIconBorder_=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.CIRCLE,{class:"blocklyDeleteIconShape",r:"7",cx:"7.5",cy:"7.5"},this.deleteGroup_),(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.LINE,{x1:"5",y1:"10",x2:"10",y2:"5",stroke:"#fff","stroke-width":"2"},this.deleteGroup_),(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.LINE,{x1:"5",y1:"5",x2:"10",y2:"10",stroke:"#fff","stroke-width":"2"},this.deleteGroup_)},module$exports$Blockly$WorkspaceCommentSvg.WorkspaceCommentSvg.prototype.resizeMouseDown_=function(a){this.unbindDragEvents_(),(0,module$exports$Blockly$browserEvents.isRightButton)(a)||(this.workspace.startDrag(a,new module$exports$Blockly$utils$Coordinate.Coordinate(this.workspace.RTL?-this.width_:this.width_,this.height_)),this.onMouseUpWrapper_=(0,module$exports$Blockly$browserEvents.conditionalBind)(document,"mouseup",this,this.resizeMouseUp_),this.onMouseMoveWrapper_=(0,module$exports$Blockly$browserEvents.conditionalBind)(document,"mousemove",this,this.resizeMouseMove_),this.workspace.hideChaff()),a.stopPropagation()},module$exports$Blockly$WorkspaceCommentSvg.WorkspaceCommentSvg.prototype.deleteMouseDown_=function(a){(0,module$exports$Blockly$utils$dom.addClass)(this.deleteIconBorder_,"blocklyDeleteIconHighlighted"),a.stopPropagation()},module$exports$Blockly$WorkspaceCommentSvg.WorkspaceCommentSvg.prototype.deleteMouseOut_=function(a){(0,module$exports$Blockly$utils$dom.removeClass)(this.deleteIconBorder_,"blocklyDeleteIconHighlighted")},module$exports$Blockly$WorkspaceCommentSvg.WorkspaceCommentSvg.prototype.deleteMouseUp_=function(a){this.dispose(),a.stopPropagation()},module$exports$Blockly$WorkspaceCommentSvg.WorkspaceCommentSvg.prototype.unbindDragEvents_=function(){this.onMouseUpWrapper_&&((0,module$exports$Blockly$browserEvents.unbind)(this.onMouseUpWrapper_),this.onMouseUpWrapper_=null),this.onMouseMoveWrapper_&&((0,module$exports$Blockly$browserEvents.unbind)(this.onMouseMoveWrapper_),this.onMouseMoveWrapper_=null)},module$exports$Blockly$WorkspaceCommentSvg.WorkspaceCommentSvg.prototype.resizeMouseUp_=function(a){(0,module$exports$Blockly$Touch.clearTouchIdentifier)(),this.unbindDragEvents_()},module$exports$Blockly$WorkspaceCommentSvg.WorkspaceCommentSvg.prototype.resizeMouseMove_=function(a){this.autoLayout_=!1,a=this.workspace.moveDrag(a),this.setSize_(this.RTL?-a.x:a.x,a.y)},module$exports$Blockly$WorkspaceCommentSvg.WorkspaceCommentSvg.prototype.resizeComment_=function(){var a=this.getHeightWidth(),b=module$exports$Blockly$WorkspaceCommentSvg.WorkspaceCommentSvg.TOP_OFFSET;this.foreignObject_.setAttribute("width",a.width),this.foreignObject_.setAttribute("height",a.height-b),this.RTL&&this.foreignObject_.setAttribute("x",-a.width),this.textarea_.style.width=a.width-4+"px",this.textarea_.style.height=a.height-4-b+"px"},module$exports$Blockly$WorkspaceCommentSvg.WorkspaceCommentSvg.prototype.setSize_=function(a,b){a=Math.max(a,45),b=Math.max(b,20+module$exports$Blockly$WorkspaceCommentSvg.WorkspaceCommentSvg.TOP_OFFSET),this.width_=a,this.height_=b,this.svgRect_.setAttribute("width",a),this.svgRect_.setAttribute("height",b),this.svgRectTarget_.setAttribute("width",a),this.svgRectTarget_.setAttribute("height",b),this.svgHandleTarget_.setAttribute("width",a),this.svgHandleTarget_.setAttribute("height",module$exports$Blockly$WorkspaceCommentSvg.WorkspaceCommentSvg.TOP_OFFSET),this.RTL&&(this.svgRect_.setAttribute("transform","scale(-1 1)"),this.svgRectTarget_.setAttribute("transform","scale(-1 1)")),this.resizeGroup_&&(this.RTL?(this.resizeGroup_.setAttribute("transform","translate("+(8-a)+","+(b-8)+") scale(-1 1)"),this.deleteGroup_.setAttribute("transform","translate("+(8-a)+",-8) scale(-1 1)")):(this.resizeGroup_.setAttribute("transform","translate("+(a-8)+","+(b-8)+")"),this.deleteGroup_.setAttribute("transform","translate("+(a-8)+",-8)"))),this.resizeComment_()},module$exports$Blockly$WorkspaceCommentSvg.WorkspaceCommentSvg.prototype.disposeInternal_=function(){this.svgHandleTarget_=this.svgRectTarget_=this.foreignObject_=this.textarea_=null,this.disposed_=!0},module$exports$Blockly$WorkspaceCommentSvg.WorkspaceCommentSvg.prototype.setFocus=function(){var a=this;this.focused_=!0,setTimeout((function(){a.disposed_||(a.textarea_.focus(),a.addFocus(),(0,module$exports$Blockly$utils$dom.addClass)(a.svgRectTarget_,"blocklyCommentTargetFocused"),(0,module$exports$Blockly$utils$dom.addClass)(a.svgHandleTarget_,"blocklyCommentHandleTargetFocused"))}),0)},module$exports$Blockly$WorkspaceCommentSvg.WorkspaceCommentSvg.prototype.blurFocus=function(){var a=this;this.focused_=!1,setTimeout((function(){a.disposed_||(a.textarea_.blur(),a.removeFocus(),(0,module$exports$Blockly$utils$dom.removeClass)(a.svgRectTarget_,"blocklyCommentTargetFocused"),(0,module$exports$Blockly$utils$dom.removeClass)(a.svgHandleTarget_,"blocklyCommentHandleTargetFocused"))}),0)},(0,module$exports$Blockly$Css.register)("\n  .blocklyCommentForeignObject {\n    position: relative;\n    z-index: 0;\n  }\n\n  .blocklyCommentRect {\n    fill: #E7DE8E;\n    stroke: #bcA903;\n    stroke-width: 1px;\n  }\n\n  .blocklyCommentTarget {\n    fill: transparent;\n    stroke: #bcA903;\n  }\n\n  .blocklyCommentTargetFocused {\n    fill: none;\n  }\n\n  .blocklyCommentHandleTarget {\n    fill: none;\n  }\n\n  .blocklyCommentHandleTargetFocused {\n    fill: transparent;\n  }\n\n  .blocklyFocused>.blocklyCommentRect {\n    fill: #B9B272;\n    stroke: #B9B272;\n  }\n\n  .blocklySelected>.blocklyCommentTarget {\n    stroke: #fc3;\n    stroke-width: 3px;\n  }\n\n  .blocklyCommentDeleteIcon {\n    cursor: pointer;\n    fill: #000;\n    display: none;\n  }\n\n  .blocklySelected > .blocklyCommentDeleteIcon {\n    display: block;\n  }\n\n  .blocklyDeleteIconShape {\n    fill: #000;\n    stroke: #000;\n    stroke-width: 1px;\n  }\n\n  .blocklyDeleteIconShape.blocklyDeleteIconHighlighted {\n    stroke: #fc3;\n  }\n");var module$exports$Blockly$Trashcan={Trashcan:function(a){module$exports$Blockly$Trashcan.Trashcan.superClass_.constructor.call(this),this.workspace_=a,this.id="trashcan",this.contents_=[],this.flyout=null,0>=this.workspace_.options.maxTrashcanContents||(a=new module$exports$Blockly$Options.Options({scrollbars:!0,parentWorkspace:this.workspace_,rtl:this.workspace_.RTL,oneBasedIndex:this.workspace_.options.oneBasedIndex,renderer:this.workspace_.options.renderer,rendererOverrides:this.workspace_.options.rendererOverrides,move:{scrollbars:!0}}),this.workspace_.horizontalLayout?(a.toolboxPosition=this.workspace_.toolboxPosition===module$exports$Blockly$utils$toolbox.Position.TOP?module$exports$Blockly$utils$toolbox.Position.BOTTOM:module$exports$Blockly$utils$toolbox.Position.TOP,this.flyout=new((0,module$exports$Blockly$registry.getClassFromOptions)(module$exports$Blockly$registry.Type.FLYOUTS_HORIZONTAL_TOOLBOX,this.workspace_.options,!0))(a)):(a.toolboxPosition=this.workspace_.toolboxPosition===module$exports$Blockly$utils$toolbox.Position.RIGHT?module$exports$Blockly$utils$toolbox.Position.LEFT:module$exports$Blockly$utils$toolbox.Position.RIGHT,this.flyout=new((0,module$exports$Blockly$registry.getClassFromOptions)(module$exports$Blockly$registry.Type.FLYOUTS_VERTICAL_TOOLBOX,this.workspace_.options,!0))(a)),this.workspace_.addChangeListener(this.onDelete_.bind(this)))}};(0,$.module$exports$Blockly$utils$object.inherits)(module$exports$Blockly$Trashcan.Trashcan,module$exports$Blockly$DeleteArea.DeleteArea),module$exports$Blockly$Trashcan.Trashcan.prototype.isLidOpen=!1,module$exports$Blockly$Trashcan.Trashcan.prototype.minOpenness_=0,module$exports$Blockly$Trashcan.Trashcan.prototype.svgGroup_=null,module$exports$Blockly$Trashcan.Trashcan.prototype.svgLid_=null,module$exports$Blockly$Trashcan.Trashcan.prototype.lidTask_=0,module$exports$Blockly$Trashcan.Trashcan.prototype.lidOpen_=0,module$exports$Blockly$Trashcan.Trashcan.prototype.left_=0,module$exports$Blockly$Trashcan.Trashcan.prototype.top_=0,module$exports$Blockly$Trashcan.Trashcan.prototype.initialized_=!1,module$exports$Blockly$Trashcan.Trashcan.prototype.createDom=function(){this.svgGroup_=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.G,{class:"blocklyTrash"},null);var a=String(Math.random()).substring(2),b=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.CLIPPATH,{id:"blocklyTrashBodyClipPath"+a},this.svgGroup_);(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.RECT,{width:47,height:44,y:16},b);var c=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.IMAGE,{width:$.module$exports$Blockly$internalConstants.SPRITE.width,x:-0,height:$.module$exports$Blockly$internalConstants.SPRITE.height,y:-32,"clip-path":"url(#blocklyTrashBodyClipPath"+a+")"},this.svgGroup_);return c.setAttributeNS(module$exports$Blockly$utils$dom.XLINK_NS,"xlink:href",this.workspace_.options.pathToMedia+$.module$exports$Blockly$internalConstants.SPRITE.url),b=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.CLIPPATH,{id:"blocklyTrashLidClipPath"+a},this.svgGroup_),(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.RECT,{width:47,height:16},b),this.svgLid_=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.IMAGE,{width:$.module$exports$Blockly$internalConstants.SPRITE.width,x:-0,height:$.module$exports$Blockly$internalConstants.SPRITE.height,y:-32,"clip-path":"url(#blocklyTrashLidClipPath"+a+")"},this.svgGroup_),this.svgLid_.setAttributeNS(module$exports$Blockly$utils$dom.XLINK_NS,"xlink:href",this.workspace_.options.pathToMedia+$.module$exports$Blockly$internalConstants.SPRITE.url),(0,module$exports$Blockly$browserEvents.bind)(this.svgGroup_,"mousedown",this,this.blockMouseDownWhenOpenable_),(0,module$exports$Blockly$browserEvents.bind)(this.svgGroup_,"mouseup",this,this.click),(0,module$exports$Blockly$browserEvents.bind)(c,"mouseover",this,this.mouseOver_),(0,module$exports$Blockly$browserEvents.bind)(c,"mouseout",this,this.mouseOut_),this.animateLid_(),this.svgGroup_},module$exports$Blockly$Trashcan.Trashcan.prototype.init=function(){0<this.workspace_.options.maxTrashcanContents&&((0,module$exports$Blockly$utils$dom.insertAfter)(this.flyout.createDom(module$exports$Blockly$utils$Svg.Svg.SVG),this.workspace_.getParentSvg()),this.flyout.init(this.workspace_)),this.workspace_.getComponentManager().addComponent({component:this,weight:1,capabilities:[module$exports$Blockly$ComponentManager.ComponentManager.Capability.AUTOHIDEABLE,module$exports$Blockly$ComponentManager.ComponentManager.Capability.DELETE_AREA,module$exports$Blockly$ComponentManager.ComponentManager.Capability.DRAG_TARGET,module$exports$Blockly$ComponentManager.ComponentManager.Capability.POSITIONABLE]}),this.initialized_=!0,this.setLidOpen(!1)},module$exports$Blockly$Trashcan.Trashcan.prototype.dispose=function(){this.workspace_.getComponentManager().removeComponent("trashcan"),this.svgGroup_&&((0,module$exports$Blockly$utils$dom.removeNode)(this.svgGroup_),this.svgGroup_=null),this.workspace_=this.svgLid_=null,clearTimeout(this.lidTask_)},module$exports$Blockly$Trashcan.Trashcan.prototype.hasContents_=function(){return!!this.contents_.length},module$exports$Blockly$Trashcan.Trashcan.prototype.contentsIsOpen=function(){return!!this.flyout&&this.flyout.isVisible()},module$exports$Blockly$Trashcan.Trashcan.prototype.openFlyout=function(){if(!this.contentsIsOpen()){var a=this.contents_.map((function(b){return JSON.parse(b)}));this.flyout.show(a),this.fireUiEvent_(!0)}},module$exports$Blockly$Trashcan.Trashcan.prototype.closeFlyout=function(){this.contentsIsOpen()&&(this.flyout.hide(),this.fireUiEvent_(!1),this.workspace_.recordDragTargets())},module$exports$Blockly$Trashcan.Trashcan.prototype.autoHide=function(a){!a&&this.flyout&&this.closeFlyout()},module$exports$Blockly$Trashcan.Trashcan.prototype.emptyContents=function(){this.hasContents_()&&(this.contents_.length=0,this.setMinOpenness_(0),this.closeFlyout())},module$exports$Blockly$Trashcan.Trashcan.prototype.position=function(a,b){if(this.initialized_){var c=(0,module$exports$Blockly$uiPosition.getCornerOppositeToolbox)(this.workspace_,a);a=(0,module$exports$Blockly$uiPosition.getStartPositionRect)(c,new module$exports$Blockly$utils$Size.Size(47,60),20,20,a,this.workspace_),b=(0,module$exports$Blockly$uiPosition.bumpPositionRect)(a,20,c.vertical===module$exports$Blockly$uiPosition.verticalPosition.TOP?module$exports$Blockly$uiPosition.bumpDirection.DOWN:module$exports$Blockly$uiPosition.bumpDirection.UP,b),this.top_=b.top,this.left_=b.left,this.svgGroup_.setAttribute("transform","translate("+this.left_+","+this.top_+")")}},module$exports$Blockly$Trashcan.Trashcan.prototype.getBoundingRectangle=function(){return new module$exports$Blockly$utils$Rect.Rect(this.top_,this.top_+44+16,this.left_,this.left_+47)},module$exports$Blockly$Trashcan.Trashcan.prototype.getClientRect=function(){if(!this.svgGroup_)return null;var a=this.svgGroup_.getBoundingClientRect(),b=a.top+32-10;return a=a.left+0-10,new module$exports$Blockly$utils$Rect.Rect(b,b+16+44+20,a,a+47+20)},module$exports$Blockly$Trashcan.Trashcan.prototype.onDragOver=function(a){this.setLidOpen(this.wouldDelete_)},module$exports$Blockly$Trashcan.Trashcan.prototype.onDragExit=function(a){this.setLidOpen(!1)},module$exports$Blockly$Trashcan.Trashcan.prototype.onDrop=function(a){setTimeout(this.setLidOpen.bind(this,!1),100)},module$exports$Blockly$Trashcan.Trashcan.prototype.setLidOpen=function(a){this.isLidOpen!==a&&(clearTimeout(this.lidTask_),this.isLidOpen=a,this.animateLid_())},module$exports$Blockly$Trashcan.Trashcan.prototype.animateLid_=function(){this.lidOpen_+=this.isLidOpen?.2:-.2,this.lidOpen_=Math.min(Math.max(this.lidOpen_,this.minOpenness_),1),this.setLidAngle_(45*this.lidOpen_),this.svgGroup_.style.opacity=.4+.4*this.lidOpen_,this.lidOpen_>this.minOpenness_&&1>this.lidOpen_&&(this.lidTask_=setTimeout(this.animateLid_.bind(this),20))},module$exports$Blockly$Trashcan.Trashcan.prototype.setLidAngle_=function(a){var b=this.workspace_.toolboxPosition===module$exports$Blockly$utils$toolbox.Position.RIGHT||this.workspace_.horizontalLayout&&this.workspace_.RTL;this.svgLid_.setAttribute("transform","rotate("+(b?-a:a)+","+(b?4:43)+",14)")},module$exports$Blockly$Trashcan.Trashcan.prototype.setMinOpenness_=function(a){this.minOpenness_=a,this.isLidOpen||this.setLidAngle_(45*a)},module$exports$Blockly$Trashcan.Trashcan.prototype.closeLid=function(){this.setLidOpen(!1)},module$exports$Blockly$Trashcan.Trashcan.prototype.click=function(){this.hasContents_()&&this.openFlyout()},module$exports$Blockly$Trashcan.Trashcan.prototype.fireUiEvent_=function(a){a=new((0,module$exports$Blockly$Events$utils.get)(module$exports$Blockly$Events$utils.TRASHCAN_OPEN))(a,this.workspace_.id),(0,module$exports$Blockly$Events$utils.fire)(a)},module$exports$Blockly$Trashcan.Trashcan.prototype.blockMouseDownWhenOpenable_=function(a){!this.contentsIsOpen()&&this.hasContents_()&&a.stopPropagation()},module$exports$Blockly$Trashcan.Trashcan.prototype.mouseOver_=function(){this.hasContents_()&&this.setLidOpen(!0)},module$exports$Blockly$Trashcan.Trashcan.prototype.mouseOut_=function(){this.setLidOpen(!1)},module$exports$Blockly$Trashcan.Trashcan.prototype.onDelete_=function(a){if(!(0>=this.workspace_.options.maxTrashcanContents||a.type!==module$exports$Blockly$Events$utils.DELETE||a.wasShadow)&&(a=this.cleanBlockJson_(a.oldJson),-1===this.contents_.indexOf(a))){for(this.contents_.unshift(a);this.contents_.length>this.workspace_.options.maxTrashcanContents;)this.contents_.pop();this.setMinOpenness_(.1)}},module$exports$Blockly$Trashcan.Trashcan.prototype.cleanBlockJson_=function(a){return function b(c){if(c){if(delete c.id,delete c.x,delete c.y,delete c.enabled,c.icons&&c.icons.comment){var d=c.icons.comment;delete d.height,delete d.width,delete d.pinned}for(var e in d=c.inputs){var f=d[e];b(f.block),b(f.shadow)}c.next&&(b((c=c.next).block),b(c.shadow))}}(a=JSON.parse(JSON.stringify(a))),a.kind="BLOCK",JSON.stringify(a)};var module$exports$Blockly$FlyoutButton={FlyoutButton:function(a,b,c,d){this.workspace_=a,this.targetWorkspace_=b,this.text_=c.text,this.position_=new module$exports$Blockly$utils$Coordinate.Coordinate(0,0),this.isLabel_=d,this.callbackKey_=c.callbackKey||c.callbackkey,this.cssClass_=c["web-class"]||null,this.onMouseUpWrapper_=null,this.info=c}};module$exports$Blockly$FlyoutButton.FlyoutButton.MARGIN_X=5,module$exports$Blockly$FlyoutButton.FlyoutButton.MARGIN_Y=2,module$exports$Blockly$FlyoutButton.FlyoutButton.prototype.width=0,module$exports$Blockly$FlyoutButton.FlyoutButton.prototype.height=0,module$exports$Blockly$FlyoutButton.FlyoutButton.prototype.createDom=function(){var b,a=this.isLabel_?"blocklyFlyoutLabel":"blocklyFlyoutButton";this.cssClass_&&(a+=" "+this.cssClass_),this.svgGroup_=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.G,{class:a},this.workspace_.getCanvas()),this.isLabel_||(b=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.RECT,{class:"blocklyFlyoutButtonShadow",rx:4,ry:4,x:1,y:1},this.svgGroup_)),a=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.RECT,{class:this.isLabel_?"blocklyFlyoutLabelBackground":"blocklyFlyoutButtonBackground",rx:4,ry:4},this.svgGroup_);var c=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.TEXT,{class:this.isLabel_?"blocklyFlyoutLabelText":"blocklyText",x:0,y:0,"text-anchor":"middle"},this.svgGroup_),d=(0,module$exports$Blockly$utils$parsing.replaceMessageReferences)(this.text_);this.workspace_.RTL&&(d+=""),c.textContent=d,this.isLabel_&&(this.svgText_=c,this.workspace_.getThemeManager().subscribe(this.svgText_,"flyoutForegroundColour","fill"));var e=(0,module$exports$Blockly$utils$style.getComputedStyle)(c,"fontSize"),f=(0,module$exports$Blockly$utils$style.getComputedStyle)(c,"fontWeight"),g=(0,module$exports$Blockly$utils$style.getComputedStyle)(c,"fontFamily");return this.width=(0,module$exports$Blockly$utils$dom.getFastTextWidthWithSizeString)(c,e,f,g),d=(0,module$exports$Blockly$utils$dom.measureFontMetrics)(d,e,f,g),this.height=d.height,this.isLabel_||(this.width+=2*module$exports$Blockly$FlyoutButton.FlyoutButton.MARGIN_X,this.height+=2*module$exports$Blockly$FlyoutButton.FlyoutButton.MARGIN_Y,b.setAttribute("width",this.width),b.setAttribute("height",this.height)),a.setAttribute("width",this.width),a.setAttribute("height",this.height),c.setAttribute("x",this.width/2),c.setAttribute("y",this.height/2-d.height/2+d.baseline),this.updateTransform_(),this.onMouseUpWrapper_=(0,module$exports$Blockly$browserEvents.conditionalBind)(this.svgGroup_,"mouseup",this,this.onMouseUp_),this.svgGroup_},module$exports$Blockly$FlyoutButton.FlyoutButton.prototype.show=function(){this.updateTransform_(),this.svgGroup_.setAttribute("display","block")},module$exports$Blockly$FlyoutButton.FlyoutButton.prototype.updateTransform_=function(){this.svgGroup_.setAttribute("transform","translate("+this.position_.x+","+this.position_.y+")")},module$exports$Blockly$FlyoutButton.FlyoutButton.prototype.moveTo=function(a,b){this.position_.x=a,this.position_.y=b,this.updateTransform_()},module$exports$Blockly$FlyoutButton.FlyoutButton.prototype.isLabel=function(){return this.isLabel_},module$exports$Blockly$FlyoutButton.FlyoutButton.prototype.getPosition=function(){return this.position_},module$exports$Blockly$FlyoutButton.FlyoutButton.prototype.getButtonText=function(){return this.text_},module$exports$Blockly$FlyoutButton.FlyoutButton.prototype.getTargetWorkspace=function(){return this.targetWorkspace_},module$exports$Blockly$FlyoutButton.FlyoutButton.prototype.dispose=function(){this.onMouseUpWrapper_&&(0,module$exports$Blockly$browserEvents.unbind)(this.onMouseUpWrapper_),this.svgGroup_&&(0,module$exports$Blockly$utils$dom.removeNode)(this.svgGroup_),this.svgText_&&this.workspace_.getThemeManager().unsubscribe(this.svgText_)},module$exports$Blockly$FlyoutButton.FlyoutButton.prototype.onMouseUp_=function(a){(a=this.targetWorkspace_.getGesture(a))&&a.cancel(),this.isLabel_&&this.callbackKey_?console.warn("Labels should not have callbacks. Label text: "+this.text_):this.isLabel_||this.callbackKey_&&this.targetWorkspace_.getButtonCallback(this.callbackKey_)?this.isLabel_||this.targetWorkspace_.getButtonCallback(this.callbackKey_)(this):console.warn("Buttons should have callbacks. Button text: "+this.text_)},(0,module$exports$Blockly$Css.register)("\n  .blocklyFlyoutButton {\n    fill: #888;\n    cursor: default;\n  }\n\n  .blocklyFlyoutButtonShadow {\n    fill: #666;\n  }\n\n  .blocklyFlyoutButton:hover {\n    fill: #aaa;\n  }\n\n  .blocklyFlyoutLabel {\n    cursor: default;\n  }\n\n  .blocklyFlyoutLabelBackground {\n    opacity: 0;\n  }\n");var module$contents$Blockly$Procedures_procTupleComparator,module$exports$Blockly$VariablesDynamic={CATEGORY_NAME:"VARIABLE_DYNAMIC",onCreateVariableButtonClick_String:function(a){(0,$.module$exports$Blockly$Variables.createVariableButtonHandler)(a.getTargetWorkspace(),void 0,"String")},onCreateVariableButtonClick_Number:function(a){(0,$.module$exports$Blockly$Variables.createVariableButtonHandler)(a.getTargetWorkspace(),void 0,"Number")},onCreateVariableButtonClick_Colour:function(a){(0,$.module$exports$Blockly$Variables.createVariableButtonHandler)(a.getTargetWorkspace(),void 0,"Colour")},flyoutCategory:function(a){var b=[],c=document.createElement("button");return c.setAttribute("text",$.module$exports$Blockly$Msg.Msg.NEW_STRING_VARIABLE),c.setAttribute("callbackKey","CREATE_VARIABLE_STRING"),b.push(c),(c=document.createElement("button")).setAttribute("text",$.module$exports$Blockly$Msg.Msg.NEW_NUMBER_VARIABLE),c.setAttribute("callbackKey","CREATE_VARIABLE_NUMBER"),b.push(c),(c=document.createElement("button")).setAttribute("text",$.module$exports$Blockly$Msg.Msg.NEW_COLOUR_VARIABLE),c.setAttribute("callbackKey","CREATE_VARIABLE_COLOUR"),b.push(c),a.registerButtonCallback("CREATE_VARIABLE_STRING",module$exports$Blockly$VariablesDynamic.onCreateVariableButtonClick_String),a.registerButtonCallback("CREATE_VARIABLE_NUMBER",module$exports$Blockly$VariablesDynamic.onCreateVariableButtonClick_Number),a.registerButtonCallback("CREATE_VARIABLE_COLOUR",module$exports$Blockly$VariablesDynamic.onCreateVariableButtonClick_Colour),a=(0,module$exports$Blockly$VariablesDynamic.flyoutCategoryBlocks)(a),b.concat(a)},flyoutCategoryBlocks:function(a){var b=[];if(0<(a=a.getAllVariables()).length){if($.module$exports$Blockly$blocks.Blocks.variables_set_dynamic){var c=a[a.length-1],d=(0,$.module$exports$Blockly$utils$xml.createElement)("block");d.setAttribute("type","variables_set_dynamic"),d.setAttribute("gap",24),d.appendChild((0,$.module$exports$Blockly$Variables.generateVariableFieldDom)(c)),b.push(d)}if($.module$exports$Blockly$blocks.Blocks.variables_get_dynamic)for(a.sort(module$exports$Blockly$VariableModel.VariableModel.compareByName),c=0;d=a[c];c++){var e=(0,$.module$exports$Blockly$utils$xml.createElement)("block");e.setAttribute("type","variables_get_dynamic"),e.setAttribute("gap",8),e.appendChild((0,$.module$exports$Blockly$Variables.generateVariableFieldDom)(d)),b.push(e)}}return b}};$.module$exports$Blockly$Procedures={CATEGORY_NAME:"PROCEDURE",DEFAULT_ARG:"x",allProcedures:function(a){var b=a.getBlocksByType("procedures_defnoreturn",!1).map((function(c){return c.getProcedureDef()}));return a=a.getBlocksByType("procedures_defreturn",!1).map((function(c){return c.getProcedureDef()})),b.sort(module$contents$Blockly$Procedures_procTupleComparator),a.sort(module$contents$Blockly$Procedures_procTupleComparator),[b,a]}},module$contents$Blockly$Procedures_procTupleComparator=function(a,b){return a[0].localeCompare(b[0],void 0,{sensitivity:"base"})},$.module$exports$Blockly$Procedures.findLegalName=function(a,b){if(b.isInFlyout)return a;for(a=a||$.module$exports$Blockly$Msg.Msg.UNNAMED_KEY||"unnamed";!module$contents$Blockly$Procedures_isLegalName(a,b.workspace,b);){var c=a.match(/^(.*?)(\d+)$/);a=c?c[1]+(parseInt(c[2],10)+1):a+"2"}return a};var module$contents$Blockly$Procedures_isLegalName=function(a,b,c){return!(0,$.module$exports$Blockly$Procedures.isNameUsed)(a,b,c)};$.module$exports$Blockly$Procedures.isNameUsed=function(a,b,c){b=b.getAllBlocks(!1);for(var d=0;d<b.length;d++)if(b[d]!==c&&b[d].getProcedureDef){var e=b[d].getProcedureDef();if($.module$exports$Blockly$Names.Names.equals(e[0],a))return!0}return!1},$.module$exports$Blockly$Procedures.rename=function(a){a=a.trim();var b=(0,$.module$exports$Blockly$Procedures.findLegalName)(a,this.getSourceBlock()),c=this.getValue();if(c!==a&&c!==b){a=this.getSourceBlock().workspace.getAllBlocks(!1);for(var d=0;d<a.length;d++)a[d].renameProcedure&&a[d].renameProcedure(c,b)}return b},$.module$exports$Blockly$Procedures.flyoutCategory=function(a){function b(f,g){for(var h=0;h<f.length;h++){var k=f[h][0],l=f[h][1],m=(0,$.module$exports$Blockly$utils$xml.createElement)("block");m.setAttribute("type",g),m.setAttribute("gap",16);var n=(0,$.module$exports$Blockly$utils$xml.createElement)("mutation");for(n.setAttribute("name",k),m.appendChild(n),k=0;k<l.length;k++){var p=(0,$.module$exports$Blockly$utils$xml.createElement)("arg");p.setAttribute("name",l[k]),n.appendChild(p)}c.push(m)}}var c=[];if($.module$exports$Blockly$blocks.Blocks.procedures_defnoreturn){var d=(0,$.module$exports$Blockly$utils$xml.createElement)("block");d.setAttribute("type","procedures_defnoreturn"),d.setAttribute("gap",16);var e=(0,$.module$exports$Blockly$utils$xml.createElement)("field");e.setAttribute("name","NAME"),e.appendChild((0,$.module$exports$Blockly$utils$xml.createTextNode)($.module$exports$Blockly$Msg.Msg.PROCEDURES_DEFNORETURN_PROCEDURE)),d.appendChild(e),c.push(d)}return $.module$exports$Blockly$blocks.Blocks.procedures_defreturn&&((d=(0,$.module$exports$Blockly$utils$xml.createElement)("block")).setAttribute("type","procedures_defreturn"),d.setAttribute("gap",16),(e=(0,$.module$exports$Blockly$utils$xml.createElement)("field")).setAttribute("name","NAME"),e.appendChild((0,$.module$exports$Blockly$utils$xml.createTextNode)($.module$exports$Blockly$Msg.Msg.PROCEDURES_DEFRETURN_PROCEDURE)),d.appendChild(e),c.push(d)),$.module$exports$Blockly$blocks.Blocks.procedures_ifreturn&&((d=(0,$.module$exports$Blockly$utils$xml.createElement)("block")).setAttribute("type","procedures_ifreturn"),d.setAttribute("gap",16),c.push(d)),c.length&&c[c.length-1].setAttribute("gap",24),b((a=(0,$.module$exports$Blockly$Procedures.allProcedures)(a))[0],"procedures_callnoreturn"),b(a[1],"procedures_callreturn"),c};var module$contents$Blockly$Procedures_updateMutatorFlyout=function(a){for(var e,b=[],c=a.getBlocksByType("procedures_mutatorarg",!1),d=0;e=c[d];d++)b.push(e.getFieldValue("NAME"));c=(0,$.module$exports$Blockly$utils$xml.createElement)("xml"),(d=(0,$.module$exports$Blockly$utils$xml.createElement)("block")).setAttribute("type","procedures_mutatorarg"),(e=(0,$.module$exports$Blockly$utils$xml.createElement)("field")).setAttribute("name","NAME"),b=(0,$.module$exports$Blockly$Variables.generateUniqueNameFromOptions)($.module$exports$Blockly$Procedures.DEFAULT_ARG,b),b=(0,$.module$exports$Blockly$utils$xml.createTextNode)(b),e.appendChild(b),d.appendChild(e),c.appendChild(d),a.updateToolbox(c)};$.module$exports$Blockly$Procedures.mutatorOpenListener=function(a){if(a.type===module$exports$Blockly$Events$utils.BUBBLE_OPEN&&"mutator"===a.bubbleType&&a.isOpen){var b=(a=module$exports$Blockly$Workspace.Workspace.getById(a.workspaceId).getBlockById(a.blockId)).type;"procedures_defnoreturn"!==b&&"procedures_defreturn"!==b||(a=a.mutator.getWorkspace(),module$contents$Blockly$Procedures_updateMutatorFlyout(a),a.addChangeListener(module$contents$Blockly$Procedures_mutatorChangeListener))}};var module$contents$Blockly$Procedures_mutatorChangeListener=function(a){a.type!==module$exports$Blockly$Events$utils.CREATE&&a.type!==module$exports$Blockly$Events$utils.DELETE&&a.type!==module$exports$Blockly$Events$utils.CHANGE||(a=module$exports$Blockly$Workspace.Workspace.getById(a.workspaceId),module$contents$Blockly$Procedures_updateMutatorFlyout(a))};return $.module$exports$Blockly$Procedures.getCallers=function(a,b){var c=[];b=b.getAllBlocks(!1);for(var d=0;d<b.length;d++)if(b[d].getProcedureCall){var e=b[d].getProcedureCall();e&&$.module$exports$Blockly$Names.Names.equals(e,a)&&c.push(b[d])}return c},$.module$exports$Blockly$Procedures.mutateCallers=function(a){var e,b=(0,module$exports$Blockly$Events$utils.getRecordUndo)(),c=a.getProcedureDef()[0],d=a.mutationToDom(!0);for(a=(0,$.module$exports$Blockly$Procedures.getCallers)(c,a.workspace),c=0;e=a[c];c++){var f=e.mutationToDom();f=f&&(0,$.module$exports$Blockly$Xml.domToText)(f),e.domToMutation(d);var g=e.mutationToDom();f!==(g=g&&(0,$.module$exports$Blockly$Xml.domToText)(g))&&((0,module$exports$Blockly$Events$utils.setRecordUndo)(!1),(0,module$exports$Blockly$Events$utils.fire)(new((0,module$exports$Blockly$Events$utils.get)(module$exports$Blockly$Events$utils.CHANGE))(e,"mutation",null,f,g)),(0,module$exports$Blockly$Events$utils.setRecordUndo)(b))}},$.module$exports$Blockly$Procedures.getDefinition=function(a,b){b=b.getAllBlocks(!1);for(var c=0;c<b.length;c++)if(b[c].getProcedureDef){var d=b[c].getProcedureDef();if(d&&$.module$exports$Blockly$Names.Names.equals(d[0],a))return b[c]}return null},$.module$exports$Blockly$Mutator={Mutator:function(a){$.module$exports$Blockly$Mutator.Mutator.superClass_.constructor.call(this,null),this.quarkNames_=a}},(0,$.module$exports$Blockly$utils$object.inherits)($.module$exports$Blockly$Mutator.Mutator,module$exports$Blockly$Icon.Icon),$.module$exports$Blockly$Mutator.Mutator.prototype.workspace_=null,$.module$exports$Blockly$Mutator.Mutator.prototype.workspaceWidth_=0,$.module$exports$Blockly$Mutator.Mutator.prototype.workspaceHeight_=0,$.module$exports$Blockly$Mutator.Mutator.prototype.setBlock=function(a){this.block_=a},$.module$exports$Blockly$Mutator.Mutator.prototype.getWorkspace=function(){return this.workspace_},$.module$exports$Blockly$Mutator.Mutator.prototype.drawIcon_=function(a){(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.RECT,{class:"blocklyIconShape",rx:"4",ry:"4",height:"16",width:"16"},a),(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.PATH,{class:"blocklyIconSymbol",d:"m4.203,7.296 0,1.368 -0.92,0.677 -0.11,0.41 0.9,1.559 0.41,0.11 1.043,-0.457 1.187,0.683 0.127,1.134 0.3,0.3 1.8,0 0.3,-0.299 0.127,-1.138 1.185,-0.682 1.046,0.458 0.409,-0.11 0.9,-1.559 -0.11,-0.41 -0.92,-0.677 0,-1.366 0.92,-0.677 0.11,-0.41 -0.9,-1.559 -0.409,-0.109 -1.046,0.458 -1.185,-0.682 -0.127,-1.138 -0.3,-0.299 -1.8,0 -0.3,0.3 -0.126,1.135 -1.187,0.682 -1.043,-0.457 -0.41,0.11 -0.899,1.559 0.108,0.409z"},a),(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.CIRCLE,{class:"blocklyIconShape",r:"2.7",cx:"8",cy:"8"},a)},$.module$exports$Blockly$Mutator.Mutator.prototype.iconClick_=function(a){this.block_.isEditable()&&module$exports$Blockly$Icon.Icon.prototype.iconClick_.call(this,a)},$.module$exports$Blockly$Mutator.Mutator.prototype.createEditor_=function(){if(this.svgDialog_=(0,module$exports$Blockly$utils$dom.createSvgElement)(module$exports$Blockly$utils$Svg.Svg.SVG,{x:module$exports$Blockly$Bubble.Bubble.BORDER_WIDTH,y:module$exports$Blockly$Bubble.Bubble.BORDER_WIDTH},null),this.quarkNames_.length)for(var c,a=(0,$.module$exports$Blockly$utils$xml.createElement)("xml"),b=0;c=this.quarkNames_[b];b++){var d=(0,$.module$exports$Blockly$utils$xml.createElement)("block");d.setAttribute("type",c),a.appendChild(d)}else a=null;return(b=new module$exports$Blockly$Options.Options({disable:!1,parentWorkspace:this.block_.workspace,media:this.block_.workspace.options.pathToMedia,rtl:this.block_.RTL,horizontalLayout:!1,renderer:this.block_.workspace.options.renderer,rendererOverrides:this.block_.workspace.options.rendererOverrides})).toolboxPosition=this.block_.RTL?module$exports$Blockly$utils$toolbox.Position.RIGHT:module$exports$Blockly$utils$toolbox.Position.LEFT,(c=!!a)&&(b.languageTree=(0,module$exports$Blockly$utils$toolbox.convertToolboxDefToJson)(a)),this.workspace_=new module$exports$Blockly$WorkspaceSvg.WorkspaceSvg(b),this.workspace_.isMutator=!0,this.workspace_.addChangeListener(module$exports$Blockly$Events$utils.disableOrphans),a=c?this.workspace_.addFlyout(module$exports$Blockly$utils$Svg.Svg.G):null,b=this.workspace_.createDom("blocklyMutatorBackground"),a&&b.insertBefore(a,this.workspace_.svgBlockCanvas_),this.svgDialog_.appendChild(b),this.svgDialog_},$.module$exports$Blockly$Mutator.Mutator.prototype.updateEditable=function(){$.module$exports$Blockly$Mutator.Mutator.superClass_.updateEditable.call(this),this.block_.isInFlyout||(this.block_.isEditable()?this.iconGroup_&&(0,module$exports$Blockly$utils$dom.removeClass)(this.iconGroup_,"blocklyIconGroupReadonly"):(this.setVisible(!1),this.iconGroup_&&(0,module$exports$Blockly$utils$dom.addClass)(this.iconGroup_,"blocklyIconGroupReadonly")))},$.module$exports$Blockly$Mutator.Mutator.prototype.resizeBubble_=function(){var a=2*module$exports$Blockly$Bubble.Bubble.BORDER_WIDTH,b=this.workspace_.getCanvas().getBBox(),c=b.width+b.x,d=b.height+3*a,e=this.workspace_.getFlyout();if(e){var f=e.getWorkspace().getMetricsManager().getScrollMetrics();d=Math.max(d,f.height+20),c+=e.getWidth()}this.block_.RTL&&(c=-b.x),c+=3*a,(Math.abs(this.workspaceWidth_-c)>a||Math.abs(this.workspaceHeight_-d)>a)&&(this.workspaceWidth_=c,this.workspaceHeight_=d,this.bubble_.setBubbleSize(c+a,d+a),this.svgDialog_.setAttribute("width",this.workspaceWidth_),this.svgDialog_.setAttribute("height",this.workspaceHeight_),this.workspace_.setCachedParentSvgSize(this.workspaceWidth_,this.workspaceHeight_)),this.block_.RTL&&(a="translate("+this.workspaceWidth_+",0)",this.workspace_.getCanvas().setAttribute("transform",a)),this.workspace_.resize()},$.module$exports$Blockly$Mutator.Mutator.prototype.onBubbleMove_=function(){this.workspace_&&this.workspace_.recordDragTargets()},$.module$exports$Blockly$Mutator.Mutator.prototype.setVisible=function(a){if(a!==this.isVisible())if((0,module$exports$Blockly$Events$utils.fire)(new((0,module$exports$Blockly$Events$utils.get)(module$exports$Blockly$Events$utils.BUBBLE_OPEN))(this.block_,a,"mutator")),a){this.bubble_=new module$exports$Blockly$Bubble.Bubble(this.block_.workspace,this.createEditor_(),this.block_.pathObject.svgPath,this.iconXY_,null,null),this.bubble_.setSvgId(this.block_.id),this.bubble_.registerMoveEvent(this.onBubbleMove_.bind(this));var b=this.workspace_.options.languageTree;a=this.workspace_.getFlyout(),b&&(a.init(this.workspace_),a.show(b)),this.rootBlock_=this.block_.decompose(this.workspace_),b=this.rootBlock_.getDescendants(!1);for(var c=0,d=void 0;d=b[c];c++)d.render();if(this.rootBlock_.setMovable(!1),this.rootBlock_.setDeletable(!1),a?(b=2*a.CORNER_RADIUS,a=this.rootBlock_.RTL?a.getWidth()+b:b):a=b=16,this.block_.RTL&&(a=-a),this.rootBlock_.moveBy(a,b),this.block_.saveConnections){var e=this,f=this.block_;f.saveConnections(this.rootBlock_),this.sourceListener_=function(){f.saveConnections(e.rootBlock_)},this.block_.workspace.addChangeListener(this.sourceListener_)}this.resizeBubble_(),this.workspace_.addChangeListener(this.workspaceChanged_.bind(this)),this.updateWorkspace_(),this.applyColour()}else this.svgDialog_=null,this.workspace_.dispose(),this.rootBlock_=this.workspace_=null,this.bubble_.dispose(),this.bubble_=null,this.workspaceHeight_=this.workspaceWidth_=0,this.sourceListener_&&(this.block_.workspace.removeChangeListener(this.sourceListener_),this.sourceListener_=null)},$.module$exports$Blockly$Mutator.Mutator.prototype.workspaceChanged_=function(a){a.isUiEvent||a.type===module$exports$Blockly$Events$utils.CHANGE&&"disabled"===a.element||a.type===module$exports$Blockly$Events$utils.CREATE||this.updateWorkspace_()},$.module$exports$Blockly$Mutator.Mutator.prototype.updateWorkspace_=function(){if(!this.workspace_.isDragging())for(var a=this.workspace_.getTopBlocks(!1),b=0,c=void 0;c=a[b];b++){var d=c.getRelativeToSurfaceXY();if(20>d.y&&c.moveBy(0,20-d.y),c.RTL){var e=-20,f=this.workspace_.getFlyout();f&&(e-=f.getWidth()),d.x>e&&c.moveBy(e-d.x,0)}else 20>d.x&&c.moveBy(20-d.x,0)}if(this.rootBlock_.workspace===this.workspace_){(0,module$exports$Blockly$Events$utils.setGroup)(!0);var g=this.block_;if(a=module$exports$Blockly$Events$BlockChange.BlockChange.getExtraBlockState_(g),b=g.rendered,g.rendered=!1,g.compose(this.rootBlock_),g.rendered=b,g.initSvg(),g.rendered&&g.render(),a!==(b=module$exports$Blockly$Events$BlockChange.BlockChange.getExtraBlockState_(g))){(0,module$exports$Blockly$Events$utils.fire)(new((0,module$exports$Blockly$Events$utils.get)(module$exports$Blockly$Events$utils.CHANGE))(g,"mutation",null,a,b));var h=(0,module$exports$Blockly$Events$utils.getGroup)();setTimeout((function(){(0,module$exports$Blockly$Events$utils.setGroup)(h),g.bumpNeighbours(),(0,module$exports$Blockly$Events$utils.setGroup)(!1)}),$.module$exports$Blockly$internalConstants.BUMP_DELAY)}this.workspace_.isDragging()||this.resizeBubble_(),(0,module$exports$Blockly$Events$utils.setGroup)(!1)}},$.module$exports$Blockly$Mutator.Mutator.prototype.dispose=function(){this.block_.mutator=null,module$exports$Blockly$Icon.Icon.prototype.dispose.call(this)},$.module$exports$Blockly$Mutator.Mutator.prototype.updateBlockStyle=function(){var a=this.workspace_;if(a&&a.getAllBlocks(!1)){for(var d,b=a.getAllBlocks(!1),c=0;d=b[c];c++)d.setStyle(d.getStyleName());if(a=a.getFlyout())for(a=a.workspace_.getAllBlocks(!1),b=0;c=a[b];b++)c.setStyle(c.getStyleName())}},$.module$exports$Blockly$Mutator.Mutator.reconnect=function(a,b,c){if(!a||!a.getSourceBlock().workspace)return!1;c=b.getInput(c).connection;var d=a.targetBlock();return!(d&&d!==b||c.targetConnection===a||(c.isConnected()&&c.disconnect(),c.connect(a),0))},$.module$exports$Blockly$Mutator.Mutator.findParentWs=function(a){var b=null;if(a&&a.options){var c=a.options.parentWorkspace;a.isFlyout?c&&c.options&&(b=c.options.parentWorkspace):c&&(b=c)}return b},$.Blockly={VERSION:"7.20211209.4"},$.Blockly.ALIGN_LEFT=$.module$exports$Blockly$Input.Align.LEFT,$.Blockly.ALIGN_CENTRE=$.module$exports$Blockly$Input.Align.CENTRE,$.Blockly.ALIGN_RIGHT=$.module$exports$Blockly$Input.Align.RIGHT,$.Blockly.INPUT_VALUE=$.module$exports$Blockly$ConnectionType.ConnectionType.INPUT_VALUE,$.Blockly.OUTPUT_VALUE=$.module$exports$Blockly$ConnectionType.ConnectionType.OUTPUT_VALUE,$.Blockly.NEXT_STATEMENT=$.module$exports$Blockly$ConnectionType.ConnectionType.NEXT_STATEMENT,$.Blockly.PREVIOUS_STATEMENT=$.module$exports$Blockly$ConnectionType.ConnectionType.PREVIOUS_STATEMENT,$.Blockly.DUMMY_INPUT=$.module$exports$Blockly$inputTypes.inputTypes.DUMMY,$.Blockly.TOOLBOX_AT_TOP=module$exports$Blockly$utils$toolbox.Position.TOP,$.Blockly.TOOLBOX_AT_BOTTOM=module$exports$Blockly$utils$toolbox.Position.BOTTOM,$.Blockly.TOOLBOX_AT_LEFT=module$exports$Blockly$utils$toolbox.Position.LEFT,$.Blockly.TOOLBOX_AT_RIGHT=module$exports$Blockly$utils$toolbox.Position.RIGHT,$.Blockly.svgResize=$.module$exports$Blockly$common.svgResize,$.Blockly.hideChaff=function(a){(0,$.module$exports$Blockly$common.getMainWorkspace)().hideChaff(a)},$.Blockly.getMainWorkspace=$.module$exports$Blockly$common.getMainWorkspace,$.Blockly.defineBlocksWithJsonArray=$.module$exports$Blockly$common.defineBlocksWithJsonArray,$.Blockly.setParentContainer=$.module$exports$Blockly$common.setParentContainer,Object.defineProperties($.Blockly,{alert:{set:function(a){(0,module$exports$Blockly$utils$deprecation.warn)("Blockly.alert","December 2021","December 2022"),(0,module$exports$Blockly$dialog.setAlert)(a)},get:function(){return(0,module$exports$Blockly$utils$deprecation.warn)("Blockly.alert","December 2021","December 2022","Blockly.dialog.alert()"),module$exports$Blockly$dialog.alert}},confirm:{set:function(a){(0,module$exports$Blockly$utils$deprecation.warn)("Blockly.confirm","December 2021","December 2022"),(0,module$exports$Blockly$dialog.setConfirm)(a)},get:function(){return(0,module$exports$Blockly$utils$deprecation.warn)("Blockly.confirm","December 2021","December 2022","Blockly.dialog.confirm()"),module$exports$Blockly$dialog.confirm}},mainWorkspace:{set:function(a){(0,$.module$exports$Blockly$common.setMainWorkspace)(a)},get:function(){return(0,$.module$exports$Blockly$common.getMainWorkspace)()}},prompt:{set:function(a){(0,module$exports$Blockly$utils$deprecation.warn)("Blockly.prompt","December 2021","December 2022"),(0,module$exports$Blockly$dialog.setPrompt)(a)},get:function(){return(0,module$exports$Blockly$utils$deprecation.warn)("Blockly.prompt","December 2021","December 2022","Blockly.dialog.prompt()"),module$exports$Blockly$dialog.prompt}},selected:{get:function(){return(0,$.module$exports$Blockly$common.getSelected)()},set:function(a){(0,$.module$exports$Blockly$common.setSelected)(a)}},HSV_SATURATION:{get:function(){return module$exports$Blockly$utils.colour.getHsvSaturation()},set:function(a){module$exports$Blockly$utils.colour.setHsvSaturation(a)}},HSV_VALUE:{get:function(){return module$exports$Blockly$utils.colour.getHsvValue()},set:function(a){module$exports$Blockly$utils.colour.setHsvValue(a)}}}),$.Blockly.svgSize=module$exports$Blockly$utils$svgMath.svgSize,$.Blockly.resizeSvgContents=function(a){(0,module$exports$Blockly$utils$deprecation.warn)("Blockly.resizeSvgContents","December 2021","December 2022","Blockly.WorkspaceSvg.resizeSvgContents"),(0,module$exports$Blockly$WorkspaceSvg.resizeSvgContents)(a)},$.Blockly.copy=function(a){(0,module$exports$Blockly$utils$deprecation.warn)("Blockly.copy","December 2021","December 2022","Blockly.clipboard.copy"),(0,module$exports$Blockly$clipboard.copy)(a)},$.Blockly.paste=function(){return(0,module$exports$Blockly$utils$deprecation.warn)("Blockly.paste","December 2021","December 2022","Blockly.clipboard.paste"),(0,module$exports$Blockly$clipboard.paste)()},$.Blockly.duplicate=function(a){(0,module$exports$Blockly$utils$deprecation.warn)("Blockly.duplicate","December 2021","December 2022","Blockly.clipboard.duplicate"),(0,module$exports$Blockly$clipboard.duplicate)(a)},$.Blockly.isNumber=function(a){return(0,module$exports$Blockly$utils$deprecation.warn)("Blockly.isNumber","December 2021","December 2022","Blockly.utils.string.isNumber"),module$exports$Blockly$utils.string.isNumber(a)},$.Blockly.hueToHex=function(a){return(0,module$exports$Blockly$utils$deprecation.warn)("Blockly.hueToHex","December 2021","December 2022","Blockly.utils.colour.hueToHex"),(0,module$exports$Blockly$utils$colour.hueToHex)(a)},$.Blockly.bindEvent_=function(a,b,c,d){return(0,module$exports$Blockly$utils$deprecation.warn)("Blockly.bindEvent_","December 2021","December 2022","Blockly.browserEvents.bind"),(0,module$exports$Blockly$browserEvents.bind)(a,b,c,d)},$.Blockly.unbindEvent_=function(a){return(0,module$exports$Blockly$utils$deprecation.warn)("Blockly.unbindEvent_","December 2021","December 2022","Blockly.browserEvents.unbind"),(0,module$exports$Blockly$browserEvents.unbind)(a)},$.Blockly.bindEventWithChecks_=function(a,b,c,d,e,f){return(0,module$exports$Blockly$utils$deprecation.warn)("Blockly.bindEventWithChecks_","December 2021","December 2022","Blockly.browserEvents.conditionalBind"),(0,module$exports$Blockly$browserEvents.conditionalBind)(a,b,c,d,e,f)},$.Blockly.LINE_MODE_MULTIPLIER=$.module$exports$Blockly$internalConstants.LINE_MODE_MULTIPLIER,$.Blockly.PAGE_MODE_MULTIPLIER=$.module$exports$Blockly$internalConstants.PAGE_MODE_MULTIPLIER,$.Blockly.DRAG_RADIUS=$.module$exports$Blockly$internalConstants.DRAG_RADIUS,$.Blockly.FLYOUT_DRAG_RADIUS=$.module$exports$Blockly$internalConstants.FLYOUT_DRAG_RADIUS,$.Blockly.SNAP_RADIUS=$.module$exports$Blockly$internalConstants.SNAP_RADIUS,$.Blockly.CONNECTING_SNAP_RADIUS=$.module$exports$Blockly$internalConstants.SNAP_RADIUS,$.Blockly.CURRENT_CONNECTION_PREFERENCE=$.module$exports$Blockly$internalConstants.CURRENT_CONNECTION_PREFERENCE,$.Blockly.BUMP_DELAY=$.module$exports$Blockly$internalConstants.BUMP_DELAY,$.Blockly.BUMP_RANDOMNESS=$.module$exports$Blockly$internalConstants.BUMP_RANDOMNESS,$.Blockly.COLLAPSE_CHARS=$.module$exports$Blockly$internalConstants.COLLAPSE_CHARS,$.Blockly.LONGPRESS=$.module$exports$Blockly$internalConstants.LONGPRESS,$.Blockly.SOUND_LIMIT=$.module$exports$Blockly$internalConstants.SOUND_LIMIT,$.Blockly.DRAG_STACK=$.module$exports$Blockly$internalConstants.DRAG_STACK,$.Blockly.SPRITE=$.module$exports$Blockly$internalConstants.SPRITE,$.Blockly.DRAG_NONE=$.module$exports$Blockly$internalConstants.DRAG_NONE,$.Blockly.DRAG_STICKY=$.module$exports$Blockly$internalConstants.DRAG_STICKY,$.Blockly.DRAG_BEGIN=$.module$exports$Blockly$internalConstants.DRAG_BEGIN,$.Blockly.DRAG_FREE=$.module$exports$Blockly$internalConstants.DRAG_FREE,$.Blockly.OPPOSITE_TYPE=$.module$exports$Blockly$internalConstants.OPPOSITE_TYPE,$.Blockly.RENAME_VARIABLE_ID=$.module$exports$Blockly$internalConstants.RENAME_VARIABLE_ID,$.Blockly.DELETE_VARIABLE_ID=$.module$exports$Blockly$internalConstants.DELETE_VARIABLE_ID,$.Blockly.COLLAPSED_INPUT_NAME=module$exports$Blockly$constants.COLLAPSED_INPUT_NAME,$.Blockly.COLLAPSED_FIELD_NAME=module$exports$Blockly$constants.COLLAPSED_FIELD_NAME,$.Blockly.VARIABLE_CATEGORY_NAME=$.module$exports$Blockly$Variables.CATEGORY_NAME,$.Blockly.VARIABLE_DYNAMIC_CATEGORY_NAME=module$exports$Blockly$VariablesDynamic.CATEGORY_NAME,$.Blockly.PROCEDURE_CATEGORY_NAME=$.module$exports$Blockly$Procedures.CATEGORY_NAME,$.Blockly.ASTNode=module$exports$Blockly$ASTNode.ASTNode,$.Blockly.BasicCursor=module$exports$Blockly$BasicCursor.BasicCursor,$.Blockly.Block=module$exports$Blockly$Block.Block,$.Blockly.BlocklyOptions=function(){},$.Blockly.BlockDragger=module$exports$Blockly$BlockDragger.BlockDragger,$.Blockly.BlockDragSurfaceSvg=module$exports$Blockly$BlockDragSurfaceSvg.BlockDragSurfaceSvg,$.Blockly.BlockSvg=module$exports$Blockly$BlockSvg.BlockSvg,$.Blockly.Blocks=$.module$exports$Blockly$blocks.Blocks,$.Blockly.Bubble=module$exports$Blockly$Bubble.Bubble,$.Blockly.BubbleDragger=module$exports$Blockly$BubbleDragger.BubbleDragger,$.Blockly.CollapsibleToolboxCategory=module$exports$Blockly$CollapsibleToolboxCategory.CollapsibleToolboxCategory,$.Blockly.Comment=module$exports$Blockly$Comment.Comment,$.Blockly.ComponentManager=module$exports$Blockly$ComponentManager.ComponentManager,$.Blockly.Connection=module$exports$Blockly$Connection.Connection,$.Blockly.ConnectionType=$.module$exports$Blockly$ConnectionType.ConnectionType,$.Blockly.ConnectionChecker=module$exports$Blockly$ConnectionChecker.ConnectionChecker,$.Blockly.ConnectionDB=module$exports$Blockly$ConnectionDB.ConnectionDB,$.Blockly.ContextMenu=$.module$exports$Blockly$ContextMenu,$.Blockly.ContextMenuItems=module$exports$Blockly$ContextMenuItems,$.Blockly.ContextMenuRegistry=module$exports$Blockly$ContextMenuRegistry.ContextMenuRegistry,$.Blockly.Css=module$exports$Blockly$Css,$.Blockly.Cursor=module$exports$Blockly$Cursor.Cursor,$.Blockly.DeleteArea=module$exports$Blockly$DeleteArea.DeleteArea,$.Blockly.DragTarget=module$exports$Blockly$DragTarget.DragTarget,$.Blockly.DropDownDiv=module$exports$Blockly$DropDownDiv.DropDownDiv,$.Blockly.Events=$.module$exports$Blockly$Events,$.Blockly.Extensions=$.module$exports$Blockly$Extensions,$.Blockly.Field=module$exports$Blockly$Field.Field,$.Blockly.FieldAngle=module$exports$Blockly$FieldAngle.FieldAngle,$.Blockly.FieldCheckbox=$.module$exports$Blockly$FieldCheckbox.FieldCheckbox,$.Blockly.FieldColour=module$exports$Blockly$FieldColour.FieldColour,$.Blockly.FieldDropdown=$.module$exports$Blockly$FieldDropdown.FieldDropdown,$.Blockly.FieldImage=$.module$exports$Blockly$FieldImage.FieldImage,$.Blockly.FieldLabel=$.module$exports$Blockly$FieldLabel.FieldLabel,$.Blockly.FieldLabelSerializable=module$exports$Blockly$FieldLabelSerializable.FieldLabelSerializable,$.Blockly.FieldMultilineInput=module$exports$Blockly$FieldMultilineInput.FieldMultilineInput,$.Blockly.FieldNumber=module$exports$Blockly$FieldNumber.FieldNumber,$.Blockly.FieldTextInput=$.module$exports$Blockly$FieldTextInput.FieldTextInput,$.Blockly.FieldVariable=module$exports$Blockly$FieldVariable.FieldVariable,$.Blockly.Flyout=module$exports$Blockly$Flyout.Flyout,$.Blockly.FlyoutButton=module$exports$Blockly$FlyoutButton.FlyoutButton,$.Blockly.FlyoutMetricsManager=module$exports$Blockly$FlyoutMetricsManager.FlyoutMetricsManager,$.Blockly.Generator=$.module$exports$Blockly$Generator.Generator,$.Blockly.Gesture=module$exports$Blockly$Gesture.Gesture,$.Blockly.Grid=module$exports$Blockly$Grid.Grid,$.Blockly.HorizontalFlyout=module$exports$Blockly$HorizontalFlyout.HorizontalFlyout,$.Blockly.IASTNodeLocation=function(){},$.Blockly.IASTNodeLocationSvg=function(){},$.Blockly.IASTNodeLocationWithBlock=function(){},$.Blockly.IAutoHideable=function(){},$.Blockly.IBlockDragger=function(){},$.Blockly.IBoundedElement=function(){},$.Blockly.IBubble=function(){},$.Blockly.ICollapsibleToolboxItem=function(){},$.Blockly.IComponent=function(){},$.Blockly.IConnectionChecker=function(){},$.Blockly.IContextMenu=function(){},$.Blockly.Icon=module$exports$Blockly$Icon.Icon,$.Blockly.ICopyable=function(){},$.Blockly.IDeletable=function(){},$.Blockly.IDeleteArea=function(){},$.Blockly.IDragTarget=function(){},$.Blockly.IDraggable=function(){},$.Blockly.IFlyout=function(){},$.Blockly.IKeyboardAccessible=function(){},$.Blockly.IMetricsManager=function(){},$.Blockly.IMovable=function(){},$.Blockly.Input=$.module$exports$Blockly$Input.Input,$.Blockly.InsertionMarkerManager=module$exports$Blockly$InsertionMarkerManager.InsertionMarkerManager,$.Blockly.IPositionable=function(){},$.Blockly.IRegistrable=function(){},$.Blockly.IRegistrableField={},$.Blockly.ISelectable=function(){},$.Blockly.ISelectableToolboxItem=function(){},$.Blockly.IStyleable=function(){},$.Blockly.IToolbox=function(){},$.Blockly.IToolboxItem=function(){},$.Blockly.Marker=module$exports$Blockly$Marker.Marker,$.Blockly.MarkerManager=module$exports$Blockly$MarkerManager.MarkerManager,$.Blockly.Menu=module$exports$Blockly$Menu.Menu,$.Blockly.MenuItem=module$exports$Blockly$MenuItem.MenuItem,$.Blockly.MetricsManager=module$exports$Blockly$MetricsManager.MetricsManager,$.Blockly.Mutator=$.module$exports$Blockly$Mutator.Mutator,$.Blockly.Msg=$.module$exports$Blockly$Msg.Msg,$.Blockly.Names=$.module$exports$Blockly$Names.Names,$.Blockly.Options=module$exports$Blockly$Options.Options,$.Blockly.Procedures=$.module$exports$Blockly$Procedures,$.Blockly.RenderedConnection=module$exports$Blockly$RenderedConnection.RenderedConnection,$.Blockly.Scrollbar=module$exports$Blockly$Scrollbar.Scrollbar,$.Blockly.ScrollbarPair=module$exports$Blockly$ScrollbarPair.ScrollbarPair,$.Blockly.ShortcutItems=module$exports$Blockly$ShortcutItems,$.Blockly.ShortcutRegistry=module$exports$Blockly$ShortcutRegistry.ShortcutRegistry,$.Blockly.TabNavigateCursor=module$exports$Blockly$TabNavigateCursor.TabNavigateCursor,$.Blockly.Theme=module$exports$Blockly$Theme.Theme,$.Blockly.Themes=module$exports$Blockly$Themes,$.Blockly.ThemeManager=module$exports$Blockly$ThemeManager.ThemeManager,$.Blockly.Toolbox=module$exports$Blockly$Toolbox.Toolbox,$.Blockly.ToolboxCategory=module$exports$Blockly$ToolboxCategory.ToolboxCategory,$.Blockly.ToolboxItem=module$exports$Blockly$ToolboxItem.ToolboxItem,$.Blockly.ToolboxSeparator=module$exports$Blockly$ToolboxSeparator.ToolboxSeparator,$.Blockly.Tooltip=module$exports$Blockly$Tooltip,$.Blockly.Touch=module$exports$Blockly$Touch,$.Blockly.TouchGesture=module$exports$Blockly$TouchGesture.TouchGesture,$.Blockly.Trashcan=module$exports$Blockly$Trashcan.Trashcan,$.Blockly.VariableMap=module$exports$Blockly$VariableMap.VariableMap,$.Blockly.VariableModel=module$exports$Blockly$VariableModel.VariableModel,$.Blockly.Variables=$.module$exports$Blockly$Variables,$.Blockly.VariablesDynamic=module$exports$Blockly$VariablesDynamic,$.Blockly.VerticalFlyout=module$exports$Blockly$VerticalFlyout.VerticalFlyout,$.Blockly.Warning=module$exports$Blockly$Warning.Warning,$.Blockly.WidgetDiv=module$exports$Blockly$WidgetDiv,$.Blockly.Workspace=module$exports$Blockly$Workspace.Workspace,$.Blockly.WorkspaceAudio=module$exports$Blockly$WorkspaceAudio.WorkspaceAudio,$.Blockly.WorkspaceComment=module$exports$Blockly$WorkspaceComment.WorkspaceComment,$.Blockly.WorkspaceCommentSvg=module$exports$Blockly$WorkspaceCommentSvg.WorkspaceCommentSvg,$.Blockly.WorkspaceDragSurfaceSvg=module$exports$Blockly$WorkspaceDragSurfaceSvg.WorkspaceDragSurfaceSvg,$.Blockly.WorkspaceDragger=module$exports$Blockly$WorkspaceDragger.WorkspaceDragger,$.Blockly.WorkspaceSvg=module$exports$Blockly$WorkspaceSvg.WorkspaceSvg,$.Blockly.Xml=$.module$exports$Blockly$Xml,$.Blockly.ZoomControls=module$exports$Blockly$ZoomControls.ZoomControls,$.Blockly.blockAnimations=module$exports$Blockly$blockAnimations,$.Blockly.blockRendering=module$exports$Blockly$blockRendering,$.Blockly.browserEvents=module$exports$Blockly$browserEvents,$.Blockly.bumpObjects=module$exports$Blockly$bumpObjects,$.Blockly.clipboard=module$exports$Blockly$clipboard,$.Blockly.common=$.module$exports$Blockly$common,$.Blockly.connectionTypes=$.module$exports$Blockly$ConnectionType.ConnectionType,$.Blockly.constants=module$exports$Blockly$constants,$.Blockly.dialog=module$exports$Blockly$dialog,$.Blockly.fieldRegistry=module$exports$Blockly$fieldRegistry,$.Blockly.geras=module$exports$Blockly$geras,$.Blockly.inject=module$exports$Blockly$inject_inject,$.Blockly.inputTypes=$.module$exports$Blockly$inputTypes.inputTypes,$.Blockly.minimalist=module$exports$Blockly$minimalist,$.Blockly.registry=module$exports$Blockly$registry,$.Blockly.serialization={blocks:module$exports$Blockly$serialization$blocks,exceptions:module$exports$Blockly$serialization$exceptions,priorities:module$exports$Blockly$serialization$priorities,registry:module$exports$Blockly$serialization$registry,variables:{},workspaces:module$exports$Blockly$serialization$workspaces,ISerializer:module$exports$Blockly$serialization$ISerializer.ISerializer},$.Blockly.thrasos=module$exports$Blockly$thrasos,$.Blockly.uiPosition=module$exports$Blockly$uiPosition,$.Blockly.utils=module$exports$Blockly$utils,$.Blockly.zelos=module$exports$Blockly$zelos,"Blockly"in $.module$exports$Blockly$utils$global.globalThis||($.module$exports$Blockly$utils$global.globalThis.Blockly={Msg:$.module$exports$Blockly$Msg.Msg}),$.Blockly.internal_=$,$.Blockly},__WEBPACK_AMD_DEFINE_ARRAY__=[],void 0===(__WEBPACK_AMD_DEFINE_RESULT__="function"==typeof(__WEBPACK_AMD_DEFINE_FACTORY__=factory)?__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__):__WEBPACK_AMD_DEFINE_FACTORY__)||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},1003:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(6904)],void 0===(__WEBPACK_AMD_DEFINE_RESULT__="function"==typeof(__WEBPACK_AMD_DEFINE_FACTORY__=function(BlocklyBlocks){return BlocklyBlocks})?__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__):__WEBPACK_AMD_DEFINE_FACTORY__)||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},6904:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(1334)],void 0===(__WEBPACK_AMD_DEFINE_RESULT__="function"==typeof(__WEBPACK_AMD_DEFINE_FACTORY__=function(Blockly){const $=Blockly.internal_;(0,$.module$exports$Blockly$common.defineBlocksWithJsonArray)([{type:"variables_get_dynamic",message0:"%1",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"}],output:null,style:"variable_dynamic_blocks",helpUrl:"%{BKY_VARIABLES_GET_HELPURL}",tooltip:"%{BKY_VARIABLES_GET_TOOLTIP}",extensions:["contextMenu_variableDynamicSetterGetter"]},{type:"variables_set_dynamic",message0:"%{BKY_VARIABLES_SET}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"},{type:"input_value",name:"VALUE"}],previousStatement:null,nextStatement:null,style:"variable_dynamic_blocks",tooltip:"%{BKY_VARIABLES_SET_TOOLTIP}",helpUrl:"%{BKY_VARIABLES_SET_HELPURL}",extensions:["contextMenu_variableDynamicSetterGetter"]}]);var module$contents$Blockly$blocks$variablesDynamic_CUSTOM_CONTEXT_MENU_VARIABLE_GETTER_SETTER_MIXIN={customContextMenu:function(a){if(this.isInFlyout)"variables_get_dynamic"!==this.type&&"variables_get_reporter_dynamic"!==this.type||(b={text:$.module$exports$Blockly$Msg.Msg.RENAME_VARIABLE,enabled:!0,callback:module$contents$Blockly$blocks$variablesDynamic_renameOptionCallbackFactory(this)},e=this.getField("VAR").getText(),e={text:$.module$exports$Blockly$Msg.Msg.DELETE_VARIABLE.replace("%1",e),enabled:!0,callback:module$contents$Blockly$blocks$variablesDynamic_deleteOptionCallbackFactory(this)},a.unshift(b),a.unshift(e));else{var b=this.getFieldValue("VAR"),c=this.workspace.getVariableById(b).type;if("variables_get_dynamic"===this.type){b="variables_set_dynamic";var d=$.module$exports$Blockly$Msg.Msg.VARIABLES_GET_CREATE_SET}else b="variables_get_dynamic",d=$.module$exports$Blockly$Msg.Msg.VARIABLES_SET_CREATE_GET;var e={enabled:0<this.workspace.remainingCapacity()},f=this.getField("VAR").getText();e.text=d.replace("%1",f),(d=(0,$.module$exports$Blockly$utils$xml.createElement)("field")).setAttribute("name","VAR"),d.setAttribute("variabletype",c),d.appendChild((0,$.module$exports$Blockly$utils$xml.createTextNode)(f)),(c=(0,$.module$exports$Blockly$utils$xml.createElement)("block")).setAttribute("type",b),c.appendChild(d),e.callback=(0,$.module$exports$Blockly$ContextMenu.callbackFactory)(this,c),a.push(e)}},onchange:function(a){a=this.getFieldValue("VAR"),a=(0,$.module$exports$Blockly$Variables.getVariable)(this.workspace,a),"variables_get_dynamic"===this.type?this.outputConnection.setCheck(a.type):this.getInput("VALUE").connection.setCheck(a.type)}},module$contents$Blockly$blocks$variablesDynamic_renameOptionCallbackFactory=function(a){return function(){var b=a.workspace,c=a.getField("VAR").getVariable();(0,$.module$exports$Blockly$Variables.renameVariable)(b,c)}},module$contents$Blockly$blocks$variablesDynamic_deleteOptionCallbackFactory=function(a){return function(){var b=a.workspace,c=a.getField("VAR").getVariable();b.deleteVariableById(c.getId()),b.refreshToolboxSelection()}};(0,$.module$exports$Blockly$Extensions.registerMixin)("contextMenu_variableDynamicSetterGetter",module$contents$Blockly$blocks$variablesDynamic_CUSTOM_CONTEXT_MENU_VARIABLE_GETTER_SETTER_MIXIN),(0,$.module$exports$Blockly$common.defineBlocksWithJsonArray)([{type:"variables_get",message0:"%1",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"}],output:null,style:"variable_blocks",helpUrl:"%{BKY_VARIABLES_GET_HELPURL}",tooltip:"%{BKY_VARIABLES_GET_TOOLTIP}",extensions:["contextMenu_variableSetterGetter"]},{type:"variables_set",message0:"%{BKY_VARIABLES_SET}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"},{type:"input_value",name:"VALUE"}],previousStatement:null,nextStatement:null,style:"variable_blocks",tooltip:"%{BKY_VARIABLES_SET_TOOLTIP}",helpUrl:"%{BKY_VARIABLES_SET_HELPURL}",extensions:["contextMenu_variableSetterGetter"]}]);var module$contents$Blockly$blocks$variables_CUSTOM_CONTEXT_MENU_VARIABLE_GETTER_SETTER_MIXIN={customContextMenu:function(a){if(this.isInFlyout)"variables_get"!==this.type&&"variables_get_reporter"!==this.type||(b={text:$.module$exports$Blockly$Msg.Msg.RENAME_VARIABLE,enabled:!0,callback:module$contents$Blockly$blocks$variables_renameOptionCallbackFactory(this)},d=this.getField("VAR").getText(),d={text:$.module$exports$Blockly$Msg.Msg.DELETE_VARIABLE.replace("%1",d),enabled:!0,callback:module$contents$Blockly$blocks$variables_deleteOptionCallbackFactory(this)},a.unshift(b),a.unshift(d));else{if("variables_get"===this.type)var b="variables_set",c=$.module$exports$Blockly$Msg.Msg.VARIABLES_GET_CREATE_SET;else b="variables_get",c=$.module$exports$Blockly$Msg.Msg.VARIABLES_SET_CREATE_GET;var d={enabled:0<this.workspace.remainingCapacity()},e=this.getField("VAR").getText();d.text=c.replace("%1",e),(c=(0,$.module$exports$Blockly$utils$xml.createElement)("field")).setAttribute("name","VAR"),c.appendChild((0,$.module$exports$Blockly$utils$xml.createTextNode)(e)),(e=(0,$.module$exports$Blockly$utils$xml.createElement)("block")).setAttribute("type",b),e.appendChild(c),d.callback=(0,$.module$exports$Blockly$ContextMenu.callbackFactory)(this,e),a.push(d)}}},module$contents$Blockly$blocks$variables_renameOptionCallbackFactory=function(a){return function(){var b=a.workspace,c=a.getField("VAR").getVariable();(0,$.module$exports$Blockly$Variables.renameVariable)(b,c)}},module$contents$Blockly$blocks$variables_deleteOptionCallbackFactory=function(a){return function(){var b=a.workspace,c=a.getField("VAR").getVariable();b.deleteVariableById(c.getId()),b.refreshToolboxSelection()}};(0,$.module$exports$Blockly$Extensions.registerMixin)("contextMenu_variableSetterGetter",module$contents$Blockly$blocks$variables_CUSTOM_CONTEXT_MENU_VARIABLE_GETTER_SETTER_MIXIN),(0,$.module$exports$Blockly$common.defineBlocksWithJsonArray)([{type:"text",message0:"%1",args0:[{type:"field_input",name:"TEXT",text:""}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_TEXT_HELPURL}",tooltip:"%{BKY_TEXT_TEXT_TOOLTIP}",extensions:["text_quotes","parent_tooltip_when_inline"]},{type:"text_multiline",message0:"%1 %2",args0:[{type:"field_image",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAARCAYAAADpPU2iAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAdhgAAHYYBXaITgQAAABh0RVh0U29mdHdhcmUAcGFpbnQubmV0IDQuMS42/U4J6AAAAP1JREFUOE+Vks0KQUEYhjmRIja4ABtZ2dm5A3t3Ia6AUm7CylYuQRaUhZSlLZJiQbFAyRnPN33y01HOW08z8873zpwzM4F3GWOCruvGIE4/rLaV+Nq1hVGMBqzhqlxgCys4wJA65xnogMHsQ5lujnYHTejBBCK2mE4abjCgMGhNxHgDFWjDSG07kdfVa2pZMf4ZyMAdWmpZMfYOsLiDMYMjlMB+K613QISRhTnITnsYg5yUd0DETmEoMlkFOeIT/A58iyK5E18BuTBfgYXfwNJv4P9/oEBerLylOnRhygmGdPpTTBZAPkde61lbQe4moWUvYUZYLfUNftIY4zwA5X2Z9AYnQrEAAAAASUVORK5CYII=",width:12,height:17,alt:""},{type:"field_multilinetext",name:"TEXT",text:""}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_TEXT_HELPURL}",tooltip:"%{BKY_TEXT_TEXT_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"text_join",message0:"",output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_JOIN_HELPURL}",tooltip:"%{BKY_TEXT_JOIN_TOOLTIP}",mutator:"text_join_mutator"},{type:"text_create_join_container",message0:"%{BKY_TEXT_CREATE_JOIN_TITLE_JOIN} %1 %2",args0:[{type:"input_dummy"},{type:"input_statement",name:"STACK"}],style:"text_blocks",tooltip:"%{BKY_TEXT_CREATE_JOIN_TOOLTIP}",enableContextMenu:!1},{type:"text_create_join_item",message0:"%{BKY_TEXT_CREATE_JOIN_ITEM_TITLE_ITEM}",previousStatement:null,nextStatement:null,style:"text_blocks",tooltip:"%{BKY_TEXT_CREATE_JOIN_ITEM_TOOLTIP}",enableContextMenu:!1},{type:"text_append",message0:"%{BKY_TEXT_APPEND_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_TEXT_APPEND_VARIABLE}"},{type:"input_value",name:"TEXT"}],previousStatement:null,nextStatement:null,style:"text_blocks",extensions:["text_append_tooltip"]},{type:"text_length",message0:"%{BKY_TEXT_LENGTH_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Number",style:"text_blocks",tooltip:"%{BKY_TEXT_LENGTH_TOOLTIP}",helpUrl:"%{BKY_TEXT_LENGTH_HELPURL}"},{type:"text_isEmpty",message0:"%{BKY_TEXT_ISEMPTY_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Boolean",style:"text_blocks",tooltip:"%{BKY_TEXT_ISEMPTY_TOOLTIP}",helpUrl:"%{BKY_TEXT_ISEMPTY_HELPURL}"},{type:"text_indexOf",message0:"%{BKY_TEXT_INDEXOF_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"String"},{type:"field_dropdown",name:"END",options:[["%{BKY_TEXT_INDEXOF_OPERATOR_FIRST}","FIRST"],["%{BKY_TEXT_INDEXOF_OPERATOR_LAST}","LAST"]]},{type:"input_value",name:"FIND",check:"String"}],output:"Number",style:"text_blocks",helpUrl:"%{BKY_TEXT_INDEXOF_HELPURL}",inputsInline:!0,extensions:["text_indexOf_tooltip"]},{type:"text_charAt",message0:"%{BKY_TEXT_CHARAT_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"String"},{type:"field_dropdown",name:"WHERE",options:[["%{BKY_TEXT_CHARAT_FROM_START}","FROM_START"],["%{BKY_TEXT_CHARAT_FROM_END}","FROM_END"],["%{BKY_TEXT_CHARAT_FIRST}","FIRST"],["%{BKY_TEXT_CHARAT_LAST}","LAST"],["%{BKY_TEXT_CHARAT_RANDOM}","RANDOM"]]}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_CHARAT_HELPURL}",inputsInline:!0,mutator:"text_charAt_mutator"}]),$.module$exports$Blockly$blocks.Blocks.text_getSubstring={init:function(){this.WHERE_OPTIONS_1=[[$.module$exports$Blockly$Msg.Msg.TEXT_GET_SUBSTRING_START_FROM_START,"FROM_START"],[$.module$exports$Blockly$Msg.Msg.TEXT_GET_SUBSTRING_START_FROM_END,"FROM_END"],[$.module$exports$Blockly$Msg.Msg.TEXT_GET_SUBSTRING_START_FIRST,"FIRST"]],this.WHERE_OPTIONS_2=[[$.module$exports$Blockly$Msg.Msg.TEXT_GET_SUBSTRING_END_FROM_START,"FROM_START"],[$.module$exports$Blockly$Msg.Msg.TEXT_GET_SUBSTRING_END_FROM_END,"FROM_END"],[$.module$exports$Blockly$Msg.Msg.TEXT_GET_SUBSTRING_END_LAST,"LAST"]],this.setHelpUrl($.module$exports$Blockly$Msg.Msg.TEXT_GET_SUBSTRING_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("STRING").setCheck("String").appendField($.module$exports$Blockly$Msg.Msg.TEXT_GET_SUBSTRING_INPUT_IN_TEXT),this.appendDummyInput("AT1"),this.appendDummyInput("AT2"),$.module$exports$Blockly$Msg.Msg.TEXT_GET_SUBSTRING_TAIL&&this.appendDummyInput("TAIL").appendField($.module$exports$Blockly$Msg.Msg.TEXT_GET_SUBSTRING_TAIL),this.setInputsInline(!0),this.setOutput(!0,"String"),this.updateAt_(1,!0),this.updateAt_(2,!0),this.setTooltip($.module$exports$Blockly$Msg.Msg.TEXT_GET_SUBSTRING_TOOLTIP)},mutationToDom:function(){var a=(0,$.module$exports$Blockly$utils$xml.createElement)("mutation"),b=this.getInput("AT1").type===$.module$exports$Blockly$ConnectionType.ConnectionType.INPUT_VALUE;return a.setAttribute("at1",b),b=this.getInput("AT2").type===$.module$exports$Blockly$ConnectionType.ConnectionType.INPUT_VALUE,a.setAttribute("at2",b),a},domToMutation:function(a){var b="true"===a.getAttribute("at1");a="true"===a.getAttribute("at2"),this.updateAt_(1,b),this.updateAt_(2,a)},updateAt_:function(a,b){this.removeInput("AT"+a),this.removeInput("ORDINAL"+a,!0),b?(this.appendValueInput("AT"+a).setCheck("Number"),$.module$exports$Blockly$Msg.Msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL"+a).appendField($.module$exports$Blockly$Msg.Msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"+a),2===a&&$.module$exports$Blockly$Msg.Msg.TEXT_GET_SUBSTRING_TAIL&&(this.removeInput("TAIL",!0),this.appendDummyInput("TAIL").appendField($.module$exports$Blockly$Msg.Msg.TEXT_GET_SUBSTRING_TAIL));var c=new $.module$exports$Blockly$FieldDropdown.FieldDropdown(this["WHERE_OPTIONS_"+a],(function(d){var e="FROM_START"===d||"FROM_END"===d;if(e!==b){var f=this.getSourceBlock();return f.updateAt_(a,e),f.setFieldValue(d,"WHERE"+a),null}}));this.getInput("AT"+a).appendField(c,"WHERE"+a),1===a&&(this.moveInputBefore("AT1","AT2"),this.getInput("ORDINAL1")&&this.moveInputBefore("ORDINAL1","AT2"))}},$.module$exports$Blockly$blocks.Blocks.text_changeCase={init:function(){var a=[[$.module$exports$Blockly$Msg.Msg.TEXT_CHANGECASE_OPERATOR_UPPERCASE,"UPPERCASE"],[$.module$exports$Blockly$Msg.Msg.TEXT_CHANGECASE_OPERATOR_LOWERCASE,"LOWERCASE"],[$.module$exports$Blockly$Msg.Msg.TEXT_CHANGECASE_OPERATOR_TITLECASE,"TITLECASE"]];this.setHelpUrl($.module$exports$Blockly$Msg.Msg.TEXT_CHANGECASE_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("TEXT").setCheck("String").appendField(new $.module$exports$Blockly$FieldDropdown.FieldDropdown(a),"CASE"),this.setOutput(!0,"String"),this.setTooltip($.module$exports$Blockly$Msg.Msg.TEXT_CHANGECASE_TOOLTIP)}},$.module$exports$Blockly$blocks.Blocks.text_trim={init:function(){var a=[[$.module$exports$Blockly$Msg.Msg.TEXT_TRIM_OPERATOR_BOTH,"BOTH"],[$.module$exports$Blockly$Msg.Msg.TEXT_TRIM_OPERATOR_LEFT,"LEFT"],[$.module$exports$Blockly$Msg.Msg.TEXT_TRIM_OPERATOR_RIGHT,"RIGHT"]];this.setHelpUrl($.module$exports$Blockly$Msg.Msg.TEXT_TRIM_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("TEXT").setCheck("String").appendField(new $.module$exports$Blockly$FieldDropdown.FieldDropdown(a),"MODE"),this.setOutput(!0,"String"),this.setTooltip($.module$exports$Blockly$Msg.Msg.TEXT_TRIM_TOOLTIP)}},$.module$exports$Blockly$blocks.Blocks.text_print={init:function(){this.jsonInit({message0:$.module$exports$Blockly$Msg.Msg.TEXT_PRINT_TITLE,args0:[{type:"input_value",name:"TEXT"}],previousStatement:null,nextStatement:null,style:"text_blocks",tooltip:$.module$exports$Blockly$Msg.Msg.TEXT_PRINT_TOOLTIP,helpUrl:$.module$exports$Blockly$Msg.Msg.TEXT_PRINT_HELPURL})}};var module$contents$Blockly$blocks$texts_TEXT_PROMPT_COMMON={updateType_:function(a){this.outputConnection.setCheck("NUMBER"===a?"Number":"String")},mutationToDom:function(){var a=(0,$.module$exports$Blockly$utils$xml.createElement)("mutation");return a.setAttribute("type",this.getFieldValue("TYPE")),a},domToMutation:function(a){this.updateType_(a.getAttribute("type"))}};$.module$exports$Blockly$blocks.Blocks.text_prompt_ext=Object.assign({},module$contents$Blockly$blocks$texts_TEXT_PROMPT_COMMON,{init:function(){var a=[[$.module$exports$Blockly$Msg.Msg.TEXT_PROMPT_TYPE_TEXT,"TEXT"],[$.module$exports$Blockly$Msg.Msg.TEXT_PROMPT_TYPE_NUMBER,"NUMBER"]];this.setHelpUrl($.module$exports$Blockly$Msg.Msg.TEXT_PROMPT_HELPURL),this.setStyle("text_blocks");var b=this;a=new $.module$exports$Blockly$FieldDropdown.FieldDropdown(a,(function(c){b.updateType_(c)})),this.appendValueInput("TEXT").appendField(a,"TYPE"),this.setOutput(!0,"String"),this.setTooltip((function(){return"TEXT"===b.getFieldValue("TYPE")?$.module$exports$Blockly$Msg.Msg.TEXT_PROMPT_TOOLTIP_TEXT:$.module$exports$Blockly$Msg.Msg.TEXT_PROMPT_TOOLTIP_NUMBER}))}}),$.module$exports$Blockly$blocks.Blocks.text_prompt=Object.assign({},module$contents$Blockly$blocks$texts_TEXT_PROMPT_COMMON,{init:function(){this.mixin(module$contents$Blockly$blocks$texts_QUOTE_IMAGE_MIXIN);var a=[[$.module$exports$Blockly$Msg.Msg.TEXT_PROMPT_TYPE_TEXT,"TEXT"],[$.module$exports$Blockly$Msg.Msg.TEXT_PROMPT_TYPE_NUMBER,"NUMBER"]],b=this;this.setHelpUrl($.module$exports$Blockly$Msg.Msg.TEXT_PROMPT_HELPURL),this.setStyle("text_blocks"),a=new $.module$exports$Blockly$FieldDropdown.FieldDropdown(a,(function(c){b.updateType_(c)})),this.appendDummyInput().appendField(a,"TYPE").appendField(this.newQuote_(!0)).appendField(new $.module$exports$Blockly$FieldTextInput.FieldTextInput(""),"TEXT").appendField(this.newQuote_(!1)),this.setOutput(!0,"String"),this.setTooltip((function(){return"TEXT"===b.getFieldValue("TYPE")?$.module$exports$Blockly$Msg.Msg.TEXT_PROMPT_TOOLTIP_TEXT:$.module$exports$Blockly$Msg.Msg.TEXT_PROMPT_TOOLTIP_NUMBER}))}}),$.module$exports$Blockly$blocks.Blocks.text_count={init:function(){this.jsonInit({message0:$.module$exports$Blockly$Msg.Msg.TEXT_COUNT_MESSAGE0,args0:[{type:"input_value",name:"SUB",check:"String"},{type:"input_value",name:"TEXT",check:"String"}],output:"Number",inputsInline:!0,style:"text_blocks",tooltip:$.module$exports$Blockly$Msg.Msg.TEXT_COUNT_TOOLTIP,helpUrl:$.module$exports$Blockly$Msg.Msg.TEXT_COUNT_HELPURL})}},$.module$exports$Blockly$blocks.Blocks.text_replace={init:function(){this.jsonInit({message0:$.module$exports$Blockly$Msg.Msg.TEXT_REPLACE_MESSAGE0,args0:[{type:"input_value",name:"FROM",check:"String"},{type:"input_value",name:"TO",check:"String"},{type:"input_value",name:"TEXT",check:"String"}],output:"String",inputsInline:!0,style:"text_blocks",tooltip:$.module$exports$Blockly$Msg.Msg.TEXT_REPLACE_TOOLTIP,helpUrl:$.module$exports$Blockly$Msg.Msg.TEXT_REPLACE_HELPURL})}},$.module$exports$Blockly$blocks.Blocks.text_reverse={init:function(){this.jsonInit({message0:$.module$exports$Blockly$Msg.Msg.TEXT_REVERSE_MESSAGE0,args0:[{type:"input_value",name:"TEXT",check:"String"}],output:"String",inputsInline:!0,style:"text_blocks",tooltip:$.module$exports$Blockly$Msg.Msg.TEXT_REVERSE_TOOLTIP,helpUrl:$.module$exports$Blockly$Msg.Msg.TEXT_REVERSE_HELPURL})}};var module$contents$Blockly$blocks$texts_QUOTE_IMAGE_MIXIN={QUOTE_IMAGE_LEFT_DATAURI:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAKCAQAAAAqJXdxAAAAn0lEQVQI1z3OMa5BURSF4f/cQhAKjUQhuQmFNwGJEUi0RKN5rU7FHKhpjEH3TEMtkdBSCY1EIv8r7nFX9e29V7EBAOvu7RPjwmWGH/VuF8CyN9/OAdvqIXYLvtRaNjx9mMTDyo+NjAN1HNcl9ZQ5oQMM3dgDUqDo1l8DzvwmtZN7mnD+PkmLa+4mhrxVA9fRowBWmVBhFy5gYEjKMfz9AylsaRRgGzvZAAAAAElFTkSuQmCC",QUOTE_IMAGE_RIGHT_DATAURI:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAKCAQAAAAqJXdxAAAAqUlEQVQI1z3KvUpCcRiA8ef9E4JNHhI0aFEacm1o0BsI0Slx8wa8gLauoDnoBhq7DcfWhggONDmJJgqCPA7neJ7p934EOOKOnM8Q7PDElo/4x4lFb2DmuUjcUzS3URnGib9qaPNbuXvBO3sGPHJDRG6fGVdMSeWDP2q99FQdFrz26Gu5Tq7dFMzUvbXy8KXeAj57cOklgA+u1B5AoslLtGIHQMaCVnwDnADZIFIrXsoXrgAAAABJRU5ErkJggg==",QUOTE_IMAGE_WIDTH:12,QUOTE_IMAGE_HEIGHT:12,quoteField_:function(a){for(var c,b=0;c=this.inputList[b];b++)for(var e,d=0;e=c.fieldRow[d];d++)if(a===e.name)return c.insertFieldAt(d,this.newQuote_(!0)),void c.insertFieldAt(d+2,this.newQuote_(!1));console.warn('field named "'+a+'" not found in '+this.toDevString())},newQuote_:function(a){return a=this.RTL?!a:a,new $.module$exports$Blockly$FieldImage.FieldImage(a?this.QUOTE_IMAGE_LEFT_DATAURI:this.QUOTE_IMAGE_RIGHT_DATAURI,this.QUOTE_IMAGE_WIDTH,this.QUOTE_IMAGE_HEIGHT,a?"":"")}},module$contents$Blockly$blocks$texts_TEXT_QUOTES_EXTENSION=function(){this.mixin(module$contents$Blockly$blocks$texts_QUOTE_IMAGE_MIXIN),this.quoteField_("TEXT")},module$contents$Blockly$blocks$texts_TEXT_JOIN_MUTATOR_MIXIN={mutationToDom:function(){var a=(0,$.module$exports$Blockly$utils$xml.createElement)("mutation");return a.setAttribute("items",this.itemCount_),a},domToMutation:function(a){this.itemCount_=parseInt(a.getAttribute("items"),10),this.updateShape_()},saveExtraState:function(){return{itemCount:this.itemCount_}},loadExtraState:function(a){this.itemCount_=a.itemCount,this.updateShape_()},decompose:function(a){var b=a.newBlock("text_create_join_container");b.initSvg();for(var c=b.getInput("STACK").connection,d=0;d<this.itemCount_;d++){var e=a.newBlock("text_create_join_item");e.initSvg(),c.connect(e.previousConnection),c=e.nextConnection}return b},compose:function(a){var b=a.getInputTargetBlock("STACK");for(a=[];b&&!b.isInsertionMarker();)a.push(b.valueConnection_),b=b.nextConnection&&b.nextConnection.targetBlock();for(b=0;b<this.itemCount_;b++){var c=this.getInput("ADD"+b).connection.targetConnection;c&&-1===a.indexOf(c)&&c.disconnect()}for(this.itemCount_=a.length,this.updateShape_(),b=0;b<this.itemCount_;b++)$.module$exports$Blockly$Mutator.Mutator.reconnect(a[b],this,"ADD"+b)},saveConnections:function(a){a=a.getInputTargetBlock("STACK");for(var b=0;a;){var c=this.getInput("ADD"+b);a.valueConnection_=c&&c.connection.targetConnection,a=a.nextConnection&&a.nextConnection.targetBlock(),b++}},updateShape_:function(){this.itemCount_&&this.getInput("EMPTY")?this.removeInput("EMPTY"):this.itemCount_||this.getInput("EMPTY")||this.appendDummyInput("EMPTY").appendField(this.newQuote_(!0)).appendField(this.newQuote_(!1));for(var a=0;a<this.itemCount_;a++)if(!this.getInput("ADD"+a)){var b=this.appendValueInput("ADD"+a).setAlign($.module$exports$Blockly$Input.Align.RIGHT);0===a&&b.appendField($.module$exports$Blockly$Msg.Msg.TEXT_JOIN_TITLE_CREATEWITH)}for(a=this.itemCount_;this.getInput("ADD"+a);a++)this.removeInput("ADD"+a)}},module$contents$Blockly$blocks$texts_TEXT_JOIN_EXTENSION=function(){this.mixin(module$contents$Blockly$blocks$texts_QUOTE_IMAGE_MIXIN),this.itemCount_=2,this.updateShape_(),this.setMutator(new $.module$exports$Blockly$Mutator.Mutator(["text_create_join_item"]))};(0,$.module$exports$Blockly$Extensions.register)("text_append_tooltip",(0,$.module$exports$Blockly$Extensions.buildTooltipWithFieldText)("%{BKY_TEXT_APPEND_TOOLTIP}","VAR"));var module$contents$Blockly$blocks$texts_TEXT_INDEXOF_TOOLTIP_EXTENSION=function(){var a=this;this.setTooltip((function(){return $.module$exports$Blockly$Msg.Msg.TEXT_INDEXOF_TOOLTIP.replace("%1",a.workspace.options.oneBasedIndex?"0":"-1")}))},module$contents$Blockly$blocks$texts_TEXT_CHARAT_MUTATOR_MIXIN={mutationToDom:function(){var a=(0,$.module$exports$Blockly$utils$xml.createElement)("mutation");return a.setAttribute("at",!!this.isAt_),a},domToMutation:function(a){a="false"!==a.getAttribute("at"),this.updateAt_(a)},updateAt_:function(a){this.removeInput("AT",!0),this.removeInput("ORDINAL",!0),a&&(this.appendValueInput("AT").setCheck("Number"),$.module$exports$Blockly$Msg.Msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField($.module$exports$Blockly$Msg.Msg.ORDINAL_NUMBER_SUFFIX)),$.module$exports$Blockly$Msg.Msg.TEXT_CHARAT_TAIL&&(this.removeInput("TAIL",!0),this.appendDummyInput("TAIL").appendField($.module$exports$Blockly$Msg.Msg.TEXT_CHARAT_TAIL)),this.isAt_=a}},module$contents$Blockly$blocks$texts_TEXT_CHARAT_EXTENSION=function(){this.getField("WHERE").setValidator((function(b){(b="FROM_START"===b||"FROM_END"===b)!==this.isAt_&&this.getSourceBlock().updateAt_(b)})),this.updateAt_(!0);var a=this;this.setTooltip((function(){var b=a.getFieldValue("WHERE"),c=$.module$exports$Blockly$Msg.Msg.TEXT_CHARAT_TOOLTIP;return("FROM_START"===b||"FROM_END"===b)&&(b="FROM_START"===b?$.module$exports$Blockly$Msg.Msg.LISTS_INDEX_FROM_START_TOOLTIP:$.module$exports$Blockly$Msg.Msg.LISTS_INDEX_FROM_END_TOOLTIP)&&(c+="  "+b.replace("%1",a.workspace.options.oneBasedIndex?"#1":"#0")),c}))};(0,$.module$exports$Blockly$Extensions.register)("text_indexOf_tooltip",module$contents$Blockly$blocks$texts_TEXT_INDEXOF_TOOLTIP_EXTENSION),(0,$.module$exports$Blockly$Extensions.register)("text_quotes",module$contents$Blockly$blocks$texts_TEXT_QUOTES_EXTENSION),(0,$.module$exports$Blockly$Extensions.registerMutator)("text_join_mutator",module$contents$Blockly$blocks$texts_TEXT_JOIN_MUTATOR_MIXIN,module$contents$Blockly$blocks$texts_TEXT_JOIN_EXTENSION),(0,$.module$exports$Blockly$Extensions.registerMutator)("text_charAt_mutator",module$contents$Blockly$blocks$texts_TEXT_CHARAT_MUTATOR_MIXIN,module$contents$Blockly$blocks$texts_TEXT_CHARAT_EXTENSION);var module$contents$Blockly$blocks$procedures_PROCEDURE_DEF_COMMON={setStatements_:function(a){this.hasStatements_!==a&&(a?(this.appendStatementInput("STACK").appendField($.module$exports$Blockly$Msg.Msg.PROCEDURES_DEFNORETURN_DO),this.getInput("RETURN")&&this.moveInputBefore("STACK","RETURN")):this.removeInput("STACK",!0),this.hasStatements_=a)},updateParams_:function(){var a="";this.arguments_.length&&(a=$.module$exports$Blockly$Msg.Msg.PROCEDURES_BEFORE_PARAMS+" "+this.arguments_.join(", ")),(0,$.module$exports$Blockly$Events.disable)();try{this.setFieldValue(a,"PARAMS")}finally{(0,$.module$exports$Blockly$Events.enable)()}},mutationToDom:function(a){var b=(0,$.module$exports$Blockly$utils$xml.createElement)("mutation");a&&b.setAttribute("name",this.getFieldValue("NAME"));for(var c=0;c<this.argumentVarModels_.length;c++){var d=(0,$.module$exports$Blockly$utils$xml.createElement)("arg"),e=this.argumentVarModels_[c];d.setAttribute("name",e.name),d.setAttribute("varid",e.getId()),a&&this.paramIds_&&d.setAttribute("paramId",this.paramIds_[c]),b.appendChild(d)}return this.hasStatements_||b.setAttribute("statements","false"),b},domToMutation:function(a){this.arguments_=[],this.argumentVarModels_=[];for(var c,b=0;c=a.childNodes[b];b++)if("arg"===c.nodeName.toLowerCase()){var d=c.getAttribute("name");c=c.getAttribute("varid")||c.getAttribute("varId"),this.arguments_.push(d),null!==(c=(0,$.module$exports$Blockly$Variables.getOrCreateVariablePackage)(this.workspace,c,d,""))?this.argumentVarModels_.push(c):console.log("Failed to create a variable with name "+d+", ignoring.")}this.updateParams_(),(0,$.module$exports$Blockly$Procedures.mutateCallers)(this),this.setStatements_("false"!==a.getAttribute("statements"))},saveExtraState:function(){if(!this.argumentVarModels_.length&&this.hasStatements_)return null;var a=Object.create(null);if(this.argumentVarModels_.length){a.params=[];for(var b=0;b<this.argumentVarModels_.length;b++)a.params.push({name:this.argumentVarModels_[b].name,id:this.argumentVarModels_[b].getId()})}return this.hasStatements_||(a.hasStatements=!1),a},loadExtraState:function(a){if(this.arguments_=[],this.argumentVarModels_=[],a.params)for(var b=0;b<a.params.length;b++){var c=a.params[b];c=(0,$.module$exports$Blockly$Variables.getOrCreateVariablePackage)(this.workspace,c.id,c.name,""),this.arguments_.push(c.name),this.argumentVarModels_.push(c)}this.updateParams_(),(0,$.module$exports$Blockly$Procedures.mutateCallers)(this),this.setStatements_(!1!==a.hasStatements)},decompose:function(a){var b=(0,$.module$exports$Blockly$utils$xml.createElement)("block");b.setAttribute("type","procedures_mutatorcontainer");var c=(0,$.module$exports$Blockly$utils$xml.createElement)("statement");c.setAttribute("name","STACK"),b.appendChild(c);for(var d=0;d<this.arguments_.length;d++){var e=(0,$.module$exports$Blockly$utils$xml.createElement)("block");e.setAttribute("type","procedures_mutatorarg");var f=(0,$.module$exports$Blockly$utils$xml.createElement)("field");f.setAttribute("name","NAME");var g=(0,$.module$exports$Blockly$utils$xml.createTextNode)(this.arguments_[d]);f.appendChild(g),e.appendChild(f),f=(0,$.module$exports$Blockly$utils$xml.createElement)("next"),e.appendChild(f),c.appendChild(e),c=f}return a=(0,$.module$exports$Blockly$Xml.domToBlock)(b,a),"procedures_defreturn"===this.type?a.setFieldValue(this.hasStatements_,"STATEMENTS"):a.removeInput("STATEMENT_INPUT"),(0,$.module$exports$Blockly$Procedures.mutateCallers)(this),a},compose:function(a){this.arguments_=[],this.paramIds_=[],this.argumentVarModels_=[];for(var b=a.getInputTargetBlock("STACK");b&&!b.isInsertionMarker();){var c=b.getFieldValue("NAME");this.arguments_.push(c),c=this.workspace.getVariable(c,""),this.argumentVarModels_.push(c),this.paramIds_.push(b.id),b=b.nextConnection&&b.nextConnection.targetBlock()}this.updateParams_(),(0,$.module$exports$Blockly$Procedures.mutateCallers)(this),null!==(a=a.getFieldValue("STATEMENTS"))&&(a="TRUE"===a,this.hasStatements_!==a)&&(a?(this.setStatements_(!0),$.module$exports$Blockly$Mutator.Mutator.reconnect(this.statementConnection_,this,"STACK"),this.statementConnection_=null):(a=this.getInput("STACK").connection,(this.statementConnection_=a.targetConnection)&&((a=a.targetBlock()).unplug(),a.bumpNeighbours()),this.setStatements_(!1)))},getVars:function(){return this.arguments_},getVarModels:function(){return this.argumentVarModels_},renameVarById:function(a,b){var c=this.workspace.getVariableById(a);if(""===c.type){c=c.name,b=this.workspace.getVariableById(b);for(var d=!1,e=0;e<this.argumentVarModels_.length;e++)this.argumentVarModels_[e].getId()===a&&(this.arguments_[e]=b.name,this.argumentVarModels_[e]=b,d=!0);d&&(this.displayRenamedVar_(c,b.name),(0,$.module$exports$Blockly$Procedures.mutateCallers)(this))}},updateVarName:function(a){for(var d,b=a.name,c=!1,e=0;e<this.argumentVarModels_.length;e++)this.argumentVarModels_[e].getId()===a.getId()&&(d=this.arguments_[e],this.arguments_[e]=b,c=!0);c&&(this.displayRenamedVar_(d,b),(0,$.module$exports$Blockly$Procedures.mutateCallers)(this))},displayRenamedVar_:function(a,b){if(this.updateParams_(),this.mutator&&this.mutator.isVisible())for(var e,c=this.mutator.workspace_.getAllBlocks(!1),d=0;e=c[d];d++)"procedures_mutatorarg"===e.type&&$.module$exports$Blockly$Names.Names.equals(a,e.getFieldValue("NAME"))&&e.setFieldValue(b,"NAME")},customContextMenu:function(a){if(!this.isInFlyout){var b={enabled:!0},c=this.getFieldValue("NAME");b.text=$.module$exports$Blockly$Msg.Msg.PROCEDURES_CREATE_DO.replace("%1",c);var d=(0,$.module$exports$Blockly$utils$xml.createElement)("mutation");for(d.setAttribute("name",c),c=0;c<this.arguments_.length;c++){var e=(0,$.module$exports$Blockly$utils$xml.createElement)("arg");e.setAttribute("name",this.arguments_[c]),d.appendChild(e)}if((c=(0,$.module$exports$Blockly$utils$xml.createElement)("block")).setAttribute("type",this.callType_),c.appendChild(d),b.callback=(0,$.module$exports$Blockly$ContextMenu.callbackFactory)(this,c),a.push(b),!this.isCollapsed())for(b=0;b<this.argumentVarModels_.length;b++)d={enabled:!0},c=this.argumentVarModels_[b],d.text=$.module$exports$Blockly$Msg.Msg.VARIABLES_SET_CREATE_GET.replace("%1",c.name),c=(0,$.module$exports$Blockly$Variables.generateVariableFieldDom)(c),(e=(0,$.module$exports$Blockly$utils$xml.createElement)("block")).setAttribute("type","variables_get"),e.appendChild(c),d.callback=(0,$.module$exports$Blockly$ContextMenu.callbackFactory)(this,e),a.push(d)}},callType_:"procedures_callnoreturn"};$.module$exports$Blockly$blocks.Blocks.procedures_defnoreturn=Object.assign({},module$contents$Blockly$blocks$procedures_PROCEDURE_DEF_COMMON,{init:function(){var a=(0,$.module$exports$Blockly$Procedures.findLegalName)("",this);(a=new $.module$exports$Blockly$FieldTextInput.FieldTextInput(a,$.module$exports$Blockly$Procedures.rename)).setSpellcheck(!1),this.appendDummyInput().appendField($.module$exports$Blockly$Msg.Msg.PROCEDURES_DEFNORETURN_TITLE).appendField(a,"NAME").appendField("","PARAMS"),this.setMutator(new $.module$exports$Blockly$Mutator.Mutator(["procedures_mutatorarg"])),(this.workspace.options.comments||this.workspace.options.parentWorkspace&&this.workspace.options.parentWorkspace.options.comments)&&$.module$exports$Blockly$Msg.Msg.PROCEDURES_DEFNORETURN_COMMENT&&this.setCommentText($.module$exports$Blockly$Msg.Msg.PROCEDURES_DEFNORETURN_COMMENT),this.setStyle("procedure_blocks"),this.setTooltip($.module$exports$Blockly$Msg.Msg.PROCEDURES_DEFNORETURN_TOOLTIP),this.setHelpUrl($.module$exports$Blockly$Msg.Msg.PROCEDURES_DEFNORETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.setStatements_(!0),this.statementConnection_=null},getProcedureDef:function(){return[this.getFieldValue("NAME"),this.arguments_,!1]}}),$.module$exports$Blockly$blocks.Blocks.procedures_defreturn=Object.assign({},module$contents$Blockly$blocks$procedures_PROCEDURE_DEF_COMMON,{init:function(){var a=(0,$.module$exports$Blockly$Procedures.findLegalName)("",this);(a=new $.module$exports$Blockly$FieldTextInput.FieldTextInput(a,$.module$exports$Blockly$Procedures.rename)).setSpellcheck(!1),this.appendDummyInput().appendField($.module$exports$Blockly$Msg.Msg.PROCEDURES_DEFRETURN_TITLE).appendField(a,"NAME").appendField("","PARAMS"),this.appendValueInput("RETURN").setAlign($.module$exports$Blockly$Input.Align.RIGHT).appendField($.module$exports$Blockly$Msg.Msg.PROCEDURES_DEFRETURN_RETURN),this.setMutator(new $.module$exports$Blockly$Mutator.Mutator(["procedures_mutatorarg"])),(this.workspace.options.comments||this.workspace.options.parentWorkspace&&this.workspace.options.parentWorkspace.options.comments)&&$.module$exports$Blockly$Msg.Msg.PROCEDURES_DEFRETURN_COMMENT&&this.setCommentText($.module$exports$Blockly$Msg.Msg.PROCEDURES_DEFRETURN_COMMENT),this.setStyle("procedure_blocks"),this.setTooltip($.module$exports$Blockly$Msg.Msg.PROCEDURES_DEFRETURN_TOOLTIP),this.setHelpUrl($.module$exports$Blockly$Msg.Msg.PROCEDURES_DEFRETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.setStatements_(!0),this.statementConnection_=null},getProcedureDef:function(){return[this.getFieldValue("NAME"),this.arguments_,!0]}}),$.module$exports$Blockly$blocks.Blocks.procedures_mutatorcontainer={init:function(){this.appendDummyInput().appendField($.module$exports$Blockly$Msg.Msg.PROCEDURES_MUTATORCONTAINER_TITLE),this.appendStatementInput("STACK"),this.appendDummyInput("STATEMENT_INPUT").appendField($.module$exports$Blockly$Msg.Msg.PROCEDURES_ALLOW_STATEMENTS).appendField(new $.module$exports$Blockly$FieldCheckbox.FieldCheckbox("TRUE"),"STATEMENTS"),this.setStyle("procedure_blocks"),this.setTooltip($.module$exports$Blockly$Msg.Msg.PROCEDURES_MUTATORCONTAINER_TOOLTIP),this.contextMenu=!1}},$.module$exports$Blockly$blocks.Blocks.procedures_mutatorarg={init:function(){var a=new $.module$exports$Blockly$FieldTextInput.FieldTextInput($.module$exports$Blockly$Procedures.DEFAULT_ARG,this.validator_);a.oldShowEditorFn_=a.showEditor_,a.showEditor_=function(){this.createdVariables_=[],this.oldShowEditorFn_()},this.appendDummyInput().appendField($.module$exports$Blockly$Msg.Msg.PROCEDURES_MUTATORARG_TITLE).appendField(a,"NAME"),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setTooltip($.module$exports$Blockly$Msg.Msg.PROCEDURES_MUTATORARG_TOOLTIP),this.contextMenu=!1,a.onFinishEditing_=this.deleteIntermediateVars_,a.createdVariables_=[],a.onFinishEditing_("x")},validator_:function(a){var b=this.getSourceBlock(),c=$.module$exports$Blockly$Mutator.Mutator.findParentWs(b.workspace);if(!(a=a.replace(/[\s\xa0]+/g," ").replace(/^ | $/g,"")))return null;for(var d=(b.workspace.targetWorkspace||b.workspace).getAllBlocks(!1),e=a.toLowerCase(),f=0;f<d.length;f++)if(d[f].id!==this.getSourceBlock().id){var g=d[f].getFieldValue("NAME");if(g&&g.toLowerCase()===e)return null}return b.isInFlyout||((b=c.getVariable(a,""))&&b.name!==a&&c.renameVariableById(b.getId(),a),b||(b=c.createVariable(a,""))&&this.createdVariables_&&this.createdVariables_.push(b)),a},deleteIntermediateVars_:function(a){var b=$.module$exports$Blockly$Mutator.Mutator.findParentWs(this.getSourceBlock().workspace);if(b)for(var c=0;c<this.createdVariables_.length;c++){var d=this.createdVariables_[c];d.name!==a&&b.deleteVariableById(d.getId())}}};var module$contents$Blockly$blocks$procedures_PROCEDURE_CALL_COMMON={getProcedureCall:function(){return this.getFieldValue("NAME")},renameProcedure:function(a,b){$.module$exports$Blockly$Names.Names.equals(a,this.getProcedureCall())&&(this.setFieldValue(b,"NAME"),this.setTooltip((this.outputConnection?$.module$exports$Blockly$Msg.Msg.PROCEDURES_CALLRETURN_TOOLTIP:$.module$exports$Blockly$Msg.Msg.PROCEDURES_CALLNORETURN_TOOLTIP).replace("%1",b)))},setProcedureParameters_:function(a,b){var c=(0,$.module$exports$Blockly$Procedures.getDefinition)(this.getProcedureCall(),this.workspace),d=c&&c.mutator&&c.mutator.isVisible();if(d||(this.quarkConnections_={},this.quarkIds_=null),b)if(a.join("\n")===this.arguments_.join("\n"))this.quarkIds_=b;else{if(b.length!==a.length)throw RangeError("paramNames and paramIds must be the same length.");this.setCollapsed(!1),this.quarkIds_||(this.quarkConnections_={},this.quarkIds_=[]),c=this.rendered,this.rendered=!1;for(var e=0;e<this.arguments_.length;e++){var f=this.getInput("ARG"+e);f&&(f=f.connection.targetConnection,this.quarkConnections_[this.quarkIds_[e]]=f,d&&f&&-1===b.indexOf(this.quarkIds_[e])&&(f.disconnect(),f.getSourceBlock().bumpNeighbours()))}for(this.arguments_=[].concat(a),this.argumentVarModels_=[],a=0;a<this.arguments_.length;a++)d=(0,$.module$exports$Blockly$Variables.getOrCreateVariablePackage)(this.workspace,null,this.arguments_[a],""),this.argumentVarModels_.push(d);if(this.updateShape_(),this.quarkIds_=b)for(b=0;b<this.arguments_.length;b++)(a=this.quarkIds_[b])in this.quarkConnections_&&($.module$exports$Blockly$Mutator.Mutator.reconnect(this.quarkConnections_[a],this,"ARG"+b)||delete this.quarkConnections_[a]);(this.rendered=c)&&this.render()}},updateShape_:function(){for(var a=0;a<this.arguments_.length;a++){var b=this.getField("ARGNAME"+a);if(b){(0,$.module$exports$Blockly$Events.disable)();try{b.setValue(this.arguments_[a])}finally{(0,$.module$exports$Blockly$Events.enable)()}}else b=new $.module$exports$Blockly$FieldLabel.FieldLabel(this.arguments_[a]),this.appendValueInput("ARG"+a).setAlign($.module$exports$Blockly$Input.Align.RIGHT).appendField(b,"ARGNAME"+a).init()}for(a=this.arguments_.length;this.getInput("ARG"+a);a++)this.removeInput("ARG"+a);(a=this.getInput("TOPROW"))&&(this.arguments_.length?this.getField("WITH")||(a.appendField($.module$exports$Blockly$Msg.Msg.PROCEDURES_CALL_BEFORE_PARAMS,"WITH"),a.init()):this.getField("WITH")&&a.removeField("WITH"))},mutationToDom:function(){var a=(0,$.module$exports$Blockly$utils$xml.createElement)("mutation");a.setAttribute("name",this.getProcedureCall());for(var b=0;b<this.arguments_.length;b++){var c=(0,$.module$exports$Blockly$utils$xml.createElement)("arg");c.setAttribute("name",this.arguments_[b]),a.appendChild(c)}return a},domToMutation:function(a){var b=a.getAttribute("name");this.renameProcedure(this.getProcedureCall(),b),b=[];for(var e,c=[],d=0;e=a.childNodes[d];d++)"arg"===e.nodeName.toLowerCase()&&(b.push(e.getAttribute("name")),c.push(e.getAttribute("paramId")));this.setProcedureParameters_(b,c)},saveExtraState:function(){var a=Object.create(null);return a.name=this.getProcedureCall(),this.arguments_.length&&(a.params=this.arguments_),a},loadExtraState:function(a){if(this.renameProcedure(this.getProcedureCall(),a.name),a=a.params){var b=[];b.length=a.length,b.fill(null),this.setProcedureParameters_(a,b)}},getVars:function(){return this.arguments_},getVarModels:function(){return this.argumentVarModels_},onchange:function(a){if(this.workspace&&!this.workspace.isFlyout&&a.recordUndo)if(a.type===$.module$exports$Blockly$Events.BLOCK_CREATE&&-1!==a.ids.indexOf(this.id)){var b=this.getProcedureCall();if(!(b=(0,$.module$exports$Blockly$Procedures.getDefinition)(b,this.workspace))||b.type===this.defType_&&JSON.stringify(b.getVars())===JSON.stringify(this.arguments_)||(b=null),!b){(0,$.module$exports$Blockly$Events.setGroup)(a.group),a=(0,$.module$exports$Blockly$utils$xml.createElement)("xml"),(b=(0,$.module$exports$Blockly$utils$xml.createElement)("block")).setAttribute("type",this.defType_);var c=this.getRelativeToSurfaceXY(),d=c.y+2*$.module$exports$Blockly$internalConstants.SNAP_RADIUS;b.setAttribute("x",c.x+$.module$exports$Blockly$internalConstants.SNAP_RADIUS*(this.RTL?-1:1)),b.setAttribute("y",d),c=this.mutationToDom(),b.appendChild(c),(c=(0,$.module$exports$Blockly$utils$xml.createElement)("field")).setAttribute("name","NAME"),(d=this.getProcedureCall())||(d=(0,$.module$exports$Blockly$Procedures.findLegalName)("",this),this.renameProcedure("",d)),c.appendChild((0,$.module$exports$Blockly$utils$xml.createTextNode)(d)),b.appendChild(c),a.appendChild(b),(0,$.module$exports$Blockly$Xml.domToWorkspace)(a,this.workspace),(0,$.module$exports$Blockly$Events.setGroup)(!1)}}else a.type===$.module$exports$Blockly$Events.BLOCK_DELETE?(b=this.getProcedureCall(),(0,$.module$exports$Blockly$Procedures.getDefinition)(b,this.workspace)||((0,$.module$exports$Blockly$Events.setGroup)(a.group),this.dispose(!0),(0,$.module$exports$Blockly$Events.setGroup)(!1))):a.type===$.module$exports$Blockly$Events.CHANGE&&"disabled"===a.element&&(b=this.getProcedureCall(),(b=(0,$.module$exports$Blockly$Procedures.getDefinition)(b,this.workspace))&&b.id===a.blockId&&((b=(0,$.module$exports$Blockly$Events.getGroup)())&&console.log("Saw an existing group while responding to a definition change"),(0,$.module$exports$Blockly$Events.setGroup)(a.group),a.newValue?(this.previousEnabledState_=this.isEnabled(),this.setEnabled(!1)):this.setEnabled(this.previousEnabledState_),(0,$.module$exports$Blockly$Events.setGroup)(b)))},customContextMenu:function(a){if(this.workspace.isMovable()){var b={enabled:!0};b.text=$.module$exports$Blockly$Msg.Msg.PROCEDURES_HIGHLIGHT_DEF;var c=this.getProcedureCall(),d=this.workspace;b.callback=function(){var e=(0,$.module$exports$Blockly$Procedures.getDefinition)(c,d);e&&(d.centerOnBlock(e.id),e.select())},a.push(b)}}};$.module$exports$Blockly$blocks.Blocks.procedures_callnoreturn=Object.assign({},module$contents$Blockly$blocks$procedures_PROCEDURE_CALL_COMMON,{init:function(){this.appendDummyInput("TOPROW").appendField("","NAME"),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setHelpUrl($.module$exports$Blockly$Msg.Msg.PROCEDURES_CALLNORETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.quarkConnections_={},this.quarkIds_=null,this.previousEnabledState_=!0},defType_:"procedures_defnoreturn"}),$.module$exports$Blockly$blocks.Blocks.procedures_callreturn=Object.assign({},module$contents$Blockly$blocks$procedures_PROCEDURE_CALL_COMMON,{init:function(){this.appendDummyInput("TOPROW").appendField("","NAME"),this.setOutput(!0),this.setStyle("procedure_blocks"),this.setHelpUrl($.module$exports$Blockly$Msg.Msg.PROCEDURES_CALLRETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.quarkConnections_={},this.quarkIds_=null,this.previousEnabledState_=!0},defType_:"procedures_defreturn"}),$.module$exports$Blockly$blocks.Blocks.procedures_ifreturn={init:function(){this.appendValueInput("CONDITION").setCheck("Boolean").appendField($.module$exports$Blockly$Msg.Msg.CONTROLS_IF_MSG_IF),this.appendValueInput("VALUE").appendField($.module$exports$Blockly$Msg.Msg.PROCEDURES_DEFRETURN_RETURN),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setTooltip($.module$exports$Blockly$Msg.Msg.PROCEDURES_IFRETURN_TOOLTIP),this.setHelpUrl($.module$exports$Blockly$Msg.Msg.PROCEDURES_IFRETURN_HELPURL),this.hasReturnValue_=!0},mutationToDom:function(){var a=(0,$.module$exports$Blockly$utils$xml.createElement)("mutation");return a.setAttribute("value",Number(this.hasReturnValue_)),a},domToMutation:function(a){this.hasReturnValue_="1"===a.getAttribute("value"),this.hasReturnValue_||(this.removeInput("VALUE"),this.appendDummyInput("VALUE").appendField($.module$exports$Blockly$Msg.Msg.PROCEDURES_DEFRETURN_RETURN))},onchange:function(a){if(!this.workspace.isDragging||!this.workspace.isDragging()){a=!1;var b=this;do{if(-1!==this.FUNCTION_TYPES.indexOf(b.type)){a=!0;break}b=b.getSurroundParent()}while(b);a?("procedures_defnoreturn"===b.type&&this.hasReturnValue_?(this.removeInput("VALUE"),this.appendDummyInput("VALUE").appendField($.module$exports$Blockly$Msg.Msg.PROCEDURES_DEFRETURN_RETURN),this.hasReturnValue_=!1):"procedures_defreturn"!==b.type||this.hasReturnValue_||(this.removeInput("VALUE"),this.appendValueInput("VALUE").appendField($.module$exports$Blockly$Msg.Msg.PROCEDURES_DEFRETURN_RETURN),this.hasReturnValue_=!0),this.setWarningText(null),this.isInFlyout||this.setEnabled(!0)):(this.setWarningText($.module$exports$Blockly$Msg.Msg.PROCEDURES_IFRETURN_WARNING),this.isInFlyout||this.getInheritedDisabled()||this.setEnabled(!1))}},FUNCTION_TYPES:["procedures_defnoreturn","procedures_defreturn"]},(0,$.module$exports$Blockly$common.defineBlocksWithJsonArray)([{type:"math_number",message0:"%1",args0:[{type:"field_number",name:"NUM",value:0}],output:"Number",helpUrl:"%{BKY_MATH_NUMBER_HELPURL}",style:"math_blocks",tooltip:"%{BKY_MATH_NUMBER_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"math_arithmetic",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A",check:"Number"},{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ADDITION_SYMBOL}","ADD"],["%{BKY_MATH_SUBTRACTION_SYMBOL}","MINUS"],["%{BKY_MATH_MULTIPLICATION_SYMBOL}","MULTIPLY"],["%{BKY_MATH_DIVISION_SYMBOL}","DIVIDE"],["%{BKY_MATH_POWER_SYMBOL}","POWER"]]},{type:"input_value",name:"B",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ARITHMETIC_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_single",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_SINGLE_OP_ROOT}","ROOT"],["%{BKY_MATH_SINGLE_OP_ABSOLUTE}","ABS"],["-","NEG"],["ln","LN"],["log10","LOG10"],["e^","EXP"],["10^","POW10"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_SINGLE_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_trig",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_TRIG_SIN}","SIN"],["%{BKY_MATH_TRIG_COS}","COS"],["%{BKY_MATH_TRIG_TAN}","TAN"],["%{BKY_MATH_TRIG_ASIN}","ASIN"],["%{BKY_MATH_TRIG_ACOS}","ACOS"],["%{BKY_MATH_TRIG_ATAN}","ATAN"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_TRIG_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_constant",message0:"%1",args0:[{type:"field_dropdown",name:"CONSTANT",options:[["","PI"],["e","E"],["","GOLDEN_RATIO"],["sqrt(2)","SQRT2"],["sqrt()","SQRT1_2"],["","INFINITY"]]}],output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_CONSTANT_TOOLTIP}",helpUrl:"%{BKY_MATH_CONSTANT_HELPURL}"},{type:"math_number_property",message0:"%1 %2",args0:[{type:"input_value",name:"NUMBER_TO_CHECK",check:"Number"},{type:"field_dropdown",name:"PROPERTY",options:[["%{BKY_MATH_IS_EVEN}","EVEN"],["%{BKY_MATH_IS_ODD}","ODD"],["%{BKY_MATH_IS_PRIME}","PRIME"],["%{BKY_MATH_IS_WHOLE}","WHOLE"],["%{BKY_MATH_IS_POSITIVE}","POSITIVE"],["%{BKY_MATH_IS_NEGATIVE}","NEGATIVE"],["%{BKY_MATH_IS_DIVISIBLE_BY}","DIVISIBLE_BY"]]}],inputsInline:!0,output:"Boolean",style:"math_blocks",tooltip:"%{BKY_MATH_IS_TOOLTIP}",mutator:"math_is_divisibleby_mutator"},{type:"math_change",message0:"%{BKY_MATH_CHANGE_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_MATH_CHANGE_TITLE_ITEM}"},{type:"input_value",name:"DELTA",check:"Number"}],previousStatement:null,nextStatement:null,style:"variable_blocks",helpUrl:"%{BKY_MATH_CHANGE_HELPURL}",extensions:["math_change_tooltip"]},{type:"math_round",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ROUND_OPERATOR_ROUND}","ROUND"],["%{BKY_MATH_ROUND_OPERATOR_ROUNDUP}","ROUNDUP"],["%{BKY_MATH_ROUND_OPERATOR_ROUNDDOWN}","ROUNDDOWN"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ROUND_HELPURL}",tooltip:"%{BKY_MATH_ROUND_TOOLTIP}"},{type:"math_on_list",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ONLIST_OPERATOR_SUM}","SUM"],["%{BKY_MATH_ONLIST_OPERATOR_MIN}","MIN"],["%{BKY_MATH_ONLIST_OPERATOR_MAX}","MAX"],["%{BKY_MATH_ONLIST_OPERATOR_AVERAGE}","AVERAGE"],["%{BKY_MATH_ONLIST_OPERATOR_MEDIAN}","MEDIAN"],["%{BKY_MATH_ONLIST_OPERATOR_MODE}","MODE"],["%{BKY_MATH_ONLIST_OPERATOR_STD_DEV}","STD_DEV"],["%{BKY_MATH_ONLIST_OPERATOR_RANDOM}","RANDOM"]]},{type:"input_value",name:"LIST",check:"Array"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ONLIST_HELPURL}",mutator:"math_modes_of_list_mutator",extensions:["math_op_tooltip"]},{type:"math_modulo",message0:"%{BKY_MATH_MODULO_TITLE}",args0:[{type:"input_value",name:"DIVIDEND",check:"Number"},{type:"input_value",name:"DIVISOR",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_MODULO_TOOLTIP}",helpUrl:"%{BKY_MATH_MODULO_HELPURL}"},{type:"math_constrain",message0:"%{BKY_MATH_CONSTRAIN_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"Number"},{type:"input_value",name:"LOW",check:"Number"},{type:"input_value",name:"HIGH",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_CONSTRAIN_TOOLTIP}",helpUrl:"%{BKY_MATH_CONSTRAIN_HELPURL}"},{type:"math_random_int",message0:"%{BKY_MATH_RANDOM_INT_TITLE}",args0:[{type:"input_value",name:"FROM",check:"Number"},{type:"input_value",name:"TO",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_RANDOM_INT_TOOLTIP}",helpUrl:"%{BKY_MATH_RANDOM_INT_HELPURL}"},{type:"math_random_float",message0:"%{BKY_MATH_RANDOM_FLOAT_TITLE_RANDOM}",output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_RANDOM_FLOAT_TOOLTIP}",helpUrl:"%{BKY_MATH_RANDOM_FLOAT_HELPURL}"},{type:"math_atan2",message0:"%{BKY_MATH_ATAN2_TITLE}",args0:[{type:"input_value",name:"X",check:"Number"},{type:"input_value",name:"Y",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_ATAN2_TOOLTIP}",helpUrl:"%{BKY_MATH_ATAN2_HELPURL}"}]);var module$contents$Blockly$blocks$math_TOOLTIPS_BY_OP={ADD:"%{BKY_MATH_ARITHMETIC_TOOLTIP_ADD}",MINUS:"%{BKY_MATH_ARITHMETIC_TOOLTIP_MINUS}",MULTIPLY:"%{BKY_MATH_ARITHMETIC_TOOLTIP_MULTIPLY}",DIVIDE:"%{BKY_MATH_ARITHMETIC_TOOLTIP_DIVIDE}",POWER:"%{BKY_MATH_ARITHMETIC_TOOLTIP_POWER}",ROOT:"%{BKY_MATH_SINGLE_TOOLTIP_ROOT}",ABS:"%{BKY_MATH_SINGLE_TOOLTIP_ABS}",NEG:"%{BKY_MATH_SINGLE_TOOLTIP_NEG}",LN:"%{BKY_MATH_SINGLE_TOOLTIP_LN}",LOG10:"%{BKY_MATH_SINGLE_TOOLTIP_LOG10}",EXP:"%{BKY_MATH_SINGLE_TOOLTIP_EXP}",POW10:"%{BKY_MATH_SINGLE_TOOLTIP_POW10}",SIN:"%{BKY_MATH_TRIG_TOOLTIP_SIN}",COS:"%{BKY_MATH_TRIG_TOOLTIP_COS}",TAN:"%{BKY_MATH_TRIG_TOOLTIP_TAN}",ASIN:"%{BKY_MATH_TRIG_TOOLTIP_ASIN}",ACOS:"%{BKY_MATH_TRIG_TOOLTIP_ACOS}",ATAN:"%{BKY_MATH_TRIG_TOOLTIP_ATAN}",SUM:"%{BKY_MATH_ONLIST_TOOLTIP_SUM}",MIN:"%{BKY_MATH_ONLIST_TOOLTIP_MIN}",MAX:"%{BKY_MATH_ONLIST_TOOLTIP_MAX}",AVERAGE:"%{BKY_MATH_ONLIST_TOOLTIP_AVERAGE}",MEDIAN:"%{BKY_MATH_ONLIST_TOOLTIP_MEDIAN}",MODE:"%{BKY_MATH_ONLIST_TOOLTIP_MODE}",STD_DEV:"%{BKY_MATH_ONLIST_TOOLTIP_STD_DEV}",RANDOM:"%{BKY_MATH_ONLIST_TOOLTIP_RANDOM}"};(0,$.module$exports$Blockly$Extensions.register)("math_op_tooltip",(0,$.module$exports$Blockly$Extensions.buildTooltipForDropdown)("OP",module$contents$Blockly$blocks$math_TOOLTIPS_BY_OP));var module$contents$Blockly$blocks$math_IS_DIVISIBLEBY_MUTATOR_MIXIN={mutationToDom:function(){var a=(0,$.module$exports$Blockly$utils$xml.createElement)("mutation"),b="DIVISIBLE_BY"===this.getFieldValue("PROPERTY");return a.setAttribute("divisor_input",b),a},domToMutation:function(a){a="true"===a.getAttribute("divisor_input"),this.updateShape_(a)},updateShape_:function(a){var b=this.getInput("DIVISOR");a?b||this.appendValueInput("DIVISOR").setCheck("Number"):b&&this.removeInput("DIVISOR")}},module$contents$Blockly$blocks$math_IS_DIVISIBLE_MUTATOR_EXTENSION=function(){this.getField("PROPERTY").setValidator((function(a){a="DIVISIBLE_BY"===a,this.getSourceBlock().updateShape_(a)}))};(0,$.module$exports$Blockly$Extensions.registerMutator)("math_is_divisibleby_mutator",module$contents$Blockly$blocks$math_IS_DIVISIBLEBY_MUTATOR_MIXIN,module$contents$Blockly$blocks$math_IS_DIVISIBLE_MUTATOR_EXTENSION),(0,$.module$exports$Blockly$Extensions.register)("math_change_tooltip",(0,$.module$exports$Blockly$Extensions.buildTooltipWithFieldText)("%{BKY_MATH_CHANGE_TOOLTIP}","VAR"));var module$contents$Blockly$blocks$math_LIST_MODES_MUTATOR_MIXIN={updateType_:function(a){"MODE"===a?this.outputConnection.setCheck("Array"):this.outputConnection.setCheck("Number")},mutationToDom:function(){var a=(0,$.module$exports$Blockly$utils$xml.createElement)("mutation");return a.setAttribute("op",this.getFieldValue("OP")),a},domToMutation:function(a){this.updateType_(a.getAttribute("op"))}},module$contents$Blockly$blocks$math_LIST_MODES_MUTATOR_EXTENSION=function(){this.getField("OP").setValidator(function(a){this.updateType_(a)}.bind(this))};(0,$.module$exports$Blockly$Extensions.registerMutator)("math_modes_of_list_mutator",module$contents$Blockly$blocks$math_LIST_MODES_MUTATOR_MIXIN,module$contents$Blockly$blocks$math_LIST_MODES_MUTATOR_EXTENSION);var module$exports$Blockly$blocks$loops={};(0,$.module$exports$Blockly$common.defineBlocksWithJsonArray)([{type:"controls_repeat_ext",message0:"%{BKY_CONTROLS_REPEAT_TITLE}",args0:[{type:"input_value",name:"TIMES",check:"Number"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",tooltip:"%{BKY_CONTROLS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_CONTROLS_REPEAT_HELPURL}"},{type:"controls_repeat",message0:"%{BKY_CONTROLS_REPEAT_TITLE}",args0:[{type:"field_number",name:"TIMES",value:10,min:0,precision:1}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",tooltip:"%{BKY_CONTROLS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_CONTROLS_REPEAT_HELPURL}"},{type:"controls_whileUntil",message0:"%1 %2",args0:[{type:"field_dropdown",name:"MODE",options:[["%{BKY_CONTROLS_WHILEUNTIL_OPERATOR_WHILE}","WHILE"],["%{BKY_CONTROLS_WHILEUNTIL_OPERATOR_UNTIL}","UNTIL"]]},{type:"input_value",name:"BOOL",check:"Boolean"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_WHILEUNTIL_HELPURL}",extensions:["controls_whileUntil_tooltip"]},{type:"controls_for",message0:"%{BKY_CONTROLS_FOR_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:null},{type:"input_value",name:"FROM",check:"Number",align:"RIGHT"},{type:"input_value",name:"TO",check:"Number",align:"RIGHT"},{type:"input_value",name:"BY",check:"Number",align:"RIGHT"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],inputsInline:!0,previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FOR_HELPURL}",extensions:["contextMenu_newGetVariableBlock","controls_for_tooltip"]},{type:"controls_forEach",message0:"%{BKY_CONTROLS_FOREACH_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:null},{type:"input_value",name:"LIST",check:"Array"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FOREACH_HELPURL}",extensions:["contextMenu_newGetVariableBlock","controls_forEach_tooltip"]},{type:"controls_flow_statements",message0:"%1",args0:[{type:"field_dropdown",name:"FLOW",options:[["%{BKY_CONTROLS_FLOW_STATEMENTS_OPERATOR_BREAK}","BREAK"],["%{BKY_CONTROLS_FLOW_STATEMENTS_OPERATOR_CONTINUE}","CONTINUE"]]}],previousStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FLOW_STATEMENTS_HELPURL}",suppressPrefixSuffix:!0,extensions:["controls_flow_tooltip","controls_flow_in_loop_check"]}]);var module$contents$Blockly$blocks$loops_WHILE_UNTIL_TOOLTIPS={WHILE:"%{BKY_CONTROLS_WHILEUNTIL_TOOLTIP_WHILE}",UNTIL:"%{BKY_CONTROLS_WHILEUNTIL_TOOLTIP_UNTIL}"};(0,$.module$exports$Blockly$Extensions.register)("controls_whileUntil_tooltip",(0,$.module$exports$Blockly$Extensions.buildTooltipForDropdown)("MODE",module$contents$Blockly$blocks$loops_WHILE_UNTIL_TOOLTIPS));var module$contents$Blockly$blocks$loops_BREAK_CONTINUE_TOOLTIPS={BREAK:"%{BKY_CONTROLS_FLOW_STATEMENTS_TOOLTIP_BREAK}",CONTINUE:"%{BKY_CONTROLS_FLOW_STATEMENTS_TOOLTIP_CONTINUE}"};(0,$.module$exports$Blockly$Extensions.register)("controls_flow_tooltip",(0,$.module$exports$Blockly$Extensions.buildTooltipForDropdown)("FLOW",module$contents$Blockly$blocks$loops_BREAK_CONTINUE_TOOLTIPS));var module$contents$Blockly$blocks$loops_CUSTOM_CONTEXT_MENU_CREATE_VARIABLES_GET_MIXIN={customContextMenu:function(a){if(!this.isInFlyout){var b=this.getField("VAR").getVariable(),c=b.name;if(!this.isCollapsed()&&null!==c){var d={enabled:!0};d.text=$.module$exports$Blockly$Msg.Msg.VARIABLES_SET_CREATE_GET.replace("%1",c),b=(0,$.module$exports$Blockly$Variables.generateVariableFieldDom)(b),(c=(0,$.module$exports$Blockly$utils$xml.createElement)("block")).setAttribute("type","variables_get"),c.appendChild(b),d.callback=(0,$.module$exports$Blockly$ContextMenu.callbackFactory)(this,c),a.push(d)}}}};(0,$.module$exports$Blockly$Extensions.registerMixin)("contextMenu_newGetVariableBlock",module$contents$Blockly$blocks$loops_CUSTOM_CONTEXT_MENU_CREATE_VARIABLES_GET_MIXIN),(0,$.module$exports$Blockly$Extensions.register)("controls_for_tooltip",(0,$.module$exports$Blockly$Extensions.buildTooltipWithFieldText)("%{BKY_CONTROLS_FOR_TOOLTIP}","VAR")),(0,$.module$exports$Blockly$Extensions.register)("controls_forEach_tooltip",(0,$.module$exports$Blockly$Extensions.buildTooltipWithFieldText)("%{BKY_CONTROLS_FOREACH_TOOLTIP}","VAR")),module$exports$Blockly$blocks$loops.loopTypes=["controls_repeat","controls_repeat_ext","controls_forEach","controls_for","controls_whileUntil"];var module$contents$Blockly$blocks$loops_CONTROL_FLOW_IN_LOOP_CHECK_MIXIN={getSurroundLoop:function(){var a=this;do{if(module$exports$Blockly$blocks$loops.loopTypes.includes(a.type))return a;a=a.getSurroundParent()}while(a);return null},onchange:function(a){if(this.workspace.isDragging&&!this.workspace.isDragging()&&a.type===$.module$exports$Blockly$Events.BLOCK_MOVE){var b=this.getSurroundLoop(this);if(this.setWarningText(b?null:$.module$exports$Blockly$Msg.Msg.CONTROLS_FLOW_STATEMENTS_WARNING),!this.isInFlyout){var c=(0,$.module$exports$Blockly$Events.getGroup)();(0,$.module$exports$Blockly$Events.setGroup)(a.group),this.setEnabled(b),(0,$.module$exports$Blockly$Events.setGroup)(c)}}}};(0,$.module$exports$Blockly$Extensions.registerMixin)("controls_flow_in_loop_check",module$contents$Blockly$blocks$loops_CONTROL_FLOW_IN_LOOP_CHECK_MIXIN),(0,$.module$exports$Blockly$common.defineBlocksWithJsonArray)([{type:"logic_boolean",message0:"%1",args0:[{type:"field_dropdown",name:"BOOL",options:[["%{BKY_LOGIC_BOOLEAN_TRUE}","TRUE"],["%{BKY_LOGIC_BOOLEAN_FALSE}","FALSE"]]}],output:"Boolean",style:"logic_blocks",tooltip:"%{BKY_LOGIC_BOOLEAN_TOOLTIP}",helpUrl:"%{BKY_LOGIC_BOOLEAN_HELPURL}"},{type:"controls_if",message0:"%{BKY_CONTROLS_IF_MSG_IF} %1",args0:[{type:"input_value",name:"IF0",check:"Boolean"}],message1:"%{BKY_CONTROLS_IF_MSG_THEN} %1",args1:[{type:"input_statement",name:"DO0"}],previousStatement:null,nextStatement:null,style:"logic_blocks",helpUrl:"%{BKY_CONTROLS_IF_HELPURL}",suppressPrefixSuffix:!0,mutator:"controls_if_mutator",extensions:["controls_if_tooltip"]},{type:"controls_ifelse",message0:"%{BKY_CONTROLS_IF_MSG_IF} %1",args0:[{type:"input_value",name:"IF0",check:"Boolean"}],message1:"%{BKY_CONTROLS_IF_MSG_THEN} %1",args1:[{type:"input_statement",name:"DO0"}],message2:"%{BKY_CONTROLS_IF_MSG_ELSE} %1",args2:[{type:"input_statement",name:"ELSE"}],previousStatement:null,nextStatement:null,style:"logic_blocks",tooltip:"%{BKYCONTROLS_IF_TOOLTIP_2}",helpUrl:"%{BKY_CONTROLS_IF_HELPURL}",suppressPrefixSuffix:!0,extensions:["controls_if_tooltip"]},{type:"logic_compare",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A"},{type:"field_dropdown",name:"OP",options:[["=","EQ"],["","NEQ"],["<","LT"],["","LTE"],[">","GT"],["","GTE"]]},{type:"input_value",name:"B"}],inputsInline:!0,output:"Boolean",style:"logic_blocks",helpUrl:"%{BKY_LOGIC_COMPARE_HELPURL}",extensions:["logic_compare","logic_op_tooltip"]},{type:"logic_operation",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A",check:"Boolean"},{type:"field_dropdown",name:"OP",options:[["%{BKY_LOGIC_OPERATION_AND}","AND"],["%{BKY_LOGIC_OPERATION_OR}","OR"]]},{type:"input_value",name:"B",check:"Boolean"}],inputsInline:!0,output:"Boolean",style:"logic_blocks",helpUrl:"%{BKY_LOGIC_OPERATION_HELPURL}",extensions:["logic_op_tooltip"]},{type:"logic_negate",message0:"%{BKY_LOGIC_NEGATE_TITLE}",args0:[{type:"input_value",name:"BOOL",check:"Boolean"}],output:"Boolean",style:"logic_blocks",tooltip:"%{BKY_LOGIC_NEGATE_TOOLTIP}",helpUrl:"%{BKY_LOGIC_NEGATE_HELPURL}"},{type:"logic_null",message0:"%{BKY_LOGIC_NULL}",output:null,style:"logic_blocks",tooltip:"%{BKY_LOGIC_NULL_TOOLTIP}",helpUrl:"%{BKY_LOGIC_NULL_HELPURL}"},{type:"logic_ternary",message0:"%{BKY_LOGIC_TERNARY_CONDITION} %1",args0:[{type:"input_value",name:"IF",check:"Boolean"}],message1:"%{BKY_LOGIC_TERNARY_IF_TRUE} %1",args1:[{type:"input_value",name:"THEN"}],message2:"%{BKY_LOGIC_TERNARY_IF_FALSE} %1",args2:[{type:"input_value",name:"ELSE"}],output:null,style:"logic_blocks",tooltip:"%{BKY_LOGIC_TERNARY_TOOLTIP}",helpUrl:"%{BKY_LOGIC_TERNARY_HELPURL}",extensions:["logic_ternary"]},{type:"controls_if_if",message0:"%{BKY_CONTROLS_IF_IF_TITLE_IF}",nextStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_IF_TOOLTIP}"},{type:"controls_if_elseif",message0:"%{BKY_CONTROLS_IF_ELSEIF_TITLE_ELSEIF}",previousStatement:null,nextStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_ELSEIF_TOOLTIP}"},{type:"controls_if_else",message0:"%{BKY_CONTROLS_IF_ELSE_TITLE_ELSE}",previousStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_ELSE_TOOLTIP}"}]);var module$contents$Blockly$blocks$logic_TOOLTIPS_BY_OP={EQ:"%{BKY_LOGIC_COMPARE_TOOLTIP_EQ}",NEQ:"%{BKY_LOGIC_COMPARE_TOOLTIP_NEQ}",LT:"%{BKY_LOGIC_COMPARE_TOOLTIP_LT}",LTE:"%{BKY_LOGIC_COMPARE_TOOLTIP_LTE}",GT:"%{BKY_LOGIC_COMPARE_TOOLTIP_GT}",GTE:"%{BKY_LOGIC_COMPARE_TOOLTIP_GTE}",AND:"%{BKY_LOGIC_OPERATION_TOOLTIP_AND}",OR:"%{BKY_LOGIC_OPERATION_TOOLTIP_OR}"};(0,$.module$exports$Blockly$Extensions.register)("logic_op_tooltip",(0,$.module$exports$Blockly$Extensions.buildTooltipForDropdown)("OP",module$contents$Blockly$blocks$logic_TOOLTIPS_BY_OP));var module$contents$Blockly$blocks$logic_CONTROLS_IF_MUTATOR_MIXIN={elseifCount_:0,elseCount_:0,mutationToDom:function(){if(!this.elseifCount_&&!this.elseCount_)return null;var a=(0,$.module$exports$Blockly$utils$xml.createElement)("mutation");return this.elseifCount_&&a.setAttribute("elseif",this.elseifCount_),this.elseCount_&&a.setAttribute("else",1),a},domToMutation:function(a){this.elseifCount_=parseInt(a.getAttribute("elseif"),10)||0,this.elseCount_=parseInt(a.getAttribute("else"),10)||0,this.rebuildShape_()},saveExtraState:function(){if(!this.elseifCount_&&!this.elseCount_)return null;var a=Object.create(null);return this.elseifCount_&&(a.elseIfCount=this.elseifCount_),this.elseCount_&&(a.hasElse=!0),a},loadExtraState:function(a){this.elseifCount_=a.elseIfCount||0,this.elseCount_=a.hasElse?1:0,this.updateShape_()},decompose:function(a){var b=a.newBlock("controls_if_if");b.initSvg();for(var c=b.nextConnection,d=1;d<=this.elseifCount_;d++){var e=a.newBlock("controls_if_elseif");e.initSvg(),c.connect(e.previousConnection),c=e.nextConnection}return this.elseCount_&&((a=a.newBlock("controls_if_else")).initSvg(),c.connect(a.previousConnection)),b},compose:function(a){a=a.nextConnection.targetBlock(),this.elseCount_=this.elseifCount_=0;for(var b=[null],c=[null],d=null;a&&!a.isInsertionMarker();){switch(a.type){case"controls_if_elseif":this.elseifCount_++,b.push(a.valueConnection_),c.push(a.statementConnection_);break;case"controls_if_else":this.elseCount_++,d=a.statementConnection_;break;default:throw TypeError("Unknown block type: "+a.type)}a=a.nextConnection&&a.nextConnection.targetBlock()}this.updateShape_(),this.reconnectChildBlocks_(b,c,d)},saveConnections:function(a){a=a.nextConnection.targetBlock();for(var b=1;a;){switch(a.type){case"controls_if_elseif":var c=this.getInput("IF"+b),d=this.getInput("DO"+b);a.valueConnection_=c&&c.connection.targetConnection,a.statementConnection_=d&&d.connection.targetConnection,b++;break;case"controls_if_else":c=this.getInput("ELSE"),a.statementConnection_=c&&c.connection.targetConnection;break;default:throw TypeError("Unknown block type: "+a.type)}a=a.nextConnection&&a.nextConnection.targetBlock()}},rebuildShape_:function(){var a=[null],b=[null],c=null;this.getInput("ELSE")&&(c=this.getInput("ELSE").connection.targetConnection);for(var d=1;this.getInput("IF"+d);d++){var e=this.getInput("IF"+d),f=this.getInput("DO"+d);a.push(e.connection.targetConnection),b.push(f.connection.targetConnection)}this.updateShape_(),this.reconnectChildBlocks_(a,b,c)},updateShape_:function(){this.getInput("ELSE")&&this.removeInput("ELSE");for(var a=1;this.getInput("IF"+a);a++)this.removeInput("IF"+a),this.removeInput("DO"+a);for(a=1;a<=this.elseifCount_;a++)this.appendValueInput("IF"+a).setCheck("Boolean").appendField($.module$exports$Blockly$Msg.Msg.CONTROLS_IF_MSG_ELSEIF),this.appendStatementInput("DO"+a).appendField($.module$exports$Blockly$Msg.Msg.CONTROLS_IF_MSG_THEN);this.elseCount_&&this.appendStatementInput("ELSE").appendField($.module$exports$Blockly$Msg.Msg.CONTROLS_IF_MSG_ELSE)},reconnectChildBlocks_:function(a,b,c){for(var d=1;d<=this.elseifCount_;d++)$.module$exports$Blockly$Mutator.Mutator.reconnect(a[d],this,"IF"+d),$.module$exports$Blockly$Mutator.Mutator.reconnect(b[d],this,"DO"+d);$.module$exports$Blockly$Mutator.Mutator.reconnect(c,this,"ELSE")}};(0,$.module$exports$Blockly$Extensions.registerMutator)("controls_if_mutator",module$contents$Blockly$blocks$logic_CONTROLS_IF_MUTATOR_MIXIN,null,["controls_if_elseif","controls_if_else"]);var module$contents$Blockly$blocks$logic_CONTROLS_IF_TOOLTIP_EXTENSION=function(){this.setTooltip(function(){return this.elseifCount_||this.elseCount_?!this.elseifCount_&&this.elseCount_?$.module$exports$Blockly$Msg.Msg.CONTROLS_IF_TOOLTIP_2:this.elseifCount_&&!this.elseCount_?$.module$exports$Blockly$Msg.Msg.CONTROLS_IF_TOOLTIP_3:this.elseifCount_&&this.elseCount_?$.module$exports$Blockly$Msg.Msg.CONTROLS_IF_TOOLTIP_4:"":$.module$exports$Blockly$Msg.Msg.CONTROLS_IF_TOOLTIP_1}.bind(this))};(0,$.module$exports$Blockly$Extensions.register)("controls_if_tooltip",module$contents$Blockly$blocks$logic_CONTROLS_IF_TOOLTIP_EXTENSION);var module$contents$Blockly$blocks$logic_LOGIC_COMPARE_ONCHANGE_MIXIN={onchange:function(a){this.prevBlocks_||(this.prevBlocks_=[null,null]);var b=this.getInputTargetBlock("A"),c=this.getInputTargetBlock("B");b&&c&&!this.workspace.connectionChecker.doTypeChecks(b.outputConnection,c.outputConnection)&&((0,$.module$exports$Blockly$Events.setGroup)(a.group),(a=this.prevBlocks_[0])!==b&&(b.unplug(),!a||a.isDisposed()||a.isShadow()||this.getInput("A").connection.connect(a.outputConnection)),(b=this.prevBlocks_[1])!==c&&(c.unplug(),!b||b.isDisposed()||b.isShadow()||this.getInput("B").connection.connect(b.outputConnection)),this.bumpNeighbours(),(0,$.module$exports$Blockly$Events.setGroup)(!1)),this.prevBlocks_[0]=this.getInputTargetBlock("A"),this.prevBlocks_[1]=this.getInputTargetBlock("B")}},module$contents$Blockly$blocks$logic_LOGIC_COMPARE_EXTENSION=function(){this.mixin(module$contents$Blockly$blocks$logic_LOGIC_COMPARE_ONCHANGE_MIXIN)};(0,$.module$exports$Blockly$Extensions.register)("logic_compare",module$contents$Blockly$blocks$logic_LOGIC_COMPARE_EXTENSION);var module$contents$Blockly$blocks$logic_LOGIC_TERNARY_ONCHANGE_MIXIN={prevParentConnection_:null,onchange:function(a){var b=this.getInputTargetBlock("THEN"),c=this.getInputTargetBlock("ELSE"),d=this.outputConnection.targetConnection;if((b||c)&&d)for(var e=0;2>e;e++){var f=1===e?b:c;f&&!f.workspace.connectionChecker.doTypeChecks(f.outputConnection,d)&&((0,$.module$exports$Blockly$Events.setGroup)(a.group),d===this.prevParentConnection_?(this.unplug(),d.getSourceBlock().bumpNeighbours()):(f.unplug(),f.bumpNeighbours()),(0,$.module$exports$Blockly$Events.setGroup)(!1))}this.prevParentConnection_=d}};return(0,$.module$exports$Blockly$Extensions.registerMixin)("logic_ternary",module$contents$Blockly$blocks$logic_LOGIC_TERNARY_ONCHANGE_MIXIN),(0,$.module$exports$Blockly$common.defineBlocksWithJsonArray)([{type:"lists_create_empty",message0:"%{BKY_LISTS_CREATE_EMPTY_TITLE}",output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_CREATE_EMPTY_TOOLTIP}",helpUrl:"%{BKY_LISTS_CREATE_EMPTY_HELPURL}"},{type:"lists_repeat",message0:"%{BKY_LISTS_REPEAT_TITLE}",args0:[{type:"input_value",name:"ITEM"},{type:"input_value",name:"NUM",check:"Number"}],output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_LISTS_REPEAT_HELPURL}"},{type:"lists_reverse",message0:"%{BKY_LISTS_REVERSE_MESSAGE0}",args0:[{type:"input_value",name:"LIST",check:"Array"}],output:"Array",inputsInline:!0,style:"list_blocks",tooltip:"%{BKY_LISTS_REVERSE_TOOLTIP}",helpUrl:"%{BKY_LISTS_REVERSE_HELPURL}"},{type:"lists_isEmpty",message0:"%{BKY_LISTS_ISEMPTY_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Boolean",style:"list_blocks",tooltip:"%{BKY_LISTS_ISEMPTY_TOOLTIP}",helpUrl:"%{BKY_LISTS_ISEMPTY_HELPURL}"},{type:"lists_length",message0:"%{BKY_LISTS_LENGTH_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Number",style:"list_blocks",tooltip:"%{BKY_LISTS_LENGTH_TOOLTIP}",helpUrl:"%{BKY_LISTS_LENGTH_HELPURL}"}]),$.module$exports$Blockly$blocks.Blocks.lists_create_with={init:function(){this.setHelpUrl($.module$exports$Blockly$Msg.Msg.LISTS_CREATE_WITH_HELPURL),this.setStyle("list_blocks"),this.itemCount_=3,this.updateShape_(),this.setOutput(!0,"Array"),this.setMutator(new $.module$exports$Blockly$Mutator.Mutator(["lists_create_with_item"])),this.setTooltip($.module$exports$Blockly$Msg.Msg.LISTS_CREATE_WITH_TOOLTIP)},mutationToDom:function(){var a=(0,$.module$exports$Blockly$utils$xml.createElement)("mutation");return a.setAttribute("items",this.itemCount_),a},domToMutation:function(a){this.itemCount_=parseInt(a.getAttribute("items"),10),this.updateShape_()},saveExtraState:function(){return{itemCount:this.itemCount_}},loadExtraState:function(a){this.itemCount_=a.itemCount,this.updateShape_()},decompose:function(a){var b=a.newBlock("lists_create_with_container");b.initSvg();for(var c=b.getInput("STACK").connection,d=0;d<this.itemCount_;d++){var e=a.newBlock("lists_create_with_item");e.initSvg(),c.connect(e.previousConnection),c=e.nextConnection}return b},compose:function(a){var b=a.getInputTargetBlock("STACK");for(a=[];b&&!b.isInsertionMarker();)a.push(b.valueConnection_),b=b.nextConnection&&b.nextConnection.targetBlock();for(b=0;b<this.itemCount_;b++){var c=this.getInput("ADD"+b).connection.targetConnection;c&&-1===a.indexOf(c)&&c.disconnect()}for(this.itemCount_=a.length,this.updateShape_(),b=0;b<this.itemCount_;b++)$.module$exports$Blockly$Mutator.Mutator.reconnect(a[b],this,"ADD"+b)},saveConnections:function(a){a=a.getInputTargetBlock("STACK");for(var b=0;a;){var c=this.getInput("ADD"+b);a.valueConnection_=c&&c.connection.targetConnection,a=a.nextConnection&&a.nextConnection.targetBlock(),b++}},updateShape_:function(){this.itemCount_&&this.getInput("EMPTY")?this.removeInput("EMPTY"):this.itemCount_||this.getInput("EMPTY")||this.appendDummyInput("EMPTY").appendField($.module$exports$Blockly$Msg.Msg.LISTS_CREATE_EMPTY_TITLE);for(var a=0;a<this.itemCount_;a++)if(!this.getInput("ADD"+a)){var b=this.appendValueInput("ADD"+a).setAlign($.module$exports$Blockly$Input.Align.RIGHT);0===a&&b.appendField($.module$exports$Blockly$Msg.Msg.LISTS_CREATE_WITH_INPUT_WITH)}for(a=this.itemCount_;this.getInput("ADD"+a);a++)this.removeInput("ADD"+a)}},$.module$exports$Blockly$blocks.Blocks.lists_create_with_container={init:function(){this.setStyle("list_blocks"),this.appendDummyInput().appendField($.module$exports$Blockly$Msg.Msg.LISTS_CREATE_WITH_CONTAINER_TITLE_ADD),this.appendStatementInput("STACK"),this.setTooltip($.module$exports$Blockly$Msg.Msg.LISTS_CREATE_WITH_CONTAINER_TOOLTIP),this.contextMenu=!1}},$.module$exports$Blockly$blocks.Blocks.lists_create_with_item={init:function(){this.setStyle("list_blocks"),this.appendDummyInput().appendField($.module$exports$Blockly$Msg.Msg.LISTS_CREATE_WITH_ITEM_TITLE),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip($.module$exports$Blockly$Msg.Msg.LISTS_CREATE_WITH_ITEM_TOOLTIP),this.contextMenu=!1}},$.module$exports$Blockly$blocks.Blocks.lists_indexOf={init:function(){var a=[[$.module$exports$Blockly$Msg.Msg.LISTS_INDEX_OF_FIRST,"FIRST"],[$.module$exports$Blockly$Msg.Msg.LISTS_INDEX_OF_LAST,"LAST"]];this.setHelpUrl($.module$exports$Blockly$Msg.Msg.LISTS_INDEX_OF_HELPURL),this.setStyle("list_blocks"),this.setOutput(!0,"Number"),this.appendValueInput("VALUE").setCheck("Array").appendField($.module$exports$Blockly$Msg.Msg.LISTS_INDEX_OF_INPUT_IN_LIST),this.appendValueInput("FIND").appendField(new $.module$exports$Blockly$FieldDropdown.FieldDropdown(a),"END"),this.setInputsInline(!0);var b=this;this.setTooltip((function(){return $.module$exports$Blockly$Msg.Msg.LISTS_INDEX_OF_TOOLTIP.replace("%1",b.workspace.options.oneBasedIndex?"0":"-1")}))}},$.module$exports$Blockly$blocks.Blocks.lists_getIndex={init:function(){var a=[[$.module$exports$Blockly$Msg.Msg.LISTS_GET_INDEX_GET,"GET"],[$.module$exports$Blockly$Msg.Msg.LISTS_GET_INDEX_GET_REMOVE,"GET_REMOVE"],[$.module$exports$Blockly$Msg.Msg.LISTS_GET_INDEX_REMOVE,"REMOVE"]];this.WHERE_OPTIONS=[[$.module$exports$Blockly$Msg.Msg.LISTS_GET_INDEX_FROM_START,"FROM_START"],[$.module$exports$Blockly$Msg.Msg.LISTS_GET_INDEX_FROM_END,"FROM_END"],[$.module$exports$Blockly$Msg.Msg.LISTS_GET_INDEX_FIRST,"FIRST"],[$.module$exports$Blockly$Msg.Msg.LISTS_GET_INDEX_LAST,"LAST"],[$.module$exports$Blockly$Msg.Msg.LISTS_GET_INDEX_RANDOM,"RANDOM"]],this.setHelpUrl($.module$exports$Blockly$Msg.Msg.LISTS_GET_INDEX_HELPURL),this.setStyle("list_blocks"),a=new $.module$exports$Blockly$FieldDropdown.FieldDropdown(a,(function(c){c="REMOVE"===c,this.getSourceBlock().updateStatement_(c)})),this.appendValueInput("VALUE").setCheck("Array").appendField($.module$exports$Blockly$Msg.Msg.LISTS_GET_INDEX_INPUT_IN_LIST),this.appendDummyInput().appendField(a,"MODE").appendField("","SPACE"),this.appendDummyInput("AT"),$.module$exports$Blockly$Msg.Msg.LISTS_GET_INDEX_TAIL&&this.appendDummyInput("TAIL").appendField($.module$exports$Blockly$Msg.Msg.LISTS_GET_INDEX_TAIL),this.setInputsInline(!0),this.setOutput(!0),this.updateAt_(!0);var b=this;this.setTooltip((function(){var c=b.getFieldValue("MODE"),d=b.getFieldValue("WHERE"),e="";switch(c+" "+d){case"GET FROM_START":case"GET FROM_END":e=$.module$exports$Blockly$Msg.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FROM;break;case"GET FIRST":e=$.module$exports$Blockly$Msg.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FIRST;break;case"GET LAST":e=$.module$exports$Blockly$Msg.Msg.LISTS_GET_INDEX_TOOLTIP_GET_LAST;break;case"GET RANDOM":e=$.module$exports$Blockly$Msg.Msg.LISTS_GET_INDEX_TOOLTIP_GET_RANDOM;break;case"GET_REMOVE FROM_START":case"GET_REMOVE FROM_END":e=$.module$exports$Blockly$Msg.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FROM;break;case"GET_REMOVE FIRST":e=$.module$exports$Blockly$Msg.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FIRST;break;case"GET_REMOVE LAST":e=$.module$exports$Blockly$Msg.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_LAST;break;case"GET_REMOVE RANDOM":e=$.module$exports$Blockly$Msg.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_RANDOM;break;case"REMOVE FROM_START":case"REMOVE FROM_END":e=$.module$exports$Blockly$Msg.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FROM;break;case"REMOVE FIRST":e=$.module$exports$Blockly$Msg.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FIRST;break;case"REMOVE LAST":e=$.module$exports$Blockly$Msg.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_LAST;break;case"REMOVE RANDOM":e=$.module$exports$Blockly$Msg.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_RANDOM}return"FROM_START"!==d&&"FROM_END"!==d||(e+="  "+("FROM_START"===d?$.module$exports$Blockly$Msg.Msg.LISTS_INDEX_FROM_START_TOOLTIP:$.module$exports$Blockly$Msg.Msg.LISTS_INDEX_FROM_END_TOOLTIP).replace("%1",b.workspace.options.oneBasedIndex?"#1":"#0")),e}))},mutationToDom:function(){var a=(0,$.module$exports$Blockly$utils$xml.createElement)("mutation");a.setAttribute("statement",!this.outputConnection);var b=this.getInput("AT").type===$.module$exports$Blockly$ConnectionType.ConnectionType.INPUT_VALUE;return a.setAttribute("at",b),a},domToMutation:function(a){var b="true"===a.getAttribute("statement");this.updateStatement_(b),a="false"!==a.getAttribute("at"),this.updateAt_(a)},updateStatement_:function(a){a!==!this.outputConnection&&(this.unplug(!0,!0),a?(this.setOutput(!1),this.setPreviousStatement(!0),this.setNextStatement(!0)):(this.setPreviousStatement(!1),this.setNextStatement(!1),this.setOutput(!0)))},updateAt_:function(a){this.removeInput("AT"),this.removeInput("ORDINAL",!0),a?(this.appendValueInput("AT").setCheck("Number"),$.module$exports$Blockly$Msg.Msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField($.module$exports$Blockly$Msg.Msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT");var b=new $.module$exports$Blockly$FieldDropdown.FieldDropdown(this.WHERE_OPTIONS,(function(c){var d="FROM_START"===c||"FROM_END"===c;if(d!==a){var e=this.getSourceBlock();return e.updateAt_(d),e.setFieldValue(c,"WHERE"),null}}));this.getInput("AT").appendField(b,"WHERE"),$.module$exports$Blockly$Msg.Msg.LISTS_GET_INDEX_TAIL&&this.moveInputBefore("TAIL",null)}},$.module$exports$Blockly$blocks.Blocks.lists_setIndex={init:function(){var a=[[$.module$exports$Blockly$Msg.Msg.LISTS_SET_INDEX_SET,"SET"],[$.module$exports$Blockly$Msg.Msg.LISTS_SET_INDEX_INSERT,"INSERT"]];this.WHERE_OPTIONS=[[$.module$exports$Blockly$Msg.Msg.LISTS_GET_INDEX_FROM_START,"FROM_START"],[$.module$exports$Blockly$Msg.Msg.LISTS_GET_INDEX_FROM_END,"FROM_END"],[$.module$exports$Blockly$Msg.Msg.LISTS_GET_INDEX_FIRST,"FIRST"],[$.module$exports$Blockly$Msg.Msg.LISTS_GET_INDEX_LAST,"LAST"],[$.module$exports$Blockly$Msg.Msg.LISTS_GET_INDEX_RANDOM,"RANDOM"]],this.setHelpUrl($.module$exports$Blockly$Msg.Msg.LISTS_SET_INDEX_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("LIST").setCheck("Array").appendField($.module$exports$Blockly$Msg.Msg.LISTS_SET_INDEX_INPUT_IN_LIST),this.appendDummyInput().appendField(new $.module$exports$Blockly$FieldDropdown.FieldDropdown(a),"MODE").appendField("","SPACE"),this.appendDummyInput("AT"),this.appendValueInput("TO").appendField($.module$exports$Blockly$Msg.Msg.LISTS_SET_INDEX_INPUT_TO),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip($.module$exports$Blockly$Msg.Msg.LISTS_SET_INDEX_TOOLTIP),this.updateAt_(!0);var b=this;this.setTooltip((function(){var c=b.getFieldValue("MODE"),d=b.getFieldValue("WHERE"),e="";switch(c+" "+d){case"SET FROM_START":case"SET FROM_END":e=$.module$exports$Blockly$Msg.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FROM;break;case"SET FIRST":e=$.module$exports$Blockly$Msg.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FIRST;break;case"SET LAST":e=$.module$exports$Blockly$Msg.Msg.LISTS_SET_INDEX_TOOLTIP_SET_LAST;break;case"SET RANDOM":e=$.module$exports$Blockly$Msg.Msg.LISTS_SET_INDEX_TOOLTIP_SET_RANDOM;break;case"INSERT FROM_START":case"INSERT FROM_END":e=$.module$exports$Blockly$Msg.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FROM;break;case"INSERT FIRST":e=$.module$exports$Blockly$Msg.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FIRST;break;case"INSERT LAST":e=$.module$exports$Blockly$Msg.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_LAST;break;case"INSERT RANDOM":e=$.module$exports$Blockly$Msg.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_RANDOM}return"FROM_START"!==d&&"FROM_END"!==d||(e+="  "+$.module$exports$Blockly$Msg.Msg.LISTS_INDEX_FROM_START_TOOLTIP.replace("%1",b.workspace.options.oneBasedIndex?"#1":"#0")),e}))},mutationToDom:function(){var a=(0,$.module$exports$Blockly$utils$xml.createElement)("mutation"),b=this.getInput("AT").type===$.module$exports$Blockly$ConnectionType.ConnectionType.INPUT_VALUE;return a.setAttribute("at",b),a},domToMutation:function(a){a="false"!==a.getAttribute("at"),this.updateAt_(a)},updateAt_:function(a){this.removeInput("AT"),this.removeInput("ORDINAL",!0),a?(this.appendValueInput("AT").setCheck("Number"),$.module$exports$Blockly$Msg.Msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField($.module$exports$Blockly$Msg.Msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT");var b=new $.module$exports$Blockly$FieldDropdown.FieldDropdown(this.WHERE_OPTIONS,(function(c){var d="FROM_START"===c||"FROM_END"===c;if(d!==a){var e=this.getSourceBlock();return e.updateAt_(d),e.setFieldValue(c,"WHERE"),null}}));this.moveInputBefore("AT","TO"),this.getInput("ORDINAL")&&this.moveInputBefore("ORDINAL","TO"),this.getInput("AT").appendField(b,"WHERE")}},$.module$exports$Blockly$blocks.Blocks.lists_getSublist={init:function(){this.WHERE_OPTIONS_1=[[$.module$exports$Blockly$Msg.Msg.LISTS_GET_SUBLIST_START_FROM_START,"FROM_START"],[$.module$exports$Blockly$Msg.Msg.LISTS_GET_SUBLIST_START_FROM_END,"FROM_END"],[$.module$exports$Blockly$Msg.Msg.LISTS_GET_SUBLIST_START_FIRST,"FIRST"]],this.WHERE_OPTIONS_2=[[$.module$exports$Blockly$Msg.Msg.LISTS_GET_SUBLIST_END_FROM_START,"FROM_START"],[$.module$exports$Blockly$Msg.Msg.LISTS_GET_SUBLIST_END_FROM_END,"FROM_END"],[$.module$exports$Blockly$Msg.Msg.LISTS_GET_SUBLIST_END_LAST,"LAST"]],this.setHelpUrl($.module$exports$Blockly$Msg.Msg.LISTS_GET_SUBLIST_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("LIST").setCheck("Array").appendField($.module$exports$Blockly$Msg.Msg.LISTS_GET_SUBLIST_INPUT_IN_LIST),this.appendDummyInput("AT1"),this.appendDummyInput("AT2"),$.module$exports$Blockly$Msg.Msg.LISTS_GET_SUBLIST_TAIL&&this.appendDummyInput("TAIL").appendField($.module$exports$Blockly$Msg.Msg.LISTS_GET_SUBLIST_TAIL),this.setInputsInline(!0),this.setOutput(!0,"Array"),this.updateAt_(1,!0),this.updateAt_(2,!0),this.setTooltip($.module$exports$Blockly$Msg.Msg.LISTS_GET_SUBLIST_TOOLTIP)},mutationToDom:function(){var a=(0,$.module$exports$Blockly$utils$xml.createElement)("mutation"),b=this.getInput("AT1").type===$.module$exports$Blockly$ConnectionType.ConnectionType.INPUT_VALUE;return a.setAttribute("at1",b),b=this.getInput("AT2").type===$.module$exports$Blockly$ConnectionType.ConnectionType.INPUT_VALUE,a.setAttribute("at2",b),a},domToMutation:function(a){var b="true"===a.getAttribute("at1");a="true"===a.getAttribute("at2"),this.updateAt_(1,b),this.updateAt_(2,a)},updateAt_:function(a,b){this.removeInput("AT"+a),this.removeInput("ORDINAL"+a,!0),b?(this.appendValueInput("AT"+a).setCheck("Number"),$.module$exports$Blockly$Msg.Msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL"+a).appendField($.module$exports$Blockly$Msg.Msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"+a);var c=new $.module$exports$Blockly$FieldDropdown.FieldDropdown(this["WHERE_OPTIONS_"+a],(function(d){var e="FROM_START"===d||"FROM_END"===d;if(e!==b){var f=this.getSourceBlock();return f.updateAt_(a,e),f.setFieldValue(d,"WHERE"+a),null}}));this.getInput("AT"+a).appendField(c,"WHERE"+a),1===a&&(this.moveInputBefore("AT1","AT2"),this.getInput("ORDINAL1")&&this.moveInputBefore("ORDINAL1","AT2")),$.module$exports$Blockly$Msg.Msg.LISTS_GET_SUBLIST_TAIL&&this.moveInputBefore("TAIL",null)}},$.module$exports$Blockly$blocks.Blocks.lists_sort={init:function(){this.jsonInit({message0:$.module$exports$Blockly$Msg.Msg.LISTS_SORT_TITLE,args0:[{type:"field_dropdown",name:"TYPE",options:[[$.module$exports$Blockly$Msg.Msg.LISTS_SORT_TYPE_NUMERIC,"NUMERIC"],[$.module$exports$Blockly$Msg.Msg.LISTS_SORT_TYPE_TEXT,"TEXT"],[$.module$exports$Blockly$Msg.Msg.LISTS_SORT_TYPE_IGNORECASE,"IGNORE_CASE"]]},{type:"field_dropdown",name:"DIRECTION",options:[[$.module$exports$Blockly$Msg.Msg.LISTS_SORT_ORDER_ASCENDING,"1"],[$.module$exports$Blockly$Msg.Msg.LISTS_SORT_ORDER_DESCENDING,"-1"]]},{type:"input_value",name:"LIST",check:"Array"}],output:"Array",style:"list_blocks",tooltip:$.module$exports$Blockly$Msg.Msg.LISTS_SORT_TOOLTIP,helpUrl:$.module$exports$Blockly$Msg.Msg.LISTS_SORT_HELPURL})}},$.module$exports$Blockly$blocks.Blocks.lists_split={init:function(){var a=this,b=new $.module$exports$Blockly$FieldDropdown.FieldDropdown([[$.module$exports$Blockly$Msg.Msg.LISTS_SPLIT_LIST_FROM_TEXT,"SPLIT"],[$.module$exports$Blockly$Msg.Msg.LISTS_SPLIT_TEXT_FROM_LIST,"JOIN"]],(function(c){a.updateType_(c)}));this.setHelpUrl($.module$exports$Blockly$Msg.Msg.LISTS_SPLIT_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("INPUT").setCheck("String").appendField(b,"MODE"),this.appendValueInput("DELIM").setCheck("String").appendField($.module$exports$Blockly$Msg.Msg.LISTS_SPLIT_WITH_DELIMITER),this.setInputsInline(!0),this.setOutput(!0,"Array"),this.setTooltip((function(){var c=a.getFieldValue("MODE");if("SPLIT"===c)return $.module$exports$Blockly$Msg.Msg.LISTS_SPLIT_TOOLTIP_SPLIT;if("JOIN"===c)return $.module$exports$Blockly$Msg.Msg.LISTS_SPLIT_TOOLTIP_JOIN;throw Error("Unknown mode: "+c)}))},updateType_:function(a){if(this.getFieldValue("MODE")!==a){var b=this.getInput("INPUT").connection;b.setShadowDom(null);var c=b.targetBlock();c&&(b.disconnect(),c.isShadow()?c.dispose():this.bumpNeighbours())}"SPLIT"===a?(this.outputConnection.setCheck("Array"),this.getInput("INPUT").setCheck("String")):(this.outputConnection.setCheck("String"),this.getInput("INPUT").setCheck("Array"))},mutationToDom:function(){var a=(0,$.module$exports$Blockly$utils$xml.createElement)("mutation");return a.setAttribute("mode",this.getFieldValue("MODE")),a},domToMutation:function(a){this.updateType_(a.getAttribute("mode"))}},(0,$.module$exports$Blockly$common.defineBlocksWithJsonArray)([{type:"colour_picker",message0:"%1",args0:[{type:"field_colour",name:"COLOUR",colour:"#ff0000"}],output:"Colour",helpUrl:"%{BKY_COLOUR_PICKER_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_PICKER_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"colour_random",message0:"%{BKY_COLOUR_RANDOM_TITLE}",output:"Colour",helpUrl:"%{BKY_COLOUR_RANDOM_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_RANDOM_TOOLTIP}"},{type:"colour_rgb",message0:"%{BKY_COLOUR_RGB_TITLE} %{BKY_COLOUR_RGB_RED} %1 %{BKY_COLOUR_RGB_GREEN} %2 %{BKY_COLOUR_RGB_BLUE} %3",args0:[{type:"input_value",name:"RED",check:"Number",align:"RIGHT"},{type:"input_value",name:"GREEN",check:"Number",align:"RIGHT"},{type:"input_value",name:"BLUE",check:"Number",align:"RIGHT"}],output:"Colour",helpUrl:"%{BKY_COLOUR_RGB_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_RGB_TOOLTIP}"},{type:"colour_blend",message0:"%{BKY_COLOUR_BLEND_TITLE} %{BKY_COLOUR_BLEND_COLOUR1} %1 %{BKY_COLOUR_BLEND_COLOUR2} %2 %{BKY_COLOUR_BLEND_RATIO} %3",args0:[{type:"input_value",name:"COLOUR1",check:"Colour",align:"RIGHT"},{type:"input_value",name:"COLOUR2",check:"Colour",align:"RIGHT"},{type:"input_value",name:"RATIO",check:"Number",align:"RIGHT"}],output:"Colour",helpUrl:"%{BKY_COLOUR_BLEND_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_BLEND_TOOLTIP}"}]),$.Blockly.Blocks})?__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__):__WEBPACK_AMD_DEFINE_FACTORY__)||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},6421:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(8256),__webpack_require__(9177),__webpack_require__(1003),__webpack_require__(5466)],void 0===(__WEBPACK_AMD_DEFINE_RESULT__="function"==typeof(__WEBPACK_AMD_DEFINE_FACTORY__=function(Blockly,En,BlocklyBlocks,BlocklyJS){"use strict";return Blockly.setLocale(En),Blockly})?__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__):__WEBPACK_AMD_DEFINE_FACTORY__)||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},8256:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(4097)],void 0===(__WEBPACK_AMD_DEFINE_RESULT__="function"==typeof(__WEBPACK_AMD_DEFINE_FACTORY__=function(Blockly){"use strict";return Blockly.setLocale=function(locale){Object.keys(locale).forEach((function(k){Blockly.Msg[k]=locale[k]}))},Blockly})?__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__):__WEBPACK_AMD_DEFINE_FACTORY__)||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},4948:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(6421)],void 0===(__WEBPACK_AMD_DEFINE_RESULT__="function"==typeof(__WEBPACK_AMD_DEFINE_FACTORY__=function(Blockly){return Blockly})?__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__):__WEBPACK_AMD_DEFINE_FACTORY__)||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},5466:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(8256),__webpack_require__(9274)],void 0===(__WEBPACK_AMD_DEFINE_RESULT__="function"==typeof(__WEBPACK_AMD_DEFINE_FACTORY__=function(Blockly,BlocklyJavaScript){return BlocklyJavaScript})?__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__):__WEBPACK_AMD_DEFINE_FACTORY__)||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},9274:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(1334)],void 0===(__WEBPACK_AMD_DEFINE_RESULT__="function"==typeof(__WEBPACK_AMD_DEFINE_FACTORY__=function(Blockly){const $=Blockly.internal_;var module$contents$Blockly$JavaScript_JavaScript=new $.module$exports$Blockly$Generator.Generator("JavaScript");module$contents$Blockly$JavaScript_JavaScript.addReservedWords("break,case,catch,class,const,continue,debugger,default,delete,do,else,export,extends,finally,for,function,if,import,in,instanceof,new,return,super,switch,this,throw,try,typeof,var,void,while,with,yield,enum,implements,interface,let,package,private,protected,public,static,await,null,true,false,arguments,"+Object.getOwnPropertyNames($.module$exports$Blockly$utils$global.globalThis).join(",")),module$contents$Blockly$JavaScript_JavaScript.ORDER_ATOMIC=0,module$contents$Blockly$JavaScript_JavaScript.ORDER_NEW=1.1,module$contents$Blockly$JavaScript_JavaScript.ORDER_MEMBER=1.2,module$contents$Blockly$JavaScript_JavaScript.ORDER_FUNCTION_CALL=2,module$contents$Blockly$JavaScript_JavaScript.ORDER_INCREMENT=3,module$contents$Blockly$JavaScript_JavaScript.ORDER_DECREMENT=3,module$contents$Blockly$JavaScript_JavaScript.ORDER_BITWISE_NOT=4.1,module$contents$Blockly$JavaScript_JavaScript.ORDER_UNARY_PLUS=4.2,module$contents$Blockly$JavaScript_JavaScript.ORDER_UNARY_NEGATION=4.3,module$contents$Blockly$JavaScript_JavaScript.ORDER_LOGICAL_NOT=4.4,module$contents$Blockly$JavaScript_JavaScript.ORDER_TYPEOF=4.5,module$contents$Blockly$JavaScript_JavaScript.ORDER_VOID=4.6,module$contents$Blockly$JavaScript_JavaScript.ORDER_DELETE=4.7,module$contents$Blockly$JavaScript_JavaScript.ORDER_AWAIT=4.8,module$contents$Blockly$JavaScript_JavaScript.ORDER_EXPONENTIATION=5,module$contents$Blockly$JavaScript_JavaScript.ORDER_MULTIPLICATION=5.1,module$contents$Blockly$JavaScript_JavaScript.ORDER_DIVISION=5.2,module$contents$Blockly$JavaScript_JavaScript.ORDER_MODULUS=5.3,module$contents$Blockly$JavaScript_JavaScript.ORDER_SUBTRACTION=6.1,module$contents$Blockly$JavaScript_JavaScript.ORDER_ADDITION=6.2,module$contents$Blockly$JavaScript_JavaScript.ORDER_BITWISE_SHIFT=7,module$contents$Blockly$JavaScript_JavaScript.ORDER_RELATIONAL=8,module$contents$Blockly$JavaScript_JavaScript.ORDER_IN=8,module$contents$Blockly$JavaScript_JavaScript.ORDER_INSTANCEOF=8,module$contents$Blockly$JavaScript_JavaScript.ORDER_EQUALITY=9,module$contents$Blockly$JavaScript_JavaScript.ORDER_BITWISE_AND=10,module$contents$Blockly$JavaScript_JavaScript.ORDER_BITWISE_XOR=11,module$contents$Blockly$JavaScript_JavaScript.ORDER_BITWISE_OR=12,module$contents$Blockly$JavaScript_JavaScript.ORDER_LOGICAL_AND=13,module$contents$Blockly$JavaScript_JavaScript.ORDER_LOGICAL_OR=14,module$contents$Blockly$JavaScript_JavaScript.ORDER_CONDITIONAL=15,module$contents$Blockly$JavaScript_JavaScript.ORDER_ASSIGNMENT=16,module$contents$Blockly$JavaScript_JavaScript.ORDER_YIELD=17,module$contents$Blockly$JavaScript_JavaScript.ORDER_COMMA=18,module$contents$Blockly$JavaScript_JavaScript.ORDER_NONE=99,module$contents$Blockly$JavaScript_JavaScript.ORDER_OVERRIDES=[[module$contents$Blockly$JavaScript_JavaScript.ORDER_FUNCTION_CALL,module$contents$Blockly$JavaScript_JavaScript.ORDER_MEMBER],[module$contents$Blockly$JavaScript_JavaScript.ORDER_FUNCTION_CALL,module$contents$Blockly$JavaScript_JavaScript.ORDER_FUNCTION_CALL],[module$contents$Blockly$JavaScript_JavaScript.ORDER_MEMBER,module$contents$Blockly$JavaScript_JavaScript.ORDER_MEMBER],[module$contents$Blockly$JavaScript_JavaScript.ORDER_MEMBER,module$contents$Blockly$JavaScript_JavaScript.ORDER_FUNCTION_CALL],[module$contents$Blockly$JavaScript_JavaScript.ORDER_LOGICAL_NOT,module$contents$Blockly$JavaScript_JavaScript.ORDER_LOGICAL_NOT],[module$contents$Blockly$JavaScript_JavaScript.ORDER_MULTIPLICATION,module$contents$Blockly$JavaScript_JavaScript.ORDER_MULTIPLICATION],[module$contents$Blockly$JavaScript_JavaScript.ORDER_ADDITION,module$contents$Blockly$JavaScript_JavaScript.ORDER_ADDITION],[module$contents$Blockly$JavaScript_JavaScript.ORDER_LOGICAL_AND,module$contents$Blockly$JavaScript_JavaScript.ORDER_LOGICAL_AND],[module$contents$Blockly$JavaScript_JavaScript.ORDER_LOGICAL_OR,module$contents$Blockly$JavaScript_JavaScript.ORDER_LOGICAL_OR]],module$contents$Blockly$JavaScript_JavaScript.isInitialized=!1,module$contents$Blockly$JavaScript_JavaScript.init=function(a){Object.getPrototypeOf(this).init.call(this),this.nameDB_?this.nameDB_.reset():this.nameDB_=new $.module$exports$Blockly$Names.Names(this.RESERVED_WORDS_),this.nameDB_.setVariableMap(a.getVariableMap()),this.nameDB_.populateVariables(a),this.nameDB_.populateProcedures(a);for(var b=[],c=(0,$.module$exports$Blockly$Variables.allDeveloperVariables)(a),d=0;d<c.length;d++)b.push(this.nameDB_.getName(c[d],$.module$exports$Blockly$Names.NameType.DEVELOPER_VARIABLE));for(a=(0,$.module$exports$Blockly$Variables.allUsedVarModels)(a),c=0;c<a.length;c++)b.push(this.nameDB_.getName(a[c].getId(),$.module$exports$Blockly$Names.NameType.VARIABLE));b.length&&(this.definitions_.variables="var "+b.join(", ")+";"),this.isInitialized=!0},module$contents$Blockly$JavaScript_JavaScript.finish=function(a){var b=(0,$.module$exports$Blockly$utils$object.values)(this.definitions_);return a=Object.getPrototypeOf(this).finish.call(this,a),this.isInitialized=!1,this.nameDB_.reset(),b.join("\n\n")+"\n\n\n"+a},module$contents$Blockly$JavaScript_JavaScript.scrubNakedValue=function(a){return a+";\n"},module$contents$Blockly$JavaScript_JavaScript.quote_=function(a){return"'"+(a=a.replace(/\\/g,"\\\\").replace(/\n/g,"\\\n").replace(/'/g,"\\'"))+"'"},module$contents$Blockly$JavaScript_JavaScript.multiline_quote_=function(a){return a.split(/\n/g).map(this.quote_).join(" + '\\n' +\n")},module$contents$Blockly$JavaScript_JavaScript.scrub_=function(a,b,c){var d="";if(!a.outputConnection||!a.outputConnection.targetConnection){var e=a.getCommentText();e&&(e=(0,$.module$exports$Blockly$utils$string.wrap)(e,this.COMMENT_WRAP-3),d+=this.prefixLines(e+"\n","// "));for(var f=0;f<a.inputList.length;f++)a.inputList[f].type===$.module$exports$Blockly$inputTypes.inputTypes.VALUE&&(e=a.inputList[f].connection.targetBlock())&&(e=this.allNestedComments(e))&&(d+=this.prefixLines(e,"// "))}return a=a.nextConnection&&a.nextConnection.targetBlock(),d+b+(c=c?"":this.blockToCode(a))},module$contents$Blockly$JavaScript_JavaScript.getAdjusted=function(a,b,c,d,e){c=c||0,e=e||this.ORDER_NONE,a.workspace.options.oneBasedIndex&&c--;var f=a.workspace.options.oneBasedIndex?"1":"0",g=e;if(0<c)var h=g=this.ORDER_ADDITION;else 0>c?h=g=this.ORDER_SUBTRACTION:d&&(h=g=this.ORDER_UNARY_NEGATION);return a=this.valueToCode(a,b,g)||f,(0,$.module$exports$Blockly$utils$string.isNumber)(a)?(a=Number(a)+c,d&&(a=-a)):(0<c?a=a+" + "+c:0>c&&(a=a+" - "+-c),d&&(a=c?"-("+a+")":"-"+a),h=Math.floor(h),e=Math.floor(e),h&&e>=h&&(a="("+a+")")),a},$.Blockly.JavaScript=module$contents$Blockly$JavaScript_JavaScript,$.Blockly.JavaScript.variables_get=function(a){return[$.Blockly.JavaScript.nameDB_.getName(a.getFieldValue("VAR"),$.module$exports$Blockly$Names.NameType.VARIABLE),$.Blockly.JavaScript.ORDER_ATOMIC]},$.Blockly.JavaScript.variables_set=function(a){var b=$.Blockly.JavaScript.valueToCode(a,"VALUE",$.Blockly.JavaScript.ORDER_ASSIGNMENT)||"0";return $.Blockly.JavaScript.nameDB_.getName(a.getFieldValue("VAR"),$.module$exports$Blockly$Names.NameType.VARIABLE)+" = "+b+";\n"},$.Blockly.JavaScript.variables_get_dynamic=$.Blockly.JavaScript.variables_get,$.Blockly.JavaScript.variables_set_dynamic=$.Blockly.JavaScript.variables_set;var module$contents$Blockly$JavaScript$texts_strRegExp=/^\s*'([^']|\\')*'\s*$/,module$contents$Blockly$JavaScript$texts_forceString=function(a){return module$contents$Blockly$JavaScript$texts_strRegExp.test(a)?[a,$.Blockly.JavaScript.ORDER_ATOMIC]:["String("+a+")",$.Blockly.JavaScript.ORDER_FUNCTION_CALL]},module$contents$Blockly$JavaScript$texts_getSubstringIndex=function(a,b,c){return"FIRST"===b?"0":"FROM_END"===b?a+".length - 1 - "+c:"LAST"===b?a+".length - 1":c};$.Blockly.JavaScript.text=function(a){return[$.Blockly.JavaScript.quote_(a.getFieldValue("TEXT")),$.Blockly.JavaScript.ORDER_ATOMIC]},$.Blockly.JavaScript.text_multiline=function(a){var b=-1!==(a=$.Blockly.JavaScript.multiline_quote_(a.getFieldValue("TEXT"))).indexOf("+")?$.Blockly.JavaScript.ORDER_ADDITION:$.Blockly.JavaScript.ORDER_ATOMIC;return[a,b]},$.Blockly.JavaScript.text_join=function(a){switch(a.itemCount_){case 0:return["''",$.Blockly.JavaScript.ORDER_ATOMIC];case 1:return a=$.Blockly.JavaScript.valueToCode(a,"ADD0",$.Blockly.JavaScript.ORDER_NONE)||"''",module$contents$Blockly$JavaScript$texts_forceString(a);case 2:var b=$.Blockly.JavaScript.valueToCode(a,"ADD0",$.Blockly.JavaScript.ORDER_NONE)||"''";return a=$.Blockly.JavaScript.valueToCode(a,"ADD1",$.Blockly.JavaScript.ORDER_NONE)||"''",[module$contents$Blockly$JavaScript$texts_forceString(b)[0]+" + "+module$contents$Blockly$JavaScript$texts_forceString(a)[0],$.Blockly.JavaScript.ORDER_ADDITION];default:b=Array(a.itemCount_);for(var c=0;c<a.itemCount_;c++)b[c]=$.Blockly.JavaScript.valueToCode(a,"ADD"+c,$.Blockly.JavaScript.ORDER_NONE)||"''";return["["+b.join(",")+"].join('')",$.Blockly.JavaScript.ORDER_FUNCTION_CALL]}},$.Blockly.JavaScript.text_append=function(a){var b=$.Blockly.JavaScript.nameDB_.getName(a.getFieldValue("VAR"),$.module$exports$Blockly$Names.NameType.VARIABLE);return a=$.Blockly.JavaScript.valueToCode(a,"TEXT",$.Blockly.JavaScript.ORDER_NONE)||"''",b+" += "+module$contents$Blockly$JavaScript$texts_forceString(a)[0]+";\n"},$.Blockly.JavaScript.text_length=function(a){return[($.Blockly.JavaScript.valueToCode(a,"VALUE",$.Blockly.JavaScript.ORDER_MEMBER)||"''")+".length",$.Blockly.JavaScript.ORDER_MEMBER]},$.Blockly.JavaScript.text_isEmpty=function(a){return["!"+($.Blockly.JavaScript.valueToCode(a,"VALUE",$.Blockly.JavaScript.ORDER_MEMBER)||"''")+".length",$.Blockly.JavaScript.ORDER_LOGICAL_NOT]},$.Blockly.JavaScript.text_indexOf=function(a){var b="FIRST"===a.getFieldValue("END")?"indexOf":"lastIndexOf",c=$.Blockly.JavaScript.valueToCode(a,"FIND",$.Blockly.JavaScript.ORDER_NONE)||"''";return b=($.Blockly.JavaScript.valueToCode(a,"VALUE",$.Blockly.JavaScript.ORDER_MEMBER)||"''")+"."+b+"("+c+")",a.workspace.options.oneBasedIndex?[b+" + 1",$.Blockly.JavaScript.ORDER_ADDITION]:[b,$.Blockly.JavaScript.ORDER_FUNCTION_CALL]},$.Blockly.JavaScript.text_charAt=function(a){var b=a.getFieldValue("WHERE")||"FROM_START",c=$.Blockly.JavaScript.valueToCode(a,"VALUE","RANDOM"===b?$.Blockly.JavaScript.ORDER_NONE:$.Blockly.JavaScript.ORDER_MEMBER)||"''";switch(b){case"FIRST":return[c+".charAt(0)",$.Blockly.JavaScript.ORDER_FUNCTION_CALL];case"LAST":return[c+".slice(-1)",$.Blockly.JavaScript.ORDER_FUNCTION_CALL];case"FROM_START":return[c+".charAt("+(a=$.Blockly.JavaScript.getAdjusted(a,"AT"))+")",$.Blockly.JavaScript.ORDER_FUNCTION_CALL];case"FROM_END":return[c+".slice("+(a=$.Blockly.JavaScript.getAdjusted(a,"AT",1,!0))+").charAt(0)",$.Blockly.JavaScript.ORDER_FUNCTION_CALL];case"RANDOM":return[$.Blockly.JavaScript.provideFunction_("textRandomLetter",["function "+$.Blockly.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(text) {","  var x = Math.floor(Math.random() * text.length);","  return text[x];","}"])+"("+c+")",$.Blockly.JavaScript.ORDER_FUNCTION_CALL]}throw Error("Unhandled option (text_charAt).")},$.Blockly.JavaScript.text_getSubstring=function(a){var b=a.getFieldValue("WHERE1"),c=a.getFieldValue("WHERE2"),d="FROM_END"!==b&&"LAST"!==b&&"FROM_END"!==c&&"LAST"!==c,e=$.Blockly.JavaScript.valueToCode(a,"STRING",d?$.Blockly.JavaScript.ORDER_MEMBER:$.Blockly.JavaScript.ORDER_NONE)||"''";if("FIRST"===b&&"LAST"===c)return[e,$.Blockly.JavaScript.ORDER_NONE];if(e.match(/^'?\w+'?$/)||d){switch(b){case"FROM_START":b=$.Blockly.JavaScript.getAdjusted(a,"AT1");break;case"FROM_END":b=e+".length - "+(b=$.Blockly.JavaScript.getAdjusted(a,"AT1",1,!1,$.Blockly.JavaScript.ORDER_SUBTRACTION));break;case"FIRST":b="0";break;default:throw Error("Unhandled option (text_getSubstring).")}switch(c){case"FROM_START":c=$.Blockly.JavaScript.getAdjusted(a,"AT2",1);break;case"FROM_END":c=e+".length - "+(c=$.Blockly.JavaScript.getAdjusted(a,"AT2",0,!1,$.Blockly.JavaScript.ORDER_SUBTRACTION));break;case"LAST":c=e+".length";break;default:throw Error("Unhandled option (text_getSubstring).")}e=e+".slice("+b+", "+c+")"}else{d=$.Blockly.JavaScript.getAdjusted(a,"AT1"),a=$.Blockly.JavaScript.getAdjusted(a,"AT2");var f={FIRST:"First",LAST:"Last",FROM_START:"FromStart",FROM_END:"FromEnd"};e=$.Blockly.JavaScript.provideFunction_("subsequence"+f[b]+f[c],["function "+$.Blockly.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(sequence"+("FROM_END"===b||"FROM_START"===b?", at1":"")+("FROM_END"===c||"FROM_START"===c?", at2":"")+") {","  var start = "+module$contents$Blockly$JavaScript$texts_getSubstringIndex("sequence",b,"at1")+";","  var end = "+module$contents$Blockly$JavaScript$texts_getSubstringIndex("sequence",c,"at2")+" + 1;","  return sequence.slice(start, end);","}"])+"("+e+("FROM_END"===b||"FROM_START"===b?", "+d:"")+("FROM_END"===c||"FROM_START"===c?", "+a:"")+")"}return[e,$.Blockly.JavaScript.ORDER_FUNCTION_CALL]},$.Blockly.JavaScript.text_changeCase=function(a){var b={UPPERCASE:".toUpperCase()",LOWERCASE:".toLowerCase()",TITLECASE:null}[a.getFieldValue("CASE")];return a=$.Blockly.JavaScript.valueToCode(a,"TEXT",b?$.Blockly.JavaScript.ORDER_MEMBER:$.Blockly.JavaScript.ORDER_NONE)||"''",[b?a+b:$.Blockly.JavaScript.provideFunction_("textToTitleCase",["function "+$.Blockly.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(str) {","  return str.replace(/\\S+/g,","      function(txt) {return txt[0].toUpperCase() + txt.substring(1).toLowerCase();});","}"])+"("+a+")",$.Blockly.JavaScript.ORDER_FUNCTION_CALL]},$.Blockly.JavaScript.text_trim=function(a){var b={LEFT:".replace(/^[\\s\\xa0]+/, '')",RIGHT:".replace(/[\\s\\xa0]+$/, '')",BOTH:".trim()"}[a.getFieldValue("MODE")];return[($.Blockly.JavaScript.valueToCode(a,"TEXT",$.Blockly.JavaScript.ORDER_MEMBER)||"''")+b,$.Blockly.JavaScript.ORDER_FUNCTION_CALL]},$.Blockly.JavaScript.text_print=function(a){return"window.alert("+($.Blockly.JavaScript.valueToCode(a,"TEXT",$.Blockly.JavaScript.ORDER_NONE)||"''")+");\n"},$.Blockly.JavaScript.text_prompt_ext=function(a){var b="window.prompt("+(a.getField("TEXT")?$.Blockly.JavaScript.quote_(a.getFieldValue("TEXT")):$.Blockly.JavaScript.valueToCode(a,"TEXT",$.Blockly.JavaScript.ORDER_NONE)||"''")+")";return"NUMBER"===a.getFieldValue("TYPE")&&(b="Number("+b+")"),[b,$.Blockly.JavaScript.ORDER_FUNCTION_CALL]},$.Blockly.JavaScript.text_prompt=$.Blockly.JavaScript.text_prompt_ext,$.Blockly.JavaScript.text_count=function(a){var b=$.Blockly.JavaScript.valueToCode(a,"TEXT",$.Blockly.JavaScript.ORDER_NONE)||"''";return a=$.Blockly.JavaScript.valueToCode(a,"SUB",$.Blockly.JavaScript.ORDER_NONE)||"''",[$.Blockly.JavaScript.provideFunction_("textCount",["function "+$.Blockly.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(haystack, needle) {","  if (needle.length === 0) {","    return haystack.length + 1;","  } else {","    return haystack.split(needle).length - 1;","  }","}"])+"("+b+", "+a+")",$.Blockly.JavaScript.ORDER_FUNCTION_CALL]},$.Blockly.JavaScript.text_replace=function(a){var b=$.Blockly.JavaScript.valueToCode(a,"TEXT",$.Blockly.JavaScript.ORDER_NONE)||"''",c=$.Blockly.JavaScript.valueToCode(a,"FROM",$.Blockly.JavaScript.ORDER_NONE)||"''";return a=$.Blockly.JavaScript.valueToCode(a,"TO",$.Blockly.JavaScript.ORDER_NONE)||"''",[$.Blockly.JavaScript.provideFunction_("textReplace",["function "+$.Blockly.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(haystack, needle, replacement) {",'  needle = needle.replace(/([-()\\[\\]{}+?*.$\\^|,:#<!\\\\])/g,"\\\\$1")','                 .replace(/\\x08/g,"\\\\x08");',"  return haystack.replace(new RegExp(needle, 'g'), replacement);","}"])+"("+b+", "+c+", "+a+")",$.Blockly.JavaScript.ORDER_FUNCTION_CALL]},$.Blockly.JavaScript.text_reverse=function(a){return[($.Blockly.JavaScript.valueToCode(a,"TEXT",$.Blockly.JavaScript.ORDER_MEMBER)||"''")+".split('').reverse().join('')",$.Blockly.JavaScript.ORDER_FUNCTION_CALL]},$.Blockly.JavaScript.procedures_defreturn=function(a){var b=$.Blockly.JavaScript.nameDB_.getName(a.getFieldValue("NAME"),$.module$exports$Blockly$Names.NameType.PROCEDURE),c="";$.Blockly.JavaScript.STATEMENT_PREFIX&&(c+=$.Blockly.JavaScript.injectId($.Blockly.JavaScript.STATEMENT_PREFIX,a)),$.Blockly.JavaScript.STATEMENT_SUFFIX&&(c+=$.Blockly.JavaScript.injectId($.Blockly.JavaScript.STATEMENT_SUFFIX,a)),c&&(c=$.Blockly.JavaScript.prefixLines(c,$.Blockly.JavaScript.INDENT));var d="";$.Blockly.JavaScript.INFINITE_LOOP_TRAP&&(d=$.Blockly.JavaScript.prefixLines($.Blockly.JavaScript.injectId($.Blockly.JavaScript.INFINITE_LOOP_TRAP,a),$.Blockly.JavaScript.INDENT));var e=$.Blockly.JavaScript.statementToCode(a,"STACK"),f=$.Blockly.JavaScript.valueToCode(a,"RETURN",$.Blockly.JavaScript.ORDER_NONE)||"",g="";e&&f&&(g=c),f&&(f=$.Blockly.JavaScript.INDENT+"return "+f+";\n");for(var h=[],k=a.getVars(),l=0;l<k.length;l++)h[l]=$.Blockly.JavaScript.nameDB_.getName(k[l],$.module$exports$Blockly$Names.NameType.VARIABLE);return c="function "+b+"("+h.join(", ")+") {\n"+c+d+e+g+f+"}",c=$.Blockly.JavaScript.scrub_(a,c),$.Blockly.JavaScript.definitions_["%"+b]=c,null},$.Blockly.JavaScript.procedures_defnoreturn=$.Blockly.JavaScript.procedures_defreturn,$.Blockly.JavaScript.procedures_callreturn=function(a){for(var b=$.Blockly.JavaScript.nameDB_.getName(a.getFieldValue("NAME"),$.module$exports$Blockly$Names.NameType.PROCEDURE),c=[],d=a.getVars(),e=0;e<d.length;e++)c[e]=$.Blockly.JavaScript.valueToCode(a,"ARG"+e,$.Blockly.JavaScript.ORDER_NONE)||"null";return[b+"("+c.join(", ")+")",$.Blockly.JavaScript.ORDER_FUNCTION_CALL]},$.Blockly.JavaScript.procedures_callnoreturn=function(a){return $.Blockly.JavaScript.procedures_callreturn(a)[0]+";\n"},$.Blockly.JavaScript.procedures_ifreturn=function(a){var b="if ("+($.Blockly.JavaScript.valueToCode(a,"CONDITION",$.Blockly.JavaScript.ORDER_NONE)||"false")+") {\n";return $.Blockly.JavaScript.STATEMENT_SUFFIX&&(b+=$.Blockly.JavaScript.prefixLines($.Blockly.JavaScript.injectId($.Blockly.JavaScript.STATEMENT_SUFFIX,a),$.Blockly.JavaScript.INDENT)),a.hasReturnValue_?(a=$.Blockly.JavaScript.valueToCode(a,"VALUE",$.Blockly.JavaScript.ORDER_NONE)||"null",b+=$.Blockly.JavaScript.INDENT+"return "+a+";\n"):b+=$.Blockly.JavaScript.INDENT+"return;\n",b+"}\n"},$.Blockly.JavaScript.math_number=function(a){return[a=Number(a.getFieldValue("NUM")),0<=a?$.Blockly.JavaScript.ORDER_ATOMIC:$.Blockly.JavaScript.ORDER_UNARY_NEGATION]},$.Blockly.JavaScript.math_arithmetic=function(a){var b={ADD:[" + ",$.Blockly.JavaScript.ORDER_ADDITION],MINUS:[" - ",$.Blockly.JavaScript.ORDER_SUBTRACTION],MULTIPLY:[" * ",$.Blockly.JavaScript.ORDER_MULTIPLICATION],DIVIDE:[" / ",$.Blockly.JavaScript.ORDER_DIVISION],POWER:[null,$.Blockly.JavaScript.ORDER_NONE]}[a.getFieldValue("OP")],c=b[0];b=b[1];var d=$.Blockly.JavaScript.valueToCode(a,"A",b)||"0";return a=$.Blockly.JavaScript.valueToCode(a,"B",b)||"0",c?[d+c+a,b]:["Math.pow("+d+", "+a+")",$.Blockly.JavaScript.ORDER_FUNCTION_CALL]},$.Blockly.JavaScript.math_single=function(a){var b=a.getFieldValue("OP");if("NEG"===b)return"-"===(a=$.Blockly.JavaScript.valueToCode(a,"NUM",$.Blockly.JavaScript.ORDER_UNARY_NEGATION)||"0")[0]&&(a=" "+a),["-"+a,$.Blockly.JavaScript.ORDER_UNARY_NEGATION];switch(a="SIN"===b||"COS"===b||"TAN"===b?$.Blockly.JavaScript.valueToCode(a,"NUM",$.Blockly.JavaScript.ORDER_DIVISION)||"0":$.Blockly.JavaScript.valueToCode(a,"NUM",$.Blockly.JavaScript.ORDER_NONE)||"0",b){case"ABS":var c="Math.abs("+a+")";break;case"ROOT":c="Math.sqrt("+a+")";break;case"LN":c="Math.log("+a+")";break;case"EXP":c="Math.exp("+a+")";break;case"POW10":c="Math.pow(10,"+a+")";break;case"ROUND":c="Math.round("+a+")";break;case"ROUNDUP":c="Math.ceil("+a+")";break;case"ROUNDDOWN":c="Math.floor("+a+")";break;case"SIN":c="Math.sin("+a+" / 180 * Math.PI)";break;case"COS":c="Math.cos("+a+" / 180 * Math.PI)";break;case"TAN":c="Math.tan("+a+" / 180 * Math.PI)"}if(c)return[c,$.Blockly.JavaScript.ORDER_FUNCTION_CALL];switch(b){case"LOG10":c="Math.log("+a+") / Math.log(10)";break;case"ASIN":c="Math.asin("+a+") / Math.PI * 180";break;case"ACOS":c="Math.acos("+a+") / Math.PI * 180";break;case"ATAN":c="Math.atan("+a+") / Math.PI * 180";break;default:throw Error("Unknown math operator: "+b)}return[c,$.Blockly.JavaScript.ORDER_DIVISION]},$.Blockly.JavaScript.math_constant=function(a){return{PI:["Math.PI",$.Blockly.JavaScript.ORDER_MEMBER],E:["Math.E",$.Blockly.JavaScript.ORDER_MEMBER],GOLDEN_RATIO:["(1 + Math.sqrt(5)) / 2",$.Blockly.JavaScript.ORDER_DIVISION],SQRT2:["Math.SQRT2",$.Blockly.JavaScript.ORDER_MEMBER],SQRT1_2:["Math.SQRT1_2",$.Blockly.JavaScript.ORDER_MEMBER],INFINITY:["Infinity",$.Blockly.JavaScript.ORDER_ATOMIC]}[a.getFieldValue("CONSTANT")]},$.Blockly.JavaScript.math_number_property=function(a){var b=$.Blockly.JavaScript.valueToCode(a,"NUMBER_TO_CHECK",$.Blockly.JavaScript.ORDER_MODULUS)||"0",c=a.getFieldValue("PROPERTY");if("PRIME"===c)return[$.Blockly.JavaScript.provideFunction_("mathIsPrime",["function "+$.Blockly.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(n) {","  // https://en.wikipedia.org/wiki/Primality_test#Naive_methods","  if (n == 2 || n == 3) {","    return true;","  }","  // False if n is NaN, negative, is 1, or not whole.","  // And false if n is divisible by 2 or 3.","  if (isNaN(n) || n <= 1 || n % 1 !== 0 || n % 2 === 0 || n % 3 === 0) {","    return false;","  }","  // Check all the numbers of form 6k +/- 1, up to sqrt(n).","  for (var x = 6; x <= Math.sqrt(n) + 1; x += 6) {","    if (n % (x - 1) === 0 || n % (x + 1) === 0) {","      return false;","    }","  }","  return true;","}"])+"("+b+")",$.Blockly.JavaScript.ORDER_FUNCTION_CALL];switch(c){case"EVEN":var d=b+" % 2 === 0";break;case"ODD":d=b+" % 2 === 1";break;case"WHOLE":d=b+" % 1 === 0";break;case"POSITIVE":d=b+" > 0";break;case"NEGATIVE":d=b+" < 0";break;case"DIVISIBLE_BY":d=b+" % "+(a=$.Blockly.JavaScript.valueToCode(a,"DIVISOR",$.Blockly.JavaScript.ORDER_MODULUS)||"0")+" === 0"}return[d,$.Blockly.JavaScript.ORDER_EQUALITY]},$.Blockly.JavaScript.math_change=function(a){var b=$.Blockly.JavaScript.valueToCode(a,"DELTA",$.Blockly.JavaScript.ORDER_ADDITION)||"0";return(a=$.Blockly.JavaScript.nameDB_.getName(a.getFieldValue("VAR"),$.module$exports$Blockly$Names.NameType.VARIABLE))+" = (typeof "+a+" === 'number' ? "+a+" : 0) + "+b+";\n"},$.Blockly.JavaScript.math_round=$.Blockly.JavaScript.math_single,$.Blockly.JavaScript.math_trig=$.Blockly.JavaScript.math_single,$.Blockly.JavaScript.math_on_list=function(a){var b=a.getFieldValue("OP");switch(b){case"SUM":a=$.Blockly.JavaScript.valueToCode(a,"LIST",$.Blockly.JavaScript.ORDER_MEMBER)||"[]",a+=".reduce(function(x, y) {return x + y;})";break;case"MIN":a="Math.min.apply(null, "+(a=$.Blockly.JavaScript.valueToCode(a,"LIST",$.Blockly.JavaScript.ORDER_NONE)||"[]")+")";break;case"MAX":a="Math.max.apply(null, "+(a=$.Blockly.JavaScript.valueToCode(a,"LIST",$.Blockly.JavaScript.ORDER_NONE)||"[]")+")";break;case"AVERAGE":a=(b=$.Blockly.JavaScript.provideFunction_("mathMean",["function "+$.Blockly.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(myList) {","  return myList.reduce(function(x, y) {return x + y;}) / myList.length;","}"]))+"("+(a=$.Blockly.JavaScript.valueToCode(a,"LIST",$.Blockly.JavaScript.ORDER_NONE)||"[]")+")";break;case"MEDIAN":a=(b=$.Blockly.JavaScript.provideFunction_("mathMedian",["function "+$.Blockly.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(myList) {","  var localList = myList.filter(function (x) {return typeof x === 'number';});","  if (!localList.length) return null;","  localList.sort(function(a, b) {return b - a;});","  if (localList.length % 2 === 0) {","    return (localList[localList.length / 2 - 1] + localList[localList.length / 2]) / 2;","  } else {","    return localList[(localList.length - 1) / 2];","  }","}"]))+"("+(a=$.Blockly.JavaScript.valueToCode(a,"LIST",$.Blockly.JavaScript.ORDER_NONE)||"[]")+")";break;case"MODE":a=(b=$.Blockly.JavaScript.provideFunction_("mathModes",["function "+$.Blockly.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(values) {","  var modes = [];","  var counts = [];","  var maxCount = 0;","  for (var i = 0; i < values.length; i++) {","    var value = values[i];","    var found = false;","    var thisCount;","    for (var j = 0; j < counts.length; j++) {","      if (counts[j][0] === value) {","        thisCount = ++counts[j][1];","        found = true;","        break;","      }","    }","    if (!found) {","      counts.push([value, 1]);","      thisCount = 1;","    }","    maxCount = Math.max(thisCount, maxCount);","  }","  for (var j = 0; j < counts.length; j++) {","    if (counts[j][1] === maxCount) {","        modes.push(counts[j][0]);","    }","  }","  return modes;","}"]))+"("+(a=$.Blockly.JavaScript.valueToCode(a,"LIST",$.Blockly.JavaScript.ORDER_NONE)||"[]")+")";break;case"STD_DEV":a=(b=$.Blockly.JavaScript.provideFunction_("mathStandardDeviation",["function "+$.Blockly.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(numbers) {","  var n = numbers.length;","  if (!n) return null;","  var mean = numbers.reduce(function(x, y) {return x + y;}) / n;","  var variance = 0;","  for (var j = 0; j < n; j++) {","    variance += Math.pow(numbers[j] - mean, 2);","  }","  variance = variance / n;","  return Math.sqrt(variance);","}"]))+"("+(a=$.Blockly.JavaScript.valueToCode(a,"LIST",$.Blockly.JavaScript.ORDER_NONE)||"[]")+")";break;case"RANDOM":a=(b=$.Blockly.JavaScript.provideFunction_("mathRandomList",["function "+$.Blockly.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(list) {","  var x = Math.floor(Math.random() * list.length);","  return list[x];","}"]))+"("+(a=$.Blockly.JavaScript.valueToCode(a,"LIST",$.Blockly.JavaScript.ORDER_NONE)||"[]")+")";break;default:throw Error("Unknown operator: "+b)}return[a,$.Blockly.JavaScript.ORDER_FUNCTION_CALL]},$.Blockly.JavaScript.math_modulo=function(a){return[($.Blockly.JavaScript.valueToCode(a,"DIVIDEND",$.Blockly.JavaScript.ORDER_MODULUS)||"0")+" % "+(a=$.Blockly.JavaScript.valueToCode(a,"DIVISOR",$.Blockly.JavaScript.ORDER_MODULUS)||"0"),$.Blockly.JavaScript.ORDER_MODULUS]},$.Blockly.JavaScript.math_constrain=function(a){return["Math.min(Math.max("+($.Blockly.JavaScript.valueToCode(a,"VALUE",$.Blockly.JavaScript.ORDER_NONE)||"0")+", "+($.Blockly.JavaScript.valueToCode(a,"LOW",$.Blockly.JavaScript.ORDER_NONE)||"0")+"), "+(a=$.Blockly.JavaScript.valueToCode(a,"HIGH",$.Blockly.JavaScript.ORDER_NONE)||"Infinity")+")",$.Blockly.JavaScript.ORDER_FUNCTION_CALL]},$.Blockly.JavaScript.math_random_int=function(a){var b=$.Blockly.JavaScript.valueToCode(a,"FROM",$.Blockly.JavaScript.ORDER_NONE)||"0";return a=$.Blockly.JavaScript.valueToCode(a,"TO",$.Blockly.JavaScript.ORDER_NONE)||"0",[$.Blockly.JavaScript.provideFunction_("mathRandomInt",["function "+$.Blockly.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(a, b) {","  if (a > b) {","    // Swap a and b to ensure a is smaller.","    var c = a;","    a = b;","    b = c;","  }","  return Math.floor(Math.random() * (b - a + 1) + a);","}"])+"("+b+", "+a+")",$.Blockly.JavaScript.ORDER_FUNCTION_CALL]},$.Blockly.JavaScript.math_random_float=function(a){return["Math.random()",$.Blockly.JavaScript.ORDER_FUNCTION_CALL]},$.Blockly.JavaScript.math_atan2=function(a){var b=$.Blockly.JavaScript.valueToCode(a,"X",$.Blockly.JavaScript.ORDER_NONE)||"0";return["Math.atan2("+($.Blockly.JavaScript.valueToCode(a,"Y",$.Blockly.JavaScript.ORDER_NONE)||"0")+", "+b+") / Math.PI * 180",$.Blockly.JavaScript.ORDER_DIVISION]},$.Blockly.JavaScript.controls_repeat_ext=function(a){var b=a.getField("TIMES")?String(Number(a.getFieldValue("TIMES"))):$.Blockly.JavaScript.valueToCode(a,"TIMES",$.Blockly.JavaScript.ORDER_ASSIGNMENT)||"0",c=$.Blockly.JavaScript.statementToCode(a,"DO");c=$.Blockly.JavaScript.addLoopTrap(c,a),a="";var d=$.Blockly.JavaScript.nameDB_.getDistinctName("count",$.module$exports$Blockly$Names.NameType.VARIABLE),e=b;return b.match(/^\w+$/)||(0,$.module$exports$Blockly$utils$string.isNumber)(b)||(a+="var "+(e=$.Blockly.JavaScript.nameDB_.getDistinctName("repeat_end",$.module$exports$Blockly$Names.NameType.VARIABLE))+" = "+b+";\n"),a+"for (var "+d+" = 0; "+d+" < "+e+"; "+d+"++) {\n"+c+"}\n"},$.Blockly.JavaScript.controls_repeat=$.Blockly.JavaScript.controls_repeat_ext,$.Blockly.JavaScript.controls_whileUntil=function(a){var b="UNTIL"===a.getFieldValue("MODE"),c=$.Blockly.JavaScript.valueToCode(a,"BOOL",b?$.Blockly.JavaScript.ORDER_LOGICAL_NOT:$.Blockly.JavaScript.ORDER_NONE)||"false",d=$.Blockly.JavaScript.statementToCode(a,"DO");return b&&(c="!"+c),"while ("+c+") {\n"+(d=$.Blockly.JavaScript.addLoopTrap(d,a))+"}\n"},$.Blockly.JavaScript.controls_for=function(a){var b=$.Blockly.JavaScript.nameDB_.getName(a.getFieldValue("VAR"),$.module$exports$Blockly$Names.NameType.VARIABLE),c=$.Blockly.JavaScript.valueToCode(a,"FROM",$.Blockly.JavaScript.ORDER_ASSIGNMENT)||"0",d=$.Blockly.JavaScript.valueToCode(a,"TO",$.Blockly.JavaScript.ORDER_ASSIGNMENT)||"0",e=$.Blockly.JavaScript.valueToCode(a,"BY",$.Blockly.JavaScript.ORDER_ASSIGNMENT)||"1",f=$.Blockly.JavaScript.statementToCode(a,"DO");if(f=$.Blockly.JavaScript.addLoopTrap(f,a),(0,$.module$exports$Blockly$utils$string.isNumber)(c)&&(0,$.module$exports$Blockly$utils$string.isNumber)(d)&&(0,$.module$exports$Blockly$utils$string.isNumber)(e)){var g=Number(c)<=Number(d);a="for ("+b+" = "+c+"; "+b+(g?" <= ":" >= ")+d+"; "+b,a=(1===(b=Math.abs(Number(e)))?a+(g?"++":"--"):a+(g?" += ":" -= ")+b)+") {\n"+f+"}\n"}else a="",g=c,c.match(/^\w+$/)||(0,$.module$exports$Blockly$utils$string.isNumber)(c)||(a+="var "+(g=$.Blockly.JavaScript.nameDB_.getDistinctName(b+"_start",$.module$exports$Blockly$Names.NameType.VARIABLE))+" = "+c+";\n"),c=d,d.match(/^\w+$/)||(0,$.module$exports$Blockly$utils$string.isNumber)(d)||(a+="var "+(c=$.Blockly.JavaScript.nameDB_.getDistinctName(b+"_end",$.module$exports$Blockly$Names.NameType.VARIABLE))+" = "+d+";\n"),a+="var "+(d=$.Blockly.JavaScript.nameDB_.getDistinctName(b+"_inc",$.module$exports$Blockly$Names.NameType.VARIABLE))+" = ",a=(a=(0,$.module$exports$Blockly$utils$string.isNumber)(e)?a+(Math.abs(e)+";\n"):a+"Math.abs("+e+");\n")+"if ("+g+" > "+c+") {\n"+($.Blockly.JavaScript.INDENT+d)+" = -"+d+";\n",a+="}\n",a+="for ("+b+" = "+g+"; "+d+" >= 0 ? "+b+" <= "+c+" : "+b+" >= "+c+"; "+b+" += "+d+") {\n"+f+"}\n";return a},$.Blockly.JavaScript.controls_forEach=function(a){var b=$.Blockly.JavaScript.nameDB_.getName(a.getFieldValue("VAR"),$.module$exports$Blockly$Names.NameType.VARIABLE),c=$.Blockly.JavaScript.valueToCode(a,"LIST",$.Blockly.JavaScript.ORDER_ASSIGNMENT)||"[]",d=$.Blockly.JavaScript.statementToCode(a,"DO");d=$.Blockly.JavaScript.addLoopTrap(d,a),a="";var e=c;return c.match(/^\w+$/)||(a+="var "+(e=$.Blockly.JavaScript.nameDB_.getDistinctName(b+"_list",$.module$exports$Blockly$Names.NameType.VARIABLE))+" = "+c+";\n"),a+"for (var "+(c=$.Blockly.JavaScript.nameDB_.getDistinctName(b+"_index",$.module$exports$Blockly$Names.NameType.VARIABLE))+" in "+e+") {\n"+(d=$.Blockly.JavaScript.INDENT+b+" = "+e+"["+c+"];\n"+d)+"}\n"},$.Blockly.JavaScript.controls_flow_statements=function(a){var b="";if($.Blockly.JavaScript.STATEMENT_PREFIX&&(b+=$.Blockly.JavaScript.injectId($.Blockly.JavaScript.STATEMENT_PREFIX,a)),$.Blockly.JavaScript.STATEMENT_SUFFIX&&(b+=$.Blockly.JavaScript.injectId($.Blockly.JavaScript.STATEMENT_SUFFIX,a)),$.Blockly.JavaScript.STATEMENT_PREFIX){var c=a.getSurroundLoop();c&&!c.suppressPrefixSuffix&&(b+=$.Blockly.JavaScript.injectId($.Blockly.JavaScript.STATEMENT_PREFIX,c))}switch(a.getFieldValue("FLOW")){case"BREAK":return b+"break;\n";case"CONTINUE":return b+"continue;\n"}throw Error("Unknown flow statement.")},$.Blockly.JavaScript.controls_if=function(a){var b=0,c="";$.Blockly.JavaScript.STATEMENT_PREFIX&&(c+=$.Blockly.JavaScript.injectId($.Blockly.JavaScript.STATEMENT_PREFIX,a));do{var d=$.Blockly.JavaScript.valueToCode(a,"IF"+b,$.Blockly.JavaScript.ORDER_NONE)||"false",e=$.Blockly.JavaScript.statementToCode(a,"DO"+b);$.Blockly.JavaScript.STATEMENT_SUFFIX&&(e=$.Blockly.JavaScript.prefixLines($.Blockly.JavaScript.injectId($.Blockly.JavaScript.STATEMENT_SUFFIX,a),$.Blockly.JavaScript.INDENT)+e),c+=(0<b?" else ":"")+"if ("+d+") {\n"+e+"}",b++}while(a.getInput("IF"+b));return(a.getInput("ELSE")||$.Blockly.JavaScript.STATEMENT_SUFFIX)&&(b=$.Blockly.JavaScript.statementToCode(a,"ELSE"),$.Blockly.JavaScript.STATEMENT_SUFFIX&&(b=$.Blockly.JavaScript.prefixLines($.Blockly.JavaScript.injectId($.Blockly.JavaScript.STATEMENT_SUFFIX,a),$.Blockly.JavaScript.INDENT)+b),c+=" else {\n"+b+"}"),c+"\n"},$.Blockly.JavaScript.controls_ifelse=$.Blockly.JavaScript.controls_if,$.Blockly.JavaScript.logic_compare=function(a){var b={EQ:"==",NEQ:"!=",LT:"<",LTE:"<=",GT:">",GTE:">="}[a.getFieldValue("OP")],c="=="===b||"!="===b?$.Blockly.JavaScript.ORDER_EQUALITY:$.Blockly.JavaScript.ORDER_RELATIONAL;return[($.Blockly.JavaScript.valueToCode(a,"A",c)||"0")+" "+b+" "+(a=$.Blockly.JavaScript.valueToCode(a,"B",c)||"0"),c]},$.Blockly.JavaScript.logic_operation=function(a){var b="AND"===a.getFieldValue("OP")?"&&":"||",c="&&"===b?$.Blockly.JavaScript.ORDER_LOGICAL_AND:$.Blockly.JavaScript.ORDER_LOGICAL_OR,d=$.Blockly.JavaScript.valueToCode(a,"A",c);if(a=$.Blockly.JavaScript.valueToCode(a,"B",c),d||a){var e="&&"===b?"true":"false";d||(d=e),a||(a=e)}else a=d="false";return[d+" "+b+" "+a,c]},$.Blockly.JavaScript.logic_negate=function(a){var b=$.Blockly.JavaScript.ORDER_LOGICAL_NOT;return["!"+($.Blockly.JavaScript.valueToCode(a,"BOOL",b)||"true"),b]},$.Blockly.JavaScript.logic_boolean=function(a){return["TRUE"===a.getFieldValue("BOOL")?"true":"false",$.Blockly.JavaScript.ORDER_ATOMIC]},$.Blockly.JavaScript.logic_null=function(a){return["null",$.Blockly.JavaScript.ORDER_ATOMIC]},$.Blockly.JavaScript.logic_ternary=function(a){return[($.Blockly.JavaScript.valueToCode(a,"IF",$.Blockly.JavaScript.ORDER_CONDITIONAL)||"false")+" ? "+($.Blockly.JavaScript.valueToCode(a,"THEN",$.Blockly.JavaScript.ORDER_CONDITIONAL)||"null")+" : "+(a=$.Blockly.JavaScript.valueToCode(a,"ELSE",$.Blockly.JavaScript.ORDER_CONDITIONAL)||"null"),$.Blockly.JavaScript.ORDER_CONDITIONAL]},$.Blockly.JavaScript.lists_create_empty=function(a){return["[]",$.Blockly.JavaScript.ORDER_ATOMIC]},$.Blockly.JavaScript.lists_create_with=function(a){for(var b=Array(a.itemCount_),c=0;c<a.itemCount_;c++)b[c]=$.Blockly.JavaScript.valueToCode(a,"ADD"+c,$.Blockly.JavaScript.ORDER_NONE)||"null";return["["+b.join(", ")+"]",$.Blockly.JavaScript.ORDER_ATOMIC]},$.Blockly.JavaScript.lists_repeat=function(a){return[$.Blockly.JavaScript.provideFunction_("listsRepeat",["function "+$.Blockly.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(value, n) {","  var array = [];","  for (var i = 0; i < n; i++) {","    array[i] = value;","  }","  return array;","}"])+"("+($.Blockly.JavaScript.valueToCode(a,"ITEM",$.Blockly.JavaScript.ORDER_NONE)||"null")+", "+(a=$.Blockly.JavaScript.valueToCode(a,"NUM",$.Blockly.JavaScript.ORDER_NONE)||"0")+")",$.Blockly.JavaScript.ORDER_FUNCTION_CALL]},$.Blockly.JavaScript.lists_length=function(a){return[($.Blockly.JavaScript.valueToCode(a,"VALUE",$.Blockly.JavaScript.ORDER_MEMBER)||"[]")+".length",$.Blockly.JavaScript.ORDER_MEMBER]},$.Blockly.JavaScript.lists_isEmpty=function(a){return["!"+($.Blockly.JavaScript.valueToCode(a,"VALUE",$.Blockly.JavaScript.ORDER_MEMBER)||"[]")+".length",$.Blockly.JavaScript.ORDER_LOGICAL_NOT]},$.Blockly.JavaScript.lists_indexOf=function(a){var b="FIRST"===a.getFieldValue("END")?"indexOf":"lastIndexOf",c=$.Blockly.JavaScript.valueToCode(a,"FIND",$.Blockly.JavaScript.ORDER_NONE)||"''";return b=($.Blockly.JavaScript.valueToCode(a,"VALUE",$.Blockly.JavaScript.ORDER_MEMBER)||"[]")+"."+b+"("+c+")",a.workspace.options.oneBasedIndex?[b+" + 1",$.Blockly.JavaScript.ORDER_ADDITION]:[b,$.Blockly.JavaScript.ORDER_FUNCTION_CALL]},$.Blockly.JavaScript.lists_getIndex=function(a){var b=a.getFieldValue("MODE")||"GET",c=a.getFieldValue("WHERE")||"FROM_START",d=$.Blockly.JavaScript.valueToCode(a,"VALUE","RANDOM"===c?$.Blockly.JavaScript.ORDER_NONE:$.Blockly.JavaScript.ORDER_MEMBER)||"[]";switch(c){case"FIRST":if("GET"===b)return[d+"[0]",$.Blockly.JavaScript.ORDER_MEMBER];if("GET_REMOVE"===b)return[d+".shift()",$.Blockly.JavaScript.ORDER_MEMBER];if("REMOVE"===b)return d+".shift();\n";break;case"LAST":if("GET"===b)return[d+".slice(-1)[0]",$.Blockly.JavaScript.ORDER_MEMBER];if("GET_REMOVE"===b)return[d+".pop()",$.Blockly.JavaScript.ORDER_MEMBER];if("REMOVE"===b)return d+".pop();\n";break;case"FROM_START":if(a=$.Blockly.JavaScript.getAdjusted(a,"AT"),"GET"===b)return[d+"["+a+"]",$.Blockly.JavaScript.ORDER_MEMBER];if("GET_REMOVE"===b)return[d+".splice("+a+", 1)[0]",$.Blockly.JavaScript.ORDER_FUNCTION_CALL];if("REMOVE"===b)return d+".splice("+a+", 1);\n";break;case"FROM_END":if(a=$.Blockly.JavaScript.getAdjusted(a,"AT",1,!0),"GET"===b)return[d+".slice("+a+")[0]",$.Blockly.JavaScript.ORDER_FUNCTION_CALL];if("GET_REMOVE"===b)return[d+".splice("+a+", 1)[0]",$.Blockly.JavaScript.ORDER_FUNCTION_CALL];if("REMOVE"===b)return d+".splice("+a+", 1);";break;case"RANDOM":if(d=$.Blockly.JavaScript.provideFunction_("listsGetRandomItem",["function "+$.Blockly.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(list, remove) {","  var x = Math.floor(Math.random() * list.length);","  if (remove) {","    return list.splice(x, 1)[0];","  } else {","    return list[x];","  }","}"])+"("+d+", "+("GET"!==b)+")","GET"===b||"GET_REMOVE"===b)return[d,$.Blockly.JavaScript.ORDER_FUNCTION_CALL];if("REMOVE"===b)return d+";\n"}throw Error("Unhandled combination (lists_getIndex).")},$.Blockly.JavaScript.lists_setIndex=function(a){function b(){if(c.match(/^\w+$/))return"";var g=$.Blockly.JavaScript.nameDB_.getDistinctName("tmpList",$.module$exports$Blockly$Names.NameType.VARIABLE),h="var "+g+" = "+c+";\n";return c=g,h}var c=$.Blockly.JavaScript.valueToCode(a,"LIST",$.Blockly.JavaScript.ORDER_MEMBER)||"[]",d=a.getFieldValue("MODE")||"GET",e=a.getFieldValue("WHERE")||"FROM_START",f=$.Blockly.JavaScript.valueToCode(a,"TO",$.Blockly.JavaScript.ORDER_ASSIGNMENT)||"null";switch(e){case"FIRST":if("SET"===d)return c+"[0] = "+f+";\n";if("INSERT"===d)return c+".unshift("+f+");\n";break;case"LAST":if("SET"===d)return b()+(c+"[")+c+".length - 1] = "+f+";\n";if("INSERT"===d)return c+".push("+f+");\n";break;case"FROM_START":if(a=$.Blockly.JavaScript.getAdjusted(a,"AT"),"SET"===d)return c+"["+a+"] = "+f+";\n";if("INSERT"===d)return c+".splice("+a+", 0, "+f+");\n";break;case"FROM_END":if(a=$.Blockly.JavaScript.getAdjusted(a,"AT",1,!1,$.Blockly.JavaScript.ORDER_SUBTRACTION),e=b(),"SET"===d)return e+(c+"[")+c+".length - "+a+"] = "+f+";\n";if("INSERT"===d)return e+(c+".splice(")+c+".length - "+a+", 0, "+f+");\n";break;case"RANDOM":if(a=b(),a+="var "+(e=$.Blockly.JavaScript.nameDB_.getDistinctName("tmpX",$.module$exports$Blockly$Names.NameType.VARIABLE))+" = Math.floor(Math.random() * "+c+".length);\n","SET"===d)return a+(c+"[")+e+"] = "+f+";\n";if("INSERT"===d)return a+(c+".splice(")+e+", 0, "+f+");\n"}throw Error("Unhandled combination (lists_setIndex).")};var module$contents$Blockly$JavaScript$lists_getSubstringIndex=function(a,b,c){return"FIRST"===b?"0":"FROM_END"===b?a+".length - 1 - "+c:"LAST"===b?a+".length - 1":c};return $.Blockly.JavaScript.lists_getSublist=function(a){var b=$.Blockly.JavaScript.valueToCode(a,"LIST",$.Blockly.JavaScript.ORDER_MEMBER)||"[]",c=a.getFieldValue("WHERE1"),d=a.getFieldValue("WHERE2");if("FIRST"===c&&"LAST"===d)b+=".slice(0)";else if(b.match(/^\w+$/)||"FROM_END"!==c&&"FROM_START"===d){switch(c){case"FROM_START":c=$.Blockly.JavaScript.getAdjusted(a,"AT1");break;case"FROM_END":c=b+".length - "+(c=$.Blockly.JavaScript.getAdjusted(a,"AT1",1,!1,$.Blockly.JavaScript.ORDER_SUBTRACTION));break;case"FIRST":c="0";break;default:throw Error("Unhandled option (lists_getSublist).")}switch(d){case"FROM_START":d=$.Blockly.JavaScript.getAdjusted(a,"AT2",1);break;case"FROM_END":d=b+".length - "+(d=$.Blockly.JavaScript.getAdjusted(a,"AT2",0,!1,$.Blockly.JavaScript.ORDER_SUBTRACTION));break;case"LAST":d=b+".length";break;default:throw Error("Unhandled option (lists_getSublist).")}b=b+".slice("+c+", "+d+")"}else{var e=$.Blockly.JavaScript.getAdjusted(a,"AT1");a=$.Blockly.JavaScript.getAdjusted(a,"AT2");var f={FIRST:"First",LAST:"Last",FROM_START:"FromStart",FROM_END:"FromEnd"};b=$.Blockly.JavaScript.provideFunction_("subsequence"+f[c]+f[d],["function "+$.Blockly.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(sequence"+("FROM_END"===c||"FROM_START"===c?", at1":"")+("FROM_END"===d||"FROM_START"===d?", at2":"")+") {",module$contents$Blockly$JavaScript$lists_getSubstringIndex("sequence",c,"at1")+";","  var end = "+module$contents$Blockly$JavaScript$lists_getSubstringIndex("sequence",d,"at2")+" + 1;","  return sequence.slice(start, end);","}"])+"("+b+("FROM_END"===c||"FROM_START"===c?", "+e:"")+("FROM_END"===d||"FROM_START"===d?", "+a:"")+")"}return[b,$.Blockly.JavaScript.ORDER_FUNCTION_CALL]},$.Blockly.JavaScript.lists_sort=function(a){var b=$.Blockly.JavaScript.valueToCode(a,"LIST",$.Blockly.JavaScript.ORDER_FUNCTION_CALL)||"[]",c="1"===a.getFieldValue("DIRECTION")?1:-1;return a=a.getFieldValue("TYPE"),[b+".slice().sort("+$.Blockly.JavaScript.provideFunction_("listsGetSortCompare",["function "+$.Blockly.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(type, direction) {","  var compareFuncs = {",'    "NUMERIC": function(a, b) {',"        return Number(a) - Number(b); },",'    "TEXT": function(a, b) {',"        return a.toString() > b.toString() ? 1 : -1; },",'    "IGNORE_CASE": function(a, b) {',"        return a.toString().toLowerCase() > b.toString().toLowerCase() ? 1 : -1; },","  };","  var compare = compareFuncs[type];","  return function(a, b) { return compare(a, b) * direction; }","}"])+'("'+a+'", '+c+"))",$.Blockly.JavaScript.ORDER_FUNCTION_CALL]},$.Blockly.JavaScript.lists_split=function(a){var b=$.Blockly.JavaScript.valueToCode(a,"INPUT",$.Blockly.JavaScript.ORDER_MEMBER),c=$.Blockly.JavaScript.valueToCode(a,"DELIM",$.Blockly.JavaScript.ORDER_NONE)||"''";if("SPLIT"===(a=a.getFieldValue("MODE")))b||(b="''"),a="split";else{if("JOIN"!==a)throw Error("Unknown mode: "+a);b||(b="[]"),a="join"}return[b+"."+a+"("+c+")",$.Blockly.JavaScript.ORDER_FUNCTION_CALL]},$.Blockly.JavaScript.lists_reverse=function(a){return[($.Blockly.JavaScript.valueToCode(a,"LIST",$.Blockly.JavaScript.ORDER_FUNCTION_CALL)||"[]")+".slice().reverse()",$.Blockly.JavaScript.ORDER_FUNCTION_CALL]},$.Blockly.JavaScript.colour_picker=function(a){return[$.Blockly.JavaScript.quote_(a.getFieldValue("COLOUR")),$.Blockly.JavaScript.ORDER_ATOMIC]},$.Blockly.JavaScript.colour_random=function(a){return[$.Blockly.JavaScript.provideFunction_("colourRandom",["function "+$.Blockly.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"() {","  var num = Math.floor(Math.random() * Math.pow(2, 24));","  return '#' + ('00000' + num.toString(16)).substr(-6);","}"])+"()",$.Blockly.JavaScript.ORDER_FUNCTION_CALL]},$.Blockly.JavaScript.colour_rgb=function(a){var b=$.Blockly.JavaScript.valueToCode(a,"RED",$.Blockly.JavaScript.ORDER_NONE)||0,c=$.Blockly.JavaScript.valueToCode(a,"GREEN",$.Blockly.JavaScript.ORDER_NONE)||0;return a=$.Blockly.JavaScript.valueToCode(a,"BLUE",$.Blockly.JavaScript.ORDER_NONE)||0,[$.Blockly.JavaScript.provideFunction_("colourRgb",["function "+$.Blockly.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(r, g, b) {","  r = Math.max(Math.min(Number(r), 100), 0) * 2.55;","  g = Math.max(Math.min(Number(g), 100), 0) * 2.55;","  b = Math.max(Math.min(Number(b), 100), 0) * 2.55;","  r = ('0' + (Math.round(r) || 0).toString(16)).slice(-2);","  g = ('0' + (Math.round(g) || 0).toString(16)).slice(-2);","  b = ('0' + (Math.round(b) || 0).toString(16)).slice(-2);","  return '#' + r + g + b;","}"])+"("+b+", "+c+", "+a+")",$.Blockly.JavaScript.ORDER_FUNCTION_CALL]},$.Blockly.JavaScript.colour_blend=function(a){var b=$.Blockly.JavaScript.valueToCode(a,"COLOUR1",$.Blockly.JavaScript.ORDER_NONE)||"'#000000'",c=$.Blockly.JavaScript.valueToCode(a,"COLOUR2",$.Blockly.JavaScript.ORDER_NONE)||"'#000000'";return a=$.Blockly.JavaScript.valueToCode(a,"RATIO",$.Blockly.JavaScript.ORDER_NONE)||.5,[$.Blockly.JavaScript.provideFunction_("colourBlend",["function "+$.Blockly.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(c1, c2, ratio) {","  ratio = Math.max(Math.min(Number(ratio), 1), 0);","  var r1 = parseInt(c1.substring(1, 3), 16);","  var g1 = parseInt(c1.substring(3, 5), 16);","  var b1 = parseInt(c1.substring(5, 7), 16);","  var r2 = parseInt(c2.substring(1, 3), 16);","  var g2 = parseInt(c2.substring(3, 5), 16);","  var b2 = parseInt(c2.substring(5, 7), 16);","  var r = Math.round(r1 * (1 - ratio) + r2 * ratio);","  var g = Math.round(g1 * (1 - ratio) + g2 * ratio);","  var b = Math.round(b1 * (1 - ratio) + b2 * ratio);","  r = ('0' + (r || 0).toString(16)).slice(-2);","  g = ('0' + (g || 0).toString(16)).slice(-2);","  b = ('0' + (b || 0).toString(16)).slice(-2);","  return '#' + r + g + b;","}"])+"("+b+", "+c+", "+a+")",$.Blockly.JavaScript.ORDER_FUNCTION_CALL]},$.Blockly.JavaScript})?__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__):__WEBPACK_AMD_DEFINE_FACTORY__)||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},9177:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(8256)],void 0===(__WEBPACK_AMD_DEFINE_RESULT__="function"==typeof(__WEBPACK_AMD_DEFINE_FACTORY__=function(Blockly){return(Blockly={Msg:{}}).Msg.ADD_COMMENT="Add Comment",Blockly.Msg.CANNOT_DELETE_VARIABLE_PROCEDURE="Can't delete the variable '%1' because it's part of the definition of the function '%2'",Blockly.Msg.CHANGE_VALUE_TITLE="Change value:",Blockly.Msg.CLEAN_UP="Clean up Blocks",Blockly.Msg.COLLAPSED_WARNINGS_WARNING="Collapsed blocks contain warnings.",Blockly.Msg.COLLAPSE_ALL="Collapse Blocks",Blockly.Msg.COLLAPSE_BLOCK="Collapse Block",Blockly.Msg.COLOUR_BLEND_COLOUR1="colour 1",Blockly.Msg.COLOUR_BLEND_COLOUR2="colour 2",Blockly.Msg.COLOUR_BLEND_HELPURL="https://meyerweb.com/eric/tools/color-blend/#:::rgbp",Blockly.Msg.COLOUR_BLEND_RATIO="ratio",Blockly.Msg.COLOUR_BLEND_TITLE="blend",Blockly.Msg.COLOUR_BLEND_TOOLTIP="Blends two colours together with a given ratio (0.0 - 1.0).",Blockly.Msg.COLOUR_PICKER_HELPURL="https://en.wikipedia.org/wiki/Color",Blockly.Msg.COLOUR_PICKER_TOOLTIP="Choose a colour from the palette.",Blockly.Msg.COLOUR_RANDOM_HELPURL="http://randomcolour.com",Blockly.Msg.COLOUR_RANDOM_TITLE="random colour",Blockly.Msg.COLOUR_RANDOM_TOOLTIP="Choose a colour at random.",Blockly.Msg.COLOUR_RGB_BLUE="blue",Blockly.Msg.COLOUR_RGB_GREEN="green",Blockly.Msg.COLOUR_RGB_HELPURL="https://www.december.com/html/spec/colorpercompact.html",Blockly.Msg.COLOUR_RGB_RED="red",Blockly.Msg.COLOUR_RGB_TITLE="colour with",Blockly.Msg.COLOUR_RGB_TOOLTIP="Create a colour with the specified amount of red, green, and blue. All values must be between 0 and 100.",Blockly.Msg.CONTROLS_FLOW_STATEMENTS_HELPURL="https://github.com/google/blockly/wiki/Loops#loop-termination-blocks",Blockly.Msg.CONTROLS_FLOW_STATEMENTS_OPERATOR_BREAK="break out of loop",Blockly.Msg.CONTROLS_FLOW_STATEMENTS_OPERATOR_CONTINUE="continue with next iteration of loop",Blockly.Msg.CONTROLS_FLOW_STATEMENTS_TOOLTIP_BREAK="Break out of the containing loop.",Blockly.Msg.CONTROLS_FLOW_STATEMENTS_TOOLTIP_CONTINUE="Skip the rest of this loop, and continue with the next iteration.",Blockly.Msg.CONTROLS_FLOW_STATEMENTS_WARNING="Warning: This block may only be used within a loop.",Blockly.Msg.CONTROLS_FOREACH_HELPURL="https://github.com/google/blockly/wiki/Loops#for-each",Blockly.Msg.CONTROLS_FOREACH_TITLE="for each item %1 in list %2",Blockly.Msg.CONTROLS_FOREACH_TOOLTIP="For each item in a list, set the variable '%1' to the item, and then do some statements.",Blockly.Msg.CONTROLS_FOR_HELPURL="https://github.com/google/blockly/wiki/Loops#count-with",Blockly.Msg.CONTROLS_FOR_TITLE="count with %1 from %2 to %3 by %4",Blockly.Msg.CONTROLS_FOR_TOOLTIP="Have the variable '%1' take on the values from the start number to the end number, counting by the specified interval, and do the specified blocks.",Blockly.Msg.CONTROLS_IF_ELSEIF_TOOLTIP="Add a condition to the if block.",Blockly.Msg.CONTROLS_IF_ELSE_TOOLTIP="Add a final, catch-all condition to the if block.",Blockly.Msg.CONTROLS_IF_HELPURL="https://github.com/google/blockly/wiki/IfElse",Blockly.Msg.CONTROLS_IF_IF_TOOLTIP="Add, remove, or reorder sections to reconfigure this if block.",Blockly.Msg.CONTROLS_IF_MSG_ELSE="else",Blockly.Msg.CONTROLS_IF_MSG_ELSEIF="else if",Blockly.Msg.CONTROLS_IF_MSG_IF="if",Blockly.Msg.CONTROLS_IF_TOOLTIP_1="If a value is true, then do some statements.",Blockly.Msg.CONTROLS_IF_TOOLTIP_2="If a value is true, then do the first block of statements. Otherwise, do the second block of statements.",Blockly.Msg.CONTROLS_IF_TOOLTIP_3="If the first value is true, then do the first block of statements. Otherwise, if the second value is true, do the second block of statements.",Blockly.Msg.CONTROLS_IF_TOOLTIP_4="If the first value is true, then do the first block of statements. Otherwise, if the second value is true, do the second block of statements. If none of the values are true, do the last block of statements.",Blockly.Msg.CONTROLS_REPEAT_HELPURL="https://en.wikipedia.org/wiki/For_loop",Blockly.Msg.CONTROLS_REPEAT_INPUT_DO="do",Blockly.Msg.CONTROLS_REPEAT_TITLE="repeat %1 times",Blockly.Msg.CONTROLS_REPEAT_TOOLTIP="Do some statements several times.",Blockly.Msg.CONTROLS_WHILEUNTIL_HELPURL="https://github.com/google/blockly/wiki/Loops#repeat",Blockly.Msg.CONTROLS_WHILEUNTIL_OPERATOR_UNTIL="repeat until",Blockly.Msg.CONTROLS_WHILEUNTIL_OPERATOR_WHILE="repeat while",Blockly.Msg.CONTROLS_WHILEUNTIL_TOOLTIP_UNTIL="While a value is false, then do some statements.",Blockly.Msg.CONTROLS_WHILEUNTIL_TOOLTIP_WHILE="While a value is true, then do some statements.",Blockly.Msg.DELETE_ALL_BLOCKS="Delete all %1 blocks?",Blockly.Msg.DELETE_BLOCK="Delete Block",Blockly.Msg.DELETE_VARIABLE="Delete the '%1' variable",Blockly.Msg.DELETE_VARIABLE_CONFIRMATION="Delete %1 uses of the '%2' variable?",Blockly.Msg.DELETE_X_BLOCKS="Delete %1 Blocks",Blockly.Msg.DIALOG_CANCEL="Cancel",Blockly.Msg.DIALOG_OK="OK",Blockly.Msg.DISABLE_BLOCK="Disable Block",Blockly.Msg.DUPLICATE_BLOCK="Duplicate",Blockly.Msg.DUPLICATE_COMMENT="Duplicate Comment",Blockly.Msg.ENABLE_BLOCK="Enable Block",Blockly.Msg.EXPAND_ALL="Expand Blocks",Blockly.Msg.EXPAND_BLOCK="Expand Block",Blockly.Msg.EXTERNAL_INPUTS="External Inputs",Blockly.Msg.HELP="Help",Blockly.Msg.INLINE_INPUTS="Inline Inputs",Blockly.Msg.LISTS_CREATE_EMPTY_HELPURL="https://github.com/google/blockly/wiki/Lists#create-empty-list",Blockly.Msg.LISTS_CREATE_EMPTY_TITLE="create empty list",Blockly.Msg.LISTS_CREATE_EMPTY_TOOLTIP="Returns a list, of length 0, containing no data records",Blockly.Msg.LISTS_CREATE_WITH_CONTAINER_TITLE_ADD="list",Blockly.Msg.LISTS_CREATE_WITH_CONTAINER_TOOLTIP="Add, remove, or reorder sections to reconfigure this list block.",Blockly.Msg.LISTS_CREATE_WITH_HELPURL="https://github.com/google/blockly/wiki/Lists#create-list-with",Blockly.Msg.LISTS_CREATE_WITH_INPUT_WITH="create list with",Blockly.Msg.LISTS_CREATE_WITH_ITEM_TOOLTIP="Add an item to the list.",Blockly.Msg.LISTS_CREATE_WITH_TOOLTIP="Create a list with any number of items.",Blockly.Msg.LISTS_GET_INDEX_FIRST="first",Blockly.Msg.LISTS_GET_INDEX_FROM_END="# from end",Blockly.Msg.LISTS_GET_INDEX_FROM_START="#",Blockly.Msg.LISTS_GET_INDEX_GET="get",Blockly.Msg.LISTS_GET_INDEX_GET_REMOVE="get and remove",Blockly.Msg.LISTS_GET_INDEX_LAST="last",Blockly.Msg.LISTS_GET_INDEX_RANDOM="random",Blockly.Msg.LISTS_GET_INDEX_REMOVE="remove",Blockly.Msg.LISTS_GET_INDEX_TAIL="",Blockly.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FIRST="Returns the first item in a list.",Blockly.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FROM="Returns the item at the specified position in a list.",Blockly.Msg.LISTS_GET_INDEX_TOOLTIP_GET_LAST="Returns the last item in a list.",Blockly.Msg.LISTS_GET_INDEX_TOOLTIP_GET_RANDOM="Returns a random item in a list.",Blockly.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FIRST="Removes and returns the first item in a list.",Blockly.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FROM="Removes and returns the item at the specified position in a list.",Blockly.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_LAST="Removes and returns the last item in a list.",Blockly.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_RANDOM="Removes and returns a random item in a list.",Blockly.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FIRST="Removes the first item in a list.",Blockly.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FROM="Removes the item at the specified position in a list.",Blockly.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_LAST="Removes the last item in a list.",Blockly.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_RANDOM="Removes a random item in a list.",Blockly.Msg.LISTS_GET_SUBLIST_END_FROM_END="to # from end",Blockly.Msg.LISTS_GET_SUBLIST_END_FROM_START="to #",Blockly.Msg.LISTS_GET_SUBLIST_END_LAST="to last",Blockly.Msg.LISTS_GET_SUBLIST_HELPURL="https://github.com/google/blockly/wiki/Lists#getting-a-sublist",Blockly.Msg.LISTS_GET_SUBLIST_START_FIRST="get sub-list from first",Blockly.Msg.LISTS_GET_SUBLIST_START_FROM_END="get sub-list from # from end",Blockly.Msg.LISTS_GET_SUBLIST_START_FROM_START="get sub-list from #",Blockly.Msg.LISTS_GET_SUBLIST_TAIL="",Blockly.Msg.LISTS_GET_SUBLIST_TOOLTIP="Creates a copy of the specified portion of a list.",Blockly.Msg.LISTS_INDEX_FROM_END_TOOLTIP="%1 is the last item.",Blockly.Msg.LISTS_INDEX_FROM_START_TOOLTIP="%1 is the first item.",Blockly.Msg.LISTS_INDEX_OF_FIRST="find first occurrence of item",Blockly.Msg.LISTS_INDEX_OF_HELPURL="https://github.com/google/blockly/wiki/Lists#getting-items-from-a-list",Blockly.Msg.LISTS_INDEX_OF_LAST="find last occurrence of item",Blockly.Msg.LISTS_INDEX_OF_TOOLTIP="Returns the index of the first/last occurrence of the item in the list. Returns %1 if item is not found.",Blockly.Msg.LISTS_INLIST="in list",Blockly.Msg.LISTS_ISEMPTY_HELPURL="https://github.com/google/blockly/wiki/Lists#is-empty",Blockly.Msg.LISTS_ISEMPTY_TITLE="%1 is empty",Blockly.Msg.LISTS_ISEMPTY_TOOLTIP="Returns true if the list is empty.",Blockly.Msg.LISTS_LENGTH_HELPURL="https://github.com/google/blockly/wiki/Lists#length-of",Blockly.Msg.LISTS_LENGTH_TITLE="length of %1",Blockly.Msg.LISTS_LENGTH_TOOLTIP="Returns the length of a list.",Blockly.Msg.LISTS_REPEAT_HELPURL="https://github.com/google/blockly/wiki/Lists#create-list-with",Blockly.Msg.LISTS_REPEAT_TITLE="create list with item %1 repeated %2 times",Blockly.Msg.LISTS_REPEAT_TOOLTIP="Creates a list consisting of the given value repeated the specified number of times.",Blockly.Msg.LISTS_REVERSE_HELPURL="https://github.com/google/blockly/wiki/Lists#reversing-a-list",Blockly.Msg.LISTS_REVERSE_MESSAGE0="reverse %1",Blockly.Msg.LISTS_REVERSE_TOOLTIP="Reverse a copy of a list.",Blockly.Msg.LISTS_SET_INDEX_HELPURL="https://github.com/google/blockly/wiki/Lists#in-list--set",Blockly.Msg.LISTS_SET_INDEX_INPUT_TO="as",Blockly.Msg.LISTS_SET_INDEX_INSERT="insert at",Blockly.Msg.LISTS_SET_INDEX_SET="set",Blockly.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FIRST="Inserts the item at the start of a list.",Blockly.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FROM="Inserts the item at the specified position in a list.",Blockly.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_LAST="Append the item to the end of a list.",Blockly.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_RANDOM="Inserts the item randomly in a list.",Blockly.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FIRST="Sets the first item in a list.",Blockly.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FROM="Sets the item at the specified position in a list.",Blockly.Msg.LISTS_SET_INDEX_TOOLTIP_SET_LAST="Sets the last item in a list.",Blockly.Msg.LISTS_SET_INDEX_TOOLTIP_SET_RANDOM="Sets a random item in a list.",Blockly.Msg.LISTS_SORT_HELPURL="https://github.com/google/blockly/wiki/Lists#sorting-a-list",Blockly.Msg.LISTS_SORT_ORDER_ASCENDING="ascending",Blockly.Msg.LISTS_SORT_ORDER_DESCENDING="descending",Blockly.Msg.LISTS_SORT_TITLE="sort %1 %2 %3",Blockly.Msg.LISTS_SORT_TOOLTIP="Sort a copy of a list.",Blockly.Msg.LISTS_SORT_TYPE_IGNORECASE="alphabetic, ignore case",Blockly.Msg.LISTS_SORT_TYPE_NUMERIC="numeric",Blockly.Msg.LISTS_SORT_TYPE_TEXT="alphabetic",Blockly.Msg.LISTS_SPLIT_HELPURL="https://github.com/google/blockly/wiki/Lists#splitting-strings-and-joining-lists",Blockly.Msg.LISTS_SPLIT_LIST_FROM_TEXT="make list from text",Blockly.Msg.LISTS_SPLIT_TEXT_FROM_LIST="make text from list",Blockly.Msg.LISTS_SPLIT_TOOLTIP_JOIN="Join a list of texts into one text, separated by a delimiter.",Blockly.Msg.LISTS_SPLIT_TOOLTIP_SPLIT="Split text into a list of texts, breaking at each delimiter.",Blockly.Msg.LISTS_SPLIT_WITH_DELIMITER="with delimiter",Blockly.Msg.LOGIC_BOOLEAN_FALSE="false",Blockly.Msg.LOGIC_BOOLEAN_HELPURL="https://github.com/google/blockly/wiki/Logic#values",Blockly.Msg.LOGIC_BOOLEAN_TOOLTIP="Returns either true or false.",Blockly.Msg.LOGIC_BOOLEAN_TRUE="true",Blockly.Msg.LOGIC_COMPARE_HELPURL="https://en.wikipedia.org/wiki/Inequality_(mathematics)",Blockly.Msg.LOGIC_COMPARE_TOOLTIP_EQ="Return true if both inputs equal each other.",Blockly.Msg.LOGIC_COMPARE_TOOLTIP_GT="Return true if the first input is greater than the second input.",Blockly.Msg.LOGIC_COMPARE_TOOLTIP_GTE="Return true if the first input is greater than or equal to the second input.",Blockly.Msg.LOGIC_COMPARE_TOOLTIP_LT="Return true if the first input is smaller than the second input.",Blockly.Msg.LOGIC_COMPARE_TOOLTIP_LTE="Return true if the first input is smaller than or equal to the second input.",Blockly.Msg.LOGIC_COMPARE_TOOLTIP_NEQ="Return true if both inputs are not equal to each other.",Blockly.Msg.LOGIC_NEGATE_HELPURL="https://github.com/google/blockly/wiki/Logic#not",Blockly.Msg.LOGIC_NEGATE_TITLE="not %1",Blockly.Msg.LOGIC_NEGATE_TOOLTIP="Returns true if the input is false. Returns false if the input is true.",Blockly.Msg.LOGIC_NULL="null",Blockly.Msg.LOGIC_NULL_HELPURL="https://en.wikipedia.org/wiki/Nullable_type",Blockly.Msg.LOGIC_NULL_TOOLTIP="Returns null.",Blockly.Msg.LOGIC_OPERATION_AND="and",Blockly.Msg.LOGIC_OPERATION_HELPURL="https://github.com/google/blockly/wiki/Logic#logical-operations",Blockly.Msg.LOGIC_OPERATION_OR="or",Blockly.Msg.LOGIC_OPERATION_TOOLTIP_AND="Return true if both inputs are true.",Blockly.Msg.LOGIC_OPERATION_TOOLTIP_OR="Return true if at least one of the inputs is true.",Blockly.Msg.LOGIC_TERNARY_CONDITION="test",Blockly.Msg.LOGIC_TERNARY_HELPURL="https://en.wikipedia.org/wiki/%3F:",Blockly.Msg.LOGIC_TERNARY_IF_FALSE="if false",Blockly.Msg.LOGIC_TERNARY_IF_TRUE="if true",Blockly.Msg.LOGIC_TERNARY_TOOLTIP="Check the condition in 'test'. If the condition is true, returns the 'if true' value; otherwise returns the 'if false' value.",Blockly.Msg.MATH_ADDITION_SYMBOL="+",Blockly.Msg.MATH_ARITHMETIC_HELPURL="https://en.wikipedia.org/wiki/Arithmetic",Blockly.Msg.MATH_ARITHMETIC_TOOLTIP_ADD="Return the sum of the two numbers.",Blockly.Msg.MATH_ARITHMETIC_TOOLTIP_DIVIDE="Return the quotient of the two numbers.",Blockly.Msg.MATH_ARITHMETIC_TOOLTIP_MINUS="Return the difference of the two numbers.",Blockly.Msg.MATH_ARITHMETIC_TOOLTIP_MULTIPLY="Return the product of the two numbers.",Blockly.Msg.MATH_ARITHMETIC_TOOLTIP_POWER="Return the first number raised to the power of the second number.",Blockly.Msg.MATH_ATAN2_HELPURL="https://en.wikipedia.org/wiki/Atan2",Blockly.Msg.MATH_ATAN2_TITLE="atan2 of X:%1 Y:%2",Blockly.Msg.MATH_ATAN2_TOOLTIP="Return the arctangent of point (X, Y) in degrees from -180 to 180.",Blockly.Msg.MATH_CHANGE_HELPURL="https://en.wikipedia.org/wiki/Programming_idiom#Incrementing_a_counter",Blockly.Msg.MATH_CHANGE_TITLE="change %1 by %2",Blockly.Msg.MATH_CHANGE_TOOLTIP="Add a number to variable '%1'.",Blockly.Msg.MATH_CONSTANT_HELPURL="https://en.wikipedia.org/wiki/Mathematical_constant",Blockly.Msg.MATH_CONSTANT_TOOLTIP="Return one of the common constants:  (3.141), e (2.718),  (1.618), sqrt(2) (1.414), sqrt() (0.707), or  (infinity).",Blockly.Msg.MATH_CONSTRAIN_HELPURL="https://en.wikipedia.org/wiki/Clamping_(graphics)",Blockly.Msg.MATH_CONSTRAIN_TITLE="constrain %1 low %2 high %3",Blockly.Msg.MATH_CONSTRAIN_TOOLTIP="Constrain a number to be between the specified limits (inclusive).",Blockly.Msg.MATH_DIVISION_SYMBOL="",Blockly.Msg.MATH_IS_DIVISIBLE_BY="is divisible by",Blockly.Msg.MATH_IS_EVEN="is even",Blockly.Msg.MATH_IS_NEGATIVE="is negative",Blockly.Msg.MATH_IS_ODD="is odd",Blockly.Msg.MATH_IS_POSITIVE="is positive",Blockly.Msg.MATH_IS_PRIME="is prime",Blockly.Msg.MATH_IS_TOOLTIP="Check if a number is an even, odd, prime, whole, positive, negative, or if it is divisible by certain number. Returns true or false.",Blockly.Msg.MATH_IS_WHOLE="is whole",Blockly.Msg.MATH_MODULO_HELPURL="https://en.wikipedia.org/wiki/Modulo_operation",Blockly.Msg.MATH_MODULO_TITLE="remainder of %1  %2",Blockly.Msg.MATH_MODULO_TOOLTIP="Return the remainder from dividing the two numbers.",Blockly.Msg.MATH_MULTIPLICATION_SYMBOL="",Blockly.Msg.MATH_NUMBER_HELPURL="https://en.wikipedia.org/wiki/Number",Blockly.Msg.MATH_NUMBER_TOOLTIP="A number.",Blockly.Msg.MATH_ONLIST_HELPURL="",Blockly.Msg.MATH_ONLIST_OPERATOR_AVERAGE="average of list",Blockly.Msg.MATH_ONLIST_OPERATOR_MAX="max of list",Blockly.Msg.MATH_ONLIST_OPERATOR_MEDIAN="median of list",Blockly.Msg.MATH_ONLIST_OPERATOR_MIN="min of list",Blockly.Msg.MATH_ONLIST_OPERATOR_MODE="modes of list",Blockly.Msg.MATH_ONLIST_OPERATOR_RANDOM="random item of list",Blockly.Msg.MATH_ONLIST_OPERATOR_STD_DEV="standard deviation of list",Blockly.Msg.MATH_ONLIST_OPERATOR_SUM="sum of list",Blockly.Msg.MATH_ONLIST_TOOLTIP_AVERAGE="Return the average (arithmetic mean) of the numeric values in the list.",Blockly.Msg.MATH_ONLIST_TOOLTIP_MAX="Return the largest number in the list.",Blockly.Msg.MATH_ONLIST_TOOLTIP_MEDIAN="Return the median number in the list.",Blockly.Msg.MATH_ONLIST_TOOLTIP_MIN="Return the smallest number in the list.",Blockly.Msg.MATH_ONLIST_TOOLTIP_MODE="Return a list of the most common item(s) in the list.",Blockly.Msg.MATH_ONLIST_TOOLTIP_RANDOM="Return a random element from the list.",Blockly.Msg.MATH_ONLIST_TOOLTIP_STD_DEV="Return the standard deviation of the list.",Blockly.Msg.MATH_ONLIST_TOOLTIP_SUM="Return the sum of all the numbers in the list.",Blockly.Msg.MATH_POWER_SYMBOL="^",Blockly.Msg.MATH_RANDOM_FLOAT_HELPURL="https://en.wikipedia.org/wiki/Random_number_generation",Blockly.Msg.MATH_RANDOM_FLOAT_TITLE_RANDOM="random fraction",Blockly.Msg.MATH_RANDOM_FLOAT_TOOLTIP="Return a random fraction between 0.0 (inclusive) and 1.0 (exclusive).",Blockly.Msg.MATH_RANDOM_INT_HELPURL="https://en.wikipedia.org/wiki/Random_number_generation",Blockly.Msg.MATH_RANDOM_INT_TITLE="random integer from %1 to %2",Blockly.Msg.MATH_RANDOM_INT_TOOLTIP="Return a random integer between the two specified limits, inclusive.",Blockly.Msg.MATH_ROUND_HELPURL="https://en.wikipedia.org/wiki/Rounding",Blockly.Msg.MATH_ROUND_OPERATOR_ROUND="round",Blockly.Msg.MATH_ROUND_OPERATOR_ROUNDDOWN="round down",Blockly.Msg.MATH_ROUND_OPERATOR_ROUNDUP="round up",Blockly.Msg.MATH_ROUND_TOOLTIP="Round a number up or down.",Blockly.Msg.MATH_SINGLE_HELPURL="https://en.wikipedia.org/wiki/Square_root",Blockly.Msg.MATH_SINGLE_OP_ABSOLUTE="absolute",Blockly.Msg.MATH_SINGLE_OP_ROOT="square root",Blockly.Msg.MATH_SINGLE_TOOLTIP_ABS="Return the absolute value of a number.",Blockly.Msg.MATH_SINGLE_TOOLTIP_EXP="Return e to the power of a number.",Blockly.Msg.MATH_SINGLE_TOOLTIP_LN="Return the natural logarithm of a number.",Blockly.Msg.MATH_SINGLE_TOOLTIP_LOG10="Return the base 10 logarithm of a number.",Blockly.Msg.MATH_SINGLE_TOOLTIP_NEG="Return the negation of a number.",Blockly.Msg.MATH_SINGLE_TOOLTIP_POW10="Return 10 to the power of a number.",Blockly.Msg.MATH_SINGLE_TOOLTIP_ROOT="Return the square root of a number.",Blockly.Msg.MATH_SUBTRACTION_SYMBOL="-",Blockly.Msg.MATH_TRIG_ACOS="acos",Blockly.Msg.MATH_TRIG_ASIN="asin",Blockly.Msg.MATH_TRIG_ATAN="atan",Blockly.Msg.MATH_TRIG_COS="cos",Blockly.Msg.MATH_TRIG_HELPURL="https://en.wikipedia.org/wiki/Trigonometric_functions",Blockly.Msg.MATH_TRIG_SIN="sin",Blockly.Msg.MATH_TRIG_TAN="tan",Blockly.Msg.MATH_TRIG_TOOLTIP_ACOS="Return the arccosine of a number.",Blockly.Msg.MATH_TRIG_TOOLTIP_ASIN="Return the arcsine of a number.",Blockly.Msg.MATH_TRIG_TOOLTIP_ATAN="Return the arctangent of a number.",Blockly.Msg.MATH_TRIG_TOOLTIP_COS="Return the cosine of a degree (not radian).",Blockly.Msg.MATH_TRIG_TOOLTIP_SIN="Return the sine of a degree (not radian).",Blockly.Msg.MATH_TRIG_TOOLTIP_TAN="Return the tangent of a degree (not radian).",Blockly.Msg.NEW_COLOUR_VARIABLE="Create colour variable...",Blockly.Msg.NEW_NUMBER_VARIABLE="Create number variable...",Blockly.Msg.NEW_STRING_VARIABLE="Create string variable...",Blockly.Msg.NEW_VARIABLE="Create variable...",Blockly.Msg.NEW_VARIABLE_TITLE="New variable name:",Blockly.Msg.NEW_VARIABLE_TYPE_TITLE="New variable type:",Blockly.Msg.ORDINAL_NUMBER_SUFFIX="",Blockly.Msg.PROCEDURES_ALLOW_STATEMENTS="allow statements",Blockly.Msg.PROCEDURES_BEFORE_PARAMS="with:",Blockly.Msg.PROCEDURES_CALLNORETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",Blockly.Msg.PROCEDURES_CALLNORETURN_TOOLTIP="Run the user-defined function '%1'.",Blockly.Msg.PROCEDURES_CALLRETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",Blockly.Msg.PROCEDURES_CALLRETURN_TOOLTIP="Run the user-defined function '%1' and use its output.",Blockly.Msg.PROCEDURES_CALL_BEFORE_PARAMS="with:",Blockly.Msg.PROCEDURES_CREATE_DO="Create '%1'",Blockly.Msg.PROCEDURES_DEFNORETURN_COMMENT="Describe this function...",Blockly.Msg.PROCEDURES_DEFNORETURN_DO="",Blockly.Msg.PROCEDURES_DEFNORETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",Blockly.Msg.PROCEDURES_DEFNORETURN_PROCEDURE="do something",Blockly.Msg.PROCEDURES_DEFNORETURN_TITLE="to",Blockly.Msg.PROCEDURES_DEFNORETURN_TOOLTIP="Creates a function with no output.",Blockly.Msg.PROCEDURES_DEFRETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",Blockly.Msg.PROCEDURES_DEFRETURN_RETURN="return",Blockly.Msg.PROCEDURES_DEFRETURN_TOOLTIP="Creates a function with an output.",Blockly.Msg.PROCEDURES_DEF_DUPLICATE_WARNING="Warning: This function has duplicate parameters.",Blockly.Msg.PROCEDURES_HIGHLIGHT_DEF="Highlight function definition",Blockly.Msg.PROCEDURES_IFRETURN_HELPURL="http://c2.com/cgi/wiki?GuardClause",Blockly.Msg.PROCEDURES_IFRETURN_TOOLTIP="If a value is true, then return a second value.",Blockly.Msg.PROCEDURES_IFRETURN_WARNING="Warning: This block may be used only within a function definition.",Blockly.Msg.PROCEDURES_MUTATORARG_TITLE="input name:",Blockly.Msg.PROCEDURES_MUTATORARG_TOOLTIP="Add an input to the function.",Blockly.Msg.PROCEDURES_MUTATORCONTAINER_TITLE="inputs",Blockly.Msg.PROCEDURES_MUTATORCONTAINER_TOOLTIP="Add, remove, or reorder inputs to this function.",Blockly.Msg.REDO="Redo",Blockly.Msg.REMOVE_COMMENT="Remove Comment",Blockly.Msg.RENAME_VARIABLE="Rename variable...",Blockly.Msg.RENAME_VARIABLE_TITLE="Rename all '%1' variables to:",Blockly.Msg.TEXT_APPEND_HELPURL="https://github.com/google/blockly/wiki/Text#text-modification",Blockly.Msg.TEXT_APPEND_TITLE="to %1 append text %2",Blockly.Msg.TEXT_APPEND_TOOLTIP="Append some text to variable '%1'.",Blockly.Msg.TEXT_CHANGECASE_HELPURL="https://github.com/google/blockly/wiki/Text#adjusting-text-case",Blockly.Msg.TEXT_CHANGECASE_OPERATOR_LOWERCASE="to lower case",Blockly.Msg.TEXT_CHANGECASE_OPERATOR_TITLECASE="to Title Case",Blockly.Msg.TEXT_CHANGECASE_OPERATOR_UPPERCASE="to UPPER CASE",Blockly.Msg.TEXT_CHANGECASE_TOOLTIP="Return a copy of the text in a different case.",Blockly.Msg.TEXT_CHARAT_FIRST="get first letter",Blockly.Msg.TEXT_CHARAT_FROM_END="get letter # from end",Blockly.Msg.TEXT_CHARAT_FROM_START="get letter #",Blockly.Msg.TEXT_CHARAT_HELPURL="https://github.com/google/blockly/wiki/Text#extracting-text",Blockly.Msg.TEXT_CHARAT_LAST="get last letter",Blockly.Msg.TEXT_CHARAT_RANDOM="get random letter",Blockly.Msg.TEXT_CHARAT_TAIL="",Blockly.Msg.TEXT_CHARAT_TITLE="in text %1 %2",Blockly.Msg.TEXT_CHARAT_TOOLTIP="Returns the letter at the specified position.",Blockly.Msg.TEXT_COUNT_HELPURL="https://github.com/google/blockly/wiki/Text#counting-substrings",Blockly.Msg.TEXT_COUNT_MESSAGE0="count %1 in %2",Blockly.Msg.TEXT_COUNT_TOOLTIP="Count how many times some text occurs within some other text.",Blockly.Msg.TEXT_CREATE_JOIN_ITEM_TOOLTIP="Add an item to the text.",Blockly.Msg.TEXT_CREATE_JOIN_TITLE_JOIN="join",Blockly.Msg.TEXT_CREATE_JOIN_TOOLTIP="Add, remove, or reorder sections to reconfigure this text block.",Blockly.Msg.TEXT_GET_SUBSTRING_END_FROM_END="to letter # from end",Blockly.Msg.TEXT_GET_SUBSTRING_END_FROM_START="to letter #",Blockly.Msg.TEXT_GET_SUBSTRING_END_LAST="to last letter",Blockly.Msg.TEXT_GET_SUBSTRING_HELPURL="https://github.com/google/blockly/wiki/Text#extracting-a-region-of-text",Blockly.Msg.TEXT_GET_SUBSTRING_INPUT_IN_TEXT="in text",Blockly.Msg.TEXT_GET_SUBSTRING_START_FIRST="get substring from first letter",Blockly.Msg.TEXT_GET_SUBSTRING_START_FROM_END="get substring from letter # from end",Blockly.Msg.TEXT_GET_SUBSTRING_START_FROM_START="get substring from letter #",Blockly.Msg.TEXT_GET_SUBSTRING_TAIL="",Blockly.Msg.TEXT_GET_SUBSTRING_TOOLTIP="Returns a specified portion of the text.",Blockly.Msg.TEXT_INDEXOF_HELPURL="https://github.com/google/blockly/wiki/Text#finding-text",Blockly.Msg.TEXT_INDEXOF_OPERATOR_FIRST="find first occurrence of text",Blockly.Msg.TEXT_INDEXOF_OPERATOR_LAST="find last occurrence of text",Blockly.Msg.TEXT_INDEXOF_TITLE="in text %1 %2 %3",Blockly.Msg.TEXT_INDEXOF_TOOLTIP="Returns the index of the first/last occurrence of the first text in the second text. Returns %1 if text is not found.",Blockly.Msg.TEXT_ISEMPTY_HELPURL="https://github.com/google/blockly/wiki/Text#checking-for-empty-text",Blockly.Msg.TEXT_ISEMPTY_TITLE="%1 is empty",Blockly.Msg.TEXT_ISEMPTY_TOOLTIP="Returns true if the provided text is empty.",Blockly.Msg.TEXT_JOIN_HELPURL="https://github.com/google/blockly/wiki/Text#text-creation",Blockly.Msg.TEXT_JOIN_TITLE_CREATEWITH="create text with",Blockly.Msg.TEXT_JOIN_TOOLTIP="Create a piece of text by joining together any number of items.",Blockly.Msg.TEXT_LENGTH_HELPURL="https://github.com/google/blockly/wiki/Text#text-modification",Blockly.Msg.TEXT_LENGTH_TITLE="length of %1",Blockly.Msg.TEXT_LENGTH_TOOLTIP="Returns the number of letters (including spaces) in the provided text.",Blockly.Msg.TEXT_PRINT_HELPURL="https://github.com/google/blockly/wiki/Text#printing-text",Blockly.Msg.TEXT_PRINT_TITLE="print %1",Blockly.Msg.TEXT_PRINT_TOOLTIP="Print the specified text, number or other value.",Blockly.Msg.TEXT_PROMPT_HELPURL="https://github.com/google/blockly/wiki/Text#getting-input-from-the-user",Blockly.Msg.TEXT_PROMPT_TOOLTIP_NUMBER="Prompt for user for a number.",Blockly.Msg.TEXT_PROMPT_TOOLTIP_TEXT="Prompt for user for some text.",Blockly.Msg.TEXT_PROMPT_TYPE_NUMBER="prompt for number with message",Blockly.Msg.TEXT_PROMPT_TYPE_TEXT="prompt for text with message",Blockly.Msg.TEXT_REPLACE_HELPURL="https://github.com/google/blockly/wiki/Text#replacing-substrings",Blockly.Msg.TEXT_REPLACE_MESSAGE0="replace %1 with %2 in %3",Blockly.Msg.TEXT_REPLACE_TOOLTIP="Replace all occurances of some text within some other text.",Blockly.Msg.TEXT_REVERSE_HELPURL="https://github.com/google/blockly/wiki/Text#reversing-text",Blockly.Msg.TEXT_REVERSE_MESSAGE0="reverse %1",Blockly.Msg.TEXT_REVERSE_TOOLTIP="Reverses the order of the characters in the text.",Blockly.Msg.TEXT_TEXT_HELPURL="https://en.wikipedia.org/wiki/String_(computer_science)",Blockly.Msg.TEXT_TEXT_TOOLTIP="A letter, word, or line of text.",Blockly.Msg.TEXT_TRIM_HELPURL="https://github.com/google/blockly/wiki/Text#trimming-removing-spaces",Blockly.Msg.TEXT_TRIM_OPERATOR_BOTH="trim spaces from both sides of",Blockly.Msg.TEXT_TRIM_OPERATOR_LEFT="trim spaces from left side of",Blockly.Msg.TEXT_TRIM_OPERATOR_RIGHT="trim spaces from right side of",Blockly.Msg.TEXT_TRIM_TOOLTIP="Return a copy of the text with spaces removed from one or both ends.",Blockly.Msg.TODAY="Today",Blockly.Msg.UNDO="Undo",Blockly.Msg.UNNAMED_KEY="unnamed",Blockly.Msg.VARIABLES_DEFAULT_NAME="item",Blockly.Msg.VARIABLES_GET_CREATE_SET="Create 'set %1'",Blockly.Msg.VARIABLES_GET_HELPURL="https://github.com/google/blockly/wiki/Variables#get",Blockly.Msg.VARIABLES_GET_TOOLTIP="Returns the value of this variable.",Blockly.Msg.VARIABLES_SET="set %1 to %2",Blockly.Msg.VARIABLES_SET_CREATE_GET="Create 'get %1'",Blockly.Msg.VARIABLES_SET_HELPURL="https://github.com/google/blockly/wiki/Variables#set",Blockly.Msg.VARIABLES_SET_TOOLTIP="Sets this variable to be equal to the input.",Blockly.Msg.VARIABLE_ALREADY_EXISTS="A variable named '%1' already exists.",Blockly.Msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE="A variable named '%1' already exists for another type: '%2'.",Blockly.Msg.WORKSPACE_ARIA_LABEL="Blockly Workspace",Blockly.Msg.WORKSPACE_COMMENT_DEFAULT_TEXT="Say something...",Blockly.Msg.CONTROLS_FOREACH_INPUT_DO=Blockly.Msg.CONTROLS_REPEAT_INPUT_DO,Blockly.Msg.CONTROLS_FOR_INPUT_DO=Blockly.Msg.CONTROLS_REPEAT_INPUT_DO,Blockly.Msg.CONTROLS_IF_ELSEIF_TITLE_ELSEIF=Blockly.Msg.CONTROLS_IF_MSG_ELSEIF,Blockly.Msg.CONTROLS_IF_ELSE_TITLE_ELSE=Blockly.Msg.CONTROLS_IF_MSG_ELSE,Blockly.Msg.CONTROLS_IF_IF_TITLE_IF=Blockly.Msg.CONTROLS_IF_MSG_IF,Blockly.Msg.CONTROLS_IF_MSG_THEN=Blockly.Msg.CONTROLS_REPEAT_INPUT_DO,Blockly.Msg.CONTROLS_WHILEUNTIL_INPUT_DO=Blockly.Msg.CONTROLS_REPEAT_INPUT_DO,Blockly.Msg.LISTS_CREATE_WITH_ITEM_TITLE=Blockly.Msg.VARIABLES_DEFAULT_NAME,Blockly.Msg.LISTS_GET_INDEX_HELPURL=Blockly.Msg.LISTS_INDEX_OF_HELPURL,Blockly.Msg.LISTS_GET_INDEX_INPUT_IN_LIST=Blockly.Msg.LISTS_INLIST,Blockly.Msg.LISTS_GET_SUBLIST_INPUT_IN_LIST=Blockly.Msg.LISTS_INLIST,Blockly.Msg.LISTS_INDEX_OF_INPUT_IN_LIST=Blockly.Msg.LISTS_INLIST,Blockly.Msg.LISTS_SET_INDEX_INPUT_IN_LIST=Blockly.Msg.LISTS_INLIST,Blockly.Msg.MATH_CHANGE_TITLE_ITEM=Blockly.Msg.VARIABLES_DEFAULT_NAME,Blockly.Msg.PROCEDURES_DEFRETURN_COMMENT=Blockly.Msg.PROCEDURES_DEFNORETURN_COMMENT,Blockly.Msg.PROCEDURES_DEFRETURN_DO=Blockly.Msg.PROCEDURES_DEFNORETURN_DO,Blockly.Msg.PROCEDURES_DEFRETURN_PROCEDURE=Blockly.Msg.PROCEDURES_DEFNORETURN_PROCEDURE,Blockly.Msg.PROCEDURES_DEFRETURN_TITLE=Blockly.Msg.PROCEDURES_DEFNORETURN_TITLE,Blockly.Msg.TEXT_APPEND_VARIABLE=Blockly.Msg.VARIABLES_DEFAULT_NAME,Blockly.Msg.TEXT_CREATE_JOIN_ITEM_TITLE_ITEM=Blockly.Msg.VARIABLES_DEFAULT_NAME,Blockly.Msg.MATH_HUE="230",Blockly.Msg.LOOPS_HUE="120",Blockly.Msg.LISTS_HUE="260",Blockly.Msg.LOGIC_HUE="210",Blockly.Msg.VARIABLES_HUE="330",Blockly.Msg.TEXTS_HUE="160",Blockly.Msg.PROCEDURES_HUE="290",Blockly.Msg.COLOUR_HUE="20",Blockly.Msg.VARIABLES_DYNAMIC_HUE="310",Blockly.Msg})?__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__):__WEBPACK_AMD_DEFINE_FACTORY__)||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},6833:(module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(3645),_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0__),_node_modules_css_loader_dist_runtime_getUrl_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(1667),_node_modules_css_loader_dist_runtime_getUrl_js__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_node_modules_css_loader_dist_runtime_getUrl_js__WEBPACK_IMPORTED_MODULE_1__),_images_gmenew_png__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(3677),_images_gmeimport_png__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(3154),_images_gmeexport_png__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(3653),_images_gmebackups_png__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(9336),_images_gmesettings_png__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(4140),_images_gmesave_png__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(6601),_images_gmeclose_png__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(158),_images_gmmlogo_png__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(8159),___CSS_LOADER_EXPORT___=_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0___default()((function(i){return i[1]})),___CSS_LOADER_URL_REPLACEMENT_0___=_node_modules_css_loader_dist_runtime_getUrl_js__WEBPACK_IMPORTED_MODULE_1___default()(_images_gmenew_png__WEBPACK_IMPORTED_MODULE_2__.Z),___CSS_LOADER_URL_REPLACEMENT_1___=_node_modules_css_loader_dist_runtime_getUrl_js__WEBPACK_IMPORTED_MODULE_1___default()(_images_gmeimport_png__WEBPACK_IMPORTED_MODULE_3__.Z),___CSS_LOADER_URL_REPLACEMENT_2___=_node_modules_css_loader_dist_runtime_getUrl_js__WEBPACK_IMPORTED_MODULE_1___default()(_images_gmeexport_png__WEBPACK_IMPORTED_MODULE_4__.Z),___CSS_LOADER_URL_REPLACEMENT_3___=_node_modules_css_loader_dist_runtime_getUrl_js__WEBPACK_IMPORTED_MODULE_1___default()(_images_gmebackups_png__WEBPACK_IMPORTED_MODULE_5__.Z),___CSS_LOADER_URL_REPLACEMENT_4___=_node_modules_css_loader_dist_runtime_getUrl_js__WEBPACK_IMPORTED_MODULE_1___default()(_images_gmesettings_png__WEBPACK_IMPORTED_MODULE_6__.Z),___CSS_LOADER_URL_REPLACEMENT_5___=_node_modules_css_loader_dist_runtime_getUrl_js__WEBPACK_IMPORTED_MODULE_1___default()(_images_gmesave_png__WEBPACK_IMPORTED_MODULE_7__.Z),___CSS_LOADER_URL_REPLACEMENT_6___=_node_modules_css_loader_dist_runtime_getUrl_js__WEBPACK_IMPORTED_MODULE_1___default()(_images_gmeclose_png__WEBPACK_IMPORTED_MODULE_8__.Z),___CSS_LOADER_URL_REPLACEMENT_7___=_node_modules_css_loader_dist_runtime_getUrl_js__WEBPACK_IMPORTED_MODULE_1___default()(_images_gmmlogo_png__WEBPACK_IMPORTED_MODULE_9__.Z);___CSS_LOADER_EXPORT___.push([module.id,"/* THEMES COMPAT */\r\n\r\n:root {\r\n    --gm_primary_text: #000000;\r\n    --gm_secondary_text: #505050;\r\n    --gm_window_color: #009688;\r\n    --gm_window_text: #ffffff;\r\n    --gm_primary_background: #e2e2e2;\r\n    --gm_behind_lobby_background: #1a2733;\r\n    --gm_table_color: #c1cdd2;\r\n    --gm_table_alt_color: #d2dbde;\r\n}\r\n\r\n/* GAME MODE EDITOR */\r\n\r\n#gmeditor {\r\n    position: absolute;\r\n    width: 100%;\r\n    height: 100%;\r\n    background-color: var(--gm_behind_lobby_background);\r\n}\r\n\r\n#gmeditorwindow {\r\n    position: absolute;\r\n    top: 50%;\r\n    left: 50%;\r\n    transform: translate(-50%, -50%);\r\n    width: 90%;\r\n    height: 90%;\r\n    box-sizing: border-box;\r\n    margin: 0;\r\n    padding-top: 34px;\r\n    background-color: var(--gm_primary_background);\r\n    border-radius: 4px;\r\n    display: flex;\r\n    flex-direction: column;\r\n    align-items: center;\r\n}\r\n\r\n#gmeditor_helptext {\r\n    font-family: 'futurept_b1';\r\n    font-size: 15px;\r\n    line-height: 25px;\r\n    flex-grow: 1;\r\n    text-align: center;\r\n}\r\n\r\n#gmeditor_buttoncontainer {\r\n    display: flex;\r\n    width: 100%;\r\n    align-items: center;\r\n    justify-content: space-between;\r\n    align-content: stretch;\r\n}\r\n\r\n#gmeditor_leftbuttons {\r\n    display: flex;\r\n    flex-grow: 1;\r\n    justify-content: flex-start;\r\n    margin: 5px;\r\n}\r\n\r\n#gmeditor_rightbuttons {\r\n    display: flex;\r\n    flex-grow: 1;\r\n    justify-content: flex-end;\r\n    margin: 5px;\r\n}\r\n\r\n.gmeditor_iconbutton {\r\n    background-repeat: no-repeat;\r\n    background-position: center;\r\n    width: 28px;\r\n    height: 24px;\r\n    display: inline-block;\r\n    margin: 0 2px;\r\n}\r\n\r\n#gmeditor_newbutton {\r\n    background-image: url("+___CSS_LOADER_URL_REPLACEMENT_0___+");\r\n}\r\n\r\n#gmeditor_importbutton {\r\n    background-image: url("+___CSS_LOADER_URL_REPLACEMENT_1___+");\r\n}\r\n\r\n#gmeditor_exportbutton {\r\n    background-image: url("+___CSS_LOADER_URL_REPLACEMENT_2___+");\r\n}\r\n\r\n#gmeditor_backupsbutton {\r\n    background-image: url("+___CSS_LOADER_URL_REPLACEMENT_3___+");\r\n}\r\n\r\n#gmeditor_settingsbutton {\r\n    background-image: url("+___CSS_LOADER_URL_REPLACEMENT_4___+");\r\n}\r\n\r\n#gmeditor_savebutton {\r\n    background-image: url("+___CSS_LOADER_URL_REPLACEMENT_5___+");\r\n}\r\n\r\n#gmeditor_closebutton {\r\n    background-image: url("+___CSS_LOADER_URL_REPLACEMENT_6___+");\r\n}\r\n\r\n#gmblocklyarea {\r\n    width: 100%;\r\n    padding: 10px;\r\n    box-sizing: border-box;\r\n    flex-grow: 1;\r\n}\r\n\r\n#gmblocklydiv {\r\n    position: absolute;\r\n    padding: 10px;\r\n    box-sizing: border-box;\r\n}\r\n\r\n.blockly-ws-search button {\r\n    width: 20px;\r\n}\r\n\r\n/* LOBBY MODS */\r\n\r\n.modebuttoncontainer {\r\n    display: flex;\r\n    position: absolute;\r\n    right: 15px;\r\n    bottom: 55px;\r\n    width: 116px;\r\n}\r\n\r\n#newbonklobby_modebutton {\r\n    width: 75px;\r\n    right: 55px;\r\n}\r\n\r\n#newbonklobby_modebutton .gm_withbonkhost {\r\n    right: 15px;\r\n}\r\n\r\n#gmeditor_openbutton {\r\n    position: absolute;\r\n    right: 15px;\r\n    bottom: 55px;\r\n    height: 30px;\r\n    width: 30px;\r\n    margin-left: 5px;\r\n    background-image: url("+___CSS_LOADER_URL_REPLACEMENT_7___+');\r\n    background-size: 95%;\r\n    background-repeat: no-repeat;\r\n    background-position-x: center;\r\n    background-position-y: center;\r\n}\r\n\r\n#gm_basemodetext {\r\n    display: inline-block;\r\n    color: var(--gm_secondary_text);\r\n    font-size: 14px;\r\n    pointer-events: none;\r\n    margin-left: 5px;\r\n}\r\n\r\n/* DIALOG CLASSES */\r\n\r\n.gm_behindblocker {\r\n    position: absolute;\r\n    left: 0;\r\n    right: 0;\r\n    top: 0;\r\n    bottom: 0;\r\n    margin: auto;\r\n    outline: 3000px solid rgba(0,0,0,0.30);\r\n    width: 1px;\r\n    height: 1px;\r\n}\r\n\r\n.gm_dialogwindowcontainer {\r\n    width: 100%;\r\n    height: 100%;\r\n    position: absolute;\r\n    visibility: hidden;\r\n    z-index: 99999;\r\n}\r\n\r\n.gm_dialogwindow {\r\n    position: absolute;\r\n    left: 0;\r\n    right: 0;\r\n    top: 0;\r\n    bottom: 0;\r\n    width: 400px;\r\n    height: fit-content;\r\n    background-color: var(--gm_primary_background);\r\n    margin: auto;\r\n    font-family: "futurept_b1";\r\n    border-radius: 7px;\r\n    display: flex;\r\n    flex-direction: column;\r\n    align-items: center;\r\n}\r\n\r\n.gm_dialogtopbar {\r\n    background-color: var(--gm_window_color);\r\n    width: 100%;\r\n    height: 30px;\r\n    line-height: 30px;\r\n    color: var(--gm_window_text);\r\n    font-family: "futurept_b1";\r\n    text-align: center;\r\n    font-size: 20px;\r\n    border-top-left-radius: 3px;\r\n    border-top-right-radius: 3px;\r\n}\r\n\r\n.gm_dialogtext {\r\n    color: var(--gm_primary_text);\r\n    text-align: center;\r\n    left: 0;\r\n    right: 0;\r\n    top: 53px;\r\n    margin-top: 20px;\r\n    margin-bottom: 10px;\r\n}\r\n\r\n.gm_dialogbuttoncontainer {\r\n    display: flex;\r\n    align-content: stretch;\r\n    width: 90%;\r\n    justify-content: space-evenly;\r\n}\r\n\r\n.gm_dialogbuttoncontainer div {\r\n    padding: 5px;\r\n    margin: 10px;\r\n    flex-grow: 1;\r\n}\r\n\r\n.gm_dialogoptions {\r\n    color: var(--gm_primary_text);\r\n    text-align: left;\r\n    left: 0;\r\n    right: 0;\r\n    top: 53px;\r\n    margin-top: 20px;\r\n    margin-bottom: 10px;\r\n    width: 80%;\r\n}\r\n\r\n.gm_dialogtextfield {\r\n    font-family: Arial, Helvetica, sans-serif;\r\n    text-align: center;\r\n    font-size: 15px;\r\n    background: #fdfdfd;\r\n    border: 1px solid #bdbdbd;\r\n    color: #4e4e4e;\r\n    width: 100%;\r\n    height: 30px;\r\n    padding-right: 4px;\r\n    margin-top: 3px;\r\n    resize: vertical;\r\n}\r\n\r\n/* VAR INSPECTOR */\r\n\r\n#gm_varinspector {\r\n    display: none;\r\n    position: absolute;\r\n    z-index: 9999;\r\n    width: 500px;\r\n    height: 500px;\r\n    resize: both;    \r\n    overflow: auto;\r\n\r\n    background-color: var(--gm_primary_background);\r\n    padding-top: 34px;\r\n    border-radius: 7px;\r\n    box-shadow: 1px 1px 5px -2px rgb(0 0 0 / 63%);\r\n}\r\n\r\n#gm_varinspector .windowTopBar {\r\n    cursor: grab;\r\n}\r\n\r\n#gm_varinspector .windowTopBar:active {\r\n    cursor: grabbing;\r\n}\r\n\r\n#gmvi_content {\r\n    flex-direction: column;\r\n    font-family: \'futurept_b1\';\r\n\r\n    overflow-x: hidden;\r\n    overflow-y: auto;\r\n\r\n    width: 100%;\r\n    height: 100%;\r\n    box-sizing: border-box;\r\n}\r\n\r\n.gmvi_tab_content {\r\n    display: flex;\r\n    flex-direction: column;\r\n\r\n    width: 100%;\r\n    color: var(--gm_primary_text);\r\n    font-family: "futurept_b1";\r\n}\r\n\r\n.gmvi_var {\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: space-between;\r\n    align-content: stretch;\r\n\r\n    width: 100%;\r\n    padding: 4px;\r\n    box-sizing: border-box;\r\n    background-color: var(--gm_table_color);\r\n}\r\n\r\n.gmvi_var:nth-child(odd) {\r\n    background-color: var(--gm_table_alt_color);\r\n}\r\n\r\n.gmvi_var div {\r\n    flex-basis: 0;\r\n    flex-grow: 1;\r\n}',""]);const __WEBPACK_DEFAULT_EXPORT__=___CSS_LOADER_EXPORT___},3645:module=>{"use strict";module.exports=function(cssWithMappingToString){var list=[];return list.toString=function(){return this.map((function(item){var content=cssWithMappingToString(item);return item[2]?"@media ".concat(item[2]," {").concat(content,"}"):content})).join("")},list.i=function(modules,mediaQuery,dedupe){"string"==typeof modules&&(modules=[[null,modules,""]]);var alreadyImportedModules={};if(dedupe)for(var i=0;i<this.length;i++){var id=this[i][0];null!=id&&(alreadyImportedModules[id]=!0)}for(var _i=0;_i<modules.length;_i++){var item=[].concat(modules[_i]);dedupe&&alreadyImportedModules[item[0]]||(mediaQuery&&(item[2]?item[2]="".concat(mediaQuery," and ").concat(item[2]):item[2]=mediaQuery),list.push(item))}},list}},1667:module=>{"use strict";module.exports=function(url,options){return options||(options={}),"string"!=typeof(url=url&&url.__esModule?url.default:url)?url:(/^['"].*['"]$/.test(url)&&(url=url.slice(1,-1)),options.hash&&(url+=options.hash),/["'() \t\n]/.test(url)||options.needQuotes?'"'.concat(url.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):url)}},9187:module=>{"use strict";function earcut(data,holeIndices,dim){dim=dim||2;var minX,minY,maxX,maxY,x,y,invSize,hasHoles=holeIndices&&holeIndices.length,outerLen=hasHoles?holeIndices[0]*dim:data.length,outerNode=linkedList(data,0,outerLen,dim,!0),triangles=[];if(!outerNode||outerNode.next===outerNode.prev)return triangles;if(hasHoles&&(outerNode=function(data,holeIndices,outerNode,dim){var i,len,list,queue=[];for(i=0,len=holeIndices.length;i<len;i++)(list=linkedList(data,holeIndices[i]*dim,i<len-1?holeIndices[i+1]*dim:data.length,dim,!1))===list.next&&(list.steiner=!0),queue.push(getLeftmost(list));for(queue.sort(compareX),i=0;i<queue.length;i++)outerNode=filterPoints(outerNode=eliminateHole(queue[i],outerNode),outerNode.next);return outerNode}(data,holeIndices,outerNode,dim)),data.length>80*dim){minX=maxX=data[0],minY=maxY=data[1];for(var i=dim;i<outerLen;i+=dim)(x=data[i])<minX&&(minX=x),(y=data[i+1])<minY&&(minY=y),x>maxX&&(maxX=x),y>maxY&&(maxY=y);invSize=0!==(invSize=Math.max(maxX-minX,maxY-minY))?1/invSize:0}return earcutLinked(outerNode,triangles,dim,minX,minY,invSize),triangles}function linkedList(data,start,end,dim,clockwise){var i,last;if(clockwise===signedArea(data,start,end,dim)>0)for(i=start;i<end;i+=dim)last=insertNode(i,data[i],data[i+1],last);else for(i=end-dim;i>=start;i-=dim)last=insertNode(i,data[i],data[i+1],last);return last&&equals(last,last.next)&&(removeNode(last),last=last.next),last}function filterPoints(start,end){if(!start)return start;end||(end=start);var again,p=start;do{if(again=!1,p.steiner||!equals(p,p.next)&&0!==area(p.prev,p,p.next))p=p.next;else{if(removeNode(p),(p=end=p.prev)===p.next)break;again=!0}}while(again||p!==end);return end}function earcutLinked(ear,triangles,dim,minX,minY,invSize,pass){if(ear){!pass&&invSize&&function(start,minX,minY,invSize){var p=start;do{null===p.z&&(p.z=zOrder(p.x,p.y,minX,minY,invSize)),p.prevZ=p.prev,p.nextZ=p.next,p=p.next}while(p!==start);p.prevZ.nextZ=null,p.prevZ=null,function(list){var i,p,q,e,tail,numMerges,pSize,qSize,inSize=1;do{for(p=list,list=null,tail=null,numMerges=0;p;){for(numMerges++,q=p,pSize=0,i=0;i<inSize&&(pSize++,q=q.nextZ);i++);for(qSize=inSize;pSize>0||qSize>0&&q;)0!==pSize&&(0===qSize||!q||p.z<=q.z)?(e=p,p=p.nextZ,pSize--):(e=q,q=q.nextZ,qSize--),tail?tail.nextZ=e:list=e,e.prevZ=tail,tail=e;p=q}tail.nextZ=null,inSize*=2}while(numMerges>1)}(p)}(ear,minX,minY,invSize);for(var prev,next,stop=ear;ear.prev!==ear.next;)if(prev=ear.prev,next=ear.next,invSize?isEarHashed(ear,minX,minY,invSize):isEar(ear))triangles.push(prev.i/dim),triangles.push(ear.i/dim),triangles.push(next.i/dim),removeNode(ear),ear=next.next,stop=next.next;else if((ear=next)===stop){pass?1===pass?earcutLinked(ear=cureLocalIntersections(filterPoints(ear),triangles,dim),triangles,dim,minX,minY,invSize,2):2===pass&&splitEarcut(ear,triangles,dim,minX,minY,invSize):earcutLinked(filterPoints(ear),triangles,dim,minX,minY,invSize,1);break}}}function isEar(ear){var a=ear.prev,b=ear,c=ear.next;if(area(a,b,c)>=0)return!1;for(var p=ear.next.next;p!==ear.prev;){if(pointInTriangle(a.x,a.y,b.x,b.y,c.x,c.y,p.x,p.y)&&area(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function isEarHashed(ear,minX,minY,invSize){var a=ear.prev,b=ear,c=ear.next;if(area(a,b,c)>=0)return!1;for(var minTX=a.x<b.x?a.x<c.x?a.x:c.x:b.x<c.x?b.x:c.x,minTY=a.y<b.y?a.y<c.y?a.y:c.y:b.y<c.y?b.y:c.y,maxTX=a.x>b.x?a.x>c.x?a.x:c.x:b.x>c.x?b.x:c.x,maxTY=a.y>b.y?a.y>c.y?a.y:c.y:b.y>c.y?b.y:c.y,minZ=zOrder(minTX,minTY,minX,minY,invSize),maxZ=zOrder(maxTX,maxTY,minX,minY,invSize),p=ear.prevZ,n=ear.nextZ;p&&p.z>=minZ&&n&&n.z<=maxZ;){if(p!==ear.prev&&p!==ear.next&&pointInTriangle(a.x,a.y,b.x,b.y,c.x,c.y,p.x,p.y)&&area(p.prev,p,p.next)>=0)return!1;if(p=p.prevZ,n!==ear.prev&&n!==ear.next&&pointInTriangle(a.x,a.y,b.x,b.y,c.x,c.y,n.x,n.y)&&area(n.prev,n,n.next)>=0)return!1;n=n.nextZ}for(;p&&p.z>=minZ;){if(p!==ear.prev&&p!==ear.next&&pointInTriangle(a.x,a.y,b.x,b.y,c.x,c.y,p.x,p.y)&&area(p.prev,p,p.next)>=0)return!1;p=p.prevZ}for(;n&&n.z<=maxZ;){if(n!==ear.prev&&n!==ear.next&&pointInTriangle(a.x,a.y,b.x,b.y,c.x,c.y,n.x,n.y)&&area(n.prev,n,n.next)>=0)return!1;n=n.nextZ}return!0}function cureLocalIntersections(start,triangles,dim){var p=start;do{var a=p.prev,b=p.next.next;!equals(a,b)&&intersects(a,p,p.next,b)&&locallyInside(a,b)&&locallyInside(b,a)&&(triangles.push(a.i/dim),triangles.push(p.i/dim),triangles.push(b.i/dim),removeNode(p),removeNode(p.next),p=start=b),p=p.next}while(p!==start);return filterPoints(p)}function splitEarcut(start,triangles,dim,minX,minY,invSize){var a=start;do{for(var b=a.next.next;b!==a.prev;){if(a.i!==b.i&&isValidDiagonal(a,b)){var c=splitPolygon(a,b);return a=filterPoints(a,a.next),c=filterPoints(c,c.next),earcutLinked(a,triangles,dim,minX,minY,invSize),void earcutLinked(c,triangles,dim,minX,minY,invSize)}b=b.next}a=a.next}while(a!==start)}function compareX(a,b){return a.x-b.x}function eliminateHole(hole,outerNode){var bridge=function(hole,outerNode){var m,p=outerNode,hx=hole.x,hy=hole.y,qx=-1/0;do{if(hy<=p.y&&hy>=p.next.y&&p.next.y!==p.y){var x=p.x+(hy-p.y)*(p.next.x-p.x)/(p.next.y-p.y);if(x<=hx&&x>qx){if(qx=x,x===hx){if(hy===p.y)return p;if(hy===p.next.y)return p.next}m=p.x<p.next.x?p:p.next}}p=p.next}while(p!==outerNode);if(!m)return null;if(hx===qx)return m;var tan,stop=m,mx=m.x,my=m.y,tanMin=1/0;p=m;do{hx>=p.x&&p.x>=mx&&hx!==p.x&&pointInTriangle(hy<my?hx:qx,hy,mx,my,hy<my?qx:hx,hy,p.x,p.y)&&(tan=Math.abs(hy-p.y)/(hx-p.x),locallyInside(p,hole)&&(tan<tanMin||tan===tanMin&&(p.x>m.x||p.x===m.x&&sectorContainsSector(m,p)))&&(m=p,tanMin=tan)),p=p.next}while(p!==stop);return m}(hole,outerNode);if(!bridge)return outerNode;var bridgeReverse=splitPolygon(bridge,hole),filteredBridge=filterPoints(bridge,bridge.next);return filterPoints(bridgeReverse,bridgeReverse.next),outerNode===bridge?filteredBridge:outerNode}function sectorContainsSector(m,p){return area(m.prev,m,p.prev)<0&&area(p.next,m,m.next)<0}function zOrder(x,y,minX,minY,invSize){return(x=1431655765&((x=858993459&((x=252645135&((x=16711935&((x=32767*(x-minX)*invSize)|x<<8))|x<<4))|x<<2))|x<<1))|(y=1431655765&((y=858993459&((y=252645135&((y=16711935&((y=32767*(y-minY)*invSize)|y<<8))|y<<4))|y<<2))|y<<1))<<1}function getLeftmost(start){var p=start,leftmost=start;do{(p.x<leftmost.x||p.x===leftmost.x&&p.y<leftmost.y)&&(leftmost=p),p=p.next}while(p!==start);return leftmost}function pointInTriangle(ax,ay,bx,by,cx,cy,px,py){return(cx-px)*(ay-py)-(ax-px)*(cy-py)>=0&&(ax-px)*(by-py)-(bx-px)*(ay-py)>=0&&(bx-px)*(cy-py)-(cx-px)*(by-py)>=0}function isValidDiagonal(a,b){return a.next.i!==b.i&&a.prev.i!==b.i&&!function(a,b){var p=a;do{if(p.i!==a.i&&p.next.i!==a.i&&p.i!==b.i&&p.next.i!==b.i&&intersects(p,p.next,a,b))return!0;p=p.next}while(p!==a);return!1}(a,b)&&(locallyInside(a,b)&&locallyInside(b,a)&&function(a,b){var p=a,inside=!1,px=(a.x+b.x)/2,py=(a.y+b.y)/2;do{p.y>py!=p.next.y>py&&p.next.y!==p.y&&px<(p.next.x-p.x)*(py-p.y)/(p.next.y-p.y)+p.x&&(inside=!inside),p=p.next}while(p!==a);return inside}(a,b)&&(area(a.prev,a,b.prev)||area(a,b.prev,b))||equals(a,b)&&area(a.prev,a,a.next)>0&&area(b.prev,b,b.next)>0)}function area(p,q,r){return(q.y-p.y)*(r.x-q.x)-(q.x-p.x)*(r.y-q.y)}function equals(p1,p2){return p1.x===p2.x&&p1.y===p2.y}function intersects(p1,q1,p2,q2){var o1=sign(area(p1,q1,p2)),o2=sign(area(p1,q1,q2)),o3=sign(area(p2,q2,p1)),o4=sign(area(p2,q2,q1));return o1!==o2&&o3!==o4||(!(0!==o1||!onSegment(p1,p2,q1))||(!(0!==o2||!onSegment(p1,q2,q1))||(!(0!==o3||!onSegment(p2,p1,q2))||!(0!==o4||!onSegment(p2,q1,q2)))))}function onSegment(p,q,r){return q.x<=Math.max(p.x,r.x)&&q.x>=Math.min(p.x,r.x)&&q.y<=Math.max(p.y,r.y)&&q.y>=Math.min(p.y,r.y)}function sign(num){return num>0?1:num<0?-1:0}function locallyInside(a,b){return area(a.prev,a,a.next)<0?area(a,b,a.next)>=0&&area(a,a.prev,b)>=0:area(a,b,a.prev)<0||area(a,a.next,b)<0}function splitPolygon(a,b){var a2=new Node(a.i,a.x,a.y),b2=new Node(b.i,b.x,b.y),an=a.next,bp=b.prev;return a.next=b,b.prev=a,a2.next=an,an.prev=a2,b2.next=a2,a2.prev=b2,bp.next=b2,b2.prev=bp,b2}function insertNode(i,x,y,last){var p=new Node(i,x,y);return last?(p.next=last.next,p.prev=last,last.next.prev=p,last.next=p):(p.prev=p,p.next=p),p}function removeNode(p){p.next.prev=p.prev,p.prev.next=p.next,p.prevZ&&(p.prevZ.nextZ=p.nextZ),p.nextZ&&(p.nextZ.prevZ=p.prevZ)}function Node(i,x,y){this.i=i,this.x=x,this.y=y,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function signedArea(data,start,end,dim){for(var sum=0,i=start,j=end-dim;i<end;i+=dim)sum+=(data[j]-data[i])*(data[i+1]+data[j+1]),j=i;return sum}module.exports=earcut,module.exports.default=earcut,earcut.deviation=function(data,holeIndices,dim,triangles){var hasHoles=holeIndices&&holeIndices.length,outerLen=hasHoles?holeIndices[0]*dim:data.length,polygonArea=Math.abs(signedArea(data,0,outerLen,dim));if(hasHoles)for(var i=0,len=holeIndices.length;i<len;i++){var start=holeIndices[i]*dim,end=i<len-1?holeIndices[i+1]*dim:data.length;polygonArea-=Math.abs(signedArea(data,start,end,dim))}var trianglesArea=0;for(i=0;i<triangles.length;i+=3){var a=triangles[i]*dim,b=triangles[i+1]*dim,c=triangles[i+2]*dim;trianglesArea+=Math.abs((data[a]-data[c])*(data[b+1]-data[a+1])-(data[a]-data[b])*(data[c+1]-data[a+1]))}return 0===polygonArea&&0===trianglesArea?0:Math.abs((trianglesArea-polygonArea)/polygonArea)},earcut.flatten=function(data){for(var dim=data[0][0].length,result={vertices:[],holes:[],dimensions:dim},holeIndex=0,i=0;i<data.length;i++){for(var j=0;j<data[i].length;j++)for(var d=0;d<dim;d++)result.vertices.push(data[i][j][d]);i>0&&(holeIndex+=data[i-1].length,result.holes.push(holeIndex))}return result}},6729:module=>{"use strict";var has=Object.prototype.hasOwnProperty,prefix="~";function Events(){}function EE(fn,context,once){this.fn=fn,this.context=context,this.once=once||!1}function addListener(emitter,event,fn,context,once){if("function"!=typeof fn)throw new TypeError("The listener must be a function");var listener=new EE(fn,context||emitter,once),evt=prefix?prefix+event:event;return emitter._events[evt]?emitter._events[evt].fn?emitter._events[evt]=[emitter._events[evt],listener]:emitter._events[evt].push(listener):(emitter._events[evt]=listener,emitter._eventsCount++),emitter}function clearEvent(emitter,evt){0==--emitter._eventsCount?emitter._events=new Events:delete emitter._events[evt]}function EventEmitter(){this._events=new Events,this._eventsCount=0}Object.create&&(Events.prototype=Object.create(null),(new Events).__proto__||(prefix=!1)),EventEmitter.prototype.eventNames=function(){var events,name,names=[];if(0===this._eventsCount)return names;for(name in events=this._events)has.call(events,name)&&names.push(prefix?name.slice(1):name);return Object.getOwnPropertySymbols?names.concat(Object.getOwnPropertySymbols(events)):names},EventEmitter.prototype.listeners=function(event){var evt=prefix?prefix+event:event,handlers=this._events[evt];if(!handlers)return[];if(handlers.fn)return[handlers.fn];for(var i=0,l=handlers.length,ee=new Array(l);i<l;i++)ee[i]=handlers[i].fn;return ee},EventEmitter.prototype.listenerCount=function(event){var evt=prefix?prefix+event:event,listeners=this._events[evt];return listeners?listeners.fn?1:listeners.length:0},EventEmitter.prototype.emit=function(event,a1,a2,a3,a4,a5){var evt=prefix?prefix+event:event;if(!this._events[evt])return!1;var args,i,listeners=this._events[evt],len=arguments.length;if(listeners.fn){switch(listeners.once&&this.removeListener(event,listeners.fn,void 0,!0),len){case 1:return listeners.fn.call(listeners.context),!0;case 2:return listeners.fn.call(listeners.context,a1),!0;case 3:return listeners.fn.call(listeners.context,a1,a2),!0;case 4:return listeners.fn.call(listeners.context,a1,a2,a3),!0;case 5:return listeners.fn.call(listeners.context,a1,a2,a3,a4),!0;case 6:return listeners.fn.call(listeners.context,a1,a2,a3,a4,a5),!0}for(i=1,args=new Array(len-1);i<len;i++)args[i-1]=arguments[i];listeners.fn.apply(listeners.context,args)}else{var j,length=listeners.length;for(i=0;i<length;i++)switch(listeners[i].once&&this.removeListener(event,listeners[i].fn,void 0,!0),len){case 1:listeners[i].fn.call(listeners[i].context);break;case 2:listeners[i].fn.call(listeners[i].context,a1);break;case 3:listeners[i].fn.call(listeners[i].context,a1,a2);break;case 4:listeners[i].fn.call(listeners[i].context,a1,a2,a3);break;default:if(!args)for(j=1,args=new Array(len-1);j<len;j++)args[j-1]=arguments[j];listeners[i].fn.apply(listeners[i].context,args)}}return!0},EventEmitter.prototype.on=function(event,fn,context){return addListener(this,event,fn,context,!1)},EventEmitter.prototype.once=function(event,fn,context){return addListener(this,event,fn,context,!0)},EventEmitter.prototype.removeListener=function(event,fn,context,once){var evt=prefix?prefix+event:event;if(!this._events[evt])return this;if(!fn)return clearEvent(this,evt),this;var listeners=this._events[evt];if(listeners.fn)listeners.fn!==fn||once&&!listeners.once||context&&listeners.context!==context||clearEvent(this,evt);else{for(var i=0,events=[],length=listeners.length;i<length;i++)(listeners[i].fn!==fn||once&&!listeners[i].once||context&&listeners[i].context!==context)&&events.push(listeners[i]);events.length?this._events[evt]=1===events.length?events[0]:events:clearEvent(this,evt)}return this},EventEmitter.prototype.removeAllListeners=function(event){var evt;return event?(evt=prefix?prefix+event:event,this._events[evt]&&clearEvent(this,evt)):(this._events=new Events,this._eventsCount=0),this},EventEmitter.prototype.off=EventEmitter.prototype.removeListener,EventEmitter.prototype.addListener=EventEmitter.prototype.on,EventEmitter.prefixed=prefix,EventEmitter.EventEmitter=EventEmitter,module.exports=EventEmitter},3162:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[],__WEBPACK_AMD_DEFINE_FACTORY__=function(){"use strict";function b(a,b){return void 0===b?b={autoBom:!1}:"object"!=typeof b&&(console.warn("Deprecated: Expected third argument to be a object"),b={autoBom:!b}),b.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a.type)?new Blob(["\ufeff",a],{type:a.type}):a}function c(a,b,c){var d=new XMLHttpRequest;d.open("GET",a),d.responseType="blob",d.onload=function(){g(d.response,b,c)},d.onerror=function(){console.error("could not download file")},d.send()}function d(a){var b=new XMLHttpRequest;b.open("HEAD",a,!1);try{b.send()}catch(a){}return 200<=b.status&&299>=b.status}function e(a){try{a.dispatchEvent(new MouseEvent("click"))}catch(c){var b=document.createEvent("MouseEvents");b.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),a.dispatchEvent(b)}}var f="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof __webpack_require__.g&&__webpack_require__.g.global===__webpack_require__.g?__webpack_require__.g:void 0,a=f.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),g=f.saveAs||("object"!=typeof window||window!==f?function(){}:"download"in HTMLAnchorElement.prototype&&!a?function(b,g,h){var i=f.URL||f.webkitURL,j=document.createElement("a");g=g||b.name||"download",j.download=g,j.rel="noopener","string"==typeof b?(j.href=b,j.origin===location.origin?e(j):d(j.href)?c(b,g,h):e(j,j.target="_blank")):(j.href=i.createObjectURL(b),setTimeout((function(){i.revokeObjectURL(j.href)}),4e4),setTimeout((function(){e(j)}),0))}:"msSaveOrOpenBlob"in navigator?function(f,g,h){if(g=g||f.name||"download","string"!=typeof f)navigator.msSaveOrOpenBlob(b(f,h),g);else if(d(f))c(f,g,h);else{var i=document.createElement("a");i.href=f,i.target="_blank",setTimeout((function(){e(i)}))}}:function(b,d,e,g){if((g=g||open("","_blank"))&&(g.document.title=g.document.body.innerText="downloading..."),"string"==typeof b)return c(b,d,e);var h="application/octet-stream"===b.type,i=/constructor/i.test(f.HTMLElement)||f.safari,j=/CriOS\/[\d]+/.test(navigator.userAgent);if((j||h&&i||a)&&"undefined"!=typeof FileReader){var k=new FileReader;k.onloadend=function(){var a=k.result;a=j?a:a.replace(/^data:[^;]*;/,"data:attachment/file;"),g?g.location.href=a:location=a,g=null},k.readAsDataURL(b)}else{var l=f.URL||f.webkitURL,m=l.createObjectURL(b);g?g.location=m:location.href=m,g=null,setTimeout((function(){l.revokeObjectURL(m)}),4e4)}});f.saveAs=g.saveAs=g,module.exports=g},void 0===(__WEBPACK_AMD_DEFINE_RESULT__="function"==typeof __WEBPACK_AMD_DEFINE_FACTORY__?__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__):__WEBPACK_AMD_DEFINE_FACTORY__)||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},7418:module=>{"use strict";var getOwnPropertySymbols=Object.getOwnPropertySymbols,hasOwnProperty=Object.prototype.hasOwnProperty,propIsEnumerable=Object.prototype.propertyIsEnumerable;function toObject(val){if(null==val)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(val)}module.exports=function(){try{if(!Object.assign)return!1;var test1=new String("abc");if(test1[5]="de","5"===Object.getOwnPropertyNames(test1)[0])return!1;for(var test2={},i=0;i<10;i++)test2["_"+String.fromCharCode(i)]=i;if("0123456789"!==Object.getOwnPropertyNames(test2).map((function(n){return test2[n]})).join(""))return!1;var test3={};return"abcdefghijklmnopqrst".split("").forEach((function(letter){test3[letter]=letter})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},test3)).join("")}catch(err){return!1}}()?Object.assign:function(target,source){for(var from,symbols,to=toObject(target),s=1;s<arguments.length;s++){for(var key in from=Object(arguments[s]))hasOwnProperty.call(from,key)&&(to[key]=from[key]);if(getOwnPropertySymbols){symbols=getOwnPropertySymbols(from);for(var i=0;i<symbols.length;i++)propIsEnumerable.call(from,symbols[i])&&(to[symbols[i]]=from[symbols[i]])}}return to}},2587:module=>{"use strict";function hasOwnProperty(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop)}module.exports=function(qs,sep,eq,options){sep=sep||"&",eq=eq||"=";var obj={};if("string"!=typeof qs||0===qs.length)return obj;var regexp=/\+/g;qs=qs.split(sep);var maxKeys=1e3;options&&"number"==typeof options.maxKeys&&(maxKeys=options.maxKeys);var len=qs.length;maxKeys>0&&len>maxKeys&&(len=maxKeys);for(var i=0;i<len;++i){var kstr,vstr,k,v,x=qs[i].replace(regexp,"%20"),idx=x.indexOf(eq);idx>=0?(kstr=x.substr(0,idx),vstr=x.substr(idx+1)):(kstr=x,vstr=""),k=decodeURIComponent(kstr),v=decodeURIComponent(vstr),hasOwnProperty(obj,k)?Array.isArray(obj[k])?obj[k].push(v):obj[k]=[obj[k],v]:obj[k]=v}return obj}},2361:module=>{"use strict";var stringifyPrimitive=function(v){switch(typeof v){case"string":return v;case"boolean":return v?"true":"false";case"number":return isFinite(v)?v:"";default:return""}};module.exports=function(obj,sep,eq,name){return sep=sep||"&",eq=eq||"=",null===obj&&(obj=void 0),"object"==typeof obj?Object.keys(obj).map((function(k){var ks=encodeURIComponent(stringifyPrimitive(k))+eq;return Array.isArray(obj[k])?obj[k].map((function(v){return ks+encodeURIComponent(stringifyPrimitive(v))})).join(sep):ks+encodeURIComponent(stringifyPrimitive(obj[k]))})).join(sep):name?encodeURIComponent(stringifyPrimitive(name))+eq+encodeURIComponent(stringifyPrimitive(obj)):""}},7673:(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";exports.decode=exports.parse=__webpack_require__(2587),exports.encode=exports.stringify=__webpack_require__(2361)},8820:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});const __WEBPACK_DEFAULT_EXPORT__='<xml xmlns="https://developers.google.com/blockly/xml" id="toolbox" style="display: none">\n  <category name="Logic" colour="#5b80a5">\n    <block type="controls_if"></block>\n    <block type="logic_compare">\n      <field name="OP">EQ</field>\n    </block>\n    <block type="logic_operation">\n      <field name="OP">AND</field>\n    </block>\n    <block type="logic_negate"></block>\n    <block type="logic_boolean">\n      <field name="BOOL">TRUE</field>\n    </block>\n    <block type="logic_null"></block>\n    <block type="logic_ternary"></block>\n  </category>\n  <category name="Loops" colour="#5ba55b">\n    <block type="controls_repeat_ext">\n      <value name="TIMES">\n        <shadow type="math_number">\n          <field name="NUM">10</field>\n        </shadow>\n      </value>\n    </block>\n    <block type="controls_whileUntil">\n      <field name="MODE">WHILE</field>\n    </block>\n    <block type="controls_for">\n      <field name="VAR" id="{WqvPolv4NnHnXhJ#i?A">i</field>\n      <value name="FROM">\n        <shadow type="math_number">\n          <field name="NUM">1</field>\n        </shadow>\n      </value>\n      <value name="TO">\n        <shadow type="math_number">\n          <field name="NUM">10</field>\n        </shadow>\n      </value>\n      <value name="BY">\n        <shadow type="math_number">\n          <field name="NUM">1</field>\n        </shadow>\n      </value>\n    </block>\n    <block type="controls_forEach">\n      <field name="VAR" id="|lGd7TPL8ZGM}[=cdJ{$">j</field>\n    </block>\n    <block type="controls_flow_statements">\n      <field name="FLOW">BREAK</field>\n    </block>\n  </category>\n  <category name="Math" colour="#5b67a5">\n    <block type="math_number">\n      <field name="NUM">0</field>\n    </block>\n    <block type="math_arithmetic">\n      <field name="OP">ADD</field>\n      <value name="A">\n        <shadow type="math_number">\n          <field name="NUM">1</field>\n        </shadow>\n      </value>\n      <value name="B">\n        <shadow type="math_number">\n          <field name="NUM">1</field>\n        </shadow>\n      </value>\n    </block>\n    <block type="math_single">\n      <field name="OP">ROOT</field>\n      <value name="NUM">\n        <shadow type="math_number">\n          <field name="NUM">9</field>\n        </shadow>\n      </value>\n    </block>\n    <block type="math_trig">\n      <field name="OP">SIN</field>\n      <value name="NUM">\n        <shadow type="math_number">\n          <field name="NUM">45</field>\n        </shadow>\n      </value>\n    </block>\n    <block type="math_constant">\n      <field name="CONSTANT">PI</field>\n    </block>\n    <block type="math_number_property">\n      <mutation divisor_input="false"></mutation>\n      <field name="PROPERTY">EVEN</field>\n      <value name="NUMBER_TO_CHECK">\n        <shadow type="math_number">\n          <field name="NUM">0</field>\n        </shadow>\n      </value>\n    </block>\n    <block type="math_round">\n      <field name="OP">ROUND</field>\n      <value name="NUM">\n        <shadow type="math_number">\n          <field name="NUM">3.1</field>\n        </shadow>\n      </value>\n    </block>\n    <block type="math_on_list">\n      <mutation op="SUM"></mutation>\n      <field name="OP">SUM</field>\n    </block>\n    <block type="math_modulo">\n      <value name="DIVIDEND">\n        <shadow type="math_number">\n          <field name="NUM">64</field>\n        </shadow>\n      </value>\n      <value name="DIVISOR">\n        <shadow type="math_number">\n          <field name="NUM">10</field>\n        </shadow>\n      </value>\n    </block>\n    <block type="math_constrain">\n      <value name="VALUE">\n        <shadow type="math_number">\n          <field name="NUM">50</field>\n        </shadow>\n      </value>\n      <value name="LOW">\n        <shadow type="math_number">\n          <field name="NUM">1</field>\n        </shadow>\n      </value>\n      <value name="HIGH">\n        <shadow type="math_number">\n          <field name="NUM">100</field>\n        </shadow>\n      </value>\n    </block>\n    <block type="math_random_int">\n      <value name="FROM">\n        <shadow type="math_number">\n          <field name="NUM">1</field>\n        </shadow>\n      </value>\n      <value name="TO">\n        <shadow type="math_number">\n          <field name="NUM">100</field>\n        </shadow>\n      </value>\n    </block>\n    <block type="math_random_float"></block>\n    <block type="deg_to_rad">\n      <value name="degree_value">\n        <shadow type="math_number">\n          <field name="NUM">180</field>\n        </shadow>\n      </value>\n    </block>\n    <block type="rad_to_deg">\n      <value name="radian_value">\n        <shadow type="math_number">\n          <field name="NUM">3.14</field>\n        </shadow>\n      </value>\n    </block>\n    <block type="math_atan2">\n      <value name="x">\n        <shadow type="math_number">\n          <field name="NUM">10</field>\n        </shadow>\n      </value>\n      <value name="y">\n        <shadow type="math_number">\n          <field name="NUM">10</field>\n        </shadow>\n      </value>\n    </block>\n    <block type="math_distance">\n      <value name="a_x">\n        <shadow type="math_number">\n          <field name="NUM">0</field>\n        </shadow>\n      </value>\n      <value name="a_y">\n        <shadow type="math_number">\n          <field name="NUM">0</field>\n        </shadow>\n      </value>\n      <value name="b_x">\n        <shadow type="math_number">\n          <field name="NUM">10</field>\n        </shadow>\n      </value>\n      <value name="b_y">\n        <shadow type="math_number">\n          <field name="NUM">10</field>\n        </shadow>\n      </value>\n    </block>\n  </category>\n  <category name="Lists" colour="#745ba5">\n    <block type="lists_create_with">\n      <mutation items="0"></mutation>\n    </block>\n    <block type="lists_create_with">\n      <mutation items="3"></mutation>\n    </block>\n    <block type="lists_repeat">\n      <value name="NUM">\n        <shadow type="math_number">\n          <field name="NUM">5</field>\n        </shadow>\n      </value>\n    </block>\n    <block type="lists_length"></block>\n    <block type="lists_isEmpty"></block>\n    <block type="lists_indexOf">\n      <field name="END">FIRST</field>\n      <value name="VALUE">\n        <block type="variables_get">\n          <mutation playerid_input="false" show_dropdown="true"></mutation>\n          <field name="VAR" id="OHL[BKPS.tSBl273}]t$">list</field>\n        </block>\n      </value>\n    </block>\n    <block type="lists_getIndex">\n      <mutation statement="false" at="true"></mutation>\n      <field name="MODE">GET</field>\n      <field name="WHERE">FROM_START</field>\n      <value name="VALUE">\n        <block type="variables_get">\n          <mutation playerid_input="false" show_dropdown="true"></mutation>\n          <field name="VAR" id="OHL[BKPS.tSBl273}]t$">list</field>\n        </block>\n      </value>\n    </block>\n    <block type="lists_setIndex">\n      <mutation at="true"></mutation>\n      <field name="MODE">SET</field>\n      <field name="WHERE">FROM_START</field>\n      <value name="LIST">\n        <block type="variables_get">\n          <mutation playerid_input="false" show_dropdown="true"></mutation>\n          <field name="VAR" id="OHL[BKPS.tSBl273}]t$">list</field>\n        </block>\n      </value>\n    </block>\n    <block type="lists_getSublist">\n      <mutation at1="true" at2="true"></mutation>\n      <field name="WHERE1">FROM_START</field>\n      <field name="WHERE2">FROM_START</field>\n      <value name="LIST">\n        <block type="variables_get">\n          <mutation playerid_input="false" show_dropdown="true"></mutation>\n          <field name="VAR" id="OHL[BKPS.tSBl273}]t$">list</field>\n        </block>\n      </value>\n    </block>\n    <block type="lists_split">\n      <mutation mode="SPLIT"></mutation>\n      <field name="MODE">SPLIT</field>\n      <value name="DELIM">\n        <shadow type="text">\n          <field name="TEXT">,</field>\n        </shadow>\n      </value>\n    </block>\n    <block type="lists_sort">\n      <field name="TYPE">NUMERIC</field>\n      <field name="DIRECTION">1</field>\n    </block>\n  </category>\n  <category name="Text" colour="#5ba58c">\n    <block type="text">\n      <field name="TEXT"></field>\n    </block>\n    <block type="text_join">\n      <mutation items="2"></mutation>\n    </block>\n    <block type="text_append">\n      <field name="VAR" id=")?E@rk:Ve@UsZ3VblUrR">item</field>\n      <value name="TEXT">\n        <shadow type="text">\n          <field name="TEXT"></field>\n        </shadow>\n      </value>\n    </block>\n    <block type="text_length">\n      <value name="VALUE">\n        <shadow type="text">\n          <field name="TEXT">abc</field>\n        </shadow>\n      </value>\n    </block>\n    <block type="text_isEmpty">\n      <value name="VALUE">\n        <shadow type="text">\n          <field name="TEXT"></field>\n        </shadow>\n      </value>\n    </block>\n    <block type="text_indexOf">\n      <field name="END">FIRST</field>\n      <value name="VALUE">\n        <block type="variables_get">\n          <mutation playerid_input="false" show_dropdown="true"></mutation>\n          <field name="VAR" id="BM=;WeRTa{JMwH|%:(Zf">text</field>\n        </block>\n      </value>\n      <value name="FIND">\n        <shadow type="text">\n          <field name="TEXT">abc</field>\n        </shadow>\n      </value>\n    </block>\n    <block type="text_charAt">\n      <mutation at="true"></mutation>\n      <field name="WHERE">FROM_START</field>\n      <value name="VALUE">\n        <block type="variables_get">\n          <field name="VAR" id="BM=;WeRTa{JMwH|%:(Zf">text</field>\n          <mutation playerid_input="false" show_dropdown="true"></mutation>\n        </block>\n      </value>\n    </block>\n    <block type="text_getSubstring">\n      <mutation at1="true" at2="true"></mutation>\n      <field name="WHERE1">FROM_START</field>\n      <field name="WHERE2">FROM_START</field>\n      <value name="STRING">\n        <block type="variables_get">\n          <field name="VAR" id="BM=;WeRTa{JMwH|%:(Zf">text</field>\n          <mutation playerid_input="false" show_dropdown="true"></mutation>\n        </block>\n      </value>\n    </block>\n    <block type="text_changeCase">\n      <field name="CASE">UPPERCASE</field>\n      <value name="TEXT">\n        <shadow type="text">\n          <field name="TEXT">abc</field>\n        </shadow>\n      </value>\n    </block>\n    <block type="text_trim">\n      <field name="MODE">BOTH</field>\n      <value name="TEXT">\n        <shadow type="text">\n          <field name="TEXT">abc</field>\n        </shadow>\n      </value>\n    </block>\n  </category>\n  <category name="Colour" colour="#a5745b">\n    <block type="colour_picker">\n      <field name="COLOUR">#ff0000</field>\n    </block>\n    <block type="colour_hex">\n      <value name="hex_code">\n        <shadow type="text">\n          <field name="TEXT">FF0000</field>\n        </shadow>\n      </value>\n    </block>\n    <block type="colour_random"></block>\n    <block type="colour_rgb">\n      <value name="RED">\n        <shadow type="math_number">\n          <field name="NUM">100</field>\n        </shadow>\n      </value>\n      <value name="GREEN">\n        <shadow type="math_number">\n          <field name="NUM">50</field>\n        </shadow>\n      </value>\n      <value name="BLUE">\n        <shadow type="math_number">\n          <field name="NUM">0</field>\n        </shadow>\n      </value>\n    </block>\n    <block type="colour_blend">\n      <value name="COLOUR1">\n        <shadow type="colour_picker">\n          <field name="COLOUR">#ff0000</field>\n        </shadow>\n      </value>\n      <value name="COLOUR2">\n        <shadow type="colour_picker">\n          <field name="COLOUR">#3333ff</field>\n        </shadow>\n      </value>\n      <value name="RATIO">\n        <shadow type="math_number">\n          <field name="NUM">0.5</field>\n        </shadow>\n      </value>\n    </block>\n  </category>\n  <sep></sep>\n  <category name="Variables" colour="#a55b80" custom="VARIABLE"></category>\n  <category name="Functions" colour="#995ba5" custom="PROCEDURE"></category>\n  <sep></sep>\n  <category name="Bonk Events" colour="#a5745b">\n    <block type="on_round_start"></block>\n    <block type="on_each_phys_frame"></block>\n    <block type="on_each_render_frame"></block>\n    <block type="on_player_die"></block>\n    <block type="on_player_collide">\n      <field name="collide_type">collide_player</field>\n      <field name="return_info">FALSE</field>\n      <field name="player_id" id="0YRMwNZi;j8;w+8P%,=/">hit player id</field>\n      <field name="arrow_id" id="n`,#/rH4N9zK3kN%kqf;">hit arrow number</field>\n      <field name="platform_id" id=":SJf9G~6AmE3!:UU}OmF">hit platform id</field>\n      <field name="normal_x" id="_eo=O8;[pMsW1Ays:dqa">hit normal x</field>\n      <field name="normal_y" id="Wg5!le%r1|G4{=IH{Gyq">hit normal y</field>\n    </block>\n    <block type="on_arrow_collide">\n      <field name="collide_type">collide_player</field>\n      <field name="return_info">FALSE</field>\n      <field name="self_arrow_id" id="vc=L=v@m=U6zy=gd!ABw">own arrow number</field>\n      <field name="player_id" id="0YRMwNZi;j8;w+8P%,=/">hit player id</field>\n      <field name="arrow_id" id="n`,#/rH4N9zK3kN%kqf;">hit arrow number</field>\n      <field name="platform_id" id=":SJf9G~6AmE3!:UU}OmF">hit platform id</field>\n      <field name="normal_x" id="_eo=O8;[pMsW1Ays:dqa">hit normal x</field>\n      <field name="normal_y" id="Wg5!le%r1|G4{=IH{Gyq">hit normal y</field>\n    </block>\n    <block type="on_platform_collide">\n      <field name="collide_type">collide_player</field>\n      <field name="return_info">FALSE</field>\n      <field name="self_platform_id" id="V6vQ,J11COF*;i]GkIlj">own platform id</field>\n      <field name="player_id" id="0YRMwNZi;j8;w+8P%,=/">hit player id</field>\n      <field name="arrow_id" id="n`,#/rH4N9zK3kN%kqf;">hit arrow number</field>\n      <field name="platform_id" id=":SJf9G~6AmE3!:UU}OmF">hit platform id</field>\n      <field name="normal_x" id="_eo=O8;[pMsW1Ays:dqa">hit normal x</field>\n      <field name="normal_y" id="Wg5!le%r1|G4{=IH{Gyq">hit normal y</field>\n    </block>\n  </category>\n  <category name="Map Objects" colour="#5b80a5">\n    <block type="get_map_size"></block>\n    <block type="get_platform_order"></block>\n    <block type="get_platform_by_name">\n      <value name="platform_name">\n        <shadow type="text">\n          <field name="TEXT">platform</field>\n        </shadow>\n      </value>\n    </block>\n    <block type="get_platform_name">\n      <value name="platform_id">\n        <shadow type="math_number">\n          <field name="NUM">0</field>\n        </shadow>\n      </value>\n    </block>\n    <block type="raycast">\n      <field name="collide_a">TRUE</field>\n      <field name="collide_b">TRUE</field>\n      <field name="collide_c">TRUE</field>\n      <field name="collide_d">TRUE</field>\n      <field name="collide_player">FALSE</field>\n      <field name="point_x" id="d~|`8[0U:G4^,mAO:SDY">hit point x</field>\n      <field name="point_y" id="M;q2y5Pmh-ax72@!1IZ7">hit point y</field>\n      <field name="normal_x" id="MnUZ%.[qb*QxyBjN!1[w">hit normal x</field>\n      <field name="normal_y" id="5=tEmDRp@!~p-ywup)ow">hit normal y</field>\n      <value name="a_x">\n        <shadow type="math_number">\n          <field name="NUM">0</field>\n        </shadow>\n      </value>\n      <value name="a_y">\n        <shadow type="math_number">\n          <field name="NUM">0</field>\n        </shadow>\n      </value>\n      <value name="b_x">\n        <shadow type="math_number">\n          <field name="NUM">10</field>\n        </shadow>\n      </value>\n      <value name="b_y">\n        <shadow type="math_number">\n          <field name="NUM">10</field>\n        </shadow>\n      </value>\n    </block>\n    <block type="set_platform_prop">\n      <field name="platform_prop">p_x</field>\n      <value name="platform_id">\n        <shadow type="math_number">\n          <field name="NUM">0</field>\n        </shadow>\n      </value>\n      <value name="set_value">\n        <shadow type="math_number">\n          <field name="NUM">0</field>\n        </shadow>\n      </value>\n    </block>\n    <block type="change_platform_prop">\n      <field name="platform_prop">p_x</field>\n      <value name="platform_id">\n        <shadow type="math_number">\n          <field name="NUM">0</field>\n        </shadow>\n      </value>\n      <value name="change_value">\n        <shadow type="math_number">\n          <field name="NUM">0</field>\n        </shadow>\n      </value>\n    </block>\n    <block type="get_platform_prop">\n      <field name="platform_prop">p_x</field>\n      <value name="platform_id">\n        <shadow type="math_number">\n          <field name="NUM">0</field>\n        </shadow>\n      </value>\n    </block>\n    <block type="set_shape_prop">\n      <field name="shape_prop">s_c_x</field>\n      <value name="platform_id">\n        <shadow type="math_number">\n          <field name="NUM">0</field>\n        </shadow>\n      </value>\n      <value name="shape_id">\n        <shadow type="math_number">\n          <field name="NUM">1</field>\n        </shadow>\n      </value>\n      <value name="set_value">\n        <shadow type="math_number">\n          <field name="NUM">0</field>\n        </shadow>\n      </value>\n    </block>\n    <block type="change_shape_prop">\n      <field name="shape_prop">s_c_x</field>\n      <value name="platform_id">\n        <shadow type="math_number">\n          <field name="NUM">0</field>\n        </shadow>\n      </value>\n      <value name="shape_id">\n        <shadow type="math_number">\n          <field name="NUM">1</field>\n        </shadow>\n      </value>\n      <value name="change_value">\n        <shadow type="math_number">\n          <field name="NUM">1</field>\n        </shadow>\n      </value>\n    </block>\n    <block type="get_shape_prop">\n      <field name="shape_prop">s_c_x</field>\n      <value name="platform_id">\n        <shadow type="math_number">\n          <field name="NUM">0</field>\n        </shadow>\n      </value>\n      <value name="shape_id">\n        <shadow type="math_number">\n          <field name="NUM">1</field>\n        </shadow>\n      </value>\n    </block>\n    <block type="get_shape_amount">\n      <value name="platform_id">\n        <shadow type="math_number">\n          <field name="NUM">0</field>\n        </shadow>\n      </value>\n    </block>\n    <block type="delete_platform">\n      <value name="platform_id">\n        <shadow type="math_number">\n          <field name="NUM">0</field>\n        </shadow>\n      </value>\n    </block>\n    <block type="delete_shape">\n      <value name="platform_id">\n        <shadow type="math_number">\n          <field name="NUM">0</field>\n        </shadow>\n      </value>\n      <value name="shape_id">\n        <shadow type="math_number">\n          <field name="NUM">1</field>\n        </shadow>\n      </value>\n    </block>\n    <block type="add_shape">\n      <value name="shape">\n        <shadow type="rectangle_shape">\n          <field name="nophys">FALSE</field>\n          <field name="nograp">FALSE</field>\n          <field name="ingrap">FALSE</field>\n          <field name="death">FALSE</field>\n          <value name="color">\n            <shadow type="colour_picker">\n              <field name="COLOUR">#ff0000</field>\n            </shadow>\n          </value>\n          <value name="xpos">\n            <shadow type="math_number">\n              <field name="NUM">0</field>\n            </shadow>\n          </value>\n          <value name="ypos">\n            <shadow type="math_number">\n              <field name="NUM">0</field>\n            </shadow>\n          </value>\n          <value name="width">\n            <shadow type="math_number">\n              <field name="NUM">5</field>\n            </shadow>\n          </value>\n          <value name="height">\n            <shadow type="math_number">\n              <field name="NUM">2</field>\n            </shadow>\n          </value>\n          <value name="angle">\n            <shadow type="math_number">\n              <field name="NUM">0</field>\n            </shadow>\n          </value>\n        </shadow>\n      </value>\n      <value name="platform_id">\n        <shadow type="math_number">\n          <field name="NUM">0</field>\n        </shadow>\n      </value>\n    </block>\n    <block type="clone_platform">\n      <value name="platform_id">\n        <shadow type="math_number">\n          <field name="NUM">0</field>\n        </shadow>\n      </value>\n      <field name="return_id">FALSE</field>\n    </block>\n    <block type="create_platform">\n      <field name="return_id">FALSE</field>\n      <field name="type">s</field>\n      <field name="colgroup">1</field>\n      <field name="colplayers">TRUE</field>\n      <field name="cola">TRUE</field>\n      <field name="colb">TRUE</field>\n      <field name="colc">TRUE</field>\n      <field name="cold">TRUE</field>\n      <value name="shape_list">\n        <block type="lists_create_with">\n          <mutation items="1"></mutation>\n          <value name="ADD0">\n            <shadow type="rectangle_shape">\n              <field name="nophys">FALSE</field>\n              <field name="nograp">FALSE</field>\n              <field name="ingrap">FALSE</field>\n              <field name="death">FALSE</field>\n              <value name="color">\n                <shadow type="colour_picker">\n                  <field name="COLOUR">#ff0000</field>\n                </shadow>\n              </value>\n              <value name="xpos">\n                <shadow type="math_number">\n                  <field name="NUM">0</field>\n                </shadow>\n              </value>\n              <value name="ypos">\n                <shadow type="math_number">\n                  <field name="NUM">0</field>\n                </shadow>\n              </value>\n              <value name="width">\n                <shadow type="math_number">\n                  <field name="NUM">5</field>\n                </shadow>\n              </value>\n              <value name="height">\n                <shadow type="math_number">\n                  <field name="NUM">2</field>\n                </shadow>\n              </value>\n              <value name="angle">\n                <shadow type="math_number">\n                  <field name="NUM">0</field>\n                </shadow>\n              </value>\n            </shadow>\n          </value>\n        </block>\n        <shadow type="lists_create_with">\n          <mutation items="1"></mutation>\n          <value name="ADD0">\n            <shadow type="rectangle_shape">\n              <field name="nophys">FALSE</field>\n              <field name="nograp">FALSE</field>\n              <field name="ingrap">FALSE</field>\n              <field name="death">FALSE</field>\n              <value name="color">\n                <shadow type="colour_picker">\n                  <field name="COLOUR">#ff0000</field>\n                </shadow>\n              </value>\n              <value name="xpos">\n                <shadow type="math_number">\n                  <field name="NUM">0</field>\n                </shadow>\n              </value>\n              <value name="ypos">\n                <shadow type="math_number">\n                  <field name="NUM">0</field>\n                </shadow>\n              </value>\n              <value name="width">\n                <shadow type="math_number">\n                  <field name="NUM">5</field>\n                </shadow>\n              </value>\n              <value name="height">\n                <shadow type="math_number">\n                  <field name="NUM">2</field>\n                </shadow>\n              </value>\n              <value name="angle">\n                <shadow type="math_number">\n                  <field name="NUM">0</field>\n                </shadow>\n              </value>\n            </shadow>\n          </value>\n        </shadow>\n      </value>\n      <value name="xpos">\n        <shadow type="math_number">\n          <field name="NUM">0</field>\n        </shadow>\n      </value>\n      <value name="ypos">\n        <shadow type="math_number">\n          <field name="NUM">0</field>\n        </shadow>\n      </value>\n      <value name="angle">\n        <shadow type="math_number">\n          <field name="NUM">0</field>\n        </shadow>\n      </value>\n      <value name="bounciness">\n        <shadow type="math_number">\n          <field name="NUM">0.8</field>\n        </shadow>\n      </value>\n      <value name="density">\n        <shadow type="math_number">\n          <field name="NUM">0.3</field>\n        </shadow>\n      </value>\n      <value name="friction">\n        <shadow type="math_number">\n          <field name="NUM">0.5</field>\n        </shadow>\n      </value>\n      <value name="fricp">\n        <shadow type="logic_boolean">\n          <field name="BOOL">FALSE</field>\n        </shadow>\n      </value>\n    </block>\n    <block type="rectangle_shape">\n      <field name="nophys">FALSE</field>\n      <field name="nograp">FALSE</field>\n      <field name="ingrap">FALSE</field>\n      <field name="death">FALSE</field>\n      <value name="color">\n        <shadow type="colour_picker">\n          <field name="COLOUR">#ff0000</field>\n        </shadow>\n      </value>\n      <value name="xpos">\n        <shadow type="math_number">\n          <field name="NUM">0</field>\n        </shadow>\n      </value>\n      <value name="ypos">\n        <shadow type="math_number">\n          <field name="NUM">0</field>\n        </shadow>\n      </value>\n      <value name="width">\n        <shadow type="math_number">\n          <field name="NUM">5</field>\n        </shadow>\n      </value>\n      <value name="height">\n        <shadow type="math_number">\n          <field name="NUM">2</field>\n        </shadow>\n      </value>\n      <value name="angle">\n        <shadow type="math_number">\n          <field name="NUM">0</field>\n        </shadow>\n      </value>\n    </block>\n    <block type="circle_shape">\n      <field name="nophys">FALSE</field>\n      <field name="nograp">FALSE</field>\n      <field name="ingrap">FALSE</field>\n      <field name="death">FALSE</field>\n      <value name="color">\n        <shadow type="colour_picker">\n          <field name="COLOUR">#ff0000</field>\n        </shadow>\n      </value>\n      <value name="xpos">\n        <shadow type="math_number">\n          <field name="NUM">0</field>\n        </shadow>\n      </value>\n      <value name="ypos">\n        <shadow type="math_number">\n          <field name="NUM">0</field>\n        </shadow>\n      </value>\n      <value name="radius">\n        <shadow type="math_number">\n          <field name="NUM">5</field>\n        </shadow>\n      </value>\n    </block>\n    <block type="polygon_shape">\n      <field name="nophys">FALSE</field>\n      <field name="nograp">FALSE</field>\n      <field name="ingrap">FALSE</field>\n      <field name="death">FALSE</field>\n      <value name="color">\n        <shadow type="colour_picker">\n          <field name="COLOUR">#ff0000</field>\n        </shadow>\n      </value>\n      <value name="xpos">\n        <shadow type="math_number">\n          <field name="NUM">0</field>\n        </shadow>\n      </value>\n      <value name="ypos">\n        <shadow type="math_number">\n          <field name="NUM">0</field>\n        </shadow>\n      </value>\n      <value name="vertex">\n        <shadow type="lists_create_with">\n          <mutation items="6"></mutation>\n          <value name="ADD0">\n            <shadow type="math_number">\n              <field name="NUM">0</field>\n            </shadow>\n          </value>\n          <value name="ADD1">\n            <shadow type="math_number">\n              <field name="NUM">0</field>\n            </shadow>\n          </value>\n          <value name="ADD2">\n            <shadow type="math_number">\n              <field name="NUM">10</field>\n            </shadow>\n          </value>\n          <value name="ADD3">\n            <shadow type="math_number">\n              <field name="NUM">0</field>\n            </shadow>\n          </value>\n          <value name="ADD4">\n            <shadow type="math_number">\n              <field name="NUM">0</field>\n            </shadow>\n          </value>\n          <value name="ADD5">\n            <shadow type="math_number">\n              <field name="NUM">10</field>\n            </shadow>\n          </value>\n        </shadow>\n      </value>\n      <value name="angle">\n        <shadow type="math_number">\n          <field name="NUM">0</field>\n        </shadow>\n      </value>\n      <value name="scale">\n        <shadow type="math_number">\n          <field name="NUM">1</field>\n        </shadow>\n      </value>\n    </block>\n  </category>\n  <category name="Players &amp; Arrows" colour="#5b67a5">\n    <block type="set_player_prop">\n      <field name="player">self</field>\n      <field name="player_prop">x</field>\n      <value name="set_number">\n        <shadow type="math_number">\n          <field name="NUM">0</field>\n        </shadow>\n      </value>\n    </block>\n    <block type="change_player_prop">\n      <field name="player">self</field>\n      <field name="player_prop">x</field>\n      <value name="change_number">\n        <shadow type="math_number">\n          <field name="NUM">10</field>\n        </shadow>\n      </value>\n    </block>\n    <block type="get_player_prop">\n      <field name="player">self</field>\n      <field name="property">x</field>\n    </block>\n    <block type="set_last_arrow_prop">\n      <field name="player">self</field>\n      <field name="arrow">last</field>\n      <field name="arrow_prop">x</field>\n      <value name="set_number">\n        <shadow type="math_number">\n          <field name="NUM">0</field>\n        </shadow>\n      </value>\n    </block>\n    <block type="change_last_arrow_prop">\n      <field name="player">self</field>\n      <field name="arrow">last</field>\n      <field name="arrow_prop">x</field>\n      <value name="change_number">\n        <shadow type="math_number">\n          <field name="NUM">10</field>\n        </shadow>\n      </value>\n    </block>\n    <block type="get_last_arrow_prop">\n      <field name="player">self</field>\n      <field name="arrow">last</field>\n      <field name="property">x</field>\n    </block>\n    <block type="pressing_key">\n      <field name="player">self</field>\n      <field name="key">up</field>\n    </block>\n    <block type="input_override">\n      <field name="player">self</field>\n      <field name="key">up</field>\n      <value name="override_value">\n        <shadow type="logic_boolean">\n          <field name="BOOL">FALSE</field>\n        </shadow>\n      </value>\n    </block>\n    <block type="stop_input_override">\n      <field name="player">self</field>\n      <field name="key">up</field>\n    </block>\n    <block type="create_arrow">\n      <value name="arrow_xpos">\n        <shadow type="math_number">\n          <field name="NUM">50</field>\n        </shadow>\n      </value>\n      <value name="arrow_ypos">\n        <shadow type="math_number">\n          <field name="NUM">20</field>\n        </shadow>\n      </value>\n      <value name="arrow_xvel">\n        <shadow type="math_number">\n          <field name="NUM">10</field>\n        </shadow>\n      </value>\n      <value name="arrow_yvel">\n        <shadow type="math_number">\n          <field name="NUM">0</field>\n        </shadow>\n      </value>\n      <value name="arrow_angle">\n        <shadow type="math_number">\n          <field name="NUM">90</field>\n        </shadow>\n      </value>\n      <value name="arrow_time">\n        <shadow type="math_number">\n          <field name="NUM">150</field>\n        </shadow>\n      </value>\n    </block>\n    <block type="get_own_id"></block>\n    <block type="get_player_id_list"></block>\n    <block type="player_on_team">\n      <field name="player">self</field>\n      <field name="team">2</field>\n    </block>\n    <block type="get_arrow_amount">\n      <field name="player">self</field>\n    </block>\n    <block type="delete_arrows">\n      <field name="player">self</field>\n      <field name="arrow">all</field>\n    </block>\n    <block type="player_die">\n      <field name="player">self</field>\n    </block>\n  </category>\n  <category name="Drawing" colour="#5ba58c">\n    <block type="draw_clear"></block>\n    <block type="get_screen_prop">\n      <field name="screen_prop">width</field>\n    </block>\n    <block type="get_player_color">\n      <field name="player">self</field>\n    </block>\n    <block type="get_player_name">\n      <field name="player">self</field>\n    </block>\n    <block type="draw_line">\n      <field name="line_anchored">FALSE</field>\n      <value name="line_x1">\n        <shadow type="math_number">\n          <field name="NUM">0</field>\n        </shadow>\n      </value>\n      <value name="line_y1">\n        <shadow type="math_number">\n          <field name="NUM">0</field>\n        </shadow>\n      </value>\n      <value name="line_x2">\n        <shadow type="math_number">\n          <field name="NUM">5</field>\n        </shadow>\n      </value>\n      <value name="line_y2">\n        <shadow type="math_number">\n          <field name="NUM">5</field>\n        </shadow>\n      </value>\n      <value name="line_width">\n        <shadow type="math_number">\n          <field name="NUM">1</field>\n        </shadow>\n      </value>\n      <value name="line_color">\n        <shadow type="colour_picker">\n          <field name="COLOUR">#ff0000</field>\n        </shadow>\n      </value>\n      <value name="line_alpha">\n        <shadow type="math_number">\n          <field name="NUM">100</field>\n        </shadow>\n      </value>\n    </block>\n    <block type="draw_rect">\n      <field name="rect_anchored">FALSE</field>\n      <value name="rect_x1">\n        <shadow type="math_number">\n          <field name="NUM">0</field>\n        </shadow>\n      </value>\n      <value name="rect_y1">\n        <shadow type="math_number">\n          <field name="NUM">0</field>\n        </shadow>\n      </value>\n      <value name="rect_x2">\n        <shadow type="math_number">\n          <field name="NUM">5</field>\n        </shadow>\n      </value>\n      <value name="rect_y2">\n        <shadow type="math_number">\n          <field name="NUM">5</field>\n        </shadow>\n      </value>\n      <value name="rect_angle">\n        <shadow type="math_number">\n          <field name="NUM">0</field>\n        </shadow>\n      </value>\n      <value name="rect_color">\n        <shadow type="colour_picker">\n          <field name="COLOUR">#ff0000</field>\n        </shadow>\n      </value>\n      <value name="rect_alpha">\n        <shadow type="math_number">\n          <field name="NUM">100</field>\n        </shadow>\n      </value>\n    </block>\n    <block type="draw_circle">\n      <field name="circ_anchored">FALSE</field>\n      <value name="circ_x">\n        <shadow type="math_number">\n          <field name="NUM">0</field>\n        </shadow>\n      </value>\n      <value name="circ_y">\n        <shadow type="math_number">\n          <field name="NUM">0</field>\n        </shadow>\n      </value>\n      <value name="circ_radius">\n        <shadow type="math_number">\n          <field name="NUM">5</field>\n        </shadow>\n      </value>\n      <value name="circ_color">\n        <shadow type="colour_picker">\n          <field name="COLOUR">#ff0000</field>\n        </shadow>\n      </value>\n      <value name="circ_alpha">\n        <shadow type="math_number">\n          <field name="NUM">100</field>\n        </shadow>\n      </value>\n    </block>\n    <block type="draw_poly">\n      <field name="poly_anchored">FALSE</field>\n      <value name="poly_vertex">\n        <shadow type="lists_create_with">\n          <mutation items="8"></mutation>\n          <value name="ADD0">\n            <shadow type="math_number">\n              <field name="NUM">5</field>\n            </shadow>\n          </value>\n          <value name="ADD1">\n            <shadow type="math_number">\n              <field name="NUM">0</field>\n            </shadow>\n          </value>\n          <value name="ADD2">\n            <shadow type="math_number">\n              <field name="NUM">10</field>\n            </shadow>\n          </value>\n          <value name="ADD3">\n            <shadow type="math_number">\n              <field name="NUM">0</field>\n            </shadow>\n          </value>\n          <value name="ADD4">\n            <shadow type="math_number">\n              <field name="NUM">5</field>\n            </shadow>\n          </value>\n          <value name="ADD5">\n            <shadow type="math_number">\n              <field name="NUM">3</field>\n            </shadow>\n          </value>\n          <value name="ADD6">\n            <shadow type="math_number">\n              <field name="NUM">0</field>\n            </shadow>\n          </value>\n          <value name="ADD7">\n            <shadow type="math_number">\n              <field name="NUM">3</field>\n            </shadow>\n          </value>\n        </shadow>\n      </value>\n      <value name="poly_color">\n        <shadow type="colour_picker">\n          <field name="COLOUR">#ff0000</field>\n        </shadow>\n      </value>\n      <value name="poly_alpha">\n        <shadow type="math_number">\n          <field name="NUM">100</field>\n        </shadow>\n      </value>\n    </block>\n    <block type="draw_text">\n      <field name="text_centered">FALSE</field>\n      <field name="text_anchored">FALSE</field>\n      <value name="text_string">\n        <shadow type="text">\n          <field name="TEXT">Hello!</field>\n        </shadow>\n      </value>\n      <value name="text_x">\n        <shadow type="math_number">\n          <field name="NUM">0</field>\n        </shadow>\n      </value>\n      <value name="text_y">\n        <shadow type="math_number">\n          <field name="NUM">0</field>\n        </shadow>\n      </value>\n      <value name="text_size">\n        <shadow type="math_number">\n          <field name="NUM">1</field>\n        </shadow>\n      </value>\n      <value name="text_color">\n        <shadow type="colour_picker">\n          <field name="COLOUR">#ff0000</field>\n        </shadow>\n      </value>\n      <value name="text_alpha">\n        <shadow type="math_number">\n          <field name="NUM">100</field>\n        </shadow>\n      </value>\n    </block>\n  </category>\n  <category name="Misc" colour="#a55b5b">\n    <block type="play_sound">\n      <value name="sound_volume">\n        <shadow type="math_number">\n          <field name="NUM">0.5</field>\n        </shadow>\n      </value>\n      <field name="pan_type">const</field>\n      <value name="sound_pan">\n        <shadow type="math_number">\n          <field name="NUM">0</field>\n        </shadow>\n      </value>\n    </block>\n    <block type="play_sound">\n      <value name="sound_volume">\n        <shadow type="math_number">\n          <field name="NUM">0.5</field>\n        </shadow>\n      </value>\n      <field name="pan_type">world</field>\n      <value name="sound_pan">\n        <shadow type="math_number">\n          <field name="NUM">0</field>\n        </shadow>\n        <block type="get_player_prop">\n          <field name="player">self</field>\n          <field name="property">x</field>\n        </block>\n      </value>\n    </block>\n    <block type="set_camera_prop">\n      <field name="player">self</field>\n      <field name="camera_prop">xpos</field>\n      <value name="set_number">\n        <shadow type="math_number">\n          <field name="NUM">0</field>\n        </shadow>\n      </value>\n    </block>\n    <block type="change_camera_prop">\n      <field name="player">self</field>\n      <field name="camera_prop">xpos</field>\n      <value name="change_number">\n        <shadow type="math_number">\n          <field name="NUM">10</field>\n        </shadow>\n      </value>\n    </block>\n    <block type="get_camera_prop">\n      <field name="player">self</field>\n      <field name="camera_prop">xpos</field>\n    </block>\n    <block type="change_camera_lerp">\n      <field name="player">self</field>\n      <field name="enable">false</field>\n    </block>\n    <block type="change_death_barrier">\n      <field name="enable">false</field>\n    </block>\n  </category>\n</xml>'},5026:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});const __WEBPACK_DEFAULT_EXPORT__='<div id="gmeditor">\n    <div id="gmeditorwindow">\n        <div class="windowTopBar windowTopBar_classic">Game Mode Editor</div>\n        <div id="gmeditor_buttoncontainer">\n            <div id="gmeditor_leftbuttons">\n                <div id="gmeditor_newbutton" title="New" class="brownButton brownButton_classic buttonShadow gmeditor_iconbutton"></div>\n                <div id="gmeditor_importbutton" title="Import" class="brownButton brownButton_classic buttonShadow gmeditor_iconbutton"></div>\n                <div id="gmeditor_exportbutton" title="Export" class="brownButton brownButton_classic buttonShadow gmeditor_iconbutton"></div>\n                <div id="gmeditor_backupsbutton" title="Load backup" class="brownButton brownButton_classic buttonShadow gmeditor_iconbutton"></div>\n            </div>\n            <div id="gmeditor_helptext">\n                Feeling lost? Hover over a block to get a brief description of what it does.\n            </div>\n            <div id="gmeditor_rightbuttons">\n                <div id="gmeditor_settingsbutton" title="Mode settings" class="brownButton brownButton_classic buttonShadow gmeditor_iconbutton"></div>\n                <div id="gmeditor_closebutton" title="Close" class="brownButton brownButton_classic buttonShadow gmeditor_iconbutton"></div>\n                <div id="gmeditor_savebutton" title="Apply and close" class="brownButton brownButton_classic buttonShadow gmeditor_iconbutton"></div>\n                \n            </div>\n        </div>\n        <div id="gmblocklyarea"></div>\n    </div>\n</div>\n<div id="gm_backupswindowcontainer" class="gm_dialogwindowcontainer">\n    <div class="gm_behindblocker"></div>\n    <div class="gm_dialogwindow" class="windowShadow">\n        <div class="gm_dialogtopbar">Mode Backups</div>\n        <div class="gm_dialogoptions">\n            <label for="gmbackups_backupselect">Backup to load:</label>\n            <select id="gmbackups_backupselect">\n            </select>\n        </div>\n\n        <div class="gm_dialogbuttoncontainer">\n            <div id="gmbackups_cancel" class="brownButton brownButton_classic buttonShadow">CANCEL</div>\n            <div id="gmbackups_load" class="brownButton brownButton_classic buttonShadow">LOAD</div>\n        </div>\n    </div>\n</div>\n<div id="gm_settingswindowcontainer" class="gm_dialogwindowcontainer">\n    <div class="gm_behindblocker"></div>\n    <div class="gm_dialogwindow" class="windowShadow">\n        <div class="gm_dialogtopbar">Mode Settings</div>\n        <div class="gm_dialogoptions">\n            Mode name (12 characters max.)<br>\n            <input type="text" id="gmsettings_modename" class="whiteInputField windowShadow gm_dialogtextfield"\n                spellcheck="false" maxlength="12">\n            <br><br>\n            Mode description (500 characters max.)<br>\n            <textarea id="gmsettings_modedescription" style="height: 100px;" class="whiteInputField windowShadow gm_dialogtextfield"\n                spellcheck="false" maxlength="500"></textarea>\n            <br><br>\n            <label for="gmsettings_basemode">Base mode:</label>\n            <select id="gmsettings_basemode">\n                <option value="any">Any</option>\n            </select>\n            <br><br>\n            <input type="checkbox" id="gmsettings_showvarinsp"><label for="gmsettings_showvarinsp">Show variable inspector (for debugging)</label>\n        </div>\n\n        <div class="gm_dialogbuttoncontainer">\n            <div id="gmsettings_cancel" class="brownButton brownButton_classic buttonShadow">CANCEL</div>\n            <div id="gmsettings_save" class="brownButton brownButton_classic buttonShadow">SAVE</div>\n        </div>\n    </div>\n</div>\n<div id="gm_exportwindowcontainer" class="gm_dialogwindowcontainer">\n    <div class="gm_behindblocker"></div>\n    <div class="gm_dialogwindow" class="windowShadow">\n        <div class="gm_dialogtopbar">Mode Export</div>\n        <div class="gm_dialogoptions">\n            File name<br>\n            <input type="text" id="gmexport_name" value="export" class="whiteInputField windowShadow gm_dialogtextfield"\n                spellcheck="false">\n            <br><br>\n            <input type="checkbox" id="gmexport_attachmap"><label for="gmexport_attachmap">Attach current map</label>\n        </div>\n\n        <div class="gm_dialogbuttoncontainer">\n            <div id="gmexport_cancel" class="brownButton brownButton_classic buttonShadow">CANCEL</div>\n            <div id="gmexport_ok" class="brownButton brownButton_classic buttonShadow">EXPORT</div>\n        </div>\n    </div>\n</div>\n<div id="gm_importdialogwindowcontainer" class="gm_dialogwindowcontainer">\n    <div class="gm_behindblocker"></div>\n    <div class="gm_dialogwindow" class="windowShadow">\n        <div class="gm_dialogtopbar">Change map?</div>\n        <div class="gm_dialogtext">\n            The mode you imported has an attached map.\n            <br>\n            <br>\n            Do you want to load it?\n            <br>\n            (Note that the mode might not work without it.)\n        </div>\n\n        <div class="gm_dialogbuttoncontainer">\n            <div id="gmimportdialog_cancel" class="brownButton brownButton_classic buttonShadow">CANCEL</div>\n            <div id="gmimportdialog_no" class="brownButton brownButton_classic buttonShadow">NO</div>\n            <div id="gmimportdialog_yes" class="brownButton brownButton_classic buttonShadow">YES</div>\n        </div>\n    </div>\n</div>\n</div>'},6377:(module,__unused_webpack_exports,__webpack_require__)=>{var alea=__webpack_require__(4832),xor128=__webpack_require__(8652),xorwow=__webpack_require__(801),xorshift7=__webpack_require__(2030),xor4096=__webpack_require__(3618),tychei=__webpack_require__(9049),sr=__webpack_require__(1971);sr.alea=alea,sr.xor128=xor128,sr.xorwow=xorwow,sr.xorshift7=xorshift7,sr.xor4096=xor4096,sr.tychei=tychei,module.exports=sr},4832:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_RESULT__;!function(global,module,define){function Alea(seed){var n,me=this,mash=(n=4022871197,function(data){data=String(data);for(var i=0;i<data.length;i++){var h=.02519603282416938*(n+=data.charCodeAt(i));h-=n=h>>>0,n=(h*=n)>>>0,n+=4294967296*(h-=n)}return 2.3283064365386963e-10*(n>>>0)});me.next=function(){var t=2091639*me.s0+2.3283064365386963e-10*me.c;return me.s0=me.s1,me.s1=me.s2,me.s2=t-(me.c=0|t)},me.c=1,me.s0=mash(" "),me.s1=mash(" "),me.s2=mash(" "),me.s0-=mash(seed),me.s0<0&&(me.s0+=1),me.s1-=mash(seed),me.s1<0&&(me.s1+=1),me.s2-=mash(seed),me.s2<0&&(me.s2+=1),mash=null}function copy(f,t){return t.c=f.c,t.s0=f.s0,t.s1=f.s1,t.s2=f.s2,t}function impl(seed,opts){var xg=new Alea(seed),state=opts&&opts.state,prng=xg.next;return prng.int32=function(){return 4294967296*xg.next()|0},prng.double=function(){return prng()+11102230246251565e-32*(2097152*prng()|0)},prng.quick=prng,state&&("object"==typeof state&&copy(state,xg),prng.state=function(){return copy(xg,{})}),prng}module&&module.exports?module.exports=impl:__webpack_require__.amdD&&__webpack_require__.amdO?void 0===(__WEBPACK_AMD_DEFINE_RESULT__=function(){return impl}.call(exports,__webpack_require__,exports,module))||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__):this.alea=impl}(0,module=__webpack_require__.nmd(module),__webpack_require__.amdD)},9049:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_RESULT__;!function(global,module,define){function XorGen(seed){var me=this,strseed="";me.next=function(){var b=me.b,c=me.c,d=me.d,a=me.a;return b=b<<25^b>>>7^c,c=c-d|0,d=d<<24^d>>>8^a,a=a-b|0,me.b=b=b<<20^b>>>12^c,me.c=c=c-d|0,me.d=d<<16^c>>>16^a,me.a=a-b|0},me.a=0,me.b=0,me.c=-1640531527,me.d=1367130551,seed===Math.floor(seed)?(me.a=seed/4294967296|0,me.b=0|seed):strseed+=seed;for(var k=0;k<strseed.length+20;k++)me.b^=0|strseed.charCodeAt(k),me.next()}function copy(f,t){return t.a=f.a,t.b=f.b,t.c=f.c,t.d=f.d,t}function impl(seed,opts){var xg=new XorGen(seed),state=opts&&opts.state,prng=function(){return(xg.next()>>>0)/4294967296};return prng.double=function(){do{var result=((xg.next()>>>11)+(xg.next()>>>0)/4294967296)/(1<<21)}while(0===result);return result},prng.int32=xg.next,prng.quick=prng,state&&("object"==typeof state&&copy(state,xg),prng.state=function(){return copy(xg,{})}),prng}module&&module.exports?module.exports=impl:__webpack_require__.amdD&&__webpack_require__.amdO?void 0===(__WEBPACK_AMD_DEFINE_RESULT__=function(){return impl}.call(exports,__webpack_require__,exports,module))||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__):this.tychei=impl}(0,module=__webpack_require__.nmd(module),__webpack_require__.amdD)},8652:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_RESULT__;!function(global,module,define){function XorGen(seed){var me=this,strseed="";me.x=0,me.y=0,me.z=0,me.w=0,me.next=function(){var t=me.x^me.x<<11;return me.x=me.y,me.y=me.z,me.z=me.w,me.w^=me.w>>>19^t^t>>>8},seed===(0|seed)?me.x=seed:strseed+=seed;for(var k=0;k<strseed.length+64;k++)me.x^=0|strseed.charCodeAt(k),me.next()}function copy(f,t){return t.x=f.x,t.y=f.y,t.z=f.z,t.w=f.w,t}function impl(seed,opts){var xg=new XorGen(seed),state=opts&&opts.state,prng=function(){return(xg.next()>>>0)/4294967296};return prng.double=function(){do{var result=((xg.next()>>>11)+(xg.next()>>>0)/4294967296)/(1<<21)}while(0===result);return result},prng.int32=xg.next,prng.quick=prng,state&&("object"==typeof state&&copy(state,xg),prng.state=function(){return copy(xg,{})}),prng}module&&module.exports?module.exports=impl:__webpack_require__.amdD&&__webpack_require__.amdO?void 0===(__WEBPACK_AMD_DEFINE_RESULT__=function(){return impl}.call(exports,__webpack_require__,exports,module))||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__):this.xor128=impl}(0,module=__webpack_require__.nmd(module),__webpack_require__.amdD)},3618:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_RESULT__;!function(global,module,define){function XorGen(seed){var me=this;me.next=function(){var t,v,w=me.w,X=me.X,i=me.i;return me.w=w=w+1640531527|0,v=X[i+34&127],t=X[i=i+1&127],v^=v<<13,t^=t<<17,v^=v>>>15,t^=t>>>12,v=X[i]=v^t,me.i=i,v+(w^w>>>16)|0},function(me,seed){var t,v,i,j,w,X=[],limit=128;for(seed===(0|seed)?(v=seed,seed=null):(seed+="\0",v=0,limit=Math.max(limit,seed.length)),i=0,j=-32;j<limit;++j)seed&&(v^=seed.charCodeAt((j+32)%seed.length)),0===j&&(w=v),v^=v<<10,v^=v>>>15,v^=v<<4,v^=v>>>13,j>=0&&(w=w+1640531527|0,i=0==(t=X[127&j]^=v+w)?i+1:0);for(i>=128&&(X[127&(seed&&seed.length||0)]=-1),i=127,j=512;j>0;--j)v=X[i+34&127],t=X[i=i+1&127],v^=v<<13,t^=t<<17,v^=v>>>15,t^=t>>>12,X[i]=v^t;me.w=w,me.X=X,me.i=i}(me,seed)}function copy(f,t){return t.i=f.i,t.w=f.w,t.X=f.X.slice(),t}function impl(seed,opts){null==seed&&(seed=+new Date);var xg=new XorGen(seed),state=opts&&opts.state,prng=function(){return(xg.next()>>>0)/4294967296};return prng.double=function(){do{var result=((xg.next()>>>11)+(xg.next()>>>0)/4294967296)/(1<<21)}while(0===result);return result},prng.int32=xg.next,prng.quick=prng,state&&(state.X&&copy(state,xg),prng.state=function(){return copy(xg,{})}),prng}module&&module.exports?module.exports=impl:__webpack_require__.amdD&&__webpack_require__.amdO?void 0===(__WEBPACK_AMD_DEFINE_RESULT__=function(){return impl}.call(exports,__webpack_require__,exports,module))||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__):this.xor4096=impl}(0,module=__webpack_require__.nmd(module),__webpack_require__.amdD)},2030:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_RESULT__;!function(global,module,define){function XorGen(seed){var me=this;me.next=function(){var t,v,X=me.x,i=me.i;return t=X[i],v=(t^=t>>>7)^t<<24,v^=(t=X[i+1&7])^t>>>10,v^=(t=X[i+3&7])^t>>>3,v^=(t=X[i+4&7])^t<<7,t=X[i+7&7],v^=(t^=t<<13)^t<<9,X[i]=v,me.i=i+1&7,v},function(me,seed){var j,X=[];if(seed===(0|seed))X[0]=seed;else for(seed=""+seed,j=0;j<seed.length;++j)X[7&j]=X[7&j]<<15^seed.charCodeAt(j)+X[j+1&7]<<13;for(;X.length<8;)X.push(0);for(j=0;j<8&&0===X[j];++j);for(8==j?X[7]=-1:X[j],me.x=X,me.i=0,j=256;j>0;--j)me.next()}(me,seed)}function copy(f,t){return t.x=f.x.slice(),t.i=f.i,t}function impl(seed,opts){null==seed&&(seed=+new Date);var xg=new XorGen(seed),state=opts&&opts.state,prng=function(){return(xg.next()>>>0)/4294967296};return prng.double=function(){do{var result=((xg.next()>>>11)+(xg.next()>>>0)/4294967296)/(1<<21)}while(0===result);return result},prng.int32=xg.next,prng.quick=prng,state&&(state.x&&copy(state,xg),prng.state=function(){return copy(xg,{})}),prng}module&&module.exports?module.exports=impl:__webpack_require__.amdD&&__webpack_require__.amdO?void 0===(__WEBPACK_AMD_DEFINE_RESULT__=function(){return impl}.call(exports,__webpack_require__,exports,module))||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__):this.xorshift7=impl}(0,module=__webpack_require__.nmd(module),__webpack_require__.amdD)},801:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_RESULT__;!function(global,module,define){function XorGen(seed){var me=this,strseed="";me.next=function(){var t=me.x^me.x>>>2;return me.x=me.y,me.y=me.z,me.z=me.w,me.w=me.v,(me.d=me.d+362437|0)+(me.v=me.v^me.v<<4^t^t<<1)|0},me.x=0,me.y=0,me.z=0,me.w=0,me.v=0,seed===(0|seed)?me.x=seed:strseed+=seed;for(var k=0;k<strseed.length+64;k++)me.x^=0|strseed.charCodeAt(k),k==strseed.length&&(me.d=me.x<<10^me.x>>>4),me.next()}function copy(f,t){return t.x=f.x,t.y=f.y,t.z=f.z,t.w=f.w,t.v=f.v,t.d=f.d,t}function impl(seed,opts){var xg=new XorGen(seed),state=opts&&opts.state,prng=function(){return(xg.next()>>>0)/4294967296};return prng.double=function(){do{var result=((xg.next()>>>11)+(xg.next()>>>0)/4294967296)/(1<<21)}while(0===result);return result},prng.int32=xg.next,prng.quick=prng,state&&("object"==typeof state&&copy(state,xg),prng.state=function(){return copy(xg,{})}),prng}module&&module.exports?module.exports=impl:__webpack_require__.amdD&&__webpack_require__.amdO?void 0===(__WEBPACK_AMD_DEFINE_RESULT__=function(){return impl}.call(exports,__webpack_require__,exports,module))||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__):this.xorwow=impl}(0,module=__webpack_require__.nmd(module),__webpack_require__.amdD)},1971:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_RESULT__;!function(global,pool,math){var nodecrypto,startdenom=math.pow(256,6),significance=math.pow(2,52),overflow=2*significance;function seedrandom(seed,options,callback){var key=[],shortseed=mixkey(flatten((options=1==options?{entropy:!0}:options||{}).entropy?[seed,tostring(pool)]:null==seed?function(){try{var out;return nodecrypto&&(out=nodecrypto.randomBytes)?out=out(256):(out=new Uint8Array(256),(global.crypto||global.msCrypto).getRandomValues(out)),tostring(out)}catch(e){var browser=global.navigator,plugins=browser&&browser.plugins;return[+new Date,global,plugins,global.screen,tostring(pool)]}}():seed,3),key),arc4=new ARC4(key),prng=function(){for(var n=arc4.g(6),d=startdenom,x=0;n<significance;)n=256*(n+x),d*=256,x=arc4.g(1);for(;n>=overflow;)n/=2,d/=2,x>>>=1;return(n+x)/d};return prng.int32=function(){return 0|arc4.g(4)},prng.quick=function(){return arc4.g(4)/4294967296},prng.double=prng,mixkey(tostring(arc4.S),pool),(options.pass||callback||function(prng,seed,is_math_call,state){return state&&(state.S&&copy(state,arc4),prng.state=function(){return copy(arc4,{})}),is_math_call?(math.random=prng,seed):prng})(prng,shortseed,"global"in options?options.global:this==math,options.state)}function ARC4(key){var t,keylen=key.length,me=this,i=0,j=me.i=me.j=0,s=me.S=[];for(keylen||(key=[keylen++]);i<256;)s[i]=i++;for(i=0;i<256;i++)s[i]=s[j=255&j+key[i%keylen]+(t=s[i])],s[j]=t;(me.g=function(count){for(var t,r=0,i=me.i,j=me.j,s=me.S;count--;)t=s[i=255&i+1],r=256*r+s[255&(s[i]=s[j=255&j+t])+(s[j]=t)];return me.i=i,me.j=j,r})(256)}function copy(f,t){return t.i=f.i,t.j=f.j,t.S=f.S.slice(),t}function flatten(obj,depth){var prop,result=[],typ=typeof obj;if(depth&&"object"==typ)for(prop in obj)try{result.push(flatten(obj[prop],depth-1))}catch(e){}return result.length?result:"string"==typ?obj:obj+"\0"}function mixkey(seed,key){for(var smear,stringseed=seed+"",j=0;j<stringseed.length;)key[255&j]=255&(smear^=19*key[255&j])+stringseed.charCodeAt(j++);return tostring(key)}function tostring(a){return String.fromCharCode.apply(0,a)}if(mixkey(math.random(),pool),module.exports){module.exports=seedrandom;try{nodecrypto=__webpack_require__(5042)}catch(ex){}}else void 0===(__WEBPACK_AMD_DEFINE_RESULT__=function(){return seedrandom}.call(exports,__webpack_require__,exports,module))||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)}("undefined"!=typeof self?self:this,[],Math)},4190:(__unused_webpack_module,__unused_webpack___webpack_exports__,__webpack_require__)=>{"use strict";var _node_modules_style_loader_dist_runtime_injectStylesIntoStyleTag_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(3379),_node_modules_style_loader_dist_runtime_injectStylesIntoStyleTag_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_style_loader_dist_runtime_injectStylesIntoStyleTag_js__WEBPACK_IMPORTED_MODULE_0__),_node_modules_style_loader_dist_runtime_styleDomAPI_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(7795),_node_modules_style_loader_dist_runtime_styleDomAPI_js__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_node_modules_style_loader_dist_runtime_styleDomAPI_js__WEBPACK_IMPORTED_MODULE_1__),_node_modules_style_loader_dist_runtime_setAttributesWithoutAttributes_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(3565),_node_modules_style_loader_dist_runtime_setAttributesWithoutAttributes_js__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_node_modules_style_loader_dist_runtime_setAttributesWithoutAttributes_js__WEBPACK_IMPORTED_MODULE_2__),_node_modules_style_loader_dist_runtime_insertStyleElement_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(9216),_node_modules_style_loader_dist_runtime_insertStyleElement_js__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_node_modules_style_loader_dist_runtime_insertStyleElement_js__WEBPACK_IMPORTED_MODULE_3__),_node_modules_style_loader_dist_runtime_styleTagTransform_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(4589),_node_modules_style_loader_dist_runtime_styleTagTransform_js__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_node_modules_style_loader_dist_runtime_styleTagTransform_js__WEBPACK_IMPORTED_MODULE_4__),_node_modules_css_loader_dist_cjs_js_style_css__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(6833),options={};options.styleTagTransform=_node_modules_style_loader_dist_runtime_styleTagTransform_js__WEBPACK_IMPORTED_MODULE_4___default(),options.setAttributes=_node_modules_style_loader_dist_runtime_setAttributesWithoutAttributes_js__WEBPACK_IMPORTED_MODULE_2___default(),options.insert=function(element){let parent=window.gmStyles;null==parent&&(window.gmStyles=document.createElement("div"),parent=window.gmStyles);const lastInsertedElement=window._lastElementInsertedByStyleLoader;lastInsertedElement?lastInsertedElement.nextSibling?parent.insertBefore(element,lastInsertedElement.nextSibling):parent.appendChild(element):parent.insertBefore(element,parent.firstChild),window._lastElementInsertedByStyleLoader=element},options.domAPI=_node_modules_style_loader_dist_runtime_styleDomAPI_js__WEBPACK_IMPORTED_MODULE_1___default(),options.insertStyleElement=_node_modules_style_loader_dist_runtime_insertStyleElement_js__WEBPACK_IMPORTED_MODULE_3___default();_node_modules_style_loader_dist_runtime_injectStylesIntoStyleTag_js__WEBPACK_IMPORTED_MODULE_0___default()(_node_modules_css_loader_dist_cjs_js_style_css__WEBPACK_IMPORTED_MODULE_5__.Z,options),_node_modules_css_loader_dist_cjs_js_style_css__WEBPACK_IMPORTED_MODULE_5__.Z&&_node_modules_css_loader_dist_cjs_js_style_css__WEBPACK_IMPORTED_MODULE_5__.Z.locals&&_node_modules_css_loader_dist_cjs_js_style_css__WEBPACK_IMPORTED_MODULE_5__.Z.locals},3379:module=>{"use strict";var stylesInDOM=[];function getIndexByIdentifier(identifier){for(var result=-1,i=0;i<stylesInDOM.length;i++)if(stylesInDOM[i].identifier===identifier){result=i;break}return result}function modulesToDom(list,options){for(var idCountMap={},identifiers=[],i=0;i<list.length;i++){var item=list[i],id=options.base?item[0]+options.base:item[0],count=idCountMap[id]||0,identifier="".concat(id," ").concat(count);idCountMap[id]=count+1;var indexByIdentifier=getIndexByIdentifier(identifier),obj={css:item[1],media:item[2],sourceMap:item[3],supports:item[4],layer:item[5]};if(-1!==indexByIdentifier)stylesInDOM[indexByIdentifier].references++,stylesInDOM[indexByIdentifier].updater(obj);else{var updater=addElementStyle(obj,options);options.byIndex=i,stylesInDOM.splice(i,0,{identifier,updater,references:1})}identifiers.push(identifier)}return identifiers}function addElementStyle(obj,options){var api=options.domAPI(options);api.update(obj);return function(newObj){if(newObj){if(newObj.css===obj.css&&newObj.media===obj.media&&newObj.sourceMap===obj.sourceMap&&newObj.supports===obj.supports&&newObj.layer===obj.layer)return;api.update(obj=newObj)}else api.remove()}}module.exports=function(list,options){var lastIdentifiers=modulesToDom(list=list||[],options=options||{});return function(newList){newList=newList||[];for(var i=0;i<lastIdentifiers.length;i++){var index=getIndexByIdentifier(lastIdentifiers[i]);stylesInDOM[index].references--}for(var newLastIdentifiers=modulesToDom(newList,options),_i=0;_i<lastIdentifiers.length;_i++){var _index=getIndexByIdentifier(lastIdentifiers[_i]);0===stylesInDOM[_index].references&&(stylesInDOM[_index].updater(),stylesInDOM.splice(_index,1))}lastIdentifiers=newLastIdentifiers}}},9216:module=>{"use strict";module.exports=function(options){var element=document.createElement("style");return options.setAttributes(element,options.attributes),options.insert(element,options.options),element}},3565:(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";module.exports=function(styleElement){var nonce=__webpack_require__.nc;nonce&&styleElement.setAttribute("nonce",nonce)}},7795:module=>{"use strict";module.exports=function(options){var styleElement=options.insertStyleElement(options);return{update:function(obj){!function(styleElement,options,obj){var css="";obj.supports&&(css+="@supports (".concat(obj.supports,") {")),obj.media&&(css+="@media ".concat(obj.media," {"));var needLayer=void 0!==obj.layer;needLayer&&(css+="@layer".concat(obj.layer.length>0?" ".concat(obj.layer):""," {")),css+=obj.css,needLayer&&(css+="}"),obj.media&&(css+="}"),obj.supports&&(css+="}");var sourceMap=obj.sourceMap;sourceMap&&"undefined"!=typeof btoa&&(css+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))))," */")),options.styleTagTransform(css,styleElement,options.options)}(styleElement,options,obj)},remove:function(){!function(styleElement){if(null===styleElement.parentNode)return!1;styleElement.parentNode.removeChild(styleElement)}(styleElement)}}}},4589:module=>{"use strict";module.exports=function(css,styleElement){if(styleElement.styleSheet)styleElement.styleSheet.cssText=css;else{for(;styleElement.firstChild;)styleElement.removeChild(styleElement.firstChild);styleElement.appendChild(document.createTextNode(css))}}},9336:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});const __WEBPACK_DEFAULT_EXPORT__="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAACxQAAAsUBidZ/7wAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAHCSURBVEiJ1ZXBahNhFIXPDWpjSAUX1mbXKuhrqDtBVHyEIhZLRC3oK/QB3PkMxaXoxoWCol0LXVkE0WjaRgouhPznc5EfHMZpMtG66IVhhp9zzzkX5p5fOuwVdYHAMUmnJCHpW0QM/1kdaAGrtl/bTrbJz9D2K+AucLzUc6HWBMAV4LGkjqQ9SS+Aj5IiIhYlXZTUlvQ5IpYi4nlKaS0izjcajRuTnN/JjreBLjBTgWkC92wP8kTP8nRPJpFfzeSbwJmx4BH+XBZhogDQtt3LzhcnkUtSSmmtQP6HwJESfkXS6YhYiYitGu4fAsuSBoWzH/s22H5ne5B/yYMtoOVRrR8kb6Pw3ZEUwIf/JUB+197ucqWUHtkG6FQJ9CQREQt/K5B7h5L6lQDbG7Z3gaPTkgNN23u2XxbPixMoItYlnZS0NK2ApFuSZjPHvi5mbX+13QcW6jIDZ23v2v5UDr8q8PUcFe/riGTyTdtD4HJdR6t5J/rA7arFA2aAru0d2wnoVnGNi+trOa7nJH3X77hWjutLkk5I+hIRNyPiaS33JZE28MD229KFk2y/Ae4DrXEc01yZTUnzGi1kLyJ+Tu34UNYvjYqQ50rXP00AAAAASUVORK5CYII="},158:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});const __WEBPACK_DEFAULT_EXPORT__="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAACxQAAAsUBidZ/7wAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAACsSURBVEiJ7ZRRDoIwFATBC4B40dZTqigJXmj88Jk0L6luCzF8sH+E7kyBR5tmz+YCtEAEjgWd3jqtsjjyzl2RGHy0zlndzU2ROPgI9D8FVuyAixUn4JRZc03WDBJckSyGf5OsBs9IZuCxGtxJPh8T4KnCDwWedMZx1/Vx73y20c1O1xL4BAzKCFfD3b16iTKK1RIKfn8KjpW0FBR4RhLVpwgK3EkCynG95+95ARDkx5DX/PP7AAAAAElFTkSuQmCC"},3653:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});const __WEBPACK_DEFAULT_EXPORT__="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAACxQAAAsUBidZ/7wAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAEhSURBVEiJ1ZU/SwMxGIefiIt4ICgFoUNxESzoKkKRLvWLODrUUT+Cm5NfouBSqEs7O1hwUwRFcHFwFXTy53IH13iXS1I73A9eCHn/PHkTkkDdZbKBpBWgHVnnwxjz5oyQtKt4fUrqFtVdqljZBFi3bBs4Sq0BjIFVYCipE9rBTUHccc6/Jmnk6qSqg1BlnTQXBQBIgI1FAma0HJFzC/TT8de8gENJLw5/H9iMAVwCjxVwWzvAqT1ZdgYjYAr8eNo0zfkj1xYdACdea4cr4MkZYV20nmfhfH4vl7+XzZd2IOkcOPOsfwHcFTlcWzQA7j0Bz8BWKKAJ7HsCvsscLkALKH8dZ/UKvIcAEmCYmq+6IYDrgMJO/deXaevBGFP5TtVDvzVa0PDXywDUAAAAAElFTkSuQmCC"},3154:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});const __WEBPACK_DEFAULT_EXPORT__="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAACxQAAAsUBidZ/7wAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAEfSURBVEiJ1ZW9SsNQGIafVy12FKziINbFC9DNGxJHN70DC92FoqMX0aGD4BAX8W9xEMXVxcVuldehORLbpGh6IvosOV/y8T58nCQH/jsCsL0GLBX0GLiS5NIW20eezIntmTLZc5n1E7CT07MFtIB327s/nSQreJPUy+np2X4FOkDT9vOEvAdJ7SJBIZKObQMcABsFbcvANdAee5Luwe13ZEXYPrV9Pnp/bALbe8BKCcc60LDdSuszSd0vAtvzwCFQLyEI7KfXO4DRV29zyvAsSZ5gO1L4i6THKgVJWPyqoAasVilYjBQ+AC7zBAuRBDeS+nmCWiTBRbYIglmG//0YJNkiCBqkh09VgkGk8M8PLBCOzCbDKaalL+k+Qs4f4gNi+3bWxe/oUQAAAABJRU5ErkJggg=="},3677:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});const __WEBPACK_DEFAULT_EXPORT__="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAACxQAAAsUBidZ/7wAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAADVSURBVEiJ7ZWxDcIwEEXvwKFPNmACxqCAmgL2oGYYFkjBFinYgA1IBULyv3wKUkWJE0iQQMqXTrLu7P98tmSL/Lu0Lkky8d7PaxeoJs65maqePqYC2AJgKLz3h14AMzuTjKthZvsSAgCbNi8X4qhqXk2a2b0cTkXkCODmnGs8rklrO2FFIpICWH8LIPLqJAWwGgRA8iEieSUoIsvOJuUlZ13nm1kGYFdXG+KIghoBI2AEhF9TRzLuYlIURaNPY4HkwsyuXQAhvf1lNimKoouq9t7Q7+kJyBmRw45Of6gAAAAASUVORK5CYII="},6601:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});const __WEBPACK_DEFAULT_EXPORT__="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAACxQAAAsUBidZ/7wAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAADFSURBVEiJ7ZMxCsJAEEU3kFptzR28hl5AsFIrLSwtvYnewErwRoKNhQp2IW/ybVYQCQbjBkX85bK8N3xmnPvnJyIpMbOppKgWAbAFZGbzOuBDQMBOUiMoXFIbOAJ5lmW9oHDnnAM2fvplHfCRh+8ltYLCv78aSc0n8NFbW5OmaQc4AJMCcQKcfDXdl+F+wj6QAfmj5HZQwKoSvEhiZjP/Ng66NcDgTrJ4u5oSiYJUUyKptDVx6Yc4XgNO0jmKoku1Mf/5ZK7dYgZXbSH4kAAAAABJRU5ErkJggg=="},4140:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});const __WEBPACK_DEFAULT_EXPORT__="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAAASAAAAEgARslrPgAAAVJJREFUSMfllT9KA0EYxd+IkBRiJVGsLCwsFQIprbyAVsZiPYTBY2ipIsZrJOoBFEEPoEkRBI8QWM3PZoLrZGZ2/FeID7b59n3v7fe+3VnpXwBoMYlWSu9Uoseap7b6kwbLibXSKAxwBXSBLaAGHAK5J6Lc3qtZbtf2mphB5oiMKIfLyULiM8BTgmAZnoFZ3w72JS1GEuxJOrFXP8Kbl7Tnm6AJDANPdQZUC9wq0A5wh8B2KKY60HcaHovijknP4faBepH34TU1xtxKOna0LowxQ9fA1i6d8pHV8BtYjFytSN6mpHdi7AYw+EZEA6AREt+JLLntWfJ5ZMnNMXe64LEiqRIYblfSOjDOfEPSUoBbsVoTE/zKh+aaZA75NUHQ5WQKgffDrgNsAgvAKfDiEc6BA2DOcjuUHXYR4xuPwXVKb+r/4CGx9mWDO0/t/tNR/Em8ASiL3Dzcv8azAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIwLTA0LTEzVDE0OjQzOjAzKzAwOjAwfCpNXQAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyMC0wNC0xM1QxNDo0MzowMyswMDowMA139eEAAAAodEVYdHN2ZzpiYXNlLXVyaQBmaWxlOi8vL3RtcC9tYWdpY2stZEprWU1DZ05qxfNUAAAAAElFTkSuQmCC"},8159:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});const __WEBPACK_DEFAULT_EXPORT__="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAB2AAAAdgB+lymcgAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAp8SURBVHic7Z1bjFVXGcf/Hy2Wyp0GlBpptDIIktIWGmINKFJIpY0N1NZQFRORFsNDfZEYn0w1sRgfIDEiFTQm+tBa2zS2CWirISQ1clMTiykgSVstFxkuM2CnlfLzYZ3DDOOZM3uvvfbl7Fm/hExm2Hut76z1nb1u3/ffUiQSiUQikUgkEolEIpFIJBKJRCLlAcwCNgBzy7YlUgDANGA1sAN4nX62l21bXbEyKweul7RI0l2SlkmaN4RNFyXdaGY9BZoXyRNgO/AWyVlfts11ZFSJdU+RNCbF9evyMmQkU6YDHEl5/e3A/FwsGcGU6QCHPe55OETFwBhgMzA7RHkRD4DFKcb/Jr3AuIz1zgD2N8o7EZ2gJIDpHg4A4D0XAJYCpweVF52gLIAeDwfY61GPAY8C/x2izFPAx/L4jJE2AAc9HADg9hR1jAOeatx3uU2Z0QmKBnjS0wG2Jiy/C3glQec3icNBkQDf8ej8y8A7wK3DlH0ffkNMdIKiANZ4dFCTM8AXgVGDyhwNfJdk3/gR7wRlnwV8XNLLGYt5Q9KLkk5JGifpM5I+LAll+3xbzOzrGW2rPGU7wGxJh8q0YQj2S1pkZn1lG5I3Ze4ESu70r2p0S/rcSOh8Sbq2rIqBayVtLKv+FiDpsqTPm9lrZRtTFGU+AbZIuq3E+gdjkr5lZi+VbUiReM8BcFE6k+VO9Y42fh42s+PD3DdR0o8kPaTsE7WQPC3pQTOjbEOKxKvxcZE8Z9T6PL9X/Q5xRO7U76ikCXLRP+vlYgGqxCFJC83sQtmGFI2vAyyXtCuwLWXRI+kOM/M5nu54fCeBdwW1ohyaj/o1I7XzJf9J4LKgVpSDSfqBmT1XtiFlknoIAKZJOuFzbwDONeqdGKCstyVNNbPeAGV1LD5PgKUqtvN3Sbpf0mQzm2xmk+RWH6uUbR5ybKR3vhe4pI0i6AbuSWDPPY1r03KsiPaqHcBrQbu5Nd3AnBQ2zSG9E7wLVG05WjiphgBglqQZOdkykDVmlviQqHHtmpR1jJL0QMp7Rja4RM282ZnBvp0p6zoKvDdkG3UaaSeBuyXtkMvVy4ttGe59IuX1N0vayqCgksgwABOA9cCBwN9+gEkZ7Jqcsq5m1NBOUgSaRgYALAC24ZI2snI2gD1nM9S/D1gHjA/RNiMKYDzwcKMRfTkTwI4sDtCkF+fUC0K0zYgDuBs46dn4WYaASQE6fzAHcMPdhJBtVHuAO3Dh22mjc1dlqHNl4M4fyAWcpkGUq0kKsNWjoYtcBvqwIWQb1RpgnmcjD7sF3KKuewN2cjtm5dFWtQU47tHIRWwF+1C7YNEiNkD+4XHPFEl7SHgYJGmPigkze7GAOgqlCAfw3TWcIul53Li+kgGrA9xsfxVuvvC8iosxTOwAwFzc1nmlh4zcz/WB/ZJCafuclwvl8l4qZgBJ7zezU4kudlHTaxu/viHpd3IO9FLSMoogVwfAybl0S3pPnvUUxF/MLFEeA27P4E1JY1v9t6S/qt8h9pjZW8GsTEneQ8BXVY/Ol1yHJWW1Wne+5L50t0r6hlxE0xlKVELNzQGALkmP5VV+CaSZAKZRMxujEvMkcskNbDz6n5VUxUOVC5J+KZeWbpJmDvj3EbW2uU9upTEsuPODtCeLpYWlB3cAwCT9TFLidXyB/FbSV8zsX80/4FLUH5H0ZTPrA6ZL6lK/Q8yUdDbFOO2jYpZWNLO6ABsL2JDx4dfA6EG2zsapgYDTDswU7oYTpPI5Fl+crdUrAvBpnBRbFnmWPPgbg0K/uLrzm5wGlmb4/Os87ZuevfVLBriJ/xdhrAqfGmTrLODNIa69BHwbN5SlbQOfWIgen7oqBU57N0sgSJ7sH2Rru86H/qfXc7hU9qRtcIunfQfC90hyQi0DH5dU1eiZK9lDuAnfbkntHrnNb+NnJb1M8q3cr/mZV+4EMJQDbJN00vPevAUZTktXOv8Pkt6X4t45kvYB97W7CKdZuFZ+n6XzHcDM/i5pifycoE/S9+SeIKPl9vlnSfqCpN9IupTRvBs8O7/JeEnP4rQHB68iRgEPSfq9nO0+Y3mpDhB08uHR0IckrTKzV9uU+VE5SZkl8pOUeUrScUmPprzvKjMa9R6TtFNOBWWqXJr8BzOUK0l3mtkfM5ZRHWi9vGo1yfoVCbX/gWuAn3tOsg5S7UlqV959Uji0d4JLuM2iVN9k4DrgsEcD9+Lk4m+imsvU+/Pqh1KhghstuBdGXKJaG1V7gWvCtXyFoIJbrVRzq3pL9tauKDgn2AykeUVcu/K2eTTw2gH3G27+URWaT6NfkCD5BPeqnU8Ca4HHcWcc3vEEHbcFiTtu3Zfytk1m9s0BZYyT9CdV78SyW9KP5TarLsqdRnap/1RypoY+rp5SZmRRoZA+K/mZFmV0AecDfIOrwnKftuzUvPifpLi2T07V9Coa2oBr5Nb4dZCH9dJu7LghQAobdAl8Xy4+r9NJHLQ6kI50AClc2DXuxO+0wkRHnW/8DKFjmJZUYesdDwETL4AjGcbeZuLKxAHlXUlcyTKoe7A6a1uMSIB/ejR2N3BvgrJ9dQx92FFEe9UKYCrpdwZrk7zaqauAkDyg9HOhLxWgY+jDDCqei1gpgLHAsZTfsloJWIzYJwBOG3CrpA+lvDWLjmGWe4fjopyG4+4c66gHwG0Dvo1pxv/LFKtjmIQoYpUE3EniOtzxqy/nAthxLkCnRxm7pADzCSdkWbYDRCHLJOCkbB+helK2k/ALRjkJ3B2yjWoJbndwO07TLy9WZrAvrY7hZZzWYnzUJ4H6ydkD/DBkG9UaXNpXEQy7BdzCthWedd2SR1vVFurzShuAtq/hDUEdN4KK0PJr6hiuGO5CsukY5p41FB3AnymSXqC1juHExt+y6hjm/i7jjg0IGQrKfbFl6ICQvWa2MFBZLamdA0gS8Gc5KbZO5225aN//5FVBHYcAKZ2mX5W5Tn6iU4mpqwPUSdT5MXJMIK3rEHC9XCh4q2ykXrnZ9RFJRxs/35X0CTlNgirusx+StNDMgk8Ka+kA0pWo4cnq7+wjko6Y2ZBra+ADkn4qabn8tAjy5GlJD5pZHXIYqgswGpdvV0U2hv68VfLwygCMlbRX1codbGYwrTCzXcNdnJToAEOA0zGo4mSyW9J8Mwvy+proAG0ADkpKnW5VAPslLTKzvqwF1XUZGIpgj9rALJDTZsxMdID2/Dvn8n1n9CcVKMI4OkB7sr7I4R1Jz8jtL8xplHeDpDslbZJLXU/LSUlLGtqMkTwBnvRYqjVj/l4Abh6m/C7glUH3teMETosxUgQ4jUEftuEST5LUMY5+zaJ2ThA7v0hwYlI9Hp3/KpDqRVmNujbiJOxi51cBnBqXD96ndzgdw8FilrHzywBY7NH5vSSUv21T7wycpmLs/DLB6fClJcjSDKdtvDl2fokAmzwcINQrcgsj7gMMzcyU1x80s1Jf/+JDdIChOaN0GzVP5GVInsTDoDbgIosWyYkwLpM0T63b7KKkG82sp0DzIkUDTANWAzuA1weM/aW9/DlSIrhcxA3A3LJtiUQikUgkEolEIpFIJBKJRCKRSGQI/geCWEvyH1UDYwAAAABJRU5ErkJggg=="},2511:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_RESULT__;module=__webpack_require__.nmd(module),function(root){exports&&exports.nodeType,module&&module.nodeType;var freeGlobal="object"==typeof __webpack_require__.g&&__webpack_require__.g;freeGlobal.global!==freeGlobal&&freeGlobal.window!==freeGlobal&&freeGlobal.self;var punycode,maxInt=2147483647,regexPunycode=/^xn--/,regexNonASCII=/[^\x20-\x7E]/,regexSeparators=/[\x2E\u3002\uFF0E\uFF61]/g,errors={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},floor=Math.floor,stringFromCharCode=String.fromCharCode;function error(type){throw RangeError(errors[type])}function map(array,fn){for(var length=array.length,result=[];length--;)result[length]=fn(array[length]);return result}function mapDomain(string,fn){var parts=string.split("@"),result="";return parts.length>1&&(result=parts[0]+"@",string=parts[1]),result+map((string=string.replace(regexSeparators,".")).split("."),fn).join(".")}function ucs2decode(string){for(var value,extra,output=[],counter=0,length=string.length;counter<length;)(value=string.charCodeAt(counter++))>=55296&&value<=56319&&counter<length?56320==(64512&(extra=string.charCodeAt(counter++)))?output.push(((1023&value)<<10)+(1023&extra)+65536):(output.push(value),counter--):output.push(value);return output}function ucs2encode(array){return map(array,(function(value){var output="";return value>65535&&(output+=stringFromCharCode((value-=65536)>>>10&1023|55296),value=56320|1023&value),output+=stringFromCharCode(value)})).join("")}function digitToBasic(digit,flag){return digit+22+75*(digit<26)-((0!=flag)<<5)}function adapt(delta,numPoints,firstTime){var k=0;for(delta=firstTime?floor(delta/700):delta>>1,delta+=floor(delta/numPoints);delta>455;k+=36)delta=floor(delta/35);return floor(k+36*delta/(delta+38))}function decode(input){var out,basic,j,index,oldi,w,k,digit,t,baseMinusT,codePoint,output=[],inputLength=input.length,i=0,n=128,bias=72;for((basic=input.lastIndexOf("-"))<0&&(basic=0),j=0;j<basic;++j)input.charCodeAt(j)>=128&&error("not-basic"),output.push(input.charCodeAt(j));for(index=basic>0?basic+1:0;index<inputLength;){for(oldi=i,w=1,k=36;index>=inputLength&&error("invalid-input"),((digit=(codePoint=input.charCodeAt(index++))-48<10?codePoint-22:codePoint-65<26?codePoint-65:codePoint-97<26?codePoint-97:36)>=36||digit>floor((maxInt-i)/w))&&error("overflow"),i+=digit*w,!(digit<(t=k<=bias?1:k>=bias+26?26:k-bias));k+=36)w>floor(maxInt/(baseMinusT=36-t))&&error("overflow"),w*=baseMinusT;bias=adapt(i-oldi,out=output.length+1,0==oldi),floor(i/out)>maxInt-n&&error("overflow"),n+=floor(i/out),i%=out,output.splice(i++,0,n)}return ucs2encode(output)}function encode(input){var n,delta,handledCPCount,basicLength,bias,j,m,q,k,t,currentValue,inputLength,handledCPCountPlusOne,baseMinusT,qMinusT,output=[];for(inputLength=(input=ucs2decode(input)).length,n=128,delta=0,bias=72,j=0;j<inputLength;++j)(currentValue=input[j])<128&&output.push(stringFromCharCode(currentValue));for(handledCPCount=basicLength=output.length,basicLength&&output.push("-");handledCPCount<inputLength;){for(m=maxInt,j=0;j<inputLength;++j)(currentValue=input[j])>=n&&currentValue<m&&(m=currentValue);for(m-n>floor((maxInt-delta)/(handledCPCountPlusOne=handledCPCount+1))&&error("overflow"),delta+=(m-n)*handledCPCountPlusOne,n=m,j=0;j<inputLength;++j)if((currentValue=input[j])<n&&++delta>maxInt&&error("overflow"),currentValue==n){for(q=delta,k=36;!(q<(t=k<=bias?1:k>=bias+26?26:k-bias));k+=36)qMinusT=q-t,baseMinusT=36-t,output.push(stringFromCharCode(digitToBasic(t+qMinusT%baseMinusT,0))),q=floor(qMinusT/baseMinusT);output.push(stringFromCharCode(digitToBasic(q,0))),bias=adapt(delta,handledCPCountPlusOne,handledCPCount==basicLength),delta=0,++handledCPCount}++delta,++n}return output.join("")}punycode={version:"1.3.2",ucs2:{decode:ucs2decode,encode:ucs2encode},decode,encode,toASCII:function(input){return mapDomain(input,(function(string){return regexNonASCII.test(string)?"xn--"+encode(string):string}))},toUnicode:function(input){return mapDomain(input,(function(string){return regexPunycode.test(string)?decode(string.slice(4).toLowerCase()):string}))}},void 0===(__WEBPACK_AMD_DEFINE_RESULT__=function(){return punycode}.call(exports,__webpack_require__,exports,module))||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)}()},8575:(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";var punycode=__webpack_require__(2511),util=__webpack_require__(2502);function Url(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}exports.Qc=urlParse,exports.DB=function(source,relative){return urlParse(source,!1,!0).resolve(relative)},exports.WU=function(obj){util.isString(obj)&&(obj=urlParse(obj));return obj instanceof Url?obj.format():Url.prototype.format.call(obj)};var protocolPattern=/^([a-z0-9.+-]+:)/i,portPattern=/:[0-9]*$/,simplePathPattern=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,unwise=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),autoEscape=["'"].concat(unwise),nonHostChars=["%","/","?",";","#"].concat(autoEscape),hostEndingChars=["/","?","#"],hostnamePartPattern=/^[+a-z0-9A-Z_-]{0,63}$/,hostnamePartStart=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,unsafeProtocol={javascript:!0,"javascript:":!0},hostlessProtocol={javascript:!0,"javascript:":!0},slashedProtocol={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},querystring=__webpack_require__(7673);function urlParse(url,parseQueryString,slashesDenoteHost){if(url&&util.isObject(url)&&url instanceof Url)return url;var u=new Url;return u.parse(url,parseQueryString,slashesDenoteHost),u}Url.prototype.parse=function(url,parseQueryString,slashesDenoteHost){if(!util.isString(url))throw new TypeError("Parameter 'url' must be a string, not "+typeof url);var queryIndex=url.indexOf("?"),splitter=-1!==queryIndex&&queryIndex<url.indexOf("#")?"?":"#",uSplit=url.split(splitter);uSplit[0]=uSplit[0].replace(/\\/g,"/");var rest=url=uSplit.join(splitter);if(rest=rest.trim(),!slashesDenoteHost&&1===url.split("#").length){var simplePath=simplePathPattern.exec(rest);if(simplePath)return this.path=rest,this.href=rest,this.pathname=simplePath[1],simplePath[2]?(this.search=simplePath[2],this.query=parseQueryString?querystring.parse(this.search.substr(1)):this.search.substr(1)):parseQueryString&&(this.search="",this.query={}),this}var proto=protocolPattern.exec(rest);if(proto){var lowerProto=(proto=proto[0]).toLowerCase();this.protocol=lowerProto,rest=rest.substr(proto.length)}if(slashesDenoteHost||proto||rest.match(/^\/\/[^@\/]+@[^@\/]+/)){var slashes="//"===rest.substr(0,2);!slashes||proto&&hostlessProtocol[proto]||(rest=rest.substr(2),this.slashes=!0)}if(!hostlessProtocol[proto]&&(slashes||proto&&!slashedProtocol[proto])){for(var auth,atSign,hostEnd=-1,i=0;i<hostEndingChars.length;i++){-1!==(hec=rest.indexOf(hostEndingChars[i]))&&(-1===hostEnd||hec<hostEnd)&&(hostEnd=hec)}-1!==(atSign=-1===hostEnd?rest.lastIndexOf("@"):rest.lastIndexOf("@",hostEnd))&&(auth=rest.slice(0,atSign),rest=rest.slice(atSign+1),this.auth=decodeURIComponent(auth)),hostEnd=-1;for(i=0;i<nonHostChars.length;i++){var hec;-1!==(hec=rest.indexOf(nonHostChars[i]))&&(-1===hostEnd||hec<hostEnd)&&(hostEnd=hec)}-1===hostEnd&&(hostEnd=rest.length),this.host=rest.slice(0,hostEnd),rest=rest.slice(hostEnd),this.parseHost(),this.hostname=this.hostname||"";var ipv6Hostname="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!ipv6Hostname)for(var hostparts=this.hostname.split(/\./),l=(i=0,hostparts.length);i<l;i++){var part=hostparts[i];if(part&&!part.match(hostnamePartPattern)){for(var newpart="",j=0,k=part.length;j<k;j++)part.charCodeAt(j)>127?newpart+="x":newpart+=part[j];if(!newpart.match(hostnamePartPattern)){var validParts=hostparts.slice(0,i),notHost=hostparts.slice(i+1),bit=part.match(hostnamePartStart);bit&&(validParts.push(bit[1]),notHost.unshift(bit[2])),notHost.length&&(rest="/"+notHost.join(".")+rest),this.hostname=validParts.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),ipv6Hostname||(this.hostname=punycode.toASCII(this.hostname));var p=this.port?":"+this.port:"",h=this.hostname||"";this.host=h+p,this.href+=this.host,ipv6Hostname&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==rest[0]&&(rest="/"+rest))}if(!unsafeProtocol[lowerProto])for(i=0,l=autoEscape.length;i<l;i++){var ae=autoEscape[i];if(-1!==rest.indexOf(ae)){var esc=encodeURIComponent(ae);esc===ae&&(esc=escape(ae)),rest=rest.split(ae).join(esc)}}var hash=rest.indexOf("#");-1!==hash&&(this.hash=rest.substr(hash),rest=rest.slice(0,hash));var qm=rest.indexOf("?");if(-1!==qm?(this.search=rest.substr(qm),this.query=rest.substr(qm+1),parseQueryString&&(this.query=querystring.parse(this.query)),rest=rest.slice(0,qm)):parseQueryString&&(this.search="",this.query={}),rest&&(this.pathname=rest),slashedProtocol[lowerProto]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){p=this.pathname||"";var s=this.search||"";this.path=p+s}return this.href=this.format(),this},Url.prototype.format=function(){var auth=this.auth||"";auth&&(auth=(auth=encodeURIComponent(auth)).replace(/%3A/i,":"),auth+="@");var protocol=this.protocol||"",pathname=this.pathname||"",hash=this.hash||"",host=!1,query="";this.host?host=auth+this.host:this.hostname&&(host=auth+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(host+=":"+this.port)),this.query&&util.isObject(this.query)&&Object.keys(this.query).length&&(query=querystring.stringify(this.query));var search=this.search||query&&"?"+query||"";return protocol&&":"!==protocol.substr(-1)&&(protocol+=":"),this.slashes||(!protocol||slashedProtocol[protocol])&&!1!==host?(host="//"+(host||""),pathname&&"/"!==pathname.charAt(0)&&(pathname="/"+pathname)):host||(host=""),hash&&"#"!==hash.charAt(0)&&(hash="#"+hash),search&&"?"!==search.charAt(0)&&(search="?"+search),protocol+host+(pathname=pathname.replace(/[?#]/g,(function(match){return encodeURIComponent(match)})))+(search=search.replace("#","%23"))+hash},Url.prototype.resolve=function(relative){return this.resolveObject(urlParse(relative,!1,!0)).format()},Url.prototype.resolveObject=function(relative){if(util.isString(relative)){var rel=new Url;rel.parse(relative,!1,!0),relative=rel}for(var result=new Url,tkeys=Object.keys(this),tk=0;tk<tkeys.length;tk++){var tkey=tkeys[tk];result[tkey]=this[tkey]}if(result.hash=relative.hash,""===relative.href)return result.href=result.format(),result;if(relative.slashes&&!relative.protocol){for(var rkeys=Object.keys(relative),rk=0;rk<rkeys.length;rk++){var rkey=rkeys[rk];"protocol"!==rkey&&(result[rkey]=relative[rkey])}return slashedProtocol[result.protocol]&&result.hostname&&!result.pathname&&(result.path=result.pathname="/"),result.href=result.format(),result}if(relative.protocol&&relative.protocol!==result.protocol){if(!slashedProtocol[relative.protocol]){for(var keys=Object.keys(relative),v=0;v<keys.length;v++){var k=keys[v];result[k]=relative[k]}return result.href=result.format(),result}if(result.protocol=relative.protocol,relative.host||hostlessProtocol[relative.protocol])result.pathname=relative.pathname;else{for(var relPath=(relative.pathname||"").split("/");relPath.length&&!(relative.host=relPath.shift()););relative.host||(relative.host=""),relative.hostname||(relative.hostname=""),""!==relPath[0]&&relPath.unshift(""),relPath.length<2&&relPath.unshift(""),result.pathname=relPath.join("/")}if(result.search=relative.search,result.query=relative.query,result.host=relative.host||"",result.auth=relative.auth,result.hostname=relative.hostname||relative.host,result.port=relative.port,result.pathname||result.search){var p=result.pathname||"",s=result.search||"";result.path=p+s}return result.slashes=result.slashes||relative.slashes,result.href=result.format(),result}var isSourceAbs=result.pathname&&"/"===result.pathname.charAt(0),isRelAbs=relative.host||relative.pathname&&"/"===relative.pathname.charAt(0),mustEndAbs=isRelAbs||isSourceAbs||result.host&&relative.pathname,removeAllDots=mustEndAbs,srcPath=result.pathname&&result.pathname.split("/")||[],psychotic=(relPath=relative.pathname&&relative.pathname.split("/")||[],result.protocol&&!slashedProtocol[result.protocol]);if(psychotic&&(result.hostname="",result.port=null,result.host&&(""===srcPath[0]?srcPath[0]=result.host:srcPath.unshift(result.host)),result.host="",relative.protocol&&(relative.hostname=null,relative.port=null,relative.host&&(""===relPath[0]?relPath[0]=relative.host:relPath.unshift(relative.host)),relative.host=null),mustEndAbs=mustEndAbs&&(""===relPath[0]||""===srcPath[0])),isRelAbs)result.host=relative.host||""===relative.host?relative.host:result.host,result.hostname=relative.hostname||""===relative.hostname?relative.hostname:result.hostname,result.search=relative.search,result.query=relative.query,srcPath=relPath;else if(relPath.length)srcPath||(srcPath=[]),srcPath.pop(),srcPath=srcPath.concat(relPath),result.search=relative.search,result.query=relative.query;else if(!util.isNullOrUndefined(relative.search)){if(psychotic)result.hostname=result.host=srcPath.shift(),(authInHost=!!(result.host&&result.host.indexOf("@")>0)&&result.host.split("@"))&&(result.auth=authInHost.shift(),result.host=result.hostname=authInHost.shift());return result.search=relative.search,result.query=relative.query,util.isNull(result.pathname)&&util.isNull(result.search)||(result.path=(result.pathname?result.pathname:"")+(result.search?result.search:"")),result.href=result.format(),result}if(!srcPath.length)return result.pathname=null,result.search?result.path="/"+result.search:result.path=null,result.href=result.format(),result;for(var last=srcPath.slice(-1)[0],hasTrailingSlash=(result.host||relative.host||srcPath.length>1)&&("."===last||".."===last)||""===last,up=0,i=srcPath.length;i>=0;i--)"."===(last=srcPath[i])?srcPath.splice(i,1):".."===last?(srcPath.splice(i,1),up++):up&&(srcPath.splice(i,1),up--);if(!mustEndAbs&&!removeAllDots)for(;up--;up)srcPath.unshift("..");!mustEndAbs||""===srcPath[0]||srcPath[0]&&"/"===srcPath[0].charAt(0)||srcPath.unshift(""),hasTrailingSlash&&"/"!==srcPath.join("/").substr(-1)&&srcPath.push("");var authInHost,isAbsolute=""===srcPath[0]||srcPath[0]&&"/"===srcPath[0].charAt(0);psychotic&&(result.hostname=result.host=isAbsolute?"":srcPath.length?srcPath.shift():"",(authInHost=!!(result.host&&result.host.indexOf("@")>0)&&result.host.split("@"))&&(result.auth=authInHost.shift(),result.host=result.hostname=authInHost.shift()));return(mustEndAbs=mustEndAbs||result.host&&srcPath.length)&&!isAbsolute&&srcPath.unshift(""),srcPath.length?result.pathname=srcPath.join("/"):(result.pathname=null,result.path=null),util.isNull(result.pathname)&&util.isNull(result.search)||(result.path=(result.pathname?result.pathname:"")+(result.search?result.search:"")),result.auth=relative.auth||result.auth,result.slashes=result.slashes||relative.slashes,result.href=result.format(),result},Url.prototype.parseHost=function(){var host=this.host,port=portPattern.exec(host);port&&(":"!==(port=port[0])&&(this.port=port.substr(1)),host=host.substr(0,host.length-port.length)),host&&(this.hostname=host)}},2502:module=>{"use strict";module.exports={isString:function(arg){return"string"==typeof arg},isObject:function(arg){return"object"==typeof arg&&null!==arg},isNull:function(arg){return null===arg},isNullOrUndefined:function(arg){return null==arg}}},8201:module=>{module.exports=[{type:"create_arrow",message0:"create arrow %1 x position %2 y position %3 x velocity %4 y velocity %5 angle %6 steps until despawn %7",args0:[{type:"input_dummy"},{type:"input_value",name:"arrow_xpos",check:"Number",align:"RIGHT"},{type:"input_value",name:"arrow_ypos",check:"Number",align:"RIGHT"},{type:"input_value",name:"arrow_xvel",check:"Number",align:"RIGHT"},{type:"input_value",name:"arrow_yvel",check:"Number",align:"RIGHT"},{type:"input_value",name:"arrow_angle",check:"Number",align:"RIGHT"},{type:"input_value",name:"arrow_time",check:"Number",align:"RIGHT"}],inputsInline:!1,previousStatement:null,nextStatement:null,colour:230,tooltip:"Create an arrow.",helpUrl:""},{type:"player_die",message0:"kill %1 %2 %3 , %4 respawn",args0:[{type:"field_dropdown",name:"player",options:[["your player","self"],["player with id","id"]]},{type:"input_dummy"},{type:"input_value",name:"player_id",check:"Number"},{type:"field_dropdown",name:"allow_respawn",options:[["allow","true"],["don't allow","false"]]}],inputsInline:!0,previousStatement:null,colour:230,tooltip:"Kill a player. Not allowing a player to respawn makes the player stay killed until the round ends, even when respawn on death is activated.",helpUrl:""},{type:"draw_line",lastDummyAlign0:"RIGHT",message0:"draw line %1 from x %2 y %3 to x %4 y %5 width %6 colour %7 alpha (0 to 100) %8 anchored to player? %9 %10 only visible to player? %11 %12 doesn't move with camera? %13",args0:[{type:"input_dummy"},{type:"input_value",name:"line_x1",check:"Number",align:"RIGHT"},{type:"input_value",name:"line_y1",check:"Number",align:"RIGHT"},{type:"input_value",name:"line_x2",check:"Number",align:"RIGHT"},{type:"input_value",name:"line_y2",check:"Number",align:"RIGHT"},{type:"input_value",name:"line_width",check:"Number",align:"RIGHT"},{type:"input_value",name:"line_color",check:"Colour",align:"RIGHT"},{type:"input_value",name:"line_alpha",check:"Number",align:"RIGHT"},{type:"field_checkbox",name:"line_anchored",checked:!1},{type:"input_dummy",align:"RIGHT"},{type:"field_checkbox",name:"line_onlyplayer",checked:!1},{type:"input_dummy",align:"RIGHT"},{type:"field_checkbox",name:"line_nocameramove",checked:!1}],inputsInline:!1,previousStatement:null,nextStatement:null,colour:160,tooltip:'Draw a line to the screen. If the drawing is anchored to player, the "don\'t move with camera" option will be ignored.',helpUrl:""},{type:"draw_rect",lastDummyAlign0:"RIGHT",message0:"draw rectangle %1 x %2 y %3 width %4 height %5 angle %6 colour %7 alpha (0 to 100) %8 anchored to player? %9 %10 only visible to player? %11 %12 doesn't move with camera? %13",args0:[{type:"input_dummy"},{type:"input_value",name:"rect_x1",check:"Number",align:"RIGHT"},{type:"input_value",name:"rect_y1",check:"Number",align:"RIGHT"},{type:"input_value",name:"rect_x2",check:"Number",align:"RIGHT"},{type:"input_value",name:"rect_y2",check:"Number",align:"RIGHT"},{type:"input_value",name:"rect_angle",check:"Number",align:"RIGHT"},{type:"input_value",name:"rect_color",check:"Colour",align:"RIGHT"},{type:"input_value",name:"rect_alpha",check:"Number",align:"RIGHT"},{type:"field_checkbox",name:"rect_anchored",checked:!1},{type:"input_dummy",align:"RIGHT"},{type:"field_checkbox",name:"rect_onlyplayer",checked:!1},{type:"input_dummy",align:"RIGHT"},{type:"field_checkbox",name:"rect_nocameramove",checked:!1}],inputsInline:!1,previousStatement:null,nextStatement:null,colour:160,tooltip:'Draw a rectangle to the screen.  If the drawing is anchored to player, the "don\'t move with camera" option will be ignored.',helpUrl:""},{type:"draw_circle",lastDummyAlign0:"RIGHT",message0:"draw circle %1 at x %2 y %3 with radius %4 colour %5 alpha (0 to 100) %6 anchored to player? %7 %8 only visible to player? %9 %10 doesn't move with camera? %11",args0:[{type:"input_dummy"},{type:"input_value",name:"circ_x",check:"Number",align:"RIGHT"},{type:"input_value",name:"circ_y",check:"Number",align:"RIGHT"},{type:"input_value",name:"circ_radius",check:"Number",align:"RIGHT"},{type:"input_value",name:"circ_color",check:"Colour",align:"RIGHT"},{type:"input_value",name:"circ_alpha",check:"Number",align:"RIGHT"},{type:"field_checkbox",name:"circ_anchored",checked:!1},{type:"input_dummy",align:"RIGHT"},{type:"field_checkbox",name:"circ_onlyplayer",checked:!1},{type:"input_dummy",align:"RIGHT"},{type:"field_checkbox",name:"circ_nocameramove",checked:!1}],inputsInline:!1,previousStatement:null,nextStatement:null,colour:160,tooltip:'Draw a circle to the screen.  If the drawing is anchored to player, the "don\'t move with camera" option will be ignored.',helpUrl:""},{type:"draw_text",lastDummyAlign0:"RIGHT",message0:"draw text %1 text %2 at x %3 y %4 size %5 colour %6 alpha (0 to 100) %7 centered? %8 %9 anchored to player? %10 %11 only visible to player? %12 %13 doesn't move with camera? %14",args0:[{type:"input_dummy"},{type:"input_value",name:"text_string",check:"String",align:"RIGHT"},{type:"input_value",name:"text_x",check:"Number",align:"RIGHT"},{type:"input_value",name:"text_y",check:"Number",align:"RIGHT"},{type:"input_value",name:"text_size",check:"Number",align:"RIGHT"},{type:"input_value",name:"text_color",check:"Colour",align:"RIGHT"},{type:"input_value",name:"text_alpha",check:"Number",align:"RIGHT"},{type:"field_checkbox",name:"text_centered",checked:!1},{type:"input_dummy",align:"RIGHT"},{type:"field_checkbox",name:"text_anchored",checked:!1},{type:"input_dummy",align:"RIGHT"},{type:"field_checkbox",name:"text_onlyplayer",checked:!1},{type:"input_dummy",align:"RIGHT"},{type:"field_checkbox",name:"text_nocameramove",checked:!1}],inputsInline:!1,previousStatement:null,nextStatement:null,colour:160,tooltip:"Draw text to the screen.  If the drawing is anchored to player, the \"don't move with camera\" option will be ignored. Text is resource intensive, so it's a bad idea to have more than 20 of them on screen.",helpUrl:""},{type:"draw_clear",message0:"clear player's drawings",inputsInline:!1,previousStatement:null,nextStatement:null,colour:160,tooltip:"Clear all previous drawings from the player.",helpUrl:""},{type:"on_each_phys_frame",message0:"on physics step %1 %2",args0:[{type:"input_dummy"},{type:"input_statement",name:"code"}],colour:20,tooltip:"Executes every time the physics get calculated (30 times a second).",helpUrl:""},{type:"on_each_render_frame",message0:"on render %1 %2",args0:[{type:"input_dummy"},{type:"input_statement",name:"code"}],colour:20,tooltip:'Executes every time the game is rendered (varies depending on your FPS). Game modifying blocks such as "set player\'s x position" do not work here.',helpUrl:""},{type:"on_player_collide",message0:"when the player collides with  %1 %2 store info in variables %3 %4 %5 %6 %7 %8 %9 %10 %11",args0:[{type:"field_dropdown",name:"collide_type",options:[["another player","collide_player"],["an arrow","collide_arrow"],["a platform","collide_platform"]]},{type:"input_dummy"},{type:"field_checkbox",name:"return_info",checked:!1},{type:"field_variable",name:"player_id",variable:"hit player id"},{type:"field_variable",name:"arrow_id",variable:"hit arrow number"},{type:"field_variable",name:"platform_id",variable:"hit platform id"},{type:"field_variable",name:"shape_id",variable:"hit shape number"},{type:"field_variable",name:"normal_x",variable:"hit normal x"},{type:"field_variable",name:"normal_y",variable:"hit normal y"},{type:"input_dummy"},{type:"input_statement",name:"code"}],colour:20,tooltip:"Executes when the player collides with a specified type of object.",helpUrl:""},{type:"on_round_start",message0:"on round start %1 %2",args0:[{type:"input_dummy"},{type:"input_statement",name:"code"}],colour:20,tooltip:"Executes when a round starts.",helpUrl:""},{type:"set_player_prop",message0:"set %1 %2 %3 %4 to %5",args0:[{type:"field_dropdown",name:"player",options:[["your","self"],["player with id","id"]]},{type:"input_dummy"},{type:"input_value",name:"player_id",check:"Number"},{type:"field_dropdown",name:"player_prop",options:[["x position","x"],["y position","y"],["x velocity","xv"],["y velocity","yv"],["angle","a"]]},{type:"input_value",name:"set_number",check:"Number"}],inputsInline:!0,previousStatement:null,nextStatement:null,colour:230,tooltip:"Set a player's property to a specified value.",helpUrl:""},{type:"get_player_prop",message0:"get %1 %2 %3 %4",args0:[{type:"field_dropdown",name:"player",options:[["your","self"],["player with id","id"]]},{type:"input_dummy"},{type:"input_value",name:"player_id",check:"Number"},{type:"field_dropdown",name:"property",options:[["x position","x"],["y position","y"],["x velocity","xv"],["y velocity","yv"],["angle","a"],["size","size"]]}],inputsInline:!0,output:"Number",colour:230,tooltip:"Get a player's property. If the player doesn't exist, it will return 0.",helpUrl:""},{type:"set_last_arrow_prop",message0:"set %1 %2 %3 %4 %5 %6 %7 to %8",args0:[{type:"field_dropdown",name:"player",options:[["your","self"],["player with id","id"]]},{type:"input_dummy"},{type:"input_value",name:"player_id",check:"Number"},{type:"field_dropdown",name:"arrow",options:[["last arrow","last"],["arrow number","id"],["arrows","all"]]},{type:"input_dummy"},{type:"input_value",name:"arrow_id",check:"Number"},{type:"field_dropdown",name:"arrow_prop",options:[["x position","x"],["y position","y"],["x velocity","xv"],["y velocity","yv"],["angle","a"],["amount of steps until despawn","fte"]]},{type:"input_value",name:"set_number",check:"Number"}],inputsInline:!0,previousStatement:null,nextStatement:null,colour:230,tooltip:"Set a player's arrow's property to a specified value.",helpUrl:""},{type:"pressing_key",message0:"%1 %2 %3 is pressing %4",args0:[{type:"field_dropdown",name:"player",options:[["your player","self"],["player with id","id"]]},{type:"input_dummy"},{type:"input_value",name:"player_id",check:"Number"},{type:"field_dropdown",name:"key",options:[["up","up"],["down","down"],["left","left"],["right","right"],["heavy","action"],["special","action2"]]}],inputsInline:!0,output:"Boolean",colour:230,tooltip:"Returns true if the player is pressing the specified key.",helpUrl:""},{type:"on_arrow_collide",message0:"when player's arrow collides with  %1 %2 store info in variables %3 %4 %5 %6 %7 %8 %9 %10 %11 %12",args0:[{type:"field_dropdown",name:"collide_type",options:[["a player","collide_player"],["another arrow","collide_arrow"],["a platform","collide_platform"]]},{type:"input_dummy"},{type:"field_checkbox",name:"return_info",checked:!1},{type:"field_variable",name:"self_arrow_id",variable:"own arrow number"},{type:"field_variable",name:"player_id",variable:"hit player id"},{type:"field_variable",name:"arrow_id",variable:"hit arrow number"},{type:"field_variable",name:"platform_id",variable:"hit platform id"},{type:"field_variable",name:"shape_id",variable:"hit shape number"},{type:"field_variable",name:"normal_x",variable:"hit normal x"},{type:"field_variable",name:"normal_y",variable:"hit normal y"},{type:"input_dummy"},{type:"input_statement",name:"code"}],colour:20,tooltip:"Executes when any of the player's arrows collides with a specified type of object.",helpUrl:""},{type:"unit_to_pixel",message0:"get screen pos of %1",args0:[{type:"input_value",name:"unit_value",check:"Number"}],output:"Number",tooltip:"[NO LONGER WORKS]  Turn physics length units into pixels.",helpUrl:""},{type:"pixel_to_unit",message0:"get physics pos of %1",args0:[{type:"input_value",name:"unit_value",check:"Number"}],output:"Number",tooltip:"[NO LONGER WORKS] Turn pixels into physics length units.",helpUrl:""},{type:"raycast",lastDummyAlign0:"RIGHT",message0:"raycast from x: %1 y: %2 to x: %3 y: %4 collide with A: %5 %6 B: %7 %8 C: %9 %10 D: %11 %12 players (including self): %13 %14 and return %15 %16 %17 %18 %19 %20 %21 %22",args0:[{type:"input_value",name:"a_x",check:"Number",align:"RIGHT"},{type:"input_value",name:"a_y",check:"Number",align:"RIGHT"},{type:"input_value",name:"b_x",check:"Number",align:"RIGHT"},{type:"input_value",name:"b_y",check:"Number",align:"RIGHT"},{type:"field_checkbox",name:"collide_a",checked:!1},{type:"input_dummy",align:"RIGHT"},{type:"field_checkbox",name:"collide_b",checked:!1},{type:"input_dummy",align:"RIGHT"},{type:"field_checkbox",name:"collide_c",checked:!1},{type:"input_dummy",align:"RIGHT"},{type:"field_checkbox",name:"collide_d",checked:!1},{type:"input_dummy",align:"RIGHT"},{type:"field_checkbox",name:"collide_player",checked:!1},{type:"input_dummy",align:"RIGHT"},{type:"field_variable",name:"point_x",variable:"hit point x"},{type:"field_variable",name:"point_y",variable:"hit point y"},{type:"input_dummy",align:"RIGHT"},{type:"field_variable",name:"normal_x",variable:"hit normal x"},{type:"field_variable",name:"normal_y",variable:"hit normal y"},{type:"input_dummy",align:"RIGHT"},{type:"field_variable",name:"object_type",variable:"hit object type"},{type:"field_variable",name:"object_id",variable:"hit object id"}],inputsInline:!1,output:"Boolean",colour:195,tooltip:'"Throws" a ray from point A to point B. if it hits something, it returns true and sets the specified variables to hit point, normal, object type and id. The "hit object type" returned is text, and it can be either "platform" or "player".',helpUrl:""},{type:"draw_poly",lastDummyAlign0:"RIGHT",message0:"draw polygon %1 with vertex list %2 (2 items = 1 vertex) %3 colour %4 alpha (0 to 100) %5 anchored to player? %6 %7 only visible to player? %8 %9 doesn't move with camera? %10",args0:[{type:"input_dummy"},{type:"input_value",name:"poly_vertex",check:"Array",align:"RIGHT"},{type:"input_dummy",align:"RIGHT"},{type:"input_value",name:"poly_color",check:"Colour",align:"RIGHT"},{type:"input_value",name:"poly_alpha",check:"Number",align:"RIGHT"},{type:"field_checkbox",name:"poly_anchored",checked:!1},{type:"input_dummy",align:"RIGHT"},{type:"field_checkbox",name:"poly_onlyplayer",checked:!1},{type:"input_dummy",align:"RIGHT"},{type:"field_checkbox",name:"poly_nocameramove",checked:!1}],inputsInline:!1,previousStatement:null,nextStatement:null,colour:160,tooltip:'Draw a polygon to the screen. Every pair of items correspond to the x and y coordinates of a vertex.  If the drawing is anchored to player, the "don\'t move with camera" option will be ignored.',helpUrl:""},{type:"deg_to_rad",message0:"degrees to radians %1",args0:[{type:"input_value",name:"degree_value",check:"Number"}],output:"Number",colour:230,tooltip:"Turn degrees into radians.",helpUrl:""},{type:"rad_to_deg",message0:"radians to degrees %1",args0:[{type:"input_value",name:"radian_value",check:"Number"}],output:"Number",colour:230,tooltip:"Turn radians into degrees.",helpUrl:""},{type:"delete_arrows",message0:"delete %1 %2 %3 %4 %5 %6",args0:[{type:"field_dropdown",name:"player",options:[["your","self"],["player with id","id"]]},{type:"input_dummy"},{type:"input_value",name:"player_id",check:"Number"},{type:"field_dropdown",name:"arrow",options:[["arrows","all"],["last arrow","last"],["arrow number","id"]]},{type:"input_dummy"},{type:"input_value",name:"arrow_id",check:"Number"}],inputsInline:!0,previousStatement:null,nextStatement:null,colour:230,tooltip:"Delete an arrow or all arrows that belong to a player.",helpUrl:""},{type:"math_atan2",message0:"atan2 of x: %1 y: %2",args0:[{type:"input_value",name:"x",check:"Number"},{type:"input_value",name:"y",check:"Number"}],inputsInline:!0,output:"Number",colour:230,tooltip:"Returns the atan2 of the specified coordinate, in degrees.",helpUrl:""},{type:"math_distance",message0:"distance between x: %1 y: %2 and x: %3 y: %4",args0:[{type:"input_value",name:"a_x",check:"Number"},{type:"input_value",name:"a_y",check:"Number"},{type:"input_value",name:"b_x",check:"Number"},{type:"input_value",name:"b_y",check:"Number"}],inputsInline:!0,output:"Number",colour:230,tooltip:"Returns the distance between two points.",helpUrl:""},{type:"get_player_color",message0:"get %1 %2 %3 main colour",args0:[{type:"field_dropdown",name:"player",options:[["your player's","self"],["player with id","id"]]},{type:"input_dummy"},{type:"input_value",name:"player_id",check:"Number"}],inputsInline:!0,output:"Colour",colour:160,tooltip:"Get a player's main (background) colour.",helpUrl:""},{type:"change_last_arrow_prop",message0:"change %1 %2 %3 %4 %5 %6 %7 by %8",args0:[{type:"field_dropdown",name:"player",options:[["your","self"],["player with id","id"]]},{type:"input_dummy"},{type:"input_value",name:"player_id",check:"Number"},{type:"field_dropdown",name:"arrow",options:[["last arrow","last"],["arrow number","id"],["arrows","all"]]},{type:"input_dummy"},{type:"input_value",name:"arrow_id",check:"Number"},{type:"field_dropdown",name:"arrow_prop",options:[["x position","x"],["y position","y"],["x velocity","xv"],["y velocity","yv"],["angle","a"],["steps until despawn","fte"]]},{type:"input_value",name:"change_number",check:"Number"}],inputsInline:!0,previousStatement:null,nextStatement:null,colour:230,tooltip:"Change a player's arrow's property by a specified value.",helpUrl:""},{type:"get_last_arrow_prop",message0:"get %1 %2 %3 %4 %5 %6 's %7",args0:[{type:"field_dropdown",name:"player",options:[["your","self"],["player with id","id"]]},{type:"input_dummy"},{type:"input_value",name:"player_id",check:"Number"},{type:"field_dropdown",name:"arrow",options:[["last arrow","last"],["arrow number","id"]]},{type:"input_dummy"},{type:"input_value",name:"arrow_id",check:"Number"},{type:"field_dropdown",name:"property",options:[["x position","x"],["y position","y"],["x velocity","xv"],["y velocity","yv"],["angle","a"],["steps until despawn","fte"]]}],inputsInline:!0,output:"Number",colour:230,tooltip:"Get a player's arrow's property.",helpUrl:""},{type:"change_player_prop",message0:"change %1 %2 %3 %4 by %5",args0:[{type:"field_dropdown",name:"player",options:[["your","self"],["player with id","id"]]},{type:"input_dummy"},{type:"input_value",name:"player_id",check:"Number"},{type:"field_dropdown",name:"player_prop",options:[["x position","x"],["y position","y"],["x velocity","xv"],["y velocity","yv"],["angle","a"]]},{type:"input_value",name:"change_number",check:"Number"}],inputsInline:!0,previousStatement:null,nextStatement:null,colour:230,tooltip:"Set a player's property to a specified value.",helpUrl:""},{type:"get_arrow_amount",message0:"get %1 %2 %3 arrow amount",args0:[{type:"field_dropdown",name:"player",options:[["your","self"],["player with id","id"]]},{type:"input_dummy"},{type:"input_value",name:"player_id",check:"Number"}],inputsInline:!0,output:"Number",colour:230,tooltip:"Get the amount of arrows a player has.",helpUrl:""},{type:"get_map_size",message0:"get map size",output:"Number",colour:195,tooltip:"Gives you the map size. This is useful when you need a physics coordinate that is constant between map sizes.",helpUrl:""},{type:"get_own_id",message0:"get %1 player id",args0:[{type:"field_dropdown",name:"player",options:[["your","self"],["host's","host"]]}],output:"Number",colour:230,tooltip:"Get your player's id, or the host's player id.",helpUrl:""},{type:"input_override",message0:"override %1 %2 %3 %4 key to %5 %6",args0:[{type:"field_dropdown",name:"player",options:[["your","self"],["player with id","id"]]},{type:"input_dummy"},{type:"input_value",name:"player_id",check:"Number"},{type:"field_dropdown",name:"key",options:[["up","up"],["down","down"],["left","left"],["right","right"],["heavy","action"],["special","action2"]]},{type:"input_dummy"},{type:"input_value",name:"override_value",check:"Boolean"}],inputsInline:!0,previousStatement:null,nextStatement:null,colour:230,tooltip:'Overrides a key to be on/off until a "stop overriding" block. Only built-in behaviour related to that key will be overriden, the real value is still visible to the custom mode.',helpUrl:""},{type:"stop_input_override",message0:"stop overriding %1 %2 %3 %4 key",args0:[{type:"field_dropdown",name:"player",options:[["your","self"],["player with id","id"]]},{type:"input_dummy"},{type:"input_value",name:"player_id",check:"Number"},{type:"field_dropdown",name:"key",options:[["up","up"],["down","down"],["left","left"],["right","right"],["heavy","action"],["special","action2"]]}],inputsInline:!0,previousStatement:null,nextStatement:null,colour:230,tooltip:"Stop overriding a key.",helpUrl:""},{type:"get_player_id_list",message0:"get all player ids as list",output:"Array",colour:230,tooltip:"Returns a list that contains the ids of all alive players.",helpUrl:""},{type:"rectangle_shape",message0:"rectangle shape %1 colour %2 x %3 y %4 width %5 height %6 angle %7 no physics %8 , no grapple %9 %10 inner grap %11 , death %12",args0:[{type:"input_dummy"},{type:"input_value",name:"color",check:"Colour",align:"RIGHT"},{type:"input_value",name:"xpos",check:"Number",align:"RIGHT"},{type:"input_value",name:"ypos",check:"Number",align:"RIGHT"},{type:"input_value",name:"width",check:"Number",align:"RIGHT"},{type:"input_value",name:"height",check:"Number",align:"RIGHT"},{type:"input_value",name:"angle",check:"Number",align:"RIGHT"},{type:"field_checkbox",name:"nophys",checked:!1},{type:"field_checkbox",name:"nograp",checked:!1},{type:"input_dummy"},{type:"field_checkbox",name:"ingrap",checked:!1},{type:"field_checkbox",name:"death",checked:!1}],inputsInline:!1,output:"Shape",colour:195,tooltip:'Defines a rectangle shape to use in the "create platform" block.',helpUrl:""},{type:"circle_shape",message0:"circle shape %1 colour %2 x %3 y %4 radius %5 no physics %6 , no grapple %7 %8 inner grap %9 , death %10",args0:[{type:"input_dummy"},{type:"input_value",name:"color",check:"Colour",align:"RIGHT"},{type:"input_value",name:"xpos",check:"Number",align:"RIGHT"},{type:"input_value",name:"ypos",check:"Number",align:"RIGHT"},{type:"input_value",name:"radius",check:"Number",align:"RIGHT"},{type:"field_checkbox",name:"nophys",checked:!1},{type:"field_checkbox",name:"nograp",checked:!1},{type:"input_dummy"},{type:"field_checkbox",name:"ingrap",checked:!1},{type:"field_checkbox",name:"death",checked:!1}],inputsInline:!1,output:"Shape",colour:195,tooltip:'Defines a circle shape to use in the "create platform" block.',helpUrl:""},{type:"polygon_shape",message0:"polygon shape %1 colour %2 x %3 y %4 vertex list %5 (2 values = 1 vertex) %6 angle %7 scale %8 no physics %9 , no grapple %10 %11 inner grap %12 , death %13",args0:[{type:"input_dummy"},{type:"input_value",name:"color",check:"Colour",align:"RIGHT"},{type:"input_value",name:"xpos",check:"Number",align:"RIGHT"},{type:"input_value",name:"ypos",check:"Number",align:"RIGHT"},{type:"input_value",name:"vertex",check:"Array",align:"RIGHT"},{type:"input_dummy",align:"RIGHT"},{type:"input_value",name:"angle",check:"Number",align:"RIGHT"},{type:"input_value",name:"scale",check:"Number",align:"RIGHT"},{type:"field_checkbox",name:"nophys",checked:!1},{type:"field_checkbox",name:"nograp",checked:!1},{type:"input_dummy"},{type:"field_checkbox",name:"ingrap",checked:!1},{type:"field_checkbox",name:"death",checked:!1}],inputsInline:!1,output:"Shape",colour:195,tooltip:'Defines a polygon shape to use in the "create platform" block.',helpUrl:""},{type:"create_platform",message0:"create platform %1 return id %2 %3 type %4 %5 shape list %6 x %7 y %8 angle %9 bounciness %10 density %11 friction %12 fric players %13 collide group %14 %15 collide with.. %16 players %17 , group A %18 , group B %19 , %20 group C %21 , group D %22",args0:[{type:"input_dummy"},{type:"field_checkbox",name:"return_id",checked:!1},{type:"input_dummy",align:"RIGHT"},{type:"field_dropdown",name:"type",options:[["stationary","s"],["free moving","d"],["kinematic","k"]]},{type:"input_dummy",align:"RIGHT"},{type:"input_value",name:"shape_list",check:"Array",align:"RIGHT"},{type:"input_value",name:"xpos",check:"Number",align:"RIGHT"},{type:"input_value",name:"ypos",check:"Number",align:"RIGHT"},{type:"input_value",name:"angle",check:"Number",align:"RIGHT"},{type:"input_value",name:"bounciness",check:"Number",align:"RIGHT"},{type:"input_value",name:"density",check:"Number",align:"RIGHT"},{type:"input_value",name:"friction",check:"Number",align:"RIGHT"},{type:"input_value",name:"fricp",check:"Boolean",align:"RIGHT"},{type:"field_dropdown",name:"colgroup",options:[["A","1"],["B","2"],["C","3"],["D","4"]]},{type:"input_dummy",align:"RIGHT"},{type:"input_dummy"},{type:"field_checkbox",name:"colplayers",checked:!0},{type:"field_checkbox",name:"cola",checked:!0},{type:"field_checkbox",name:"colb",checked:!0},{type:"input_dummy"},{type:"field_checkbox",name:"colc",checked:!0},{type:"field_checkbox",name:"cold",checked:!0}],inputsInline:!1,previousStatement:null,nextStatement:null,colour:195,tooltip:"Create a platform with the specified shapes and properties. Be aware that this may lag the game if done too often. ",helpUrl:""},{type:"set_platform_prop",message0:"set platform with id %1 's %2 to %3",args0:[{type:"input_value",name:"platform_id",check:"Number"},{type:"field_dropdown",name:"platform_prop",options:[["x position","p_x"],["y position","p_y"],["x velocity","lv_x"],["y velocity","lv_y"],["angle","a"],["angular velocity","av"],["bounciness","re"],["density","de"],["friction","fric"],["fric players","fricp"],["collide with players","f_p"],["collide with A","f_1"],["collide with B","f_2"],["collide with C","f_3"],["collide with D","f_4"],["linear drag","ld"],["spin drag","ad"]]},{type:"input_value",name:"set_value",check:["Number","Boolean"]}],inputsInline:!0,previousStatement:null,nextStatement:null,colour:195,tooltip:"Set a platform's property.",helpUrl:""},{type:"change_platform_prop",message0:"change platform with id %1 's %2 by %3",args0:[{type:"input_value",name:"platform_id",check:"Number"},{type:"field_dropdown",name:"platform_prop",options:[["x position","p_x"],["y position","p_y"],["x velocity","lv_x"],["y velocity","lv_y"],["angle","a"],["angular velocity","av"],["bounciness","re"],["density","de"],["friction","fric"],["linear drag","ld"],["spin drag","ad"]]},{type:"input_value",name:"change_value",check:"Number"}],inputsInline:!0,previousStatement:null,nextStatement:null,colour:195,tooltip:"Change a platform's property by a specified amount.",helpUrl:""},{type:"get_platform_prop",message0:"get platform with id %1 's %2",args0:[{type:"input_value",name:"platform_id",check:"Number"},{type:"field_dropdown",name:"platform_prop",options:[["x position","p_x"],["y position","p_y"],["x velocity","lv_x"],["y velocity","lv_y"],["angle","a"],["angular velocity","av"],["bounciness","re"],["density","de"],["friction","fric"],["fric players","fricp"],["collide with players","f_p"],["collide with A","f_1"],["collide with B","f_2"],["collide with C","f_3"],["collide with D","f_4"],["linear drag","ld"],["spin drag","ad"]]}],inputsInline:!0,output:["Number","Boolean"],colour:195,tooltip:"Get a platform's property.",helpUrl:""},{type:"set_shape_prop",message0:"set platform with id %1 's shape # %2 's %3 to %4",args0:[{type:"input_value",name:"platform_id",check:"Number"},{type:"input_value",name:"shape_id",check:"Number"},{type:"field_dropdown",name:"shape_prop",options:[["colour","f_f"],["x offset","s_c_x"],["y offset","s_c_y"],["angle (only rectangle)","s_a"],["width (only rectangle)","s_w"],["height (only rectangle)","s_h"],["radius (only circle)","s_r"],["no physics","f_np"],["no grapple","f_ng"],["inner grapple","f_ig"],["death","f_d"]]},{type:"input_value",name:"set_value",check:["Number","Boolean","Colour"]}],inputsInline:!0,previousStatement:null,nextStatement:null,colour:195,tooltip:"Set a platform's shape's property. Be aware that this may lag the game if done too often.",helpUrl:""},{type:"change_shape_prop",message0:"change platform with id %1 's shape # %2 's %3 by %4",args0:[{type:"input_value",name:"platform_id",check:"Number"},{type:"input_value",name:"shape_id",check:"Number"},{type:"field_dropdown",name:"shape_prop",options:[["x offset","s_c_x"],["y offset","s_c_y"],["angle (only rectangle)","s_a"],["width (only rectangle)","s_w"],["height (only rectangle)","s_h"],["radius (only circle)","s_r"]]},{type:"input_value",name:"change_value",check:"Number"}],inputsInline:!0,previousStatement:null,nextStatement:null,colour:195,tooltip:"Change a platform's shape's property by a specified amount. Be aware that this may lag the game if done too often.",helpUrl:""},{type:"get_shape_prop",message0:"get platform with id %1 's shape # %2 's %3",args0:[{type:"input_value",name:"platform_id",check:"Number"},{type:"input_value",name:"shape_id",check:"Number"},{type:"field_dropdown",name:"shape_prop",options:[["colour","f_f"],["x offset","s_c_x"],["y offset","s_c_y"],["angle (only rectangle)","s_a"],["width (only rectangle)","s_w"],["height (only rectangle)","s_h"],["radius (only circle)","s_r"],["no physics","f_np"],["no grapple","f_ng"],["inner grapple","f_ig"],["death","f_d"]]}],inputsInline:!0,output:["Number","Boolean","Colour"],colour:195,tooltip:"Get a platform's shape's property.",helpUrl:""},{type:"get_shape_amount",message0:"get platform with id %1 's shape amount",args0:[{type:"input_value",name:"platform_id",check:"Number"}],inputsInline:!0,output:"Number",colour:195,tooltip:"Returns the amount of shapes in the specified platform.",helpUrl:""},{type:"delete_platform",message0:"delete platform with id %1",args0:[{type:"input_value",name:"platform_id",check:"Number"}],inputsInline:!0,previousStatement:null,nextStatement:null,colour:195,tooltip:"Delete a platform. Be aware that this may lag the game if done too often.",helpUrl:""},{type:"delete_shape",message0:"delete platform with id %1 's shape # %2",args0:[{type:"input_value",name:"platform_id",check:"Number"},{type:"input_value",name:"shape_id",check:"Number"}],inputsInline:!0,previousStatement:null,nextStatement:null,colour:195,tooltip:"Delete a shape. Be aware that this may lag the game if done too often.",helpUrl:""},{type:"add_shape",message0:"add shape %1 to platform with id %2",args0:[{type:"input_value",name:"shape",check:"Shape"},{type:"input_value",name:"platform_id",check:"Number",align:"RIGHT"}],previousStatement:null,nextStatement:null,colour:195,tooltip:"Add a shape to a platform. Be aware that this may lag the game if done too often.",helpUrl:""},{type:"on_platform_collide",message0:"when any platform collides with  %1 %2 store info in variables %3 %4 %5 %6 %7 %8 %9 %10 %11 %12 %13",args0:[{type:"field_dropdown",name:"collide_type",options:[["a player","collide_player"],["an arrow","collide_arrow"],["another platform","collide_platform"]]},{type:"input_dummy"},{type:"field_checkbox",name:"return_info",checked:!1},{type:"field_variable",name:"self_platform_id",variable:"own platform id"},{type:"field_variable",name:"self_shape_id",variable:"own shape number"},{type:"field_variable",name:"player_id",variable:"hit player id"},{type:"field_variable",name:"arrow_id",variable:"hit arrow number"},{type:"field_variable",name:"platform_id",variable:"hit platform id"},{type:"field_variable",name:"shape_id",variable:"hit shape number"},{type:"field_variable",name:"normal_x",variable:"hit normal x"},{type:"field_variable",name:"normal_y",variable:"hit normal y"},{type:"input_dummy"},{type:"input_statement",name:"code"}],colour:20,tooltip:"Executes when any platform collides with a specified type of object.",helpUrl:""},{type:"get_platform_order",message0:"get list of platform ids on view order",output:"Array",colour:195,tooltip:"Returns a list of all platform ids on view order, front to back (as shown in the map editor).",helpUrl:""},{type:"on_player_die",message0:"on player die %1 %2",args0:[{type:"input_dummy"},{type:"input_statement",name:"code"}],colour:20,tooltip:"Executes right before the player dies.",helpUrl:""},{type:"get_player_name",message0:"get %1 %2 %3 username",args0:[{type:"field_dropdown",name:"player",options:[["your","self"],["player with id","id"]]},{type:"input_dummy"},{type:"input_value",name:"player_id",check:"Number"}],inputsInline:!0,output:"String",colour:160,tooltip:"Returns the player's name.",helpUrl:""},{type:"clone_platform",lastDummyAlign0:"RIGHT",message0:"clone platform with id %1 return id %2",args0:[{type:"input_value",name:"platform_id",check:"Number"},{type:"field_checkbox",name:"return_id",checked:!0}],inputsInline:!1,previousStatement:null,nextStatement:null,colour:195,tooltip:"Clone a platform. Be aware that this may lag the game if done too often.",helpUrl:""},{type:"get_platform_by_name",message0:"get platform with name %1 's id",args0:[{type:"input_value",name:"platform_name",check:"String"}],inputsInline:!0,output:"Number",colour:195,tooltip:"Get a platform\\'s id by its name. If there are multiple platforms with the same name, the oldest one will be chosen.",helpUrl:""},{type:"get_platform_name",message0:"get platform with id %1 's name",args0:[{type:"input_value",name:"platform_id",check:"Number"}],inputsInline:!0,output:"String",colour:195,tooltip:"Get a platform's name.",helpUrl:""},{type:"play_sound",message0:"play sound %1 %2 with volume (0.0 to 1.0) %3 panning type %4 %5 %6 %7",args0:[{type:"field_dropdown",name:"sound_name",options:[["player-platform collision","platBounce"],["player-player collision","discDisc"],["player death","discDeath"],["player offscreen","discOffScreen"],["capzone increase","capIncrease"],["capzone decrease","capDecrease"],["capzone full","capComplete"],["football kick","footKick"],["football bounce","footBounce"],["football goal","footGoal"],["football win swoosh","scoreAnimation"],["countdown beep","digiBeep"],["button hover","classicButtonHover"],["button press","classicButtonClick"],["back/cancel button press","classicButtonBack"]]},{type:"input_dummy"},{type:"input_value",name:"sound_volume",check:"Number",align:"RIGHT"},{type:"field_dropdown",name:"pan_type",options:[["constant","const"],["world position","world"]]},{type:"input_dummy",align:"RIGHT"},{type:"field_label_serializable",name:"sound_pan_name",text:"with panning (-1.0 to 1.0)"},{type:"input_value",name:"sound_pan",check:"Number",align:"RIGHT"}],inputsInline:!1,previousStatement:null,nextStatement:null,colour:0,tooltip:"Plays a sound with a specified amount of volume and panning. Panning type 'constant' means the \"location\" of the sound is always the same, while panning type 'world position' means the \"position\" of the sound is affected by where in the world the camera is.",helpUrl:""},{type:"colour_hex",message0:"hex color code %1",args0:[{type:"input_value",name:"hex_code",check:"String"}],output:"Colour",colour:20,tooltip:"Creates a colour with the hex code.",helpUrl:""},{type:"player_on_team",message0:"%1 %2 %3 is on %4 team",args0:[{type:"field_dropdown",name:"player",options:[["your player","self"],["player with id","id"]]},{type:"input_dummy"},{type:"input_value",name:"player_id",check:"Number"},{type:"field_dropdown",name:"team",options:[["red","2"],["blue","3"],["green","4"],["yellow","5"]]}],inputsInline:!0,output:"Boolean",colour:230,tooltip:"Returns true if the player is on the specified team, if not, returns false.",helpUrl:""},{type:"set_camera_prop",message0:"set %1 %2 %3 camera's %4 to %5",args0:[{type:"field_dropdown",name:"player",options:[["your","self"],["everyone's","all"],["player with id","id"]]},{type:"input_dummy"},{type:"input_value",name:"player_id",check:"Number"},{type:"field_dropdown",name:"camera_prop",options:[["x position","xpos"],["y position","ypos"],["angle","angle"],["x scale","xscal"],["y scale","yscal"],["x skew","xskew"],["y skew","yskew"]]},{type:"input_value",name:"set_number",check:"Number"}],inputsInline:!0,previousStatement:null,nextStatement:null,colour:0,tooltip:"Set one of the camera's properties to a specified value. You can make it so that only one player's camera is modified.",helpUrl:""},{type:"change_camera_prop",message0:"change %1 %2 %3 camera's %4 by %5",args0:[{type:"field_dropdown",name:"player",options:[["your","self"],["everyone's","all"],["player with id","id"]]},{type:"input_dummy"},{type:"input_value",name:"player_id",check:"Number"},{type:"field_dropdown",name:"camera_prop",options:[["x position","xpos"],["y position","ypos"],["angle","angle"],["x scale","xscal"],["y scale","yscal"],["x skew","xskew"],["y skew","yskew"]]},{type:"input_value",name:"change_number",check:"Number"}],inputsInline:!0,previousStatement:null,nextStatement:null,colour:0,tooltip:"Change one of the camera's properties by a specified amount. You can make it so that only one player's camera is modified.",helpUrl:""},{type:"get_camera_prop",lastDummyAlign0:"RIGHT",message0:"get %1 %2 %3 camera's %4",args0:[{type:"field_dropdown",name:"player",options:[["your","self"],["player with id","id"]]},{type:"input_dummy"},{type:"input_value",name:"player_id",check:"Number"},{type:"field_dropdown",name:"camera_prop",options:[["x position","xpos"],["y position","ypos"],["angle","angle"],["x scale","xscal"],["y scale","yscal"],["x skew","xskew"],["y skew","yskew"]]}],inputsInline:!0,output:"Number",colour:0,tooltip:"Get one of the camera's properties of a specified player. Different players can have different camera properties.",helpUrl:""},{type:"change_camera_lerp",message0:"%1 camera interpolation for %2 %3 %4",args0:[{type:"field_dropdown",name:"enable",options:[["enable","true"],["disable","false"]]},{type:"field_dropdown",name:"player",options:[["everyone","all"],["yourself","self"],["player with id","id"]]},{type:"input_dummy"},{type:"input_value",name:"player_id",check:"Number"}],inputsInline:!0,previousStatement:null,nextStatement:null,colour:0,tooltip:"Enables or disables camera interpolation between physics steps. Enable this if you want a smoother look when moving around the camera, disable it if you want to make a hard transition from one place to another. This is enabled by default.",helpUrl:""},{type:"change_death_barrier",message0:"%1 death barrier",args0:[{type:"field_dropdown",name:"enable",options:[["enable","true"],["disable","false"]]}],previousStatement:null,nextStatement:null,colour:0,tooltip:"Enables or disables the vanilla death barrier that kills players when they touch the map's ground or go too far from the screen.",helpUrl:""},{type:"variables_retain_value",message0:"keep value of %1 on next round",args0:[{type:"field_variable",name:"VAR",variable:"item"}],previousStatement:null,nextStatement:null,colour:330,tooltip:"Mantain the value of this variable to the next round. Normally, variables get wiped up when a new round starts. When you execute this block, the variable is set to keep its value when moving on to the next round.",helpUrl:""},{type:"get_screen_prop",message0:"%1 of screen",args0:[{type:"field_dropdown",name:"screen_prop",options:[["width","width"],["height","height"]]}],output:"Number",colour:160,tooltip:"Get width or height of screen (in gmmaker units, not in pixels).",helpUrl:""},{type:"variables_get",message0:"%1 %2 %3 %4",args0:[{type:"field_dropdown",name:"player",options:[["your","self"],["player with id","id"]]},{type:"input_dummy",name:"drop_container"},{type:"input_value",name:"player_id",check:"Number"},{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"}],inputsInline:!0,output:null,style:"variable_blocks",helpUrl:"%{BKY_VARIABLES_GET_HELPURL}",tooltip:"%{BKY_VARIABLES_GET_TOOLTIP}",extensions:["contextMenu_variableSetterGetter"]},{type:"variables_set",message0:"set %1 %2 %3 %4 %5 to %6 %7",args0:[{type:"input_dummy"},{type:"field_dropdown",name:"player",options:[["your","self"],["player with id","id"]]},{type:"input_dummy",name:"drop_container"},{type:"input_value",name:"player_id",check:"Number"},{type:"field_variable",name:"VAR",variable:"item"},{type:"input_dummy"},{type:"input_value",name:"VALUE"}],inputsInline:!0,previousStatement:null,nextStatement:null,style:"variable_blocks",tooltip:"%{BKY_VARIABLES_SET_TOOLTIP}",helpUrl:"%{BKY_VARIABLES_SET_HELPURL}",extensions:["contextMenu_variableSetterGetter"]},{type:"math_change",message0:"change %1 %2 %3 %4 %5 by %6 %7",args0:[{type:"input_dummy"},{type:"field_dropdown",name:"player",options:[["your","self"],["player with id","id"]]},{type:"input_dummy",name:"drop_container"},{type:"input_value",name:"player_id",check:"Number"},{type:"field_variable",name:"VAR",variable:"item"},{type:"input_dummy"},{type:"input_value",name:"DELTA",check:"Number"}],inputsInline:!0,previousStatement:null,nextStatement:null,style:"variable_blocks",tooltip:"",helpUrl:"%{BKY_MATH_CHANGE_HELPURL}",extensions:["math_change_tooltip"]}]},8557:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var blockly__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(4948),blockly__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(blockly__WEBPACK_IMPORTED_MODULE_0__);function __WEBPACK_DEFAULT_EXPORT__(){blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.draw_line=function(block){const x1=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"line_x1",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC),y1=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"line_y1",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC),x2=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"line_x2",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC),y2=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"line_y2",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC),width=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"line_width",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC),color=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"line_color",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC);let alpha=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"line_alpha",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC);""===alpha&&(alpha="100");return`gm.blockly.funcs.createLine(playerid,${x1},${y1},${x2},${y2},${color},${alpha},${width},${"TRUE"===block.getFieldValue("line_anchored")},${"TRUE"===block.getFieldValue("line_onlyplayer")},${"TRUE"===block.getFieldValue("line_nocameramove")});`},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.draw_rect=function(block){const x1=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"rect_x1",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC),y1=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"rect_y1",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC),x2=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"rect_x2",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC),y2=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"rect_y2",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC),angle=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"rect_angle",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC)||"0",color=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"rect_color",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC);let alpha=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"rect_alpha",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC);""===alpha&&(alpha="100");return`gm.blockly.funcs.createRect(playerid,${x1},${y1},${x2},${y2},${angle},${color},${alpha},${"TRUE"===block.getFieldValue("rect_anchored")},${"TRUE"===block.getFieldValue("rect_onlyplayer")},${"TRUE"===block.getFieldValue("rect_nocameramove")});`},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.draw_circle=function(block){const x=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"circ_x",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC),y=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"circ_y",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC),radius=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"circ_radius",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC),color=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"circ_color",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC);let alpha=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"circ_alpha",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC);""===alpha&&(alpha="100");return`gm.blockly.funcs.createCircle(playerid,${x},${y},${radius},${color},${alpha},${"TRUE"===block.getFieldValue("circ_anchored")},${"TRUE"===block.getFieldValue("circ_onlyplayer")},${"TRUE"===block.getFieldValue("circ_nocameramove")});`},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.draw_poly=function(block){const vertex=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"poly_vertex",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC),color=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"poly_color",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC);let alpha=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"poly_alpha",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC);""===alpha&&(alpha="100");return`gm.blockly.funcs.createPoly(playerid,${vertex},${color},${alpha},${"TRUE"===block.getFieldValue("poly_anchored")},${"TRUE"===block.getFieldValue("poly_onlyplayer")},${"TRUE"===block.getFieldValue("poly_nocameramove")});`},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.draw_text=function(block){var string=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"text_string",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC),x=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"text_x",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC),y=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"text_y",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC),size=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"text_size",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC),color=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"text_color",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC),alpha=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"text_alpha",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC);""===alpha&&(alpha="100");return`gm.blockly.funcs.createText(playerid,${x},${y},${color},${alpha},${string},${size},${"TRUE"===block.getFieldValue("text_centered")},${"TRUE"===block.getFieldValue("text_anchored")},${"TRUE"===block.getFieldValue("text_onlyplayer")},${"TRUE"===block.getFieldValue("text_nocameramove")});`},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.draw_clear=function(block){return"gm.blockly.funcs.clearGraphics(playerid);"},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.get_player_color=function(block){const player=block.getFieldValue("player"),player_id=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"player_id",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC)||null;return[`gm.blockly.funcs.getPlayerColor(gst, ${"self"===player?"playerid":player_id})`,blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_NONE]},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.set_player_prop=function(block){const player=block.getFieldValue("player"),player_id=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"player_id",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC)||null,player_prop=block.getFieldValue("player_prop");return`gm.blockly.funcs.setPlayerProperty(gst, ${"self"===player?"playerid":player_id}, "${player_prop}", ${blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"set_number",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC)}${"a"==player_prop?"*(Math.PI/180)":""});`},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.change_player_prop=function(block){const player=block.getFieldValue("player"),player_id=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"player_id",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC)||null,player_prop=block.getFieldValue("player_prop");return`gm.blockly.funcs.changePlayerProperty(gst, ${"self"===player?"playerid":player_id}, "${player_prop}", ${blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"change_number",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC)}${"a"==player_prop?"*(Math.PI/180)":""});`},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.set_last_arrow_prop=function(block){const player=block.getFieldValue("player"),player_id=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"player_id",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC)||null,arrow=block.getFieldValue("arrow"),arrow_id=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"arrow_id",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC)||null,arrow_prop=block.getFieldValue("arrow_prop"),set_number=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"set_number",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC);let code="";return code="all"===arrow?`gm.blockly.funcs.setAllArrowsProperty(gst, ${"self"===player?"playerid":player_id}, "${arrow_prop}", ${set_number}${"a"==arrow_prop?"*(Math.PI/180)":""});`:`gm.blockly.funcs.setArrowProperty(gst, ${"self"===player?"playerid":player_id}, ${"last"===arrow?"gm.blockly.funcs.getArrowAmount(gst, playerid)":arrow_id}, "${arrow_prop}", ${set_number}${"a"==arrow_prop?"*(Math.PI/180)":""});`,code},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.change_last_arrow_prop=function(block){const player=block.getFieldValue("player"),player_id=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"player_id",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC)||null,arrow=block.getFieldValue("arrow"),arrow_id=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"arrow_id",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC)||null,arrow_prop=block.getFieldValue("arrow_prop"),change_number=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"change_number",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC);let code="";return code="all"===arrow?`gm.blockly.funcs.changeAllArrowsProperty(gst, ${"self"===player?"playerid":player_id}, "${arrow_prop}", ${change_number}${"a"==arrow_prop?"*(Math.PI/180)":""});`:`gm.blockly.funcs.changeArrowProperty(gst, ${"self"===player?"playerid":player_id}, ${"last"===arrow?"gm.blockly.funcs.getArrowAmount(gst, playerid)":arrow_id}, "${arrow_prop}", ${change_number}${"a"==arrow_prop?"*(Math.PI/180)":""});`,code},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.get_player_prop=function(block){const player=block.getFieldValue("player"),player_id=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"player_id",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC)||null,player_prop=block.getFieldValue("property");return["size"===player_prop?"gm.blockly.funcs.getPlayerSize(playerid)":`gm.blockly.funcs.getPlayerProperty(gst, ${"self"===player?"playerid":player_id}, "${player_prop}")${"a"==player_prop?"*(180/Math.PI)":""}`,blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_NONE]},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.get_last_arrow_prop=function(block){const player=block.getFieldValue("player"),player_id=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"player_id",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC)||null,arrow=block.getFieldValue("arrow"),arrow_id=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"arrow_id",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC)||null,arrow_prop=block.getFieldValue("property");return[`gm.blockly.funcs.getArrowProperty(gst, ${"self"===player?"playerid":player_id}, ${"last"===arrow?"gm.blockly.funcs.getArrowAmount(gst, playerid)":arrow_id}, "${arrow_prop}")${"a"==arrow_prop?"*(180/Math.PI)":""}`,blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_NONE]},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.get_arrow_amount=function(block){const player=block.getFieldValue("player"),player_id=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"player_id",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC)||null;return[`gm.blockly.funcs.getArrowAmount(gst, ${"self"===player?"playerid":player_id})`,blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_NONE]},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.create_arrow=function(block){const arrow_xpos=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"arrow_xpos",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC),arrow_ypos=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"arrow_ypos",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC),arrow_xvel=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"arrow_xvel",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC),arrow_yvel=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"arrow_yvel",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC),arrow_angle=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"arrow_angle",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC),arrow_time=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"arrow_time",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC);return`gm.blockly.funcs.createArrow(gst, playerid, ${arrow_xpos}, ${arrow_ypos}, ${arrow_xvel}, ${arrow_yvel}, ${arrow_angle}*(Math.PI/180), ${""!==arrow_time?arrow_time:150});`},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.delete_arrows=function(block){const player=block.getFieldValue("player"),player_id=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"player_id",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC)||null,arrow=block.getFieldValue("arrow"),arrow_id=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"arrow_id",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC)||null;let code="";return code="all"===arrow?`gm.blockly.funcs.deleteAllPlayerArrows(gst, ${"self"===player?"playerid":player_id});`:`gm.blockly.funcs.deletePlayerArrow(gst, ${"self"===player?"playerid":player_id}, ${"last"===arrow?"gm.blockly.funcs.getArrowAmount(gst, playerid)":arrow_id});`,code},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.get_own_id=function(block){return["self"===block.getFieldValue("player")?"playerid":"gm.lobby.networkEngine?.hostID ?? Infinity",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_NONE]},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.get_player_id_list=function(block){return["gm.blockly.funcs.getAllPlayerIds(gst)",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_NONE]},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.get_player_name=function(block){const player=block.getFieldValue("player"),player_id=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"player_id",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC)||null;return[`gm.graphics.rendererClass.playerArray[${"self"===player?"playerid":player_id}]?.userName ?? ""`,blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_NONE]},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.change_death_barrier=function(block){return`gm.blockly.funcs.enableDeathBarrier(gst, ${block.getFieldValue("enable")});`},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.set_camera_prop=function(block){const camera_prop=block.getFieldValue("camera_prop"),set_number=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"set_number",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC),player=block.getFieldValue("player"),player_id=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"player_id",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC)||null;return`gm.blockly.funcs.setCameraProperty(gst, ${"all"!==player?"self"===player?"playerid":player_id:"null"}, "${camera_prop}", ${set_number});`},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.change_camera_prop=function(block){const camera_prop=block.getFieldValue("camera_prop"),change_number=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"change_number",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC),player=block.getFieldValue("player"),player_id=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"player_id",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC)||null;return`gm.blockly.funcs.changeCameraProperty(gst, ${"all"!==player?"self"===player?"playerid":player_id:"null"}, "${camera_prop}", ${change_number});`},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.get_camera_prop=function(block){const player=block.getFieldValue("player"),player_id=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"player_id",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC)||null;return[`gm.blockly.funcs.getCameraProperty(gst, ${"self"===player?"playerid":player_id}, "${block.getFieldValue("camera_prop")}")`,blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_NONE]},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.change_camera_lerp=function(block){const enable=block.getFieldValue("enable"),player=block.getFieldValue("player"),player_id=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"player_id",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC);return`gm.blockly.funcs.enableCameraLerp(gst, ${enable}, ${"all"!==player?"self"===player?"playerid":player_id:"null"});`},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.raycast=function(block){return[`gm.blockly.funcs.rayCast(gst, playerid, ${blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"a_x",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC)}, ${blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"a_y",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC)}, ${blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"b_x",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC)}, ${blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"b_y",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC)}, ${"TRUE"==block.getFieldValue("collide_a")}, ${"TRUE"==block.getFieldValue("collide_b")}, ${"TRUE"==block.getFieldValue("collide_c")}, ${"TRUE"==block.getFieldValue("collide_d")}, ${"TRUE"==block.getFieldValue("collide_player")}, "${blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.nameDB_.getName(block.getFieldValue("point_x"),blockly__WEBPACK_IMPORTED_MODULE_0___default().VARIABLE_CATEGORY_NAME)}", "${blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.nameDB_.getName(block.getFieldValue("point_y"),blockly__WEBPACK_IMPORTED_MODULE_0___default().VARIABLE_CATEGORY_NAME)}", "${blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.nameDB_.getName(block.getFieldValue("normal_x"),blockly__WEBPACK_IMPORTED_MODULE_0___default().VARIABLE_CATEGORY_NAME)}", "${blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.nameDB_.getName(block.getFieldValue("normal_y"),blockly__WEBPACK_IMPORTED_MODULE_0___default().VARIABLE_CATEGORY_NAME)}", "${blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.nameDB_.getName(block.getFieldValue("object_type"),blockly__WEBPACK_IMPORTED_MODULE_0___default().VARIABLE_CATEGORY_NAME)}", "${blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.nameDB_.getName(block.getFieldValue("object_id"),blockly__WEBPACK_IMPORTED_MODULE_0___default().VARIABLE_CATEGORY_NAME)}")`,blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_NONE]},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.get_map_size=function(block){return["gm.physics.gameState.physics.ppm",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_NONE]},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.player_die=function(block){const player=block.getFieldValue("player"),player_id=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"player_id",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC)||null;return`gm.blockly.funcs.killPlayer(gst, ${"self"===player?"playerid":player_id}, ${"true"===block.getFieldValue("allow_respawn")});`},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.player_on_team=function(block){var player=block.getFieldValue("player"),player_id=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"player_id",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC);return[`gst.discs[${"self"===player?"playerid":player_id}]?.team == ${block.getFieldValue("team")}`,blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_NONE]},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.input_override=function(block){var player=block.getFieldValue("player"),player_id=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"player_id",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC)||null;return`gm.blockly.funcs.overrideInput(gst, ${"self"===player?"playerid":player_id}, '${block.getFieldValue("key")}', ${blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"override_value",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC)});`},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.stop_input_override=function(block){var player=block.getFieldValue("player"),player_id=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"player_id",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC)||null;return`gm.blockly.funcs.overrideInput(gst, ${"self"===player?"playerid":player_id}, '${block.getFieldValue("key")}', null);`},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.on_round_start=function(block){return`gm.physics.onFirstStep = function(playerid){let gst = gm.physics.gameState;let loopIterations = 0;${blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.statementToCode(block,"code")}gm.physics.setGameState(gst);}`},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.on_player_die=function(block){return`gm.physics.onPlayerDie = function(playerid){let gst = gm.physics.gameState;let loopIterations = 0;${blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.statementToCode(block,"code")}gm.physics.setGameState(gst);}`},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.on_each_phys_frame=function(block){return`gm.physics.onStep = function(playerid){let gst = gm.physics.gameState;let loopIterations = 0;${blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.statementToCode(block,"code")}gm.physics.setGameState(gst);}`},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.on_each_render_frame=function(block){return`gm.graphics.onRender = function(playerid){let gst = gm.physics.gameState;let loopIterations = 0;${blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.statementToCode(block,"code")}gm.physics.setGameState(gst);}`},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.on_player_collide=function(block){const collide_type=block.getFieldValue("collide_type"),return_info="TRUE"===block.getFieldValue("return_info"),hit_player_id=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.nameDB_.getName(block.getFieldValue("player_id"),blockly__WEBPACK_IMPORTED_MODULE_0___default().VARIABLE_CATEGORY_NAME),hit_arrow_id=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.nameDB_.getName(block.getFieldValue("arrow_id"),blockly__WEBPACK_IMPORTED_MODULE_0___default().VARIABLE_CATEGORY_NAME),hit_platform_id=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.nameDB_.getName(block.getFieldValue("platform_id"),blockly__WEBPACK_IMPORTED_MODULE_0___default().VARIABLE_CATEGORY_NAME),hit_shape_id=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.nameDB_.getName(block.getFieldValue("shape_id"),blockly__WEBPACK_IMPORTED_MODULE_0___default().VARIABLE_CATEGORY_NAME),hit_normal_x=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.nameDB_.getName(block.getFieldValue("normal_x"),blockly__WEBPACK_IMPORTED_MODULE_0___default().VARIABLE_CATEGORY_NAME),hit_normal_y=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.nameDB_.getName(block.getFieldValue("normal_y"),blockly__WEBPACK_IMPORTED_MODULE_0___default().VARIABLE_CATEGORY_NAME),inside_code=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.statementToCode(block,"code");let code="",setCode="";switch(collide_type){case"collide_player":setCode=`gm.blockly.funcs.setVar("${hit_player_id}", gst, playerid, colid);`,code=`gm.physics.onPlayerPlayerCollision = function(playerid, colid){let gst = gm.physics.gameState;let loopIterations = 0;${return_info?setCode:""}${inside_code}gm.physics.setGameState(gst);}`;break;case"collide_arrow":setCode=`gm.blockly.funcs.setVar("${hit_player_id}", gst, playerid, colid);gm.blockly.funcs.setVar("${hit_arrow_id}", gst, playerid, colarrowid);`,code=`gm.physics.onPlayerArrowCollision = function(playerid, colid, colarrowid){let gst = gm.physics.gameState;let loopIterations = 0;${return_info?setCode:""}${inside_code}gm.physics.setGameState(gst);}`;break;case"collide_platform":setCode=`gm.blockly.funcs.setVar("${hit_platform_id}", gst, playerid, colid);gm.blockly.funcs.setVar("${hit_shape_id}", gst, playerid, colshapeid);gm.blockly.funcs.setVar("${hit_normal_x}", gst, playerid, normal.x);gm.blockly.funcs.setVar("${hit_normal_y}", gst, playerid, normal.y);`,code=`gm.physics.onPlayerPlatformCollision = function(playerid, colid, colshapeid, normal){let gst = gm.physics.gameState;let loopIterations = 0;${return_info?setCode:""}${inside_code}gm.physics.setGameState(gst);}`}return code},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.pressing_key=function(block){const player=block.getFieldValue("player"),player_id=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"player_id",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC)||null;return[`(gm.inputs.allPlayerInputs[${"self"===player?"playerid":player_id}] && gm.inputs.allPlayerInputs[${"self"===player?"playerid":player_id}]["${block.getFieldValue("key")}"])`,blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_NONE]},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.on_arrow_collide=function(block){const collide_type=block.getFieldValue("collide_type"),return_info="TRUE"===block.getFieldValue("return_info"),self_arrow_id=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.nameDB_.getName(block.getFieldValue("self_arrow_id"),blockly__WEBPACK_IMPORTED_MODULE_0___default().VARIABLE_CATEGORY_NAME),hit_player_id=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.nameDB_.getName(block.getFieldValue("player_id"),blockly__WEBPACK_IMPORTED_MODULE_0___default().VARIABLE_CATEGORY_NAME),hit_arrow_id=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.nameDB_.getName(block.getFieldValue("arrow_id"),blockly__WEBPACK_IMPORTED_MODULE_0___default().VARIABLE_CATEGORY_NAME),hit_platform_id=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.nameDB_.getName(block.getFieldValue("platform_id"),blockly__WEBPACK_IMPORTED_MODULE_0___default().VARIABLE_CATEGORY_NAME),hit_shape_id=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.nameDB_.getName(block.getFieldValue("shape_id"),blockly__WEBPACK_IMPORTED_MODULE_0___default().VARIABLE_CATEGORY_NAME),hit_normal_x=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.nameDB_.getName(block.getFieldValue("normal_x"),blockly__WEBPACK_IMPORTED_MODULE_0___default().VARIABLE_CATEGORY_NAME),hit_normal_y=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.nameDB_.getName(block.getFieldValue("normal_y"),blockly__WEBPACK_IMPORTED_MODULE_0___default().VARIABLE_CATEGORY_NAME),inside_code=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.statementToCode(block,"code");let code="",setCode=`gm.blockly.funcs.setVar("${self_arrow_id}", gst, playerid, arrowid);`;switch(collide_type){case"collide_player":setCode=`gm.blockly.funcs.setVar("${hit_player_id}", gst, playerid, colid);`,code=`gm.physics.onArrowPlayerCollision = function(playerid, arrowid, colid){let gst = gm.physics.gameState;let loopIterations = 0;${return_info?setCode:""}${inside_code}gm.physics.setGameState(gst);}`;break;case"collide_arrow":setCode=`gm.blockly.funcs.setVar("${hit_player_id}", gst, playerid, colid);gm.blockly.funcs.setVar("${hit_arrow_id}", gst, playerid, colarrowid);`,code=`gm.physics.onArrowArrowCollision = function(playerid, arrowid, colid, colarrowid){let gst = gm.physics.gameState;let loopIterations = 0;${return_info?setCode:""}${inside_code}gm.physics.setGameState(gst);}`;break;case"collide_platform":setCode=`gm.blockly.funcs.setVar("${hit_platform_id}", gst, playerid, colid);gm.blockly.funcs.setVar("${hit_shape_id}", gst, playerid, colshapeid);gm.blockly.funcs.setVar("${hit_normal_x}", gst, playerid, normal.x);gm.blockly.funcs.setVar("${hit_normal_y}", gst, playerid, normal.y);`,code=`gm.physics.onArrowPlatformCollision = function(playerid, arrowid, colid, colshapeid, normal){let gst = gm.physics.gameState;let loopIterations = 0;${return_info?setCode:""}${inside_code}gm.physics.setGameState(gst);}`}return code},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.on_platform_collide=function(block){const collide_type=block.getFieldValue("collide_type"),return_info="TRUE"===block.getFieldValue("return_info"),self_platform_id=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.nameDB_.getName(block.getFieldValue("self_platform_id"),blockly__WEBPACK_IMPORTED_MODULE_0___default().VARIABLE_CATEGORY_NAME),self_shape_id=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.nameDB_.getName(block.getFieldValue("self_shape_id"),blockly__WEBPACK_IMPORTED_MODULE_0___default().VARIABLE_CATEGORY_NAME),hit_player_id=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.nameDB_.getName(block.getFieldValue("player_id"),blockly__WEBPACK_IMPORTED_MODULE_0___default().VARIABLE_CATEGORY_NAME),hit_arrow_id=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.nameDB_.getName(block.getFieldValue("arrow_id"),blockly__WEBPACK_IMPORTED_MODULE_0___default().VARIABLE_CATEGORY_NAME),hit_platform_id=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.nameDB_.getName(block.getFieldValue("platform_id"),blockly__WEBPACK_IMPORTED_MODULE_0___default().VARIABLE_CATEGORY_NAME),hit_shape_id=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.nameDB_.getName(block.getFieldValue("shape_id"),blockly__WEBPACK_IMPORTED_MODULE_0___default().VARIABLE_CATEGORY_NAME),hit_normal_x=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.nameDB_.getName(block.getFieldValue("normal_x"),blockly__WEBPACK_IMPORTED_MODULE_0___default().VARIABLE_CATEGORY_NAME),hit_normal_y=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.nameDB_.getName(block.getFieldValue("normal_y"),blockly__WEBPACK_IMPORTED_MODULE_0___default().VARIABLE_CATEGORY_NAME),inside_code=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.statementToCode(block,"code");let code="",setCode=`gm.blockly.funcs.setVar("${self_platform_id}", gst, playerid, platid);gm.blockly.funcs.setVar("${self_shape_id}", gst, playerid, shapeid);`;switch(collide_type){case"collide_player":setCode+=`gm.blockly.funcs.setVar("${hit_player_id}", gst, playerid, colid);`,code=`gm.physics.onPlatformPlayerCollision = function(playerid, platid, shapeid, colid){let gst = gm.physics.gameState;let loopIterations = 0;${return_info?setCode:""}${inside_code}gm.physics.setGameState(gst);}`;break;case"collide_arrow":setCode+=`gm.blockly.funcs.setVar("${hit_player_id}", gst, playerid, colid);gm.blockly.funcs.setVar("${hit_arrow_id}", gst, playerid, colarrowid);`,code=`gm.physics.onPlatformArrowCollision = function(playerid, platid, shapeid, colid, colarrowid){let gst = gm.physics.gameState;let loopIterations = 0;${return_info?setCode:""}${inside_code}gm.physics.setGameState(gst);}`;break;case"collide_platform":setCode+=`gm.blockly.funcs.setVar("${hit_platform_id}", gst, playerid, colid);gm.blockly.funcs.setVar("${hit_shape_id}", gst, playerid, colshapeid);gm.blockly.funcs.setVar("${hit_normal_x}", gst, playerid, normal.x);gm.blockly.funcs.setVar("${hit_normal_y}", gst, playerid, normal.y);`,code=`gm.physics.onPlatformPlatformCollision = function(playerid, platid, shapeid, colid, colshapeid, normal){let gst = gm.physics.gameState;let loopIterations = 0;${return_info?setCode:""}${inside_code}gm.physics.setGameState(gst);}`}return code},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.rectangle_shape=function(block){return[`gm.blockly.funcs.createRectShape(${blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"color",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC)}, ${blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"xpos",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC)}, ${blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"ypos",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC)}, ${blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"width",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC)}, ${blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"height",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC)}, ${blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"angle",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC)}*(Math.PI/180), ${"TRUE"===block.getFieldValue("nophys")}, ${"TRUE"===block.getFieldValue("nograp")}, ${"TRUE"===block.getFieldValue("ingrap")}, ${"TRUE"===block.getFieldValue("death")})`,blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_NONE]},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.circle_shape=function(block){return[`gm.blockly.funcs.createCircleShape(${blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"color",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC)}, ${blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"xpos",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC)}, ${blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"ypos",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC)}, ${blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"radius",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC)}, ${"TRUE"===block.getFieldValue("nophys")}, ${"TRUE"===block.getFieldValue("nograp")}, ${"TRUE"===block.getFieldValue("ingrap")}, ${"TRUE"===block.getFieldValue("death")})`,blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_NONE]},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.polygon_shape=function(block){return[`gm.blockly.funcs.createPolyShape(${blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"color",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC)}, ${blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"xpos",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC)}, ${blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"ypos",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC)}, ${blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"vertex",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC)}, ${blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"angle",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC)}*(Math.PI/180), ${blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"scale",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC)}, ${"TRUE"===block.getFieldValue("nophys")}, ${"TRUE"===block.getFieldValue("nograp")}, ${"TRUE"===block.getFieldValue("ingrap")}, ${"TRUE"===block.getFieldValue("death")})`,blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_NONE]},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.create_platform=function(block){var type=block.getFieldValue("type"),shape_list=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"shape_list",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC)||"[]",xpos=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"xpos",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC),ypos=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"ypos",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC),angle=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"angle",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC),bounciness=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"bounciness",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC),density=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"density",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC),friction=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"friction",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC),fricp=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"fricp",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC),colgroup=block.getFieldValue("colgroup"),colplayers="TRUE"===block.getFieldValue("colplayers"),cola="TRUE"===block.getFieldValue("cola"),colb="TRUE"===block.getFieldValue("colb"),colc="TRUE"===block.getFieldValue("colc"),cold="TRUE"===block.getFieldValue("cold");return"TRUE"===block.getFieldValue("return_id")?[`gm.blockly.funcs.createPlatform(gst, '${type}', ${xpos}, ${ypos}, ${angle}*(Math.PI/180), ${shape_list}, ${bounciness}, ${density}, ${friction}, ${fricp}, ${colgroup}, ${colplayers}, ${cola}, ${colb}, ${colc}, ${cold})`,blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_NONE]:`gm.blockly.funcs.createPlatform(gst, '${type}', ${xpos}, ${ypos}, ${angle}*(Math.PI/180), ${shape_list}, ${bounciness}, ${density}, ${friction}, ${fricp}, ${colgroup}, ${colplayers}, ${cola}, ${colb}, ${colc}, ${cold});`},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.clone_platform=function(block){var platform_id=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"platform_id",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC);return"TRUE"===block.getFieldValue("return_id")?[`gm.blockly.funcs.clonePlatform(gst, ${platform_id})`,blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_NONE]:`gm.blockly.funcs.clonePlatform(gst, ${platform_id});`},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.set_platform_prop=function(block){var platform_id=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"platform_id",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC),platform_prop=block.getFieldValue("platform_prop");return`gm.blockly.funcs.setPlatformProperty(gst, ${platform_id}, '${platform_prop}', ${blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"set_value",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC)}${"a"==platform_prop?"*(Math.PI/180)":""});`},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.change_platform_prop=function(block){var platform_id=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"platform_id",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC),platform_prop=block.getFieldValue("platform_prop");return`gm.blockly.funcs.changePlatformProperty(gst, ${platform_id}, '${platform_prop}', ${blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"change_value",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC)}${"a"==platform_prop?"*(Math.PI/180)":""});`},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.get_platform_prop=function(block){var platform_id=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"platform_id",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC),platform_prop=block.getFieldValue("platform_prop");return[`gm.blockly.funcs.getPlatformProperty(gst, ${platform_id}, '${platform_prop}')${"a"==platform_prop?"*(180/Math.PI)":""}`,blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_NONE]},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.set_shape_prop=function(block){var platform_id=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"platform_id",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC),shape_id=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"shape_id",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC),shape_prop=block.getFieldValue("shape_prop");return`gm.blockly.funcs.setShapeProperty(gst, ${platform_id}, ${shape_id}, '${shape_prop}', ${blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"set_value",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC)}${"s_a"==shape_prop?"*(Math.PI/180)":""});`},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.change_shape_prop=function(block){var platform_id=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"platform_id",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC),shape_id=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"shape_id",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC),shape_prop=block.getFieldValue("shape_prop");return`gm.blockly.funcs.changeShapeProperty(gst, ${platform_id}, ${shape_id}, '${shape_prop}', ${blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"change_value",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC)}${"s_a"==shape_prop?"*(Math.PI/180)":""});`},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.get_shape_prop=function(block){var platform_id=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"platform_id",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC),shape_id=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"shape_id",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC),shape_prop=block.getFieldValue("shape_prop");return[`gm.blockly.funcs.getShapeProperty(gst, ${platform_id}, ${shape_id}, '${shape_prop}')${"s_a"==shape_prop?"*(180/Math.PI)":""}`,blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_NONE]},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.get_shape_amount=function(block){return[`gm.blockly.funcs.getShapeAmount(gst, ${blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"platform_id",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC)})`,blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_NONE]},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.get_platform_order=function(block){return["gst.physics.bro",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_NONE]},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.get_platform_by_name=function(block){return[`gm.blockly.funcs.getPlatformByName(${blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"platform_name",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC)})`,blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_NONE]},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.get_platform_name=function(block){return[`gm.blockly.funcs.getPlatformName(${blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"platform_id",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC)})`,blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_NONE]},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.delete_platform=function(block){return`gm.blockly.funcs.deletePlatform(gst, ${blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"platform_id",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC)});`},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.delete_shape=function(block){return`gm.blockly.funcs.deleteShape(gst, ${blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"platform_id",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC)}, ${blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"shape_id",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC)});`},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.add_shape=function(block){return`gm.blockly.funcs.addShape(gst, ${blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"platform_id",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC)}, ${blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"shape",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC)});`},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.unit_to_pixel=function(block){return[`${blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"unit_value",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC)}`,blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_NONE]},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.pixel_to_unit=function(block){return[`${blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"unit_value",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC)}`,blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_NONE]},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.deg_to_rad=function(block){return[`${blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"degree_value",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC)}*(Math.PI/180)`,blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_NONE]},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.rad_to_deg=function(block){return[`${blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"radian_value",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC)}*(180/Math.PI)`,blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_NONE]},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.math_atan2=function(block){return[`SafeTrig.safeATan2(${blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"x",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC)}, ${blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"y",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC)})*(180/Math.PI)`,blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_NONE]},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.math_distance=function(block){return[`gm.blockly.funcs.getDistance(${blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"a_x",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC)}, ${blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"a_y",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC)}, ${blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"b_x",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC)}, ${blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"b_y",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC)})`,blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_NONE]},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.play_sound=function(block){var sound_name=block.getFieldValue("sound_name"),sound_volume=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"sound_volume",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC),sound_pan=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"sound_pan",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC);return`gm.blockly.funcs.playSound(gst, "${block.getFieldValue("pan_type")}", "${sound_name}", ${sound_volume}, ${sound_pan});`},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.colour_hex=function(block){return[`gm.blockly.funcs.parseColour(${blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"hex_code",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC)})`,blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_NONE]},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.variables_retain_value=function(block){return`gm.blockly.funcs.keepVar("${blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.nameDB_.getName(block.getFieldValue("VAR"),blockly__WEBPACK_IMPORTED_MODULE_0___default().Variables.NAME_TYPE)}", gst);`},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.get_screen_prop=function(block){return[("width"==block.getFieldValue("screen_prop")?"730":"500")+" / gst.physics.ppm",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_NONE]},blockly__WEBPACK_IMPORTED_MODULE_0___default().WorkspaceSvg.prototype.setCachedParentSvgSize=function(width,height){const svg=this.getParentSvg();null!=width&&(this.cachedParentSvgSize_.width=width,svg.cachedWidth_=width),null!=height&&(this.cachedParentSvgSize_.height=height,svg.cachedHeight_=height)};const CUSTOM_CONTEXT_MENU_VARIABLE_GETTER_SETTER_MIXIN={customContextMenu:function(options){if(this.isInFlyout){if("variables_get"===this.type||"variables_get_reporter"===this.type){const renameOption={text:blockly__WEBPACK_IMPORTED_MODULE_0___default().Msg.RENAME_VARIABLE,enabled:!0,callback:renameOptionCallbackFactory(this)},name=this.getField("VAR").getText(),deleteOption={text:blockly__WEBPACK_IMPORTED_MODULE_0___default().Msg.DELETE_VARIABLE.replace("%1",name),enabled:!0,callback:deleteOptionCallbackFactory(this)};options.unshift(renameOption),options.unshift(deleteOption)}}else{let oppositeType,contextMenuMsg;"variables_get"===this.type?(oppositeType="variables_set",contextMenuMsg=blockly__WEBPACK_IMPORTED_MODULE_0___default().Msg.VARIABLES_GET_CREATE_SET):(oppositeType="variables_get",contextMenuMsg=blockly__WEBPACK_IMPORTED_MODULE_0___default().Msg.VARIABLES_SET_CREATE_GET);const option={enabled:this.workspace.remainingCapacity()>0},name=this.getField("VAR").getText();option.text=contextMenuMsg.replace("%1",name);const xmlField=blockly__WEBPACK_IMPORTED_MODULE_0___default().utils.xml.createElement("field");xmlField.setAttribute("name","VAR"),xmlField.appendChild(blockly__WEBPACK_IMPORTED_MODULE_0___default().utils.xml.createTextNode(name));const xmlBlock=blockly__WEBPACK_IMPORTED_MODULE_0___default().utils.xml.createElement("block");xmlBlock.setAttribute("type",oppositeType),xmlBlock.appendChild(blockly__WEBPACK_IMPORTED_MODULE_0___default().Xml.textToDom('<mutation playerid_input="false" show_dropdown="'+!name.startsWith("GLOBAL_")+'"></mutation>')),xmlBlock.appendChild(xmlField),option.callback=blockly__WEBPACK_IMPORTED_MODULE_0___default().ContextMenu.callbackFactory(this,xmlBlock),options.push(option)}}},renameOptionCallbackFactory=function(block){return function(){const workspace=block.workspace,variable=block.getField("VAR").getVariable();blockly__WEBPACK_IMPORTED_MODULE_0___default().Variables.renameVariable(workspace,variable)}},deleteOptionCallbackFactory=function(block){return function(){const workspace=block.workspace,variable=block.getField("VAR").getVariable();workspace.deleteVariableById(variable.getId()),workspace.refreshToolboxSelection()}};blockly__WEBPACK_IMPORTED_MODULE_0___default().Extensions.unregister("contextMenu_variableSetterGetter"),blockly__WEBPACK_IMPORTED_MODULE_0___default().Extensions.registerMixin("contextMenu_variableSetterGetter",CUSTOM_CONTEXT_MENU_VARIABLE_GETTER_SETTER_MIXIN),blockly__WEBPACK_IMPORTED_MODULE_0___default().Variables.flyoutCategory=function(workspace){let xmlList=[];const button=document.createElement("button");button.setAttribute("text","%{BKY_NEW_VARIABLE}"),button.setAttribute("callbackKey","CREATE_VARIABLE"),workspace.registerButtonCallback("CREATE_VARIABLE",(function(button){blockly__WEBPACK_IMPORTED_MODULE_0___default().Variables.createVariableButtonHandler(button.getTargetWorkspace())})),xmlList.push(button);const helpLabel1=document.createElement("label");helpLabel1.setAttribute("text","You can make a variable global");const labelGap=document.createElement("sep");labelGap.setAttribute("gap","4");const helpLabel2=document.createElement("label");helpLabel2.setAttribute("text",'by adding "GLOBAL_" before its name.'),xmlList.push(helpLabel1),xmlList.push(labelGap),xmlList.push(helpLabel2);const blockList=blockly__WEBPACK_IMPORTED_MODULE_0___default().Variables.flyoutCategoryBlocks(workspace);return xmlList=xmlList.concat(blockList),xmlList},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.math_change=function(block){const argument0=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"DELTA",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ADDITION)||"0",varName=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.nameDB_.getName(block.getFieldValue("VAR"),blockly__WEBPACK_IMPORTED_MODULE_0___default().VARIABLE_CATEGORY_NAME),player=block.getFieldValue("player"),player_id=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"player_id",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC)||null;return'gm.blockly.funcs.changeVar("'+varName+'", gst, '+("self"===player?"playerid":player_id)+", "+argument0+");"},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.variables_set=function(block){const argument0=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"VALUE",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ASSIGNMENT)||"0",varName=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.nameDB_.getName(block.getFieldValue("VAR"),blockly__WEBPACK_IMPORTED_MODULE_0___default().VARIABLE_CATEGORY_NAME),player=block.getFieldValue("player"),player_id=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"player_id",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC)||null;return'gm.blockly.funcs.setVar("'+varName+'", gst, '+("self"===player?"playerid":player_id)+", "+argument0+");"},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.variables_get=function(block){const varName=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.nameDB_.getName(block.getFieldValue("VAR"),blockly__WEBPACK_IMPORTED_MODULE_0___default().VARIABLE_CATEGORY_NAME),player=block.getFieldValue("player"),player_id=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"player_id",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC)||null;return['gm.blockly.funcs.getVar("'+varName+'", gst, '+("self"===player?"playerid":player_id)+")",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC]},blockly__WEBPACK_IMPORTED_MODULE_0___default().Variables.flyoutCategoryBlocks=function(workspace){const variableModelList=workspace.getVariablesOfType(""),eventVariableList=[],eventBlockNames=["on_player_collide","on_arrow_collide","on_platform_collide","raycast"];for(const blockName of eventBlockNames)for(const block of workspace.getBlocksByType(blockName))for(const varModel of block.getVarModels())eventVariableList.includes(varModel)||eventVariableList.push(varModel);const xmlList=[];if(variableModelList.length>0){let mostRecentVariable=null;for(let i=variableModelList.length-1;i>=0;i--)if(!eventVariableList.includes(variableModelList[i])){mostRecentVariable=variableModelList[i];break}if(mostRecentVariable){const setBlock=blockly__WEBPACK_IMPORTED_MODULE_0___default().utils.xml.createElement("block");setBlock.setAttribute("type","variables_set"),setBlock.setAttribute("gap",blockly__WEBPACK_IMPORTED_MODULE_0___default().Blocks.math_change?8:24),setBlock.appendChild(blockly__WEBPACK_IMPORTED_MODULE_0___default().Variables.generateVariableFieldDom(mostRecentVariable)),setBlock.appendChild(blockly__WEBPACK_IMPORTED_MODULE_0___default().Xml.textToDom('<mutation playerid_input="false" show_dropdown="'+!blockly__WEBPACK_IMPORTED_MODULE_0___default().Variables.generateVariableFieldDom(mostRecentVariable).innerHTML.startsWith("GLOBAL_")+'"></mutation>')),xmlList.push(setBlock);const changeBlock=blockly__WEBPACK_IMPORTED_MODULE_0___default().utils.xml.createElement("block");changeBlock.setAttribute("type","math_change"),changeBlock.setAttribute("gap",blockly__WEBPACK_IMPORTED_MODULE_0___default().Blocks.variables_get?20:8),changeBlock.appendChild(blockly__WEBPACK_IMPORTED_MODULE_0___default().Variables.generateVariableFieldDom(mostRecentVariable)),changeBlock.appendChild(blockly__WEBPACK_IMPORTED_MODULE_0___default().Xml.textToDom('<mutation playerid_input="false" show_dropdown="'+!blockly__WEBPACK_IMPORTED_MODULE_0___default().Variables.generateVariableFieldDom(mostRecentVariable).innerHTML.startsWith("GLOBAL_")+'"></mutation>')),changeBlock.appendChild(blockly__WEBPACK_IMPORTED_MODULE_0___default().Xml.textToDom('<value name="DELTA"><shadow type="math_number"><field name="NUM">1</field></shadow></value>')),xmlList.push(changeBlock);const retainBlock=blockly__WEBPACK_IMPORTED_MODULE_0___default().utils.xml.createElement("block");retainBlock.setAttribute("type","variables_retain_value"),retainBlock.appendChild(blockly__WEBPACK_IMPORTED_MODULE_0___default().Variables.generateVariableFieldDom(mostRecentVariable)),xmlList.push(retainBlock)}if(blockly__WEBPACK_IMPORTED_MODULE_0___default().Blocks.variables_get){variableModelList.sort(blockly__WEBPACK_IMPORTED_MODULE_0___default().VariableModel.compareByName),eventVariableList.sort(blockly__WEBPACK_IMPORTED_MODULE_0___default().VariableModel.compareByName);for(let variable,i=0;variable=variableModelList[i];i++){if(eventVariableList.includes(variable))continue;const block=blockly__WEBPACK_IMPORTED_MODULE_0___default().utils.xml.createElement("block");block.setAttribute("type","variables_get"),block.setAttribute("gap",8),block.appendChild(blockly__WEBPACK_IMPORTED_MODULE_0___default().Variables.generateVariableFieldDom(variable)),block.appendChild(blockly__WEBPACK_IMPORTED_MODULE_0___default().Xml.textToDom('<mutation playerid_input="false" show_dropdown="'+!blockly__WEBPACK_IMPORTED_MODULE_0___default().Variables.generateVariableFieldDom(variable).innerHTML.startsWith("GLOBAL_")+'"></mutation>')),xmlList.push(block)}if(eventVariableList.length>0){const eventsSep=blockly__WEBPACK_IMPORTED_MODULE_0___default().utils.xml.createElement("label");eventsSep.setAttribute("gap",8),xmlList.push(eventsSep);const eventsLabel=blockly__WEBPACK_IMPORTED_MODULE_0___default().utils.xml.createElement("label");eventsLabel.setAttribute("text","Variables used by events:"),xmlList.push(eventsLabel)}for(let variable,i=0;variable=eventVariableList[i];i++){const block=blockly__WEBPACK_IMPORTED_MODULE_0___default().utils.xml.createElement("block");block.setAttribute("type","variables_get"),block.setAttribute("gap",8),block.appendChild(blockly__WEBPACK_IMPORTED_MODULE_0___default().Variables.generateVariableFieldDom(variable)),block.appendChild(blockly__WEBPACK_IMPORTED_MODULE_0___default().Xml.textToDom('<mutation playerid_input="false" show_dropdown="'+!blockly__WEBPACK_IMPORTED_MODULE_0___default().Variables.generateVariableFieldDom(variable).innerHTML.startsWith("GLOBAL_")+'"></mutation>')),xmlList.push(block)}}}return xmlList},blockly__WEBPACK_IMPORTED_MODULE_0___default().FieldVariable.dropdownCreate=function(){if(!this.variable_)throw Error("Tried to call dropdownCreate on a variable field with no variable selected.");const name=this.getText();let variableModelList=[];if(this.sourceBlock_&&this.sourceBlock_.workspace){const variableTypes=this.getVariableTypes_();for(let i=0;i<variableTypes.length;i++){const variableType=variableTypes[i],variables=this.sourceBlock_.workspace.getVariablesOfType(variableType);variableModelList=variableModelList.concat(variables)}}variableModelList.sort(blockly__WEBPACK_IMPORTED_MODULE_0___default().VariableModel.compareByName);const eventVariableList=[],eventBlockNames=["on_player_collide","on_arrow_collide","on_platform_collide","raycast"];for(const blockName of eventBlockNames)for(const block of this.sourceBlock_.workspace.getBlocksByType(blockName))for(const varModel of block.getVarModels())eventVariableList.includes(varModel)||eventVariableList.push(varModel);const options=[];for(let i=0;i<variableModelList.length;i++)eventVariableList.includes(variableModelList[i])&&!eventBlockNames.includes(this.sourceBlock_.type)||options.push([variableModelList[i].name,variableModelList[i].getId()]);return options.push([blockly__WEBPACK_IMPORTED_MODULE_0___default().Msg.RENAME_VARIABLE,"RENAME_VARIABLE_ID"]),blockly__WEBPACK_IMPORTED_MODULE_0___default().Msg.DELETE_VARIABLE&&options.push([blockly__WEBPACK_IMPORTED_MODULE_0___default().Msg.DELETE_VARIABLE.replace("%1",name),"DELETE_VARIABLE_ID"]),options},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.lists_repeat=function(block){return[blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.provideFunction_("listsRepeat",["function "+blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(value, n) {","  var array = [];","  for (var i = 0; i < n; i++) {","    array[i] = JSON.parse(JSON.stringify(value));","  }","  return array;","}"])+"("+(blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"ITEM",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_NONE)||"null")+", "+(blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"NUM",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_NONE)||"0")+")",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_FUNCTION_CALL]},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.procedures_defreturn=function(block){const funcName=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.nameDB_.getName(block.getFieldValue("NAME"),blockly__WEBPACK_IMPORTED_MODULE_0___default().PROCEDURE_CATEGORY_NAME);let xfix1="";blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.STATEMENT_PREFIX&&(xfix1+=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.injectId(blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.STATEMENT_PREFIX,block)),blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.STATEMENT_SUFFIX&&(xfix1+=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.injectId(blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.STATEMENT_SUFFIX,block)),xfix1&&(xfix1=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.prefixLines(xfix1,blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.INDENT));let loopTrap="";blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.INFINITE_LOOP_TRAP&&(loopTrap=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.prefixLines(blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.injectId(blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.INFINITE_LOOP_TRAP,block),blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.INDENT));const branch=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.statementToCode(block,"STACK");let returnValue=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"RETURN",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_NONE)||"",xfix2="";branch&&returnValue&&(xfix2=xfix1),returnValue&&(returnValue=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.INDENT+"return "+returnValue+";");const args=[];let setCode="";const variables=block.getVars();for(let i=0;i<variables.length;i++)args[i]=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.nameDB_.getName(variables[i],blockly__WEBPACK_IMPORTED_MODULE_0___default().VARIABLE_CATEGORY_NAME),setCode+=`gm.blockly.funcs.setVar('${args[i]}', gst, playerid, ${args[i]});`;let code="function "+funcName+"(gst, playerid, "+args.join(", ")+") {let loopIterations = 0;"+setCode+xfix1+branch+xfix2+returnValue+"}";return code=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.scrub_(block,code),blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.definitions_["%"+funcName]=code,null},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.procedures_defnoreturn=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.procedures_defreturn,blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.procedures_callreturn=function(block){const funcName=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.nameDB_.getName(block.getFieldValue("NAME"),blockly__WEBPACK_IMPORTED_MODULE_0___default().PROCEDURE_CATEGORY_NAME),args=[],variables=block.getVars();for(let i=0;i<variables.length;i++)args[i]=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"ARG"+i,blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_NONE)||"null";return[funcName+"(gst, playerid, "+args.join(", ")+")",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_FUNCTION_CALL]},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.math_random_int=function(block){const argument0=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"FROM",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_NONE)||"0",argument1=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"TO",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_NONE)||"0";return[blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.provideFunction_("mathRandomInt",["function "+blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(a, b) {","  if (a > b) {","    // Swap a and b to ensure a is smaller.","    var c = a;","    a = b;","    b = c;","  }","  return Math.floor(gm.physics.pseudoRandom() * (b - a + 1) + a);","}"])+"("+argument0+", "+argument1+")",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_FUNCTION_CALL]},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.math_random_float=function(block){return["gm.physics.pseudoRandom()",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_FUNCTION_CALL]},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.colour_random=function(block){return[blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.provideFunction_("colourRandom",["function "+blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.FUNCTION_NAME_PLACEHOLDER_+"() {","  var num = Math.floor(gm.physics.pseudoRandom() * Math.pow(2, 24));","  return '#' + ('00000' + num.toString(16)).substr(-6);","}"])+"()",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_FUNCTION_CALL]};blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.text_append=function(block){const code='gm.blockly.funcs.changeVar("'+blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.nameDB_.getName(block.getFieldValue("VAR"),blockly__WEBPACK_IMPORTED_MODULE_0___default().VARIABLE_CATEGORY_NAME)+'", gst, playerid, '+function(value){return/^\s*'([^']|\\')*'\s*$/.test(value)?[value,blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ATOMIC]:["String("+value+")",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_FUNCTION_CALL]}(blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"TEXT",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_NONE)||"''")[0]+");\n";return code},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.text_charAt=function(block){const where=block.getFieldValue("WHERE")||"FROM_START",textOrder="RANDOM"===where?blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_NONE:blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_MEMBER,text=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"VALUE",textOrder)||"''";switch(where){case"FIRST":return[text+".charAt(0)",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_FUNCTION_CALL];case"LAST":return[text+".slice(-1)",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_FUNCTION_CALL];case"FROM_START":return[text+".charAt("+blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.getAdjusted(block,"AT")+")",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_FUNCTION_CALL];case"FROM_END":return[text+".slice("+blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.getAdjusted(block,"AT",1,!0)+").charAt(0)",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_FUNCTION_CALL];case"RANDOM":return[blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.provideFunction_("textRandomLetter",["function "+blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(text) {","  var x = Math.floor(gm.physics.pseudoRandom() * text.length);","  return text[x];","}"])+"("+text+")",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_FUNCTION_CALL]}throw Error("Unhandled option (text_charAt).")},blockly__WEBPACK_IMPORTED_MODULE_0___default().Blocks.lists_setIndex.init=function(){const MODE=[[blockly__WEBPACK_IMPORTED_MODULE_0___default().Msg.LISTS_SET_INDEX_SET,"SET"],[blockly__WEBPACK_IMPORTED_MODULE_0___default().Msg.LISTS_SET_INDEX_INSERT,"INSERT"]];this.WHERE_OPTIONS=[[blockly__WEBPACK_IMPORTED_MODULE_0___default().Msg.LISTS_GET_INDEX_FROM_START,"FROM_START"],[blockly__WEBPACK_IMPORTED_MODULE_0___default().Msg.LISTS_GET_INDEX_FROM_END,"FROM_END"],[blockly__WEBPACK_IMPORTED_MODULE_0___default().Msg.LISTS_GET_INDEX_FIRST,"FIRST"],[blockly__WEBPACK_IMPORTED_MODULE_0___default().Msg.LISTS_GET_INDEX_LAST,"LAST"],[blockly__WEBPACK_IMPORTED_MODULE_0___default().Msg.LISTS_GET_INDEX_RANDOM,"RANDOM"]],this.setHelpUrl(blockly__WEBPACK_IMPORTED_MODULE_0___default().Msg.LISTS_SET_INDEX_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("LIST").setCheck("Array").appendField(blockly__WEBPACK_IMPORTED_MODULE_0___default().Msg.LISTS_SET_INDEX_INPUT_IN_LIST),this.appendDummyInput().appendField(new(blockly__WEBPACK_IMPORTED_MODULE_0___default().FieldDropdown)(MODE),"MODE").appendField("","SPACE"),this.appendDummyInput("AT"),this.appendValueInput("TO").appendField(blockly__WEBPACK_IMPORTED_MODULE_0___default().Msg.LISTS_SET_INDEX_INPUT_TO),this.setInputsInline(!0),this.setOutput(!0),this.setTooltip(blockly__WEBPACK_IMPORTED_MODULE_0___default().Msg.LISTS_SET_INDEX_TOOLTIP),this.updateAt_(!0);const thisBlock=this;this.setTooltip((function(){const mode=thisBlock.getFieldValue("MODE"),where=thisBlock.getFieldValue("WHERE");let tooltip="";switch(mode+" "+where){case"SET FROM_START":case"SET FROM_END":tooltip=blockly__WEBPACK_IMPORTED_MODULE_0___default().Msg.LISTS_SET_INDEX_TOOLTIP_SET_FROM;break;case"SET FIRST":tooltip=blockly__WEBPACK_IMPORTED_MODULE_0___default().Msg.LISTS_SET_INDEX_TOOLTIP_SET_FIRST;break;case"SET LAST":tooltip=blockly__WEBPACK_IMPORTED_MODULE_0___default().Msg.LISTS_SET_INDEX_TOOLTIP_SET_LAST;break;case"SET RANDOM":tooltip=blockly__WEBPACK_IMPORTED_MODULE_0___default().Msg.LISTS_SET_INDEX_TOOLTIP_SET_RANDOM;break;case"INSERT FROM_START":case"INSERT FROM_END":tooltip=blockly__WEBPACK_IMPORTED_MODULE_0___default().Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FROM;break;case"INSERT FIRST":tooltip=blockly__WEBPACK_IMPORTED_MODULE_0___default().Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FIRST;break;case"INSERT LAST":tooltip=blockly__WEBPACK_IMPORTED_MODULE_0___default().Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_LAST;break;case"INSERT RANDOM":tooltip=blockly__WEBPACK_IMPORTED_MODULE_0___default().Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_RANDOM}return"FROM_START"!=where&&"FROM_END"!=where||(tooltip+="  "+blockly__WEBPACK_IMPORTED_MODULE_0___default().Msg.LISTS_INDEX_FROM_START_TOOLTIP.replace("%1",thisBlock.workspace.options.oneBasedIndex?"#1":"#0")),tooltip}))},blockly__WEBPACK_IMPORTED_MODULE_0___default().Blocks.lists_getIndex.init=function(){const MODE=[[blockly__WEBPACK_IMPORTED_MODULE_0___default().Msg.LISTS_GET_INDEX_GET,"GET"],[blockly__WEBPACK_IMPORTED_MODULE_0___default().Msg.LISTS_GET_INDEX_REMOVE,"REMOVE"]];this.WHERE_OPTIONS=[[blockly__WEBPACK_IMPORTED_MODULE_0___default().Msg.LISTS_GET_INDEX_FROM_START,"FROM_START"],[blockly__WEBPACK_IMPORTED_MODULE_0___default().Msg.LISTS_GET_INDEX_FROM_END,"FROM_END"],[blockly__WEBPACK_IMPORTED_MODULE_0___default().Msg.LISTS_GET_INDEX_FIRST,"FIRST"],[blockly__WEBPACK_IMPORTED_MODULE_0___default().Msg.LISTS_GET_INDEX_LAST,"LAST"],[blockly__WEBPACK_IMPORTED_MODULE_0___default().Msg.LISTS_GET_INDEX_RANDOM,"RANDOM"]],this.setHelpUrl(blockly__WEBPACK_IMPORTED_MODULE_0___default().Msg.LISTS_GET_INDEX_HELPURL),this.setStyle("list_blocks");const modeMenu=new(blockly__WEBPACK_IMPORTED_MODULE_0___default().FieldDropdown)(MODE,(function(value){this.getSourceBlock().updateStatement_(!1)}));this.appendValueInput("VALUE").setCheck("Array").appendField(blockly__WEBPACK_IMPORTED_MODULE_0___default().Msg.LISTS_GET_INDEX_INPUT_IN_LIST),this.appendDummyInput().appendField(modeMenu,"MODE").appendField("","SPACE"),this.appendDummyInput("AT"),blockly__WEBPACK_IMPORTED_MODULE_0___default().Msg.LISTS_GET_INDEX_TAIL&&this.appendDummyInput("TAIL").appendField(blockly__WEBPACK_IMPORTED_MODULE_0___default().Msg.LISTS_GET_INDEX_TAIL),this.setInputsInline(!0),this.setOutput(!0),this.updateAt_(!0);const thisBlock=this;this.setTooltip((function(){const mode=thisBlock.getFieldValue("MODE"),where=thisBlock.getFieldValue("WHERE");let tooltip="";switch(mode+" "+where){case"GET FROM_START":case"GET FROM_END":tooltip=blockly__WEBPACK_IMPORTED_MODULE_0___default().Msg.LISTS_GET_INDEX_TOOLTIP_GET_FROM;break;case"GET FIRST":tooltip=blockly__WEBPACK_IMPORTED_MODULE_0___default().Msg.LISTS_GET_INDEX_TOOLTIP_GET_FIRST;break;case"GET LAST":tooltip=blockly__WEBPACK_IMPORTED_MODULE_0___default().Msg.LISTS_GET_INDEX_TOOLTIP_GET_LAST;break;case"GET RANDOM":tooltip=blockly__WEBPACK_IMPORTED_MODULE_0___default().Msg.LISTS_GET_INDEX_TOOLTIP_GET_RANDOM;break;case"GET_REMOVE FROM_START":case"GET_REMOVE FROM_END":tooltip=blockly__WEBPACK_IMPORTED_MODULE_0___default().Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FROM;break;case"GET_REMOVE FIRST":tooltip=blockly__WEBPACK_IMPORTED_MODULE_0___default().Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FIRST;break;case"GET_REMOVE LAST":tooltip=blockly__WEBPACK_IMPORTED_MODULE_0___default().Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_LAST;break;case"GET_REMOVE RANDOM":tooltip=blockly__WEBPACK_IMPORTED_MODULE_0___default().Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_RANDOM;break;case"REMOVE FROM_START":case"REMOVE FROM_END":tooltip=blockly__WEBPACK_IMPORTED_MODULE_0___default().Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FROM;break;case"REMOVE FIRST":tooltip=blockly__WEBPACK_IMPORTED_MODULE_0___default().Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FIRST;break;case"REMOVE LAST":tooltip=blockly__WEBPACK_IMPORTED_MODULE_0___default().Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_LAST;break;case"REMOVE RANDOM":tooltip=blockly__WEBPACK_IMPORTED_MODULE_0___default().Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_RANDOM}if("FROM_START"==where||"FROM_END"==where){tooltip+="  "+("FROM_START"==where?blockly__WEBPACK_IMPORTED_MODULE_0___default().Msg.LISTS_INDEX_FROM_START_TOOLTIP:blockly__WEBPACK_IMPORTED_MODULE_0___default().Msg.LISTS_INDEX_FROM_END_TOOLTIP).replace("%1",thisBlock.workspace.options.oneBasedIndex?"#1":"#0")}return tooltip}))},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.controls_for=function(block){const variable0=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.nameDB_.getName(block.getFieldValue("VAR"),blockly__WEBPACK_IMPORTED_MODULE_0___default().VARIABLE_CATEGORY_NAME),argument0=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"FROM",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ASSIGNMENT)||"0",argument1=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"TO",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ASSIGNMENT)||"0",increment=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"BY",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ASSIGNMENT)||"1";let code,branch=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.statementToCode(block,"DO");if(branch=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.addLoopTrap(branch,block),blockly__WEBPACK_IMPORTED_MODULE_0___default().isNumber(argument0)&&blockly__WEBPACK_IMPORTED_MODULE_0___default().isNumber(argument1)&&blockly__WEBPACK_IMPORTED_MODULE_0___default().isNumber(increment)){const up=Number(argument0)<=Number(argument1);code="for (let "+variable0+" = "+argument0+"; "+variable0+(up?" <= ":" >= ")+argument1+"; "+variable0;const step=Math.abs(Number(increment));code+=1===step?up?"++":"--":(up?" += ":" -= ")+step,code+=`) {gm.blockly.funcs.setVar("${variable0}", gst, playerid, ${variable0});`+branch+"}\n"}else{code="";let startVar=argument0;argument0.match(/^\w+$/)||blockly__WEBPACK_IMPORTED_MODULE_0___default().isNumber(argument0)||(startVar=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.nameDB_.getDistinctName(variable0+"_start",blockly__WEBPACK_IMPORTED_MODULE_0___default().VARIABLE_CATEGORY_NAME),code+="let "+startVar+" = "+argument0+";\n");let endVar=argument1;argument1.match(/^\w+$/)||blockly__WEBPACK_IMPORTED_MODULE_0___default().isNumber(argument1)||(endVar=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.nameDB_.getDistinctName(variable0+"_end",blockly__WEBPACK_IMPORTED_MODULE_0___default().VARIABLE_CATEGORY_NAME),code+="let "+endVar+" = "+argument1+";\n");const incVar=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.nameDB_.getDistinctName(variable0+"_inc",blockly__WEBPACK_IMPORTED_MODULE_0___default().VARIABLE_CATEGORY_NAME);code+="let "+incVar+" = ",blockly__WEBPACK_IMPORTED_MODULE_0___default().isNumber(increment)?code+=Math.abs(increment)+";\n":code+="Math.abs("+increment+");\n",code+="if ("+startVar+" > "+endVar+") {\n",code+=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.INDENT+incVar+" = -"+incVar+";\n",code+="}\n",code+="for (let "+variable0+" = "+startVar+"; "+incVar+" >= 0 ? "+variable0+" <= "+endVar+" : "+variable0+" >= "+endVar+"; "+variable0+" += "+incVar+") {"+`gm.blockly.funcs.setVar("${variable0}", gst, playerid, ${variable0});`+branch+"}"}return code},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.controls_forEach=function(block){const variable0=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.nameDB_.getName(block.getFieldValue("VAR"),blockly__WEBPACK_IMPORTED_MODULE_0___default().VARIABLE_CATEGORY_NAME),argument0=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"LIST",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ASSIGNMENT)||"[]";let branch=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.statementToCode(block,"DO");branch=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.addLoopTrap(branch,block);let code="",listVar=argument0;argument0.match(/^\w+$/)||(listVar=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.nameDB_.getDistinctName(variable0+"_list",blockly__WEBPACK_IMPORTED_MODULE_0___default().VARIABLE_CATEGORY_NAME),code+="let "+listVar+" = "+argument0+";\n");const indexVar=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.nameDB_.getDistinctName(variable0+"_index",blockly__WEBPACK_IMPORTED_MODULE_0___default().VARIABLE_CATEGORY_NAME);return branch=`gm.blockly.funcs.setVar("${variable0}", gst, playerid, ${listVar}[${indexVar}]);${branch}`,code+="for (let "+indexVar+" in "+listVar+") {"+branch+"}\n",code},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.math_single=function(block){const operator=block.getFieldValue("OP");let code,arg;if("NEG"===operator)return arg=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"NUM",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_UNARY_NEGATION)||"0","-"===arg[0]&&(arg=" "+arg),code="-"+arg,[code,blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_UNARY_NEGATION];switch(arg="SIN"===operator||"COS"===operator||"TAN"===operator?blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"NUM",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_DIVISION)||"0":blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"NUM",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_NONE)||"0",operator){case"ABS":code="Math.abs("+arg+")";break;case"ROOT":code="Math.sqrt("+arg+")";break;case"LN":code="Math.log("+arg+")";break;case"EXP":code="Math.exp("+arg+")";break;case"POW10":code="Math.pow(10,"+arg+")";break;case"ROUND":code="Math.round("+arg+")";break;case"ROUNDUP":code="Math.ceil("+arg+")";break;case"ROUNDDOWN":code="Math.floor("+arg+")";break;case"SIN":code="SafeTrig.safeSin("+arg+" / 180 * Math.PI)";break;case"COS":code="SafeTrig.safeCos("+arg+" / 180 * Math.PI)";break;case"TAN":code="SafeTrig.safeTan("+arg+" / 180 * Math.PI)"}if(code)return[code,blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_FUNCTION_CALL];switch(operator){case"LOG10":code="Math.log("+arg+") / Math.log(10)";break;case"ASIN":code="SafeTrig.safeASin("+arg+") / Math.PI * 180";break;case"ACOS":code="SafeTrig.safeACos("+arg+") / Math.PI * 180";break;case"ATAN":code="SafeTrig.safeATan("+arg+") / Math.PI * 180";break;default:throw Error("Unknown math operator: "+operator)}return[code,blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_DIVISION]},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.math_round=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.math_single,blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.math_trig=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.math_single,blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.lists_length=function(block){let list=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"VALUE",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_MEMBER)||"[]";return list=`(typeof ${list} === 'object' ? ${list} : [])`,[list+".length",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_MEMBER]},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.lists_isEmpty=function(block){var list=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"VALUE",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_MEMBER)||"[]";return["!"+(list=`(typeof ${list} === 'object' ? ${list} : [])`)+".length",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_LOGICAL_NOT]},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.lists_indexOf=function(block){const operator="FIRST"===block.getFieldValue("END")?"indexOf":"lastIndexOf",item=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"FIND",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_NONE)||"''";let list=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"VALUE",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_MEMBER)||"[]";list=`(typeof ${list} === 'object' ? ${list} : [])`;const code=list+"."+operator+"("+item+")";return block.workspace.options.oneBasedIndex?[code+" + 1",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ADDITION]:[code,blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_FUNCTION_CALL]},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.lists_getIndex=function(block){const mode=block.getFieldValue("MODE")||"GET",where=block.getFieldValue("WHERE")||"FROM_START",listOrder="RANDOM"===where?blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_NONE:blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_MEMBER;let list=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"VALUE",listOrder)||"[]";switch(list=`(typeof ${list} === 'object' ? ${list} : [])`,where){case"FIRST":if("GET"===mode){return[list+"[0]",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_MEMBER]}if("GET_REMOVE"===mode){return[list+".shift()",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_MEMBER]}if("REMOVE"===mode){return[list+".slice(1)",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_MEMBER]}break;case"LAST":if("GET"===mode){return[list+".slice(-1)[0]",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_MEMBER]}if("GET_REMOVE"===mode){return[list+".pop()",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_MEMBER]}if("REMOVE"===mode){return[list+".splice(-1)",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_MEMBER]}break;case"FROM_START":{const at=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.getAdjusted(block,"AT");if("GET"===mode){return[list+"["+at+"]",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_MEMBER]}if("GET_REMOVE"===mode){return[list+".splice("+at+", 1)[0]",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_FUNCTION_CALL]}if("REMOVE"===mode){return[list+".splice("+at+", 1)",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_MEMBER]}break}case"FROM_END":{const at=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.getAdjusted(block,"AT",1,!0);if("GET"===mode){return[list+".slice("+at+")[0]",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_MEMBER]}if("GET_REMOVE"===mode){return[list+".splice("+at+", 1)[0]",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_FUNCTION_CALL]}if("REMOVE"===mode){return[list+".splice("+at+", 1)",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_MEMBER]}break}case"RANDOM":return[blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.provideFunction_("listsGetRandomItem",["function "+blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(list, remove) {","  var x = Math.floor(gm.physics.pseudoRandom() * list.length);","  if (remove) {","    list.splice(x, 1)[0]; return list;","  } else {","    return list[x];","  }","}"])+"("+list+", "+("GET"!==mode)+")",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_FUNCTION_CALL]}throw Error("Unhandled combination (lists_getIndex).")},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.lists_setIndex=function(block){let list=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"LIST",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_MEMBER)||"[]";list=`(typeof ${list} === 'object' ? ${list} : [])`;const mode=block.getFieldValue("MODE")||"GET",where=block.getFieldValue("WHERE")||"FROM_START",value=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"TO",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_ASSIGNMENT)||"null";switch(where){case"FIRST":if("SET"===mode){return["gm.blockly.funcs.setInArray("+list+", 0, "+value+")",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_MEMBER]}if("INSERT"===mode){return["["+value+", ..."+list+"]",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_MEMBER]}break;case"LAST":if("SET"===mode){return["gm.blockly.funcs.setInArray("+list+", "+list+".length - 1, "+value+")",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_MEMBER]}if("INSERT"===mode){return["[..."+list+", "+value+"]",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_MEMBER]}break;case"FROM_START":{const at=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.getAdjusted(block,"AT");if("SET"===mode){return["gm.blockly.funcs.setInArray("+list+", "+at+", "+value+")",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_MEMBER]}if("INSERT"===mode){return["gm.blockly.funcs.insertInArray("+list+", "+at+", "+value+")",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_MEMBER]}break}case"FROM_END":{const at=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.getAdjusted(block,"AT",1,!1,blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_SUBTRACTION);if("SET"===mode){return["gm.blockly.funcs.setInArray("+list+", "+list+".length - "+at+", "+value+")",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_MEMBER]}if("INSERT"===mode){return["gm.blockly.funcs.insertInArray("+list+", "+list+".length - "+at+", "+value+")",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_MEMBER]}break}case"RANDOM":{let code="";if("SET"===mode)return code+="gm.blockly.funcs.setInArray("+list+", Math.floor(gm.physics.pseudoRandom() * "+list+".length), "+value+")",[code,blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_FUNCTION_CALL];if("INSERT"===mode)return code+="gm.blockly.funcs.insertInArray("+list+", Math.floor(gm.physics.pseudoRandom() * "+list+".length), "+value+")",[code,blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_FUNCTION_CALL];break}}throw Error("Unhandled combination (lists_setIndex).")};const getSubstringIndex=function(listName,where,opt_at){return"FIRST"===where?"0":"FROM_END"===where?listName+".length - 1 - "+opt_at:"LAST"===where?listName+".length - 1":opt_at};blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.lists_getSublist=function(block){let list=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"LIST",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_MEMBER)||"[]";list=`(typeof ${list} === 'object' ? ${list} : [])`;const where1=block.getFieldValue("WHERE1"),where2=block.getFieldValue("WHERE2");let code;if("FIRST"===where1&&"LAST"===where2)code=list+".slice(0)";else if(list.match(/^\w+$/)||"FROM_END"!==where1&&"FROM_START"===where2){let at1,at2;switch(where1){case"FROM_START":at1=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.getAdjusted(block,"AT1");break;case"FROM_END":at1=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.getAdjusted(block,"AT1",1,!1,blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_SUBTRACTION),at1=list+".length - "+at1;break;case"FIRST":at1="0";break;default:throw Error("Unhandled option (lists_getSublist).")}switch(where2){case"FROM_START":at2=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.getAdjusted(block,"AT2",1);break;case"FROM_END":at2=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.getAdjusted(block,"AT2",0,!1,blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_SUBTRACTION),at2=list+".length - "+at2;break;case"LAST":at2=list+".length";break;default:throw Error("Unhandled option (lists_getSublist).")}code=list+".slice("+at1+", "+at2+")"}else{const at1=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.getAdjusted(block,"AT1"),at2=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.getAdjusted(block,"AT2"),wherePascalCase={FIRST:"First",LAST:"Last",FROM_START:"FromStart",FROM_END:"FromEnd"};code=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.provideFunction_("subsequence"+wherePascalCase[where1]+wherePascalCase[where2],["function "+blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(sequence"+("FROM_END"===where1||"FROM_START"===where1?", at1":"")+("FROM_END"===where2||"FROM_START"===where2?", at2":"")+") {",getSubstringIndex("sequence",where1,"at1")+";","  var end = "+getSubstringIndex("sequence",where2,"at2")+" + 1;","  return sequence.slice(start, end);","}"])+"("+list+("FROM_END"===where1||"FROM_START"===where1?", "+at1:"")+("FROM_END"===where2||"FROM_START"===where2?", "+at2:"")+")"}return[code,blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_FUNCTION_CALL]},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.lists_sort=function(block){let list=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"LIST",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_FUNCTION_CALL)||"[]";list=`(typeof ${list} === 'object' ? ${list} : [])`;const direction="1"===block.getFieldValue("DIRECTION")?1:-1,type=block.getFieldValue("TYPE");return[list+".slice().sort("+blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.provideFunction_("listsGetSortCompare",["function "+blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(type, direction) {","  var compareFuncs = {",'    "NUMERIC": function(a, b) {',"        return Number(a) - Number(b); },",'    "TEXT": function(a, b) {',"        return a.toString() > b.toString() ? 1 : -1; },",'    "IGNORE_CASE": function(a, b) {',"        return a.toString().toLowerCase() > b.toString().toLowerCase() ? 1 : -1; },","  };","  var compare = compareFuncs[type];","  return function(a, b) { return compare(a, b) * direction; }","}"])+'("'+type+'", '+direction+"))",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_FUNCTION_CALL]},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.lists_split=function(block){let input=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"INPUT",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_MEMBER);const delimiter=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"DELIM",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_NONE)||"''",mode=block.getFieldValue("MODE");let functionName;if("SPLIT"===mode)input||(input="''"),functionName="split";else{if("JOIN"!==mode)throw Error("Unknown mode: "+mode);input||(input="[]"),functionName="join"}return[input+"?."+functionName+"("+delimiter+") || "+("SPLIT"===mode?"[]":"''"),blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_FUNCTION_CALL]},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.lists_reverse=function(block){let list=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.valueToCode(block,"LIST",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_FUNCTION_CALL)||"[]";list=`(typeof ${list} === 'object' ? ${list} : [])`;return[list+".slice().reverse()",blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.ORDER_FUNCTION_CALL]}}},7785:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var blockly__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(4948),blockly__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(blockly__WEBPACK_IMPORTED_MODULE_0__);function __WEBPACK_DEFAULT_EXPORT__(){const playerIdMixin={mutationToDom:function(){const container=blockly__WEBPACK_IMPORTED_MODULE_0___default().utils.xml.createElement("mutation"),showPlayerId="id"===this.getFieldValue("player");return container.setAttribute("playerid_input",showPlayerId),this.updateShape_(showPlayerId),container},domToMutation:function(xmlElement){const showPlayerId="false"!==xmlElement.getAttribute("playerid_input");this.updateShape_(showPlayerId)},updateShape_:function(showPlayerId){const inputExists=this.getInput("player_id");showPlayerId?inputExists||this.appendValueInput("player_id").setCheck("Number"):inputExists&&this.removeInput("player_id"),this.moveIdInputs(showPlayerId&&!inputExists)}},playerArrowIdMixin={mutationToDom:function(){const container=blockly__WEBPACK_IMPORTED_MODULE_0___default().utils.xml.createElement("mutation"),showPlayerId="id"===this.getFieldValue("player"),showArrowId="id"===this.getFieldValue("arrow");return container.setAttribute("playerid_input",showPlayerId),container.setAttribute("arrowid_input",showArrowId),this.updateShape_(showPlayerId,showArrowId),container},domToMutation:function(xmlElement){const showPlayerId="false"!==xmlElement.getAttribute("playerid_input"),showArrowId="false"!==xmlElement.getAttribute("arrowid_input");this.updateShape_(showPlayerId,showArrowId)},updateShape_:function(showPlayerId,showArrowId){const playerInputExists=this.getInput("player_id");showPlayerId?playerInputExists||this.appendValueInput("player_id").setCheck("Number"):playerInputExists&&this.removeInput("player_id");const arrowInputExists=this.getInput("arrow_id");showArrowId?arrowInputExists||this.appendValueInput("arrow_id").setCheck("Number"):arrowInputExists&&this.removeInput("arrow_id"),this.moveIdInputs(showPlayerId&&!playerInputExists,showArrowId&&!arrowInputExists)}};blockly__WEBPACK_IMPORTED_MODULE_0___default().Blocks.set_player_prop.validatorInit=function(){this.mixin(playerIdMixin),this.moveIdInputs=function(movePlayerId){movePlayerId&&this.moveInputBefore("player_id","set_number")};this.getField("player").setValidator((function(newValue){const showPlayerId="id"===newValue;this.getSourceBlock().updateShape_(showPlayerId)}))},blockly__WEBPACK_IMPORTED_MODULE_0___default().Blocks.change_player_prop.validatorInit=function(){this.mixin(playerIdMixin),this.moveIdInputs=function(movePlayerId){movePlayerId&&this.moveInputBefore("player_id","change_number")};this.getField("player").setValidator((function(newValue){const showPlayerId="id"===newValue;this.getSourceBlock().updateShape_(showPlayerId)}))},blockly__WEBPACK_IMPORTED_MODULE_0___default().Blocks.set_last_arrow_prop.validatorInit=function(){this.mixin(playerArrowIdMixin),this.moveIdInputs=function(movePlayerId,moveArrowId){moveArrowId&&this.moveInputBefore("arrow_id","set_number"),movePlayerId&&this.moveNumberedInputBefore(this.inputList.length-1,1)};const playerDropdown=this.getField("player");playerDropdown.setValidator((function(newValue){const showPlayerId="id"===newValue,showArrowId="id"===arrowDropdown.getValue();this.getSourceBlock().updateShape_(showPlayerId,showArrowId)}));const arrowDropdown=this.getField("arrow");arrowDropdown.setValidator((function(newValue){const showPlayerId="id"===playerDropdown.getValue(),showArrowId="id"===newValue;this.getSourceBlock().updateShape_(showPlayerId,showArrowId)}))},blockly__WEBPACK_IMPORTED_MODULE_0___default().Blocks.change_last_arrow_prop.validatorInit=function(){this.mixin(playerArrowIdMixin),this.moveIdInputs=function(movePlayerId,moveArrowId){moveArrowId&&this.moveInputBefore("arrow_id","change_number"),movePlayerId&&this.moveNumberedInputBefore(this.inputList.length-1,1)};const playerDropdown=this.getField("player");playerDropdown.setValidator((function(newValue){const showPlayerId="id"===newValue,showArrowId="id"===arrowDropdown.getValue();this.getSourceBlock().updateShape_(showPlayerId,showArrowId)}));const arrowDropdown=this.getField("arrow");arrowDropdown.setValidator((function(newValue){const showPlayerId="id"===playerDropdown.getValue(),showArrowId="id"===newValue;this.getSourceBlock().updateShape_(showPlayerId,showArrowId)}))},blockly__WEBPACK_IMPORTED_MODULE_0___default().Blocks.get_player_prop.validatorInit=function(){this.mixin(playerIdMixin),this.moveIdInputs=function(movePlayerId){movePlayerId&&this.moveNumberedInputBefore(this.inputList.length-1,1)};this.getField("player").setValidator((function(newValue){const showPlayerId="id"===newValue;this.getSourceBlock().updateShape_(showPlayerId)}))},blockly__WEBPACK_IMPORTED_MODULE_0___default().Blocks.get_last_arrow_prop.validatorInit=function(){this.mixin(playerArrowIdMixin),this.moveIdInputs=function(movePlayerId,moveArrowId){moveArrowId&&this.moveNumberedInputBefore(this.inputList.length-1,this.inputList.length-2),movePlayerId&&this.moveNumberedInputBefore(this.inputList.length-1,1)};const playerDropdown=this.getField("player");playerDropdown.setValidator((function(newValue){const showPlayerId="id"===newValue,showArrowId="id"===arrowDropdown.getValue();this.getSourceBlock().updateShape_(showPlayerId,showArrowId)}));const arrowDropdown=this.getField("arrow");arrowDropdown.setValidator((function(newValue){const showPlayerId="id"===playerDropdown.getValue(),showArrowId="id"===newValue;this.getSourceBlock().updateShape_(showPlayerId,showArrowId)}))},blockly__WEBPACK_IMPORTED_MODULE_0___default().Blocks.get_arrow_amount.validatorInit=function(){this.mixin(playerIdMixin),this.moveIdInputs=function(movePlayerId){movePlayerId&&this.moveNumberedInputBefore(this.inputList.length-1,1)};this.getField("player").setValidator((function(newValue){const showPlayerId="id"===newValue;this.getSourceBlock().updateShape_(showPlayerId)}))},blockly__WEBPACK_IMPORTED_MODULE_0___default().Blocks.delete_arrows.validatorInit=function(){this.mixin(playerArrowIdMixin),this.moveIdInputs=function(movePlayerId,moveArrowId){movePlayerId&&this.moveNumberedInputBefore(this.inputList.length-1,1)};const playerDropdown=this.getField("player");playerDropdown.setValidator((function(newValue){const showPlayerId="id"===newValue,showArrowId="id"===arrowDropdown.getValue();this.getSourceBlock().updateShape_(showPlayerId,showArrowId)}));const arrowDropdown=this.getField("arrow");arrowDropdown.setValidator((function(newValue){const showPlayerId="id"===playerDropdown.getValue(),showArrowId="id"===newValue;this.getSourceBlock().updateShape_(showPlayerId,showArrowId)}))},blockly__WEBPACK_IMPORTED_MODULE_0___default().Blocks.player_die.validatorInit=function(){this.mixin(playerIdMixin),this.moveIdInputs=function(movePlayerId){movePlayerId&&this.moveNumberedInputBefore(this.inputList.length-1,1)};this.getField("player").setValidator((function(newValue){const showPlayerId="id"===newValue;this.getSourceBlock().updateShape_(showPlayerId)}))},blockly__WEBPACK_IMPORTED_MODULE_0___default().Blocks.pressing_key.validatorInit=function(){this.mixin(playerIdMixin),this.moveIdInputs=function(movePlayerId){movePlayerId&&this.moveNumberedInputBefore(this.inputList.length-1,1)};this.getField("player").setValidator((function(newValue){const showPlayerId="id"===newValue;this.getSourceBlock().updateShape_(showPlayerId)}))},blockly__WEBPACK_IMPORTED_MODULE_0___default().Blocks.player_on_team.validatorInit=function(){this.mixin(playerIdMixin),this.moveIdInputs=function(movePlayerId){movePlayerId&&this.moveNumberedInputBefore(this.inputList.length-1,1)};this.getField("player").setValidator((function(newValue){const showPlayerId="id"===newValue;this.getSourceBlock().updateShape_(showPlayerId)}))},blockly__WEBPACK_IMPORTED_MODULE_0___default().Blocks.get_player_color.validatorInit=function(){this.mixin(playerIdMixin),this.moveIdInputs=function(movePlayerId){movePlayerId&&this.moveNumberedInputBefore(this.inputList.length-1,1)};this.getField("player").setValidator((function(newValue){const showPlayerId="id"===newValue;this.getSourceBlock().updateShape_(showPlayerId)}))},blockly__WEBPACK_IMPORTED_MODULE_0___default().Blocks.get_player_name.validatorInit=function(){this.mixin(playerIdMixin),this.moveIdInputs=function(movePlayerId){movePlayerId&&this.moveNumberedInputBefore(this.inputList.length-1,1)};this.getField("player").setValidator((function(newValue){const showPlayerId="id"===newValue;this.getSourceBlock().updateShape_(showPlayerId)}))},blockly__WEBPACK_IMPORTED_MODULE_0___default().Blocks.on_player_collide.validatorInit=function(){const returnInfo=this.getField("return_info"),collideType=this.getField("collide_type"),block=this;function showHideVars(showVars,colType){if(block.getField("player_id").setVisible(!1),block.getField("arrow_id").setVisible(!1),block.getField("platform_id").setVisible(!1),block.getField("shape_id").setVisible(!1),block.getField("normal_x").setVisible(!1),block.getField("normal_y").setVisible(!1),"TRUE"==showVars)switch(colType){case"collide_player":block.getField("player_id").setVisible(!0);break;case"collide_arrow":block.getField("player_id").setVisible(!0),block.getField("arrow_id").setVisible(!0);break;case"collide_platform":block.getField("platform_id").setVisible(!0),block.getField("shape_id").setVisible(!0),block.getField("normal_x").setVisible(!0),block.getField("normal_y").setVisible(!0)}}returnInfo.setValidator((function(newValue){showHideVars(newValue,collideType.getValue()),returnInfo.forceRerender()})),collideType.setValidator((function(newValue){showHideVars(returnInfo.getValue(),newValue),collideType.forceRerender()}))},blockly__WEBPACK_IMPORTED_MODULE_0___default().Blocks.on_arrow_collide.validatorInit=function(){const returnInfo=this.getField("return_info"),collideType=this.getField("collide_type"),block=this;function showHideVars(showVars,colType){if(block.getField("self_arrow_id").setVisible(!1),block.getField("player_id").setVisible(!1),block.getField("arrow_id").setVisible(!1),block.getField("platform_id").setVisible(!1),block.getField("shape_id").setVisible(!1),block.getField("normal_x").setVisible(!1),block.getField("normal_y").setVisible(!1),"TRUE"==showVars)switch(colType){case"collide_player":block.getField("self_arrow_id").setVisible(!0),block.getField("player_id").setVisible(!0);break;case"collide_arrow":block.getField("self_arrow_id").setVisible(!0),block.getField("player_id").setVisible(!0),block.getField("arrow_id").setVisible(!0);break;case"collide_platform":block.getField("self_arrow_id").setVisible(!0),block.getField("platform_id").setVisible(!0),block.getField("shape_id").setVisible(!0),block.getField("normal_x").setVisible(!0),block.getField("normal_y").setVisible(!0)}}returnInfo.setValidator((function(newValue){showHideVars(newValue,collideType.getValue()),returnInfo.forceRerender()})),collideType.setValidator((function(newValue){showHideVars(returnInfo.getValue(),newValue),collideType.forceRerender()}))},blockly__WEBPACK_IMPORTED_MODULE_0___default().Blocks.on_platform_collide.validatorInit=function(){const returnInfo=this.getField("return_info"),collideType=this.getField("collide_type"),block=this;function showHideVars(showVars,colType){if(block.getField("self_platform_id").setVisible(!1),block.getField("self_shape_id").setVisible(!1),block.getField("player_id").setVisible(!1),block.getField("arrow_id").setVisible(!1),block.getField("platform_id").setVisible(!1),block.getField("shape_id").setVisible(!1),block.getField("normal_x").setVisible(!1),block.getField("normal_y").setVisible(!1),"TRUE"==showVars)switch(colType){case"collide_player":block.getField("self_platform_id").setVisible(!0),block.getField("self_shape_id").setVisible(!0),block.getField("player_id").setVisible(!0);break;case"collide_arrow":block.getField("self_platform_id").setVisible(!0),block.getField("self_shape_id").setVisible(!0),block.getField("player_id").setVisible(!0),block.getField("arrow_id").setVisible(!0);break;case"collide_platform":block.getField("self_platform_id").setVisible(!0),block.getField("self_shape_id").setVisible(!0),block.getField("platform_id").setVisible(!0),block.getField("shape_id").setVisible(!0),block.getField("normal_x").setVisible(!0),block.getField("normal_y").setVisible(!0)}}returnInfo.setValidator((function(newValue){showHideVars(newValue,collideType.getValue()),returnInfo.forceRerender()})),collideType.setValidator((function(newValue){showHideVars(returnInfo.getValue(),newValue),collideType.forceRerender()}))},blockly__WEBPACK_IMPORTED_MODULE_0___default().Blocks.input_override.validatorInit=function(){this.mixin(playerIdMixin),this.moveIdInputs=function(movePlayerId){movePlayerId&&this.moveNumberedInputBefore(this.inputList.length-1,1)};this.getField("player").setValidator((function(newValue){const showPlayerId="id"===newValue;this.getSourceBlock().updateShape_(showPlayerId)}))},blockly__WEBPACK_IMPORTED_MODULE_0___default().Blocks.stop_input_override.validatorInit=function(){this.mixin(playerIdMixin),this.moveIdInputs=function(movePlayerId){movePlayerId&&this.moveNumberedInputBefore(this.inputList.length-1,1)};this.getField("player").setValidator((function(newValue){const showPlayerId="id"===newValue;this.getSourceBlock().updateShape_(showPlayerId)}))},blockly__WEBPACK_IMPORTED_MODULE_0___default().Blocks.set_camera_prop.validatorInit=function(){this.mixin(playerIdMixin),this.moveIdInputs=function(movePlayerId){movePlayerId&&this.moveInputBefore("player_id","set_number")};this.getField("player").setValidator((function(newValue){const showPlayerId="id"===newValue;this.getSourceBlock().updateShape_(showPlayerId)}))},blockly__WEBPACK_IMPORTED_MODULE_0___default().Blocks.change_camera_prop.validatorInit=function(){this.mixin(playerIdMixin),this.moveIdInputs=function(movePlayerId){movePlayerId&&this.moveInputBefore("player_id","change_number")};this.getField("player").setValidator((function(newValue){const showPlayerId="id"===newValue;this.getSourceBlock().updateShape_(showPlayerId)}))},blockly__WEBPACK_IMPORTED_MODULE_0___default().Blocks.get_camera_prop.validatorInit=function(){this.mixin(playerIdMixin),this.moveIdInputs=function(movePlayerId){movePlayerId&&this.moveNumberedInputBefore(this.inputList.length-1,1)};this.getField("player").setValidator((function(newValue){const showPlayerId="id"===newValue;this.getSourceBlock().updateShape_(showPlayerId)}))},blockly__WEBPACK_IMPORTED_MODULE_0___default().Blocks.change_camera_lerp.validatorInit=function(){this.mixin(playerIdMixin),this.moveIdInputs=function(movePlayerId){movePlayerId&&this.moveNumberedInputBefore(this.inputList.length-1,1)};this.getField("player").setValidator((function(newValue){const showPlayerId="id"===newValue;this.getSourceBlock().updateShape_(showPlayerId)}))},blockly__WEBPACK_IMPORTED_MODULE_0___default().Blocks.play_sound.validatorInit=function(){this.getField("pan_type").setValidator((function(newValue){"world"===newValue?this.getSourceBlock().getField("sound_pan_name").setValue("x sound position"):this.getSourceBlock().getField("sound_pan_name").setValue("panning (-1.0 to 1.0)")}))};const variableMixin={mutationToDom:function(){const container=blockly__WEBPACK_IMPORTED_MODULE_0___default().utils.xml.createElement("mutation"),showPlayerId="id"===this.getFieldValue("player"),showDropdown=!this.getField("VAR").variable_.name.startsWith("GLOBAL_");return container.setAttribute("playerid_input",showPlayerId),container.setAttribute("show_dropdown",showDropdown),this.updateShape_(showPlayerId,showDropdown),container},domToMutation:function(xmlElement){const showPlayerId="false"!==xmlElement.getAttribute("playerid_input"),showDropdown="false"!==xmlElement.getAttribute("show_dropdown");this.updateShape_(showPlayerId,showDropdown)},updateShape_:function(showPlayerId,showDropdown){const inputExists=this.getInput("player_id");showPlayerId&&showDropdown?inputExists||this.appendValueInput("player_id").setCheck("Number"):inputExists&&this.removeInput("player_id");const dropExists=this.getField("player");if(showDropdown){if(!dropExists){this.getInput("drop_container").appendField(new(blockly__WEBPACK_IMPORTED_MODULE_0___default().FieldDropdown)([["your","self"],["player with id","id"]]),"player");this.getField("player").setValidator((function(newValue){const showPlayerId="id"===newValue;this.getSourceBlock().updateShape_(showPlayerId,!this.getSourceBlock().getField("VAR").selectedOption_[0].startsWith("GLOBAL_"))}))}}else dropExists&&this.getInput("drop_container").removeField("player");this.moveIdInputs(showPlayerId&&showDropdown&&!inputExists)}};blockly__WEBPACK_IMPORTED_MODULE_0___default().Blocks.variables_get.validatorInit=function(){this.mixin(variableMixin),this.moveIdInputs=function(movePlayerId){movePlayerId&&this.moveNumberedInputBefore(this.inputList.length-1,1)};this.getField("VAR").setValidator((function(newValue){const startsWithGlobal=blockly__WEBPACK_IMPORTED_MODULE_0___default().Variables.getVariable(gm.blockly.workspace,newValue).name.startsWith("GLOBAL_"),showPlayerId=!startsWithGlobal&&"id"===this.getSourceBlock().getFieldValue("player");this.getSourceBlock().updateShape_(showPlayerId,!startsWithGlobal)}));this.getField("player").setValidator((function(newValue){if(!this.getSourceBlock().getField("VAR").variable_)return;const showPlayerId="id"===newValue;this.getSourceBlock().updateShape_(showPlayerId,!this.getSourceBlock().getField("VAR").variable_.name.startsWith("GLOBAL_"))}))},blockly__WEBPACK_IMPORTED_MODULE_0___default().Blocks.variables_set.validatorInit=function(){this.mixin(variableMixin),this.moveIdInputs=function(movePlayerId){movePlayerId&&this.moveNumberedInputBefore(this.inputList.length-1,2)};this.getField("VAR").setValidator((function(newValue){const startsWithGlobal=blockly__WEBPACK_IMPORTED_MODULE_0___default().Variables.getVariable(gm.blockly.workspace,newValue).name.startsWith("GLOBAL_"),showPlayerId=!startsWithGlobal&&"id"===this.getSourceBlock().getFieldValue("player");this.getSourceBlock().updateShape_(showPlayerId,!startsWithGlobal)}));this.getField("player").setValidator((function(newValue){if(!this.getSourceBlock().getField("VAR").variable_)return;const showPlayerId="id"===newValue;this.getSourceBlock().updateShape_(showPlayerId,!this.getSourceBlock().getField("VAR").variable_.name.startsWith("GLOBAL_"))}))},blockly__WEBPACK_IMPORTED_MODULE_0___default().Blocks.math_change.validatorInit=function(){this.mixin(variableMixin),this.moveIdInputs=function(movePlayerId){movePlayerId&&this.moveNumberedInputBefore(this.inputList.length-1,2)};this.getField("VAR").setValidator((function(newValue){const startsWithGlobal=blockly__WEBPACK_IMPORTED_MODULE_0___default().Variables.getVariable(gm.blockly.workspace,newValue).name.startsWith("GLOBAL_"),showPlayerId=!startsWithGlobal&&"id"===this.getSourceBlock().getFieldValue("player");this.getSourceBlock().updateShape_(showPlayerId,!startsWithGlobal)}));this.getField("player").setValidator((function(newValue){if(!this.getSourceBlock().getField("VAR").variable_)return;const showPlayerId="id"===newValue;this.getSourceBlock().updateShape_(showPlayerId,!this.getSourceBlock().getField("VAR").variable_.name.startsWith("GLOBAL_"))}))};const createPlatformMixin={mutationToDom:function(){const container=blockly__WEBPACK_IMPORTED_MODULE_0___default().utils.xml.createElement("mutation"),isStatement=!!this.outputConnection;return container.setAttribute("statement",isStatement),container},domToMutation:function(xmlElement){const returnId="true"===xmlElement.getAttribute("statement");this.updateShape_(returnId)},updateShape_:function(returnId){returnId!==!!this.outputConnection&&(this.unplug(!0,!0),returnId?(this.setPreviousStatement(!1),this.setNextStatement(!1),this.setOutput(!0)):(this.setOutput(!1),this.setPreviousStatement(!0),this.setNextStatement(!0)))}};blockly__WEBPACK_IMPORTED_MODULE_0___default().Blocks.create_platform.validatorInit=function(){this.mixin(createPlatformMixin);this.getField("return_id").setValidator((function(newValue){this.getSourceBlock().updateShape_("TRUE"===newValue)}))},blockly__WEBPACK_IMPORTED_MODULE_0___default().Blocks.clone_platform.validatorInit=function(){this.mixin(createPlatformMixin);this.getField("return_id").setValidator((function(newValue){this.getSourceBlock().updateShape_("TRUE"===newValue)}))}}blockly__WEBPACK_IMPORTED_MODULE_0___default().Xml.applyInputTagNodes_=function(xmlChildren,workspace,block,prototypeName){for(let i=0;i<xmlChildren.length;i++){const xmlChild=xmlChildren[i],nodeName=xmlChild.getAttribute("name"),input=block.getInput(nodeName);if(!input){console.warn("Ignoring non-existent input "+nodeName+" in block "+prototypeName);continue}const childBlockInfo=blockly__WEBPACK_IMPORTED_MODULE_0___default().Xml.findChildBlocks_(xmlChild);if(childBlockInfo.childBlockElement){if(!input.connection)throw TypeError("Input connection does not exist.");blockly__WEBPACK_IMPORTED_MODULE_0___default().Xml.domToBlockHeadless_(childBlockInfo.childBlockElement,workspace,input.connection,!1)}childBlockInfo.childShadowElement&&input.connection.setShadowDom(childBlockInfo.childShadowElement)}}},9323:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var blockly__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(4948),blockly__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(blockly__WEBPACK_IMPORTED_MODULE_0__),_blockly_plugin_workspace_search__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(4165),_blockly_toolbox_xml__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(8820),_gmWindow_window_html__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(5026),_blockly_blockdefs_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(8201),_blockly_blockdefs_js__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_blockly_blockdefs_js__WEBPACK_IMPORTED_MODULE_2__),_blockly_blockfuncs_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(8557),_blockly_blockvalidators_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(7785),file_saver__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(3162),file_saver__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(file_saver__WEBPACK_IMPORTED_MODULE_5__);const __WEBPACK_DEFAULT_EXPORT__={init:function(){this.blockDefs=_blockly_blockdefs_js__WEBPACK_IMPORTED_MODULE_2___default(),this.initGMEditor()},initGMEditor:function(){const GMEditorWindow=document.createElement("div");document.getElementById("newbonkgamecontainer").appendChild(GMEditorWindow),GMEditorWindow.outerHTML=_gmWindow_window_html__WEBPACK_IMPORTED_MODULE_6__.Z,document.getElementById("gmeditor_newbutton").addEventListener("click",gm.blockly.GMENew),document.getElementById("gmeditor_importbutton").addEventListener("click",gm.blockly.GMEImport),document.getElementById("gmeditor_exportbutton").addEventListener("click",gm.blockly.GMEExportShow),document.getElementById("gmeditor_backupsbutton").addEventListener("click",gm.blockly.GMEBackupsShow),document.getElementById("gmeditor_settingsbutton").addEventListener("click",gm.blockly.GMESettingsShow),document.getElementById("gmeditor_savebutton").addEventListener("click",gm.blockly.GMESave),document.getElementById("gmeditor_closebutton").addEventListener("click",gm.blockly.hideGMEWindow),document.getElementById("gmsettings_cancel").addEventListener("click",gm.blockly.GMESettingsCancel),document.getElementById("gmsettings_save").addEventListener("click",gm.blockly.GMESettingsSave),document.getElementById("gmexport_cancel").addEventListener("click",gm.blockly.GMEExportCancel),document.getElementById("gmexport_ok").addEventListener("click",gm.blockly.GMEExportSave),document.getElementById("gmbackups_cancel").addEventListener("click",gm.blockly.GMEBackupsCancel),document.getElementById("gmbackups_load").addEventListener("click",gm.blockly.GMEBackupsLoad),document.getElementById("gmimportdialog_cancel").addEventListener("click",gm.blockly.GMEImportMapCancel),document.getElementById("gmimportdialog_no").addEventListener("click",gm.blockly.GMEImportMapNo),document.getElementById("gmimportdialog_yes").addEventListener("click",gm.blockly.GMEImportMapYes);const GMOpenButton=document.createElement("div");GMOpenButton.id="gmeditor_openbutton",GMOpenButton.className="newbonklobby_settings_button brownButton brownButton_classic buttonShadow",GMOpenButton.addEventListener("click",gm.blockly.showGMEWindow),window.createModeDropdown?(window.createModeDropdown_OLD=window.createModeDropdown,window.createModeDropdown=function(){window.createModeDropdown_OLD(),GMOpenButton.className+=" gm_withbonkhost",document.getElementById("newbonklobby_settingsbox").appendChild(GMOpenButton),window.BonkUtils.setButtonSounds([GMOpenButton])}):(document.getElementById("newbonklobby_settingsbox").appendChild(GMOpenButton),window.BonkUtils.setButtonSounds([GMOpenButton]));const buttons=["gmeditor_newbutton","gmeditor_importbutton","gmeditor_exportbutton","gmeditor_savebutton","gmeditor_closebutton","gmeditor_settingsbutton","gmeditor_backupsbutton","gmexport_cancel","gmexport_ok","gmimportdialog_cancel","gmimportdialog_no","gmimportdialog_yes","gmsettings_cancel","gmsettings_save","gmbackups_cancel","gmbackups_load"];for(let i=0;i<buttons.length;i++)window.BonkUtils.setButtonSounds([document.getElementById(buttons[i])]);const baseModeSelect=document.getElementById("gmsettings_basemode");for(const mode of window.ModeList.lobbyModes){if("f"===mode||"p"===mode)continue;const option=document.createElement("option");option.value=mode,option.innerText=window.ModeList.modes[mode].lobbyName,baseModeSelect.appendChild(option)}this.varInspectorContainer=document.createElement("div"),this.varInspectorContainer.id="gm_varinspector";const varInspTopBar=document.createElement("div");varInspTopBar.className="windowTopBar windowTopBar_classic",varInspTopBar.innerText="Variable Inspector",this.varInspectorContainer.appendChild(varInspTopBar),this.varInspector=document.createElement("div"),this.varInspector.id="gmvi_content",this.varInspectorContainer.appendChild(this.varInspector),document.getElementById("pagecontainer").appendChild(this.varInspectorContainer),this.makeDraggable(this.varInspectorContainer,varInspTopBar);for(let i=0;i!==this.blockDefs.length;i++)blockly__WEBPACK_IMPORTED_MODULE_0___default().Blocks[this.blockDefs[i].type]={};(0,_blockly_blockvalidators_js__WEBPACK_IMPORTED_MODULE_4__.Z)();for(let i=0;i!==this.blockDefs.length;i++)blockly__WEBPACK_IMPORTED_MODULE_0___default().Blocks[this.blockDefs[i].type].init=function(){this.jsonInit(gm.blockly.blockDefs[i]),this.validatorInit&&this.validatorInit()};(0,_blockly_blockfuncs_js__WEBPACK_IMPORTED_MODULE_3__.Z)();for(const block in blockly__WEBPACK_IMPORTED_MODULE_0___default().Blocks)blockly__WEBPACK_IMPORTED_MODULE_0___default().Blocks[block].init=function(){const init_OLD=blockly__WEBPACK_IMPORTED_MODULE_0___default().Blocks[block].init;return function(){if(init_OLD.apply(this,arguments),!this.type.startsWith("on_")&&!this.type.startsWith("procedures_def")){const onChange_OLD=this.onchange;this.setOnChange((function(){onChange_OLD&&onChange_OLD.apply(this,arguments),this.parentBlock_||this.isInMutator||this.isInFlyout?this.setWarningText(null):this.setWarningText("The block must be inside an event block (one of the\nblocks in the Bonk Events category), or inside a function definition.")}))}}}();const blocklyToolbox=document.createElement("xml");document.head.appendChild(blocklyToolbox),blocklyToolbox.outerHTML=_blockly_toolbox_xml__WEBPACK_IMPORTED_MODULE_7__.Z;const blocklyDiv=document.createElement("div");blocklyDiv.id="gmblocklydiv";const bounds=document.getElementById("gmblocklyarea").getBoundingClientRect();blocklyDiv.style.top=bounds.top,blocklyDiv.style.left=bounds.left,blocklyDiv.style.width=bounds.width,blocklyDiv.style.height=bounds.height,document.getElementById("pagecontainer").appendChild(blocklyDiv),gm.blockly.theme=blockly__WEBPACK_IMPORTED_MODULE_0___default().Theme.defineTheme("gmmaker",{base:blockly__WEBPACK_IMPORTED_MODULE_0___default().Themes.Classic,fontStyle:{family:"futurept_b1",size:12}}),gm.blockly.workspace=blockly__WEBPACK_IMPORTED_MODULE_0___default().inject("gmblocklydiv",{toolbox:document.getElementById("toolbox"),zoom:{controls:!0,wheel:!0,pinch:!0},theme:gm.blockly.theme}),gm.blockly.headlessWorkspace=new(blockly__WEBPACK_IMPORTED_MODULE_0___default().Workspace);const workspaceSearch=new _blockly_plugin_workspace_search__WEBPACK_IMPORTED_MODULE_1__.p(gm.blockly.workspace);workspaceSearch.init(),workspaceSearch.next=function(){workspaceSearch.setCurrentBlock_(workspaceSearch.currentBlockIndex_+1),setTimeout((()=>workspaceSearch.inputElement_.focus()),2)},blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.INFINITE_LOOP_TRAP="if (++loopIterations > 10000000) throw 'gmInfiniteLoop';",window.addEventListener("resize",(()=>{const bounds=document.getElementById("gmblocklyarea").getBoundingClientRect();blocklyDiv.style.top=bounds.top,blocklyDiv.style.left=bounds.left,blocklyDiv.style.width=bounds.width,blocklyDiv.style.height=bounds.height,blockly__WEBPACK_IMPORTED_MODULE_0___default().svgResize(gm.blockly.workspace)}),!1),this.hideGMEWindow(),gm.blockly.savedXml=document.createElement("xml");const dbOpenRequest=window.indexedDB.open("gmmakerStorage",1);let db;dbOpenRequest.onsuccess=()=>{db=dbOpenRequest.result,db.transaction("backups");const getRequest=db.transaction("backups").objectStore("backups").get(1);getRequest.onsuccess=()=>{gm.blockly.modeBackups=getRequest.result},getRequest.onerror=event=>{console.error(event),alert("[Game Mode Maker] Unable to get mode backups from database.")}},dbOpenRequest.onerror=event=>{console.error(event),alert("[Game Mode Maker] Unable to open database. No mode backups will show up, and no new backups will be created.")},dbOpenRequest.onupgradeneeded=event=>{event.target.result.createObjectStore("backups").put([],1)},gm.blockly.workspace.addChangeListener((function(){if(!gm.blockly.canBackup)return;if(!db)return;gm.blockly.canBackup=!1,setTimeout((function(){gm.blockly.canBackup=!0}),3e4),gm.blockly.modeBackups.length>5&&gm.blockly.modeBackups.pop();const xml=blockly__WEBPACK_IMPORTED_MODULE_0___default().Xml.workspaceToDom(gm.blockly.workspace,!0),settingsObj=blockly__WEBPACK_IMPORTED_MODULE_0___default().utils.xml.createElement("gmsettings");settingsObj.setAttribute("mode_name",gm.blockly.modeName||"Custom"),settingsObj.setAttribute("mode_description",gm.blockly.modeDescription||"Change your mode's description on the Game Mode Editor's Settings menu (gear icon)."),settingsObj.setAttribute("show_var_insp",gm.blockly.showVarInspector),settingsObj.setAttribute("base_mode",gm.blockly.baseMode||"any"),xml.appendChild(settingsObj),gm.blockly.modeBackups.unshift({xml:xml.innerHTML,timeStamp:Date.now()});db.transaction("backups","readwrite").objectStore("backups").put(gm.blockly.modeBackups,1),db.onerror=console.error})),gm.blockly.headlessWorkspace.fireChangeListener_OLD=gm.blockly.headlessWorkspace.fireChangeListener,gm.blockly.headlessWorkspace.fireChangeListener=function(){if(gm.lobby.networkEngine.getLSID()===gm.lobby.networkEngine.hostID)return gm.blockly.headlessWorkspace.fireChangeListener_OLD(...arguments)},window.blockly=blockly__WEBPACK_IMPORTED_MODULE_0___default()},makeDraggable:function(elmnt,dragBar){let pos1=0,pos2=0,pos3=0,pos4=0;function dragMouseDown(e){(e=e||window.event).preventDefault(),pos3=e.clientX,pos4=e.clientY,document.onmouseup=closeDragElement,document.onmousemove=elementDrag}function elementDrag(e){(e=e||window.event).preventDefault(),pos1=pos3-e.clientX,pos2=pos4-e.clientY,pos3=e.clientX,pos4=e.clientY,elmnt.style.top=elmnt.offsetTop-pos2+"px",elmnt.style.left=elmnt.offsetLeft-pos1+"px"}function closeDragElement(){document.onmouseup=null,document.onmousemove=null}dragBar?dragBar.onmousedown=dragMouseDown:elmnt.onmousedown=dragMouseDown},blockDefs:null,workspace:null,xmlToImport:null,xmlDict:["block","mutation","field","variable","variables","bonkmap","statement","shadow","value","name","type","next","playerid_input","show_dropdown"],savedXml:null,modeBackups:[],canBackup:!0,compressXml:function(xml){if(!xml)return xml;for(let i=0;i<this.xmlDict.length;i++)xml=(xml=xml.replace(new RegExp(`<(/|)${this.xmlDict[i]}([ >])`,"g"),`<$1${i}$2`)).replace(new RegExp(` ${this.xmlDict[i]}="`,"g"),` ${i}="`);return xml},decompressXml:function(xml){if(!xml)return xml;for(let i=0;i<this.xmlDict.length;i++)xml=(xml=xml.replace(new RegExp(`<(/|)${i}([ >])`,"g"),`<$1${this.xmlDict[i]}$2`)).replace(new RegExp(` ${i}="`,"g"),` ${this.xmlDict[i]}="`);return xml},modeName:null,modeDescription:null,showVarInspector:!1,varInspector:null,createVarInspTab:function(id,name){if(!this.varInspector)return;const tabHeaderElement=document.createElement("div");tabHeaderElement.id=`gmvi_tab_header_${id}`,tabHeaderElement.className="mapeditor_table_heading_div";const tabNameElement=document.createElement("div");tabNameElement.id=`gmvi_tab_name_${id}`,tabNameElement.className="mapeditor_rightbox_heading",tabNameElement.innerText=name,tabHeaderElement.appendChild(tabNameElement);const tabSignElement=document.createElement("div");tabSignElement.id=`gmvi_tab_sign_${id}`,tabSignElement.className="mapeditor_rightbox_heading_pm",tabSignElement.innerText="+",tabHeaderElement.appendChild(tabSignElement);const tabContentElement=document.createElement("div");tabContentElement.id=`gmvi_tab_content_${id}`,tabContentElement.className="gmvi_tab_content",tabContentElement.style.display="none",tabHeaderElement.addEventListener("click",(function(){"none"==tabContentElement.style.display?(tabContentElement.style.display="flex",tabSignElement.textContent="-"):(tabContentElement.style.display="none",tabSignElement.textContent="+")})),this.varInspector.appendChild(tabHeaderElement),this.varInspector.appendChild(tabContentElement)},updateVarInspector:function(gameState){const vars=gameState.physics.bodies[0]?.cf.variables;document.getElementById("gmvi_tab_header_global")||this.createVarInspTab("global","Global");for(let i=0;i<gameState.discs.length;i++)gameState.discs[i]&&gm.graphics.rendererClass.playerArray[i]&&(document.getElementById(`gmvi_tab_header_${i}`)||this.createVarInspTab(i,`${gm.graphics.rendererClass.playerArray[i].userName||"Unknown"} (id ${i})`));if(vars)for(const key in vars)if(document.getElementById(`gmvi_tab_header_${key}`))for(const varName in vars[key]){let varElement=document.getElementById(`gmvi_vars_${key}_${varName}`);if(!varElement){const varContainer=document.createElement("div");varContainer.className="gmvi_var";const varNameElement=document.createElement("div");varNameElement.innerText=varName,varContainer.appendChild(varNameElement),varElement=document.createElement("div"),varElement.id=`gmvi_vars_${key}_${varName}`,varContainer.appendChild(varElement),document.getElementById(`gmvi_tab_content_${key}`).appendChild(varContainer)}const varJSON=JSON.stringify(vars[key][varName]);varElement.innerText=varJSON.includes("{")?varJSON.replace(/{([^{]+{[^}]+}){2}}/g,"{Shape}"):varJSON}},GMENew:function(){confirm("Are you sure you want to delete all blocks and reset mode settings?")&&(gm.blockly.workspace.clear(),gm.blockly.modeName="Custom",gm.blockly.modeDescription="Change your mode's description on the Game Mode Editor's Settings menu (gear icon).",gm.blockly.showVarInspector=!1,gm.blockly.baseMode="any")},GMEImport:function(){const input=document.createElement("input");input.type="file",input.onchange=e=>{const file=e.target.files[0],reader=new FileReader;reader.readAsText(file,"UTF-8"),reader.onload=readerEvent=>{let content=readerEvent.target.result;content.startsWith("!!!COMPRESSED!!!")&&(content=content.replace("!!!COMPRESSED!!!",""),content=gm.blockly.decompressXml(content));const xml=document.createElement("xml");xml.innerHTML=content;const gmSettings=xml?.getElementsByTagName("gmsettings")[0];gm.blockly.modeName=gmSettings?.getAttribute("mode_name")||"Custom",gm.blockly.modeDescription=gmSettings?.getAttribute("mode_description")||"Change your mode's description on the Game Mode Editor's Settings menu (gear icon).",gm.blockly.showVarInspector="true"===gmSettings?.getAttribute("show_var_insp")||!1,gm.blockly.baseMode=gmSettings?.getAttribute("base_mode")||"any",document.getElementById("gmexport_name").value=file.name.slice(0,-4),gm.lobby.networkEngine.getLSID()==gm.lobby.networkEngine.hostID&&xml.getElementsByTagName("bonkmap")[0]?(gm.blockly.xmlToImport=xml,document.getElementById("gm_importdialogwindowcontainer").style.visibility="visible"):(gm.blockly.workspace.clear(),blockly__WEBPACK_IMPORTED_MODULE_0___default().Xml.domToWorkspace(xml,gm.blockly.workspace))}},input.click()},GMEImportMapCancel:function(){document.getElementById("gm_importdialogwindowcontainer").style.visibility="hidden"},GMEImportMapNo:function(){gm.blockly.workspace.clear(),blockly__WEBPACK_IMPORTED_MODULE_0___default().Xml.domToWorkspace(gm.blockly.xmlToImport,gm.blockly.workspace),document.getElementById("gm_importdialogwindowcontainer").style.visibility="hidden"},GMEImportMapYes:function(){const gameSettings=gm.lobby.mpSession.getGameSettings();gameSettings.map=MapEncoder.decodeFromDatabase(gm.blockly.xmlToImport.getElementsByTagName("bonkmap")[0].innerHTML),gm.lobby.bonkLobby.updateGameSettings(gameSettings),gm.lobby.networkEngine.sendMapAdd(gameSettings.map),gm.blockly.workspace.clear(),blockly__WEBPACK_IMPORTED_MODULE_0___default().Xml.domToWorkspace(gm.blockly.xmlToImport,gm.blockly.workspace),document.getElementById("gm_importdialogwindowcontainer").style.visibility="hidden"},GMEExportShow:function(){document.getElementById("gm_exportwindowcontainer").style.visibility="visible",document.getElementById("gmexport_name").focus()},GMEExportCancel:function(){document.getElementById("gm_exportwindowcontainer").style.visibility="hidden"},GMEExportSave:function(){const filename=document.getElementById("gmexport_name").value,attachMap=document.getElementById("gmexport_attachmap").checked,xml=blockly__WEBPACK_IMPORTED_MODULE_0___default().Xml.workspaceToDom(gm.blockly.workspace,!0),settingsObj=blockly__WEBPACK_IMPORTED_MODULE_0___default().utils.xml.createElement("gmsettings");settingsObj.setAttribute("mode_name",gm.blockly.modeName||"Custom"),settingsObj.setAttribute("mode_description",gm.blockly.modeDescription||"Change your mode's description on the Game Mode Editor's Settings menu (gear icon)."),settingsObj.setAttribute("show_var_insp",gm.blockly.showVarInspector),settingsObj.setAttribute("base_mode",gm.blockly.baseMode||"any"),xml.appendChild(settingsObj),attachMap&&xml.appendChild(blockly__WEBPACK_IMPORTED_MODULE_0___default().Xml.textToDom("<bonkmap>"+MapEncoder.encodeToDatabase(gm.lobby.mpSession.getGameSettings().map)+"</bonkmap>"));const blob=new Blob(["!!!COMPRESSED!!!"+gm.blockly.compressXml(xml.innerHTML)],{type:"text/plain;charset=utf-8"});(0,file_saver__WEBPACK_IMPORTED_MODULE_5__.saveAs)(blob,`${filename}.xml`),document.getElementById("gm_exportwindowcontainer").style.visibility="hidden"},GMEBackupsShow:function(){document.getElementById("gm_backupswindowcontainer").style.visibility="visible";const backupSelect=document.getElementById("gmbackups_backupselect");backupSelect.innerHTML="",backupSelect.value="";for(let i=0;i<gm.blockly.modeBackups.length;i++){const option=document.createElement("option");option.value=i,option.innerText=new Date(gm.blockly.modeBackups[i].timeStamp).toLocaleString(),backupSelect.appendChild(option)}},GMEBackupsCancel:function(){document.getElementById("gm_backupswindowcontainer").style.visibility="hidden"},GMEBackupsLoad:function(){document.getElementById("gm_backupswindowcontainer").style.visibility="hidden";const backup=gm.blockly.modeBackups[document.getElementById("gmbackups_backupselect").value].xml;if(!backup)return;const xml=document.createElement("xml");xml.innerHTML=backup;const gmSettings=xml?.getElementsByTagName("gmsettings")[0];gm.blockly.modeName=gmSettings?.getAttribute("mode_name")||"Custom",gm.blockly.modeDescription=gmSettings?.getAttribute("mode_description")||"Change your mode's description on the Game Mode Editor's Settings menu (gear icon).",gm.blockly.showVarInspector="true"===gmSettings?.getAttribute("show_var_insp")||!1,gm.blockly.baseMode=gmSettings?.getAttribute("base_mode")||"any",gm.blockly.workspace.clear(),blockly__WEBPACK_IMPORTED_MODULE_0___default().Xml.domToWorkspace(xml,gm.blockly.workspace)},GMESettingsShow:function(){document.getElementById("gm_settingswindowcontainer").style.visibility="visible",document.getElementById("gmsettings_modename").value=gm.blockly.modeName,document.getElementById("gmsettings_modedescription").value=gm.blockly.modeDescription,document.getElementById("gmsettings_showvarinsp").checked=gm.blockly.showVarInspector,document.getElementById("gmsettings_basemode").value=gm.blockly.baseMode},GMESettingsCancel:function(){document.getElementById("gm_settingswindowcontainer").style.visibility="hidden"},GMESettingsSave:function(){gm.blockly.modeName=document.getElementById("gmsettings_modename").value.substring(0,12),gm.blockly.modeDescription=document.getElementById("gmsettings_modedescription").value.substring(0,500),gm.blockly.showVarInspector=document.getElementById("gmsettings_showvarinsp").checked,gm.blockly.baseMode=document.getElementById("gmsettings_basemode").value,document.getElementById("gm_settingswindowcontainer").style.visibility="hidden"},GMESave:function(){if(gm.lobby.networkEngine.getLSID()!==gm.lobby.networkEngine.hostID)return;gm.blockly.resetAll();try{eval(gm.blockly.generateCode())}catch(e){throw alert("An error ocurred while trying to save. Please send SneezingCactus a full screenshot of the console (Ctrl+Shift+I, go to the Console tab) so this error can be diagnosed."),e}const xml=blockly__WEBPACK_IMPORTED_MODULE_0___default().Xml.workspaceToDom(gm.blockly.workspace,!0),settingsObj=blockly__WEBPACK_IMPORTED_MODULE_0___default().utils.xml.createElement("gmsettings");settingsObj.setAttribute("mode_name",gm.blockly.modeName),settingsObj.setAttribute("mode_description",gm.blockly.modeDescription),settingsObj.setAttribute("show_var_insp",gm.blockly.showVarInspector),settingsObj.setAttribute("base_mode",gm.blockly.baseMode),xml.appendChild(settingsObj),gm.blockly.savedXml=xml,gm.blockly.savedSettings=xml?.getElementsByTagName("gmsettings")[0];const compressedXml=gm.blockly.compressXml(xml.innerHTML);gm.lobby.socket.emit(23,{m:`!!!GMMODE!!!${compressedXml}`}),gm.lobby.mpSession.getGameSettings().GMMode=compressedXml,gm.blockly.baseMode&&"any"!==gm.blockly.baseMode&&(gm.lobby.networkEngine.sendGAMO("b",gm.blockly.baseMode),gm.lobby.mpSession.getGameSettings().ga="b",gm.lobby.mpSession.getGameSettings().mo=gm.blockly.baseMode),gm.lobby.bonkLobby.updateGameSettings(),gm.blockly.hideGMEWindow()},showGMEWindow:function(){document.getElementById("gmeditor").style.transform="scale(1)";const blocklyDiv=document.getElementById("gmblocklydiv"),bounds=document.getElementById("gmblocklyarea").getBoundingClientRect();blocklyDiv.style.transform="scale(1)",blocklyDiv.style.top=bounds.top,blocklyDiv.style.left=bounds.left,blocklyDiv.style.width=bounds.width,blocklyDiv.style.height=bounds.height,gm.blockly.workspace.setVisible(!0),blockly__WEBPACK_IMPORTED_MODULE_0___default().svgResize(gm.blockly.workspace);const gmSettings=gm.blockly.savedXml?.getElementsByTagName("gmsettings")[0];gm.blockly.modeName=gmSettings?.getAttribute("mode_name")||"Custom",gm.blockly.modeDescription=gmSettings?.getAttribute("mode_description")||"Change your mode's description on the Game Mode Editor's Settings menu (gear icon).",gm.blockly.showVarInspector="true"===gmSettings?.getAttribute("show_var_insp")||!1,gm.blockly.baseMode=gmSettings?.getAttribute("base_mode")||"any"},hideGMEWindow:function(){gm.blockly.workspace.setVisible(!1),document.getElementById("gmblocklydiv").style.transform="scale(0)",document.getElementById("gmeditor").style.transform="scale(0)"},generateCode:function(){const workspace=gm.lobby.networkEngine.getLSID()===gm.lobby.networkEngine.hostID?gm.blockly.workspace:gm.blockly.headlessWorkspace,topBlocks=workspace.getTopBlocks();let code="";blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.init(workspace);for(let i=0;i!=topBlocks.length;i++)(topBlocks[i].type.startsWith("on_")||topBlocks[i].type.startsWith("procedures_def"))&&(code+=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.blockToCode(topBlocks[i])+"\n");return code=blockly__WEBPACK_IMPORTED_MODULE_0___default().JavaScript.finish(code),code.startsWith("var ")&&(code=code.replace(/var (.+);/,"")),code},vars:[],funcs:{createCircle:function(discID,xpos,ypos,radius,color,alpha,anchored,onlyPlayer,noCameraMove){if(onlyPlayer&&gm.lobby.networkEngine.getLSID()!==discID)return;let graphics;graphics=anchored?gm.graphics.additionalDiscGraphics[discID]:noCameraMove?gm.graphics.additionalScreenGraphics[discID]:gm.graphics.additionalWorldGraphics[discID],graphics&&!graphics._destroyed&&(xpos=gm.blockly.funcs.getScreenPos(xpos),ypos=gm.blockly.funcs.getScreenPos(ypos),radius=gm.blockly.funcs.getScreenPos(radius),xpos>99999||ypos>99999||radius>99999||("string"==typeof color&&(color="0x"+color.slice(1)),graphics.lineStyle(0,0,0),graphics.beginFill(color,alpha/100),graphics.drawCircle(xpos,ypos,radius),graphics.endFill()))},createRect:function(discID,xpos,ypos,width,height,angle,color,alpha,anchored,onlyPlayer,noCameraMove){if(onlyPlayer&&gm.lobby.networkEngine.getLSID()!==discID)return;let graphics;if(graphics=anchored?gm.graphics.additionalDiscGraphics[discID]:noCameraMove?gm.graphics.additionalScreenGraphics[discID]:gm.graphics.additionalWorldGraphics[discID],!graphics||graphics._destroyed)return;if(xpos=gm.blockly.funcs.getScreenPos(xpos),ypos=gm.blockly.funcs.getScreenPos(ypos),width=gm.blockly.funcs.getScreenPos(width)/2,height=gm.blockly.funcs.getScreenPos(height)/2,xpos>99999||ypos>99999||width>99999||height>99999)return;"string"==typeof color&&(color="0x"+color.slice(1)),graphics.lineStyle(0,0,0),graphics.beginFill(color,alpha/100);const pointArray=[];pointArray.push(new PIXI.Point(width,-height)),pointArray.push(new PIXI.Point(width,height)),pointArray.push(new PIXI.Point(-width,height)),pointArray.push(new PIXI.Point(-width,-height));for(let i=0;i<pointArray.length;i++){const oldVec=[pointArray[i].x,pointArray[i].y];pointArray[i].x=oldVec[0]*SafeTrig.safeCos(angle*(Math.PI/180))-oldVec[1]*SafeTrig.safeSin(angle*(Math.PI/180)),pointArray[i].y=oldVec[0]*SafeTrig.safeSin(angle*(Math.PI/180))+oldVec[1]*SafeTrig.safeCos(angle*(Math.PI/180)),pointArray[i].x+=xpos,pointArray[i].y+=ypos}graphics.drawPolygon(pointArray),graphics.endFill()},createLine:function(discID,xpos1,ypos1,xpos2,ypos2,color,alpha,width,anchored,onlyPlayer,noCameraMove){if(onlyPlayer&&gm.lobby.networkEngine.getLSID()!==discID)return;let graphics;graphics=anchored?gm.graphics.additionalDiscGraphics[discID]:noCameraMove?gm.graphics.additionalScreenGraphics[discID]:gm.graphics.additionalWorldGraphics[discID],graphics&&!graphics._destroyed&&(xpos1=gm.blockly.funcs.getScreenPos(xpos1),ypos1=gm.blockly.funcs.getScreenPos(ypos1),xpos2=gm.blockly.funcs.getScreenPos(xpos2),ypos2=gm.blockly.funcs.getScreenPos(ypos2),width=gm.blockly.funcs.getScreenPos(width),xpos1>99999||ypos1>99999||xpos2>99999||ypos2>99999||width>99999||("string"==typeof color&&(color="0x"+color.slice(1)),graphics.lineStyle(width,color,alpha/100),graphics.moveTo(xpos1,ypos1),graphics.lineTo(xpos2,ypos2)))},createPoly:function(discID,vertexes,color,alpha=100,anchored,onlyPlayer,noCameraMove){if(onlyPlayer&&gm.lobby.networkEngine.getLSID()!==discID)return;let graphics;if(graphics=anchored?gm.graphics.additionalDiscGraphics[discID]:noCameraMove?gm.graphics.additionalScreenGraphics[discID]:gm.graphics.additionalWorldGraphics[discID],graphics&&!graphics._destroyed){"string"==typeof color&&(color="0x"+color.slice(1));for(let i=0;i<vertexes.length;i++)if(vertexes[i]=gm.blockly.funcs.getScreenPos("number"==typeof vertexes[i]?vertexes[i]:0),vertexes[i]>99999)return;graphics.lineStyle(0,0,0),graphics.beginFill(color,alpha/100),graphics.drawPolygon(vertexes),graphics.endFill()}},createText:function(discID,xpos,ypos,color,alpha,str,size,centered,anchored,onlyPlayer,noCameraMove){if(onlyPlayer&&gm.lobby.networkEngine.getLSID()!==discID)return;let graphics;if(graphics=anchored?gm.graphics.additionalDiscGraphics[discID]:noCameraMove?gm.graphics.additionalScreenGraphics[discID]:gm.graphics.additionalWorldGraphics[discID],graphics&&!graphics._destroyed&&!(xpos>99999||ypos>99999||size>99999))if("string"==typeof color&&(color="0x"+color.slice(1)),gm.graphics.availableText.length>0){const reusedText=gm.graphics.availableText.pop();gm.graphics.usedText.push(reusedText),graphics.addChild(reusedText),reusedText.resolution=2,reusedText.x=gm.blockly.funcs.getScreenPos(xpos),reusedText.y=gm.blockly.funcs.getScreenPos(ypos),reusedText.text=str,reusedText.style.fill=color,reusedText.alpha=alpha/100,reusedText.style.fontSize=gm.blockly.funcs.getScreenPos(size),reusedText.usedBy=discID,centered?reusedText.anchor.set(.5,0):reusedText.anchor.set(0,0)}else{const text=new PIXI.Text(str,{fontFamily:"futurept_medium",fontSize:gm.blockly.funcs.getScreenPos(size),fill:color,align:"center",dropShadow:!0,dropShadowDistance:3,dropShadowAlpha:.3});graphics.addChild(text),text.resolution=2,text.x=gm.blockly.funcs.getScreenPos(xpos),text.y=gm.blockly.funcs.getScreenPos(ypos),text.alpha=alpha/100,text.usedBy=discID,centered&&text.anchor.set(.5,0),gm.graphics.usedText.push(text)}},clearGraphics:function(discID){if(void 0!==discID){const discGraphics=gm.graphics.additionalDiscGraphics[discID],worldGraphics=gm.graphics.additionalWorldGraphics[discID],screenGraphics=gm.graphics.additionalScreenGraphics[discID];discGraphics&&!discGraphics._destroyed&&discGraphics.clear(),worldGraphics&&!worldGraphics._destroyed&&worldGraphics.clear(),screenGraphics&&!screenGraphics._destroyed&&screenGraphics.clear(),discGraphics&&discGraphics.removeChildren(),worldGraphics&&worldGraphics.removeChildren(),screenGraphics&&screenGraphics.removeChildren();for(let i=0;i<gm.graphics.usedText.length;i++)gm.graphics.usedText[i]?.usedBy===discID&&(gm.graphics.availableText.push(gm.graphics.usedText.splice(i,1)[0]),i--)}else for(let i=0;i!==gm.graphics.additionalDiscGraphics.length;i++){const discGraphics=gm.graphics.additionalDiscGraphics[i],worldGraphics=gm.graphics.additionalWorldGraphics[i],screenGraphics=gm.graphics.additionalScreenGraphics[i];for(discGraphics&&!discGraphics._destroyed&&discGraphics.clear(),worldGraphics&&!worldGraphics._destroyed&&worldGraphics.clear(),screenGraphics&&!screenGraphics._destroyed&&screenGraphics.clear(),discGraphics&&discGraphics.removeChildren(),worldGraphics&&worldGraphics.removeChildren(),screenGraphics&&screenGraphics.removeChildren();gm.graphics.usedText.length>0;)gm.graphics.availableText.push(gm.graphics.usedText.pop())}},getScreenPos:function(value){return value*gm.physics.gameState.physics.ppm},setPlayerProperty:function(gameState,discID,property,value){gm.graphics.rendering||null!=value&&Number.isFinite(value)&&!Number.isNaN(value)&&gameState.discs[discID]&&(gameState.discs[discID][property]=value)},changePlayerProperty:function(gameState,discID,property,value){gm.graphics.rendering||null!=value&&Number.isFinite(value)&&!Number.isNaN(value)&&gameState.discs[discID]&&(gameState.discs[discID][property]+=value)},getPlayerProperty:function(gameState,discID,property){return gameState.discs[discID]&&(gameState.discs[discID][property]||0===gameState.discs[discID][property])?gameState.discs[discID][property]:1/0},setArrowProperty:function(gameState,discID,arrowID,property,value){if(gm.graphics.rendering)return;if(null==value||!Number.isFinite(value)||Number.isNaN(value))return;const projs=gameState.projectiles;let accum=1;for(let i=0;i!==projs.length;i++)if(projs[i]&&projs[i].did===discID){if(accum===arrowID){gameState.projectiles[i][property]=value;break}accum++}},setAllArrowsProperty:function(gameState,discID,property,value){if(gm.graphics.rendering)return;if(null==value||!Number.isFinite(value)||Number.isNaN(value))return;const projs=gameState.projectiles;for(let i=0;i!==projs.length;i++)projs[i]&&projs[i].did===discID&&(gameState.projectiles[i][property]=value)},changeArrowProperty:function(gameState,discID,arrowID,property,value){if(gm.graphics.rendering)return;if(null==value||!Number.isFinite(value)||Number.isNaN(value))return;const projs=gameState.projectiles;let accum=1;for(let i=0;i!==projs.length;i++)if(projs[i]&&projs[i].did===discID){if(accum===arrowID){gameState.projectiles[i][property]+=value;break}accum++}},changeAllArrowsProperty:function(gameState,discID,property,value){if(gm.graphics.rendering)return;if(null==value||!Number.isFinite(value)||Number.isNaN(value))return;const projs=gameState.projectiles;for(let i=0;i!==projs.length;i++)projs[i]&&projs[i].did===discID&&(gameState.projectiles[i][property]+=value)},getArrowProperty:function(gameState,discID,arrowID,property){const projs=gameState.projectiles;let accum=1;for(let i=0;i!==projs.length;i++)if(projs[i]&&projs[i].did===discID){if(accum===arrowID)return gameState.projectiles[i][property];accum++}return 1/0},getArrowAmount:function(gameState,discID){const projs=gameState.projectiles;let accum=0;for(let i=0;i!==projs.length;i++)projs[i]&&projs[i].did===discID&&accum++;return accum},deletePlayerArrow:function(gameState,discID,arrowID){if(gm.graphics.rendering)return;const projs=gameState.projectiles;let accum=1;for(let i=0;i!==projs.length;i++)if(projs[i]&&projs[i].did===discID){if(accum===arrowID){gameState.projectiles[i]=null;break}accum++}},deleteAllPlayerArrows:function(gameState,discID){if(gm.graphics.rendering)return;const projs=gameState.projectiles;for(let i=0;i!==projs.length;i++)projs[i]&&projs[i].did===discID&&(gameState.projectiles[i]=null)},getAllPlayerIds:function(gameState){const array=[];for(let i=0;i!==gameState.discs.length;i++)gameState.discs[i]&&array.push(i);return array},getPlayerSize:function(discID){const bal=gm.lobby.mpSession.getGameSettings().bal[discID];return bal?1+Math.max(Math.min(bal/100,1),-.94):1},getPlayerColor:function(gameState,discID){if(!gameState.discs[discID])return"#000000";switch(gameState.discs[discID].team){case 1:if(gm.graphics.rendererClass.playerArray[discID])return"#"+gm.graphics.rendererClass.playerArray[discID].avatar.bc.toString(16);break;case 2:return"#f44336";case 3:return"#2196f3";case 4:return"#4caf50";case 5:return"#ffeb3b"}return"#000000"},setCameraProperty:function(gameState,discID,property,value){if(gm.graphics.rendering)return;if(null==value||!Number.isFinite(value)||Number.isNaN(value))return;const cameras=gameState.physics.bodies[0].cf.cameras;if("angle"===property&&(value*=Math.PI/180),"xskew"!==property&&"yskew"!==property||(value*=Math.PI/-180),null!==discID&&cameras[discID])cameras[discID][property]=value;else for(let i=0;i<cameras.length;i++)cameras[i]&&(cameras[i][property]=value);gameState.physics.bodies[0].cf.cameras=cameras,gameState.physics.bodies[0].cf.cameraChanged=!0},changeCameraProperty:function(gameState,discID,property,value){if(gm.graphics.rendering)return;if(null==value||!Number.isFinite(value)||Number.isNaN(value))return;const cameras=gameState.physics.bodies[0].cf.cameras;if("angle"===property&&(value*=Math.PI/180),"xskew"!==property&&"yskew"!==property||(value*=Math.PI/-180),null!==discID&&cameras[discID])cameras[discID][property]+=value;else for(let i=0;i<cameras.length;i++)cameras[i]&&(cameras[i][property]+=value);gameState.physics.bodies[0].cf.cameras=cameras,gameState.physics.bodies[0].cf.cameraChanged=!0},getCameraProperty:function(gameState,discID,property){return gameState.physics.bodies[0].cf.cameras[discID]?"angle"===property?gameState.physics.bodies[0].cf.cameras[discID][property]*(Math.PI/180):"xskew"===property||"yskew"===property?gameState.physics.bodies[0].cf.cameras[discID][property]*(Math.PI/-180):gameState.physics.bodies[0].cf.cameras[discID][property]:1/0},enableCameraLerp:function(gameState,enable,discID){gm.graphics.rendering||gameState.physics.bodies[0].cf.cameras[discID]&&(gameState.physics.bodies[0].cf.cameras[discID].doLerp=enable)},enableDeathBarrier:function(gameState,enable){gm.graphics.rendering||(gameState.physics.bodies[0].cf.disableDeathBarrier=!enable)},rayCast:function(gameState,discID,x1,y1,x2,y2,colA,colB,colC,colD,colP,pointXVar,pointYVar,normalXVar,normalYVar,objectTypeVar,objectIdVar){let maskBits=65535;colP||(maskBits-=1),colA||(maskBits-=4),colB||(maskBits-=8),colC||(maskBits-=16),colD||(maskBits-=32);const vectorA=new Box2D.Common.Math.b2Vec2(x1,y1),vectorB=new Box2D.Common.Math.b2Vec2(x2,y2);let objectFound=!1,theChosenOne={point:vectorB};const mdf=Math.abs(vectorB.x-vectorA.x)>Math.abs(vectorB.y-vectorA.y)?"x":"y";if(window.PhysicsClass.world.RayCast(((fixture,point,normal)=>{const category=fixture.GetFilterData().categoryBits;return(maskBits&category)!=category?-1:(Math.abs(point[mdf]-vectorA[mdf])<Math.abs(theChosenOne.point[mdf]-vectorA[mdf])&&(objectFound=!0,theChosenOne={fixture,point,normal}),1)}),vectorA,vectorB),objectFound){gm.blockly.funcs.setVar(pointXVar,gameState,discID,theChosenOne.point.x),gm.blockly.funcs.setVar(pointYVar,gameState,discID,theChosenOne.point.y),gm.blockly.funcs.setVar(normalXVar,gameState,discID,theChosenOne.normal.x),gm.blockly.funcs.setVar(normalYVar,gameState,discID,theChosenOne.normal.y);const fixtureData=theChosenOne.fixture.GetBody().GetUserData();gm.blockly.funcs.setVar(objectTypeVar,gameState,discID,"phys"==fixtureData.type?"platform":"player"),gm.blockly.funcs.setVar(objectIdVar,gameState,discID,fixtureData.discID??fixtureData.arrayID)}return objectFound},createArrow:function(gameState,discID,xpos,ypos,xvel,yvel,angle,time){xpos>99999||ypos>99999||xvel>99999||yvel>99999||angle>99999||gameState.discs[discID]&&gameState.projectiles.push({a:angle,av:0,did:discID,fte:time,team:gameState.discs[discID].team,type:"arrow",x:xpos,xv:xvel,y:ypos,yv:yvel})},overrideInput:function(gameState,discID,input,value){gm.graphics.rendering||(gameState.physics.bodies[0].cf.overrides&&!gameState.physics.bodies[0].cf.overrides[discID]?gameState.physics.bodies[0].cf.overrides[discID]={}:gameState.physics.bodies[0].cf.overrides||(gameState.physics.bodies[0].cf.overrides=[],gameState.physics.bodies[0].cf.overrides[discID]={}),gameState.physics.bodies[0].cf.overrides[discID][input]=value)},killPlayer:function(gameState,discID,allowRespawn){gm.graphics.rendering||(gameState.physics.bodies[0].cf.kills&&!gameState.physics.bodies[0].cf.kills.includes(discID)?gameState.physics.bodies[0].cf.kills.push({id:discID,allowRespawn}):gameState.physics.bodies[0].cf.kills||(gameState.physics.bodies[0].cf.kills=[],gameState.physics.bodies[0].cf.kills.push({id:discID,allowRespawn})))},createRectShape:function(color,xpos,ypos,width,height,angle,noPhys,noGrap,inGrap,death){if(color=parseInt(color.slice(1),16),Number.isFinite(xpos)&&!Number.isNaN(xpos)&&null!=xpos&&Number.isFinite(ypos)&&!Number.isNaN(ypos)&&null!=ypos&&Number.isFinite(width)&&!Number.isNaN(width)&&null!=width&&Number.isFinite(height)&&!Number.isNaN(height)&&null!=height&&Number.isFinite(angle)&&!Number.isNaN(angle)&&null!=angle)return{shape:{type:"bx",w:width,h:height,c:[xpos,ypos],a:angle,sk:!1},fixture:{sh:-1,n:"gmmaker",fr:null,fp:null,re:null,de:null,f:color,d:death,np:noPhys,ng:noGrap,ig:inGrap}}},createCircleShape:function(color,xpos,ypos,radius,noPhys,noGrap,inGrap,death){if(color=parseInt(color.slice(1),16),Number.isFinite(xpos)&&!Number.isNaN(xpos)&&null!=xpos&&Number.isFinite(ypos)&&!Number.isNaN(ypos)&&null!=ypos&&Number.isFinite(radius)&&!Number.isNaN(radius)&&null!=radius)return{shape:{type:"ci",r:radius,c:[xpos,ypos],sk:!1},fixture:{sh:-1,n:"gmmaker",fr:null,fp:null,re:null,de:null,f:color,d:death,np:noPhys,ng:noGrap,ig:inGrap}}},createPolyShape:function(color,xpos,ypos,vertexList,angle,scale,noPhys,noGrap,inGrap,death){if(color=parseInt(color.slice(1),16),!Number.isFinite(xpos)||Number.isNaN(xpos)||null==xpos)return;if(!Number.isFinite(ypos)||Number.isNaN(ypos)||null==ypos)return;if(!Number.isFinite(angle)||Number.isNaN(angle)||null==angle)return;if(!Number.isFinite(scale)||Number.isNaN(scale)||null==scale)return;const actualVertexList=[];for(let i=0;i<vertexList.length;i+=2){let vertXPos=vertexList[i],vertYPos=vertexList[i+1];if(!Number.isFinite(vertXPos)||Number.isNaN(vertXPos)||null==vertXPos)return;if(!Number.isFinite(vertYPos)||Number.isNaN(vertYPos)||null==vertYPos)return;vertXPos=vertexList[i]*Math.cos(angle)-vertexList[i+1]*Math.sin(angle),vertYPos=vertexList[i]*Math.sin(angle)+vertexList[i+1]*Math.cos(angle),vertXPos=vertXPos*scale+xpos,vertYPos=vertYPos*scale+ypos,actualVertexList.push([vertXPos,vertYPos])}return{shape:{type:"po",v:actualVertexList,s:scale,a:angle,c:[0,0]},fixture:{sh:-1,n:"gmmaker",fr:null,fp:null,re:null,de:null,f:color,d:death,np:noPhys,ng:noGrap,ig:inGrap}}},createPlatform:function(gameState,type,xpos,ypos,angle,shapes=[],bounce,density,friction,fricPlayers,colGroup,colP,colA,colB,colC,colD){if(gm.graphics.rendering)return-1;const body={type,p:[xpos,ypos],a:angle,av:0,lv:[0,0],ld:0,ad:0,fr:!1,bu:!1,fx:[],fric:friction,fricp:fricPlayers,de:density,re:bounce,f_c:colGroup,f_p:colP,f_1:colA,f_2:colB,f_3:colC,f_4:colD,cf:{x:0,y:0,w:!0,ct:0}};for(let i=0;i!==shapes.length;i++){if(null===shapes[i]||void 0===shapes[i])continue;const shIndex=gameState.physics.shapes.length;gameState.physics.shapes.push(shapes[i].shape);const fxIndex=gameState.physics.fixtures.length;gameState.physics.fixtures.push(shapes[i].fixture),gameState.physics.fixtures[fxIndex].sh=shIndex,body.fx.push(fxIndex)}return 0==body.fx.length?1/0:(gameState.physics.bodies.push(body),gameState.physics.bro.unshift(gameState.physics.bodies.length-1),gm.graphics.renderUpdates[gameState.rl]||(gm.graphics.renderUpdates[gameState.rl]=[]),gm.graphics.renderUpdates[gameState.rl].push({action:"create",id:gameState.physics.bodies.length-1}),gameState.physics.bodies.length-1)},clonePlatform:function(gameState,platID){if(gameState.physics.bodies[platID]&&!gameState.physics.bodies[platID].cf.deleted){const newBody=JSON.parse(JSON.stringify(gameState.physics.bodies[platID])),newFixtureIds=[];for(let i=0;i<newBody.fx.length;i++){newFixtureIds.push(gameState.physics.fixtures.length);const newFixture=JSON.parse(JSON.stringify(gameState.physics.fixtures[newBody.fx[i]])),newShape=JSON.parse(JSON.stringify(gameState.physics.shapes[newFixture.sh]));newFixture.sh=gameState.physics.shapes.length,gameState.physics.shapes.push(newShape),gameState.physics.fixtures.push(newFixture)}return newBody.fx=newFixtureIds,gameState.physics.bro.unshift(gameState.physics.bodies.length),gameState.physics.bodies.push(newBody),gm.graphics.renderUpdates[gameState.rl]||(gm.graphics.renderUpdates[gameState.rl]=[]),gm.graphics.renderUpdates[gameState.rl].push({action:"create",id:gameState.physics.bodies.length-1}),gameState.physics.bodies.length-1}return 1/0},getPlatformByName:function(name){const map=gm.lobby.mpSession.getGameSettings().map;for(let i=0;i<map.physics.bodies.length;i++)if(map.physics.bodies[i]?.n==name)return i;return 1/0},getPlatformName:function(platID){const map=gm.lobby.mpSession.getGameSettings().map;return map.physics.bodies[platID]?map.physics.bodies[platID].n:""},setPlatformProperty:function(gameState,platID,property,value){if(gm.graphics.rendering)return;if(null==value||!Number.isFinite(value)&&"number"==typeof value||Number.isNaN(value))return;const body=gameState.physics.bodies[platID],boolProps=["fricp","f_p","f_a","f_b","f_c","f_d"];if(body&&!body.cf.deleted){switch(property){case"p_x":body.p[0]=Number.isNaN(parseFloat(value))?body.p[0]:parseFloat(value);break;case"p_y":body.p[1]=Number.isNaN(parseFloat(value))?body.p[1]:parseFloat(value);break;case"lv_x":body.lv[0]=Number.isNaN(parseFloat(value))?body.lv[0]:parseFloat(value);break;case"lv_y":body.lv[1]=Number.isNaN(parseFloat(value))?body.lv[1]:parseFloat(value)}boolProps.includes(property)?body[property]=!0===value:void 0!==body[property]&&(body[property]=Number.isNaN(parseFloat(value))?body[property]:parseFloat(value)),gameState.physics.bodies[platID]=body}},changePlatformProperty:function(gameState,platID,property,value){if(gm.graphics.rendering)return;if(null==value||!Number.isFinite(value)&&"number"==typeof value||Number.isNaN(value))return;const body=gameState.physics.bodies[platID];if(body&&!body.cf.deleted){switch(property){case"p_x":body.p[0]+=Number.isNaN(parseFloat(value))?0:parseFloat(value);break;case"p_y":body.p[1]+=Number.isNaN(parseFloat(value))?0:parseFloat(value);break;case"lv_x":body.lv[0]+=Number.isNaN(parseFloat(value))?0:parseFloat(value);break;case"lv_y":body.lv[1]+=Number.isNaN(parseFloat(value))?0:parseFloat(value)}void 0!==body[property]&&(body[property]+=Number.isNaN(parseFloat(value))?0:parseFloat(value)),gameState.physics.bodies[platID]=body}},getPlatformProperty:function(gameState,platID,property){const body=gameState.physics.bodies[platID];if(body&&!body.cf.deleted){switch(property){case"p_x":return body.p[0];case"p_y":return body.p[1];case"lv_x":return body.lv[0];case"lv_y":return body.lv[1]}if(void 0!==body[property])return body[property]}return 1/0},setShapeProperty:function(gameState,platID,shapeID,property,value){if(gm.graphics.rendering)return;if(null==value||!Number.isFinite(value)&&"number"==typeof value||Number.isNaN(value))return;const fixture=gameState.physics.fixtures[gameState.physics.bodies[platID]?.fx[shapeID-1]],shape=gameState.physics.shapes[fixture?.sh],boolProps=["f_np","f_ng","f_ig","f_d"],breakOnZero=["s_w","s_h"];if(fixture&&property.startsWith("f_"))"f_f"===property?fixture.f=("string"!=typeof value?parseInt(value):parseInt(value.slice(1),16))||0:boolProps.includes(property)?fixture[property.slice(2)]=!0===value:void 0!==fixture[property.slice(2)]&&(fixture[property.slice(2)]=parseFloat(value)||0),gameState.physics.fixtures[gameState.physics.bodies[platID].fx[shapeID-1]]=fixture,gm.graphics.renderUpdates[gameState.rl]||(gm.graphics.renderUpdates[gameState.rl]=[]),gm.graphics.renderUpdates[gameState.rl].push({action:"update",id:platID});else if(shape&&property.startsWith("s_")){switch(property){case"s_c_x":shape.c[0]=parseFloat(value)||0;break;case"s_c_y":shape.c[1]=parseFloat(value)||0}void 0!==shape[property.slice(2)]&&(shape[property.slice(2)]=parseFloat(value)||0),breakOnZero.includes(property)&&shape[property.slice(2)]>=0&&shape[property.slice(2)]<.001&&(shape[property.slice(2)]=.001),gameState.physics.shapes[fixture.sh]=shape,gm.graphics.renderUpdates[gameState.rl]||(gm.graphics.renderUpdates[gameState.rl]=[]),gm.graphics.renderUpdates[gameState.rl].push({action:"update",id:platID})}boolProps.includes(property)&&"f_np"!==property&&(gm.graphics.needRerender=!1)},changeShapeProperty:function(gameState,platID,shapeID,property,value){if(gm.graphics.rendering)return;if(null==value||!Number.isFinite(value)&&"number"==typeof value||Number.isNaN(value))return;const fixture=gameState.physics.fixtures[gameState.physics.bodies[platID]?.fx[shapeID-1]],shape=gameState.physics.shapes[fixture?.sh],breakOnZero=["s_w","s_h"];if(fixture&&property.startsWith("f_"))void 0!==fixture[property.slice(2)]&&(fixture[property.slice(2)]+=parseFloat(value)||0),gameState.physics.fixtures[gameState.physics.bodies[platID].fx[shapeID-1]]=fixture,gm.graphics.renderUpdates[gameState.rl].push({action:"update",id:platID});else if(shape&&property.startsWith("s_")){switch(property){case"s_c_x":shape.c[0]+=parseFloat(value)||0;break;case"s_c_y":shape.c[1]+=parseFloat(value)||0}void 0!==shape[property.slice(2)]&&(shape[property.slice(2)]+=parseFloat(value)||0),breakOnZero.includes(property)&&shape[property.slice(2)]>=0&&shape[property.slice(2)]<.001&&(shape[property.slice(2)]=.001),gameState.physics.shapes[fixture.sh]=shape,gm.graphics.renderUpdates[gameState.rl]||(gm.graphics.renderUpdates[gameState.rl]=[]),gm.graphics.renderUpdates[gameState.rl].push({action:"update",id:platID})}},getShapeProperty:function(gameState,platID,shapeID,property){const fixture=gameState.physics.fixtures[gameState.physics.bodies[platID]?.fx[shapeID-1]],shape=gameState.physics.shapes[fixture?.sh];if(fixture&&property.startsWith("f_")){if("f_f"===property)return gm.blockly.funcs.parseColour(fixture.f.toString(16));if(void 0!==fixture[property.slice(2)])return fixture[property.slice(2)];gameState.physics.fixtures[gameState.physics.bodies[platID].fx[shapeID-1]]=fixture}else if(shape&&property.startsWith("s_")){switch(property){case"s_c_x":return shape.c[0];case"s_c_y":return shape.c[1]}if(void 0!==shape[property.slice(2)])return shape[property.slice(2)]}return 1/0},getShapeAmount:function(gameState,platID){return gameState.physics.bodies[platID]?.fx.length??1/0},deletePlatform:function(gameState,platID){gm.graphics.rendering||gameState.physics.bodies[platID]&&0!==gameState.physics.bodies[platID].fx&&!gameState.physics.bodies[platID].cf.gmDeleted&&(gameState.physics.bodies[platID].fx=[],gameState.physics.bodies[platID].type="s",gameState.physics.bodies[platID].cf.deleted=!0,gm.graphics.renderUpdates[gameState.rl]||(gm.graphics.renderUpdates[gameState.rl]=[]),gm.graphics.renderUpdates[gameState.rl].push({action:"delete",id:platID}))},deleteShape:function(gameState,platID,shapeID){gm.graphics.rendering||gameState.physics.bodies[platID]&&void 0!==gameState.physics.bodies[platID].fx[shapeID-1]&&(gm.graphics.renderUpdates[gameState.rl]||(gm.graphics.renderUpdates[gameState.rl]=[]),gm.graphics.renderUpdates[gameState.rl].push({action:"update",id:platID}),gameState.physics.bodies[platID].fx.splice(shapeID-1,1))},addShape:function(gameState,platID,shape){if(gm.graphics.rendering)return;if(!gameState.physics.bodies[platID]||!shape||!shape.shape.type)return;const shIndex=gameState.physics.shapes.length;gameState.physics.shapes.push(shape.shape);const fxIndex=gameState.physics.fixtures.length;gameState.physics.fixtures.push(shape.fixture),gameState.physics.fixtures[fxIndex].sh=shIndex,gameState.physics.bodies[platID].fx.push(fxIndex),gm.graphics.renderUpdates[gameState.rl]||(gm.graphics.renderUpdates[gameState.rl]=[]),gm.graphics.renderUpdates[gameState.rl].push({action:"update",id:platID})},playSound:function(gameState,panType,soundName,volume,panning){if(panning=Number(panning),volume=Number(volume),Number.isFinite(volume)&&null!==volume&&!Number.isNaN(volume)&&Number.isFinite(panning)&&null!==panning&&!Number.isNaN(panning)){if("discDeath"==soundName&&(soundName+=Math.floor(2.999*gm.physics.pseudoRandom())),"world"===panType){const cameraObj=gameState.physics.bodies[0]?.cf.cameras[gm.lobby.networkEngine?.getLSID()],ppm=gameState.physics.ppm;if(!cameraObj)return;panning=panning/(365/ppm)-1,panning+=(-cameraObj.xpos+730/ppm)*cameraObj.xscal/(365/ppm)-1}panning=Math.max(Math.min(panning,1),-1),window.BonkUtils.soundManager.playSound(soundName,panning,volume)}},setVar:function(varName,gameState,discID,value){null!=value&&(varName.startsWith("GLOBAL_")?gameState.physics.bodies[0].cf.variables.global[varName]=value:gameState.physics.bodies[0].cf.variables[discID]&&(gameState.physics.bodies[0].cf.variables[discID][varName]=value))},changeVar:function(varName,gameState,discID,value){null!=value&&(varName.startsWith("GLOBAL_")?(gameState.physics.bodies[0].cf.variables.global[varName]||(gameState.physics.bodies[0].cf.variables.global[varName]=0),gameState.physics.bodies[0].cf.variables.global[varName]+=value):gameState.physics.bodies[0].cf.variables[discID]&&(gameState.physics.bodies[0].cf.variables[discID][varName]||(gameState.physics.bodies[0].cf.variables[discID][varName]=0),gameState.physics.bodies[0].cf.variables[discID][varName]+=value))},keepVar:function(varName,gameState){gameState.physics.bodies[0].cf.keepVariables.includes(varName)||gameState.physics.bodies[0].cf.keepVariables.push(varName)},getVar:function(varName,gameState,discID){return varName.startsWith("GLOBAL_")&&null!=gameState.physics.bodies[0].cf.variables.global?.[varName]?gameState.physics.bodies[0].cf.variables.global[varName]:varName.startsWith("GLOBAL_")||null==gameState.physics.bodies[0].cf.variables[discID]?.[varName]?1/0:gameState.physics.bodies[0].cf.variables[discID][varName]},getDistance:function(pointA_X,pointA_Y,pointB_X,pointB_Y){return Math.sqrt(Math.pow(pointB_X-pointA_X,2)+Math.pow(pointB_Y-pointA_Y,2))},parseColour:function(colourString){return NaN==parseInt(colourString,16)?"#000000":"#"+"0".repeat(6-colourString.length)+colourString},setInArray:function(array,index,value){return array[index]=value,array},insertInArray:function(array,index,value){return array.splice(index,0,value),array}},resetVars:function(){},resetMode:function(){gm.physics.onFirstStep=function(){},gm.physics.onStep=function(){},gm.physics.onPlayerPlayerCollision=function(){},gm.physics.onPlayerArrowCollision=function(){},gm.physics.onPlayerPlatformCollision=function(){},gm.physics.onArrowPlayerCollision=function(){},gm.physics.onArrowArrowCollision=function(){},gm.physics.onArrowPlatformCollision=function(){},gm.physics.onPlatformPlayerCollision=function(){},gm.physics.onPlatformArrowCollision=function(){},gm.physics.onPlatformPlatformCollision=function(){},gm.graphics.onRender=function(){}},resetAll:function(){gm.blockly.resetMode(),gm.blockly.funcs.clearGraphics()}}},6111:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var blockly__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(4948),blockly__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(blockly__WEBPACK_IMPORTED_MODULE_0__);const __WEBPACK_DEFAULT_EXPORT__={init:function(){this.initSocketio(),this.initBonkLobby(),this.initNetworkEngine(),this.initJoinHandlers(),MapEncoder.decodeFromDatabase_OLD=MapEncoder.decodeFromDatabase,MapEncoder.decodeFromDatabase=function(map){return map.startsWith("!!!GMMODE!!!")?gm.lobby.mpSession.getGameSettings().map:MapEncoder.decodeFromDatabase_OLD(...arguments)}},initSocketio:function(){io=function(){const socket=io_OLD(...arguments);return gm.lobby.socket=socket,socket.on("disconnect",(function(){gm.blockly.savedXml=null,gm.blockly.savedSettings=null,gm.blockly.resetAll(),gm.blockly.hideGMEWindow()})),socket.on(29,(function(data){if(data.startsWith("!!!GMMODE!!!")){const xml=document.createElement("xml");xml.innerHTML=gm.blockly.decompressXml(data.replace("!!!GMMODE!!!","")),gm.blockly.headlessWorkspace.clear(),blockly__WEBPACK_IMPORTED_MODULE_0___default().Xml.domToWorkspace(xml,gm.blockly.headlessWorkspace),gm.blockly.savedXml=xml,gm.blockly.savedSettings=xml?.getElementsByTagName("gmsettings")[0],gm.blockly.resetAll(),eval(gm.blockly.generateCode()),gm.lobby.mpSession.getGameSettings().GMMode=data.replace("!!!GMMODE!!!",""),gm.lobby.bonkLobby.showStatusMessage("* [GMMaker] Host has changed the mode","#cc3333")}})),socket}},initBonkLobby:function(){const smObj=this;NewBonkLobby=function(){const cached_bonklobby=NewBonkLobby;return function(){const result=cached_bonklobby.apply(this,arguments);return smObj.bonkLobby=this,this.handleHostLeft_OLD=this.handleHostLeft,this.handleHostLeft=function(_oldHostName,newHostId){return gm.lobby.networkEngine.getLSID()==newHostId?(document.getElementById("gmeditor_openbutton").classList.remove("brownButtonDisabled"),gm.blockly.workspace.clear(),blockly__WEBPACK_IMPORTED_MODULE_0___default().Xml.domToWorkspace(gm.blockly.savedXml,gm.blockly.workspace)):document.getElementById("gmeditor_openbutton").classList.add("brownButtonDisabled"),this.handleHostLeft_OLD(...arguments)},this.handleHostChange_OLD=this.handleHostChange,this.handleHostChange=function(_oldHostName,newHostId){return gm.lobby.networkEngine.getLSID()==newHostId?(document.getElementById("gmeditor_openbutton").classList.remove("brownButtonDisabled"),gm.blockly.workspace.clear(),blockly__WEBPACK_IMPORTED_MODULE_0___default().Xml.domToWorkspace(gm.blockly.savedXml,gm.blockly.workspace)):document.getElementById("gmeditor_openbutton").classList.add("brownButtonDisabled"),this.handleHostChange_OLD(...arguments)},this.setGameSettings_OLD=this.setGameSettings,this.setGameSettings=function(gameSettings){if(gm.lobby.networkEngine.getLSID()==gm.lobby.networkEngine.hostID?document.getElementById("gmeditor_openbutton").classList.remove("brownButtonDisabled"):document.getElementById("gmeditor_openbutton").classList.add("brownButtonDisabled"),gameSettings.GMMode&&""!==gameSettings.GMMode&&gm.lobby.networkEngine.getLSID()!=gm.lobby.networkEngine.hostID){const xml=document.createElement("xml");if(xml.innerHTML=gm.blockly.decompressXml(gameSettings.GMMode),gm.blockly.savedXml?.innerHTML!==xml.innerHTML){gm.blockly.headlessWorkspace.clear(),blockly__WEBPACK_IMPORTED_MODULE_0___default().Xml.domToWorkspace(xml,gm.blockly.headlessWorkspace),gm.blockly.savedXml=xml,gm.blockly.savedSettings=xml?.getElementsByTagName("gmsettings")[0],gm.blockly.resetAll();try{eval(gm.blockly.generateCode())}catch(e){console.log(e)}}}return this.setGameSettings_OLD(gameSettings)},this.updateGameSettings_OLD=this.updateGameSettings,this.updateGameSettings=function(){const result=this.updateGameSettings_OLD(...arguments),modeName=gm.blockly.savedSettings?.getAttribute("mode_name");if(modeName&&gm.blockly.savedXml?.getElementsByTagName("block").length>0){const modeText=document.getElementById("newbonklobby_modetext"),baseModeText=document.createElement("div");baseModeText.id="gm_basemodetext",baseModeText.innerText=`(${modeText.innerText})`,modeText.innerText=modeName,modeText.appendChild(baseModeText)}return result},this.show_OLD=this.show,this.show=function(){return gm.lobby.gameCrashed=!1,gm.lobby.haltCausedByLoop=!1,gm.blockly.varInspectorContainer.style.display="none",this.show_OLD()},result}}(),document.getElementById("newbonklobby_modetext").addEventListener("mousemove",(function(){const modeDesc=gm.blockly.savedXml?.getElementsByTagName("gmsettings")[0]?.getAttribute("mode_description");modeDesc&&gm.blockly.savedXml?.getElementsByTagName("block").length>0&&(document.getElementById("newbonklobby_tooltip").innerText=modeDesc)}))},initNetworkEngine:function(){const networkengine_OLD=NetworkEngine;NetworkEngine=function(mpSession,data){const networkEngine=new networkengine_OLD(...arguments);return networkEngine.createRoom_OLD=networkEngine.createRoom,networkEngine.createRoom=function(){return document.getElementById("gmeditor_openbutton").classList.remove("brownButtonDisabled"),networkEngine.createRoom_OLD(...arguments)},networkEngine.joinRoom_OLD=networkEngine.joinRoom,networkEngine.joinRoom=function(){return document.getElementById("gmeditor_openbutton").classList.add("brownButtonDisabled"),networkEngine.joinRoom_OLD(...arguments)},networkEngine.informInLobby_OLD=networkEngine.informInLobby,networkEngine.informInLobby=function(a,b){const gameSettings=b;return gameSettings.GMMode=gm.blockly.compressXml(gm.blockly.savedXml?.innerHTML||""),networkEngine.informInLobby_OLD(a,gameSettings)},networkEngine.informInGame_OLD=networkEngine.informInGame,networkEngine.informInGame=function(a,b){const gameSettings=b.gs;return gameSettings.GMMode=gm.blockly.compressXml(gm.blockly.savedXml?.innerHTML||""),b.gs=gameSettings,networkEngine.informInGame_OLD(a,b)},gm.lobby.data=data,gm.lobby.mpSession=mpSession,gm.lobby.networkEngine=networkEngine,networkEngine}},initJoinHandlers:function(){const smObj=this;GenericGameSessionHandler=function(){const cached_GenericGameSessionHandler=GenericGameSessionHandler;return function(){const result=cached_GenericGameSessionHandler.apply(this,arguments);return this.goInProgress_OLD=this.goInProgress,this.goInProgress=function(){const gameSettings=arguments[7];if(gameSettings.GMMode&&gm.lobby.networkEngine.getLSID()!=gm.lobby.networkEngine.hostID){const xml=document.createElement("xml");xml.innerHTML=gm.blockly.decompressXml(gameSettings.GMMode),gm.blockly.headlessWorkspace.clear(),blockly__WEBPACK_IMPORTED_MODULE_0___default().Xml.domToWorkspace(xml,gm.blockly.headlessWorkspace),gm.blockly.savedXml=xml,gm.blockly.savedSettings=xml?.getElementsByTagName("gmsettings")[0],gm.blockly.resetAll();try{eval(gm.blockly.generateCode())}catch(e){console.log(e)}}return this.goInProgress_OLD(...arguments)},smObj.GenericGameSessionHandler=this,result}}()},socket:null,mpSession:null,networkEngine:null,roundStarting:!1,gameCrashed:!1,haltCausedByLoop:!1,gameHalt:function(){gm.lobby.haltCausedByLoop?gm.lobby.bonkLobby?.showStatusMessage("* [GMMaker] Game was halted due to a very large loop (likely an infinite loop). Loop iteration limit (total loop iterations inside an event) is 10000000. Check your code.","#cc3333"):gm.lobby.bonkLobby?.showStatusMessage("* [GMMaker] Game was halted because an unexpected error ocurred. This may or may not have been caused by GMMaker. If you think GMMaker caused this, please open the browser's dev tools (Ctrl+Shift+I), go to the Console tab, and send SneezingCactus a full screenshot of the console so that the error can be diagnosed.","#cc3333"),gm.lobby.networkEngine&&gm.lobby.networkEngine.getLSID()==gm.lobby.networkEngine.hostID&&document.getElementById("pretty_top_exit").click()}}},5042:()=>{}},__webpack_module_cache__={};function __webpack_require__(moduleId){var cachedModule=__webpack_module_cache__[moduleId];if(void 0!==cachedModule)return cachedModule.exports;var module=__webpack_module_cache__[moduleId]={id:moduleId,loaded:!1,exports:{}};return __webpack_modules__[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.loaded=!0,module.exports}__webpack_require__.amdD=function(){throw new Error("define cannot be used indirect")},__webpack_require__.amdO={},__webpack_require__.n=module=>{var getter=module&&module.__esModule?()=>module.default:()=>module;return __webpack_require__.d(getter,{a:getter}),getter},__webpack_require__.d=(exports,definition)=>{for(var key in definition)__webpack_require__.o(definition,key)&&!__webpack_require__.o(exports,key)&&Object.defineProperty(exports,key,{enumerable:!0,get:definition[key]})},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.o=(obj,prop)=>Object.prototype.hasOwnProperty.call(obj,prop),__webpack_require__.nmd=module=>(module.paths=[],module.children||(module.children=[]),module);var __webpack_exports__={};(()=>{"use strict";__webpack_require__(4190);var seedrandom=__webpack_require__(6377),seedrandom_default=__webpack_require__.n(seedrandom);const physics={init:function(){this.initb2Step(),this.initGameState()},initb2Step:function(){Box2D.Dynamics.b2World.prototype.Step_OLD=Box2D.Dynamics.b2World.prototype.Step,Box2D.Dynamics.b2World.prototype.Step=function(){if(PhysicsClass.contactListener.PostSolve_OLD||gm.physics.initContactListener(),PhysicsClass.globalStepVars?.inputState){const kills=PhysicsClass.globalStepVars.inputState.physics.bodies[0].cf.kills;if(kills)for(let i=0;i!==kills.length;i++)PhysicsClass.globalStepVars.discs[kills[i].id]&&(PhysicsClass.globalStepVars.discs[kills[i].id].diedThisStep=kills[i].allowRespawn?1:3)}return this.Step_OLD(...arguments)}},initGameState:function(){const step_OLD=PhysicsClass.prototype.step;PhysicsClass.prototype.step=function(){try{if(gm.lobby.gameCrashed)throw"gmAlreadyCrashed";if(gm.inputs.allPlayerInputs=JSON.parse(JSON.stringify(arguments[1])),arguments[0]?.physics.bodies[0]?.cf.overrides){const overrides=arguments[0].physics.bodies[0].cf.overrides;for(let i=0;i!==arguments[0].discs.length;i++)overrides[i]&&arguments[0].discs[i]&&(arguments[1][i]={up:overrides[i].up??arguments[1][i]?.up??!1,down:overrides[i].down??arguments[1][i]?.down??!1,left:overrides[i].left??arguments[1][i]?.left??!1,right:overrides[i].right??arguments[1][i]?.right??!1,action:overrides[i].action??arguments[1][i]?.action??!1,action2:overrides[i].action2??arguments[1][i]?.action2??!1})}gm.physics.collisionsThisStep=[],gmReplaceAccessors.disableDeathBarrier=!!arguments[0].physics.bodies[0]?.cf.disableDeathBarrier,0===arguments[0].rl&&arguments[4].GMMode&&(gmReplaceAccessors.disableDeathBarrier=!0);let gst=step_OLD(...arguments);0==gst.ftu&&(gm.graphics.renderUpdates=[]);let randomSeed=0;for(let i=0;i<gst.physics.bodies.length;i++)gst.physics.bodies[i]&&(randomSeed=randomSeed+gst.physics.bodies[i].p[0]+gst.physics.bodies[i].p[1]+gst.physics.bodies[i].a);for(let i=0;i<gst.discs.length;i++)gst.discs[i]&&(randomSeed=randomSeed+gst.discs[i].x+gst.discs[i].y+gst.discs[i].xv+gst.discs[i].yv);if(randomSeed+=gst.rl,randomSeed/=gst.seed,gm.physics.pseudoRandom=new(seedrandom_default())(randomSeed),gst.physics.bodies[0]||(gst.physics.bodies[0]={type:"s",p:[0,0],a:0,av:0,lv:[0,0],ld:0,ad:0,fr:!1,bu:!1,fx:[],fric:0,fricp:!1,de:0,re:0,f_c:0,f_p:!1,f_1:!1,f_2:!1,f_3:!1,f_4:!1,cf:{x:0,y:0,w:!1,ct:0}}),gst.physics.bodies[0].cf.initialPlayers||(gst.physics.bodies[0].cf.initialPlayers=gm.blockly.funcs.getAllPlayerIds(gst)),!gst.physics.bodies[0].cf.variables){gst.physics.bodies[0].cf.variables={global:{}},gst.physics.bodies[0].cf.keepVariables=[];const keepVariables=arguments[0].physics.bodies[0]?.cf.keepVariables;if(keepVariables)for(let v=0;v<keepVariables.length;v++){const varName=keepVariables[v];arguments[0].physics.bodies[0]?.cf.variables?.global[varName]&&(gst.physics.bodies[0].cf.variables.global[varName]=arguments[0].physics.bodies[0].cf.variables.global[varName])}for(let i=0;i<gst.discs.length;i++)if(gst.discs[i]&&(gst.physics.bodies[0].cf.variables[i]={},keepVariables))for(let v=0;v<keepVariables.length;v++){const varName=keepVariables[v];arguments[0].physics.bodies[0].cf.variables[i][varName]&&(gst.physics.bodies[0].cf.variables[i][varName]=arguments[0].physics.bodies[0].cf.variables[i][varName])}gst.physics.bodies[0].cf.cameras=[];for(let i=0;i<gst.discs.length;i++)gst.discs[i]&&(gst.physics.bodies[0].cf.cameras[i]={xpos:365/gst.physics.ppm,ypos:250/gst.physics.ppm,angle:0,xscal:1,yscal:1,xskew:0,yskew:0,doLerp:!0});gst.physics.bodies[0].cf.disableDeathBarrier=!1}gm.graphics.onPhysStep(gst),gst.physics.bodies[0].cf.kills=[],gm.physics.gameState=gst;for(let i=0;i!==gm.physics.collisionsThisStep.length;i++){const bodyA=gm.physics.collisionsThisStep[i].fixtureABodyData,bodyB=gm.physics.collisionsThisStep[i].fixtureBBodyData,fixtureA=gm.physics.collisionsThisStep[i].fixtureAData,fixtureB=gm.physics.collisionsThisStep[i].fixtureBData,normal=gm.physics.collisionsThisStep[i].normal,projs=gm.physics.gameState.projectiles;let discBody,collisionBody,collisionFixture,arrowBody,isFixtureA=!1;if("disc"===bodyA.type?(isFixtureA=!0,discBody=bodyA,collisionBody=bodyB,collisionFixture=fixtureB):"disc"===bodyB.type&&(isFixtureA=!1,discBody=bodyB,collisionBody=bodyA,collisionFixture=fixtureA),discBody&&gst.discs[discBody.arrayID])switch(collisionBody.type){case"disc":(1===discBody.team||discBody.team!==collisionBody.team&&gst.discs[collisionBody.arrayID])&&(gm.physics.onPlayerPlayerCollision(discBody.arrayID,collisionBody.arrayID),gm.physics.onPlayerPlayerCollision(collisionBody.arrayID,discBody.arrayID));break;case"arrow":let arrowNumber=0,accum=1;for(let a=0;a!==projs.length;a++)collisionBody&&collisionBody.arrayID===a?arrowNumber=accum:collisionBody&&projs[a]&&collisionBody.discID===projs[a].did&&accum++;if(0===arrowNumber)break;discBody.arrayID===collisionBody.discID||1!==discBody.team&&discBody.team===collisionBody.team||!gst.projectiles[collisionBody.arrayID]||gm.physics.onPlayerArrowCollision(discBody.arrayID,collisionBody.discID,arrowNumber);break;case"phys":gst.physics.bodies[collisionBody.arrayID]?.fx.length>0&&gm.physics.onPlayerPlatformCollision(discBody.arrayID,collisionBody.arrayID,gst.physics.bodies[collisionBody.arrayID].fx.indexOf(collisionFixture.arrayID)+1,isFixtureA?{x:-normal.x,y:-normal.y}:normal)}let arrowNumberA=0,arrowNumberB=0;"arrow"===bodyA.type?(isFixtureA=!0,arrowBody=bodyA,collisionBody=bodyB,collisionFixture=fixtureB):"arrow"===bodyB.type&&(isFixtureA=!1,arrowBody=bodyB,collisionBody=bodyA,collisionFixture=fixtureA);let platBody,platFixture,accumA=1,accumB=1;for(let a=0;a!==projs.length;a++)arrowBody&&arrowBody.arrayID===a?arrowNumberA=accumA:arrowBody&&projs[a]&&arrowBody.discID===projs[a].did&&accumA++,collisionBody&&collisionBody.arrayID&&collisionBody.arrayID===a?arrowNumberB=accumB:collisionBody&&collisionBody.discID&&projs[a]&&collisionBody.discID===projs[a].did&&accumB++;if(arrowBody&&gst.projectiles[arrowBody.arrayID]&&gst.discs[arrowBody.discID])switch(collisionBody.type){case"disc":arrowBody.discID===collisionBody.arrayID||1!==collisionBody.team&&arrowBody.team===collisionBody.team||!gst.discs[collisionBody.arrayID]||gm.physics.onArrowPlayerCollision(arrowBody.discID,arrowNumberA,collisionBody.arrayID);break;case"arrow":gst.projectiles[collisionBody.arrayID]&&gst.discs[collisionBody.discID]&&(gm.physics.onArrowArrowCollision(arrowBody.discID,arrowNumberA,collisionBody.discID,arrowNumberB),gm.physics.onArrowArrowCollision(collisionBody.discID,arrowNumberB,arrowBody.discID,arrowNumberA));break;case"phys":gst.physics.bodies[collisionBody.arrayID]?.fx.length>0&&gm.physics.onArrowPlatformCollision(arrowBody.discID,arrowNumberA,collisionBody.arrayID,gst.physics.bodies[collisionBody.arrayID].fx.indexOf(collisionFixture.arrayID)+1,isFixtureA?{x:-normal.x,y:-normal.y}:normal)}if("phys"===bodyA.type?(isFixtureA=!0,platBody=bodyA,collisionBody=bodyB,platFixture=fixtureA,collisionFixture=fixtureB):"phys"===bodyB.type&&(isFixtureA=!1,platBody=bodyB,collisionBody=bodyA,platFixture=fixtureB,collisionFixture=fixtureA),platBody&&gst.physics.bodies[platBody.arrayID]?.fx.length>0)for(let i=0;i<gst.discs.length;i++)if(gst.discs[i])switch(collisionBody.type){case"disc":gst.discs[collisionBody.arrayID]&&gm.physics.onPlatformPlayerCollision(i,platBody.arrayID,platFixture.arrayID,collisionBody.arrayID);break;case"arrow":let arrowNumber=0,accum=1;for(let a=0;a!==projs.length;a++)collisionBody&&collisionBody.arrayID===a?arrowNumber=accum:collisionBody&&projs[a]&&collisionBody.discID===projs[a].did&&accum++;if(0===arrowNumber)break;gst.discs[collisionBody.discID]&&gst.projectiles[collisionBody.arrayID]&&gm.physics.onPlatformArrowCollision(i,platBody.arrayID,platFixture.arrayID,collisionBody.discID,arrowNumber);break;case"phys":gst.physics.bodies[collisionBody.arrayID]?.fx.length>0&&(gm.physics.onPlatformPlatformCollision(i,platBody.arrayID,platFixture.arrayID,collisionBody.arrayID,gst.physics.bodies[collisionBody.arrayID].fx.indexOf(collisionFixture.arrayID)+1,isFixtureA?{x:-normal.x,y:-normal.y}:normal),gm.physics.onPlatformPlatformCollision(i,collisionBody.arrayID,collisionFixture.arrayID,platBody.arrayID,gst.physics.bodies[platBody.arrayID].fx.indexOf(platFixture.arrayID)+1,isFixtureA?normal:{x:-normal.x,y:-normal.y}))}}gm.physics.forceGameState&&(gm.physics.forceGameState=!1,gst=gm.physics.gameState),gm.physics.gameState=gst;for(let i=0;i<arguments[0].discs.length;i++)if(arguments[0].discs[i]&&!gst.discs[i]){const currentDisc=gm.physics.gameState.discs[i];gm.physics.gameState.discs[i]=arguments[0].discs[i],gm.physics.onPlayerDie(i),gm.physics.gameState.discs[i]=currentDisc}else gst.discDeaths[gst.discDeaths.length-1]?.i==i&&0==gst.discDeaths[gst.discDeaths.length-1]?.f&&gm.physics.onPlayerDie(i);if(1===gm.physics.gameState.rl){gm.lobby.roundStarting=!1,gm.blockly.funcs.clearGraphics();for(let i=0;i!==gst.physics.bodies[0].cf.initialPlayers.length;i++){const id=gst.physics.bodies[0].cf.initialPlayers[i];gm.inputs.allPlayerInputs[id]||(gm.inputs.allPlayerInputs[id]={left:!1,right:!1,up:!1,down:!1,action:!1,action2:!1}),gm.physics.onFirstStep(id)}}else if(!gm.physics.forceGameState&&-1===gm.physics.gameState.ftu)for(let i=0;i!==gst.physics.bodies[0].cf.initialPlayers.length;i++){const id=gst.physics.bodies[0].cf.initialPlayers[i];gm.inputs.allPlayerInputs[id]||(gm.inputs.allPlayerInputs[id]={left:!1,right:!1,up:!1,down:!1,action:!1,action2:!1}),gm.physics.onStep(id)}if(gst.ftu>0&&(gm.lobby.roundStarting=!0),gm.physics.forceGameState&&(gm.physics.forceGameState=!1,gst=gm.physics.gameState),gm.physics.gameState=gst,gst.physics.bodies[0].cf.rendererExists=!!gm.graphics.rendererClass,gm.graphics.rendererClass&&!arguments[0].physics.bodies[0]?.cf.rendererExists)for(let i=0;i<gst.rl;i++)window.gmReplaceAccessors.gameStateList&&window.gmReplaceAccessors.gameStateList[i]&&gm.graphics.doRenderUpdates(window.gmReplaceAccessors.gameStateList[i]);else gm.graphics.rendererClass&&gm.graphics.doRenderUpdates(gst);return gm.physics.collisionsThisStep=[],window.gmReplaceAccessors.endStep&&window.gmReplaceAccessors.endStep(),gst}catch(e){return gm.lobby.gameCrashed||("gmInfiniteLoop"===e?gm.lobby.haltCausedByLoop=!0:console.error(e),gm.lobby.gameCrashed=!0,setTimeout(gm.lobby.gameHalt,500)),arguments[0]}}},initContactListener:function(){PhysicsClass.contactListener.PostSolve_OLD=PhysicsClass.contactListener.PostSolve,PhysicsClass.contactListener.PostSolve=function(contact,impulses){if(impulses.normalImpulses[0]>.1){const worldManifold=new Box2D.Collision.b2WorldManifold;contact.GetWorldManifold(worldManifold),gm.physics.collisionsThisStep.push({fixtureAData:contact.GetFixtureA().GetUserData(),fixtureABodyData:contact.GetFixtureA().GetBody().GetUserData(),fixtureBData:contact.GetFixtureB().GetUserData(),fixtureBBodyData:contact.GetFixtureB().GetBody().GetUserData(),normal:{x:worldManifold.m_normal.x,y:worldManifold.m_normal.y}})}return PhysicsClass.contactListener.PostSolve_OLD(...arguments)}},gameState:null,setGameState:function(newgst){this.forceGameState=!0,this.gameState=newgst},forceGameState:!1,collisionsThisStep:[],pseudoRandom:null,lastStepCount:0,onStep:function(){},onFirstStep:function(){},onPlayerDie:function(){},onPlayerPlayerCollision:function(){},onPlayerArrowCollision:function(){},onPlayerPlatformCollision:function(){},onArrowPlayerCollision:function(){},onArrowArrowCollision:function(){},onArrowPlatformCollision:function(){},onPlatformPlayerCollision:function(){},onPlatformArrowCollision:function(){},onPlatformPlatformCollision:function(){},getPlayerLastArrow:function(playerid){const projs=this.gameState.projectiles;for(let i=projs.length;-1!==i;i-=1)if(projs[i]&&projs[i].did===playerid)return projs[i];return null}};const src_finally=function(callback){var constructor=this.constructor;return this.then((function(value){return constructor.resolve(callback()).then((function(){return value}))}),(function(reason){return constructor.resolve(callback()).then((function(){return constructor.reject(reason)}))}))};const src_allSettled=function(arr){return new this((function(resolve,reject){if(!arr||void 0===arr.length)return reject(new TypeError(typeof arr+" "+arr+" is not iterable(cannot read property Symbol(Symbol.iterator))"));var args=Array.prototype.slice.call(arr);if(0===args.length)return resolve([]);var remaining=args.length;function res(i,val){if(val&&("object"==typeof val||"function"==typeof val)){var then=val.then;if("function"==typeof then)return void then.call(val,(function(val){res(i,val)}),(function(e){args[i]={status:"rejected",reason:e},0==--remaining&&resolve(args)}))}args[i]={status:"fulfilled",value:val},0==--remaining&&resolve(args)}for(var i=0;i<args.length;i++)res(i,args[i])}))};var setTimeoutFunc=setTimeout;function isArray(x){return Boolean(x&&void 0!==x.length)}function noop(){}function src_Promise(fn){if(!(this instanceof src_Promise))throw new TypeError("Promises must be constructed via new");if("function"!=typeof fn)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],doResolve(fn,this)}function handle(self,deferred){for(;3===self._state;)self=self._value;0!==self._state?(self._handled=!0,src_Promise._immediateFn((function(){var cb=1===self._state?deferred.onFulfilled:deferred.onRejected;if(null!==cb){var ret;try{ret=cb(self._value)}catch(e){return void reject(deferred.promise,e)}resolve(deferred.promise,ret)}else(1===self._state?resolve:reject)(deferred.promise,self._value)}))):self._deferreds.push(deferred)}function resolve(self,newValue){try{if(newValue===self)throw new TypeError("A promise cannot be resolved with itself.");if(newValue&&("object"==typeof newValue||"function"==typeof newValue)){var then=newValue.then;if(newValue instanceof src_Promise)return self._state=3,self._value=newValue,void finale(self);if("function"==typeof then)return void doResolve((fn=then,thisArg=newValue,function(){fn.apply(thisArg,arguments)}),self)}self._state=1,self._value=newValue,finale(self)}catch(e){reject(self,e)}var fn,thisArg}function reject(self,newValue){self._state=2,self._value=newValue,finale(self)}function finale(self){2===self._state&&0===self._deferreds.length&&src_Promise._immediateFn((function(){self._handled||src_Promise._unhandledRejectionFn(self._value)}));for(var i=0,len=self._deferreds.length;i<len;i++)handle(self,self._deferreds[i]);self._deferreds=null}function Handler(onFulfilled,onRejected,promise){this.onFulfilled="function"==typeof onFulfilled?onFulfilled:null,this.onRejected="function"==typeof onRejected?onRejected:null,this.promise=promise}function doResolve(fn,self){var done=!1;try{fn((function(value){done||(done=!0,resolve(self,value))}),(function(reason){done||(done=!0,reject(self,reason))}))}catch(ex){if(done)return;done=!0,reject(self,ex)}}src_Promise.prototype.catch=function(onRejected){return this.then(null,onRejected)},src_Promise.prototype.then=function(onFulfilled,onRejected){var prom=new this.constructor(noop);return handle(this,new Handler(onFulfilled,onRejected,prom)),prom},src_Promise.prototype.finally=src_finally,src_Promise.all=function(arr){return new src_Promise((function(resolve,reject){if(!isArray(arr))return reject(new TypeError("Promise.all accepts an array"));var args=Array.prototype.slice.call(arr);if(0===args.length)return resolve([]);var remaining=args.length;function res(i,val){try{if(val&&("object"==typeof val||"function"==typeof val)){var then=val.then;if("function"==typeof then)return void then.call(val,(function(val){res(i,val)}),reject)}args[i]=val,0==--remaining&&resolve(args)}catch(ex){reject(ex)}}for(var i=0;i<args.length;i++)res(i,args[i])}))},src_Promise.allSettled=src_allSettled,src_Promise.resolve=function(value){return value&&"object"==typeof value&&value.constructor===src_Promise?value:new src_Promise((function(resolve){resolve(value)}))},src_Promise.reject=function(value){return new src_Promise((function(resolve,reject){reject(value)}))},src_Promise.race=function(arr){return new src_Promise((function(resolve,reject){if(!isArray(arr))return reject(new TypeError("Promise.race accepts an array"));for(var i=0,len=arr.length;i<len;i++)src_Promise.resolve(arr[i]).then(resolve,reject)}))},src_Promise._immediateFn="function"==typeof setImmediate&&function(fn){setImmediate(fn)}||function(fn){setTimeoutFunc(fn,0)},src_Promise._unhandledRejectionFn=function(err){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",err)};const src=src_Promise;var object_assign=__webpack_require__(7418),object_assign_default=__webpack_require__.n(object_assign);"undefined"==typeof globalThis&&("undefined"!=typeof self?self.globalThis=self:void 0!==__webpack_require__.g&&(__webpack_require__.g.globalThis=__webpack_require__.g)),globalThis.Promise||(globalThis.Promise=src),Object.assign||(Object.assign=object_assign_default());if(Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),!globalThis.performance||!globalThis.performance.now){var startTime_1=Date.now();globalThis.performance||(globalThis.performance={}),globalThis.performance.now=function(){return Date.now()-startTime_1}}for(var lastTime=Date.now(),vendors=["ms","moz","webkit","o"],x=0;x<vendors.length&&!globalThis.requestAnimationFrame;++x){var p=vendors[x];globalThis.requestAnimationFrame=globalThis[p+"RequestAnimationFrame"],globalThis.cancelAnimationFrame=globalThis[p+"CancelAnimationFrame"]||globalThis[p+"CancelRequestAnimationFrame"]}globalThis.requestAnimationFrame||(globalThis.requestAnimationFrame=function(callback){if("function"!=typeof callback)throw new TypeError(callback+"is not a function");var currentTime=Date.now(),delay=16+lastTime-currentTime;return delay<0&&(delay=0),lastTime=currentTime,globalThis.self.setTimeout((function(){lastTime=Date.now(),callback(performance.now())}),delay)}),globalThis.cancelAnimationFrame||(globalThis.cancelAnimationFrame=function(id){return clearTimeout(id)}),Math.sign||(Math.sign=function(x){return 0===(x=Number(x))||isNaN(x)?x:x>0?1:-1}),Number.isInteger||(Number.isInteger=function(value){return"number"==typeof value&&isFinite(value)&&Math.floor(value)===value}),globalThis.ArrayBuffer||(globalThis.ArrayBuffer=Array),globalThis.Float32Array||(globalThis.Float32Array=Array),globalThis.Uint32Array||(globalThis.Uint32Array=Array),globalThis.Uint16Array||(globalThis.Uint16Array=Array),globalThis.Uint8Array||(globalThis.Uint8Array=Array),globalThis.Int32Array||(globalThis.Int32Array=Array);var appleIphone=/iPhone/i,appleIpod=/iPod/i,appleTablet=/iPad/i,appleUniversal=/\biOS-universal(?:.+)Mac\b/i,androidPhone=/\bAndroid(?:.+)Mobile\b/i,androidTablet=/Android/i,amazonPhone=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,amazonTablet=/Silk/i,windowsPhone=/Windows Phone/i,windowsTablet=/\bWindows(?:.+)ARM\b/i,otherBlackBerry=/BlackBerry/i,otherBlackBerry10=/BB10/i,otherOpera=/Opera Mini/i,otherChrome=/\b(CriOS|Chrome)(?:.+)Mobile/i,otherFirefox=/Mobile(?:.+)Firefox\b/i,isAppleTabletOnIos13=function(navigator){return void 0!==navigator&&"MacIntel"===navigator.platform&&"number"==typeof navigator.maxTouchPoints&&navigator.maxTouchPoints>1&&"undefined"==typeof MSStream};var ENV,RENDERER_TYPE,BUFFER_BITS,BLEND_MODES,DRAW_MODES,FORMATS,TARGETS,TYPES,SAMPLER_TYPES,SCALE_MODES,WRAP_MODES,MIPMAP_MODES,ALPHA_MODES,CLEAR_MODES,GC_MODES,PRECISION,MASK_TYPES,MSAA_QUALITY,BUFFER_TYPE,settings_isMobile=function(param){var nav={userAgent:"",platform:"",maxTouchPoints:0};param||"undefined"==typeof navigator?"string"==typeof param?nav.userAgent=param:param&&param.userAgent&&(nav={userAgent:param.userAgent,platform:param.platform,maxTouchPoints:param.maxTouchPoints||0}):nav={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0};var userAgent=nav.userAgent,tmp=userAgent.split("[FBAN");void 0!==tmp[1]&&(userAgent=tmp[0]),void 0!==(tmp=userAgent.split("Twitter"))[1]&&(userAgent=tmp[0]);var match=function(userAgent){return function(regex){return regex.test(userAgent)}}(userAgent),result={apple:{phone:match(appleIphone)&&!match(windowsPhone),ipod:match(appleIpod),tablet:!match(appleIphone)&&(match(appleTablet)||isAppleTabletOnIos13(nav))&&!match(windowsPhone),universal:match(appleUniversal),device:(match(appleIphone)||match(appleIpod)||match(appleTablet)||match(appleUniversal)||isAppleTabletOnIos13(nav))&&!match(windowsPhone)},amazon:{phone:match(amazonPhone),tablet:!match(amazonPhone)&&match(amazonTablet),device:match(amazonPhone)||match(amazonTablet)},android:{phone:!match(windowsPhone)&&match(amazonPhone)||!match(windowsPhone)&&match(androidPhone),tablet:!match(windowsPhone)&&!match(amazonPhone)&&!match(androidPhone)&&(match(amazonTablet)||match(androidTablet)),device:!match(windowsPhone)&&(match(amazonPhone)||match(amazonTablet)||match(androidPhone)||match(androidTablet))||match(/\bokhttp\b/i)},windows:{phone:match(windowsPhone),tablet:match(windowsTablet),device:match(windowsPhone)||match(windowsTablet)},other:{blackberry:match(otherBlackBerry),blackberry10:match(otherBlackBerry10),opera:match(otherOpera),firefox:match(otherFirefox),chrome:match(otherChrome),device:match(otherBlackBerry)||match(otherBlackBerry10)||match(otherOpera)||match(otherFirefox)||match(otherChrome)},any:!1,phone:!1,tablet:!1};return result.any=result.apple.device||result.android.device||result.windows.device||result.other.device,result.phone=result.apple.phone||result.android.phone||result.windows.phone,result.tablet=result.apple.tablet||result.android.tablet||result.windows.tablet,result}(globalThis.navigator);!function(ENV){ENV[ENV.WEBGL_LEGACY=0]="WEBGL_LEGACY",ENV[ENV.WEBGL=1]="WEBGL",ENV[ENV.WEBGL2=2]="WEBGL2"}(ENV||(ENV={})),function(RENDERER_TYPE){RENDERER_TYPE[RENDERER_TYPE.UNKNOWN=0]="UNKNOWN",RENDERER_TYPE[RENDERER_TYPE.WEBGL=1]="WEBGL",RENDERER_TYPE[RENDERER_TYPE.CANVAS=2]="CANVAS"}(RENDERER_TYPE||(RENDERER_TYPE={})),function(BUFFER_BITS){BUFFER_BITS[BUFFER_BITS.COLOR=16384]="COLOR",BUFFER_BITS[BUFFER_BITS.DEPTH=256]="DEPTH",BUFFER_BITS[BUFFER_BITS.STENCIL=1024]="STENCIL"}(BUFFER_BITS||(BUFFER_BITS={})),function(BLEND_MODES){BLEND_MODES[BLEND_MODES.NORMAL=0]="NORMAL",BLEND_MODES[BLEND_MODES.ADD=1]="ADD",BLEND_MODES[BLEND_MODES.MULTIPLY=2]="MULTIPLY",BLEND_MODES[BLEND_MODES.SCREEN=3]="SCREEN",BLEND_MODES[BLEND_MODES.OVERLAY=4]="OVERLAY",BLEND_MODES[BLEND_MODES.DARKEN=5]="DARKEN",BLEND_MODES[BLEND_MODES.LIGHTEN=6]="LIGHTEN",BLEND_MODES[BLEND_MODES.COLOR_DODGE=7]="COLOR_DODGE",BLEND_MODES[BLEND_MODES.COLOR_BURN=8]="COLOR_BURN",BLEND_MODES[BLEND_MODES.HARD_LIGHT=9]="HARD_LIGHT",BLEND_MODES[BLEND_MODES.SOFT_LIGHT=10]="SOFT_LIGHT",BLEND_MODES[BLEND_MODES.DIFFERENCE=11]="DIFFERENCE",BLEND_MODES[BLEND_MODES.EXCLUSION=12]="EXCLUSION",BLEND_MODES[BLEND_MODES.HUE=13]="HUE",BLEND_MODES[BLEND_MODES.SATURATION=14]="SATURATION",BLEND_MODES[BLEND_MODES.COLOR=15]="COLOR",BLEND_MODES[BLEND_MODES.LUMINOSITY=16]="LUMINOSITY",BLEND_MODES[BLEND_MODES.NORMAL_NPM=17]="NORMAL_NPM",BLEND_MODES[BLEND_MODES.ADD_NPM=18]="ADD_NPM",BLEND_MODES[BLEND_MODES.SCREEN_NPM=19]="SCREEN_NPM",BLEND_MODES[BLEND_MODES.NONE=20]="NONE",BLEND_MODES[BLEND_MODES.SRC_OVER=0]="SRC_OVER",BLEND_MODES[BLEND_MODES.SRC_IN=21]="SRC_IN",BLEND_MODES[BLEND_MODES.SRC_OUT=22]="SRC_OUT",BLEND_MODES[BLEND_MODES.SRC_ATOP=23]="SRC_ATOP",BLEND_MODES[BLEND_MODES.DST_OVER=24]="DST_OVER",BLEND_MODES[BLEND_MODES.DST_IN=25]="DST_IN",BLEND_MODES[BLEND_MODES.DST_OUT=26]="DST_OUT",BLEND_MODES[BLEND_MODES.DST_ATOP=27]="DST_ATOP",BLEND_MODES[BLEND_MODES.ERASE=26]="ERASE",BLEND_MODES[BLEND_MODES.SUBTRACT=28]="SUBTRACT",BLEND_MODES[BLEND_MODES.XOR=29]="XOR"}(BLEND_MODES||(BLEND_MODES={})),function(DRAW_MODES){DRAW_MODES[DRAW_MODES.POINTS=0]="POINTS",DRAW_MODES[DRAW_MODES.LINES=1]="LINES",DRAW_MODES[DRAW_MODES.LINE_LOOP=2]="LINE_LOOP",DRAW_MODES[DRAW_MODES.LINE_STRIP=3]="LINE_STRIP",DRAW_MODES[DRAW_MODES.TRIANGLES=4]="TRIANGLES",DRAW_MODES[DRAW_MODES.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",DRAW_MODES[DRAW_MODES.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(DRAW_MODES||(DRAW_MODES={})),function(FORMATS){FORMATS[FORMATS.RGBA=6408]="RGBA",FORMATS[FORMATS.RGB=6407]="RGB",FORMATS[FORMATS.RG=33319]="RG",FORMATS[FORMATS.RED=6403]="RED",FORMATS[FORMATS.RGBA_INTEGER=36249]="RGBA_INTEGER",FORMATS[FORMATS.RGB_INTEGER=36248]="RGB_INTEGER",FORMATS[FORMATS.RG_INTEGER=33320]="RG_INTEGER",FORMATS[FORMATS.RED_INTEGER=36244]="RED_INTEGER",FORMATS[FORMATS.ALPHA=6406]="ALPHA",FORMATS[FORMATS.LUMINANCE=6409]="LUMINANCE",FORMATS[FORMATS.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",FORMATS[FORMATS.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",FORMATS[FORMATS.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(FORMATS||(FORMATS={})),function(TARGETS){TARGETS[TARGETS.TEXTURE_2D=3553]="TEXTURE_2D",TARGETS[TARGETS.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",TARGETS[TARGETS.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",TARGETS[TARGETS.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",TARGETS[TARGETS.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",TARGETS[TARGETS.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",TARGETS[TARGETS.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",TARGETS[TARGETS.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",TARGETS[TARGETS.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(TARGETS||(TARGETS={})),function(TYPES){TYPES[TYPES.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",TYPES[TYPES.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",TYPES[TYPES.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",TYPES[TYPES.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",TYPES[TYPES.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",TYPES[TYPES.UNSIGNED_INT=5125]="UNSIGNED_INT",TYPES[TYPES.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",TYPES[TYPES.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",TYPES[TYPES.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",TYPES[TYPES.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",TYPES[TYPES.BYTE=5120]="BYTE",TYPES[TYPES.SHORT=5122]="SHORT",TYPES[TYPES.INT=5124]="INT",TYPES[TYPES.FLOAT=5126]="FLOAT",TYPES[TYPES.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",TYPES[TYPES.HALF_FLOAT=36193]="HALF_FLOAT"}(TYPES||(TYPES={})),function(SAMPLER_TYPES){SAMPLER_TYPES[SAMPLER_TYPES.FLOAT=0]="FLOAT",SAMPLER_TYPES[SAMPLER_TYPES.INT=1]="INT",SAMPLER_TYPES[SAMPLER_TYPES.UINT=2]="UINT"}(SAMPLER_TYPES||(SAMPLER_TYPES={})),function(SCALE_MODES){SCALE_MODES[SCALE_MODES.NEAREST=0]="NEAREST",SCALE_MODES[SCALE_MODES.LINEAR=1]="LINEAR"}(SCALE_MODES||(SCALE_MODES={})),function(WRAP_MODES){WRAP_MODES[WRAP_MODES.CLAMP=33071]="CLAMP",WRAP_MODES[WRAP_MODES.REPEAT=10497]="REPEAT",WRAP_MODES[WRAP_MODES.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(WRAP_MODES||(WRAP_MODES={})),function(MIPMAP_MODES){MIPMAP_MODES[MIPMAP_MODES.OFF=0]="OFF",MIPMAP_MODES[MIPMAP_MODES.POW2=1]="POW2",MIPMAP_MODES[MIPMAP_MODES.ON=2]="ON",MIPMAP_MODES[MIPMAP_MODES.ON_MANUAL=3]="ON_MANUAL"}(MIPMAP_MODES||(MIPMAP_MODES={})),function(ALPHA_MODES){ALPHA_MODES[ALPHA_MODES.NPM=0]="NPM",ALPHA_MODES[ALPHA_MODES.UNPACK=1]="UNPACK",ALPHA_MODES[ALPHA_MODES.PMA=2]="PMA",ALPHA_MODES[ALPHA_MODES.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",ALPHA_MODES[ALPHA_MODES.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",ALPHA_MODES[ALPHA_MODES.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",ALPHA_MODES[ALPHA_MODES.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA"}(ALPHA_MODES||(ALPHA_MODES={})),function(CLEAR_MODES){CLEAR_MODES[CLEAR_MODES.NO=0]="NO",CLEAR_MODES[CLEAR_MODES.YES=1]="YES",CLEAR_MODES[CLEAR_MODES.AUTO=2]="AUTO",CLEAR_MODES[CLEAR_MODES.BLEND=0]="BLEND",CLEAR_MODES[CLEAR_MODES.CLEAR=1]="CLEAR",CLEAR_MODES[CLEAR_MODES.BLIT=2]="BLIT"}(CLEAR_MODES||(CLEAR_MODES={})),function(GC_MODES){GC_MODES[GC_MODES.AUTO=0]="AUTO",GC_MODES[GC_MODES.MANUAL=1]="MANUAL"}(GC_MODES||(GC_MODES={})),function(PRECISION){PRECISION.LOW="lowp",PRECISION.MEDIUM="mediump",PRECISION.HIGH="highp"}(PRECISION||(PRECISION={})),function(MASK_TYPES){MASK_TYPES[MASK_TYPES.NONE=0]="NONE",MASK_TYPES[MASK_TYPES.SCISSOR=1]="SCISSOR",MASK_TYPES[MASK_TYPES.STENCIL=2]="STENCIL",MASK_TYPES[MASK_TYPES.SPRITE=3]="SPRITE"}(MASK_TYPES||(MASK_TYPES={})),function(MSAA_QUALITY){MSAA_QUALITY[MSAA_QUALITY.NONE=0]="NONE",MSAA_QUALITY[MSAA_QUALITY.LOW=2]="LOW",MSAA_QUALITY[MSAA_QUALITY.MEDIUM=4]="MEDIUM",MSAA_QUALITY[MSAA_QUALITY.HIGH=8]="HIGH"}(MSAA_QUALITY||(MSAA_QUALITY={})),function(BUFFER_TYPE){BUFFER_TYPE[BUFFER_TYPE.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",BUFFER_TYPE[BUFFER_TYPE.ARRAY_BUFFER=34962]="ARRAY_BUFFER",BUFFER_TYPE[BUFFER_TYPE.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER"}(BUFFER_TYPE||(BUFFER_TYPE={}));var constants_ENV,constants_RENDERER_TYPE,constants_BUFFER_BITS,constants_BLEND_MODES,constants_DRAW_MODES,constants_FORMATS,constants_TARGETS,constants_TYPES,constants_SAMPLER_TYPES,constants_SCALE_MODES,constants_WRAP_MODES,constants_MIPMAP_MODES,constants_ALPHA_MODES,constants_CLEAR_MODES,constants_GC_MODES,constants_PRECISION,constants_MASK_TYPES,constants_MSAA_QUALITY,constants_BUFFER_TYPE,settings={MIPMAP_TEXTURES:MIPMAP_MODES.POW2,ANISOTROPIC_LEVEL:0,RESOLUTION:1,FILTER_RESOLUTION:1,FILTER_MULTISAMPLE:MSAA_QUALITY.NONE,SPRITE_MAX_TEXTURES:function(max){var allowMax=!0;if(settings_isMobile.tablet||settings_isMobile.phone){var match;if(settings_isMobile.apple.device)if(match=navigator.userAgent.match(/OS (\d+)_(\d+)?/))parseInt(match[1],10)<11&&(allowMax=!1);if(settings_isMobile.android.device)if(match=navigator.userAgent.match(/Android\s([0-9.]*)/))parseInt(match[1],10)<7&&(allowMax=!1)}return allowMax?max:4}(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,autoDensity:!1,backgroundColor:0,backgroundAlpha:1,useContextAlpha:!0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1},GC_MODE:GC_MODES.AUTO,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:WRAP_MODES.CLAMP,SCALE_MODE:SCALE_MODES.LINEAR,PRECISION_VERTEX:PRECISION.HIGH,PRECISION_FRAGMENT:settings_isMobile.apple.device?PRECISION.HIGH:PRECISION.MEDIUM,CAN_UPLOAD_SAME_BUFFER:!settings_isMobile.apple.device,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1},eventemitter3=__webpack_require__(6729),eventemitter3_default=__webpack_require__.n(eventemitter3),earcut=__webpack_require__(9187),earcut_default=__webpack_require__.n(earcut),url=__webpack_require__(8575);!function(ENV){ENV[ENV.WEBGL_LEGACY=0]="WEBGL_LEGACY",ENV[ENV.WEBGL=1]="WEBGL",ENV[ENV.WEBGL2=2]="WEBGL2"}(constants_ENV||(constants_ENV={})),function(RENDERER_TYPE){RENDERER_TYPE[RENDERER_TYPE.UNKNOWN=0]="UNKNOWN",RENDERER_TYPE[RENDERER_TYPE.WEBGL=1]="WEBGL",RENDERER_TYPE[RENDERER_TYPE.CANVAS=2]="CANVAS"}(constants_RENDERER_TYPE||(constants_RENDERER_TYPE={})),function(BUFFER_BITS){BUFFER_BITS[BUFFER_BITS.COLOR=16384]="COLOR",BUFFER_BITS[BUFFER_BITS.DEPTH=256]="DEPTH",BUFFER_BITS[BUFFER_BITS.STENCIL=1024]="STENCIL"}(constants_BUFFER_BITS||(constants_BUFFER_BITS={})),function(BLEND_MODES){BLEND_MODES[BLEND_MODES.NORMAL=0]="NORMAL",BLEND_MODES[BLEND_MODES.ADD=1]="ADD",BLEND_MODES[BLEND_MODES.MULTIPLY=2]="MULTIPLY",BLEND_MODES[BLEND_MODES.SCREEN=3]="SCREEN",BLEND_MODES[BLEND_MODES.OVERLAY=4]="OVERLAY",BLEND_MODES[BLEND_MODES.DARKEN=5]="DARKEN",BLEND_MODES[BLEND_MODES.LIGHTEN=6]="LIGHTEN",BLEND_MODES[BLEND_MODES.COLOR_DODGE=7]="COLOR_DODGE",BLEND_MODES[BLEND_MODES.COLOR_BURN=8]="COLOR_BURN",BLEND_MODES[BLEND_MODES.HARD_LIGHT=9]="HARD_LIGHT",BLEND_MODES[BLEND_MODES.SOFT_LIGHT=10]="SOFT_LIGHT",BLEND_MODES[BLEND_MODES.DIFFERENCE=11]="DIFFERENCE",BLEND_MODES[BLEND_MODES.EXCLUSION=12]="EXCLUSION",BLEND_MODES[BLEND_MODES.HUE=13]="HUE",BLEND_MODES[BLEND_MODES.SATURATION=14]="SATURATION",BLEND_MODES[BLEND_MODES.COLOR=15]="COLOR",BLEND_MODES[BLEND_MODES.LUMINOSITY=16]="LUMINOSITY",BLEND_MODES[BLEND_MODES.NORMAL_NPM=17]="NORMAL_NPM",BLEND_MODES[BLEND_MODES.ADD_NPM=18]="ADD_NPM",BLEND_MODES[BLEND_MODES.SCREEN_NPM=19]="SCREEN_NPM",BLEND_MODES[BLEND_MODES.NONE=20]="NONE",BLEND_MODES[BLEND_MODES.SRC_OVER=0]="SRC_OVER",BLEND_MODES[BLEND_MODES.SRC_IN=21]="SRC_IN",BLEND_MODES[BLEND_MODES.SRC_OUT=22]="SRC_OUT",BLEND_MODES[BLEND_MODES.SRC_ATOP=23]="SRC_ATOP",BLEND_MODES[BLEND_MODES.DST_OVER=24]="DST_OVER",BLEND_MODES[BLEND_MODES.DST_IN=25]="DST_IN",BLEND_MODES[BLEND_MODES.DST_OUT=26]="DST_OUT",BLEND_MODES[BLEND_MODES.DST_ATOP=27]="DST_ATOP",BLEND_MODES[BLEND_MODES.ERASE=26]="ERASE",BLEND_MODES[BLEND_MODES.SUBTRACT=28]="SUBTRACT",BLEND_MODES[BLEND_MODES.XOR=29]="XOR"}(constants_BLEND_MODES||(constants_BLEND_MODES={})),function(DRAW_MODES){DRAW_MODES[DRAW_MODES.POINTS=0]="POINTS",DRAW_MODES[DRAW_MODES.LINES=1]="LINES",DRAW_MODES[DRAW_MODES.LINE_LOOP=2]="LINE_LOOP",DRAW_MODES[DRAW_MODES.LINE_STRIP=3]="LINE_STRIP",DRAW_MODES[DRAW_MODES.TRIANGLES=4]="TRIANGLES",DRAW_MODES[DRAW_MODES.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",DRAW_MODES[DRAW_MODES.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(constants_DRAW_MODES||(constants_DRAW_MODES={})),function(FORMATS){FORMATS[FORMATS.RGBA=6408]="RGBA",FORMATS[FORMATS.RGB=6407]="RGB",FORMATS[FORMATS.RG=33319]="RG",FORMATS[FORMATS.RED=6403]="RED",FORMATS[FORMATS.RGBA_INTEGER=36249]="RGBA_INTEGER",FORMATS[FORMATS.RGB_INTEGER=36248]="RGB_INTEGER",FORMATS[FORMATS.RG_INTEGER=33320]="RG_INTEGER",FORMATS[FORMATS.RED_INTEGER=36244]="RED_INTEGER",FORMATS[FORMATS.ALPHA=6406]="ALPHA",FORMATS[FORMATS.LUMINANCE=6409]="LUMINANCE",FORMATS[FORMATS.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",FORMATS[FORMATS.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",FORMATS[FORMATS.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(constants_FORMATS||(constants_FORMATS={})),function(TARGETS){TARGETS[TARGETS.TEXTURE_2D=3553]="TEXTURE_2D",TARGETS[TARGETS.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",TARGETS[TARGETS.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",TARGETS[TARGETS.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",TARGETS[TARGETS.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",TARGETS[TARGETS.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",TARGETS[TARGETS.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",TARGETS[TARGETS.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",TARGETS[TARGETS.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(constants_TARGETS||(constants_TARGETS={})),function(TYPES){TYPES[TYPES.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",TYPES[TYPES.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",TYPES[TYPES.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",TYPES[TYPES.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",TYPES[TYPES.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",TYPES[TYPES.UNSIGNED_INT=5125]="UNSIGNED_INT",TYPES[TYPES.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",TYPES[TYPES.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",TYPES[TYPES.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",TYPES[TYPES.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",TYPES[TYPES.BYTE=5120]="BYTE",TYPES[TYPES.SHORT=5122]="SHORT",TYPES[TYPES.INT=5124]="INT",TYPES[TYPES.FLOAT=5126]="FLOAT",TYPES[TYPES.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",TYPES[TYPES.HALF_FLOAT=36193]="HALF_FLOAT"}(constants_TYPES||(constants_TYPES={})),function(SAMPLER_TYPES){SAMPLER_TYPES[SAMPLER_TYPES.FLOAT=0]="FLOAT",SAMPLER_TYPES[SAMPLER_TYPES.INT=1]="INT",SAMPLER_TYPES[SAMPLER_TYPES.UINT=2]="UINT"}(constants_SAMPLER_TYPES||(constants_SAMPLER_TYPES={})),function(SCALE_MODES){SCALE_MODES[SCALE_MODES.NEAREST=0]="NEAREST",SCALE_MODES[SCALE_MODES.LINEAR=1]="LINEAR"}(constants_SCALE_MODES||(constants_SCALE_MODES={})),function(WRAP_MODES){WRAP_MODES[WRAP_MODES.CLAMP=33071]="CLAMP",WRAP_MODES[WRAP_MODES.REPEAT=10497]="REPEAT",WRAP_MODES[WRAP_MODES.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(constants_WRAP_MODES||(constants_WRAP_MODES={})),function(MIPMAP_MODES){MIPMAP_MODES[MIPMAP_MODES.OFF=0]="OFF",MIPMAP_MODES[MIPMAP_MODES.POW2=1]="POW2",MIPMAP_MODES[MIPMAP_MODES.ON=2]="ON",MIPMAP_MODES[MIPMAP_MODES.ON_MANUAL=3]="ON_MANUAL"}(constants_MIPMAP_MODES||(constants_MIPMAP_MODES={})),function(ALPHA_MODES){ALPHA_MODES[ALPHA_MODES.NPM=0]="NPM",ALPHA_MODES[ALPHA_MODES.UNPACK=1]="UNPACK",ALPHA_MODES[ALPHA_MODES.PMA=2]="PMA",ALPHA_MODES[ALPHA_MODES.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",ALPHA_MODES[ALPHA_MODES.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",ALPHA_MODES[ALPHA_MODES.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",ALPHA_MODES[ALPHA_MODES.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA"}(constants_ALPHA_MODES||(constants_ALPHA_MODES={})),function(CLEAR_MODES){CLEAR_MODES[CLEAR_MODES.NO=0]="NO",CLEAR_MODES[CLEAR_MODES.YES=1]="YES",CLEAR_MODES[CLEAR_MODES.AUTO=2]="AUTO",CLEAR_MODES[CLEAR_MODES.BLEND=0]="BLEND",CLEAR_MODES[CLEAR_MODES.CLEAR=1]="CLEAR",CLEAR_MODES[CLEAR_MODES.BLIT=2]="BLIT"}(constants_CLEAR_MODES||(constants_CLEAR_MODES={})),function(GC_MODES){GC_MODES[GC_MODES.AUTO=0]="AUTO",GC_MODES[GC_MODES.MANUAL=1]="MANUAL"}(constants_GC_MODES||(constants_GC_MODES={})),function(PRECISION){PRECISION.LOW="lowp",PRECISION.MEDIUM="mediump",PRECISION.HIGH="highp"}(constants_PRECISION||(constants_PRECISION={})),function(MASK_TYPES){MASK_TYPES[MASK_TYPES.NONE=0]="NONE",MASK_TYPES[MASK_TYPES.SCISSOR=1]="SCISSOR",MASK_TYPES[MASK_TYPES.STENCIL=2]="STENCIL",MASK_TYPES[MASK_TYPES.SPRITE=3]="SPRITE"}(constants_MASK_TYPES||(constants_MASK_TYPES={})),function(MSAA_QUALITY){MSAA_QUALITY[MSAA_QUALITY.NONE=0]="NONE",MSAA_QUALITY[MSAA_QUALITY.LOW=2]="LOW",MSAA_QUALITY[MSAA_QUALITY.MEDIUM=4]="MEDIUM",MSAA_QUALITY[MSAA_QUALITY.HIGH=8]="HIGH"}(constants_MSAA_QUALITY||(constants_MSAA_QUALITY={})),function(BUFFER_TYPE){BUFFER_TYPE[BUFFER_TYPE.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",BUFFER_TYPE[BUFFER_TYPE.ARRAY_BUFFER=34962]="ARRAY_BUFFER",BUFFER_TYPE[BUFFER_TYPE.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER"}(constants_BUFFER_TYPE||(constants_BUFFER_TYPE={}));var utils_url={parse:url.Qc,format:url.WU,resolve:url.DB};settings.RETINA_PREFIX=/@([0-9\.]+)x/,settings.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var supported,saidHello=!1;function sayHello(type){var _a;if(!saidHello){if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var args=["\n %c %c %c PixiJS 6.3.0 -  "+type+"   %c  %c  http://www.pixijs.com/  %c %c %c%c \n\n","background: #ff66a5; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff66a5; background: #030307; padding:5px 0;","background: #ff66a5; padding:5px 0;","background: #ffc3dc; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;"];(_a=globalThis.console).log.apply(_a,args)}else globalThis.console&&globalThis.console.log("PixiJS 6.3.0 - "+type+" - http://www.pixijs.com/");saidHello=!0}}var cssColorNames={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function hex2rgb(hex,out){return void 0===out&&(out=[]),out[0]=(hex>>16&255)/255,out[1]=(hex>>8&255)/255,out[2]=(255&hex)/255,out}function hex2string(hex){var hexString=hex.toString(16);return"#"+(hexString="000000".substring(0,6-hexString.length)+hexString)}function string2hex(string){return"string"==typeof string&&"#"===(string=cssColorNames[string.toLowerCase()]||string)[0]&&(string=string.slice(1)),parseInt(string,16)}function rgb2hex(rgb){return(255*rgb[0]<<16)+(255*rgb[1]<<8)+(255*rgb[2]|0)}var premultiplyBlendMode=function(){for(var pm=[],npm=[],i=0;i<32;i++)pm[i]=i,npm[i]=i;pm[constants_BLEND_MODES.NORMAL_NPM]=constants_BLEND_MODES.NORMAL,pm[constants_BLEND_MODES.ADD_NPM]=constants_BLEND_MODES.ADD,pm[constants_BLEND_MODES.SCREEN_NPM]=constants_BLEND_MODES.SCREEN,npm[constants_BLEND_MODES.NORMAL]=constants_BLEND_MODES.NORMAL_NPM,npm[constants_BLEND_MODES.ADD]=constants_BLEND_MODES.ADD_NPM,npm[constants_BLEND_MODES.SCREEN]=constants_BLEND_MODES.SCREEN_NPM;var array=[];return array.push(npm),array.push(pm),array}();function correctBlendMode(blendMode,premultiplied){return premultiplyBlendMode[premultiplied?1:0][blendMode]}function premultiplyTint(tint,alpha){if(1===alpha)return(255*alpha<<24)+tint;if(0===alpha)return 0;var R=tint>>16&255,G=tint>>8&255,B=255&tint;return(255*alpha<<24)+((R=R*alpha+.5|0)<<16)+((G=G*alpha+.5|0)<<8)+(B=B*alpha+.5|0)}function premultiplyTintToRgba(tint,alpha,out,premultiply){return(out=out||new Float32Array(4))[0]=(tint>>16&255)/255,out[1]=(tint>>8&255)/255,out[2]=(255&tint)/255,(premultiply||void 0===premultiply)&&(out[0]*=alpha,out[1]*=alpha,out[2]*=alpha),out[3]=alpha,out}function getBufferType(array){if(4===array.BYTES_PER_ELEMENT)return array instanceof Float32Array?"Float32Array":array instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===array.BYTES_PER_ELEMENT){if(array instanceof Uint16Array)return"Uint16Array"}else if(1===array.BYTES_PER_ELEMENT&&array instanceof Uint8Array)return"Uint8Array";return null}Float32Array,Uint32Array,Int32Array,Uint8Array;function nextPow2(v){return v+=0===v?1:0,--v,v|=v>>>1,v|=v>>>2,v|=v>>>4,v|=v>>>8,(v|=v>>>16)+1}function isPow2(v){return!(v&v-1||!v)}function log2(v){var r=(v>65535?1:0)<<4,shift=((v>>>=r)>255?1:0)<<3;return r|=shift,r|=shift=((v>>>=shift)>15?1:0)<<2,(r|=shift=((v>>>=shift)>3?1:0)<<1)|(v>>>=shift)>>1}function removeItems(arr,startIdx,removeCount){var i,length=arr.length;if(!(startIdx>=length||0===removeCount)){var len=length-(removeCount=startIdx+removeCount>length?length-startIdx:removeCount);for(i=startIdx;i<len;++i)arr[i]=arr[i+removeCount];arr.length=len}}function sign(n){return 0===n?0:n<0?-1:1}var nextUid=0;function uid(){return++nextUid}var warnings={};function deprecation(version,message,ignoreDepth){if(void 0===ignoreDepth&&(ignoreDepth=3),!warnings[message]){var stack=(new Error).stack;void 0===stack?console.warn("PixiJS Deprecation Warning: ",message+"\nDeprecated since v"+version):(stack=stack.split("\n").splice(ignoreDepth).join("\n"),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",message+"\nDeprecated since v"+version),console.warn(stack),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",message+"\nDeprecated since v"+version),console.warn(stack))),warnings[message]=!0}}var ProgramCache={},TextureCache=Object.create(null),BaseTextureCache=Object.create(null);var CanvasRenderTarget=function(){function CanvasRenderTarget(width,height,resolution){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=resolution||settings.RESOLUTION,this.resize(width,height)}return CanvasRenderTarget.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},CanvasRenderTarget.prototype.resize=function(desiredWidth,desiredHeight){this.canvas.width=Math.round(desiredWidth*this.resolution),this.canvas.height=Math.round(desiredHeight*this.resolution)},CanvasRenderTarget.prototype.destroy=function(){this.context=null,this.canvas=null},Object.defineProperty(CanvasRenderTarget.prototype,"width",{get:function(){return this.canvas.width},set:function(val){this.canvas.width=Math.round(val)},enumerable:!1,configurable:!0}),Object.defineProperty(CanvasRenderTarget.prototype,"height",{get:function(){return this.canvas.height},set:function(val){this.canvas.height=Math.round(val)},enumerable:!1,configurable:!0}),CanvasRenderTarget}();var tempAnchor;function getResolutionOfUrl(url,defaultValue){var resolution=settings.RETINA_PREFIX.exec(url);return resolution?parseFloat(resolution[1]):void 0!==defaultValue?defaultValue:1}var SHAPES,PI_2=2*Math.PI,RAD_TO_DEG=180/Math.PI,DEG_TO_RAD=Math.PI/180;!function(SHAPES){SHAPES[SHAPES.POLY=0]="POLY",SHAPES[SHAPES.RECT=1]="RECT",SHAPES[SHAPES.CIRC=2]="CIRC",SHAPES[SHAPES.ELIP=3]="ELIP",SHAPES[SHAPES.RREC=4]="RREC"}(SHAPES||(SHAPES={}));var Point=function(){function Point(x,y){void 0===x&&(x=0),void 0===y&&(y=0),this.x=0,this.y=0,this.x=x,this.y=y}return Point.prototype.clone=function(){return new Point(this.x,this.y)},Point.prototype.copyFrom=function(p){return this.set(p.x,p.y),this},Point.prototype.copyTo=function(p){return p.set(this.x,this.y),p},Point.prototype.equals=function(p){return p.x===this.x&&p.y===this.y},Point.prototype.set=function(x,y){return void 0===x&&(x=0),void 0===y&&(y=x),this.x=x,this.y=y,this},Point.prototype.toString=function(){return"[@pixi/math:Point x="+this.x+" y="+this.y+"]"},Point}(),tempPoints=[new Point,new Point,new Point,new Point],Rectangle=function(){function Rectangle(x,y,width,height){void 0===x&&(x=0),void 0===y&&(y=0),void 0===width&&(width=0),void 0===height&&(height=0),this.x=Number(x),this.y=Number(y),this.width=Number(width),this.height=Number(height),this.type=SHAPES.RECT}return Object.defineProperty(Rectangle.prototype,"left",{get:function(){return this.x},enumerable:!1,configurable:!0}),Object.defineProperty(Rectangle.prototype,"right",{get:function(){return this.x+this.width},enumerable:!1,configurable:!0}),Object.defineProperty(Rectangle.prototype,"top",{get:function(){return this.y},enumerable:!1,configurable:!0}),Object.defineProperty(Rectangle.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!1,configurable:!0}),Object.defineProperty(Rectangle,"EMPTY",{get:function(){return new Rectangle(0,0,0,0)},enumerable:!1,configurable:!0}),Rectangle.prototype.clone=function(){return new Rectangle(this.x,this.y,this.width,this.height)},Rectangle.prototype.copyFrom=function(rectangle){return this.x=rectangle.x,this.y=rectangle.y,this.width=rectangle.width,this.height=rectangle.height,this},Rectangle.prototype.copyTo=function(rectangle){return rectangle.x=this.x,rectangle.y=this.y,rectangle.width=this.width,rectangle.height=this.height,rectangle},Rectangle.prototype.contains=function(x,y){return!(this.width<=0||this.height<=0)&&(x>=this.x&&x<this.x+this.width&&y>=this.y&&y<this.y+this.height)},Rectangle.prototype.intersects=function(other,transform){if(!transform){var x0_1=this.x<other.x?other.x:this.x;if((this.right>other.right?other.right:this.right)<=x0_1)return!1;var y0_1=this.y<other.y?other.y:this.y;return(this.bottom>other.bottom?other.bottom:this.bottom)>y0_1}var x0=this.left,x1=this.right,y0=this.top,y1=this.bottom;if(x1<=x0||y1<=y0)return!1;var lt=tempPoints[0].set(other.left,other.top),lb=tempPoints[1].set(other.left,other.bottom),rt=tempPoints[2].set(other.right,other.top),rb=tempPoints[3].set(other.right,other.bottom);if(rt.x<=lt.x||lb.y<=lt.y)return!1;var s=Math.sign(transform.a*transform.d-transform.b*transform.c);if(0===s)return!1;if(transform.apply(lt,lt),transform.apply(lb,lb),transform.apply(rt,rt),transform.apply(rb,rb),Math.max(lt.x,lb.x,rt.x,rb.x)<=x0||Math.min(lt.x,lb.x,rt.x,rb.x)>=x1||Math.max(lt.y,lb.y,rt.y,rb.y)<=y0||Math.min(lt.y,lb.y,rt.y,rb.y)>=y1)return!1;var nx=s*(lb.y-lt.y),ny=s*(lt.x-lb.x),n00=nx*x0+ny*y0,n10=nx*x1+ny*y0,n01=nx*x0+ny*y1,n11=nx*x1+ny*y1;if(Math.max(n00,n10,n01,n11)<=nx*lt.x+ny*lt.y||Math.min(n00,n10,n01,n11)>=nx*rb.x+ny*rb.y)return!1;var mx=s*(lt.y-rt.y),my=s*(rt.x-lt.x),m00=mx*x0+my*y0,m10=mx*x1+my*y0,m01=mx*x0+my*y1,m11=mx*x1+my*y1;return!(Math.max(m00,m10,m01,m11)<=mx*lt.x+my*lt.y||Math.min(m00,m10,m01,m11)>=mx*rb.x+my*rb.y)},Rectangle.prototype.pad=function(paddingX,paddingY){return void 0===paddingX&&(paddingX=0),void 0===paddingY&&(paddingY=paddingX),this.x-=paddingX,this.y-=paddingY,this.width+=2*paddingX,this.height+=2*paddingY,this},Rectangle.prototype.fit=function(rectangle){var x1=Math.max(this.x,rectangle.x),x2=Math.min(this.x+this.width,rectangle.x+rectangle.width),y1=Math.max(this.y,rectangle.y),y2=Math.min(this.y+this.height,rectangle.y+rectangle.height);return this.x=x1,this.width=Math.max(x2-x1,0),this.y=y1,this.height=Math.max(y2-y1,0),this},Rectangle.prototype.ceil=function(resolution,eps){void 0===resolution&&(resolution=1),void 0===eps&&(eps=.001);var x2=Math.ceil((this.x+this.width-eps)*resolution)/resolution,y2=Math.ceil((this.y+this.height-eps)*resolution)/resolution;return this.x=Math.floor((this.x+eps)*resolution)/resolution,this.y=Math.floor((this.y+eps)*resolution)/resolution,this.width=x2-this.x,this.height=y2-this.y,this},Rectangle.prototype.enlarge=function(rectangle){var x1=Math.min(this.x,rectangle.x),x2=Math.max(this.x+this.width,rectangle.x+rectangle.width),y1=Math.min(this.y,rectangle.y),y2=Math.max(this.y+this.height,rectangle.y+rectangle.height);return this.x=x1,this.width=x2-x1,this.y=y1,this.height=y2-y1,this},Rectangle.prototype.toString=function(){return"[@pixi/math:Rectangle x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+"]"},Rectangle}(),Circle=function(){function Circle(x,y,radius){void 0===x&&(x=0),void 0===y&&(y=0),void 0===radius&&(radius=0),this.x=x,this.y=y,this.radius=radius,this.type=SHAPES.CIRC}return Circle.prototype.clone=function(){return new Circle(this.x,this.y,this.radius)},Circle.prototype.contains=function(x,y){if(this.radius<=0)return!1;var r2=this.radius*this.radius,dx=this.x-x,dy=this.y-y;return(dx*=dx)+(dy*=dy)<=r2},Circle.prototype.getBounds=function(){return new Rectangle(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)},Circle.prototype.toString=function(){return"[@pixi/math:Circle x="+this.x+" y="+this.y+" radius="+this.radius+"]"},Circle}(),Ellipse=function(){function Ellipse(x,y,halfWidth,halfHeight){void 0===x&&(x=0),void 0===y&&(y=0),void 0===halfWidth&&(halfWidth=0),void 0===halfHeight&&(halfHeight=0),this.x=x,this.y=y,this.width=halfWidth,this.height=halfHeight,this.type=SHAPES.ELIP}return Ellipse.prototype.clone=function(){return new Ellipse(this.x,this.y,this.width,this.height)},Ellipse.prototype.contains=function(x,y){if(this.width<=0||this.height<=0)return!1;var normx=(x-this.x)/this.width,normy=(y-this.y)/this.height;return(normx*=normx)+(normy*=normy)<=1},Ellipse.prototype.getBounds=function(){return new Rectangle(this.x-this.width,this.y-this.height,this.width,this.height)},Ellipse.prototype.toString=function(){return"[@pixi/math:Ellipse x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+"]"},Ellipse}(),Polygon=function(){function Polygon(){for(var arguments$1=arguments,points=[],_i=0;_i<arguments.length;_i++)points[_i]=arguments$1[_i];var flat=Array.isArray(points[0])?points[0]:points;if("number"!=typeof flat[0]){for(var p=[],i=0,il=flat.length;i<il;i++)p.push(flat[i].x,flat[i].y);flat=p}this.points=flat,this.type=SHAPES.POLY,this.closeStroke=!0}return Polygon.prototype.clone=function(){var polygon=new Polygon(this.points.slice());return polygon.closeStroke=this.closeStroke,polygon},Polygon.prototype.contains=function(x,y){for(var inside=!1,length=this.points.length/2,i=0,j=length-1;i<length;j=i++){var xi=this.points[2*i],yi=this.points[2*i+1],xj=this.points[2*j],yj=this.points[2*j+1];yi>y!=yj>y&&x<(y-yi)/(yj-yi)*(xj-xi)+xi&&(inside=!inside)}return inside},Polygon.prototype.toString=function(){return"[@pixi/math:PolygoncloseStroke="+this.closeStroke+"points="+this.points.reduce((function(pointsDesc,currentPoint){return pointsDesc+", "+currentPoint}),"")+"]"},Polygon}(),RoundedRectangle=function(){function RoundedRectangle(x,y,width,height,radius){void 0===x&&(x=0),void 0===y&&(y=0),void 0===width&&(width=0),void 0===height&&(height=0),void 0===radius&&(radius=20),this.x=x,this.y=y,this.width=width,this.height=height,this.radius=radius,this.type=SHAPES.RREC}return RoundedRectangle.prototype.clone=function(){return new RoundedRectangle(this.x,this.y,this.width,this.height,this.radius)},RoundedRectangle.prototype.contains=function(x,y){if(this.width<=0||this.height<=0)return!1;if(x>=this.x&&x<=this.x+this.width&&y>=this.y&&y<=this.y+this.height){var radius=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(y>=this.y+radius&&y<=this.y+this.height-radius||x>=this.x+radius&&x<=this.x+this.width-radius)return!0;var dx=x-(this.x+radius),dy=y-(this.y+radius),radius2=radius*radius;if(dx*dx+dy*dy<=radius2)return!0;if((dx=x-(this.x+this.width-radius))*dx+dy*dy<=radius2)return!0;if(dx*dx+(dy=y-(this.y+this.height-radius))*dy<=radius2)return!0;if((dx=x-(this.x+radius))*dx+dy*dy<=radius2)return!0}return!1},RoundedRectangle.prototype.toString=function(){return"[@pixi/math:RoundedRectangle x="+this.x+" y="+this.y+"width="+this.width+" height="+this.height+" radius="+this.radius+"]"},RoundedRectangle}(),ObservablePoint=function(){function ObservablePoint(cb,scope,x,y){void 0===x&&(x=0),void 0===y&&(y=0),this._x=x,this._y=y,this.cb=cb,this.scope=scope}return ObservablePoint.prototype.clone=function(cb,scope){return void 0===cb&&(cb=this.cb),void 0===scope&&(scope=this.scope),new ObservablePoint(cb,scope,this._x,this._y)},ObservablePoint.prototype.set=function(x,y){return void 0===x&&(x=0),void 0===y&&(y=x),this._x===x&&this._y===y||(this._x=x,this._y=y,this.cb.call(this.scope)),this},ObservablePoint.prototype.copyFrom=function(p){return this._x===p.x&&this._y===p.y||(this._x=p.x,this._y=p.y,this.cb.call(this.scope)),this},ObservablePoint.prototype.copyTo=function(p){return p.set(this._x,this._y),p},ObservablePoint.prototype.equals=function(p){return p.x===this._x&&p.y===this._y},ObservablePoint.prototype.toString=function(){return"[@pixi/math:ObservablePoint x=0 y=0 scope="+this.scope+"]"},Object.defineProperty(ObservablePoint.prototype,"x",{get:function(){return this._x},set:function(value){this._x!==value&&(this._x=value,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),Object.defineProperty(ObservablePoint.prototype,"y",{get:function(){return this._y},set:function(value){this._y!==value&&(this._y=value,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),ObservablePoint}(),Matrix=function(){function Matrix(a,b,c,d,tx,ty){void 0===a&&(a=1),void 0===b&&(b=0),void 0===c&&(c=0),void 0===d&&(d=1),void 0===tx&&(tx=0),void 0===ty&&(ty=0),this.array=null,this.a=a,this.b=b,this.c=c,this.d=d,this.tx=tx,this.ty=ty}return Matrix.prototype.fromArray=function(array){this.a=array[0],this.b=array[1],this.c=array[3],this.d=array[4],this.tx=array[2],this.ty=array[5]},Matrix.prototype.set=function(a,b,c,d,tx,ty){return this.a=a,this.b=b,this.c=c,this.d=d,this.tx=tx,this.ty=ty,this},Matrix.prototype.toArray=function(transpose,out){this.array||(this.array=new Float32Array(9));var array=out||this.array;return transpose?(array[0]=this.a,array[1]=this.b,array[2]=0,array[3]=this.c,array[4]=this.d,array[5]=0,array[6]=this.tx,array[7]=this.ty,array[8]=1):(array[0]=this.a,array[1]=this.c,array[2]=this.tx,array[3]=this.b,array[4]=this.d,array[5]=this.ty,array[6]=0,array[7]=0,array[8]=1),array},Matrix.prototype.apply=function(pos,newPos){newPos=newPos||new Point;var x=pos.x,y=pos.y;return newPos.x=this.a*x+this.c*y+this.tx,newPos.y=this.b*x+this.d*y+this.ty,newPos},Matrix.prototype.applyInverse=function(pos,newPos){newPos=newPos||new Point;var id=1/(this.a*this.d+this.c*-this.b),x=pos.x,y=pos.y;return newPos.x=this.d*id*x+-this.c*id*y+(this.ty*this.c-this.tx*this.d)*id,newPos.y=this.a*id*y+-this.b*id*x+(-this.ty*this.a+this.tx*this.b)*id,newPos},Matrix.prototype.translate=function(x,y){return this.tx+=x,this.ty+=y,this},Matrix.prototype.scale=function(x,y){return this.a*=x,this.d*=y,this.c*=x,this.b*=y,this.tx*=x,this.ty*=y,this},Matrix.prototype.rotate=function(angle){var cos=Math.cos(angle),sin=Math.sin(angle),a1=this.a,c1=this.c,tx1=this.tx;return this.a=a1*cos-this.b*sin,this.b=a1*sin+this.b*cos,this.c=c1*cos-this.d*sin,this.d=c1*sin+this.d*cos,this.tx=tx1*cos-this.ty*sin,this.ty=tx1*sin+this.ty*cos,this},Matrix.prototype.append=function(matrix){var a1=this.a,b1=this.b,c1=this.c,d1=this.d;return this.a=matrix.a*a1+matrix.b*c1,this.b=matrix.a*b1+matrix.b*d1,this.c=matrix.c*a1+matrix.d*c1,this.d=matrix.c*b1+matrix.d*d1,this.tx=matrix.tx*a1+matrix.ty*c1+this.tx,this.ty=matrix.tx*b1+matrix.ty*d1+this.ty,this},Matrix.prototype.setTransform=function(x,y,pivotX,pivotY,scaleX,scaleY,rotation,skewX,skewY){return this.a=Math.cos(rotation+skewY)*scaleX,this.b=Math.sin(rotation+skewY)*scaleX,this.c=-Math.sin(rotation-skewX)*scaleY,this.d=Math.cos(rotation-skewX)*scaleY,this.tx=x-(pivotX*this.a+pivotY*this.c),this.ty=y-(pivotX*this.b+pivotY*this.d),this},Matrix.prototype.prepend=function(matrix){var tx1=this.tx;if(1!==matrix.a||0!==matrix.b||0!==matrix.c||1!==matrix.d){var a1=this.a,c1=this.c;this.a=a1*matrix.a+this.b*matrix.c,this.b=a1*matrix.b+this.b*matrix.d,this.c=c1*matrix.a+this.d*matrix.c,this.d=c1*matrix.b+this.d*matrix.d}return this.tx=tx1*matrix.a+this.ty*matrix.c+matrix.tx,this.ty=tx1*matrix.b+this.ty*matrix.d+matrix.ty,this},Matrix.prototype.decompose=function(transform){var a=this.a,b=this.b,c=this.c,d=this.d,pivot=transform.pivot,skewX=-Math.atan2(-c,d),skewY=Math.atan2(b,a),delta=Math.abs(skewX+skewY);return delta<1e-5||Math.abs(PI_2-delta)<1e-5?(transform.rotation=skewY,transform.skew.x=transform.skew.y=0):(transform.rotation=0,transform.skew.x=skewX,transform.skew.y=skewY),transform.scale.x=Math.sqrt(a*a+b*b),transform.scale.y=Math.sqrt(c*c+d*d),transform.position.x=this.tx+(pivot.x*a+pivot.y*c),transform.position.y=this.ty+(pivot.x*b+pivot.y*d),transform},Matrix.prototype.invert=function(){var a1=this.a,b1=this.b,c1=this.c,d1=this.d,tx1=this.tx,n=a1*d1-b1*c1;return this.a=d1/n,this.b=-b1/n,this.c=-c1/n,this.d=a1/n,this.tx=(c1*this.ty-d1*tx1)/n,this.ty=-(a1*this.ty-b1*tx1)/n,this},Matrix.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},Matrix.prototype.clone=function(){var matrix=new Matrix;return matrix.a=this.a,matrix.b=this.b,matrix.c=this.c,matrix.d=this.d,matrix.tx=this.tx,matrix.ty=this.ty,matrix},Matrix.prototype.copyTo=function(matrix){return matrix.a=this.a,matrix.b=this.b,matrix.c=this.c,matrix.d=this.d,matrix.tx=this.tx,matrix.ty=this.ty,matrix},Matrix.prototype.copyFrom=function(matrix){return this.a=matrix.a,this.b=matrix.b,this.c=matrix.c,this.d=matrix.d,this.tx=matrix.tx,this.ty=matrix.ty,this},Matrix.prototype.toString=function(){return"[@pixi/math:Matrix a="+this.a+" b="+this.b+" c="+this.c+" d="+this.d+" tx="+this.tx+" ty="+this.ty+"]"},Object.defineProperty(Matrix,"IDENTITY",{get:function(){return new Matrix},enumerable:!1,configurable:!0}),Object.defineProperty(Matrix,"TEMP_MATRIX",{get:function(){return new Matrix},enumerable:!1,configurable:!0}),Matrix}(),ux=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],uy=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],vx=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],vy=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],rotationCayley=[],rotationMatrices=[],signum=Math.sign;!function(){for(var i=0;i<16;i++){var row=[];rotationCayley.push(row);for(var j=0;j<16;j++)for(var _ux=signum(ux[i]*ux[j]+vx[i]*uy[j]),_uy=signum(uy[i]*ux[j]+vy[i]*uy[j]),_vx=signum(ux[i]*vx[j]+vx[i]*vy[j]),_vy=signum(uy[i]*vx[j]+vy[i]*vy[j]),k=0;k<16;k++)if(ux[k]===_ux&&uy[k]===_uy&&vx[k]===_vx&&vy[k]===_vy){row.push(k);break}}for(i=0;i<16;i++){var mat=new Matrix;mat.set(ux[i],uy[i],vx[i],vy[i],0,0),rotationMatrices.push(mat)}}();var groupD8={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:function(ind){return ux[ind]},uY:function(ind){return uy[ind]},vX:function(ind){return vx[ind]},vY:function(ind){return vy[ind]},inv:function(rotation){return 8&rotation?15&rotation:7&-rotation},add:function(rotationSecond,rotationFirst){return rotationCayley[rotationSecond][rotationFirst]},sub:function(rotationSecond,rotationFirst){return rotationCayley[rotationSecond][groupD8.inv(rotationFirst)]},rotate180:function(rotation){return 4^rotation},isVertical:function(rotation){return 2==(3&rotation)},byDirection:function(dx,dy){return 2*Math.abs(dx)<=Math.abs(dy)?dy>=0?groupD8.S:groupD8.N:2*Math.abs(dy)<=Math.abs(dx)?dx>0?groupD8.E:groupD8.W:dy>0?dx>0?groupD8.SE:groupD8.SW:dx>0?groupD8.NE:groupD8.NW},matrixAppendRotationInv:function(matrix,rotation,tx,ty){void 0===tx&&(tx=0),void 0===ty&&(ty=0);var mat=rotationMatrices[groupD8.inv(rotation)];mat.tx=tx,mat.ty=ty,matrix.append(mat)}},Transform=function(){function Transform(){this.worldTransform=new Matrix,this.localTransform=new Matrix,this.position=new ObservablePoint(this.onChange,this,0,0),this.scale=new ObservablePoint(this.onChange,this,1,1),this.pivot=new ObservablePoint(this.onChange,this,0,0),this.skew=new ObservablePoint(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}return Transform.prototype.onChange=function(){this._localID++},Transform.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++},Transform.prototype.toString=function(){return"[@pixi/math:Transform position=("+this.position.x+", "+this.position.y+") rotation="+this.rotation+" scale=("+this.scale.x+", "+this.scale.y+") skew=("+this.skew.x+", "+this.skew.y+") ]"},Transform.prototype.updateLocalTransform=function(){var lt=this.localTransform;this._localID!==this._currentLocalID&&(lt.a=this._cx*this.scale.x,lt.b=this._sx*this.scale.x,lt.c=this._cy*this.scale.y,lt.d=this._sy*this.scale.y,lt.tx=this.position.x-(this.pivot.x*lt.a+this.pivot.y*lt.c),lt.ty=this.position.y-(this.pivot.x*lt.b+this.pivot.y*lt.d),this._currentLocalID=this._localID,this._parentID=-1)},Transform.prototype.updateTransform=function(parentTransform){var lt=this.localTransform;if(this._localID!==this._currentLocalID&&(lt.a=this._cx*this.scale.x,lt.b=this._sx*this.scale.x,lt.c=this._cy*this.scale.y,lt.d=this._sy*this.scale.y,lt.tx=this.position.x-(this.pivot.x*lt.a+this.pivot.y*lt.c),lt.ty=this.position.y-(this.pivot.x*lt.b+this.pivot.y*lt.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==parentTransform._worldID){var pt=parentTransform.worldTransform,wt=this.worldTransform;wt.a=lt.a*pt.a+lt.b*pt.c,wt.b=lt.a*pt.b+lt.b*pt.d,wt.c=lt.c*pt.a+lt.d*pt.c,wt.d=lt.c*pt.b+lt.d*pt.d,wt.tx=lt.tx*pt.a+lt.ty*pt.c+pt.tx,wt.ty=lt.tx*pt.b+lt.ty*pt.d+pt.ty,this._parentID=parentTransform._worldID,this._worldID++}},Transform.prototype.setFromMatrix=function(matrix){matrix.decompose(this),this._localID++},Object.defineProperty(Transform.prototype,"rotation",{get:function(){return this._rotation},set:function(value){this._rotation!==value&&(this._rotation=value,this.updateSkew())},enumerable:!1,configurable:!0}),Transform.IDENTITY=new Transform,Transform}();settings.SORTABLE_CHILDREN=!1;var Bounds=function(){function Bounds(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}return Bounds.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY},Bounds.prototype.clear=function(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},Bounds.prototype.getRectangle=function(rect){return this.minX>this.maxX||this.minY>this.maxY?Rectangle.EMPTY:((rect=rect||new Rectangle(0,0,1,1)).x=this.minX,rect.y=this.minY,rect.width=this.maxX-this.minX,rect.height=this.maxY-this.minY,rect)},Bounds.prototype.addPoint=function(point){this.minX=Math.min(this.minX,point.x),this.maxX=Math.max(this.maxX,point.x),this.minY=Math.min(this.minY,point.y),this.maxY=Math.max(this.maxY,point.y)},Bounds.prototype.addPointMatrix=function(matrix,point){var a=matrix.a,b=matrix.b,c=matrix.c,d=matrix.d,tx=matrix.tx,ty=matrix.ty,x=a*point.x+c*point.y+tx,y=b*point.x+d*point.y+ty;this.minX=Math.min(this.minX,x),this.maxX=Math.max(this.maxX,x),this.minY=Math.min(this.minY,y),this.maxY=Math.max(this.maxY,y)},Bounds.prototype.addQuad=function(vertices){var minX=this.minX,minY=this.minY,maxX=this.maxX,maxY=this.maxY,x=vertices[0],y=vertices[1];minX=x<minX?x:minX,minY=y<minY?y:minY,maxX=x>maxX?x:maxX,maxY=y>maxY?y:maxY,minX=(x=vertices[2])<minX?x:minX,minY=(y=vertices[3])<minY?y:minY,maxX=x>maxX?x:maxX,maxY=y>maxY?y:maxY,minX=(x=vertices[4])<minX?x:minX,minY=(y=vertices[5])<minY?y:minY,maxX=x>maxX?x:maxX,maxY=y>maxY?y:maxY,minX=(x=vertices[6])<minX?x:minX,minY=(y=vertices[7])<minY?y:minY,maxX=x>maxX?x:maxX,maxY=y>maxY?y:maxY,this.minX=minX,this.minY=minY,this.maxX=maxX,this.maxY=maxY},Bounds.prototype.addFrame=function(transform,x0,y0,x1,y1){this.addFrameMatrix(transform.worldTransform,x0,y0,x1,y1)},Bounds.prototype.addFrameMatrix=function(matrix,x0,y0,x1,y1){var a=matrix.a,b=matrix.b,c=matrix.c,d=matrix.d,tx=matrix.tx,ty=matrix.ty,minX=this.minX,minY=this.minY,maxX=this.maxX,maxY=this.maxY,x=a*x0+c*y0+tx,y=b*x0+d*y0+ty;minX=x<minX?x:minX,minY=y<minY?y:minY,maxX=x>maxX?x:maxX,maxY=y>maxY?y:maxY,minX=(x=a*x1+c*y0+tx)<minX?x:minX,minY=(y=b*x1+d*y0+ty)<minY?y:minY,maxX=x>maxX?x:maxX,maxY=y>maxY?y:maxY,minX=(x=a*x0+c*y1+tx)<minX?x:minX,minY=(y=b*x0+d*y1+ty)<minY?y:minY,maxX=x>maxX?x:maxX,maxY=y>maxY?y:maxY,minX=(x=a*x1+c*y1+tx)<minX?x:minX,minY=(y=b*x1+d*y1+ty)<minY?y:minY,maxX=x>maxX?x:maxX,maxY=y>maxY?y:maxY,this.minX=minX,this.minY=minY,this.maxX=maxX,this.maxY=maxY},Bounds.prototype.addVertexData=function(vertexData,beginOffset,endOffset){for(var minX=this.minX,minY=this.minY,maxX=this.maxX,maxY=this.maxY,i=beginOffset;i<endOffset;i+=2){var x=vertexData[i],y=vertexData[i+1];minX=x<minX?x:minX,minY=y<minY?y:minY,maxX=x>maxX?x:maxX,maxY=y>maxY?y:maxY}this.minX=minX,this.minY=minY,this.maxX=maxX,this.maxY=maxY},Bounds.prototype.addVertices=function(transform,vertices,beginOffset,endOffset){this.addVerticesMatrix(transform.worldTransform,vertices,beginOffset,endOffset)},Bounds.prototype.addVerticesMatrix=function(matrix,vertices,beginOffset,endOffset,padX,padY){void 0===padX&&(padX=0),void 0===padY&&(padY=padX);for(var a=matrix.a,b=matrix.b,c=matrix.c,d=matrix.d,tx=matrix.tx,ty=matrix.ty,minX=this.minX,minY=this.minY,maxX=this.maxX,maxY=this.maxY,i=beginOffset;i<endOffset;i+=2){var rawX=vertices[i],rawY=vertices[i+1],x=a*rawX+c*rawY+tx,y=d*rawY+b*rawX+ty;minX=Math.min(minX,x-padX),maxX=Math.max(maxX,x+padX),minY=Math.min(minY,y-padY),maxY=Math.max(maxY,y+padY)}this.minX=minX,this.minY=minY,this.maxX=maxX,this.maxY=maxY},Bounds.prototype.addBounds=function(bounds){var minX=this.minX,minY=this.minY,maxX=this.maxX,maxY=this.maxY;this.minX=bounds.minX<minX?bounds.minX:minX,this.minY=bounds.minY<minY?bounds.minY:minY,this.maxX=bounds.maxX>maxX?bounds.maxX:maxX,this.maxY=bounds.maxY>maxY?bounds.maxY:maxY},Bounds.prototype.addBoundsMask=function(bounds,mask){var _minX=bounds.minX>mask.minX?bounds.minX:mask.minX,_minY=bounds.minY>mask.minY?bounds.minY:mask.minY,_maxX=bounds.maxX<mask.maxX?bounds.maxX:mask.maxX,_maxY=bounds.maxY<mask.maxY?bounds.maxY:mask.maxY;if(_minX<=_maxX&&_minY<=_maxY){var minX=this.minX,minY=this.minY,maxX=this.maxX,maxY=this.maxY;this.minX=_minX<minX?_minX:minX,this.minY=_minY<minY?_minY:minY,this.maxX=_maxX>maxX?_maxX:maxX,this.maxY=_maxY>maxY?_maxY:maxY}},Bounds.prototype.addBoundsMatrix=function(bounds,matrix){this.addFrameMatrix(matrix,bounds.minX,bounds.minY,bounds.maxX,bounds.maxY)},Bounds.prototype.addBoundsArea=function(bounds,area){var _minX=bounds.minX>area.x?bounds.minX:area.x,_minY=bounds.minY>area.y?bounds.minY:area.y,_maxX=bounds.maxX<area.x+area.width?bounds.maxX:area.x+area.width,_maxY=bounds.maxY<area.y+area.height?bounds.maxY:area.y+area.height;if(_minX<=_maxX&&_minY<=_maxY){var minX=this.minX,minY=this.minY,maxX=this.maxX,maxY=this.maxY;this.minX=_minX<minX?_minX:minX,this.minY=_minY<minY?_minY:minY,this.maxX=_maxX>maxX?_maxX:maxX,this.maxY=_maxY>maxY?_maxY:maxY}},Bounds.prototype.pad=function(paddingX,paddingY){void 0===paddingX&&(paddingX=0),void 0===paddingY&&(paddingY=paddingX),this.isEmpty()||(this.minX-=paddingX,this.maxX+=paddingX,this.minY-=paddingY,this.maxY+=paddingY)},Bounds.prototype.addFramePad=function(x0,y0,x1,y1,padX,padY){x0-=padX,y0-=padY,x1+=padX,y1+=padY,this.minX=this.minX<x0?this.minX:x0,this.maxX=this.maxX>x1?this.maxX:x1,this.minY=this.minY<y0?this.minY:y0,this.maxY=this.maxY>y1?this.maxY:y1},Bounds}(),extendStatics=function(d,b){return extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])},extendStatics(d,b)};function __extends(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}var display_ENV,display_RENDERER_TYPE,display_BUFFER_BITS,display_BLEND_MODES,display_DRAW_MODES,display_FORMATS,display_TARGETS,display_TYPES,display_SAMPLER_TYPES,display_SCALE_MODES,display_WRAP_MODES,display_MIPMAP_MODES,display_ALPHA_MODES,display_CLEAR_MODES,display_GC_MODES,display_PRECISION,display_MASK_TYPES,display_MSAA_QUALITY,display_BUFFER_TYPE,DisplayObject=function(_super){function DisplayObject(){var _this=_super.call(this)||this;return _this.tempDisplayObjectParent=null,_this.transform=new Transform,_this.alpha=1,_this.visible=!0,_this.renderable=!0,_this.cullable=!1,_this.cullArea=null,_this.parent=null,_this.worldAlpha=1,_this._lastSortedIndex=0,_this._zIndex=0,_this.filterArea=null,_this.filters=null,_this._enabledFilters=null,_this._bounds=new Bounds,_this._localBounds=null,_this._boundsID=0,_this._boundsRect=null,_this._localBoundsRect=null,_this._mask=null,_this._maskRefCount=0,_this._destroyed=!1,_this.isSprite=!1,_this.isMask=!1,_this}return __extends(DisplayObject,_super),DisplayObject.mixin=function(source){for(var keys=Object.keys(source),i=0;i<keys.length;++i){var propertyName=keys[i];Object.defineProperty(DisplayObject.prototype,propertyName,Object.getOwnPropertyDescriptor(source,propertyName))}},Object.defineProperty(DisplayObject.prototype,"destroyed",{get:function(){return this._destroyed},enumerable:!1,configurable:!0}),DisplayObject.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)},DisplayObject.prototype.updateTransform=function(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha},DisplayObject.prototype.getBounds=function(skipUpdate,rect){return skipUpdate||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),rect||(this._boundsRect||(this._boundsRect=new Rectangle),rect=this._boundsRect),this._bounds.getRectangle(rect)},DisplayObject.prototype.getLocalBounds=function(rect){rect||(this._localBoundsRect||(this._localBoundsRect=new Rectangle),rect=this._localBoundsRect),this._localBounds||(this._localBounds=new Bounds);var transformRef=this.transform,parentRef=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform;var worldBounds=this._bounds,worldBoundsID=this._boundsID;this._bounds=this._localBounds;var bounds=this.getBounds(!1,rect);return this.parent=parentRef,this.transform=transformRef,this._bounds=worldBounds,this._bounds.updateID+=this._boundsID-worldBoundsID,bounds},DisplayObject.prototype.toGlobal=function(position,point,skipUpdate){return void 0===skipUpdate&&(skipUpdate=!1),skipUpdate||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(position,point)},DisplayObject.prototype.toLocal=function(position,from,point,skipUpdate){return from&&(position=from.toGlobal(position,point,skipUpdate)),skipUpdate||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(position,point)},DisplayObject.prototype.setParent=function(container){if(!container||!container.addChild)throw new Error("setParent: Argument must be a Container");return container.addChild(this),container},DisplayObject.prototype.setTransform=function(x,y,scaleX,scaleY,rotation,skewX,skewY,pivotX,pivotY){return void 0===x&&(x=0),void 0===y&&(y=0),void 0===scaleX&&(scaleX=1),void 0===scaleY&&(scaleY=1),void 0===rotation&&(rotation=0),void 0===skewX&&(skewX=0),void 0===skewY&&(skewY=0),void 0===pivotX&&(pivotX=0),void 0===pivotY&&(pivotY=0),this.position.x=x,this.position.y=y,this.scale.x=scaleX||1,this.scale.y=scaleY||1,this.rotation=rotation,this.skew.x=skewX,this.skew.y=skewY,this.pivot.x=pivotX,this.pivot.y=pivotY,this},DisplayObject.prototype.destroy=function(_options){this.parent&&this.parent.removeChild(this),this.emit("destroyed"),this.removeAllListeners(),this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this._destroyed=!0},Object.defineProperty(DisplayObject.prototype,"_tempDisplayObjectParent",{get:function(){return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new TemporaryDisplayObject),this.tempDisplayObjectParent},enumerable:!1,configurable:!0}),DisplayObject.prototype.enableTempParent=function(){var myParent=this.parent;return this.parent=this._tempDisplayObjectParent,myParent},DisplayObject.prototype.disableTempParent=function(cacheParent){this.parent=cacheParent},Object.defineProperty(DisplayObject.prototype,"x",{get:function(){return this.position.x},set:function(value){this.transform.position.x=value},enumerable:!1,configurable:!0}),Object.defineProperty(DisplayObject.prototype,"y",{get:function(){return this.position.y},set:function(value){this.transform.position.y=value},enumerable:!1,configurable:!0}),Object.defineProperty(DisplayObject.prototype,"worldTransform",{get:function(){return this.transform.worldTransform},enumerable:!1,configurable:!0}),Object.defineProperty(DisplayObject.prototype,"localTransform",{get:function(){return this.transform.localTransform},enumerable:!1,configurable:!0}),Object.defineProperty(DisplayObject.prototype,"position",{get:function(){return this.transform.position},set:function(value){this.transform.position.copyFrom(value)},enumerable:!1,configurable:!0}),Object.defineProperty(DisplayObject.prototype,"scale",{get:function(){return this.transform.scale},set:function(value){this.transform.scale.copyFrom(value)},enumerable:!1,configurable:!0}),Object.defineProperty(DisplayObject.prototype,"pivot",{get:function(){return this.transform.pivot},set:function(value){this.transform.pivot.copyFrom(value)},enumerable:!1,configurable:!0}),Object.defineProperty(DisplayObject.prototype,"skew",{get:function(){return this.transform.skew},set:function(value){this.transform.skew.copyFrom(value)},enumerable:!1,configurable:!0}),Object.defineProperty(DisplayObject.prototype,"rotation",{get:function(){return this.transform.rotation},set:function(value){this.transform.rotation=value},enumerable:!1,configurable:!0}),Object.defineProperty(DisplayObject.prototype,"angle",{get:function(){return this.transform.rotation*RAD_TO_DEG},set:function(value){this.transform.rotation=value*DEG_TO_RAD},enumerable:!1,configurable:!0}),Object.defineProperty(DisplayObject.prototype,"zIndex",{get:function(){return this._zIndex},set:function(value){this._zIndex=value,this.parent&&(this.parent.sortDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(DisplayObject.prototype,"worldVisible",{get:function(){var item=this;do{if(!item.visible)return!1;item=item.parent}while(item);return!0},enumerable:!1,configurable:!0}),Object.defineProperty(DisplayObject.prototype,"mask",{get:function(){return this._mask},set:function(value){if(this._mask!==value){var maskObject;if(this._mask)(maskObject=this._mask.maskObject||this._mask)._maskRefCount--,0===maskObject._maskRefCount&&(maskObject.renderable=!0,maskObject.isMask=!1);if(this._mask=value,this._mask)0===(maskObject=this._mask.maskObject||this._mask)._maskRefCount&&(maskObject.renderable=!1,maskObject.isMask=!0),maskObject._maskRefCount++}},enumerable:!1,configurable:!0}),DisplayObject}(eventemitter3_default()),TemporaryDisplayObject=function(_super){function TemporaryDisplayObject(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.sortDirty=null,_this}return __extends(TemporaryDisplayObject,_super),TemporaryDisplayObject}(DisplayObject);function sortChildren(a,b){return a.zIndex===b.zIndex?a._lastSortedIndex-b._lastSortedIndex:a.zIndex-b.zIndex}DisplayObject.prototype.displayObjectUpdateTransform=DisplayObject.prototype.updateTransform,function(ENV){ENV[ENV.WEBGL_LEGACY=0]="WEBGL_LEGACY",ENV[ENV.WEBGL=1]="WEBGL",ENV[ENV.WEBGL2=2]="WEBGL2"}(display_ENV||(display_ENV={})),function(RENDERER_TYPE){RENDERER_TYPE[RENDERER_TYPE.UNKNOWN=0]="UNKNOWN",RENDERER_TYPE[RENDERER_TYPE.WEBGL=1]="WEBGL",RENDERER_TYPE[RENDERER_TYPE.CANVAS=2]="CANVAS"}(display_RENDERER_TYPE||(display_RENDERER_TYPE={})),function(BUFFER_BITS){BUFFER_BITS[BUFFER_BITS.COLOR=16384]="COLOR",BUFFER_BITS[BUFFER_BITS.DEPTH=256]="DEPTH",BUFFER_BITS[BUFFER_BITS.STENCIL=1024]="STENCIL"}(display_BUFFER_BITS||(display_BUFFER_BITS={})),function(BLEND_MODES){BLEND_MODES[BLEND_MODES.NORMAL=0]="NORMAL",BLEND_MODES[BLEND_MODES.ADD=1]="ADD",BLEND_MODES[BLEND_MODES.MULTIPLY=2]="MULTIPLY",BLEND_MODES[BLEND_MODES.SCREEN=3]="SCREEN",BLEND_MODES[BLEND_MODES.OVERLAY=4]="OVERLAY",BLEND_MODES[BLEND_MODES.DARKEN=5]="DARKEN",BLEND_MODES[BLEND_MODES.LIGHTEN=6]="LIGHTEN",BLEND_MODES[BLEND_MODES.COLOR_DODGE=7]="COLOR_DODGE",BLEND_MODES[BLEND_MODES.COLOR_BURN=8]="COLOR_BURN",BLEND_MODES[BLEND_MODES.HARD_LIGHT=9]="HARD_LIGHT",BLEND_MODES[BLEND_MODES.SOFT_LIGHT=10]="SOFT_LIGHT",BLEND_MODES[BLEND_MODES.DIFFERENCE=11]="DIFFERENCE",BLEND_MODES[BLEND_MODES.EXCLUSION=12]="EXCLUSION",BLEND_MODES[BLEND_MODES.HUE=13]="HUE",BLEND_MODES[BLEND_MODES.SATURATION=14]="SATURATION",BLEND_MODES[BLEND_MODES.COLOR=15]="COLOR",BLEND_MODES[BLEND_MODES.LUMINOSITY=16]="LUMINOSITY",BLEND_MODES[BLEND_MODES.NORMAL_NPM=17]="NORMAL_NPM",BLEND_MODES[BLEND_MODES.ADD_NPM=18]="ADD_NPM",BLEND_MODES[BLEND_MODES.SCREEN_NPM=19]="SCREEN_NPM",BLEND_MODES[BLEND_MODES.NONE=20]="NONE",BLEND_MODES[BLEND_MODES.SRC_OVER=0]="SRC_OVER",BLEND_MODES[BLEND_MODES.SRC_IN=21]="SRC_IN",BLEND_MODES[BLEND_MODES.SRC_OUT=22]="SRC_OUT",BLEND_MODES[BLEND_MODES.SRC_ATOP=23]="SRC_ATOP",BLEND_MODES[BLEND_MODES.DST_OVER=24]="DST_OVER",BLEND_MODES[BLEND_MODES.DST_IN=25]="DST_IN",BLEND_MODES[BLEND_MODES.DST_OUT=26]="DST_OUT",BLEND_MODES[BLEND_MODES.DST_ATOP=27]="DST_ATOP",BLEND_MODES[BLEND_MODES.ERASE=26]="ERASE",BLEND_MODES[BLEND_MODES.SUBTRACT=28]="SUBTRACT",BLEND_MODES[BLEND_MODES.XOR=29]="XOR"}(display_BLEND_MODES||(display_BLEND_MODES={})),function(DRAW_MODES){DRAW_MODES[DRAW_MODES.POINTS=0]="POINTS",DRAW_MODES[DRAW_MODES.LINES=1]="LINES",DRAW_MODES[DRAW_MODES.LINE_LOOP=2]="LINE_LOOP",DRAW_MODES[DRAW_MODES.LINE_STRIP=3]="LINE_STRIP",DRAW_MODES[DRAW_MODES.TRIANGLES=4]="TRIANGLES",DRAW_MODES[DRAW_MODES.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",DRAW_MODES[DRAW_MODES.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(display_DRAW_MODES||(display_DRAW_MODES={})),function(FORMATS){FORMATS[FORMATS.RGBA=6408]="RGBA",FORMATS[FORMATS.RGB=6407]="RGB",FORMATS[FORMATS.RG=33319]="RG",FORMATS[FORMATS.RED=6403]="RED",FORMATS[FORMATS.RGBA_INTEGER=36249]="RGBA_INTEGER",FORMATS[FORMATS.RGB_INTEGER=36248]="RGB_INTEGER",FORMATS[FORMATS.RG_INTEGER=33320]="RG_INTEGER",FORMATS[FORMATS.RED_INTEGER=36244]="RED_INTEGER",FORMATS[FORMATS.ALPHA=6406]="ALPHA",FORMATS[FORMATS.LUMINANCE=6409]="LUMINANCE",FORMATS[FORMATS.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",FORMATS[FORMATS.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",FORMATS[FORMATS.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(display_FORMATS||(display_FORMATS={})),function(TARGETS){TARGETS[TARGETS.TEXTURE_2D=3553]="TEXTURE_2D",TARGETS[TARGETS.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",TARGETS[TARGETS.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",TARGETS[TARGETS.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",TARGETS[TARGETS.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",TARGETS[TARGETS.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",TARGETS[TARGETS.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",TARGETS[TARGETS.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",TARGETS[TARGETS.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(display_TARGETS||(display_TARGETS={})),function(TYPES){TYPES[TYPES.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",TYPES[TYPES.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",TYPES[TYPES.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",TYPES[TYPES.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",TYPES[TYPES.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",TYPES[TYPES.UNSIGNED_INT=5125]="UNSIGNED_INT",TYPES[TYPES.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",TYPES[TYPES.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",TYPES[TYPES.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",TYPES[TYPES.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",TYPES[TYPES.BYTE=5120]="BYTE",TYPES[TYPES.SHORT=5122]="SHORT",TYPES[TYPES.INT=5124]="INT",TYPES[TYPES.FLOAT=5126]="FLOAT",TYPES[TYPES.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",TYPES[TYPES.HALF_FLOAT=36193]="HALF_FLOAT"}(display_TYPES||(display_TYPES={})),function(SAMPLER_TYPES){SAMPLER_TYPES[SAMPLER_TYPES.FLOAT=0]="FLOAT",SAMPLER_TYPES[SAMPLER_TYPES.INT=1]="INT",SAMPLER_TYPES[SAMPLER_TYPES.UINT=2]="UINT"}(display_SAMPLER_TYPES||(display_SAMPLER_TYPES={})),function(SCALE_MODES){SCALE_MODES[SCALE_MODES.NEAREST=0]="NEAREST",SCALE_MODES[SCALE_MODES.LINEAR=1]="LINEAR"}(display_SCALE_MODES||(display_SCALE_MODES={})),function(WRAP_MODES){WRAP_MODES[WRAP_MODES.CLAMP=33071]="CLAMP",WRAP_MODES[WRAP_MODES.REPEAT=10497]="REPEAT",WRAP_MODES[WRAP_MODES.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(display_WRAP_MODES||(display_WRAP_MODES={})),function(MIPMAP_MODES){MIPMAP_MODES[MIPMAP_MODES.OFF=0]="OFF",MIPMAP_MODES[MIPMAP_MODES.POW2=1]="POW2",MIPMAP_MODES[MIPMAP_MODES.ON=2]="ON",MIPMAP_MODES[MIPMAP_MODES.ON_MANUAL=3]="ON_MANUAL"}(display_MIPMAP_MODES||(display_MIPMAP_MODES={})),function(ALPHA_MODES){ALPHA_MODES[ALPHA_MODES.NPM=0]="NPM",ALPHA_MODES[ALPHA_MODES.UNPACK=1]="UNPACK",ALPHA_MODES[ALPHA_MODES.PMA=2]="PMA",ALPHA_MODES[ALPHA_MODES.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",ALPHA_MODES[ALPHA_MODES.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",ALPHA_MODES[ALPHA_MODES.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",ALPHA_MODES[ALPHA_MODES.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA"}(display_ALPHA_MODES||(display_ALPHA_MODES={})),function(CLEAR_MODES){CLEAR_MODES[CLEAR_MODES.NO=0]="NO",CLEAR_MODES[CLEAR_MODES.YES=1]="YES",CLEAR_MODES[CLEAR_MODES.AUTO=2]="AUTO",CLEAR_MODES[CLEAR_MODES.BLEND=0]="BLEND",CLEAR_MODES[CLEAR_MODES.CLEAR=1]="CLEAR",CLEAR_MODES[CLEAR_MODES.BLIT=2]="BLIT"}(display_CLEAR_MODES||(display_CLEAR_MODES={})),function(GC_MODES){GC_MODES[GC_MODES.AUTO=0]="AUTO",GC_MODES[GC_MODES.MANUAL=1]="MANUAL"}(display_GC_MODES||(display_GC_MODES={})),function(PRECISION){PRECISION.LOW="lowp",PRECISION.MEDIUM="mediump",PRECISION.HIGH="highp"}(display_PRECISION||(display_PRECISION={})),function(MASK_TYPES){MASK_TYPES[MASK_TYPES.NONE=0]="NONE",MASK_TYPES[MASK_TYPES.SCISSOR=1]="SCISSOR",MASK_TYPES[MASK_TYPES.STENCIL=2]="STENCIL",MASK_TYPES[MASK_TYPES.SPRITE=3]="SPRITE"}(display_MASK_TYPES||(display_MASK_TYPES={})),function(MSAA_QUALITY){MSAA_QUALITY[MSAA_QUALITY.NONE=0]="NONE",MSAA_QUALITY[MSAA_QUALITY.LOW=2]="LOW",MSAA_QUALITY[MSAA_QUALITY.MEDIUM=4]="MEDIUM",MSAA_QUALITY[MSAA_QUALITY.HIGH=8]="HIGH"}(display_MSAA_QUALITY||(display_MSAA_QUALITY={})),function(BUFFER_TYPE){BUFFER_TYPE[BUFFER_TYPE.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",BUFFER_TYPE[BUFFER_TYPE.ARRAY_BUFFER=34962]="ARRAY_BUFFER",BUFFER_TYPE[BUFFER_TYPE.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER"}(display_BUFFER_TYPE||(display_BUFFER_TYPE={}));var Container=function(_super){function Container(){var _this=_super.call(this)||this;return _this.children=[],_this.sortableChildren=settings.SORTABLE_CHILDREN,_this.sortDirty=!1,_this}return __extends(Container,_super),Container.prototype.onChildrenChange=function(_length){},Container.prototype.addChild=function(){for(var arguments$1=arguments,children=[],_i=0;_i<arguments.length;_i++)children[_i]=arguments$1[_i];if(children.length>1)for(var i=0;i<children.length;i++)this.addChild(children[i]);else{var child=children[0];child.parent&&child.parent.removeChild(child),child.parent=this,this.sortDirty=!0,child.transform._parentID=-1,this.children.push(child),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",child,this,this.children.length-1),child.emit("added",this)}return children[0]},Container.prototype.addChildAt=function(child,index){if(index<0||index>this.children.length)throw new Error(child+"addChildAt: The index "+index+" supplied is out of bounds "+this.children.length);return child.parent&&child.parent.removeChild(child),child.parent=this,this.sortDirty=!0,child.transform._parentID=-1,this.children.splice(index,0,child),this._boundsID++,this.onChildrenChange(index),child.emit("added",this),this.emit("childAdded",child,this,index),child},Container.prototype.swapChildren=function(child,child2){if(child!==child2){var index1=this.getChildIndex(child),index2=this.getChildIndex(child2);this.children[index1]=child2,this.children[index2]=child,this.onChildrenChange(index1<index2?index1:index2)}},Container.prototype.getChildIndex=function(child){var index=this.children.indexOf(child);if(-1===index)throw new Error("The supplied DisplayObject must be a child of the caller");return index},Container.prototype.setChildIndex=function(child,index){if(index<0||index>=this.children.length)throw new Error("The index "+index+" supplied is out of bounds "+this.children.length);var currentIndex=this.getChildIndex(child);removeItems(this.children,currentIndex,1),this.children.splice(index,0,child),this.onChildrenChange(index)},Container.prototype.getChildAt=function(index){if(index<0||index>=this.children.length)throw new Error("getChildAt: Index ("+index+") does not exist.");return this.children[index]},Container.prototype.removeChild=function(){for(var arguments$1=arguments,children=[],_i=0;_i<arguments.length;_i++)children[_i]=arguments$1[_i];if(children.length>1)for(var i=0;i<children.length;i++)this.removeChild(children[i]);else{var child=children[0],index=this.children.indexOf(child);if(-1===index)return null;child.parent=null,child.transform._parentID=-1,removeItems(this.children,index,1),this._boundsID++,this.onChildrenChange(index),child.emit("removed",this),this.emit("childRemoved",child,this,index)}return children[0]},Container.prototype.removeChildAt=function(index){var child=this.getChildAt(index);return child.parent=null,child.transform._parentID=-1,removeItems(this.children,index,1),this._boundsID++,this.onChildrenChange(index),child.emit("removed",this),this.emit("childRemoved",child,this,index),child},Container.prototype.removeChildren=function(beginIndex,endIndex){void 0===beginIndex&&(beginIndex=0),void 0===endIndex&&(endIndex=this.children.length);var removed,begin=beginIndex,range=endIndex-begin;if(range>0&&range<=endIndex){removed=this.children.splice(begin,range);for(var i=0;i<removed.length;++i)removed[i].parent=null,removed[i].transform&&(removed[i].transform._parentID=-1);this._boundsID++,this.onChildrenChange(beginIndex);for(i=0;i<removed.length;++i)removed[i].emit("removed",this),this.emit("childRemoved",removed[i],this,i);return removed}if(0===range&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},Container.prototype.sortChildren=function(){for(var sortRequired=!1,i=0,j=this.children.length;i<j;++i){var child=this.children[i];child._lastSortedIndex=i,sortRequired||0===child.zIndex||(sortRequired=!0)}sortRequired&&this.children.length>1&&this.children.sort(sortChildren),this.sortDirty=!1},Container.prototype.updateTransform=function(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var i=0,j=this.children.length;i<j;++i){var child=this.children[i];child.visible&&child.updateTransform()}},Container.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var i=0;i<this.children.length;i++){var child=this.children[i];if(child.visible&&child.renderable)if(child.calculateBounds(),child._mask){var maskObject=child._mask.maskObject||child._mask;maskObject.calculateBounds(),this._bounds.addBoundsMask(child._bounds,maskObject._bounds)}else child.filterArea?this._bounds.addBoundsArea(child._bounds,child.filterArea):this._bounds.addBounds(child._bounds)}this._bounds.updateID=this._boundsID},Container.prototype.getLocalBounds=function(rect,skipChildrenUpdate){void 0===skipChildrenUpdate&&(skipChildrenUpdate=!1);var result=_super.prototype.getLocalBounds.call(this,rect);if(!skipChildrenUpdate)for(var i=0,j=this.children.length;i<j;++i){var child=this.children[i];child.visible&&child.updateTransform()}return result},Container.prototype._calculateBounds=function(){},Container.prototype._renderWithCulling=function(renderer){var sourceFrame=renderer.renderTexture.sourceFrame;if(sourceFrame.width>0&&sourceFrame.height>0){var bounds,transform;if(this.cullArea?(bounds=this.cullArea,transform=this.worldTransform):this._render!==Container.prototype._render&&(bounds=this.getBounds(!0)),bounds&&sourceFrame.intersects(bounds,transform))this._render(renderer);else if(this.cullArea)return;for(var i=0,j=this.children.length;i<j;++i){var child=this.children[i],childCullable=child.cullable;child.cullable=childCullable||!this.cullArea,child.render(renderer),child.cullable=childCullable}}},Container.prototype.render=function(renderer){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(renderer);else if(this.cullable)this._renderWithCulling(renderer);else{this._render(renderer);for(var i=0,j=this.children.length;i<j;++i)this.children[i].render(renderer)}},Container.prototype.renderAdvanced=function(renderer){var filters=this.filters,mask=this._mask;if(filters){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(var i=0;i<filters.length;i++)filters[i].enabled&&this._enabledFilters.push(filters[i])}var flush=filters&&this._enabledFilters&&this._enabledFilters.length||mask&&(!mask.isMaskData||mask.enabled&&(mask.autoDetect||mask.type!==display_MASK_TYPES.NONE));if(flush&&renderer.batch.flush(),filters&&this._enabledFilters&&this._enabledFilters.length&&renderer.filter.push(this,this._enabledFilters),mask&&renderer.mask.push(this,this._mask),this.cullable)this._renderWithCulling(renderer);else{this._render(renderer);i=0;for(var j=this.children.length;i<j;++i)this.children[i].render(renderer)}flush&&renderer.batch.flush(),mask&&renderer.mask.pop(this),filters&&this._enabledFilters&&this._enabledFilters.length&&renderer.filter.pop()},Container.prototype._render=function(_renderer){},Container.prototype.destroy=function(options){_super.prototype.destroy.call(this),this.sortDirty=!1;var destroyChildren="boolean"==typeof options?options:options&&options.children,oldChildren=this.removeChildren(0,this.children.length);if(destroyChildren)for(var i=0;i<oldChildren.length;++i)oldChildren[i].destroy(options)},Object.defineProperty(Container.prototype,"width",{get:function(){return this.scale.x*this.getLocalBounds().width},set:function(value){var width=this.getLocalBounds().width;this.scale.x=0!==width?value/width:1,this._width=value},enumerable:!1,configurable:!0}),Object.defineProperty(Container.prototype,"height",{get:function(){return this.scale.y*this.getLocalBounds().height},set:function(value){var height=this.getLocalBounds().height;this.scale.y=0!==height?value/height:1,this._height=value},enumerable:!1,configurable:!0}),Container}(DisplayObject);Container.prototype.containerUpdateTransform=Container.prototype.updateTransform;DisplayObject.mixin({accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1});var UPDATE_PRIORITY,AccessibilityManager=function(){function AccessibilityManager(renderer){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(settings_isMobile.tablet||settings_isMobile.phone)&&this.createTouchHook();var div=document.createElement("div");div.style.width="100px",div.style.height="100px",div.style.position="absolute",div.style.top="0px",div.style.left="0px",div.style.zIndex=2..toString(),this.div=div,this.renderer=renderer,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}return Object.defineProperty(AccessibilityManager.prototype,"isActive",{get:function(){return this._isActive},enumerable:!1,configurable:!0}),Object.defineProperty(AccessibilityManager.prototype,"isMobileAccessibility",{get:function(){return this._isMobileAccessibility},enumerable:!1,configurable:!0}),AccessibilityManager.prototype.createTouchHook=function(){var _this=this,hookDiv=document.createElement("button");hookDiv.style.width="1px",hookDiv.style.height="1px",hookDiv.style.position="absolute",hookDiv.style.top="-1000px",hookDiv.style.left="-1000px",hookDiv.style.zIndex=2..toString(),hookDiv.style.backgroundColor="#FF0000",hookDiv.title="select to enable accessibility for this content",hookDiv.addEventListener("focus",(function(){_this._isMobileAccessibility=!0,_this.activate(),_this.destroyTouchHook()})),document.body.appendChild(hookDiv),this._hookDiv=hookDiv},AccessibilityManager.prototype.destroyTouchHook=function(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)},AccessibilityManager.prototype.activate=function(){var _a;this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),null===(_a=this.renderer.view.parentNode)||void 0===_a||_a.appendChild(this.div))},AccessibilityManager.prototype.deactivate=function(){var _a;this._isActive&&!this._isMobileAccessibility&&(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),null===(_a=this.div.parentNode)||void 0===_a||_a.removeChild(this.div))},AccessibilityManager.prototype.updateAccessibleObjects=function(displayObject){if(displayObject.visible&&displayObject.accessibleChildren){displayObject.accessible&&displayObject.interactive&&(displayObject._accessibleActive||this.addChild(displayObject),displayObject.renderId=this.renderId);var children=displayObject.children;if(children)for(var i=0;i<children.length;i++)this.updateAccessibleObjects(children[i])}},AccessibilityManager.prototype.update=function(){var now=performance.now();if(!(settings_isMobile.android.device&&now<this.androidUpdateCount)&&(this.androidUpdateCount=now+this.androidUpdateFrequency,this.renderer.renderingToScreen)){this.renderer._lastObjectRendered&&this.updateAccessibleObjects(this.renderer._lastObjectRendered);var _a=this.renderer.view.getBoundingClientRect(),left=_a.left,top=_a.top,width=_a.width,height=_a.height,_b=this.renderer,viewWidth=_b.width,viewHeight=_b.height,resolution=_b.resolution,sx=width/viewWidth*resolution,sy=height/viewHeight*resolution,div=this.div;div.style.left=left+"px",div.style.top=top+"px",div.style.width=viewWidth+"px",div.style.height=viewHeight+"px";for(var i=0;i<this.children.length;i++){var child=this.children[i];if(child.renderId!==this.renderId)child._accessibleActive=!1,removeItems(this.children,i,1),this.div.removeChild(child._accessibleDiv),this.pool.push(child._accessibleDiv),child._accessibleDiv=null,i--;else{div=child._accessibleDiv;var hitArea=child.hitArea,wt=child.worldTransform;child.hitArea?(div.style.left=(wt.tx+hitArea.x*wt.a)*sx+"px",div.style.top=(wt.ty+hitArea.y*wt.d)*sy+"px",div.style.width=hitArea.width*wt.a*sx+"px",div.style.height=hitArea.height*wt.d*sy+"px"):(hitArea=child.getBounds(),this.capHitArea(hitArea),div.style.left=hitArea.x*sx+"px",div.style.top=hitArea.y*sy+"px",div.style.width=hitArea.width*sx+"px",div.style.height=hitArea.height*sy+"px",div.title!==child.accessibleTitle&&null!==child.accessibleTitle&&(div.title=child.accessibleTitle),div.getAttribute("aria-label")!==child.accessibleHint&&null!==child.accessibleHint&&div.setAttribute("aria-label",child.accessibleHint)),child.accessibleTitle===div.title&&child.tabIndex===div.tabIndex||(div.title=child.accessibleTitle,div.tabIndex=child.tabIndex,this.debug&&this.updateDebugHTML(div))}}this.renderId++}},AccessibilityManager.prototype.updateDebugHTML=function(div){div.innerHTML="type: "+div.type+"</br> title : "+div.title+"</br> tabIndex: "+div.tabIndex},AccessibilityManager.prototype.capHitArea=function(hitArea){hitArea.x<0&&(hitArea.width+=hitArea.x,hitArea.x=0),hitArea.y<0&&(hitArea.height+=hitArea.y,hitArea.y=0);var _a=this.renderer,viewWidth=_a.width,viewHeight=_a.height;hitArea.x+hitArea.width>viewWidth&&(hitArea.width=viewWidth-hitArea.x),hitArea.y+hitArea.height>viewHeight&&(hitArea.height=viewHeight-hitArea.y)},AccessibilityManager.prototype.addChild=function(displayObject){var div=this.pool.pop();div||((div=document.createElement("button")).style.width="100px",div.style.height="100px",div.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",div.style.position="absolute",div.style.zIndex=2..toString(),div.style.borderStyle="none",navigator.userAgent.toLowerCase().indexOf("chrome")>-1?div.setAttribute("aria-live","off"):div.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?div.setAttribute("aria-relevant","additions"):div.setAttribute("aria-relevant","text"),div.addEventListener("click",this._onClick.bind(this)),div.addEventListener("focus",this._onFocus.bind(this)),div.addEventListener("focusout",this._onFocusOut.bind(this))),div.style.pointerEvents=displayObject.accessiblePointerEvents,div.type=displayObject.accessibleType,displayObject.accessibleTitle&&null!==displayObject.accessibleTitle?div.title=displayObject.accessibleTitle:displayObject.accessibleHint&&null!==displayObject.accessibleHint||(div.title="displayObject "+displayObject.tabIndex),displayObject.accessibleHint&&null!==displayObject.accessibleHint&&div.setAttribute("aria-label",displayObject.accessibleHint),this.debug&&this.updateDebugHTML(div),displayObject._accessibleActive=!0,displayObject._accessibleDiv=div,div.displayObject=displayObject,this.children.push(displayObject),this.div.appendChild(displayObject._accessibleDiv),displayObject._accessibleDiv.tabIndex=displayObject.tabIndex},AccessibilityManager.prototype._onClick=function(e){var interactionManager=this.renderer.plugins.interaction,displayObject=e.target.displayObject,eventData=interactionManager.eventData;interactionManager.dispatchEvent(displayObject,"click",eventData),interactionManager.dispatchEvent(displayObject,"pointertap",eventData),interactionManager.dispatchEvent(displayObject,"tap",eventData)},AccessibilityManager.prototype._onFocus=function(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","assertive");var interactionManager=this.renderer.plugins.interaction,displayObject=e.target.displayObject,eventData=interactionManager.eventData;interactionManager.dispatchEvent(displayObject,"mouseover",eventData)},AccessibilityManager.prototype._onFocusOut=function(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","polite");var interactionManager=this.renderer.plugins.interaction,displayObject=e.target.displayObject,eventData=interactionManager.eventData;interactionManager.dispatchEvent(displayObject,"mouseout",eventData)},AccessibilityManager.prototype._onKeyDown=function(e){9===e.keyCode&&this.activate()},AccessibilityManager.prototype._onMouseMove=function(e){0===e.movementX&&0===e.movementY||this.deactivate()},AccessibilityManager.prototype.destroy=function(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null},AccessibilityManager}();settings.TARGET_FPMS=.06,function(UPDATE_PRIORITY){UPDATE_PRIORITY[UPDATE_PRIORITY.INTERACTION=50]="INTERACTION",UPDATE_PRIORITY[UPDATE_PRIORITY.HIGH=25]="HIGH",UPDATE_PRIORITY[UPDATE_PRIORITY.NORMAL=0]="NORMAL",UPDATE_PRIORITY[UPDATE_PRIORITY.LOW=-25]="LOW",UPDATE_PRIORITY[UPDATE_PRIORITY.UTILITY=-50]="UTILITY"}(UPDATE_PRIORITY||(UPDATE_PRIORITY={}));var TickerListener=function(){function TickerListener(fn,context,priority,once){void 0===context&&(context=null),void 0===priority&&(priority=0),void 0===once&&(once=!1),this.next=null,this.previous=null,this._destroyed=!1,this.fn=fn,this.context=context,this.priority=priority,this.once=once}return TickerListener.prototype.match=function(fn,context){return void 0===context&&(context=null),this.fn===fn&&this.context===context},TickerListener.prototype.emit=function(deltaTime){this.fn&&(this.context?this.fn.call(this.context,deltaTime):this.fn(deltaTime));var redirect=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),redirect},TickerListener.prototype.connect=function(previous){this.previous=previous,previous.next&&(previous.next.previous=this),this.next=previous.next,previous.next=this},TickerListener.prototype.destroy=function(hard){void 0===hard&&(hard=!1),this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var redirect=this.next;return this.next=hard?null:redirect,this.previous=null,redirect},TickerListener}(),Ticker=function(){function Ticker(){var _this=this;this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new TickerListener(null,null,1/0),this.deltaMS=1/settings.TARGET_FPMS,this.elapsedMS=1/settings.TARGET_FPMS,this._tick=function(time){_this._requestId=null,_this.started&&(_this.update(time),_this.started&&null===_this._requestId&&_this._head.next&&(_this._requestId=requestAnimationFrame(_this._tick)))}}return Ticker.prototype._requestIfNeeded=function(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))},Ticker.prototype._cancelIfNeeded=function(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)},Ticker.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},Ticker.prototype.add=function(fn,context,priority){return void 0===priority&&(priority=UPDATE_PRIORITY.NORMAL),this._addListener(new TickerListener(fn,context,priority))},Ticker.prototype.addOnce=function(fn,context,priority){return void 0===priority&&(priority=UPDATE_PRIORITY.NORMAL),this._addListener(new TickerListener(fn,context,priority,!0))},Ticker.prototype._addListener=function(listener){var current=this._head.next,previous=this._head;if(current){for(;current;){if(listener.priority>current.priority){listener.connect(previous);break}previous=current,current=current.next}listener.previous||listener.connect(previous)}else listener.connect(previous);return this._startIfPossible(),this},Ticker.prototype.remove=function(fn,context){for(var listener=this._head.next;listener;)listener=listener.match(fn,context)?listener.destroy():listener.next;return this._head.next||this._cancelIfNeeded(),this},Object.defineProperty(Ticker.prototype,"count",{get:function(){if(!this._head)return 0;for(var count=0,current=this._head;current=current.next;)count++;return count},enumerable:!1,configurable:!0}),Ticker.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},Ticker.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},Ticker.prototype.destroy=function(){if(!this._protected){this.stop();for(var listener=this._head.next;listener;)listener=listener.destroy(!0);this._head.destroy(),this._head=null}},Ticker.prototype.update=function(currentTime){var elapsedMS;if(void 0===currentTime&&(currentTime=performance.now()),currentTime>this.lastTime){if((elapsedMS=this.elapsedMS=currentTime-this.lastTime)>this._maxElapsedMS&&(elapsedMS=this._maxElapsedMS),elapsedMS*=this.speed,this._minElapsedMS){var delta=currentTime-this._lastFrame|0;if(delta<this._minElapsedMS)return;this._lastFrame=currentTime-delta%this._minElapsedMS}this.deltaMS=elapsedMS,this.deltaTime=this.deltaMS*settings.TARGET_FPMS;for(var head=this._head,listener=head.next;listener;)listener=listener.emit(this.deltaTime);head.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=currentTime},Object.defineProperty(Ticker.prototype,"FPS",{get:function(){return 1e3/this.elapsedMS},enumerable:!1,configurable:!0}),Object.defineProperty(Ticker.prototype,"minFPS",{get:function(){return 1e3/this._maxElapsedMS},set:function(fps){var minFPS=Math.min(this.maxFPS,fps),minFPMS=Math.min(Math.max(0,minFPS)/1e3,settings.TARGET_FPMS);this._maxElapsedMS=1/minFPMS},enumerable:!1,configurable:!0}),Object.defineProperty(Ticker.prototype,"maxFPS",{get:function(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(fps){if(0===fps)this._minElapsedMS=0;else{var maxFPS=Math.max(this.minFPS,fps);this._minElapsedMS=1/(maxFPS/1e3)}},enumerable:!1,configurable:!0}),Object.defineProperty(Ticker,"shared",{get:function(){if(!Ticker._shared){var shared=Ticker._shared=new Ticker;shared.autoStart=!0,shared._protected=!0}return Ticker._shared},enumerable:!1,configurable:!0}),Object.defineProperty(Ticker,"system",{get:function(){if(!Ticker._system){var system=Ticker._system=new Ticker;system.autoStart=!0,system._protected=!0}return Ticker._system},enumerable:!1,configurable:!0}),Ticker}(),TickerPlugin=function(){function TickerPlugin(){}return TickerPlugin.init=function(options){var _this=this;options=Object.assign({autoStart:!0,sharedTicker:!1},options),Object.defineProperty(this,"ticker",{set:function(ticker){this._ticker&&this._ticker.remove(this.render,this),this._ticker=ticker,ticker&&ticker.add(this.render,this,UPDATE_PRIORITY.LOW)},get:function(){return this._ticker}}),this.stop=function(){_this._ticker.stop()},this.start=function(){_this._ticker.start()},this._ticker=null,this.ticker=options.sharedTicker?Ticker.shared:new Ticker,options.autoStart&&this.start()},TickerPlugin.destroy=function(){if(this._ticker){var oldTicker=this._ticker;this.ticker=null,oldTicker.destroy()}},TickerPlugin}(),InteractionData=function(){function InteractionData(){this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0,this.global=new Point,this.target=null,this.originalEvent=null,this.identifier=null,this.isPrimary=!1,this.button=0,this.buttons=0,this.width=0,this.height=0,this.tiltX=0,this.tiltY=0,this.pointerType=null,this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0}return Object.defineProperty(InteractionData.prototype,"pointerId",{get:function(){return this.identifier},enumerable:!1,configurable:!0}),InteractionData.prototype.getLocalPosition=function(displayObject,point,globalPos){return displayObject.worldTransform.applyInverse(globalPos||this.global,point)},InteractionData.prototype.copyEvent=function(event){"isPrimary"in event&&event.isPrimary&&(this.isPrimary=!0),this.button="button"in event&&event.button;var buttons="buttons"in event&&event.buttons;this.buttons=Number.isInteger(buttons)?buttons:"which"in event&&event.which,this.width="width"in event&&event.width,this.height="height"in event&&event.height,this.tiltX="tiltX"in event&&event.tiltX,this.tiltY="tiltY"in event&&event.tiltY,this.pointerType="pointerType"in event&&event.pointerType,this.pressure="pressure"in event&&event.pressure,this.rotationAngle="rotationAngle"in event&&event.rotationAngle,this.twist="twist"in event&&event.twist||0,this.tangentialPressure="tangentialPressure"in event&&event.tangentialPressure||0},InteractionData.prototype.reset=function(){this.isPrimary=!1},InteractionData}(),interaction_extendStatics=function(d,b){return interaction_extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])},interaction_extendStatics(d,b)};var InteractionEvent=function(){function InteractionEvent(){this.stopped=!1,this.stopsPropagatingAt=null,this.stopPropagationHint=!1,this.target=null,this.currentTarget=null,this.type=null,this.data=null}return InteractionEvent.prototype.stopPropagation=function(){this.stopped=!0,this.stopPropagationHint=!0,this.stopsPropagatingAt=this.currentTarget},InteractionEvent.prototype.reset=function(){this.stopped=!1,this.stopsPropagatingAt=null,this.stopPropagationHint=!1,this.currentTarget=null,this.target=null},InteractionEvent}(),InteractionTrackingData=function(){function InteractionTrackingData(pointerId){this._pointerId=pointerId,this._flags=InteractionTrackingData.FLAGS.NONE}return InteractionTrackingData.prototype._doSet=function(flag,yn){this._flags=yn?this._flags|flag:this._flags&~flag},Object.defineProperty(InteractionTrackingData.prototype,"pointerId",{get:function(){return this._pointerId},enumerable:!1,configurable:!0}),Object.defineProperty(InteractionTrackingData.prototype,"flags",{get:function(){return this._flags},set:function(flags){this._flags=flags},enumerable:!1,configurable:!0}),Object.defineProperty(InteractionTrackingData.prototype,"none",{get:function(){return this._flags===InteractionTrackingData.FLAGS.NONE},enumerable:!1,configurable:!0}),Object.defineProperty(InteractionTrackingData.prototype,"over",{get:function(){return 0!=(this._flags&InteractionTrackingData.FLAGS.OVER)},set:function(yn){this._doSet(InteractionTrackingData.FLAGS.OVER,yn)},enumerable:!1,configurable:!0}),Object.defineProperty(InteractionTrackingData.prototype,"rightDown",{get:function(){return 0!=(this._flags&InteractionTrackingData.FLAGS.RIGHT_DOWN)},set:function(yn){this._doSet(InteractionTrackingData.FLAGS.RIGHT_DOWN,yn)},enumerable:!1,configurable:!0}),Object.defineProperty(InteractionTrackingData.prototype,"leftDown",{get:function(){return 0!=(this._flags&InteractionTrackingData.FLAGS.LEFT_DOWN)},set:function(yn){this._doSet(InteractionTrackingData.FLAGS.LEFT_DOWN,yn)},enumerable:!1,configurable:!0}),InteractionTrackingData.FLAGS=Object.freeze({NONE:0,OVER:1,LEFT_DOWN:2,RIGHT_DOWN:4}),InteractionTrackingData}(),TreeSearch=function(){function TreeSearch(){this._tempPoint=new Point}return TreeSearch.prototype.recursiveFindHit=function(interactionEvent,displayObject,func,hitTest,interactive){if(!displayObject||!displayObject.visible)return!1;var point=interactionEvent.data.global,hit=!1,interactiveParent=interactive=displayObject.interactive||interactive,hitTestChildren=!0;if(displayObject.hitArea?(hitTest&&(displayObject.worldTransform.applyInverse(point,this._tempPoint),displayObject.hitArea.contains(this._tempPoint.x,this._tempPoint.y)?hit=!0:(hitTest=!1,hitTestChildren=!1)),interactiveParent=!1):displayObject._mask&&hitTest&&(displayObject._mask.containsPoint&&displayObject._mask.containsPoint(point)||(hitTest=!1)),hitTestChildren&&displayObject.interactiveChildren&&displayObject.children)for(var children=displayObject.children,i=children.length-1;i>=0;i--){var child=children[i],childHit=this.recursiveFindHit(interactionEvent,child,func,hitTest,interactiveParent);if(childHit){if(!child.parent)continue;interactiveParent=!1,childHit&&(interactionEvent.target&&(hitTest=!1),hit=!0)}}return interactive&&(hitTest&&!interactionEvent.target&&!displayObject.hitArea&&displayObject.containsPoint&&displayObject.containsPoint(point)&&(hit=!0),displayObject.interactive&&(hit&&!interactionEvent.target&&(interactionEvent.target=displayObject),func&&func(interactionEvent,displayObject,!!hit))),hit},TreeSearch.prototype.findHit=function(interactionEvent,displayObject,func,hitTest){this.recursiveFindHit(interactionEvent,displayObject,func,hitTest,!1)},TreeSearch}(),interactiveTarget={interactive:!1,interactiveChildren:!0,hitArea:null,get buttonMode(){return"pointer"===this.cursor},set buttonMode(value){value?this.cursor="pointer":"pointer"===this.cursor&&(this.cursor=null)},cursor:null,get trackedPointers(){return void 0===this._trackedPointers&&(this._trackedPointers={}),this._trackedPointers},_trackedPointers:void 0};DisplayObject.mixin(interactiveTarget);var hitTestEvent={target:null,data:{global:null}},InteractionManager=function(_super){function InteractionManager(renderer,options){var _this=_super.call(this)||this;return options=options||{},_this.renderer=renderer,_this.autoPreventDefault=void 0===options.autoPreventDefault||options.autoPreventDefault,_this.interactionFrequency=options.interactionFrequency||10,_this.mouse=new InteractionData,_this.mouse.identifier=1,_this.mouse.global.set(-999999),_this.activeInteractionData={},_this.activeInteractionData[1]=_this.mouse,_this.interactionDataPool=[],_this.eventData=new InteractionEvent,_this.interactionDOMElement=null,_this.moveWhenInside=!1,_this.eventsAdded=!1,_this.tickerAdded=!1,_this.mouseOverRenderer=!("PointerEvent"in globalThis),_this.supportsTouchEvents="ontouchstart"in globalThis,_this.supportsPointerEvents=!!globalThis.PointerEvent,_this.onPointerUp=_this.onPointerUp.bind(_this),_this.processPointerUp=_this.processPointerUp.bind(_this),_this.onPointerCancel=_this.onPointerCancel.bind(_this),_this.processPointerCancel=_this.processPointerCancel.bind(_this),_this.onPointerDown=_this.onPointerDown.bind(_this),_this.processPointerDown=_this.processPointerDown.bind(_this),_this.onPointerMove=_this.onPointerMove.bind(_this),_this.processPointerMove=_this.processPointerMove.bind(_this),_this.onPointerOut=_this.onPointerOut.bind(_this),_this.processPointerOverOut=_this.processPointerOverOut.bind(_this),_this.onPointerOver=_this.onPointerOver.bind(_this),_this.cursorStyles={default:"inherit",pointer:"pointer"},_this.currentCursorMode=null,_this.cursor=null,_this.resolution=1,_this.delayedEvents=[],_this.search=new TreeSearch,_this._tempDisplayObject=new TemporaryDisplayObject,_this._eventListenerOptions={capture:!0,passive:!1},_this._useSystemTicker=void 0===options.useSystemTicker||options.useSystemTicker,_this.setTargetElement(_this.renderer.view,_this.renderer.resolution),_this}return function(d,b){function __(){this.constructor=d}interaction_extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}(InteractionManager,_super),Object.defineProperty(InteractionManager.prototype,"useSystemTicker",{get:function(){return this._useSystemTicker},set:function(useSystemTicker){this._useSystemTicker=useSystemTicker,useSystemTicker?this.addTickerListener():this.removeTickerListener()},enumerable:!1,configurable:!0}),Object.defineProperty(InteractionManager.prototype,"lastObjectRendered",{get:function(){return this.renderer._lastObjectRendered||this._tempDisplayObject},enumerable:!1,configurable:!0}),InteractionManager.prototype.hitTest=function(globalPoint,root){return hitTestEvent.target=null,hitTestEvent.data.global=globalPoint,root||(root=this.lastObjectRendered),this.processInteractive(hitTestEvent,root,null,!0),hitTestEvent.target},InteractionManager.prototype.setTargetElement=function(element,resolution){void 0===resolution&&(resolution=1),this.removeTickerListener(),this.removeEvents(),this.interactionDOMElement=element,this.resolution=resolution,this.addEvents(),this.addTickerListener()},InteractionManager.prototype.addTickerListener=function(){!this.tickerAdded&&this.interactionDOMElement&&this._useSystemTicker&&(Ticker.system.add(this.tickerUpdate,this,UPDATE_PRIORITY.INTERACTION),this.tickerAdded=!0)},InteractionManager.prototype.removeTickerListener=function(){this.tickerAdded&&(Ticker.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)},InteractionManager.prototype.addEvents=function(){if(!this.eventsAdded&&this.interactionDOMElement){var style=this.interactionDOMElement.style;globalThis.navigator.msPointerEnabled?(style.msContentZooming="none",style.msTouchAction="none"):this.supportsPointerEvents&&(style.touchAction="none"),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.addEventListener("pointerdown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.addEventListener("pointerleave",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.addEventListener("pointerover",this.onPointerOver,this._eventListenerOptions),globalThis.addEventListener("pointercancel",this.onPointerCancel,this._eventListenerOptions),globalThis.addEventListener("pointerup",this.onPointerUp,this._eventListenerOptions)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.addEventListener("mousedown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.addEventListener("mouseout",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.addEventListener("mouseover",this.onPointerOver,this._eventListenerOptions),globalThis.addEventListener("mouseup",this.onPointerUp,this._eventListenerOptions)),this.supportsTouchEvents&&(this.interactionDOMElement.addEventListener("touchstart",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.addEventListener("touchcancel",this.onPointerCancel,this._eventListenerOptions),this.interactionDOMElement.addEventListener("touchend",this.onPointerUp,this._eventListenerOptions),this.interactionDOMElement.addEventListener("touchmove",this.onPointerMove,this._eventListenerOptions)),this.eventsAdded=!0}},InteractionManager.prototype.removeEvents=function(){if(this.eventsAdded&&this.interactionDOMElement){var style=this.interactionDOMElement.style;globalThis.navigator.msPointerEnabled?(style.msContentZooming="",style.msTouchAction=""):this.supportsPointerEvents&&(style.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("pointerdown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("pointerleave",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("pointerover",this.onPointerOver,this._eventListenerOptions),globalThis.removeEventListener("pointercancel",this.onPointerCancel,this._eventListenerOptions),globalThis.removeEventListener("pointerup",this.onPointerUp,this._eventListenerOptions)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("mousedown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("mouseout",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("mouseover",this.onPointerOver,this._eventListenerOptions),globalThis.removeEventListener("mouseup",this.onPointerUp,this._eventListenerOptions)),this.supportsTouchEvents&&(this.interactionDOMElement.removeEventListener("touchstart",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("touchcancel",this.onPointerCancel,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("touchend",this.onPointerUp,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("touchmove",this.onPointerMove,this._eventListenerOptions)),this.interactionDOMElement=null,this.eventsAdded=!1}},InteractionManager.prototype.tickerUpdate=function(deltaTime){this._deltaTime+=deltaTime,this._deltaTime<this.interactionFrequency||(this._deltaTime=0,this.update())},InteractionManager.prototype.update=function(){if(this.interactionDOMElement)if(this._didMove)this._didMove=!1;else{for(var k in this.cursor=null,this.activeInteractionData)if(this.activeInteractionData.hasOwnProperty(k)){var interactionData=this.activeInteractionData[k];if(interactionData.originalEvent&&"touch"!==interactionData.pointerType){var interactionEvent=this.configureInteractionEventForDOMEvent(this.eventData,interactionData.originalEvent,interactionData);this.processInteractive(interactionEvent,this.lastObjectRendered,this.processPointerOverOut,!0)}}this.setCursorMode(this.cursor)}},InteractionManager.prototype.setCursorMode=function(mode){mode=mode||"default";var applyStyles=!0;if(globalThis.OffscreenCanvas&&this.interactionDOMElement instanceof OffscreenCanvas&&(applyStyles=!1),this.currentCursorMode!==mode){this.currentCursorMode=mode;var style=this.cursorStyles[mode];if(style)switch(typeof style){case"string":applyStyles&&(this.interactionDOMElement.style.cursor=style);break;case"function":style(mode);break;case"object":applyStyles&&Object.assign(this.interactionDOMElement.style,style)}else applyStyles&&"string"==typeof mode&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,mode)&&(this.interactionDOMElement.style.cursor=mode)}},InteractionManager.prototype.dispatchEvent=function(displayObject,eventString,eventData){eventData.stopPropagationHint&&displayObject!==eventData.stopsPropagatingAt||(eventData.currentTarget=displayObject,eventData.type=eventString,displayObject.emit(eventString,eventData),displayObject[eventString]&&displayObject[eventString](eventData))},InteractionManager.prototype.delayDispatchEvent=function(displayObject,eventString,eventData){this.delayedEvents.push({displayObject,eventString,eventData})},InteractionManager.prototype.mapPositionToPoint=function(point,x,y){var rect;rect=this.interactionDOMElement.parentElement?this.interactionDOMElement.getBoundingClientRect():{x:0,y:0,width:this.interactionDOMElement.width,height:this.interactionDOMElement.height,left:0,top:0};var resolutionMultiplier=1/this.resolution;point.x=(x-rect.left)*(this.interactionDOMElement.width/rect.width)*resolutionMultiplier,point.y=(y-rect.top)*(this.interactionDOMElement.height/rect.height)*resolutionMultiplier},InteractionManager.prototype.processInteractive=function(interactionEvent,displayObject,func,hitTest){var hit=this.search.findHit(interactionEvent,displayObject,func,hitTest),delayedEvents=this.delayedEvents;if(!delayedEvents.length)return hit;interactionEvent.stopPropagationHint=!1;var delayedLen=delayedEvents.length;this.delayedEvents=[];for(var i=0;i<delayedLen;i++){var _a=delayedEvents[i],displayObject_1=_a.displayObject,eventString=_a.eventString,eventData=_a.eventData;eventData.stopsPropagatingAt===displayObject_1&&(eventData.stopPropagationHint=!0),this.dispatchEvent(displayObject_1,eventString,eventData)}return hit},InteractionManager.prototype.onPointerDown=function(originalEvent){if(!this.supportsTouchEvents||"touch"!==originalEvent.pointerType){var events=this.normalizeToPointerData(originalEvent);if(this.autoPreventDefault&&events[0].isNormalized)(originalEvent.cancelable||!("cancelable"in originalEvent))&&originalEvent.preventDefault();for(var eventLen=events.length,i=0;i<eventLen;i++){var event=events[i],interactionData=this.getInteractionDataForPointerId(event),interactionEvent=this.configureInteractionEventForDOMEvent(this.eventData,event,interactionData);if(interactionEvent.data.originalEvent=originalEvent,this.processInteractive(interactionEvent,this.lastObjectRendered,this.processPointerDown,!0),this.emit("pointerdown",interactionEvent),"touch"===event.pointerType)this.emit("touchstart",interactionEvent);else if("mouse"===event.pointerType||"pen"===event.pointerType){var isRightButton=2===event.button;this.emit(isRightButton?"rightdown":"mousedown",this.eventData)}}}},InteractionManager.prototype.processPointerDown=function(interactionEvent,displayObject,hit){var data=interactionEvent.data,id=interactionEvent.data.identifier;if(hit)if(displayObject.trackedPointers[id]||(displayObject.trackedPointers[id]=new InteractionTrackingData(id)),this.dispatchEvent(displayObject,"pointerdown",interactionEvent),"touch"===data.pointerType)this.dispatchEvent(displayObject,"touchstart",interactionEvent);else if("mouse"===data.pointerType||"pen"===data.pointerType){var isRightButton=2===data.button;isRightButton?displayObject.trackedPointers[id].rightDown=!0:displayObject.trackedPointers[id].leftDown=!0,this.dispatchEvent(displayObject,isRightButton?"rightdown":"mousedown",interactionEvent)}},InteractionManager.prototype.onPointerComplete=function(originalEvent,cancelled,func){for(var events=this.normalizeToPointerData(originalEvent),eventLen=events.length,eventAppend=originalEvent.target!==this.interactionDOMElement?"outside":"",i=0;i<eventLen;i++){var event=events[i],interactionData=this.getInteractionDataForPointerId(event),interactionEvent=this.configureInteractionEventForDOMEvent(this.eventData,event,interactionData);if(interactionEvent.data.originalEvent=originalEvent,this.processInteractive(interactionEvent,this.lastObjectRendered,func,cancelled||!eventAppend),this.emit(cancelled?"pointercancel":"pointerup"+eventAppend,interactionEvent),"mouse"===event.pointerType||"pen"===event.pointerType){var isRightButton=2===event.button;this.emit(isRightButton?"rightup"+eventAppend:"mouseup"+eventAppend,interactionEvent)}else"touch"===event.pointerType&&(this.emit(cancelled?"touchcancel":"touchend"+eventAppend,interactionEvent),this.releaseInteractionDataForPointerId(event.pointerId))}},InteractionManager.prototype.onPointerCancel=function(event){this.supportsTouchEvents&&"touch"===event.pointerType||this.onPointerComplete(event,!0,this.processPointerCancel)},InteractionManager.prototype.processPointerCancel=function(interactionEvent,displayObject){var data=interactionEvent.data,id=interactionEvent.data.identifier;void 0!==displayObject.trackedPointers[id]&&(delete displayObject.trackedPointers[id],this.dispatchEvent(displayObject,"pointercancel",interactionEvent),"touch"===data.pointerType&&this.dispatchEvent(displayObject,"touchcancel",interactionEvent))},InteractionManager.prototype.onPointerUp=function(event){this.supportsTouchEvents&&"touch"===event.pointerType||this.onPointerComplete(event,!1,this.processPointerUp)},InteractionManager.prototype.processPointerUp=function(interactionEvent,displayObject,hit){var data=interactionEvent.data,id=interactionEvent.data.identifier,trackingData=displayObject.trackedPointers[id],isTouch="touch"===data.pointerType,isMouse="mouse"===data.pointerType||"pen"===data.pointerType,isMouseTap=!1;if(isMouse){var isRightButton=2===data.button,flags=InteractionTrackingData.FLAGS,test=isRightButton?flags.RIGHT_DOWN:flags.LEFT_DOWN,isDown=void 0!==trackingData&&trackingData.flags&test;hit?(this.dispatchEvent(displayObject,isRightButton?"rightup":"mouseup",interactionEvent),isDown&&(this.dispatchEvent(displayObject,isRightButton?"rightclick":"click",interactionEvent),isMouseTap=!0)):isDown&&this.dispatchEvent(displayObject,isRightButton?"rightupoutside":"mouseupoutside",interactionEvent),trackingData&&(isRightButton?trackingData.rightDown=!1:trackingData.leftDown=!1)}hit?(this.dispatchEvent(displayObject,"pointerup",interactionEvent),isTouch&&this.dispatchEvent(displayObject,"touchend",interactionEvent),trackingData&&(isMouse&&!isMouseTap||this.dispatchEvent(displayObject,"pointertap",interactionEvent),isTouch&&(this.dispatchEvent(displayObject,"tap",interactionEvent),trackingData.over=!1))):trackingData&&(this.dispatchEvent(displayObject,"pointerupoutside",interactionEvent),isTouch&&this.dispatchEvent(displayObject,"touchendoutside",interactionEvent)),trackingData&&trackingData.none&&delete displayObject.trackedPointers[id]},InteractionManager.prototype.onPointerMove=function(originalEvent){if(!this.supportsTouchEvents||"touch"!==originalEvent.pointerType){var events=this.normalizeToPointerData(originalEvent);"mouse"!==events[0].pointerType&&"pen"!==events[0].pointerType||(this._didMove=!0,this.cursor=null);for(var eventLen=events.length,i=0;i<eventLen;i++){var event=events[i],interactionData=this.getInteractionDataForPointerId(event),interactionEvent=this.configureInteractionEventForDOMEvent(this.eventData,event,interactionData);interactionEvent.data.originalEvent=originalEvent,this.processInteractive(interactionEvent,this.lastObjectRendered,this.processPointerMove,!0),this.emit("pointermove",interactionEvent),"touch"===event.pointerType&&this.emit("touchmove",interactionEvent),"mouse"!==event.pointerType&&"pen"!==event.pointerType||this.emit("mousemove",interactionEvent)}"mouse"===events[0].pointerType&&this.setCursorMode(this.cursor)}},InteractionManager.prototype.processPointerMove=function(interactionEvent,displayObject,hit){var data=interactionEvent.data,isTouch="touch"===data.pointerType,isMouse="mouse"===data.pointerType||"pen"===data.pointerType;isMouse&&this.processPointerOverOut(interactionEvent,displayObject,hit),this.moveWhenInside&&!hit||(this.dispatchEvent(displayObject,"pointermove",interactionEvent),isTouch&&this.dispatchEvent(displayObject,"touchmove",interactionEvent),isMouse&&this.dispatchEvent(displayObject,"mousemove",interactionEvent))},InteractionManager.prototype.onPointerOut=function(originalEvent){if(!this.supportsTouchEvents||"touch"!==originalEvent.pointerType){var event=this.normalizeToPointerData(originalEvent)[0];"mouse"===event.pointerType&&(this.mouseOverRenderer=!1,this.setCursorMode(null));var interactionData=this.getInteractionDataForPointerId(event),interactionEvent=this.configureInteractionEventForDOMEvent(this.eventData,event,interactionData);interactionEvent.data.originalEvent=event,this.processInteractive(interactionEvent,this.lastObjectRendered,this.processPointerOverOut,!1),this.emit("pointerout",interactionEvent),"mouse"===event.pointerType||"pen"===event.pointerType?this.emit("mouseout",interactionEvent):this.releaseInteractionDataForPointerId(interactionData.identifier)}},InteractionManager.prototype.processPointerOverOut=function(interactionEvent,displayObject,hit){var data=interactionEvent.data,id=interactionEvent.data.identifier,isMouse="mouse"===data.pointerType||"pen"===data.pointerType,trackingData=displayObject.trackedPointers[id];hit&&!trackingData&&(trackingData=displayObject.trackedPointers[id]=new InteractionTrackingData(id)),void 0!==trackingData&&(hit&&this.mouseOverRenderer?(trackingData.over||(trackingData.over=!0,this.delayDispatchEvent(displayObject,"pointerover",interactionEvent),isMouse&&this.delayDispatchEvent(displayObject,"mouseover",interactionEvent)),isMouse&&null===this.cursor&&(this.cursor=displayObject.cursor)):trackingData.over&&(trackingData.over=!1,this.dispatchEvent(displayObject,"pointerout",this.eventData),isMouse&&this.dispatchEvent(displayObject,"mouseout",interactionEvent),trackingData.none&&delete displayObject.trackedPointers[id]))},InteractionManager.prototype.onPointerOver=function(originalEvent){var event=this.normalizeToPointerData(originalEvent)[0],interactionData=this.getInteractionDataForPointerId(event),interactionEvent=this.configureInteractionEventForDOMEvent(this.eventData,event,interactionData);interactionEvent.data.originalEvent=event,"mouse"===event.pointerType&&(this.mouseOverRenderer=!0),this.emit("pointerover",interactionEvent),"mouse"!==event.pointerType&&"pen"!==event.pointerType||this.emit("mouseover",interactionEvent)},InteractionManager.prototype.getInteractionDataForPointerId=function(event){var interactionData,pointerId=event.pointerId;return 1===pointerId||"mouse"===event.pointerType?interactionData=this.mouse:this.activeInteractionData[pointerId]?interactionData=this.activeInteractionData[pointerId]:((interactionData=this.interactionDataPool.pop()||new InteractionData).identifier=pointerId,this.activeInteractionData[pointerId]=interactionData),interactionData.copyEvent(event),interactionData},InteractionManager.prototype.releaseInteractionDataForPointerId=function(pointerId){var interactionData=this.activeInteractionData[pointerId];interactionData&&(delete this.activeInteractionData[pointerId],interactionData.reset(),this.interactionDataPool.push(interactionData))},InteractionManager.prototype.configureInteractionEventForDOMEvent=function(interactionEvent,pointerEvent,interactionData){return interactionEvent.data=interactionData,this.mapPositionToPoint(interactionData.global,pointerEvent.clientX,pointerEvent.clientY),"touch"===pointerEvent.pointerType&&(pointerEvent.globalX=interactionData.global.x,pointerEvent.globalY=interactionData.global.y),interactionData.originalEvent=pointerEvent,interactionEvent.reset(),interactionEvent},InteractionManager.prototype.normalizeToPointerData=function(event){var normalizedEvents=[];if(this.supportsTouchEvents&&event instanceof TouchEvent)for(var i=0,li=event.changedTouches.length;i<li;i++){var touch=event.changedTouches[i];void 0===touch.button&&(touch.button=event.touches.length?1:0),void 0===touch.buttons&&(touch.buttons=event.touches.length?1:0),void 0===touch.isPrimary&&(touch.isPrimary=1===event.touches.length&&"touchstart"===event.type),void 0===touch.width&&(touch.width=touch.radiusX||1),void 0===touch.height&&(touch.height=touch.radiusY||1),void 0===touch.tiltX&&(touch.tiltX=0),void 0===touch.tiltY&&(touch.tiltY=0),void 0===touch.pointerType&&(touch.pointerType="touch"),void 0===touch.pointerId&&(touch.pointerId=touch.identifier||0),void 0===touch.pressure&&(touch.pressure=touch.force||.5),void 0===touch.twist&&(touch.twist=0),void 0===touch.tangentialPressure&&(touch.tangentialPressure=0),void 0===touch.layerX&&(touch.layerX=touch.offsetX=touch.clientX),void 0===touch.layerY&&(touch.layerY=touch.offsetY=touch.clientY),touch.isNormalized=!0,normalizedEvents.push(touch)}else if(globalThis.MouseEvent&&(!(event instanceof MouseEvent)||this.supportsPointerEvents&&event instanceof globalThis.PointerEvent))normalizedEvents.push(event);else{var tempEvent=event;void 0===tempEvent.isPrimary&&(tempEvent.isPrimary=!0),void 0===tempEvent.width&&(tempEvent.width=1),void 0===tempEvent.height&&(tempEvent.height=1),void 0===tempEvent.tiltX&&(tempEvent.tiltX=0),void 0===tempEvent.tiltY&&(tempEvent.tiltY=0),void 0===tempEvent.pointerType&&(tempEvent.pointerType="mouse"),void 0===tempEvent.pointerId&&(tempEvent.pointerId=1),void 0===tempEvent.pressure&&(tempEvent.pressure=.5),void 0===tempEvent.twist&&(tempEvent.twist=0),void 0===tempEvent.tangentialPressure&&(tempEvent.tangentialPressure=0),tempEvent.isNormalized=!0,normalizedEvents.push(tempEvent)}return normalizedEvents},InteractionManager.prototype.destroy=function(){this.removeEvents(),this.removeTickerListener(),this.removeAllListeners(),this.renderer=null,this.mouse=null,this.eventData=null,this.interactionDOMElement=null,this.onPointerDown=null,this.processPointerDown=null,this.onPointerUp=null,this.processPointerUp=null,this.onPointerCancel=null,this.processPointerCancel=null,this.onPointerMove=null,this.processPointerMove=null,this.onPointerOut=null,this.processPointerOverOut=null,this.onPointerOver=null,this.search=null},InteractionManager}(eventemitter3_default()),Runner=function(){function Runner(name){this.items=[],this._name=name,this._aliasCount=0}return Runner.prototype.emit=function(a0,a1,a2,a3,a4,a5,a6,a7){if(arguments.length>8)throw new Error("max arguments reached");var _a=this,name=_a.name,items=_a.items;this._aliasCount++;for(var i=0,len=items.length;i<len;i++)items[i][name](a0,a1,a2,a3,a4,a5,a6,a7);return items===this.items&&this._aliasCount--,this},Runner.prototype.ensureNonAliasedItems=function(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))},Runner.prototype.add=function(item){return item[this._name]&&(this.ensureNonAliasedItems(),this.remove(item),this.items.push(item)),this},Runner.prototype.remove=function(item){var index=this.items.indexOf(item);return-1!==index&&(this.ensureNonAliasedItems(),this.items.splice(index,1)),this},Runner.prototype.contains=function(item){return-1!==this.items.indexOf(item)},Runner.prototype.removeAll=function(){return this.ensureNonAliasedItems(),this.items.length=0,this},Runner.prototype.destroy=function(){this.removeAll(),this.items=null,this._name=null},Object.defineProperty(Runner.prototype,"empty",{get:function(){return 0===this.items.length},enumerable:!1,configurable:!0}),Object.defineProperty(Runner.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),Runner}();Object.defineProperties(Runner.prototype,{dispatch:{value:Runner.prototype.emit},run:{value:Runner.prototype.emit}}),settings.PREFER_ENV=settings_isMobile.any?constants_ENV.WEBGL:constants_ENV.WEBGL2,settings.STRICT_TEXTURE_CACHE=!1;var INSTALLED=[];function autoDetectResource(source,options){if(!source)return null;var extension="";if("string"==typeof source){var result=/\.(\w{3,4})(?:$|\?|#)/i.exec(source);result&&(extension=result[1].toLowerCase())}for(var i=INSTALLED.length-1;i>=0;--i){var ResourcePlugin=INSTALLED[i];if(ResourcePlugin.test&&ResourcePlugin.test(source,extension))return new ResourcePlugin(source,options)}throw new Error("Unrecognized source type to auto-detect Resource")}var core_extendStatics=function(d,b){return core_extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])},core_extendStatics(d,b)};function core_extends(d,b){function __(){this.constructor=d}core_extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}var __assign=function(){return __assign=Object.assign||function(t){for(var s,arguments$1=arguments,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments$1[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t},__assign.apply(this,arguments)};var Resource=function(){function Resource(width,height){void 0===width&&(width=0),void 0===height&&(height=0),this._width=width,this._height=height,this.destroyed=!1,this.internal=!1,this.onResize=new Runner("setRealSize"),this.onUpdate=new Runner("update"),this.onError=new Runner("onError")}return Resource.prototype.bind=function(baseTexture){this.onResize.add(baseTexture),this.onUpdate.add(baseTexture),this.onError.add(baseTexture),(this._width||this._height)&&this.onResize.emit(this._width,this._height)},Resource.prototype.unbind=function(baseTexture){this.onResize.remove(baseTexture),this.onUpdate.remove(baseTexture),this.onError.remove(baseTexture)},Resource.prototype.resize=function(width,height){width===this._width&&height===this._height||(this._width=width,this._height=height,this.onResize.emit(width,height))},Object.defineProperty(Resource.prototype,"valid",{get:function(){return!!this._width&&!!this._height},enumerable:!1,configurable:!0}),Resource.prototype.update=function(){this.destroyed||this.onUpdate.emit()},Resource.prototype.load=function(){return Promise.resolve(this)},Object.defineProperty(Resource.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0}),Object.defineProperty(Resource.prototype,"height",{get:function(){return this._height},enumerable:!1,configurable:!0}),Resource.prototype.style=function(_renderer,_baseTexture,_glTexture){return!1},Resource.prototype.dispose=function(){},Resource.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)},Resource.test=function(_source,_extension){return!1},Resource}(),BufferResource=function(_super){function BufferResource(source,options){var _this=this,_a=options||{},width=_a.width,height=_a.height;if(!width||!height)throw new Error("BufferResource width or height invalid");return(_this=_super.call(this,width,height)||this).data=source,_this}return core_extends(BufferResource,_super),BufferResource.prototype.upload=function(renderer,baseTexture,glTexture){var gl=renderer.gl;gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,baseTexture.alphaMode===constants_ALPHA_MODES.UNPACK);var width=baseTexture.realWidth,height=baseTexture.realHeight;return glTexture.width===width&&glTexture.height===height?gl.texSubImage2D(baseTexture.target,0,0,0,width,height,baseTexture.format,glTexture.type,this.data):(glTexture.width=width,glTexture.height=height,gl.texImage2D(baseTexture.target,0,glTexture.internalFormat,width,height,0,baseTexture.format,glTexture.type,this.data)),!0},BufferResource.prototype.dispose=function(){this.data=null},BufferResource.test=function(source){return source instanceof Float32Array||source instanceof Uint8Array||source instanceof Uint32Array},BufferResource}(Resource),defaultBufferOptions={scaleMode:constants_SCALE_MODES.NEAREST,format:constants_FORMATS.RGBA,alphaMode:constants_ALPHA_MODES.NPM},BaseTexture=function(_super){function BaseTexture(resource,options){void 0===resource&&(resource=null),void 0===options&&(options=null);var _this=_super.call(this)||this,alphaMode=(options=options||{}).alphaMode,mipmap=options.mipmap,anisotropicLevel=options.anisotropicLevel,scaleMode=options.scaleMode,width=options.width,height=options.height,wrapMode=options.wrapMode,format=options.format,type=options.type,target=options.target,resolution=options.resolution,resourceOptions=options.resourceOptions;return!resource||resource instanceof Resource||((resource=autoDetectResource(resource,resourceOptions)).internal=!0),_this.resolution=resolution||settings.RESOLUTION,_this.width=Math.round((width||0)*_this.resolution)/_this.resolution,_this.height=Math.round((height||0)*_this.resolution)/_this.resolution,_this._mipmap=void 0!==mipmap?mipmap:settings.MIPMAP_TEXTURES,_this.anisotropicLevel=void 0!==anisotropicLevel?anisotropicLevel:settings.ANISOTROPIC_LEVEL,_this._wrapMode=wrapMode||settings.WRAP_MODE,_this._scaleMode=void 0!==scaleMode?scaleMode:settings.SCALE_MODE,_this.format=format||constants_FORMATS.RGBA,_this.type=type||constants_TYPES.UNSIGNED_BYTE,_this.target=target||constants_TARGETS.TEXTURE_2D,_this.alphaMode=void 0!==alphaMode?alphaMode:constants_ALPHA_MODES.UNPACK,_this.uid=uid(),_this.touched=0,_this.isPowerOfTwo=!1,_this._refreshPOT(),_this._glTextures={},_this.dirtyId=0,_this.dirtyStyleId=0,_this.cacheId=null,_this.valid=width>0&&height>0,_this.textureCacheIds=[],_this.destroyed=!1,_this.resource=null,_this._batchEnabled=0,_this._batchLocation=0,_this.parentTextureArray=null,_this.setResource(resource),_this}return core_extends(BaseTexture,_super),Object.defineProperty(BaseTexture.prototype,"realWidth",{get:function(){return Math.round(this.width*this.resolution)},enumerable:!1,configurable:!0}),Object.defineProperty(BaseTexture.prototype,"realHeight",{get:function(){return Math.round(this.height*this.resolution)},enumerable:!1,configurable:!0}),Object.defineProperty(BaseTexture.prototype,"mipmap",{get:function(){return this._mipmap},set:function(value){this._mipmap!==value&&(this._mipmap=value,this.dirtyStyleId++)},enumerable:!1,configurable:!0}),Object.defineProperty(BaseTexture.prototype,"scaleMode",{get:function(){return this._scaleMode},set:function(value){this._scaleMode!==value&&(this._scaleMode=value,this.dirtyStyleId++)},enumerable:!1,configurable:!0}),Object.defineProperty(BaseTexture.prototype,"wrapMode",{get:function(){return this._wrapMode},set:function(value){this._wrapMode!==value&&(this._wrapMode=value,this.dirtyStyleId++)},enumerable:!1,configurable:!0}),BaseTexture.prototype.setStyle=function(scaleMode,mipmap){var dirty;return void 0!==scaleMode&&scaleMode!==this.scaleMode&&(this.scaleMode=scaleMode,dirty=!0),void 0!==mipmap&&mipmap!==this.mipmap&&(this.mipmap=mipmap,dirty=!0),dirty&&this.dirtyStyleId++,this},BaseTexture.prototype.setSize=function(desiredWidth,desiredHeight,resolution){return resolution=resolution||this.resolution,this.setRealSize(desiredWidth*resolution,desiredHeight*resolution,resolution)},BaseTexture.prototype.setRealSize=function(realWidth,realHeight,resolution){return this.resolution=resolution||this.resolution,this.width=Math.round(realWidth)/this.resolution,this.height=Math.round(realHeight)/this.resolution,this._refreshPOT(),this.update(),this},BaseTexture.prototype._refreshPOT=function(){this.isPowerOfTwo=isPow2(this.realWidth)&&isPow2(this.realHeight)},BaseTexture.prototype.setResolution=function(resolution){var oldResolution=this.resolution;return oldResolution===resolution||(this.resolution=resolution,this.valid&&(this.width=Math.round(this.width*oldResolution)/resolution,this.height=Math.round(this.height*oldResolution)/resolution,this.emit("update",this)),this._refreshPOT()),this},BaseTexture.prototype.setResource=function(resource){if(this.resource===resource)return this;if(this.resource)throw new Error("Resource can be set only once");return resource.bind(this),this.resource=resource,this},BaseTexture.prototype.update=function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},BaseTexture.prototype.onError=function(event){this.emit("error",this,event)},BaseTexture.prototype.destroy=function(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete BaseTextureCache[this.cacheId],delete TextureCache[this.cacheId],this.cacheId=null),this.dispose(),BaseTexture.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0},BaseTexture.prototype.dispose=function(){this.emit("dispose",this)},BaseTexture.prototype.castToBaseTexture=function(){return this},BaseTexture.from=function(source,options,strict){void 0===strict&&(strict=settings.STRICT_TEXTURE_CACHE);var isFrame="string"==typeof source,cacheId=null;if(isFrame)cacheId=source;else{if(!source._pixiId){var prefix=options&&options.pixiIdPrefix||"pixiid";source._pixiId=prefix+"_"+uid()}cacheId=source._pixiId}var baseTexture=BaseTextureCache[cacheId];if(isFrame&&strict&&!baseTexture)throw new Error('The cacheId "'+cacheId+'" does not exist in BaseTextureCache.');return baseTexture||((baseTexture=new BaseTexture(source,options)).cacheId=cacheId,BaseTexture.addToCache(baseTexture,cacheId)),baseTexture},BaseTexture.fromBuffer=function(buffer,width,height,options){buffer=buffer||new Float32Array(width*height*4);var resource=new BufferResource(buffer,{width,height}),type=buffer instanceof Float32Array?constants_TYPES.FLOAT:constants_TYPES.UNSIGNED_BYTE;return new BaseTexture(resource,Object.assign(defaultBufferOptions,options||{width,height,type}))},BaseTexture.addToCache=function(baseTexture,id){id&&(-1===baseTexture.textureCacheIds.indexOf(id)&&baseTexture.textureCacheIds.push(id),BaseTextureCache[id]&&console.warn("BaseTexture added to the cache with an id ["+id+"] that already had an entry"),BaseTextureCache[id]=baseTexture)},BaseTexture.removeFromCache=function(baseTexture){if("string"==typeof baseTexture){var baseTextureFromCache=BaseTextureCache[baseTexture];if(baseTextureFromCache){var index=baseTextureFromCache.textureCacheIds.indexOf(baseTexture);return index>-1&&baseTextureFromCache.textureCacheIds.splice(index,1),delete BaseTextureCache[baseTexture],baseTextureFromCache}}else if(baseTexture&&baseTexture.textureCacheIds){for(var i=0;i<baseTexture.textureCacheIds.length;++i)delete BaseTextureCache[baseTexture.textureCacheIds[i]];return baseTexture.textureCacheIds.length=0,baseTexture}return null},BaseTexture._globalBatch=0,BaseTexture}(eventemitter3_default()),AbstractMultiResource=function(_super){function AbstractMultiResource(length,options){var _this=this,_a=options||{},width=_a.width,height=_a.height;(_this=_super.call(this,width,height)||this).items=[],_this.itemDirtyIds=[];for(var i=0;i<length;i++){var partTexture=new BaseTexture;_this.items.push(partTexture),_this.itemDirtyIds.push(-2)}return _this.length=length,_this._load=null,_this.baseTexture=null,_this}return core_extends(AbstractMultiResource,_super),AbstractMultiResource.prototype.initFromArray=function(resources,options){for(var i=0;i<this.length;i++)resources[i]&&(resources[i].castToBaseTexture?this.addBaseTextureAt(resources[i].castToBaseTexture(),i):resources[i]instanceof Resource?this.addResourceAt(resources[i],i):this.addResourceAt(autoDetectResource(resources[i],options),i))},AbstractMultiResource.prototype.dispose=function(){for(var i=0,len=this.length;i<len;i++)this.items[i].destroy();this.items=null,this.itemDirtyIds=null,this._load=null},AbstractMultiResource.prototype.addResourceAt=function(resource,index){if(!this.items[index])throw new Error("Index "+index+" is out of bounds");return resource.valid&&!this.valid&&this.resize(resource.width,resource.height),this.items[index].setResource(resource),this},AbstractMultiResource.prototype.bind=function(baseTexture){if(null!==this.baseTexture)throw new Error("Only one base texture per TextureArray is allowed");_super.prototype.bind.call(this,baseTexture);for(var i=0;i<this.length;i++)this.items[i].parentTextureArray=baseTexture,this.items[i].on("update",baseTexture.update,baseTexture)},AbstractMultiResource.prototype.unbind=function(baseTexture){_super.prototype.unbind.call(this,baseTexture);for(var i=0;i<this.length;i++)this.items[i].parentTextureArray=null,this.items[i].off("update",baseTexture.update,baseTexture)},AbstractMultiResource.prototype.load=function(){var _this=this;if(this._load)return this._load;var promises=this.items.map((function(item){return item.resource})).filter((function(item){return item})).map((function(item){return item.load()}));return this._load=Promise.all(promises).then((function(){var _a=_this.items[0],realWidth=_a.realWidth,realHeight=_a.realHeight;return _this.resize(realWidth,realHeight),Promise.resolve(_this)})),this._load},AbstractMultiResource}(Resource),ArrayResource=function(_super){function ArrayResource(source,options){var urls,length,_this=this,_a=options||{},width=_a.width,height=_a.height;return Array.isArray(source)?(urls=source,length=source.length):length=source,_this=_super.call(this,length,{width,height})||this,urls&&_this.initFromArray(urls,options),_this}return core_extends(ArrayResource,_super),ArrayResource.prototype.addBaseTextureAt=function(baseTexture,index){if(!baseTexture.resource)throw new Error("ArrayResource does not support RenderTexture");return this.addResourceAt(baseTexture.resource,index),this},ArrayResource.prototype.bind=function(baseTexture){_super.prototype.bind.call(this,baseTexture),baseTexture.target=constants_TARGETS.TEXTURE_2D_ARRAY},ArrayResource.prototype.upload=function(renderer,texture,glTexture){var length=this.length,itemDirtyIds=this.itemDirtyIds,items=this.items,gl=renderer.gl;glTexture.dirtyId<0&&gl.texImage3D(gl.TEXTURE_2D_ARRAY,0,glTexture.internalFormat,this._width,this._height,length,0,texture.format,glTexture.type,null);for(var i=0;i<length;i++){var item=items[i];itemDirtyIds[i]<item.dirtyId&&(itemDirtyIds[i]=item.dirtyId,item.valid&&gl.texSubImage3D(gl.TEXTURE_2D_ARRAY,0,0,0,i,item.resource.width,item.resource.height,1,texture.format,glTexture.type,item.resource.source))}return!0},ArrayResource}(AbstractMultiResource),BaseImageResource=function(_super){function BaseImageResource(source){var _this=this,sourceAny=source,width=sourceAny.naturalWidth||sourceAny.videoWidth||sourceAny.width,height=sourceAny.naturalHeight||sourceAny.videoHeight||sourceAny.height;return(_this=_super.call(this,width,height)||this).source=source,_this.noSubImage=!1,_this}return core_extends(BaseImageResource,_super),BaseImageResource.crossOrigin=function(element,url,crossorigin){void 0===crossorigin&&0!==url.indexOf("data:")?element.crossOrigin=function(url$1,loc){if(void 0===loc&&(loc=globalThis.location),0===url$1.indexOf("data:"))return"";loc=loc||globalThis.location,tempAnchor||(tempAnchor=document.createElement("a")),tempAnchor.href=url$1;var parsedUrl=utils_url.parse(tempAnchor.href),samePort=!parsedUrl.port&&""===loc.port||parsedUrl.port===loc.port;return parsedUrl.hostname===loc.hostname&&samePort&&parsedUrl.protocol===loc.protocol?"":"anonymous"}(url):!1!==crossorigin&&(element.crossOrigin="string"==typeof crossorigin?crossorigin:"anonymous")},BaseImageResource.prototype.upload=function(renderer,baseTexture,glTexture,source){var gl=renderer.gl,width=baseTexture.realWidth,height=baseTexture.realHeight;if((source=source||this.source)instanceof HTMLImageElement){if(!source.complete||0===source.naturalWidth)return!1}else if(source instanceof HTMLVideoElement&&source.readyState<=1)return!1;return gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,baseTexture.alphaMode===constants_ALPHA_MODES.UNPACK),this.noSubImage||baseTexture.target!==gl.TEXTURE_2D||glTexture.width!==width||glTexture.height!==height?(glTexture.width=width,glTexture.height=height,gl.texImage2D(baseTexture.target,0,glTexture.internalFormat,baseTexture.format,glTexture.type,source)):gl.texSubImage2D(gl.TEXTURE_2D,0,0,0,baseTexture.format,glTexture.type,source),!0},BaseImageResource.prototype.update=function(){if(!this.destroyed){var source=this.source,width=source.naturalWidth||source.videoWidth||source.width,height=source.naturalHeight||source.videoHeight||source.height;this.resize(width,height),_super.prototype.update.call(this)}},BaseImageResource.prototype.dispose=function(){this.source=null},BaseImageResource}(Resource),CanvasResource=function(_super){function CanvasResource(source){return _super.call(this,source)||this}return core_extends(CanvasResource,_super),CanvasResource.test=function(source){var OffscreenCanvas=globalThis.OffscreenCanvas;return!!(OffscreenCanvas&&source instanceof OffscreenCanvas)||globalThis.HTMLCanvasElement&&source instanceof HTMLCanvasElement},CanvasResource}(BaseImageResource),CubeResource=function(_super){function CubeResource(source,options){var _this=this,_a=options||{},width=_a.width,height=_a.height,autoLoad=_a.autoLoad,linkBaseTexture=_a.linkBaseTexture;if(source&&source.length!==CubeResource.SIDES)throw new Error("Invalid length. Got "+source.length+", expected 6");_this=_super.call(this,6,{width,height})||this;for(var i=0;i<CubeResource.SIDES;i++)_this.items[i].target=constants_TARGETS.TEXTURE_CUBE_MAP_POSITIVE_X+i;return _this.linkBaseTexture=!1!==linkBaseTexture,source&&_this.initFromArray(source,options),!1!==autoLoad&&_this.load(),_this}return core_extends(CubeResource,_super),CubeResource.prototype.bind=function(baseTexture){_super.prototype.bind.call(this,baseTexture),baseTexture.target=constants_TARGETS.TEXTURE_CUBE_MAP},CubeResource.prototype.addBaseTextureAt=function(baseTexture,index,linkBaseTexture){if(void 0===linkBaseTexture&&(linkBaseTexture=this.linkBaseTexture),!this.items[index])throw new Error("Index "+index+" is out of bounds");if(!this.linkBaseTexture||baseTexture.parentTextureArray||Object.keys(baseTexture._glTextures).length>0){if(!baseTexture.resource)throw new Error("CubeResource does not support copying of renderTexture.");this.addResourceAt(baseTexture.resource,index)}else baseTexture.target=constants_TARGETS.TEXTURE_CUBE_MAP_POSITIVE_X+index,baseTexture.parentTextureArray=this.baseTexture,this.items[index]=baseTexture;return baseTexture.valid&&!this.valid&&this.resize(baseTexture.realWidth,baseTexture.realHeight),this.items[index]=baseTexture,this},CubeResource.prototype.upload=function(renderer,_baseTexture,glTexture){for(var dirty=this.itemDirtyIds,i=0;i<CubeResource.SIDES;i++){var side=this.items[i];dirty[i]<side.dirtyId&&(side.valid&&side.resource?(side.resource.upload(renderer,side,glTexture),dirty[i]=side.dirtyId):dirty[i]<-1&&(renderer.gl.texImage2D(side.target,0,glTexture.internalFormat,_baseTexture.realWidth,_baseTexture.realHeight,0,_baseTexture.format,glTexture.type,null),dirty[i]=-1))}return!0},CubeResource.test=function(source){return Array.isArray(source)&&source.length===CubeResource.SIDES},CubeResource.SIDES=6,CubeResource}(AbstractMultiResource),ImageResource=function(_super){function ImageResource(source,options){var _this=this;if(options=options||{},!(source instanceof HTMLImageElement)){var imageElement=new Image;BaseImageResource.crossOrigin(imageElement,source,options.crossorigin),imageElement.src=source,source=imageElement}return _this=_super.call(this,source)||this,!source.complete&&_this._width&&_this._height&&(_this._width=0,_this._height=0),_this.url=source.src,_this._process=null,_this.preserveBitmap=!1,_this.createBitmap=(void 0!==options.createBitmap?options.createBitmap:settings.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,_this.alphaMode="number"==typeof options.alphaMode?options.alphaMode:null,_this.bitmap=null,_this._load=null,!1!==options.autoLoad&&_this.load(),_this}return core_extends(ImageResource,_super),ImageResource.prototype.load=function(createBitmap){var _this=this;return this._load||(void 0!==createBitmap&&(this.createBitmap=createBitmap),this._load=new Promise((function(resolve,reject){var source=_this.source;_this.url=source.src;var completed=function(){_this.destroyed||(source.onload=null,source.onerror=null,_this.resize(source.width,source.height),_this._load=null,_this.createBitmap?resolve(_this.process()):resolve(_this))};source.complete&&source.src?completed():(source.onload=completed,source.onerror=function(event){reject(event),_this.onError.emit(event)})}))),this._load},ImageResource.prototype.process=function(){var _this=this,source=this.source;if(null!==this._process)return this._process;if(null!==this.bitmap||!globalThis.createImageBitmap)return Promise.resolve(this);var createImageBitmap=globalThis.createImageBitmap,cors=!source.crossOrigin||"anonymous"===source.crossOrigin;return this._process=fetch(source.src,{mode:cors?"cors":"no-cors"}).then((function(r){return r.blob()})).then((function(blob){return createImageBitmap(blob,0,0,source.width,source.height,{premultiplyAlpha:_this.alphaMode===constants_ALPHA_MODES.UNPACK?"premultiply":"none"})})).then((function(bitmap){return _this.destroyed?Promise.reject():(_this.bitmap=bitmap,_this.update(),_this._process=null,Promise.resolve(_this))})),this._process},ImageResource.prototype.upload=function(renderer,baseTexture,glTexture){if("number"==typeof this.alphaMode&&(baseTexture.alphaMode=this.alphaMode),!this.createBitmap)return _super.prototype.upload.call(this,renderer,baseTexture,glTexture);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(_super.prototype.upload.call(this,renderer,baseTexture,glTexture,this.bitmap),!this.preserveBitmap){var flag=!0,glTextures=baseTexture._glTextures;for(var key in glTextures){var otherTex=glTextures[key];if(otherTex!==glTexture&&otherTex.dirtyId!==baseTexture.dirtyId){flag=!1;break}}flag&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},ImageResource.prototype.dispose=function(){this.source.onload=null,this.source.onerror=null,_super.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},ImageResource.test=function(source){return"string"==typeof source||source instanceof HTMLImageElement},ImageResource}(BaseImageResource),SVGResource=function(_super){function SVGResource(sourceBase64,options){var _this=this;return options=options||{},(_this=_super.call(this,document.createElement("canvas"))||this)._width=0,_this._height=0,_this.svg=sourceBase64,_this.scale=options.scale||1,_this._overrideWidth=options.width,_this._overrideHeight=options.height,_this._resolve=null,_this._crossorigin=options.crossorigin,_this._load=null,!1!==options.autoLoad&&_this.load(),_this}return core_extends(SVGResource,_super),SVGResource.prototype.load=function(){var _this=this;return this._load||(this._load=new Promise((function(resolve){if(_this._resolve=function(){_this.resize(_this.source.width,_this.source.height),resolve(_this)},SVGResource.SVG_XML.test(_this.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");_this.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(_this.svg)))}_this._loadSvg()}))),this._load},SVGResource.prototype._loadSvg=function(){var _this=this,tempImage=new Image;BaseImageResource.crossOrigin(tempImage,this.svg,this._crossorigin),tempImage.src=this.svg,tempImage.onerror=function(event){_this._resolve&&(tempImage.onerror=null,_this.onError.emit(event))},tempImage.onload=function(){if(_this._resolve){var svgWidth=tempImage.width,svgHeight=tempImage.height;if(!svgWidth||!svgHeight)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");var width=svgWidth*_this.scale,height=svgHeight*_this.scale;(_this._overrideWidth||_this._overrideHeight)&&(width=_this._overrideWidth||_this._overrideHeight/svgHeight*svgWidth,height=_this._overrideHeight||_this._overrideWidth/svgWidth*svgHeight),width=Math.round(width),height=Math.round(height);var canvas=_this.source;canvas.width=width,canvas.height=height,canvas._pixiId="canvas_"+uid(),canvas.getContext("2d").drawImage(tempImage,0,0,svgWidth,svgHeight,0,0,width,height),_this._resolve(),_this._resolve=null}}},SVGResource.getSize=function(svgString){var sizeMatch=SVGResource.SVG_SIZE.exec(svgString),size={};return sizeMatch&&(size[sizeMatch[1]]=Math.round(parseFloat(sizeMatch[3])),size[sizeMatch[5]]=Math.round(parseFloat(sizeMatch[7]))),size},SVGResource.prototype.dispose=function(){_super.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},SVGResource.test=function(source,extension){return"svg"===extension||"string"==typeof source&&/^data:image\/svg\+xml(;(charset=utf8|utf8))?;base64/.test(source)||"string"==typeof source&&SVGResource.SVG_XML.test(source)},SVGResource.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m,SVGResource.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i,SVGResource}(BaseImageResource),VideoResource=function(_super){function VideoResource(source,options){var _this=this;if(options=options||{},!(source instanceof HTMLVideoElement)){var videoElement=document.createElement("video");videoElement.setAttribute("preload","auto"),videoElement.setAttribute("webkit-playsinline",""),videoElement.setAttribute("playsinline",""),"string"==typeof source&&(source=[source]);var firstSrc=source[0].src||source[0];BaseImageResource.crossOrigin(videoElement,firstSrc,options.crossorigin);for(var i=0;i<source.length;++i){var sourceElement=document.createElement("source"),_a=source[i],src=_a.src,mime=_a.mime,baseSrc=(src=src||source[i]).split("?").shift().toLowerCase(),ext=baseSrc.slice(baseSrc.lastIndexOf(".")+1);mime=mime||VideoResource.MIME_TYPES[ext]||"video/"+ext,sourceElement.src=src,sourceElement.type=mime,videoElement.appendChild(sourceElement)}source=videoElement}return(_this=_super.call(this,source)||this).noSubImage=!0,_this._autoUpdate=!0,_this._isConnectedToTicker=!1,_this._updateFPS=options.updateFPS||0,_this._msToNextUpdate=0,_this.autoPlay=!1!==options.autoPlay,_this._load=null,_this._resolve=null,_this._onCanPlay=_this._onCanPlay.bind(_this),_this._onError=_this._onError.bind(_this),!1!==options.autoLoad&&_this.load(),_this}return core_extends(VideoResource,_super),VideoResource.prototype.update=function(_deltaTime){if(!this.destroyed){var elapsedMS=Ticker.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-elapsedMS),(!this._updateFPS||this._msToNextUpdate<=0)&&(_super.prototype.update.call(this),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},VideoResource.prototype.load=function(){var _this=this;if(this._load)return this._load;var source=this.source;return(source.readyState===source.HAVE_ENOUGH_DATA||source.readyState===source.HAVE_FUTURE_DATA)&&source.width&&source.height&&(source.complete=!0),source.addEventListener("play",this._onPlayStart.bind(this)),source.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(source.addEventListener("canplay",this._onCanPlay),source.addEventListener("canplaythrough",this._onCanPlay),source.addEventListener("error",this._onError,!0)),this._load=new Promise((function(resolve){_this.valid?resolve(_this):(_this._resolve=resolve,source.load())})),this._load},VideoResource.prototype._onError=function(event){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(event)},VideoResource.prototype._isSourcePlaying=function(){var source=this.source;return source.currentTime>0&&!1===source.paused&&!1===source.ended&&source.readyState>2},VideoResource.prototype._isSourceReady=function(){var source=this.source;return 3===source.readyState||4===source.readyState},VideoResource.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(Ticker.shared.add(this.update,this),this._isConnectedToTicker=!0)},VideoResource.prototype._onPlayStop=function(){this._isConnectedToTicker&&(Ticker.shared.remove(this.update,this),this._isConnectedToTicker=!1)},VideoResource.prototype._onCanPlay=function(){var source=this.source;source.removeEventListener("canplay",this._onCanPlay),source.removeEventListener("canplaythrough",this._onCanPlay);var valid=this.valid;this.resize(source.videoWidth,source.videoHeight),!valid&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&source.play()},VideoResource.prototype.dispose=function(){this._isConnectedToTicker&&(Ticker.shared.remove(this.update,this),this._isConnectedToTicker=!1);var source=this.source;source&&(source.removeEventListener("error",this._onError,!0),source.pause(),source.src="",source.load()),_super.prototype.dispose.call(this)},Object.defineProperty(VideoResource.prototype,"autoUpdate",{get:function(){return this._autoUpdate},set:function(value){value!==this._autoUpdate&&(this._autoUpdate=value,!this._autoUpdate&&this._isConnectedToTicker?(Ticker.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(Ticker.shared.add(this.update,this),this._isConnectedToTicker=!0))},enumerable:!1,configurable:!0}),Object.defineProperty(VideoResource.prototype,"updateFPS",{get:function(){return this._updateFPS},set:function(value){value!==this._updateFPS&&(this._updateFPS=value)},enumerable:!1,configurable:!0}),VideoResource.test=function(source,extension){return globalThis.HTMLVideoElement&&source instanceof HTMLVideoElement||VideoResource.TYPES.indexOf(extension)>-1},VideoResource.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],VideoResource.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"},VideoResource}(BaseImageResource),ImageBitmapResource=function(_super){function ImageBitmapResource(source){return _super.call(this,source)||this}return core_extends(ImageBitmapResource,_super),ImageBitmapResource.test=function(source){return!!globalThis.createImageBitmap&&source instanceof ImageBitmap},ImageBitmapResource}(BaseImageResource);INSTALLED.push(ImageResource,ImageBitmapResource,CanvasResource,VideoResource,SVGResource,BufferResource,CubeResource,ArrayResource);var _resources={__proto__:null,Resource,BaseImageResource,INSTALLED,autoDetectResource,AbstractMultiResource,ArrayResource,BufferResource,CanvasResource,CubeResource,ImageResource,SVGResource,VideoResource,ImageBitmapResource},DepthResource=function(_super){function DepthResource(){return null!==_super&&_super.apply(this,arguments)||this}return core_extends(DepthResource,_super),DepthResource.prototype.upload=function(renderer,baseTexture,glTexture){var gl=renderer.gl;gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,baseTexture.alphaMode===constants_ALPHA_MODES.UNPACK);var width=baseTexture.realWidth,height=baseTexture.realHeight;return glTexture.width===width&&glTexture.height===height?gl.texSubImage2D(baseTexture.target,0,0,0,width,height,baseTexture.format,glTexture.type,this.data):(glTexture.width=width,glTexture.height=height,gl.texImage2D(baseTexture.target,0,glTexture.internalFormat,width,height,0,baseTexture.format,glTexture.type,this.data)),!0},DepthResource}(BufferResource),Framebuffer=function(){function Framebuffer(width,height){this.width=Math.round(width||100),this.height=Math.round(height||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new Runner("disposeFramebuffer"),this.multisample=constants_MSAA_QUALITY.NONE}return Object.defineProperty(Framebuffer.prototype,"colorTexture",{get:function(){return this.colorTextures[0]},enumerable:!1,configurable:!0}),Framebuffer.prototype.addColorTexture=function(index,texture){return void 0===index&&(index=0),this.colorTextures[index]=texture||new BaseTexture(null,{scaleMode:constants_SCALE_MODES.NEAREST,resolution:1,mipmap:constants_MIPMAP_MODES.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},Framebuffer.prototype.addDepthTexture=function(texture){return this.depthTexture=texture||new BaseTexture(new DepthResource(null,{width:this.width,height:this.height}),{scaleMode:constants_SCALE_MODES.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:constants_MIPMAP_MODES.OFF,format:constants_FORMATS.DEPTH_COMPONENT,type:constants_TYPES.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this},Framebuffer.prototype.enableDepth=function(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},Framebuffer.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},Framebuffer.prototype.resize=function(width,height){if(width=Math.round(width),height=Math.round(height),width!==this.width||height!==this.height){this.width=width,this.height=height,this.dirtyId++,this.dirtySize++;for(var i=0;i<this.colorTextures.length;i++){var texture=this.colorTextures[i],resolution=texture.resolution;texture.setSize(width/resolution,height/resolution)}if(this.depthTexture){resolution=this.depthTexture.resolution;this.depthTexture.setSize(width/resolution,height/resolution)}}},Framebuffer.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},Framebuffer.prototype.destroyDepthTexture=function(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)},Framebuffer}(),BaseRenderTexture=function(_super){function BaseRenderTexture(options){void 0===options&&(options={});var _this=this;if("number"==typeof options){var width=arguments[0],height=arguments[1],scaleMode=arguments[2],resolution=arguments[3];options={width,height,scaleMode,resolution}}return options.width=options.width||100,options.height=options.height||100,options.multisample=void 0!==options.multisample?options.multisample:constants_MSAA_QUALITY.NONE,(_this=_super.call(this,null,options)||this).mipmap=constants_MIPMAP_MODES.OFF,_this.valid=!0,_this.clearColor=[0,0,0,0],_this.framebuffer=new Framebuffer(_this.realWidth,_this.realHeight).addColorTexture(0,_this),_this.framebuffer.multisample=options.multisample,_this.maskStack=[],_this.filterStack=[{}],_this}return core_extends(BaseRenderTexture,_super),BaseRenderTexture.prototype.resize=function(desiredWidth,desiredHeight){this.framebuffer.resize(desiredWidth*this.resolution,desiredHeight*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)},BaseRenderTexture.prototype.dispose=function(){this.framebuffer.dispose(),_super.prototype.dispose.call(this)},BaseRenderTexture.prototype.destroy=function(){_super.prototype.destroy.call(this),this.framebuffer.destroyDepthTexture(),this.framebuffer=null},BaseRenderTexture}(BaseTexture),TextureUvs=function(){function TextureUvs(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}return TextureUvs.prototype.set=function(frame,baseFrame,rotate){var tw=baseFrame.width,th=baseFrame.height;if(rotate){var w2=frame.width/2/tw,h2=frame.height/2/th,cX=frame.x/tw+w2,cY=frame.y/th+h2;rotate=groupD8.add(rotate,groupD8.NW),this.x0=cX+w2*groupD8.uX(rotate),this.y0=cY+h2*groupD8.uY(rotate),rotate=groupD8.add(rotate,2),this.x1=cX+w2*groupD8.uX(rotate),this.y1=cY+h2*groupD8.uY(rotate),rotate=groupD8.add(rotate,2),this.x2=cX+w2*groupD8.uX(rotate),this.y2=cY+h2*groupD8.uY(rotate),rotate=groupD8.add(rotate,2),this.x3=cX+w2*groupD8.uX(rotate),this.y3=cY+h2*groupD8.uY(rotate)}else this.x0=frame.x/tw,this.y0=frame.y/th,this.x1=(frame.x+frame.width)/tw,this.y1=frame.y/th,this.x2=(frame.x+frame.width)/tw,this.y2=(frame.y+frame.height)/th,this.x3=frame.x/tw,this.y3=(frame.y+frame.height)/th;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3},TextureUvs.prototype.toString=function(){return"[@pixi/core:TextureUvs x0="+this.x0+" y0="+this.y0+" x1="+this.x1+" y1="+this.y1+" x2="+this.x2+" y2="+this.y2+" x3="+this.x3+" y3="+this.y3+"]"},TextureUvs}(),DEFAULT_UVS=new TextureUvs,Texture=function(_super){function Texture(baseTexture,frame,orig,trim,rotate,anchor){var _this=_super.call(this)||this;if(_this.noFrame=!1,frame||(_this.noFrame=!0,frame=new Rectangle(0,0,1,1)),baseTexture instanceof Texture&&(baseTexture=baseTexture.baseTexture),_this.baseTexture=baseTexture,_this._frame=frame,_this.trim=trim,_this.valid=!1,_this._uvs=DEFAULT_UVS,_this.uvMatrix=null,_this.orig=orig||frame,_this._rotate=Number(rotate||0),!0===rotate)_this._rotate=2;else if(_this._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");return _this.defaultAnchor=anchor?new Point(anchor.x,anchor.y):new Point(0,0),_this._updateID=0,_this.textureCacheIds=[],baseTexture.valid?_this.noFrame?baseTexture.valid&&_this.onBaseTextureUpdated(baseTexture):_this.frame=frame:baseTexture.once("loaded",_this.onBaseTextureUpdated,_this),_this.noFrame&&baseTexture.on("update",_this.onBaseTextureUpdated,_this),_this}return core_extends(Texture,_super),Texture.prototype.update=function(){this.baseTexture.resource&&this.baseTexture.resource.update()},Texture.prototype.onBaseTextureUpdated=function(baseTexture){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=baseTexture.width,this._frame.height=baseTexture.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)},Texture.prototype.destroy=function(destroyBase){if(this.baseTexture){if(destroyBase){var resource=this.baseTexture.resource;resource&&resource.url&&TextureCache[resource.url]&&Texture.removeFromCache(resource.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,Texture.removeFromCache(this),this.textureCacheIds=null},Texture.prototype.clone=function(){var clonedFrame=this._frame.clone(),clonedOrig=this._frame===this.orig?clonedFrame:this.orig.clone(),clonedTexture=new Texture(this.baseTexture,!this.noFrame&&clonedFrame,clonedOrig,this.trim&&this.trim.clone(),this.rotate,this.defaultAnchor);return this.noFrame&&(clonedTexture._frame=clonedFrame),clonedTexture},Texture.prototype.updateUvs=function(){this._uvs===DEFAULT_UVS&&(this._uvs=new TextureUvs),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},Texture.from=function(source,options,strict){void 0===options&&(options={}),void 0===strict&&(strict=settings.STRICT_TEXTURE_CACHE);var isFrame="string"==typeof source,cacheId=null;if(isFrame)cacheId=source;else if(source instanceof BaseTexture){if(!source.cacheId){var prefix=options&&options.pixiIdPrefix||"pixiid";source.cacheId=prefix+"-"+uid(),BaseTexture.addToCache(source,source.cacheId)}cacheId=source.cacheId}else{if(!source._pixiId){prefix=options&&options.pixiIdPrefix||"pixiid";source._pixiId=prefix+"_"+uid()}cacheId=source._pixiId}var texture=TextureCache[cacheId];if(isFrame&&strict&&!texture)throw new Error('The cacheId "'+cacheId+'" does not exist in TextureCache.');return texture||source instanceof BaseTexture?!texture&&source instanceof BaseTexture&&(texture=new Texture(source),Texture.addToCache(texture,cacheId)):(options.resolution||(options.resolution=getResolutionOfUrl(source)),(texture=new Texture(new BaseTexture(source,options))).baseTexture.cacheId=cacheId,BaseTexture.addToCache(texture.baseTexture,cacheId),Texture.addToCache(texture,cacheId)),texture},Texture.fromURL=function(url,options){var resourceOptions=Object.assign({autoLoad:!1},null==options?void 0:options.resourceOptions),texture=Texture.from(url,Object.assign({resourceOptions},options),!1),resource=texture.baseTexture.resource;return texture.baseTexture.valid?Promise.resolve(texture):resource.load().then((function(){return Promise.resolve(texture)}))},Texture.fromBuffer=function(buffer,width,height,options){return new Texture(BaseTexture.fromBuffer(buffer,width,height,options))},Texture.fromLoader=function(source,imageUrl,name,options){var baseTexture=new BaseTexture(source,Object.assign({scaleMode:settings.SCALE_MODE,resolution:getResolutionOfUrl(imageUrl)},options)),resource=baseTexture.resource;resource instanceof ImageResource&&(resource.url=imageUrl);var texture=new Texture(baseTexture);return name||(name=imageUrl),BaseTexture.addToCache(texture.baseTexture,name),Texture.addToCache(texture,name),name!==imageUrl&&(BaseTexture.addToCache(texture.baseTexture,imageUrl),Texture.addToCache(texture,imageUrl)),texture.baseTexture.valid?Promise.resolve(texture):new Promise((function(resolve){texture.baseTexture.once("loaded",(function(){return resolve(texture)}))}))},Texture.addToCache=function(texture,id){id&&(-1===texture.textureCacheIds.indexOf(id)&&texture.textureCacheIds.push(id),TextureCache[id]&&console.warn("Texture added to the cache with an id ["+id+"] that already had an entry"),TextureCache[id]=texture)},Texture.removeFromCache=function(texture){if("string"==typeof texture){var textureFromCache=TextureCache[texture];if(textureFromCache){var index=textureFromCache.textureCacheIds.indexOf(texture);return index>-1&&textureFromCache.textureCacheIds.splice(index,1),delete TextureCache[texture],textureFromCache}}else if(texture&&texture.textureCacheIds){for(var i=0;i<texture.textureCacheIds.length;++i)TextureCache[texture.textureCacheIds[i]]===texture&&delete TextureCache[texture.textureCacheIds[i]];return texture.textureCacheIds.length=0,texture}return null},Object.defineProperty(Texture.prototype,"resolution",{get:function(){return this.baseTexture.resolution},enumerable:!1,configurable:!0}),Object.defineProperty(Texture.prototype,"frame",{get:function(){return this._frame},set:function(frame){this._frame=frame,this.noFrame=!1;var x=frame.x,y=frame.y,width=frame.width,height=frame.height,xNotFit=x+width>this.baseTexture.width,yNotFit=y+height>this.baseTexture.height;if(xNotFit||yNotFit){var relationship=xNotFit&&yNotFit?"and":"or",errorX="X: "+x+" + "+width+" = "+(x+width)+" > "+this.baseTexture.width,errorY="Y: "+y+" + "+height+" = "+(y+height)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+errorX+" "+relationship+" "+errorY)}this.valid=width&&height&&this.baseTexture.valid,this.trim||this.rotate||(this.orig=frame),this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(Texture.prototype,"rotate",{get:function(){return this._rotate},set:function(rotate){this._rotate=rotate,this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(Texture.prototype,"width",{get:function(){return this.orig.width},enumerable:!1,configurable:!0}),Object.defineProperty(Texture.prototype,"height",{get:function(){return this.orig.height},enumerable:!1,configurable:!0}),Texture.prototype.castToBaseTexture=function(){return this.baseTexture},Texture}(eventemitter3_default());function removeAllHandlers(tex){tex.destroy=function(){},tex.on=function(){},tex.once=function(){},tex.emit=function(){}}Texture.EMPTY=new Texture(new BaseTexture),removeAllHandlers(Texture.EMPTY),removeAllHandlers(Texture.EMPTY.baseTexture),Texture.WHITE=function(){var canvas=document.createElement("canvas");canvas.width=16,canvas.height=16;var context=canvas.getContext("2d");return context.fillStyle="white",context.fillRect(0,0,16,16),new Texture(new BaseTexture(new CanvasResource(canvas)))}(),removeAllHandlers(Texture.WHITE),removeAllHandlers(Texture.WHITE.baseTexture);var RenderTexture=function(_super){function RenderTexture(baseRenderTexture,frame){var _this=_super.call(this,baseRenderTexture,frame)||this;return _this.valid=!0,_this.filterFrame=null,_this.filterPoolKey=null,_this.updateUvs(),_this}return core_extends(RenderTexture,_super),Object.defineProperty(RenderTexture.prototype,"framebuffer",{get:function(){return this.baseTexture.framebuffer},enumerable:!1,configurable:!0}),Object.defineProperty(RenderTexture.prototype,"multisample",{get:function(){return this.framebuffer.multisample},set:function(value){this.framebuffer.multisample=value},enumerable:!1,configurable:!0}),RenderTexture.prototype.resize=function(desiredWidth,desiredHeight,resizeBaseTexture){void 0===resizeBaseTexture&&(resizeBaseTexture=!0);var resolution=this.baseTexture.resolution,width=Math.round(desiredWidth*resolution)/resolution,height=Math.round(desiredHeight*resolution)/resolution;this.valid=width>0&&height>0,this._frame.width=this.orig.width=width,this._frame.height=this.orig.height=height,resizeBaseTexture&&this.baseTexture.resize(width,height),this.updateUvs()},RenderTexture.prototype.setResolution=function(resolution){var baseTexture=this.baseTexture;baseTexture.resolution!==resolution&&(baseTexture.setResolution(resolution),this.resize(baseTexture.width,baseTexture.height,!1))},RenderTexture.create=function(options){for(var arguments$1=arguments,rest=[],_i=1;_i<arguments.length;_i++)rest[_i-1]=arguments$1[_i];return"number"==typeof options&&(deprecation("6.0.0","Arguments (width, height, scaleMode, resolution) have been deprecated."),options={width:options,height:rest[0],scaleMode:rest[1],resolution:rest[2]}),new RenderTexture(new BaseRenderTexture(options))},RenderTexture}(Texture),RenderTexturePool=function(){function RenderTexturePool(textureOptions){this.texturePool={},this.textureOptions=textureOptions||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}return RenderTexturePool.prototype.createTexture=function(realWidth,realHeight,multisample){void 0===multisample&&(multisample=constants_MSAA_QUALITY.NONE);var baseRenderTexture=new BaseRenderTexture(Object.assign({width:realWidth,height:realHeight,resolution:1,multisample},this.textureOptions));return new RenderTexture(baseRenderTexture)},RenderTexturePool.prototype.getOptimalTexture=function(minWidth,minHeight,resolution,multisample){var key;void 0===resolution&&(resolution=1),void 0===multisample&&(multisample=constants_MSAA_QUALITY.NONE),minWidth=Math.ceil(minWidth*resolution-1e-6),minHeight=Math.ceil(minHeight*resolution-1e-6),this.enableFullScreen&&minWidth===this._pixelsWidth&&minHeight===this._pixelsHeight?key=multisample>1?-multisample:-1:(key=((65535&(minWidth=nextPow2(minWidth)))<<16|65535&(minHeight=nextPow2(minHeight)))>>>0,multisample>1&&(key+=4294967296*multisample)),this.texturePool[key]||(this.texturePool[key]=[]);var renderTexture=this.texturePool[key].pop();return renderTexture||(renderTexture=this.createTexture(minWidth,minHeight,multisample)),renderTexture.filterPoolKey=key,renderTexture.setResolution(resolution),renderTexture},RenderTexturePool.prototype.getFilterTexture=function(input,resolution,multisample){var filterTexture=this.getOptimalTexture(input.width,input.height,resolution||input.resolution,multisample||constants_MSAA_QUALITY.NONE);return filterTexture.filterFrame=input.filterFrame,filterTexture},RenderTexturePool.prototype.returnTexture=function(renderTexture){var key=renderTexture.filterPoolKey;renderTexture.filterFrame=null,this.texturePool[key].push(renderTexture)},RenderTexturePool.prototype.returnFilterTexture=function(renderTexture){this.returnTexture(renderTexture)},RenderTexturePool.prototype.clear=function(destroyTextures){if(destroyTextures=!1!==destroyTextures)for(var i in this.texturePool){var textures=this.texturePool[i];if(textures)for(var j=0;j<textures.length;j++)textures[j].destroy(!0)}this.texturePool={}},RenderTexturePool.prototype.setScreenSize=function(size){if(size.width!==this._pixelsWidth||size.height!==this._pixelsHeight){for(var i in this.enableFullScreen=size.width>0&&size.height>0,this.texturePool)if(Number(i)<0){var textures=this.texturePool[i];if(textures)for(var j=0;j<textures.length;j++)textures[j].destroy(!0);this.texturePool[i]=[]}this._pixelsWidth=size.width,this._pixelsHeight=size.height}},RenderTexturePool.SCREEN_KEY=-1,RenderTexturePool}(),Attribute=function(){function Attribute(buffer,size,normalized,type,stride,start,instance){void 0===size&&(size=0),void 0===normalized&&(normalized=!1),void 0===type&&(type=constants_TYPES.FLOAT),this.buffer=buffer,this.size=size,this.normalized=normalized,this.type=type,this.stride=stride,this.start=start,this.instance=instance}return Attribute.prototype.destroy=function(){this.buffer=null},Attribute.from=function(buffer,size,normalized,type,stride){return new Attribute(buffer,size,normalized,type,stride)},Attribute}(),UID=0,Buffer=function(){function Buffer(data,_static,index){void 0===_static&&(_static=!0),void 0===index&&(index=!1),this.data=data||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=index,this.static=_static,this.id=UID++,this.disposeRunner=new Runner("disposeBuffer")}return Buffer.prototype.update=function(data){data instanceof Array&&(data=new Float32Array(data)),this.data=data||this.data,this._updateID++},Buffer.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},Buffer.prototype.destroy=function(){this.dispose(),this.data=null},Object.defineProperty(Buffer.prototype,"index",{get:function(){return this.type===constants_BUFFER_TYPE.ELEMENT_ARRAY_BUFFER},set:function(value){this.type=value?constants_BUFFER_TYPE.ELEMENT_ARRAY_BUFFER:constants_BUFFER_TYPE.ARRAY_BUFFER},enumerable:!1,configurable:!0}),Buffer.from=function(data){return data instanceof Array&&(data=new Float32Array(data)),new Buffer(data)},Buffer}(),core_map={Float32Array,Uint32Array,Int32Array,Uint8Array};var byteSizeMap={5126:4,5123:2,5121:1},UID$1=0,map$1={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array},Geometry=function(){function Geometry(buffers,attributes){void 0===buffers&&(buffers=[]),void 0===attributes&&(attributes={}),this.buffers=buffers,this.indexBuffer=null,this.attributes=attributes,this.glVertexArrayObjects={},this.id=UID$1++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new Runner("disposeGeometry"),this.refCount=0}return Geometry.prototype.addAttribute=function(id,buffer,size,normalized,type,stride,start,instance){if(void 0===size&&(size=0),void 0===normalized&&(normalized=!1),void 0===instance&&(instance=!1),!buffer)throw new Error("You must pass a buffer when creating an attribute");buffer instanceof Buffer||(buffer instanceof Array&&(buffer=new Float32Array(buffer)),buffer=new Buffer(buffer));var ids=id.split("|");if(ids.length>1){for(var i=0;i<ids.length;i++)this.addAttribute(ids[i],buffer,size,normalized,type);return this}var bufferIndex=this.buffers.indexOf(buffer);return-1===bufferIndex&&(this.buffers.push(buffer),bufferIndex=this.buffers.length-1),this.attributes[id]=new Attribute(bufferIndex,size,normalized,type,stride,start,instance),this.instanced=this.instanced||instance,this},Geometry.prototype.getAttribute=function(id){return this.attributes[id]},Geometry.prototype.getBuffer=function(id){return this.buffers[this.getAttribute(id).buffer]},Geometry.prototype.addIndex=function(buffer){return buffer instanceof Buffer||(buffer instanceof Array&&(buffer=new Uint16Array(buffer)),buffer=new Buffer(buffer)),buffer.type=constants_BUFFER_TYPE.ELEMENT_ARRAY_BUFFER,this.indexBuffer=buffer,-1===this.buffers.indexOf(buffer)&&this.buffers.push(buffer),this},Geometry.prototype.getIndex=function(){return this.indexBuffer},Geometry.prototype.interleave=function(){if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;var i,arrays=[],sizes=[],interleavedBuffer=new Buffer;for(i in this.attributes){var attribute=this.attributes[i],buffer=this.buffers[attribute.buffer];arrays.push(buffer.data),sizes.push(attribute.size*byteSizeMap[attribute.type]/4),attribute.buffer=0}for(interleavedBuffer.data=function(arrays,sizes){for(var outSize=0,stride=0,views={},i=0;i<arrays.length;i++)stride+=sizes[i],outSize+=arrays[i].length;var buffer=new ArrayBuffer(4*outSize),out=null,littleOffset=0;for(i=0;i<arrays.length;i++){var size=sizes[i],array=arrays[i],type=getBufferType(array);views[type]||(views[type]=new core_map[type](buffer)),out=views[type];for(var j=0;j<array.length;j++)out[(j/size|0)*stride+littleOffset+j%size]=array[j];littleOffset+=size}return new Float32Array(buffer)}(arrays,sizes),i=0;i<this.buffers.length;i++)this.buffers[i]!==this.indexBuffer&&this.buffers[i].destroy();return this.buffers=[interleavedBuffer],this.indexBuffer&&this.buffers.push(this.indexBuffer),this},Geometry.prototype.getSize=function(){for(var i in this.attributes){var attribute=this.attributes[i];return this.buffers[attribute.buffer].data.length/(attribute.stride/4||attribute.size)}return 0},Geometry.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},Geometry.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null},Geometry.prototype.clone=function(){for(var geometry=new Geometry,i=0;i<this.buffers.length;i++)geometry.buffers[i]=new Buffer(this.buffers[i].data.slice(0));for(var i in this.attributes){var attrib=this.attributes[i];geometry.attributes[i]=new Attribute(attrib.buffer,attrib.size,attrib.normalized,attrib.type,attrib.stride,attrib.start,attrib.instance)}return this.indexBuffer&&(geometry.indexBuffer=geometry.buffers[this.buffers.indexOf(this.indexBuffer)],geometry.indexBuffer.type=constants_BUFFER_TYPE.ELEMENT_ARRAY_BUFFER),geometry},Geometry.merge=function(geometries){for(var geometry,geometryOut=new Geometry,arrays=[],sizes=[],offsets=[],i=0;i<geometries.length;i++){geometry=geometries[i];for(var j=0;j<geometry.buffers.length;j++)sizes[j]=sizes[j]||0,sizes[j]+=geometry.buffers[j].data.length,offsets[j]=0}for(i=0;i<geometry.buffers.length;i++)arrays[i]=new(map$1[getBufferType(geometry.buffers[i].data)])(sizes[i]),geometryOut.buffers[i]=new Buffer(arrays[i]);for(i=0;i<geometries.length;i++){geometry=geometries[i];for(j=0;j<geometry.buffers.length;j++)arrays[j].set(geometry.buffers[j].data,offsets[j]),offsets[j]+=geometry.buffers[j].data.length}if(geometryOut.attributes=geometry.attributes,geometry.indexBuffer){geometryOut.indexBuffer=geometryOut.buffers[geometry.buffers.indexOf(geometry.indexBuffer)],geometryOut.indexBuffer.type=constants_BUFFER_TYPE.ELEMENT_ARRAY_BUFFER;var offset=0,stride=0,offset2=0,bufferIndexToCount=0;for(i=0;i<geometry.buffers.length;i++)if(geometry.buffers[i]!==geometry.indexBuffer){bufferIndexToCount=i;break}for(var i in geometry.attributes){var attribute=geometry.attributes[i];(0|attribute.buffer)===bufferIndexToCount&&(stride+=attribute.size*byteSizeMap[attribute.type]/4)}for(i=0;i<geometries.length;i++){var indexBufferData=geometries[i].indexBuffer.data;for(j=0;j<indexBufferData.length;j++)geometryOut.indexBuffer.data[j+offset2]+=offset;offset+=geometries[i].buffers[bufferIndexToCount].data.length/stride,offset2+=indexBufferData.length}}return geometryOut},Geometry}(),Quad=function(_super){function Quad(){var _this=_super.call(this)||this;return _this.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2]),_this}return core_extends(Quad,_super),Quad}(Geometry),QuadUv=function(_super){function QuadUv(){var _this=_super.call(this)||this;return _this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),_this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),_this.vertexBuffer=new Buffer(_this.vertices),_this.uvBuffer=new Buffer(_this.uvs),_this.addAttribute("aVertexPosition",_this.vertexBuffer).addAttribute("aTextureCoord",_this.uvBuffer).addIndex([0,1,2,0,2,3]),_this}return core_extends(QuadUv,_super),QuadUv.prototype.map=function(targetTextureFrame,destinationFrame){var x=0,y=0;return this.uvs[0]=x,this.uvs[1]=y,this.uvs[2]=x+destinationFrame.width/targetTextureFrame.width,this.uvs[3]=y,this.uvs[4]=x+destinationFrame.width/targetTextureFrame.width,this.uvs[5]=y+destinationFrame.height/targetTextureFrame.height,this.uvs[6]=x,this.uvs[7]=y+destinationFrame.height/targetTextureFrame.height,x=destinationFrame.x,y=destinationFrame.y,this.vertices[0]=x,this.vertices[1]=y,this.vertices[2]=x+destinationFrame.width,this.vertices[3]=y,this.vertices[4]=x+destinationFrame.width,this.vertices[5]=y+destinationFrame.height,this.vertices[6]=x,this.vertices[7]=y+destinationFrame.height,this.invalidate(),this},QuadUv.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},QuadUv}(Geometry),UID$2=0,UniformGroup=function(){function UniformGroup(uniforms,isStatic,isUbo){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=UID$2++,this.static=!!isStatic,this.ubo=!!isUbo,uniforms instanceof Buffer?(this.buffer=uniforms,this.buffer.type=constants_BUFFER_TYPE.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=uniforms,this.ubo&&(this.buffer=new Buffer(new Float32Array(1)),this.buffer.type=constants_BUFFER_TYPE.UNIFORM_BUFFER,this.autoManage=!0))}return UniformGroup.prototype.update=function(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()},UniformGroup.prototype.add=function(name,uniforms,_static){if(this.ubo)throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them");this.uniforms[name]=new UniformGroup(uniforms,_static)},UniformGroup.from=function(uniforms,_static,_ubo){return new UniformGroup(uniforms,_static,_ubo)},UniformGroup.uboFrom=function(uniforms,_static){return new UniformGroup(uniforms,null==_static||_static,!0)},UniformGroup}(),FilterState=function(){function FilterState(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=constants_MSAA_QUALITY.NONE,this.sourceFrame=new Rectangle,this.destinationFrame=new Rectangle,this.bindingSourceFrame=new Rectangle,this.bindingDestinationFrame=new Rectangle,this.filters=[],this.transform=null}return FilterState.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null},FilterState}(),core_tempPoints=[new Point,new Point,new Point,new Point],tempMatrix=new Matrix,FilterSystem=function(){function FilterSystem(renderer){this.renderer=renderer,this.defaultFilterStack=[{}],this.texturePool=new RenderTexturePool,this.texturePool.setScreenSize(renderer.view),this.statePool=[],this.quad=new Quad,this.quadUv=new QuadUv,this.tempRect=new Rectangle,this.activeState={},this.globalUniforms=new UniformGroup({outputFrame:new Rectangle,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}return FilterSystem.prototype.push=function(target,filters){for(var _a,_b,renderer=this.renderer,filterStack=this.defaultFilterStack,state=this.statePool.pop()||new FilterState,renderTextureSystem=this.renderer.renderTexture,resolution=filters[0].resolution,multisample=filters[0].multisample,padding=filters[0].padding,autoFit=filters[0].autoFit,legacy=null===(_a=filters[0].legacy)||void 0===_a||_a,i=1;i<filters.length;i++){var filter=filters[i];resolution=Math.min(resolution,filter.resolution),multisample=Math.min(multisample,filter.multisample),padding=this.useMaxPadding?Math.max(padding,filter.padding):padding+filter.padding,autoFit=autoFit&&filter.autoFit,legacy=legacy||null===(_b=filter.legacy)||void 0===_b||_b}if(1===filterStack.length&&(this.defaultFilterStack[0].renderTexture=renderTextureSystem.current),filterStack.push(state),state.resolution=resolution,state.multisample=multisample,state.legacy=legacy,state.target=target,state.sourceFrame.copyFrom(target.filterArea||target.getBounds(!0)),state.sourceFrame.pad(padding),autoFit){var sourceFrameProjected=this.tempRect.copyFrom(renderTextureSystem.sourceFrame);renderer.projection.transform&&this.transformAABB(tempMatrix.copyFrom(renderer.projection.transform).invert(),sourceFrameProjected),state.sourceFrame.fit(sourceFrameProjected)}this.roundFrame(state.sourceFrame,renderTextureSystem.current?renderTextureSystem.current.resolution:renderer.resolution,renderTextureSystem.sourceFrame,renderTextureSystem.destinationFrame,renderer.projection.transform),state.renderTexture=this.getOptimalFilterTexture(state.sourceFrame.width,state.sourceFrame.height,resolution,multisample),state.filters=filters,state.destinationFrame.width=state.renderTexture.width,state.destinationFrame.height=state.renderTexture.height;var destinationFrame=this.tempRect;destinationFrame.x=0,destinationFrame.y=0,destinationFrame.width=state.sourceFrame.width,destinationFrame.height=state.sourceFrame.height,state.renderTexture.filterFrame=state.sourceFrame,state.bindingSourceFrame.copyFrom(renderTextureSystem.sourceFrame),state.bindingDestinationFrame.copyFrom(renderTextureSystem.destinationFrame),state.transform=renderer.projection.transform,renderer.projection.transform=null,renderTextureSystem.bind(state.renderTexture,state.sourceFrame,destinationFrame),renderer.framebuffer.clear(0,0,0,0)},FilterSystem.prototype.pop=function(){var filterStack=this.defaultFilterStack,state=filterStack.pop(),filters=state.filters;this.activeState=state;var globalUniforms=this.globalUniforms.uniforms;globalUniforms.outputFrame=state.sourceFrame,globalUniforms.resolution=state.resolution;var inputSize=globalUniforms.inputSize,inputPixel=globalUniforms.inputPixel,inputClamp=globalUniforms.inputClamp;if(inputSize[0]=state.destinationFrame.width,inputSize[1]=state.destinationFrame.height,inputSize[2]=1/inputSize[0],inputSize[3]=1/inputSize[1],inputPixel[0]=Math.round(inputSize[0]*state.resolution),inputPixel[1]=Math.round(inputSize[1]*state.resolution),inputPixel[2]=1/inputPixel[0],inputPixel[3]=1/inputPixel[1],inputClamp[0]=.5*inputPixel[2],inputClamp[1]=.5*inputPixel[3],inputClamp[2]=state.sourceFrame.width*inputSize[2]-.5*inputPixel[2],inputClamp[3]=state.sourceFrame.height*inputSize[3]-.5*inputPixel[3],state.legacy){var filterArea=globalUniforms.filterArea;filterArea[0]=state.destinationFrame.width,filterArea[1]=state.destinationFrame.height,filterArea[2]=state.sourceFrame.x,filterArea[3]=state.sourceFrame.y,globalUniforms.filterClamp=globalUniforms.inputClamp}this.globalUniforms.update();var lastState=filterStack[filterStack.length-1];if(this.renderer.framebuffer.blit(),1===filters.length)filters[0].apply(this,state.renderTexture,lastState.renderTexture,constants_CLEAR_MODES.BLEND,state),this.returnFilterTexture(state.renderTexture);else{var flip=state.renderTexture,flop=this.getOptimalFilterTexture(flip.width,flip.height,state.resolution);flop.filterFrame=flip.filterFrame;var i=0;for(i=0;i<filters.length-1;++i){1===i&&state.multisample>1&&((flop=this.getOptimalFilterTexture(flip.width,flip.height,state.resolution)).filterFrame=flip.filterFrame),filters[i].apply(this,flip,flop,constants_CLEAR_MODES.CLEAR,state);var t=flip;flip=flop,flop=t}filters[i].apply(this,flip,lastState.renderTexture,constants_CLEAR_MODES.BLEND,state),i>1&&state.multisample>1&&this.returnFilterTexture(state.renderTexture),this.returnFilterTexture(flip),this.returnFilterTexture(flop)}state.clear(),this.statePool.push(state)},FilterSystem.prototype.bindAndClear=function(filterTexture,clearMode){void 0===clearMode&&(clearMode=constants_CLEAR_MODES.CLEAR);var _a=this.renderer,renderTextureSystem=_a.renderTexture,stateSystem=_a.state;if(filterTexture===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,filterTexture&&filterTexture.filterFrame){var destinationFrame=this.tempRect;destinationFrame.x=0,destinationFrame.y=0,destinationFrame.width=filterTexture.filterFrame.width,destinationFrame.height=filterTexture.filterFrame.height,renderTextureSystem.bind(filterTexture,filterTexture.filterFrame,destinationFrame)}else filterTexture!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?renderTextureSystem.bind(filterTexture):this.renderer.renderTexture.bind(filterTexture,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);var autoClear=1&stateSystem.stateId||this.forceClear;(clearMode===constants_CLEAR_MODES.CLEAR||clearMode===constants_CLEAR_MODES.BLIT&&autoClear)&&this.renderer.framebuffer.clear(0,0,0,0)},FilterSystem.prototype.applyFilter=function(filter,input,output,clearMode){var renderer=this.renderer;renderer.state.set(filter.state),this.bindAndClear(output,clearMode),filter.uniforms.uSampler=input,filter.uniforms.filterGlobals=this.globalUniforms,renderer.shader.bind(filter),filter.legacy=!!filter.program.attributeData.aTextureCoord,filter.legacy?(this.quadUv.map(input._frame,input.filterFrame),renderer.geometry.bind(this.quadUv),renderer.geometry.draw(constants_DRAW_MODES.TRIANGLES)):(renderer.geometry.bind(this.quad),renderer.geometry.draw(constants_DRAW_MODES.TRIANGLE_STRIP))},FilterSystem.prototype.calculateSpriteMatrix=function(outputMatrix,sprite){var _a=this.activeState,sourceFrame=_a.sourceFrame,destinationFrame=_a.destinationFrame,orig=sprite._texture.orig,mappedMatrix=outputMatrix.set(destinationFrame.width,0,0,destinationFrame.height,sourceFrame.x,sourceFrame.y),worldTransform=sprite.worldTransform.copyTo(Matrix.TEMP_MATRIX);return worldTransform.invert(),mappedMatrix.prepend(worldTransform),mappedMatrix.scale(1/orig.width,1/orig.height),mappedMatrix.translate(sprite.anchor.x,sprite.anchor.y),mappedMatrix},FilterSystem.prototype.destroy=function(){this.renderer=null,this.texturePool.clear(!1)},FilterSystem.prototype.getOptimalFilterTexture=function(minWidth,minHeight,resolution,multisample){return void 0===resolution&&(resolution=1),void 0===multisample&&(multisample=constants_MSAA_QUALITY.NONE),this.texturePool.getOptimalTexture(minWidth,minHeight,resolution,multisample)},FilterSystem.prototype.getFilterTexture=function(input,resolution,multisample){if("number"==typeof input){var swap=input;input=resolution,resolution=swap}input=input||this.activeState.renderTexture;var filterTexture=this.texturePool.getOptimalTexture(input.width,input.height,resolution||input.resolution,multisample||constants_MSAA_QUALITY.NONE);return filterTexture.filterFrame=input.filterFrame,filterTexture},FilterSystem.prototype.returnFilterTexture=function(renderTexture){this.texturePool.returnTexture(renderTexture)},FilterSystem.prototype.emptyPool=function(){this.texturePool.clear(!0)},FilterSystem.prototype.resize=function(){this.texturePool.setScreenSize(this.renderer.view)},FilterSystem.prototype.transformAABB=function(matrix,rect){var lt=core_tempPoints[0],lb=core_tempPoints[1],rt=core_tempPoints[2],rb=core_tempPoints[3];lt.set(rect.left,rect.top),lb.set(rect.left,rect.bottom),rt.set(rect.right,rect.top),rb.set(rect.right,rect.bottom),matrix.apply(lt,lt),matrix.apply(lb,lb),matrix.apply(rt,rt),matrix.apply(rb,rb);var x0=Math.min(lt.x,lb.x,rt.x,rb.x),y0=Math.min(lt.y,lb.y,rt.y,rb.y),x1=Math.max(lt.x,lb.x,rt.x,rb.x),y1=Math.max(lt.y,lb.y,rt.y,rb.y);rect.x=x0,rect.y=y0,rect.width=x1-x0,rect.height=y1-y0},FilterSystem.prototype.roundFrame=function(frame,resolution,bindingSourceFrame,bindingDestinationFrame,transform){if(!(frame.width<=0||frame.height<=0||bindingSourceFrame.width<=0||bindingSourceFrame.height<=0)){if(transform){var a=transform.a,b=transform.b,c=transform.c,d=transform.d;if((Math.abs(b)>1e-4||Math.abs(c)>1e-4)&&(Math.abs(a)>1e-4||Math.abs(d)>1e-4))return}(transform=transform?tempMatrix.copyFrom(transform):tempMatrix.identity()).translate(-bindingSourceFrame.x,-bindingSourceFrame.y).scale(bindingDestinationFrame.width/bindingSourceFrame.width,bindingDestinationFrame.height/bindingSourceFrame.height).translate(bindingDestinationFrame.x,bindingDestinationFrame.y),this.transformAABB(transform,frame),frame.ceil(resolution),this.transformAABB(transform.invert(),frame)}},FilterSystem}(),ObjectRenderer=function(){function ObjectRenderer(renderer){this.renderer=renderer}return ObjectRenderer.prototype.flush=function(){},ObjectRenderer.prototype.destroy=function(){this.renderer=null},ObjectRenderer.prototype.start=function(){},ObjectRenderer.prototype.stop=function(){this.flush()},ObjectRenderer.prototype.render=function(_object){},ObjectRenderer}(),BatchSystem=function(){function BatchSystem(renderer){this.renderer=renderer,this.emptyRenderer=new ObjectRenderer(renderer),this.currentRenderer=this.emptyRenderer}return BatchSystem.prototype.setObjectRenderer=function(objectRenderer){this.currentRenderer!==objectRenderer&&(this.currentRenderer.stop(),this.currentRenderer=objectRenderer,this.currentRenderer.start())},BatchSystem.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},BatchSystem.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},BatchSystem.prototype.copyBoundTextures=function(arr,maxTextures){for(var boundTextures=this.renderer.texture.boundTextures,i=maxTextures-1;i>=0;--i)arr[i]=boundTextures[i]||null,arr[i]&&(arr[i]._batchLocation=i)},BatchSystem.prototype.boundArray=function(texArray,boundTextures,batchId,maxTextures){for(var elements=texArray.elements,ids=texArray.ids,count=texArray.count,j=0,i=0;i<count;i++){var tex=elements[i],loc=tex._batchLocation;if(loc>=0&&loc<maxTextures&&boundTextures[loc]===tex)ids[i]=loc;else for(;j<maxTextures;){var bound=boundTextures[j];if(!bound||bound._batchEnabled!==batchId||bound._batchLocation!==j){ids[i]=j,tex._batchLocation=j,boundTextures[j]=tex;break}j++}}},BatchSystem.prototype.destroy=function(){this.renderer=null},BatchSystem}(),CONTEXT_UID_COUNTER=0,ContextSystem=function(){function ContextSystem(renderer){this.renderer=renderer,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this),renderer.view.addEventListener("webglcontextlost",this.handleContextLost,!1),renderer.view.addEventListener("webglcontextrestored",this.handleContextRestored,!1)}return Object.defineProperty(ContextSystem.prototype,"isLost",{get:function(){return!this.gl||this.gl.isContextLost()},enumerable:!1,configurable:!0}),ContextSystem.prototype.contextChange=function(gl){this.gl=gl,this.renderer.gl=gl,this.renderer.CONTEXT_UID=CONTEXT_UID_COUNTER++,gl.isContextLost()&&gl.getExtension("WEBGL_lose_context")&&gl.getExtension("WEBGL_lose_context").restoreContext()},ContextSystem.prototype.initFromContext=function(gl){this.gl=gl,this.validateContext(gl),this.renderer.gl=gl,this.renderer.CONTEXT_UID=CONTEXT_UID_COUNTER++,this.renderer.runners.contextChange.emit(gl)},ContextSystem.prototype.initFromOptions=function(options){var gl=this.createContext(this.renderer.view,options);this.initFromContext(gl)},ContextSystem.prototype.createContext=function(canvas,options){var gl;if(settings.PREFER_ENV>=constants_ENV.WEBGL2&&(gl=canvas.getContext("webgl2",options)),gl)this.webGLVersion=2;else if(this.webGLVersion=1,!(gl=canvas.getContext("webgl",options)||canvas.getContext("experimental-webgl",options)))throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=gl,this.getExtensions(),this.gl},ContextSystem.prototype.getExtensions=function(){var gl=this.gl,common={anisotropicFiltering:gl.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:gl.getExtension("OES_texture_float_linear"),s3tc:gl.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:gl.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:gl.getExtension("WEBGL_compressed_texture_etc"),etc1:gl.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:gl.getExtension("WEBGL_compressed_texture_pvrtc")||gl.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:gl.getExtension("WEBGL_compressed_texture_atc"),astc:gl.getExtension("WEBGL_compressed_texture_astc")};1===this.webGLVersion?Object.assign(this.extensions,common,{drawBuffers:gl.getExtension("WEBGL_draw_buffers"),depthTexture:gl.getExtension("WEBGL_depth_texture"),loseContext:gl.getExtension("WEBGL_lose_context"),vertexArrayObject:gl.getExtension("OES_vertex_array_object")||gl.getExtension("MOZ_OES_vertex_array_object")||gl.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:gl.getExtension("OES_element_index_uint"),floatTexture:gl.getExtension("OES_texture_float"),floatTextureLinear:gl.getExtension("OES_texture_float_linear"),textureHalfFloat:gl.getExtension("OES_texture_half_float"),textureHalfFloatLinear:gl.getExtension("OES_texture_half_float_linear")}):2===this.webGLVersion&&Object.assign(this.extensions,common,{colorBufferFloat:gl.getExtension("EXT_color_buffer_float")})},ContextSystem.prototype.handleContextLost=function(event){event.preventDefault()},ContextSystem.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.emit(this.gl)},ContextSystem.prototype.destroy=function(){var view=this.renderer.view;this.renderer=null,view.removeEventListener("webglcontextlost",this.handleContextLost),view.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},ContextSystem.prototype.postrender=function(){this.renderer.renderingToScreen&&this.gl.flush()},ContextSystem.prototype.validateContext=function(gl){var attributes=gl.getContextAttributes(),isWebGl2="WebGL2RenderingContext"in globalThis&&gl instanceof globalThis.WebGL2RenderingContext;isWebGl2&&(this.webGLVersion=2),attributes.stencil||console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");var hasuint32=isWebGl2||!!gl.getExtension("OES_element_index_uint");this.supports.uint32Indices=hasuint32,hasuint32||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")},ContextSystem}(),GLFramebuffer=function(framebuffer){this.framebuffer=framebuffer,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=constants_MSAA_QUALITY.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0},tempRectangle=new Rectangle,FramebufferSystem=function(){function FramebufferSystem(renderer){this.renderer=renderer,this.managedFramebuffers=[],this.unknownFramebuffer=new Framebuffer(10,10),this.msaaSamples=null}return FramebufferSystem.prototype.contextChange=function(){var gl=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new Rectangle,this.hasMRT=!0,this.writeDepthTexture=!0,this.disposeAll(!0),1===this.renderer.context.webGLVersion){var nativeDrawBuffersExtension_1=this.renderer.context.extensions.drawBuffers,nativeDepthTextureExtension=this.renderer.context.extensions.depthTexture;settings.PREFER_ENV===constants_ENV.WEBGL_LEGACY&&(nativeDrawBuffersExtension_1=null,nativeDepthTextureExtension=null),nativeDrawBuffersExtension_1?gl.drawBuffers=function(activeTextures){return nativeDrawBuffersExtension_1.drawBuffersWEBGL(activeTextures)}:(this.hasMRT=!1,gl.drawBuffers=function(){}),nativeDepthTextureExtension||(this.writeDepthTexture=!1)}else this.msaaSamples=gl.getInternalformatParameter(gl.RENDERBUFFER,gl.RGBA8,gl.SAMPLES)},FramebufferSystem.prototype.bind=function(framebuffer,frame,mipLevel){void 0===mipLevel&&(mipLevel=0);var gl=this.gl;if(framebuffer){var fbo=framebuffer.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(framebuffer);this.current!==framebuffer&&(this.current=framebuffer,gl.bindFramebuffer(gl.FRAMEBUFFER,fbo.framebuffer)),fbo.mipLevel!==mipLevel&&(framebuffer.dirtyId++,framebuffer.dirtyFormat++,fbo.mipLevel=mipLevel),fbo.dirtyId!==framebuffer.dirtyId&&(fbo.dirtyId=framebuffer.dirtyId,fbo.dirtyFormat!==framebuffer.dirtyFormat?(fbo.dirtyFormat=framebuffer.dirtyFormat,fbo.dirtySize=framebuffer.dirtySize,this.updateFramebuffer(framebuffer,mipLevel)):fbo.dirtySize!==framebuffer.dirtySize&&(fbo.dirtySize=framebuffer.dirtySize,this.resizeFramebuffer(framebuffer)));for(var i=0;i<framebuffer.colorTextures.length;i++){var tex=framebuffer.colorTextures[i];this.renderer.texture.unbind(tex.parentTextureArray||tex)}if(framebuffer.depthTexture&&this.renderer.texture.unbind(framebuffer.depthTexture),frame){var mipWidth=frame.width>>mipLevel,mipHeight=frame.height>>mipLevel,scale=mipWidth/frame.width;this.setViewport(frame.x*scale,frame.y*scale,mipWidth,mipHeight)}else{mipWidth=framebuffer.width>>mipLevel,mipHeight=framebuffer.height>>mipLevel;this.setViewport(0,0,mipWidth,mipHeight)}}else this.current&&(this.current=null,gl.bindFramebuffer(gl.FRAMEBUFFER,null)),frame?this.setViewport(frame.x,frame.y,frame.width,frame.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},FramebufferSystem.prototype.setViewport=function(x,y,width,height){var v=this.viewport;x=Math.round(x),y=Math.round(y),width=Math.round(width),height=Math.round(height),v.width===width&&v.height===height&&v.x===x&&v.y===y||(v.x=x,v.y=y,v.width=width,v.height=height,this.gl.viewport(x,y,width,height))},Object.defineProperty(FramebufferSystem.prototype,"size",{get:function(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},enumerable:!1,configurable:!0}),FramebufferSystem.prototype.clear=function(r,g,b,a,mask){void 0===mask&&(mask=constants_BUFFER_BITS.COLOR|constants_BUFFER_BITS.DEPTH);var gl=this.gl;gl.clearColor(r,g,b,a),gl.clear(mask)},FramebufferSystem.prototype.initFramebuffer=function(framebuffer){var gl=this.gl,fbo=new GLFramebuffer(gl.createFramebuffer());return fbo.multisample=this.detectSamples(framebuffer.multisample),framebuffer.glFramebuffers[this.CONTEXT_UID]=fbo,this.managedFramebuffers.push(framebuffer),framebuffer.disposeRunner.add(this),fbo},FramebufferSystem.prototype.resizeFramebuffer=function(framebuffer){var gl=this.gl,fbo=framebuffer.glFramebuffers[this.CONTEXT_UID];fbo.msaaBuffer&&(gl.bindRenderbuffer(gl.RENDERBUFFER,fbo.msaaBuffer),gl.renderbufferStorageMultisample(gl.RENDERBUFFER,fbo.multisample,gl.RGBA8,framebuffer.width,framebuffer.height)),fbo.stencil&&(gl.bindRenderbuffer(gl.RENDERBUFFER,fbo.stencil),fbo.msaaBuffer?gl.renderbufferStorageMultisample(gl.RENDERBUFFER,fbo.multisample,gl.DEPTH24_STENCIL8,framebuffer.width,framebuffer.height):gl.renderbufferStorage(gl.RENDERBUFFER,gl.DEPTH_STENCIL,framebuffer.width,framebuffer.height));var colorTextures=framebuffer.colorTextures,count=colorTextures.length;gl.drawBuffers||(count=Math.min(count,1));for(var i=0;i<count;i++){var texture=colorTextures[i],parentTexture=texture.parentTextureArray||texture;this.renderer.texture.bind(parentTexture,0)}framebuffer.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(framebuffer.depthTexture,0)},FramebufferSystem.prototype.updateFramebuffer=function(framebuffer,mipLevel){var gl=this.gl,fbo=framebuffer.glFramebuffers[this.CONTEXT_UID],colorTextures=framebuffer.colorTextures,count=colorTextures.length;gl.drawBuffers||(count=Math.min(count,1)),fbo.multisample>1&&this.canMultisampleFramebuffer(framebuffer)?(fbo.msaaBuffer=fbo.msaaBuffer||gl.createRenderbuffer(),gl.bindRenderbuffer(gl.RENDERBUFFER,fbo.msaaBuffer),gl.renderbufferStorageMultisample(gl.RENDERBUFFER,fbo.multisample,gl.RGBA8,framebuffer.width,framebuffer.height),gl.framebufferRenderbuffer(gl.FRAMEBUFFER,gl.COLOR_ATTACHMENT0,gl.RENDERBUFFER,fbo.msaaBuffer)):fbo.msaaBuffer&&(gl.deleteRenderbuffer(fbo.msaaBuffer),fbo.msaaBuffer=null,fbo.blitFramebuffer&&(fbo.blitFramebuffer.dispose(),fbo.blitFramebuffer=null));for(var activeTextures=[],i=0;i<count;i++){var texture=colorTextures[i],parentTexture=texture.parentTextureArray||texture;this.renderer.texture.bind(parentTexture,0),0===i&&fbo.msaaBuffer||(gl.framebufferTexture2D(gl.FRAMEBUFFER,gl.COLOR_ATTACHMENT0+i,texture.target,parentTexture._glTextures[this.CONTEXT_UID].texture,mipLevel),activeTextures.push(gl.COLOR_ATTACHMENT0+i))}if((activeTextures.length>1&&gl.drawBuffers(activeTextures),framebuffer.depthTexture)&&this.writeDepthTexture){var depthTexture=framebuffer.depthTexture;this.renderer.texture.bind(depthTexture,0),gl.framebufferTexture2D(gl.FRAMEBUFFER,gl.DEPTH_ATTACHMENT,gl.TEXTURE_2D,depthTexture._glTextures[this.CONTEXT_UID].texture,mipLevel)}!framebuffer.stencil&&!framebuffer.depth||framebuffer.depthTexture&&this.writeDepthTexture?fbo.stencil&&(gl.deleteRenderbuffer(fbo.stencil),fbo.stencil=null):(fbo.stencil=fbo.stencil||gl.createRenderbuffer(),gl.bindRenderbuffer(gl.RENDERBUFFER,fbo.stencil),fbo.msaaBuffer?gl.renderbufferStorageMultisample(gl.RENDERBUFFER,fbo.multisample,gl.DEPTH24_STENCIL8,framebuffer.width,framebuffer.height):gl.renderbufferStorage(gl.RENDERBUFFER,gl.DEPTH_STENCIL,framebuffer.width,framebuffer.height),gl.framebufferRenderbuffer(gl.FRAMEBUFFER,gl.DEPTH_STENCIL_ATTACHMENT,gl.RENDERBUFFER,fbo.stencil))},FramebufferSystem.prototype.canMultisampleFramebuffer=function(framebuffer){return 1!==this.renderer.context.webGLVersion&&framebuffer.colorTextures.length<=1&&!framebuffer.depthTexture},FramebufferSystem.prototype.detectSamples=function(samples){var msaaSamples=this.msaaSamples,res=constants_MSAA_QUALITY.NONE;if(samples<=1||null===msaaSamples)return res;for(var i=0;i<msaaSamples.length;i++)if(msaaSamples[i]<=samples){res=msaaSamples[i];break}return 1===res&&(res=constants_MSAA_QUALITY.NONE),res},FramebufferSystem.prototype.blit=function(framebuffer,sourcePixels,destPixels){var current=this.current,renderer=this.renderer,gl=this.gl,CONTEXT_UID=this.CONTEXT_UID;if(2===renderer.context.webGLVersion&&current){var fbo=current.glFramebuffers[CONTEXT_UID];if(fbo){if(!framebuffer){if(!fbo.msaaBuffer)return;var colorTexture=current.colorTextures[0];if(!colorTexture)return;fbo.blitFramebuffer||(fbo.blitFramebuffer=new Framebuffer(current.width,current.height),fbo.blitFramebuffer.addColorTexture(0,colorTexture)),(framebuffer=fbo.blitFramebuffer).colorTextures[0]!==colorTexture&&(framebuffer.colorTextures[0]=colorTexture,framebuffer.dirtyId++,framebuffer.dirtyFormat++),framebuffer.width===current.width&&framebuffer.height===current.height||(framebuffer.width=current.width,framebuffer.height=current.height,framebuffer.dirtyId++,framebuffer.dirtySize++)}sourcePixels||((sourcePixels=tempRectangle).width=current.width,sourcePixels.height=current.height),destPixels||(destPixels=sourcePixels);var sameSize=sourcePixels.width===destPixels.width&&sourcePixels.height===destPixels.height;this.bind(framebuffer),gl.bindFramebuffer(gl.READ_FRAMEBUFFER,fbo.framebuffer),gl.blitFramebuffer(sourcePixels.left,sourcePixels.top,sourcePixels.right,sourcePixels.bottom,destPixels.left,destPixels.top,destPixels.right,destPixels.bottom,gl.COLOR_BUFFER_BIT,sameSize?gl.NEAREST:gl.LINEAR)}}},FramebufferSystem.prototype.disposeFramebuffer=function(framebuffer,contextLost){var fbo=framebuffer.glFramebuffers[this.CONTEXT_UID],gl=this.gl;if(fbo){delete framebuffer.glFramebuffers[this.CONTEXT_UID];var index=this.managedFramebuffers.indexOf(framebuffer);index>=0&&this.managedFramebuffers.splice(index,1),framebuffer.disposeRunner.remove(this),contextLost||(gl.deleteFramebuffer(fbo.framebuffer),fbo.msaaBuffer&&gl.deleteRenderbuffer(fbo.msaaBuffer),fbo.stencil&&gl.deleteRenderbuffer(fbo.stencil)),fbo.blitFramebuffer&&fbo.blitFramebuffer.dispose()}},FramebufferSystem.prototype.disposeAll=function(contextLost){var list=this.managedFramebuffers;this.managedFramebuffers=[];for(var i=0;i<list.length;i++)this.disposeFramebuffer(list[i],contextLost)},FramebufferSystem.prototype.forceStencil=function(){var framebuffer=this.current;if(framebuffer){var fbo=framebuffer.glFramebuffers[this.CONTEXT_UID];if(fbo&&!fbo.stencil){framebuffer.stencil=!0;var w=framebuffer.width,h=framebuffer.height,gl=this.gl,stencil=gl.createRenderbuffer();gl.bindRenderbuffer(gl.RENDERBUFFER,stencil),fbo.msaaBuffer?gl.renderbufferStorageMultisample(gl.RENDERBUFFER,fbo.multisample,gl.DEPTH24_STENCIL8,w,h):gl.renderbufferStorage(gl.RENDERBUFFER,gl.DEPTH_STENCIL,w,h),fbo.stencil=stencil,gl.framebufferRenderbuffer(gl.FRAMEBUFFER,gl.DEPTH_STENCIL_ATTACHMENT,gl.RENDERBUFFER,stencil)}}},FramebufferSystem.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new Rectangle},FramebufferSystem.prototype.destroy=function(){this.renderer=null},FramebufferSystem}(),byteSizeMap$1={5126:4,5123:2,5121:1},GeometrySystem=function(){function GeometrySystem(renderer){this.renderer=renderer,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}return GeometrySystem.prototype.contextChange=function(){this.disposeAll(!0);var gl=this.gl=this.renderer.gl,context=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,2!==context.webGLVersion){var nativeVaoExtension_1=this.renderer.context.extensions.vertexArrayObject;settings.PREFER_ENV===constants_ENV.WEBGL_LEGACY&&(nativeVaoExtension_1=null),nativeVaoExtension_1?(gl.createVertexArray=function(){return nativeVaoExtension_1.createVertexArrayOES()},gl.bindVertexArray=function(vao){return nativeVaoExtension_1.bindVertexArrayOES(vao)},gl.deleteVertexArray=function(vao){return nativeVaoExtension_1.deleteVertexArrayOES(vao)}):(this.hasVao=!1,gl.createVertexArray=function(){return null},gl.bindVertexArray=function(){return null},gl.deleteVertexArray=function(){return null})}if(2!==context.webGLVersion){var instanceExt_1=gl.getExtension("ANGLE_instanced_arrays");instanceExt_1?(gl.vertexAttribDivisor=function(a,b){return instanceExt_1.vertexAttribDivisorANGLE(a,b)},gl.drawElementsInstanced=function(a,b,c,d,e){return instanceExt_1.drawElementsInstancedANGLE(a,b,c,d,e)},gl.drawArraysInstanced=function(a,b,c,d){return instanceExt_1.drawArraysInstancedANGLE(a,b,c,d)}):this.hasInstance=!1}this.canUseUInt32ElementIndex=2===context.webGLVersion||!!context.extensions.uint32ElementIndex},GeometrySystem.prototype.bind=function(geometry,shader){shader=shader||this.renderer.shader.shader;var gl=this.gl,vaos=geometry.glVertexArrayObjects[this.CONTEXT_UID],incRefCount=!1;vaos||(this.managedGeometries[geometry.id]=geometry,geometry.disposeRunner.add(this),geometry.glVertexArrayObjects[this.CONTEXT_UID]=vaos={},incRefCount=!0);var vao=vaos[shader.program.id]||this.initGeometryVao(geometry,shader,incRefCount);this._activeGeometry=geometry,this._activeVao!==vao&&(this._activeVao=vao,this.hasVao?gl.bindVertexArray(vao):this.activateVao(geometry,shader.program)),this.updateBuffers()},GeometrySystem.prototype.reset=function(){this.unbind()},GeometrySystem.prototype.updateBuffers=function(){for(var geometry=this._activeGeometry,bufferSystem=this.renderer.buffer,i=0;i<geometry.buffers.length;i++){var buffer=geometry.buffers[i];bufferSystem.update(buffer)}},GeometrySystem.prototype.checkCompatibility=function(geometry,program){var geometryAttributes=geometry.attributes,shaderAttributes=program.attributeData;for(var j in shaderAttributes)if(!geometryAttributes[j])throw new Error('shader and geometry incompatible, geometry missing the "'+j+'" attribute')},GeometrySystem.prototype.getSignature=function(geometry,program){var attribs=geometry.attributes,shaderAttributes=program.attributeData,strings=["g",geometry.id];for(var i in attribs)shaderAttributes[i]&&strings.push(i,shaderAttributes[i].location);return strings.join("-")},GeometrySystem.prototype.initGeometryVao=function(geometry,shader,incRefCount){void 0===incRefCount&&(incRefCount=!0);var gl=this.gl,CONTEXT_UID=this.CONTEXT_UID,bufferSystem=this.renderer.buffer,program=shader.program;program.glPrograms[CONTEXT_UID]||this.renderer.shader.generateProgram(shader),this.checkCompatibility(geometry,program);var signature=this.getSignature(geometry,program),vaoObjectHash=geometry.glVertexArrayObjects[this.CONTEXT_UID],vao=vaoObjectHash[signature];if(vao)return vaoObjectHash[program.id]=vao,vao;var buffers=geometry.buffers,attributes=geometry.attributes,tempStride={},tempStart={};for(var j in buffers)tempStride[j]=0,tempStart[j]=0;for(var j in attributes)!attributes[j].size&&program.attributeData[j]?attributes[j].size=program.attributeData[j].size:attributes[j].size||console.warn("PIXI Geometry attribute '"+j+"' size cannot be determined (likely the bound shader does not have the attribute)"),tempStride[attributes[j].buffer]+=attributes[j].size*byteSizeMap$1[attributes[j].type];for(var j in attributes){var attribute=attributes[j],attribSize=attribute.size;void 0===attribute.stride&&(tempStride[attribute.buffer]===attribSize*byteSizeMap$1[attribute.type]?attribute.stride=0:attribute.stride=tempStride[attribute.buffer]),void 0===attribute.start&&(attribute.start=tempStart[attribute.buffer],tempStart[attribute.buffer]+=attribSize*byteSizeMap$1[attribute.type])}vao=gl.createVertexArray(),gl.bindVertexArray(vao);for(var i=0;i<buffers.length;i++){var buffer=buffers[i];bufferSystem.bind(buffer),incRefCount&&buffer._glBuffers[CONTEXT_UID].refCount++}return this.activateVao(geometry,program),this._activeVao=vao,vaoObjectHash[program.id]=vao,vaoObjectHash[signature]=vao,vao},GeometrySystem.prototype.disposeGeometry=function(geometry,contextLost){var _a;if(this.managedGeometries[geometry.id]){delete this.managedGeometries[geometry.id];var vaos=geometry.glVertexArrayObjects[this.CONTEXT_UID],gl=this.gl,buffers=geometry.buffers,bufferSystem=null===(_a=this.renderer)||void 0===_a?void 0:_a.buffer;if(geometry.disposeRunner.remove(this),vaos){if(bufferSystem)for(var i=0;i<buffers.length;i++){var buf=buffers[i]._glBuffers[this.CONTEXT_UID];buf&&(buf.refCount--,0!==buf.refCount||contextLost||bufferSystem.dispose(buffers[i],contextLost))}if(!contextLost)for(var vaoId in vaos)if("g"===vaoId[0]){var vao=vaos[vaoId];this._activeVao===vao&&this.unbind(),gl.deleteVertexArray(vao)}delete geometry.glVertexArrayObjects[this.CONTEXT_UID]}}},GeometrySystem.prototype.disposeAll=function(contextLost){for(var all=Object.keys(this.managedGeometries),i=0;i<all.length;i++)this.disposeGeometry(this.managedGeometries[all[i]],contextLost)},GeometrySystem.prototype.activateVao=function(geometry,program){var gl=this.gl,CONTEXT_UID=this.CONTEXT_UID,bufferSystem=this.renderer.buffer,buffers=geometry.buffers,attributes=geometry.attributes;geometry.indexBuffer&&bufferSystem.bind(geometry.indexBuffer);var lastBuffer=null;for(var j in attributes){var attribute=attributes[j],buffer=buffers[attribute.buffer],glBuffer=buffer._glBuffers[CONTEXT_UID];if(program.attributeData[j]){lastBuffer!==glBuffer&&(bufferSystem.bind(buffer),lastBuffer=glBuffer);var location=program.attributeData[j].location;if(gl.enableVertexAttribArray(location),gl.vertexAttribPointer(location,attribute.size,attribute.type||gl.FLOAT,attribute.normalized,attribute.stride,attribute.start),attribute.instance){if(!this.hasInstance)throw new Error("geometry error, GPU Instancing is not supported on this device");gl.vertexAttribDivisor(location,1)}}}},GeometrySystem.prototype.draw=function(type,size,start,instanceCount){var gl=this.gl,geometry=this._activeGeometry;if(geometry.indexBuffer){var byteSize=geometry.indexBuffer.data.BYTES_PER_ELEMENT,glType=2===byteSize?gl.UNSIGNED_SHORT:gl.UNSIGNED_INT;2===byteSize||4===byteSize&&this.canUseUInt32ElementIndex?geometry.instanced?gl.drawElementsInstanced(type,size||geometry.indexBuffer.data.length,glType,(start||0)*byteSize,instanceCount||1):gl.drawElements(type,size||geometry.indexBuffer.data.length,glType,(start||0)*byteSize):console.warn("unsupported index buffer type: uint32")}else geometry.instanced?gl.drawArraysInstanced(type,start,size||geometry.getSize(),instanceCount||1):gl.drawArrays(type,start,size||geometry.getSize());return this},GeometrySystem.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null},GeometrySystem.prototype.destroy=function(){this.renderer=null},GeometrySystem}(),MaskData=function(){function MaskData(maskObject){void 0===maskObject&&(maskObject=null),this.type=constants_MASK_TYPES.NONE,this.autoDetect=!0,this.maskObject=maskObject||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=settings.FILTER_MULTISAMPLE,this.enabled=!0,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._target=null}return Object.defineProperty(MaskData.prototype,"filter",{get:function(){return this._filters?this._filters[0]:null},set:function(value){value?this._filters?this._filters[0]=value:this._filters=[value]:this._filters=null},enumerable:!1,configurable:!0}),MaskData.prototype.reset=function(){this.pooled&&(this.maskObject=null,this.type=constants_MASK_TYPES.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null},MaskData.prototype.copyCountersOrReset=function(maskAbove){maskAbove?(this._stencilCounter=maskAbove._stencilCounter,this._scissorCounter=maskAbove._scissorCounter,this._scissorRect=maskAbove._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)},MaskData}();function compileShader(gl,type,src){var shader=gl.createShader(type);return gl.shaderSource(shader,src),gl.compileShader(shader),shader}function logPrettyShaderError(gl,shader){var shaderSrc=gl.getShaderSource(shader).split("\n").map((function(line,index){return index+": "+line})),shaderLog=gl.getShaderInfoLog(shader),splitShader=shaderLog.split("\n"),dedupe={},lineNumbers=splitShader.map((function(line){return parseFloat(line.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))})).filter((function(n){return!(!n||dedupe[n])&&(dedupe[n]=!0,!0)})),logArgs=[""];lineNumbers.forEach((function(number){shaderSrc[number-1]="%c"+shaderSrc[number-1]+"%c",logArgs.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")}));var fragmentSourceToLog=shaderSrc.join("\n");logArgs[0]=fragmentSourceToLog,console.error(shaderLog),console.groupCollapsed("click to view full shader code"),console.warn.apply(console,logArgs),console.groupEnd()}function booleanArray(size){for(var array=new Array(size),i=0;i<array.length;i++)array[i]=!1;return array}function defaultValue(type,size){switch(type){case"float":case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"vec2":return new Float32Array(2*size);case"vec3":return new Float32Array(3*size);case"vec4":return new Float32Array(4*size);case"ivec2":return new Int32Array(2*size);case"ivec3":return new Int32Array(3*size);case"ivec4":return new Int32Array(4*size);case"uvec2":return new Uint32Array(2*size);case"uvec3":return new Uint32Array(3*size);case"uvec4":return new Uint32Array(4*size);case"bool":return!1;case"bvec2":return booleanArray(2*size);case"bvec3":return booleanArray(3*size);case"bvec4":return booleanArray(4*size);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}var maxFragmentPrecision,unknownContext={},context=unknownContext;function getMaxFragmentPrecision(){if(!maxFragmentPrecision){maxFragmentPrecision=constants_PRECISION.MEDIUM;var gl=function(){if(context===unknownContext||context&&context.isContextLost()){var canvas=document.createElement("canvas"),gl=void 0;settings.PREFER_ENV>=constants_ENV.WEBGL2&&(gl=canvas.getContext("webgl2",{})),gl||((gl=canvas.getContext("webgl",{})||canvas.getContext("experimental-webgl",{}))?gl.getExtension("WEBGL_draw_buffers"):gl=null),context=gl}return context}();if(gl&&gl.getShaderPrecisionFormat){var shaderFragment=gl.getShaderPrecisionFormat(gl.FRAGMENT_SHADER,gl.HIGH_FLOAT);maxFragmentPrecision=shaderFragment.precision?constants_PRECISION.HIGH:constants_PRECISION.MEDIUM}}return maxFragmentPrecision}function setPrecision(src,requestedPrecision,maxSupportedPrecision){if("precision"!==src.substring(0,9)){var precision=requestedPrecision;return requestedPrecision===constants_PRECISION.HIGH&&maxSupportedPrecision!==constants_PRECISION.HIGH&&(precision=constants_PRECISION.MEDIUM),"precision "+precision+" float;\n"+src}return maxSupportedPrecision!==constants_PRECISION.HIGH&&"precision highp"===src.substring(0,15)?src.replace("precision highp","precision mediump"):src}var GLSL_TO_SIZE={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function mapSize(type){return GLSL_TO_SIZE[type]}var GL_TABLE=null,GL_TO_GLSL_TYPES={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function mapType(gl,type){if(!GL_TABLE){var typeNames=Object.keys(GL_TO_GLSL_TYPES);GL_TABLE={};for(var i=0;i<typeNames.length;++i){var tn=typeNames[i];GL_TABLE[gl[tn]]=GL_TO_GLSL_TYPES[tn]}}return GL_TABLE[type]}var uniformParsers=[{test:function(data){return"float"===data.type&&1===data.size},code:function(name){return'\n            if(uv["'+name+'"] !== ud["'+name+'"].value)\n            {\n                ud["'+name+'"].value = uv["'+name+'"]\n                gl.uniform1f(ud["'+name+'"].location, uv["'+name+'"])\n            }\n            '}},{test:function(data){return("sampler2D"===data.type||"samplerCube"===data.type||"sampler2DArray"===data.type)&&1===data.size&&!data.isArray},code:function(name){return't = syncData.textureCount++;\n\n            renderer.texture.bind(uv["'+name+'"], t);\n\n            if(ud["'+name+'"].value !== t)\n            {\n                ud["'+name+'"].value = t;\n                gl.uniform1i(ud["'+name+'"].location, t);\n; // eslint-disable-line max-len\n            }'}},{test:function(data,uniform){return"mat3"===data.type&&1===data.size&&void 0!==uniform.a},code:function(name){return'\n            gl.uniformMatrix3fv(ud["'+name+'"].location, false, uv["'+name+'"].toArray(true));\n            '},codeUbo:function(name){return"\n                var "+name+"_matrix = uv."+name+".toArray(true);\n\n                data[offset] = "+name+"_matrix[0];\n                data[offset+1] = "+name+"_matrix[1];\n                data[offset+2] = "+name+"_matrix[2];\n        \n                data[offset + 4] = "+name+"_matrix[3];\n                data[offset + 5] = "+name+"_matrix[4];\n                data[offset + 6] = "+name+"_matrix[5];\n        \n                data[offset + 8] = "+name+"_matrix[6];\n                data[offset + 9] = "+name+"_matrix[7];\n                data[offset + 10] = "+name+"_matrix[8];\n            "}},{test:function(data,uniform){return"vec2"===data.type&&1===data.size&&void 0!==uniform.x},code:function(name){return'\n                cv = ud["'+name+'"].value;\n                v = uv["'+name+'"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud["'+name+'"].location, v.x, v.y);\n                }'},codeUbo:function(name){return"\n                v = uv."+name+";\n\n                data[offset] = v.x;\n                data[offset+1] = v.y;\n            "}},{test:function(data){return"vec2"===data.type&&1===data.size},code:function(name){return'\n                cv = ud["'+name+'"].value;\n                v = uv["'+name+'"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud["'+name+'"].location, v[0], v[1]);\n                }\n            '}},{test:function(data,uniform){return"vec4"===data.type&&1===data.size&&void 0!==uniform.width},code:function(name){return'\n                cv = ud["'+name+'"].value;\n                v = uv["'+name+'"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud["'+name+'"].location, v.x, v.y, v.width, v.height)\n                }'},codeUbo:function(name){return"\n                    v = uv."+name+";\n\n                    data[offset] = v.x;\n                    data[offset+1] = v.y;\n                    data[offset+2] = v.width;\n                    data[offset+3] = v.height;\n                "}},{test:function(data){return"vec4"===data.type&&1===data.size},code:function(name){return'\n                cv = ud["'+name+'"].value;\n                v = uv["'+name+'"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud["'+name+'"].location, v[0], v[1], v[2], v[3])\n                }'}}],GLSL_TO_SINGLE_SETTERS_CACHED={float:"\n    if (cv !== v)\n    {\n        cu.value = v;\n        gl.uniform1f(location, v);\n    }",vec2:"\n    if (cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2f(location, v[0], v[1])\n    }",vec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",vec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4f(location, v[0], v[1], v[2], v[3]);\n    }",int:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1i(location, v);\n    }",ivec2:"\n    if (cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2i(location, v[0], v[1]);\n    }",ivec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3i(location, v[0], v[1], v[2]);\n    }",ivec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4i(location, v[0], v[1], v[2], v[3]);\n    }",uint:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1ui(location, v);\n    }",uvec2:"\n    if (cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2ui(location, v[0], v[1]);\n    }",uvec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3ui(location, v[0], v[1], v[2]);\n    }",uvec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);\n    }",bool:"\n    if (cv !== v)\n    {\n        cu.value = v;\n        gl.uniform1i(location, v);\n    }",bvec2:"\n    if (cv[0] != v[0] || cv[1] != v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2i(location, v[0], v[1]);\n    }",bvec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3i(location, v[0], v[1], v[2]);\n    }",bvec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4i(location, v[0], v[1], v[2], v[3]);\n    }",mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"gl.uniform1i(location, v)",samplerCube:"gl.uniform1i(location, v)",sampler2DArray:"gl.uniform1i(location, v)"},GLSL_TO_ARRAY_SETTERS={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};var unsafeEval,fragTemplate=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n");function generateIfTestSrc(maxIfs){for(var src="",i=0;i<maxIfs;++i)i>0&&(src+="\nelse "),i<maxIfs-1&&(src+="if(test == "+i+".0){}");return src}var UID$3=0,nameCache={},Program=function(){function Program(vertexSrc,fragmentSrc,name){void 0===name&&(name="pixi-shader"),this.id=UID$3++,this.vertexSrc=vertexSrc||Program.defaultVertexSrc,this.fragmentSrc=fragmentSrc||Program.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),"#version"!==this.vertexSrc.substring(0,8)&&(name=name.replace(/\s+/g,"-"),nameCache[name]?(nameCache[name]++,name+="-"+nameCache[name]):nameCache[name]=1,this.vertexSrc="#define SHADER_NAME "+name+"\n"+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+name+"\n"+this.fragmentSrc,this.vertexSrc=setPrecision(this.vertexSrc,settings.PRECISION_VERTEX,constants_PRECISION.HIGH),this.fragmentSrc=setPrecision(this.fragmentSrc,settings.PRECISION_FRAGMENT,getMaxFragmentPrecision())),this.glPrograms={},this.syncUniforms=null}return Object.defineProperty(Program,"defaultVertexSrc",{get:function(){return"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n"},enumerable:!1,configurable:!0}),Object.defineProperty(Program,"defaultFragmentSrc",{get:function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}"},enumerable:!1,configurable:!0}),Program.from=function(vertexSrc,fragmentSrc,name){var key=vertexSrc+fragmentSrc,program=ProgramCache[key];return program||(ProgramCache[key]=program=new Program(vertexSrc,fragmentSrc,name)),program},Program}(),Shader=function(){function Shader(program,uniforms){this.uniformBindCount=0,this.program=program,this.uniformGroup=uniforms?uniforms instanceof UniformGroup?uniforms:new UniformGroup(uniforms):new UniformGroup({})}return Shader.prototype.checkUniformExists=function(name,group){if(group.uniforms[name])return!0;for(var i in group.uniforms){var uniform=group.uniforms[i];if(uniform.group&&this.checkUniformExists(name,uniform))return!0}return!1},Shader.prototype.destroy=function(){this.uniformGroup=null},Object.defineProperty(Shader.prototype,"uniforms",{get:function(){return this.uniformGroup.uniforms},enumerable:!1,configurable:!0}),Shader.from=function(vertexSrc,fragmentSrc,uniforms){return new Shader(Program.from(vertexSrc,fragmentSrc),uniforms)},Shader}(),State=function(){function State(){this.data=0,this.blendMode=constants_BLEND_MODES.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}return Object.defineProperty(State.prototype,"blend",{get:function(){return!!(1&this.data)},set:function(value){!!(1&this.data)!==value&&(this.data^=1)},enumerable:!1,configurable:!0}),Object.defineProperty(State.prototype,"offsets",{get:function(){return!!(2&this.data)},set:function(value){!!(2&this.data)!==value&&(this.data^=2)},enumerable:!1,configurable:!0}),Object.defineProperty(State.prototype,"culling",{get:function(){return!!(4&this.data)},set:function(value){!!(4&this.data)!==value&&(this.data^=4)},enumerable:!1,configurable:!0}),Object.defineProperty(State.prototype,"depthTest",{get:function(){return!!(8&this.data)},set:function(value){!!(8&this.data)!==value&&(this.data^=8)},enumerable:!1,configurable:!0}),Object.defineProperty(State.prototype,"depthMask",{get:function(){return!!(32&this.data)},set:function(value){!!(32&this.data)!==value&&(this.data^=32)},enumerable:!1,configurable:!0}),Object.defineProperty(State.prototype,"clockwiseFrontFace",{get:function(){return!!(16&this.data)},set:function(value){!!(16&this.data)!==value&&(this.data^=16)},enumerable:!1,configurable:!0}),Object.defineProperty(State.prototype,"blendMode",{get:function(){return this._blendMode},set:function(value){this.blend=value!==constants_BLEND_MODES.NONE,this._blendMode=value},enumerable:!1,configurable:!0}),Object.defineProperty(State.prototype,"polygonOffset",{get:function(){return this._polygonOffset},set:function(value){this.offsets=!!value,this._polygonOffset=value},enumerable:!1,configurable:!0}),State.prototype.toString=function(){return"[@pixi/core:State blendMode="+this.blendMode+" clockwiseFrontFace="+this.clockwiseFrontFace+" culling="+this.culling+" depthMask="+this.depthMask+" polygonOffset="+this.polygonOffset+"]"},State.for2d=function(){var state=new State;return state.depthTest=!1,state.blend=!0,state},State}(),Filter=function(_super){function Filter(vertexSrc,fragmentSrc,uniforms){var _this=this,program=Program.from(vertexSrc||Filter.defaultVertexSrc,fragmentSrc||Filter.defaultFragmentSrc);return(_this=_super.call(this,program,uniforms)||this).padding=0,_this.resolution=settings.FILTER_RESOLUTION,_this.multisample=settings.FILTER_MULTISAMPLE,_this.enabled=!0,_this.autoFit=!0,_this.state=new State,_this}return core_extends(Filter,_super),Filter.prototype.apply=function(filterManager,input,output,clearMode,_currentState){filterManager.applyFilter(this,input,output,clearMode)},Object.defineProperty(Filter.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(value){this.state.blendMode=value},enumerable:!1,configurable:!0}),Object.defineProperty(Filter.prototype,"resolution",{get:function(){return this._resolution},set:function(value){this._resolution=value},enumerable:!1,configurable:!0}),Object.defineProperty(Filter,"defaultVertexSrc",{get:function(){return"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n"},enumerable:!1,configurable:!0}),Object.defineProperty(Filter,"defaultFragmentSrc",{get:function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n"},enumerable:!1,configurable:!0}),Filter}(Shader),tempMat=new Matrix,TextureMatrix=function(){function TextureMatrix(texture,clampMargin){this._texture=texture,this.mapCoord=new Matrix,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=void 0===clampMargin?.5:clampMargin,this.isSimple=!1}return Object.defineProperty(TextureMatrix.prototype,"texture",{get:function(){return this._texture},set:function(value){this._texture=value,this._textureID=-1},enumerable:!1,configurable:!0}),TextureMatrix.prototype.multiplyUvs=function(uvs,out){void 0===out&&(out=uvs);for(var mat=this.mapCoord,i=0;i<uvs.length;i+=2){var x=uvs[i],y=uvs[i+1];out[i]=x*mat.a+y*mat.c+mat.tx,out[i+1]=x*mat.b+y*mat.d+mat.ty}return out},TextureMatrix.prototype.update=function(forceUpdate){var tex=this._texture;if(!tex||!tex.valid)return!1;if(!forceUpdate&&this._textureID===tex._updateID)return!1;this._textureID=tex._updateID,this._updateID++;var uvs=tex._uvs;this.mapCoord.set(uvs.x1-uvs.x0,uvs.y1-uvs.y0,uvs.x3-uvs.x0,uvs.y3-uvs.y0,uvs.x0,uvs.y0);var orig=tex.orig,trim=tex.trim;trim&&(tempMat.set(orig.width/trim.width,0,0,orig.height/trim.height,-trim.x/trim.width,-trim.y/trim.height),this.mapCoord.append(tempMat));var texBase=tex.baseTexture,frame=this.uClampFrame,margin=this.clampMargin/texBase.resolution,offset=this.clampOffset;return frame[0]=(tex._frame.x+margin+offset)/texBase.width,frame[1]=(tex._frame.y+margin+offset)/texBase.height,frame[2]=(tex._frame.x+tex._frame.width-margin+offset)/texBase.width,frame[3]=(tex._frame.y+tex._frame.height-margin+offset)/texBase.height,this.uClampOffset[0]=offset/texBase.realWidth,this.uClampOffset[1]=offset/texBase.realHeight,this.isSimple=tex._frame.width===texBase.width&&tex._frame.height===texBase.height&&0===tex.rotate,!0},TextureMatrix}(),SpriteMaskFilter=function(_super){function SpriteMaskFilter(vertexSrc,fragmentSrc,uniforms){var _this=this,sprite=null;return"string"!=typeof vertexSrc&&void 0===fragmentSrc&&void 0===uniforms&&(sprite=vertexSrc,vertexSrc=void 0,fragmentSrc=void 0,uniforms=void 0),(_this=_super.call(this,vertexSrc||"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n",fragmentSrc||"varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n",uniforms)||this).maskSprite=sprite,_this.maskMatrix=new Matrix,_this}return core_extends(SpriteMaskFilter,_super),Object.defineProperty(SpriteMaskFilter.prototype,"maskSprite",{get:function(){return this._maskSprite},set:function(value){this._maskSprite=value,this._maskSprite&&(this._maskSprite.renderable=!1)},enumerable:!1,configurable:!0}),SpriteMaskFilter.prototype.apply=function(filterManager,input,output,clearMode){var maskSprite=this._maskSprite,tex=maskSprite._texture;tex.valid&&(tex.uvMatrix||(tex.uvMatrix=new TextureMatrix(tex,0)),tex.uvMatrix.update(),this.uniforms.npmAlpha=tex.baseTexture.alphaMode?0:1,this.uniforms.mask=tex,this.uniforms.otherMatrix=filterManager.calculateSpriteMatrix(this.maskMatrix,maskSprite).prepend(tex.uvMatrix.mapCoord),this.uniforms.alpha=maskSprite.worldAlpha,this.uniforms.maskClamp=tex.uvMatrix.uClampFrame,filterManager.applyFilter(this,input,output,clearMode))},SpriteMaskFilter}(Filter),MaskSystem=function(){function MaskSystem(renderer){this.renderer=renderer,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}return MaskSystem.prototype.setMaskStack=function(maskStack){this.maskStack=maskStack,this.renderer.scissor.setMaskStack(maskStack),this.renderer.stencil.setMaskStack(maskStack)},MaskSystem.prototype.push=function(target,maskDataOrTarget){var maskData=maskDataOrTarget;if(!maskData.isMaskData){var d=this.maskDataPool.pop()||new MaskData;d.pooled=!0,d.maskObject=maskDataOrTarget,maskData=d}var maskAbove=0!==this.maskStack.length?this.maskStack[this.maskStack.length-1]:null;if(maskData.copyCountersOrReset(maskAbove),maskData.autoDetect&&this.detect(maskData),maskData._target=target,maskData.type!==constants_MASK_TYPES.SPRITE&&this.maskStack.push(maskData),maskData.enabled)switch(maskData.type){case constants_MASK_TYPES.SCISSOR:this.renderer.scissor.push(maskData);break;case constants_MASK_TYPES.STENCIL:this.renderer.stencil.push(maskData);break;case constants_MASK_TYPES.SPRITE:maskData.copyCountersOrReset(null),this.pushSpriteMask(maskData)}maskData.type===constants_MASK_TYPES.SPRITE&&this.maskStack.push(maskData)},MaskSystem.prototype.pop=function(target){var maskData=this.maskStack.pop();if(maskData&&maskData._target===target){if(maskData.enabled)switch(maskData.type){case constants_MASK_TYPES.SCISSOR:this.renderer.scissor.pop();break;case constants_MASK_TYPES.STENCIL:this.renderer.stencil.pop(maskData.maskObject);break;case constants_MASK_TYPES.SPRITE:this.popSpriteMask(maskData)}if(maskData.reset(),maskData.pooled&&this.maskDataPool.push(maskData),0!==this.maskStack.length){var maskCurrent=this.maskStack[this.maskStack.length-1];maskCurrent.type===constants_MASK_TYPES.SPRITE&&maskCurrent._filters&&(maskCurrent._filters[0].maskSprite=maskCurrent.maskObject)}}},MaskSystem.prototype.detect=function(maskData){maskData.maskObject.isSprite?maskData.type=constants_MASK_TYPES.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(maskData)?maskData.type=constants_MASK_TYPES.SCISSOR:maskData.type=constants_MASK_TYPES.STENCIL},MaskSystem.prototype.pushSpriteMask=function(maskData){var _a,_b,maskObject=maskData.maskObject,target=maskData._target,alphaMaskFilter=maskData._filters;alphaMaskFilter||(alphaMaskFilter=this.alphaMaskPool[this.alphaMaskIndex])||(alphaMaskFilter=this.alphaMaskPool[this.alphaMaskIndex]=[new SpriteMaskFilter]);var resolution,multisample,renderer=this.renderer,renderTextureSystem=renderer.renderTexture;if(renderTextureSystem.current){var renderTexture=renderTextureSystem.current;resolution=maskData.resolution||renderTexture.resolution,multisample=null!==(_a=maskData.multisample)&&void 0!==_a?_a:renderTexture.multisample}else resolution=maskData.resolution||renderer.resolution,multisample=null!==(_b=maskData.multisample)&&void 0!==_b?_b:renderer.multisample;alphaMaskFilter[0].resolution=resolution,alphaMaskFilter[0].multisample=multisample,alphaMaskFilter[0].maskSprite=maskObject;var stashFilterArea=target.filterArea;target.filterArea=maskObject.getBounds(!0),renderer.filter.push(target,alphaMaskFilter),target.filterArea=stashFilterArea,maskData._filters||this.alphaMaskIndex++},MaskSystem.prototype.popSpriteMask=function(maskData){this.renderer.filter.pop(),maskData._filters?maskData._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)},MaskSystem.prototype.destroy=function(){this.renderer=null},MaskSystem}(),AbstractMaskSystem=function(){function AbstractMaskSystem(renderer){this.renderer=renderer,this.maskStack=[],this.glConst=0}return AbstractMaskSystem.prototype.getStackLength=function(){return this.maskStack.length},AbstractMaskSystem.prototype.setMaskStack=function(maskStack){var gl=this.renderer.gl,curStackLen=this.getStackLength();this.maskStack=maskStack;var newStackLen=this.getStackLength();newStackLen!==curStackLen&&(0===newStackLen?gl.disable(this.glConst):(gl.enable(this.glConst),this._useCurrent()))},AbstractMaskSystem.prototype._useCurrent=function(){},AbstractMaskSystem.prototype.destroy=function(){this.renderer=null,this.maskStack=null},AbstractMaskSystem}(),tempMatrix$1=new Matrix,ScissorSystem=function(_super){function ScissorSystem(renderer){var _this=_super.call(this,renderer)||this;return _this.glConst=WebGLRenderingContext.SCISSOR_TEST,_this}return core_extends(ScissorSystem,_super),ScissorSystem.prototype.getStackLength=function(){var maskData=this.maskStack[this.maskStack.length-1];return maskData?maskData._scissorCounter:0},ScissorSystem.prototype.calcScissorRect=function(maskData){if(!maskData._scissorRectLocal){var prevData=maskData._scissorRect,maskObject=maskData.maskObject,renderer=this.renderer,renderTextureSystem=renderer.renderTexture;maskObject.renderable=!0;var rect=maskObject.getBounds();this.roundFrameToPixels(rect,renderTextureSystem.current?renderTextureSystem.current.resolution:renderer.resolution,renderTextureSystem.sourceFrame,renderTextureSystem.destinationFrame,renderer.projection.transform),maskObject.renderable=!1,prevData&&rect.fit(prevData),maskData._scissorRectLocal=rect}},ScissorSystem.isMatrixRotated=function(matrix){if(!matrix)return!1;var a=matrix.a,b=matrix.b,c=matrix.c,d=matrix.d;return(Math.abs(b)>1e-4||Math.abs(c)>1e-4)&&(Math.abs(a)>1e-4||Math.abs(d)>1e-4)},ScissorSystem.prototype.testScissor=function(maskData){var maskObject=maskData.maskObject;if(!maskObject.isFastRect||!maskObject.isFastRect())return!1;if(ScissorSystem.isMatrixRotated(maskObject.worldTransform))return!1;if(ScissorSystem.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(maskData);var rect=maskData._scissorRectLocal;return rect.width>0&&rect.height>0},ScissorSystem.prototype.roundFrameToPixels=function(frame,resolution,bindingSourceFrame,bindingDestinationFrame,transform){ScissorSystem.isMatrixRotated(transform)||((transform=transform?tempMatrix$1.copyFrom(transform):tempMatrix$1.identity()).translate(-bindingSourceFrame.x,-bindingSourceFrame.y).scale(bindingDestinationFrame.width/bindingSourceFrame.width,bindingDestinationFrame.height/bindingSourceFrame.height).translate(bindingDestinationFrame.x,bindingDestinationFrame.y),this.renderer.filter.transformAABB(transform,frame),frame.fit(bindingDestinationFrame),frame.x=Math.round(frame.x*resolution),frame.y=Math.round(frame.y*resolution),frame.width=Math.round(frame.width*resolution),frame.height=Math.round(frame.height*resolution))},ScissorSystem.prototype.push=function(maskData){maskData._scissorRectLocal||this.calcScissorRect(maskData);var gl=this.renderer.gl;maskData._scissorRect||gl.enable(gl.SCISSOR_TEST),maskData._scissorCounter++,maskData._scissorRect=maskData._scissorRectLocal,this._useCurrent()},ScissorSystem.prototype.pop=function(){var gl=this.renderer.gl;this.getStackLength()>0?this._useCurrent():gl.disable(gl.SCISSOR_TEST)},ScissorSystem.prototype._useCurrent=function(){var y,rect=this.maskStack[this.maskStack.length-1]._scissorRect;y=this.renderer.renderTexture.current?rect.y:this.renderer.height-rect.height-rect.y,this.renderer.gl.scissor(rect.x,y,rect.width,rect.height)},ScissorSystem}(AbstractMaskSystem),StencilSystem=function(_super){function StencilSystem(renderer){var _this=_super.call(this,renderer)||this;return _this.glConst=WebGLRenderingContext.STENCIL_TEST,_this}return core_extends(StencilSystem,_super),StencilSystem.prototype.getStackLength=function(){var maskData=this.maskStack[this.maskStack.length-1];return maskData?maskData._stencilCounter:0},StencilSystem.prototype.push=function(maskData){var maskObject=maskData.maskObject,gl=this.renderer.gl,prevMaskCount=maskData._stencilCounter;0===prevMaskCount&&(this.renderer.framebuffer.forceStencil(),gl.clearStencil(0),gl.clear(gl.STENCIL_BUFFER_BIT),gl.enable(gl.STENCIL_TEST)),maskData._stencilCounter++,gl.colorMask(!1,!1,!1,!1),gl.stencilFunc(gl.EQUAL,prevMaskCount,4294967295),gl.stencilOp(gl.KEEP,gl.KEEP,gl.INCR),maskObject.renderable=!0,maskObject.render(this.renderer),this.renderer.batch.flush(),maskObject.renderable=!1,this._useCurrent()},StencilSystem.prototype.pop=function(maskObject){var gl=this.renderer.gl;0===this.getStackLength()?gl.disable(gl.STENCIL_TEST):(gl.colorMask(!1,!1,!1,!1),gl.stencilOp(gl.KEEP,gl.KEEP,gl.DECR),maskObject.renderable=!0,maskObject.render(this.renderer),this.renderer.batch.flush(),maskObject.renderable=!1,this._useCurrent())},StencilSystem.prototype._useCurrent=function(){var gl=this.renderer.gl;gl.colorMask(!0,!0,!0,!0),gl.stencilFunc(gl.EQUAL,this.getStackLength(),4294967295),gl.stencilOp(gl.KEEP,gl.KEEP,gl.KEEP)},StencilSystem}(AbstractMaskSystem),ProjectionSystem=function(){function ProjectionSystem(renderer){this.renderer=renderer,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new Matrix,this.transform=null}return ProjectionSystem.prototype.update=function(destinationFrame,sourceFrame,resolution,root){this.destinationFrame=destinationFrame||this.destinationFrame||this.defaultFrame,this.sourceFrame=sourceFrame||this.sourceFrame||destinationFrame,this.calculateProjection(this.destinationFrame,this.sourceFrame,resolution,root),this.transform&&this.projectionMatrix.append(this.transform);var renderer=this.renderer;renderer.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,renderer.globalUniforms.update(),renderer.shader.shader&&renderer.shader.syncUniformGroup(renderer.shader.shader.uniforms.globals)},ProjectionSystem.prototype.calculateProjection=function(_destinationFrame,sourceFrame,_resolution,root){var pm=this.projectionMatrix,sign=root?-1:1;pm.identity(),pm.a=1/sourceFrame.width*2,pm.d=sign*(1/sourceFrame.height*2),pm.tx=-1-sourceFrame.x*pm.a,pm.ty=-sign-sourceFrame.y*pm.d},ProjectionSystem.prototype.setTransform=function(_matrix){},ProjectionSystem.prototype.destroy=function(){this.renderer=null},ProjectionSystem}(),tempRect=new Rectangle,tempRect2=new Rectangle,RenderTextureSystem=function(){function RenderTextureSystem(renderer){this.renderer=renderer,this.clearColor=renderer._backgroundColorRgba,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new Rectangle,this.destinationFrame=new Rectangle,this.viewportFrame=new Rectangle}return RenderTextureSystem.prototype.bind=function(renderTexture,sourceFrame,destinationFrame){void 0===renderTexture&&(renderTexture=null);var baseTexture,framebuffer,resolution,renderer=this.renderer;this.current=renderTexture,renderTexture?(resolution=(baseTexture=renderTexture.baseTexture).resolution,sourceFrame||(tempRect.width=renderTexture.frame.width,tempRect.height=renderTexture.frame.height,sourceFrame=tempRect),destinationFrame||(tempRect2.x=renderTexture.frame.x,tempRect2.y=renderTexture.frame.y,tempRect2.width=sourceFrame.width,tempRect2.height=sourceFrame.height,destinationFrame=tempRect2),framebuffer=baseTexture.framebuffer):(resolution=renderer.resolution,sourceFrame||(tempRect.width=renderer.screen.width,tempRect.height=renderer.screen.height,sourceFrame=tempRect),destinationFrame||((destinationFrame=tempRect).width=sourceFrame.width,destinationFrame.height=sourceFrame.height));var viewportFrame=this.viewportFrame;viewportFrame.x=destinationFrame.x*resolution,viewportFrame.y=destinationFrame.y*resolution,viewportFrame.width=destinationFrame.width*resolution,viewportFrame.height=destinationFrame.height*resolution,renderTexture||(viewportFrame.y=renderer.view.height-(viewportFrame.y+viewportFrame.height)),viewportFrame.ceil(),this.renderer.framebuffer.bind(framebuffer,viewportFrame),this.renderer.projection.update(destinationFrame,sourceFrame,resolution,!framebuffer),renderTexture?this.renderer.mask.setMaskStack(baseTexture.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(sourceFrame),this.destinationFrame.copyFrom(destinationFrame)},RenderTextureSystem.prototype.clear=function(clearColor,mask){clearColor=this.current?clearColor||this.current.baseTexture.clearColor:clearColor||this.clearColor;var destinationFrame=this.destinationFrame,baseFrame=this.current?this.current.baseTexture:this.renderer.screen,clearMask=destinationFrame.width!==baseFrame.width||destinationFrame.height!==baseFrame.height;if(clearMask){var _a=this.viewportFrame,x=_a.x,y=_a.y,width=_a.width,height=_a.height;x=Math.round(x),y=Math.round(y),width=Math.round(width),height=Math.round(height),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(x,y,width,height)}this.renderer.framebuffer.clear(clearColor[0],clearColor[1],clearColor[2],clearColor[3],mask),clearMask&&this.renderer.scissor.pop()},RenderTextureSystem.prototype.resize=function(){this.bind(null)},RenderTextureSystem.prototype.reset=function(){this.bind(null)},RenderTextureSystem.prototype.destroy=function(){this.renderer=null},RenderTextureSystem}();function uboUpdate(_ud,_uv,_renderer,_syncData,buffer){_renderer.buffer.update(buffer)}var UBO_TO_SINGLE_SETTERS={float:"\n        data[offset] = v;\n    ",vec2:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n    ",vec3:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n\n    ",vec4:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n        data[offset+3] = v[3];\n    ",mat2:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n\n        data[offset+4] = v[2];\n        data[offset+5] = v[3];\n    ",mat3:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n\n        data[offset + 4] = v[3];\n        data[offset + 5] = v[4];\n        data[offset + 6] = v[5];\n\n        data[offset + 8] = v[6];\n        data[offset + 9] = v[7];\n        data[offset + 10] = v[8];\n    ",mat4:"\n        for(var i = 0; i < 16; i++)\n        {\n            data[offset + i] = v[i];\n        }\n    "},GLSL_TO_STD40_SIZE={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:32,mat3:48,mat4:64};function generateUniformBufferSync(group,uniformData){if(!group.autoManage)return{size:0,syncFunc:uboUpdate};for(var usedUniformDatas=function(uniforms,uniformData){var usedUniformDatas=[];for(var i in uniforms)uniformData[i]&&usedUniformDatas.push(uniformData[i]);return usedUniformDatas.sort((function(a,b){return a.index-b.index})),usedUniformDatas}(group.uniforms,uniformData),_a=function(uniformData){for(var uboElements=uniformData.map((function(data){return{data,offset:0,dataLen:0,dirty:0}})),size=0,chunkSize=0,offset=0,i=0;i<uboElements.length;i++){var uboElement=uboElements[i];if(size=GLSL_TO_STD40_SIZE[uboElement.data.type],uboElement.data.size>1&&(size=Math.max(size,16)*uboElement.data.size),uboElement.dataLen=size,chunkSize%size!=0&&chunkSize<16){var lineUpValue=chunkSize%size%16;chunkSize+=lineUpValue,offset+=lineUpValue}chunkSize+size>16?(offset=16*Math.ceil(offset/16),uboElement.offset=offset,offset+=size,chunkSize=size):(uboElement.offset=offset,chunkSize+=size,offset+=size)}return{uboElements,size:offset=16*Math.ceil(offset/16)}}(usedUniformDatas),uboElements=_a.uboElements,size=_a.size,funcFragments=["\n    var v = null;\n    var v2 = null;\n    var cv = null;\n    var t = 0;\n    var gl = renderer.gl\n    var index = 0;\n    var data = buffer.data;\n    "],i=0;i<uboElements.length;i++){for(var uboElement=uboElements[i],uniform=group.uniforms[uboElement.data.name],name=uboElement.data.name,parsed=!1,j=0;j<uniformParsers.length;j++){var uniformParser=uniformParsers[j];if(uniformParser.codeUbo&&uniformParser.test(uboElement.data,uniform)){funcFragments.push("offset = "+uboElement.offset/4+";",uniformParsers[j].codeUbo(uboElement.data.name,uniform)),parsed=!0;break}}if(!parsed)if(uboElement.data.size>1){var size_1=mapSize(uboElement.data.type),rowSize=Math.max(GLSL_TO_STD40_SIZE[uboElement.data.type]/16,1),elementSize=size_1/rowSize,remainder=(4-elementSize%4)%4;funcFragments.push("\n                cv = ud."+name+".value;\n                v = uv."+name+";\n                offset = "+uboElement.offset/4+";\n\n                t = 0;\n\n                for(var i=0; i < "+uboElement.data.size*rowSize+"; i++)\n                {\n                    for(var j = 0; j < "+elementSize+"; j++)\n                    {\n                        data[offset++] = v[t++];\n                    }\n                    offset += "+remainder+";\n                }\n\n                ")}else{var template=UBO_TO_SINGLE_SETTERS[uboElement.data.type];funcFragments.push("\n                cv = ud."+name+".value;\n                v = uv."+name+";\n                offset = "+uboElement.offset/4+";\n                "+template+";\n                ")}}return funcFragments.push("\n       renderer.buffer.update(buffer);\n    "),{size,syncFunc:new Function("ud","uv","renderer","syncData","buffer",funcFragments.join("\n"))}}var GLProgram=function(){function GLProgram(program,uniformData){this.program=program,this.uniformData=uniformData,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}return GLProgram.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null},GLProgram}();function generateProgram(gl,program){var glVertShader=compileShader(gl,gl.VERTEX_SHADER,program.vertexSrc),glFragShader=compileShader(gl,gl.FRAGMENT_SHADER,program.fragmentSrc),webGLProgram=gl.createProgram();if(gl.attachShader(webGLProgram,glVertShader),gl.attachShader(webGLProgram,glFragShader),gl.linkProgram(webGLProgram),gl.getProgramParameter(webGLProgram,gl.LINK_STATUS)||function(gl,program,vertexShader,fragmentShader){gl.getProgramParameter(program,gl.LINK_STATUS)||(gl.getShaderParameter(vertexShader,gl.COMPILE_STATUS)||logPrettyShaderError(gl,vertexShader),gl.getShaderParameter(fragmentShader,gl.COMPILE_STATUS)||logPrettyShaderError(gl,fragmentShader),console.error("PixiJS Error: Could not initialize shader."),""!==gl.getProgramInfoLog(program)&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",gl.getProgramInfoLog(program)))}(gl,webGLProgram,glVertShader,glFragShader),program.attributeData=function(program,gl){for(var attributes={},totalAttributes=gl.getProgramParameter(program,gl.ACTIVE_ATTRIBUTES),i=0;i<totalAttributes;i++){var attribData=gl.getActiveAttrib(program,i);if(0!==attribData.name.indexOf("gl_")){var type=mapType(gl,attribData.type),data={type,name:attribData.name,size:mapSize(type),location:gl.getAttribLocation(program,attribData.name)};attributes[attribData.name]=data}}return attributes}(webGLProgram,gl),program.uniformData=function(program,gl){for(var uniforms={},totalUniforms=gl.getProgramParameter(program,gl.ACTIVE_UNIFORMS),i=0;i<totalUniforms;i++){var uniformData=gl.getActiveUniform(program,i),name=uniformData.name.replace(/\[.*?\]$/,""),isArray=!!uniformData.name.match(/\[.*?\]$/),type=mapType(gl,uniformData.type);uniforms[name]={name,index:i,type,size:uniformData.size,isArray,value:defaultValue(type,uniformData.size)}}return uniforms}(webGLProgram,gl),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(program.vertexSrc)){var keys=Object.keys(program.attributeData);keys.sort((function(a,b){return a>b?1:-1}));for(var i=0;i<keys.length;i++)program.attributeData[keys[i]].location=i,gl.bindAttribLocation(webGLProgram,i,keys[i]);gl.linkProgram(webGLProgram)}gl.deleteShader(glVertShader),gl.deleteShader(glFragShader);var uniformData={};for(var i in program.uniformData){var data=program.uniformData[i];uniformData[i]={location:gl.getUniformLocation(webGLProgram,i),value:defaultValue(data.type,data.size)}}return new GLProgram(webGLProgram,uniformData)}var UID$4=0,defaultSyncData={textureCount:0,uboCount:0},ShaderSystem=function(){function ShaderSystem(renderer){this.destroyed=!1,this.renderer=renderer,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=UID$4++}return ShaderSystem.prototype.systemCheck=function(){if(!function(){if("boolean"==typeof unsafeEval)return unsafeEval;try{var func=new Function("param1","param2","param3","return param1[param2] === param3;");unsafeEval=!0===func({a:"b"},"a","b")}catch(e){unsafeEval=!1}return unsafeEval}())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},ShaderSystem.prototype.contextChange=function(gl){this.gl=gl,this.reset()},ShaderSystem.prototype.bind=function(shader,dontSync){shader.uniforms.globals=this.renderer.globalUniforms;var program=shader.program,glProgram=program.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(shader);return this.shader=shader,this.program!==program&&(this.program=program,this.gl.useProgram(glProgram.program)),dontSync||(defaultSyncData.textureCount=0,defaultSyncData.uboCount=0,this.syncUniformGroup(shader.uniformGroup,defaultSyncData)),glProgram},ShaderSystem.prototype.setUniforms=function(uniforms){var shader=this.shader.program,glProgram=shader.glPrograms[this.renderer.CONTEXT_UID];shader.syncUniforms(glProgram.uniformData,uniforms,this.renderer)},ShaderSystem.prototype.syncUniformGroup=function(group,syncData){var glProgram=this.getGlProgram();group.static&&group.dirtyId===glProgram.uniformDirtyGroups[group.id]||(glProgram.uniformDirtyGroups[group.id]=group.dirtyId,this.syncUniforms(group,glProgram,syncData))},ShaderSystem.prototype.syncUniforms=function(group,glProgram,syncData){(group.syncUniforms[this.shader.program.id]||this.createSyncGroups(group))(glProgram.uniformData,group.uniforms,this.renderer,syncData)},ShaderSystem.prototype.createSyncGroups=function(group){var id=this.getSignature(group,this.shader.program.uniformData,"u");return this.cache[id]||(this.cache[id]=function(group,uniformData){var _a,funcFragments=["\n        var v = null;\n        var cv = null;\n        var cu = null;\n        var t = 0;\n        var gl = renderer.gl;\n    "];for(var i in group.uniforms){var data=uniformData[i];if(data){for(var uniform=group.uniforms[i],parsed=!1,j=0;j<uniformParsers.length;j++)if(uniformParsers[j].test(data,uniform)){funcFragments.push(uniformParsers[j].code(i,uniform)),parsed=!0;break}if(!parsed){var template=(1===data.size?GLSL_TO_SINGLE_SETTERS_CACHED:GLSL_TO_ARRAY_SETTERS)[data.type].replace("location",'ud["'+i+'"].location');funcFragments.push('\n            cu = ud["'+i+'"];\n            cv = cu.value;\n            v = uv["'+i+'"];\n            '+template+";")}}else(null===(_a=group.uniforms[i])||void 0===_a?void 0:_a.group)&&(group.uniforms[i].ubo?funcFragments.push("\n                        renderer.shader.syncUniformBufferGroup(uv."+i+", '"+i+"');\n                    "):funcFragments.push("\n                        renderer.shader.syncUniformGroup(uv."+i+", syncData);\n                    "))}return new Function("ud","uv","renderer","syncData",funcFragments.join("\n"))}(group,this.shader.program.uniformData)),group.syncUniforms[this.shader.program.id]=this.cache[id],group.syncUniforms[this.shader.program.id]},ShaderSystem.prototype.syncUniformBufferGroup=function(group,name){var glProgram=this.getGlProgram();if(!group.static||0!==group.dirtyId||!glProgram.uniformGroups[group.id]){group.dirtyId=0;var syncFunc=glProgram.uniformGroups[group.id]||this.createSyncBufferGroup(group,glProgram,name);group.buffer.update(),syncFunc(glProgram.uniformData,group.uniforms,this.renderer,defaultSyncData,group.buffer)}this.renderer.buffer.bindBufferBase(group.buffer,glProgram.uniformBufferBindings[name])},ShaderSystem.prototype.createSyncBufferGroup=function(group,glProgram,name){var gl=this.renderer.gl;this.renderer.buffer.bind(group.buffer);var uniformBlockIndex=this.gl.getUniformBlockIndex(glProgram.program,name);glProgram.uniformBufferBindings[name]=this.shader.uniformBindCount,gl.uniformBlockBinding(glProgram.program,uniformBlockIndex,this.shader.uniformBindCount),this.shader.uniformBindCount++;var id=this.getSignature(group,this.shader.program.uniformData,"ubo"),uboData=this._uboCache[id];if(uboData||(uboData=this._uboCache[id]=generateUniformBufferSync(group,this.shader.program.uniformData)),group.autoManage){var data=new Float32Array(uboData.size/4);group.buffer.update(data)}return glProgram.uniformGroups[group.id]=uboData.syncFunc,glProgram.uniformGroups[group.id]},ShaderSystem.prototype.getSignature=function(group,uniformData,preFix){var uniforms=group.uniforms,strings=[preFix+"-"];for(var i in uniforms)strings.push(i),uniformData[i]&&strings.push(uniformData[i].type);return strings.join("-")},ShaderSystem.prototype.getGlProgram=function(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},ShaderSystem.prototype.generateProgram=function(shader){var gl=this.gl,program=shader.program,glProgram=generateProgram(gl,program);return program.glPrograms[this.renderer.CONTEXT_UID]=glProgram,glProgram},ShaderSystem.prototype.reset=function(){this.program=null,this.shader=null},ShaderSystem.prototype.destroy=function(){this.renderer=null,this.destroyed=!0},ShaderSystem}();var StateSystem=function(){function StateSystem(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=constants_BLEND_MODES.NONE,this._blendEq=!1,this.map=[],this.map[0]=this.setBlend,this.map[1]=this.setOffset,this.map[2]=this.setCullFace,this.map[3]=this.setDepthTest,this.map[4]=this.setFrontFace,this.map[5]=this.setDepthMask,this.checks=[],this.defaultState=new State,this.defaultState.blend=!0}return StateSystem.prototype.contextChange=function(gl){this.gl=gl,this.blendModes=function(gl,array){return void 0===array&&(array=[]),array[constants_BLEND_MODES.NORMAL]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA],array[constants_BLEND_MODES.ADD]=[gl.ONE,gl.ONE],array[constants_BLEND_MODES.MULTIPLY]=[gl.DST_COLOR,gl.ONE_MINUS_SRC_ALPHA,gl.ONE,gl.ONE_MINUS_SRC_ALPHA],array[constants_BLEND_MODES.SCREEN]=[gl.ONE,gl.ONE_MINUS_SRC_COLOR,gl.ONE,gl.ONE_MINUS_SRC_ALPHA],array[constants_BLEND_MODES.OVERLAY]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA],array[constants_BLEND_MODES.DARKEN]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA],array[constants_BLEND_MODES.LIGHTEN]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA],array[constants_BLEND_MODES.COLOR_DODGE]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA],array[constants_BLEND_MODES.COLOR_BURN]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA],array[constants_BLEND_MODES.HARD_LIGHT]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA],array[constants_BLEND_MODES.SOFT_LIGHT]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA],array[constants_BLEND_MODES.DIFFERENCE]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA],array[constants_BLEND_MODES.EXCLUSION]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA],array[constants_BLEND_MODES.HUE]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA],array[constants_BLEND_MODES.SATURATION]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA],array[constants_BLEND_MODES.COLOR]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA],array[constants_BLEND_MODES.LUMINOSITY]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA],array[constants_BLEND_MODES.NONE]=[0,0],array[constants_BLEND_MODES.NORMAL_NPM]=[gl.SRC_ALPHA,gl.ONE_MINUS_SRC_ALPHA,gl.ONE,gl.ONE_MINUS_SRC_ALPHA],array[constants_BLEND_MODES.ADD_NPM]=[gl.SRC_ALPHA,gl.ONE,gl.ONE,gl.ONE],array[constants_BLEND_MODES.SCREEN_NPM]=[gl.SRC_ALPHA,gl.ONE_MINUS_SRC_COLOR,gl.ONE,gl.ONE_MINUS_SRC_ALPHA],array[constants_BLEND_MODES.SRC_IN]=[gl.DST_ALPHA,gl.ZERO],array[constants_BLEND_MODES.SRC_OUT]=[gl.ONE_MINUS_DST_ALPHA,gl.ZERO],array[constants_BLEND_MODES.SRC_ATOP]=[gl.DST_ALPHA,gl.ONE_MINUS_SRC_ALPHA],array[constants_BLEND_MODES.DST_OVER]=[gl.ONE_MINUS_DST_ALPHA,gl.ONE],array[constants_BLEND_MODES.DST_IN]=[gl.ZERO,gl.SRC_ALPHA],array[constants_BLEND_MODES.DST_OUT]=[gl.ZERO,gl.ONE_MINUS_SRC_ALPHA],array[constants_BLEND_MODES.DST_ATOP]=[gl.ONE_MINUS_DST_ALPHA,gl.SRC_ALPHA],array[constants_BLEND_MODES.XOR]=[gl.ONE_MINUS_DST_ALPHA,gl.ONE_MINUS_SRC_ALPHA],array[constants_BLEND_MODES.SUBTRACT]=[gl.ONE,gl.ONE,gl.ONE,gl.ONE,gl.FUNC_REVERSE_SUBTRACT,gl.FUNC_ADD],array}(gl),this.set(this.defaultState),this.reset()},StateSystem.prototype.set=function(state){if(state=state||this.defaultState,this.stateId!==state.data){for(var diff=this.stateId^state.data,i=0;diff;)1&diff&&this.map[i].call(this,!!(state.data&1<<i)),diff>>=1,i++;this.stateId=state.data}for(i=0;i<this.checks.length;i++)this.checks[i](this,state)},StateSystem.prototype.forceState=function(state){state=state||this.defaultState;for(var i=0;i<this.map.length;i++)this.map[i].call(this,!!(state.data&1<<i));for(i=0;i<this.checks.length;i++)this.checks[i](this,state);this.stateId=state.data},StateSystem.prototype.setBlend=function(value){this.updateCheck(StateSystem.checkBlendMode,value),this.gl[value?"enable":"disable"](this.gl.BLEND)},StateSystem.prototype.setOffset=function(value){this.updateCheck(StateSystem.checkPolygonOffset,value),this.gl[value?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)},StateSystem.prototype.setDepthTest=function(value){this.gl[value?"enable":"disable"](this.gl.DEPTH_TEST)},StateSystem.prototype.setDepthMask=function(value){this.gl.depthMask(value)},StateSystem.prototype.setCullFace=function(value){this.gl[value?"enable":"disable"](this.gl.CULL_FACE)},StateSystem.prototype.setFrontFace=function(value){this.gl.frontFace(this.gl[value?"CW":"CCW"])},StateSystem.prototype.setBlendMode=function(value){if(value!==this.blendMode){this.blendMode=value;var mode=this.blendModes[value],gl=this.gl;2===mode.length?gl.blendFunc(mode[0],mode[1]):gl.blendFuncSeparate(mode[0],mode[1],mode[2],mode[3]),6===mode.length?(this._blendEq=!0,gl.blendEquationSeparate(mode[4],mode[5])):this._blendEq&&(this._blendEq=!1,gl.blendEquationSeparate(gl.FUNC_ADD,gl.FUNC_ADD))}},StateSystem.prototype.setPolygonOffset=function(value,scale){this.gl.polygonOffset(value,scale)},StateSystem.prototype.reset=function(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},StateSystem.prototype.updateCheck=function(func,value){var index=this.checks.indexOf(func);value&&-1===index?this.checks.push(func):value||-1===index||this.checks.splice(index,1)},StateSystem.checkBlendMode=function(system,state){system.setBlendMode(state.blendMode)},StateSystem.checkPolygonOffset=function(system,state){system.setPolygonOffset(1,state.polygonOffset)},StateSystem.prototype.destroy=function(){this.gl=null},StateSystem}(),TextureGCSystem=function(){function TextureGCSystem(renderer){this.renderer=renderer,this.count=0,this.checkCount=0,this.maxIdle=settings.GC_MAX_IDLE,this.checkCountMax=settings.GC_MAX_CHECK_COUNT,this.mode=settings.GC_MODE}return TextureGCSystem.prototype.postrender=function(){this.renderer.renderingToScreen&&(this.count++,this.mode!==constants_GC_MODES.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))},TextureGCSystem.prototype.run=function(){for(var tm=this.renderer.texture,managedTextures=tm.managedTextures,wasRemoved=!1,i=0;i<managedTextures.length;i++){var texture=managedTextures[i];!texture.framebuffer&&this.count-texture.touched>this.maxIdle&&(tm.destroyTexture(texture,!0),managedTextures[i]=null,wasRemoved=!0)}if(wasRemoved){var j=0;for(i=0;i<managedTextures.length;i++)null!==managedTextures[i]&&(managedTextures[j++]=managedTextures[i]);managedTextures.length=j}},TextureGCSystem.prototype.unload=function(displayObject){var tm=this.renderer.texture,texture=displayObject._texture;texture&&!texture.framebuffer&&tm.destroyTexture(texture);for(var i=displayObject.children.length-1;i>=0;i--)this.unload(displayObject.children[i])},TextureGCSystem.prototype.destroy=function(){this.renderer=null},TextureGCSystem}();var GLTexture=function(texture){this.texture=texture,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=constants_TYPES.UNSIGNED_BYTE,this.internalFormat=constants_FORMATS.RGBA,this.samplerType=0},TextureSystem=function(){function TextureSystem(renderer){this.renderer=renderer,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new BaseTexture,this.hasIntegerTextures=!1}return TextureSystem.prototype.contextChange=function(){var gl=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=function(gl){var _a,_b,_c,_d,_e,_f,_g,_h,_j,_k,_l,_m,_o,_p,_q,_r,_s,_t,_u,_v,_w,_x,table;return"WebGL2RenderingContext"in globalThis&&gl instanceof globalThis.WebGL2RenderingContext?((_a={})[constants_TYPES.UNSIGNED_BYTE]=((_b={})[constants_FORMATS.RGBA]=gl.RGBA8,_b[constants_FORMATS.RGB]=gl.RGB8,_b[constants_FORMATS.RG]=gl.RG8,_b[constants_FORMATS.RED]=gl.R8,_b[constants_FORMATS.RGBA_INTEGER]=gl.RGBA8UI,_b[constants_FORMATS.RGB_INTEGER]=gl.RGB8UI,_b[constants_FORMATS.RG_INTEGER]=gl.RG8UI,_b[constants_FORMATS.RED_INTEGER]=gl.R8UI,_b[constants_FORMATS.ALPHA]=gl.ALPHA,_b[constants_FORMATS.LUMINANCE]=gl.LUMINANCE,_b[constants_FORMATS.LUMINANCE_ALPHA]=gl.LUMINANCE_ALPHA,_b),_a[constants_TYPES.BYTE]=((_c={})[constants_FORMATS.RGBA]=gl.RGBA8_SNORM,_c[constants_FORMATS.RGB]=gl.RGB8_SNORM,_c[constants_FORMATS.RG]=gl.RG8_SNORM,_c[constants_FORMATS.RED]=gl.R8_SNORM,_c[constants_FORMATS.RGBA_INTEGER]=gl.RGBA8I,_c[constants_FORMATS.RGB_INTEGER]=gl.RGB8I,_c[constants_FORMATS.RG_INTEGER]=gl.RG8I,_c[constants_FORMATS.RED_INTEGER]=gl.R8I,_c),_a[constants_TYPES.UNSIGNED_SHORT]=((_d={})[constants_FORMATS.RGBA_INTEGER]=gl.RGBA16UI,_d[constants_FORMATS.RGB_INTEGER]=gl.RGB16UI,_d[constants_FORMATS.RG_INTEGER]=gl.RG16UI,_d[constants_FORMATS.RED_INTEGER]=gl.R16UI,_d[constants_FORMATS.DEPTH_COMPONENT]=gl.DEPTH_COMPONENT16,_d),_a[constants_TYPES.SHORT]=((_e={})[constants_FORMATS.RGBA_INTEGER]=gl.RGBA16I,_e[constants_FORMATS.RGB_INTEGER]=gl.RGB16I,_e[constants_FORMATS.RG_INTEGER]=gl.RG16I,_e[constants_FORMATS.RED_INTEGER]=gl.R16I,_e),_a[constants_TYPES.UNSIGNED_INT]=((_f={})[constants_FORMATS.RGBA_INTEGER]=gl.RGBA32UI,_f[constants_FORMATS.RGB_INTEGER]=gl.RGB32UI,_f[constants_FORMATS.RG_INTEGER]=gl.RG32UI,_f[constants_FORMATS.RED_INTEGER]=gl.R32UI,_f[constants_FORMATS.DEPTH_COMPONENT]=gl.DEPTH_COMPONENT24,_f),_a[constants_TYPES.INT]=((_g={})[constants_FORMATS.RGBA_INTEGER]=gl.RGBA32I,_g[constants_FORMATS.RGB_INTEGER]=gl.RGB32I,_g[constants_FORMATS.RG_INTEGER]=gl.RG32I,_g[constants_FORMATS.RED_INTEGER]=gl.R32I,_g),_a[constants_TYPES.FLOAT]=((_h={})[constants_FORMATS.RGBA]=gl.RGBA32F,_h[constants_FORMATS.RGB]=gl.RGB32F,_h[constants_FORMATS.RG]=gl.RG32F,_h[constants_FORMATS.RED]=gl.R32F,_h[constants_FORMATS.DEPTH_COMPONENT]=gl.DEPTH_COMPONENT32F,_h),_a[constants_TYPES.HALF_FLOAT]=((_j={})[constants_FORMATS.RGBA]=gl.RGBA16F,_j[constants_FORMATS.RGB]=gl.RGB16F,_j[constants_FORMATS.RG]=gl.RG16F,_j[constants_FORMATS.RED]=gl.R16F,_j),_a[constants_TYPES.UNSIGNED_SHORT_5_6_5]=((_k={})[constants_FORMATS.RGB]=gl.RGB565,_k),_a[constants_TYPES.UNSIGNED_SHORT_4_4_4_4]=((_l={})[constants_FORMATS.RGBA]=gl.RGBA4,_l),_a[constants_TYPES.UNSIGNED_SHORT_5_5_5_1]=((_m={})[constants_FORMATS.RGBA]=gl.RGB5_A1,_m),_a[constants_TYPES.UNSIGNED_INT_2_10_10_10_REV]=((_o={})[constants_FORMATS.RGBA]=gl.RGB10_A2,_o[constants_FORMATS.RGBA_INTEGER]=gl.RGB10_A2UI,_o),_a[constants_TYPES.UNSIGNED_INT_10F_11F_11F_REV]=((_p={})[constants_FORMATS.RGB]=gl.R11F_G11F_B10F,_p),_a[constants_TYPES.UNSIGNED_INT_5_9_9_9_REV]=((_q={})[constants_FORMATS.RGB]=gl.RGB9_E5,_q),_a[constants_TYPES.UNSIGNED_INT_24_8]=((_r={})[constants_FORMATS.DEPTH_STENCIL]=gl.DEPTH24_STENCIL8,_r),_a[constants_TYPES.FLOAT_32_UNSIGNED_INT_24_8_REV]=((_s={})[constants_FORMATS.DEPTH_STENCIL]=gl.DEPTH32F_STENCIL8,_s),table=_a):((_t={})[constants_TYPES.UNSIGNED_BYTE]=((_u={})[constants_FORMATS.RGBA]=gl.RGBA,_u[constants_FORMATS.RGB]=gl.RGB,_u[constants_FORMATS.ALPHA]=gl.ALPHA,_u[constants_FORMATS.LUMINANCE]=gl.LUMINANCE,_u[constants_FORMATS.LUMINANCE_ALPHA]=gl.LUMINANCE_ALPHA,_u),_t[constants_TYPES.UNSIGNED_SHORT_5_6_5]=((_v={})[constants_FORMATS.RGB]=gl.RGB,_v),_t[constants_TYPES.UNSIGNED_SHORT_4_4_4_4]=((_w={})[constants_FORMATS.RGBA]=gl.RGBA,_w),_t[constants_TYPES.UNSIGNED_SHORT_5_5_5_1]=((_x={})[constants_FORMATS.RGBA]=gl.RGBA,_x),table=_t),table}(gl);var maxTextures=gl.getParameter(gl.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=maxTextures;for(var i=0;i<maxTextures;i++)this.boundTextures[i]=null;this.emptyTextures={};var emptyTexture2D=new GLTexture(gl.createTexture());gl.bindTexture(gl.TEXTURE_2D,emptyTexture2D.texture),gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,1,1,0,gl.RGBA,gl.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[gl.TEXTURE_2D]=emptyTexture2D,this.emptyTextures[gl.TEXTURE_CUBE_MAP]=new GLTexture(gl.createTexture()),gl.bindTexture(gl.TEXTURE_CUBE_MAP,this.emptyTextures[gl.TEXTURE_CUBE_MAP].texture);for(i=0;i<6;i++)gl.texImage2D(gl.TEXTURE_CUBE_MAP_POSITIVE_X+i,0,gl.RGBA,1,1,0,gl.RGBA,gl.UNSIGNED_BYTE,null);gl.texParameteri(gl.TEXTURE_CUBE_MAP,gl.TEXTURE_MAG_FILTER,gl.LINEAR),gl.texParameteri(gl.TEXTURE_CUBE_MAP,gl.TEXTURE_MIN_FILTER,gl.LINEAR);for(i=0;i<this.boundTextures.length;i++)this.bind(null,i)},TextureSystem.prototype.bind=function(texture,location){void 0===location&&(location=0);var gl=this.gl;if((texture=null==texture?void 0:texture.castToBaseTexture())&&texture.valid&&!texture.parentTextureArray){texture.touched=this.renderer.textureGC.count;var glTexture=texture._glTextures[this.CONTEXT_UID]||this.initTexture(texture);this.boundTextures[location]!==texture&&(this.currentLocation!==location&&(this.currentLocation=location,gl.activeTexture(gl.TEXTURE0+location)),gl.bindTexture(texture.target,glTexture.texture)),glTexture.dirtyId!==texture.dirtyId&&(this.currentLocation!==location&&(this.currentLocation=location,gl.activeTexture(gl.TEXTURE0+location)),this.updateTexture(texture)),this.boundTextures[location]=texture}else this.currentLocation!==location&&(this.currentLocation=location,gl.activeTexture(gl.TEXTURE0+location)),gl.bindTexture(gl.TEXTURE_2D,this.emptyTextures[gl.TEXTURE_2D].texture),this.boundTextures[location]=null},TextureSystem.prototype.reset=function(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(var i=0;i<this.boundTextures.length;i++)this.boundTextures[i]=this.unknownTexture},TextureSystem.prototype.unbind=function(texture){var gl=this.gl,boundTextures=this.boundTextures;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var i=0;i<boundTextures.length;i++)boundTextures[i]===this.unknownTexture&&this.bind(null,i)}for(i=0;i<boundTextures.length;i++)boundTextures[i]===texture&&(this.currentLocation!==i&&(gl.activeTexture(gl.TEXTURE0+i),this.currentLocation=i),gl.bindTexture(texture.target,this.emptyTextures[texture.target].texture),boundTextures[i]=null)},TextureSystem.prototype.ensureSamplerType=function(maxTextures){var boundTextures=this.boundTextures,hasIntegerTextures=this.hasIntegerTextures,CONTEXT_UID=this.CONTEXT_UID;if(hasIntegerTextures)for(var i=maxTextures-1;i>=0;--i){var tex=boundTextures[i];if(tex)tex._glTextures[CONTEXT_UID].samplerType!==constants_SAMPLER_TYPES.FLOAT&&this.renderer.texture.unbind(tex)}},TextureSystem.prototype.initTexture=function(texture){var glTexture=new GLTexture(this.gl.createTexture());return glTexture.dirtyId=-1,texture._glTextures[this.CONTEXT_UID]=glTexture,this.managedTextures.push(texture),texture.on("dispose",this.destroyTexture,this),glTexture},TextureSystem.prototype.initTextureType=function(texture,glTexture){var _a,_b;glTexture.internalFormat=null!==(_b=null===(_a=this.internalFormats[texture.type])||void 0===_a?void 0:_a[texture.format])&&void 0!==_b?_b:texture.format,2===this.webGLVersion&&texture.type===constants_TYPES.HALF_FLOAT?glTexture.type=this.gl.HALF_FLOAT:glTexture.type=texture.type},TextureSystem.prototype.updateTexture=function(texture){var glTexture=texture._glTextures[this.CONTEXT_UID];if(glTexture){var renderer=this.renderer;if(this.initTextureType(texture,glTexture),texture.resource&&texture.resource.upload(renderer,texture,glTexture))glTexture.samplerType!==constants_SAMPLER_TYPES.FLOAT&&(this.hasIntegerTextures=!0);else{var width=texture.realWidth,height=texture.realHeight,gl=renderer.gl;(glTexture.width!==width||glTexture.height!==height||glTexture.dirtyId<0)&&(glTexture.width=width,glTexture.height=height,gl.texImage2D(texture.target,0,glTexture.internalFormat,width,height,0,texture.format,glTexture.type,null))}texture.dirtyStyleId!==glTexture.dirtyStyleId&&this.updateTextureStyle(texture),glTexture.dirtyId=texture.dirtyId}},TextureSystem.prototype.destroyTexture=function(texture,skipRemove){var gl=this.gl;if((texture=texture.castToBaseTexture())._glTextures[this.CONTEXT_UID]&&(this.unbind(texture),gl.deleteTexture(texture._glTextures[this.CONTEXT_UID].texture),texture.off("dispose",this.destroyTexture,this),delete texture._glTextures[this.CONTEXT_UID],!skipRemove)){var i=this.managedTextures.indexOf(texture);-1!==i&&removeItems(this.managedTextures,i,1)}},TextureSystem.prototype.updateTextureStyle=function(texture){var glTexture=texture._glTextures[this.CONTEXT_UID];glTexture&&(texture.mipmap!==constants_MIPMAP_MODES.POW2&&2===this.webGLVersion||texture.isPowerOfTwo?glTexture.mipmap=texture.mipmap>=1:glTexture.mipmap=!1,2===this.webGLVersion||texture.isPowerOfTwo?glTexture.wrapMode=texture.wrapMode:glTexture.wrapMode=constants_WRAP_MODES.CLAMP,texture.resource&&texture.resource.style(this.renderer,texture,glTexture)||this.setStyle(texture,glTexture),glTexture.dirtyStyleId=texture.dirtyStyleId)},TextureSystem.prototype.setStyle=function(texture,glTexture){var gl=this.gl;if(glTexture.mipmap&&texture.mipmap!==constants_MIPMAP_MODES.ON_MANUAL&&gl.generateMipmap(texture.target),gl.texParameteri(texture.target,gl.TEXTURE_WRAP_S,glTexture.wrapMode),gl.texParameteri(texture.target,gl.TEXTURE_WRAP_T,glTexture.wrapMode),glTexture.mipmap){gl.texParameteri(texture.target,gl.TEXTURE_MIN_FILTER,texture.scaleMode===constants_SCALE_MODES.LINEAR?gl.LINEAR_MIPMAP_LINEAR:gl.NEAREST_MIPMAP_NEAREST);var anisotropicExt=this.renderer.context.extensions.anisotropicFiltering;if(anisotropicExt&&texture.anisotropicLevel>0&&texture.scaleMode===constants_SCALE_MODES.LINEAR){var level=Math.min(texture.anisotropicLevel,gl.getParameter(anisotropicExt.MAX_TEXTURE_MAX_ANISOTROPY_EXT));gl.texParameterf(texture.target,anisotropicExt.TEXTURE_MAX_ANISOTROPY_EXT,level)}}else gl.texParameteri(texture.target,gl.TEXTURE_MIN_FILTER,texture.scaleMode===constants_SCALE_MODES.LINEAR?gl.LINEAR:gl.NEAREST);gl.texParameteri(texture.target,gl.TEXTURE_MAG_FILTER,texture.scaleMode===constants_SCALE_MODES.LINEAR?gl.LINEAR:gl.NEAREST)},TextureSystem.prototype.destroy=function(){this.renderer=null},TextureSystem}(),_systems={__proto__:null,FilterSystem,BatchSystem,ContextSystem,FramebufferSystem,GeometrySystem,MaskSystem,ScissorSystem,StencilSystem,ProjectionSystem,RenderTextureSystem,ShaderSystem,StateSystem,TextureGCSystem,TextureSystem},tempMatrix$2=new Matrix,AbstractRenderer=function(_super){function AbstractRenderer(type,options){void 0===type&&(type=constants_RENDERER_TYPE.UNKNOWN);var _this=_super.call(this)||this;return options=Object.assign({},settings.RENDER_OPTIONS,options),_this.options=options,_this.type=type,_this.screen=new Rectangle(0,0,options.width,options.height),_this.view=options.view||document.createElement("canvas"),_this.resolution=options.resolution||settings.RESOLUTION,_this.useContextAlpha=options.useContextAlpha,_this.autoDensity=!!options.autoDensity,_this.preserveDrawingBuffer=options.preserveDrawingBuffer,_this.clearBeforeRender=options.clearBeforeRender,_this._backgroundColor=0,_this._backgroundColorRgba=[0,0,0,1],_this._backgroundColorString="#000000",_this.backgroundColor=options.backgroundColor||_this._backgroundColor,_this.backgroundAlpha=options.backgroundAlpha,void 0!==options.transparent&&(deprecation("6.0.0","Option transparent is deprecated, please use backgroundAlpha instead."),_this.useContextAlpha=options.transparent,_this.backgroundAlpha=options.transparent?0:1),_this._lastObjectRendered=null,_this.plugins={},_this}return core_extends(AbstractRenderer,_super),AbstractRenderer.prototype.initPlugins=function(staticMap){for(var o in staticMap)this.plugins[o]=new staticMap[o](this)},Object.defineProperty(AbstractRenderer.prototype,"width",{get:function(){return this.view.width},enumerable:!1,configurable:!0}),Object.defineProperty(AbstractRenderer.prototype,"height",{get:function(){return this.view.height},enumerable:!1,configurable:!0}),AbstractRenderer.prototype.resize=function(desiredScreenWidth,desiredScreenHeight){this.view.width=Math.round(desiredScreenWidth*this.resolution),this.view.height=Math.round(desiredScreenHeight*this.resolution);var screenWidth=this.view.width/this.resolution,screenHeight=this.view.height/this.resolution;this.screen.width=screenWidth,this.screen.height=screenHeight,this.autoDensity&&(this.view.style.width=screenWidth+"px",this.view.style.height=screenHeight+"px"),this.emit("resize",screenWidth,screenHeight)},AbstractRenderer.prototype.generateTexture=function(displayObject,options,resolution,region){void 0===options&&(options={}),"number"==typeof options&&(deprecation("6.1.0","generateTexture options (scaleMode, resolution, region) are now object options."),options={scaleMode:options,resolution,region});var manualRegion=options.region,textureOptions=function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&(t[p[i]]=s[p[i]])}return t}(options,["region"]);0===(region=manualRegion||displayObject.getLocalBounds(null,!0)).width&&(region.width=1),0===region.height&&(region.height=1);var renderTexture=RenderTexture.create(__assign({width:region.width,height:region.height},textureOptions));return tempMatrix$2.tx=-region.x,tempMatrix$2.ty=-region.y,this.render(displayObject,{renderTexture,clear:!1,transform:tempMatrix$2,skipUpdateTransform:!!displayObject.parent}),renderTexture},AbstractRenderer.prototype.destroy=function(removeView){for(var o in this.plugins)this.plugins[o].destroy(),this.plugins[o]=null;removeView&&this.view.parentNode&&this.view.parentNode.removeChild(this.view);this.plugins=null,this.type=constants_RENDERER_TYPE.UNKNOWN,this.view=null,this.screen=null,this._tempDisplayObjectParent=null,this.options=null,this._backgroundColorRgba=null,this._backgroundColorString=null,this._lastObjectRendered=null},Object.defineProperty(AbstractRenderer.prototype,"backgroundColor",{get:function(){return this._backgroundColor},set:function(value){this._backgroundColor=value,this._backgroundColorString=hex2string(value),hex2rgb(value,this._backgroundColorRgba)},enumerable:!1,configurable:!0}),Object.defineProperty(AbstractRenderer.prototype,"backgroundAlpha",{get:function(){return this._backgroundColorRgba[3]},set:function(value){this._backgroundColorRgba[3]=value},enumerable:!1,configurable:!0}),AbstractRenderer}(eventemitter3_default()),GLBuffer=function(buffer){this.buffer=buffer||null,this.updateID=-1,this.byteLength=-1,this.refCount=0},BufferSystem=function(){function BufferSystem(renderer){this.renderer=renderer,this.managedBuffers={},this.boundBufferBases={}}return BufferSystem.prototype.destroy=function(){this.renderer=null},BufferSystem.prototype.contextChange=function(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID},BufferSystem.prototype.bind=function(buffer){var gl=this.gl,CONTEXT_UID=this.CONTEXT_UID,glBuffer=buffer._glBuffers[CONTEXT_UID]||this.createGLBuffer(buffer);gl.bindBuffer(buffer.type,glBuffer.buffer)},BufferSystem.prototype.bindBufferBase=function(buffer,index){var gl=this.gl,CONTEXT_UID=this.CONTEXT_UID;if(this.boundBufferBases[index]!==buffer){var glBuffer=buffer._glBuffers[CONTEXT_UID]||this.createGLBuffer(buffer);this.boundBufferBases[index]=buffer,gl.bindBufferBase(gl.UNIFORM_BUFFER,index,glBuffer.buffer)}},BufferSystem.prototype.bindBufferRange=function(buffer,index,offset){var gl=this.gl,CONTEXT_UID=this.CONTEXT_UID;offset=offset||0;var glBuffer=buffer._glBuffers[CONTEXT_UID]||this.createGLBuffer(buffer);gl.bindBufferRange(gl.UNIFORM_BUFFER,index||0,glBuffer.buffer,256*offset,256)},BufferSystem.prototype.update=function(buffer){var gl=this.gl,CONTEXT_UID=this.CONTEXT_UID,glBuffer=buffer._glBuffers[CONTEXT_UID];if(buffer._updateID!==glBuffer.updateID)if(glBuffer.updateID=buffer._updateID,gl.bindBuffer(buffer.type,glBuffer.buffer),glBuffer.byteLength>=buffer.data.byteLength)gl.bufferSubData(buffer.type,0,buffer.data);else{var drawType=buffer.static?gl.STATIC_DRAW:gl.DYNAMIC_DRAW;glBuffer.byteLength=buffer.data.byteLength,gl.bufferData(buffer.type,buffer.data,drawType)}},BufferSystem.prototype.dispose=function(buffer,contextLost){if(this.managedBuffers[buffer.id]){delete this.managedBuffers[buffer.id];var glBuffer=buffer._glBuffers[this.CONTEXT_UID],gl=this.gl;buffer.disposeRunner.remove(this),glBuffer&&(contextLost||gl.deleteBuffer(glBuffer.buffer),delete buffer._glBuffers[this.CONTEXT_UID])}},BufferSystem.prototype.disposeAll=function(contextLost){for(var all=Object.keys(this.managedBuffers),i=0;i<all.length;i++)this.dispose(this.managedBuffers[all[i]],contextLost)},BufferSystem.prototype.createGLBuffer=function(buffer){var CONTEXT_UID=this.CONTEXT_UID,gl=this.gl;return buffer._glBuffers[CONTEXT_UID]=new GLBuffer(gl.createBuffer()),this.managedBuffers[buffer.id]=buffer,buffer.disposeRunner.add(this),buffer._glBuffers[CONTEXT_UID]},BufferSystem}(),Renderer=function(_super){function Renderer(options){var _this=_super.call(this,constants_RENDERER_TYPE.WEBGL,options)||this;return options=_this.options,_this.gl=null,_this.CONTEXT_UID=0,_this.runners={destroy:new Runner("destroy"),contextChange:new Runner("contextChange"),reset:new Runner("reset"),update:new Runner("update"),postrender:new Runner("postrender"),prerender:new Runner("prerender"),resize:new Runner("resize")},_this.runners.contextChange.add(_this),_this.globalUniforms=new UniformGroup({projectionMatrix:new Matrix},!0),_this.addSystem(MaskSystem,"mask").addSystem(ContextSystem,"context").addSystem(StateSystem,"state").addSystem(ShaderSystem,"shader").addSystem(TextureSystem,"texture").addSystem(BufferSystem,"buffer").addSystem(GeometrySystem,"geometry").addSystem(FramebufferSystem,"framebuffer").addSystem(ScissorSystem,"scissor").addSystem(StencilSystem,"stencil").addSystem(ProjectionSystem,"projection").addSystem(TextureGCSystem,"textureGC").addSystem(FilterSystem,"filter").addSystem(RenderTextureSystem,"renderTexture").addSystem(BatchSystem,"batch"),_this.initPlugins(Renderer.__plugins),_this.multisample=void 0,options.context?_this.context.initFromContext(options.context):_this.context.initFromOptions({alpha:!!_this.useContextAlpha,antialias:options.antialias,premultipliedAlpha:_this.useContextAlpha&&"notMultiplied"!==_this.useContextAlpha,stencil:!0,preserveDrawingBuffer:options.preserveDrawingBuffer,powerPreference:_this.options.powerPreference}),_this.renderingToScreen=!0,sayHello(2===_this.context.webGLVersion?"WebGL 2":"WebGL 1"),_this.resize(_this.options.width,_this.options.height),_this}return core_extends(Renderer,_super),Renderer.create=function(options){if(void 0===supported&&(supported=function(){var contextOptions={stencil:!0,failIfMajorPerformanceCaveat:settings.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!globalThis.WebGLRenderingContext)return!1;var canvas=document.createElement("canvas"),gl=canvas.getContext("webgl",contextOptions)||canvas.getContext("experimental-webgl",contextOptions),success=!(!gl||!gl.getContextAttributes().stencil);if(gl){var loseContext=gl.getExtension("WEBGL_lose_context");loseContext&&loseContext.loseContext()}return gl=null,success}catch(e){return!1}}()),supported)return new Renderer(options);throw new Error('WebGL unsupported in this browser, use "pixi.js-legacy" for fallback canvas2d support.')},Renderer.prototype.contextChange=function(){var samples,gl=this.gl;if(1===this.context.webGLVersion){var framebuffer=gl.getParameter(gl.FRAMEBUFFER_BINDING);gl.bindFramebuffer(gl.FRAMEBUFFER,null),samples=gl.getParameter(gl.SAMPLES),gl.bindFramebuffer(gl.FRAMEBUFFER,framebuffer)}else{framebuffer=gl.getParameter(gl.DRAW_FRAMEBUFFER_BINDING);gl.bindFramebuffer(gl.DRAW_FRAMEBUFFER,null),samples=gl.getParameter(gl.SAMPLES),gl.bindFramebuffer(gl.DRAW_FRAMEBUFFER,framebuffer)}samples>=constants_MSAA_QUALITY.HIGH?this.multisample=constants_MSAA_QUALITY.HIGH:samples>=constants_MSAA_QUALITY.MEDIUM?this.multisample=constants_MSAA_QUALITY.MEDIUM:samples>=constants_MSAA_QUALITY.LOW?this.multisample=constants_MSAA_QUALITY.LOW:this.multisample=constants_MSAA_QUALITY.NONE},Renderer.prototype.addSystem=function(ClassRef,name){var system=new ClassRef(this);if(this[name])throw new Error('Whoops! The name "'+name+'" is already in use');for(var i in this[name]=system,this.runners)this.runners[i].add(system);return this},Renderer.prototype.render=function(displayObject,options){var renderTexture,clear,transform,skipUpdateTransform;if(options&&(options instanceof RenderTexture?(deprecation("6.0.0","Renderer#render arguments changed, use options instead."),renderTexture=options,clear=arguments[2],transform=arguments[3],skipUpdateTransform=arguments[4]):(renderTexture=options.renderTexture,clear=options.clear,transform=options.transform,skipUpdateTransform=options.skipUpdateTransform)),this.renderingToScreen=!renderTexture,this.runners.prerender.emit(),this.emit("prerender"),this.projection.transform=transform,!this.context.isLost){if(renderTexture||(this._lastObjectRendered=displayObject),!skipUpdateTransform){var cacheParent=displayObject.enableTempParent();displayObject.updateTransform(),displayObject.disableTempParent(cacheParent)}this.renderTexture.bind(renderTexture),this.batch.currentRenderer.start(),(void 0!==clear?clear:this.clearBeforeRender)&&this.renderTexture.clear(),displayObject.render(this),this.batch.currentRenderer.flush(),renderTexture&&renderTexture.baseTexture.update(),this.runners.postrender.emit(),this.projection.transform=null,this.emit("postrender")}},Renderer.prototype.generateTexture=function(displayObject,options,resolution,region){void 0===options&&(options={});var renderTexture=_super.prototype.generateTexture.call(this,displayObject,options,resolution,region);return this.framebuffer.blit(),renderTexture},Renderer.prototype.resize=function(desiredScreenWidth,desiredScreenHeight){_super.prototype.resize.call(this,desiredScreenWidth,desiredScreenHeight),this.runners.resize.emit(this.screen.height,this.screen.width)},Renderer.prototype.reset=function(){return this.runners.reset.emit(),this},Renderer.prototype.clear=function(){this.renderTexture.bind(),this.renderTexture.clear()},Renderer.prototype.destroy=function(removeView){for(var r in this.runners.destroy.emit(),this.runners)this.runners[r].destroy();_super.prototype.destroy.call(this,removeView),this.gl=null},Object.defineProperty(Renderer.prototype,"extract",{get:function(){return deprecation("6.0.0","Renderer#extract has been deprecated, please use Renderer#plugins.extract instead."),this.plugins.extract},enumerable:!1,configurable:!0}),Renderer.registerPlugin=function(pluginName,ctor){Renderer.__plugins=Renderer.__plugins||{},Renderer.__plugins[pluginName]=ctor},Renderer}(AbstractRenderer);var defaultFilterVertex="attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n",BatchDrawCall=(function(){function System(renderer){deprecation("6.1.0","System class is deprecated, implemement ISystem interface instead."),this.renderer=renderer}System.prototype.destroy=function(){this.renderer=null}}(),function(){this.texArray=null,this.blend=0,this.type=constants_DRAW_MODES.TRIANGLES,this.start=0,this.size=0,this.data=null}),BatchTextureArray=function(){function BatchTextureArray(){this.elements=[],this.ids=[],this.count=0}return BatchTextureArray.prototype.clear=function(){for(var i=0;i<this.count;i++)this.elements[i]=null;this.count=0},BatchTextureArray}(),ViewableBuffer=function(){function ViewableBuffer(sizeOrBuffer){"number"==typeof sizeOrBuffer?this.rawBinaryData=new ArrayBuffer(sizeOrBuffer):sizeOrBuffer instanceof Uint8Array?this.rawBinaryData=sizeOrBuffer.buffer:this.rawBinaryData=sizeOrBuffer,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}return Object.defineProperty(ViewableBuffer.prototype,"int8View",{get:function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View},enumerable:!1,configurable:!0}),Object.defineProperty(ViewableBuffer.prototype,"uint8View",{get:function(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View},enumerable:!1,configurable:!0}),Object.defineProperty(ViewableBuffer.prototype,"int16View",{get:function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View},enumerable:!1,configurable:!0}),Object.defineProperty(ViewableBuffer.prototype,"uint16View",{get:function(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View},enumerable:!1,configurable:!0}),Object.defineProperty(ViewableBuffer.prototype,"int32View",{get:function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View},enumerable:!1,configurable:!0}),ViewableBuffer.prototype.view=function(type){return this[type+"View"]},ViewableBuffer.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},ViewableBuffer.sizeOf=function(type){switch(type){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(type+" isn't a valid view type")}},ViewableBuffer}(),AbstractBatchRenderer=function(_super){function AbstractBatchRenderer(renderer){var _this=_super.call(this,renderer)||this;return _this.shaderGenerator=null,_this.geometryClass=null,_this.vertexSize=null,_this.state=State.for2d(),_this.size=4*settings.SPRITE_BATCH_SIZE,_this._vertexCount=0,_this._indexCount=0,_this._bufferedElements=[],_this._bufferedTextures=[],_this._bufferSize=0,_this._shader=null,_this._packedGeometries=[],_this._packedGeometryPoolSize=2,_this._flushId=0,_this._aBuffers={},_this._iBuffers={},_this.MAX_TEXTURES=1,_this.renderer.on("prerender",_this.onPrerender,_this),renderer.runners.contextChange.add(_this),_this._dcIndex=0,_this._aIndex=0,_this._iIndex=0,_this._attributeBuffer=null,_this._indexBuffer=null,_this._tempBoundTextures=[],_this}return core_extends(AbstractBatchRenderer,_super),AbstractBatchRenderer.prototype.contextChange=function(){var gl=this.renderer.gl;settings.PREFER_ENV===constants_ENV.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(gl.getParameter(gl.MAX_TEXTURE_IMAGE_UNITS),settings.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=function(maxIfs,gl){if(0===maxIfs)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var shader=gl.createShader(gl.FRAGMENT_SHADER);;){var fragmentSrc=fragTemplate.replace(/%forloop%/gi,generateIfTestSrc(maxIfs));if(gl.shaderSource(shader,fragmentSrc),gl.compileShader(shader),gl.getShaderParameter(shader,gl.COMPILE_STATUS))break;maxIfs=maxIfs/2|0}return maxIfs}(this.MAX_TEXTURES,gl)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var i=0;i<this._packedGeometryPoolSize;i++)this._packedGeometries[i]=new this.geometryClass;this.initFlushBuffers()},AbstractBatchRenderer.prototype.initFlushBuffers=function(){for(var _drawCallPool=AbstractBatchRenderer._drawCallPool,_textureArrayPool=AbstractBatchRenderer._textureArrayPool,MAX_SPRITES=this.size/4,MAX_TA=Math.floor(MAX_SPRITES/this.MAX_TEXTURES)+1;_drawCallPool.length<MAX_SPRITES;)_drawCallPool.push(new BatchDrawCall);for(;_textureArrayPool.length<MAX_TA;)_textureArrayPool.push(new BatchTextureArray);for(var i=0;i<this.MAX_TEXTURES;i++)this._tempBoundTextures[i]=null},AbstractBatchRenderer.prototype.onPrerender=function(){this._flushId=0},AbstractBatchRenderer.prototype.render=function(element){element._texture.valid&&(this._vertexCount+element.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=element.vertexData.length/2,this._indexCount+=element.indices.length,this._bufferedTextures[this._bufferSize]=element._texture.baseTexture,this._bufferedElements[this._bufferSize++]=element)},AbstractBatchRenderer.prototype.buildTexturesAndDrawCalls=function(){var textures=this._bufferedTextures,MAX_TEXTURES=this.MAX_TEXTURES,textureArrays=AbstractBatchRenderer._textureArrayPool,batch=this.renderer.batch,boundTextures=this._tempBoundTextures,touch=this.renderer.textureGC.count,TICK=++BaseTexture._globalBatch,countTexArrays=0,texArray=textureArrays[0],start=0;batch.copyBoundTextures(boundTextures,MAX_TEXTURES);for(var i=0;i<this._bufferSize;++i){var tex=textures[i];textures[i]=null,tex._batchEnabled!==TICK&&(texArray.count>=MAX_TEXTURES&&(batch.boundArray(texArray,boundTextures,TICK,MAX_TEXTURES),this.buildDrawCalls(texArray,start,i),start=i,texArray=textureArrays[++countTexArrays],++TICK),tex._batchEnabled=TICK,tex.touched=touch,texArray.elements[texArray.count++]=tex)}texArray.count>0&&(batch.boundArray(texArray,boundTextures,TICK,MAX_TEXTURES),this.buildDrawCalls(texArray,start,this._bufferSize),++countTexArrays,++TICK);for(i=0;i<boundTextures.length;i++)boundTextures[i]=null;BaseTexture._globalBatch=TICK},AbstractBatchRenderer.prototype.buildDrawCalls=function(texArray,start,finish){var elements=this._bufferedElements,_attributeBuffer=this._attributeBuffer,_indexBuffer=this._indexBuffer,vertexSize=this.vertexSize,drawCalls=AbstractBatchRenderer._drawCallPool,dcIndex=this._dcIndex,aIndex=this._aIndex,iIndex=this._iIndex,drawCall=drawCalls[dcIndex];drawCall.start=this._iIndex,drawCall.texArray=texArray;for(var i=start;i<finish;++i){var sprite=elements[i],tex=sprite._texture.baseTexture,spriteBlendMode=premultiplyBlendMode[tex.alphaMode?1:0][sprite.blendMode];elements[i]=null,start<i&&drawCall.blend!==spriteBlendMode&&(drawCall.size=iIndex-drawCall.start,start=i,(drawCall=drawCalls[++dcIndex]).texArray=texArray,drawCall.start=iIndex),this.packInterleavedGeometry(sprite,_attributeBuffer,_indexBuffer,aIndex,iIndex),aIndex+=sprite.vertexData.length/2*vertexSize,iIndex+=sprite.indices.length,drawCall.blend=spriteBlendMode}start<finish&&(drawCall.size=iIndex-drawCall.start,++dcIndex),this._dcIndex=dcIndex,this._aIndex=aIndex,this._iIndex=iIndex},AbstractBatchRenderer.prototype.bindAndClearTexArray=function(texArray){for(var textureSystem=this.renderer.texture,j=0;j<texArray.count;j++)textureSystem.bind(texArray.elements[j],texArray.ids[j]),texArray.elements[j]=null;texArray.count=0},AbstractBatchRenderer.prototype.updateGeometry=function(){var packedGeometries=this._packedGeometries,attributeBuffer=this._attributeBuffer,indexBuffer=this._indexBuffer;settings.CAN_UPLOAD_SAME_BUFFER?(packedGeometries[this._flushId]._buffer.update(attributeBuffer.rawBinaryData),packedGeometries[this._flushId]._indexBuffer.update(indexBuffer),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,packedGeometries[this._flushId]=new this.geometryClass),packedGeometries[this._flushId]._buffer.update(attributeBuffer.rawBinaryData),packedGeometries[this._flushId]._indexBuffer.update(indexBuffer),this.renderer.geometry.bind(packedGeometries[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)},AbstractBatchRenderer.prototype.drawBatches=function(){for(var dcCount=this._dcIndex,_a=this.renderer,gl=_a.gl,stateSystem=_a.state,drawCalls=AbstractBatchRenderer._drawCallPool,curTexArray=null,i=0;i<dcCount;i++){var _b=drawCalls[i],texArray=_b.texArray,type=_b.type,size=_b.size,start=_b.start,blend=_b.blend;curTexArray!==texArray&&(curTexArray=texArray,this.bindAndClearTexArray(texArray)),this.state.blendMode=blend,stateSystem.set(this.state),gl.drawElements(type,size,gl.UNSIGNED_SHORT,2*start)}},AbstractBatchRenderer.prototype.flush=function(){0!==this._vertexCount&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)},AbstractBatchRenderer.prototype.start=function(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.MAX_TEXTURES),this.renderer.shader.bind(this._shader),settings.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])},AbstractBatchRenderer.prototype.stop=function(){this.flush()},AbstractBatchRenderer.prototype.destroy=function(){for(var i=0;i<this._packedGeometryPoolSize;i++)this._packedGeometries[i]&&this._packedGeometries[i].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),_super.prototype.destroy.call(this)},AbstractBatchRenderer.prototype.getAttributeBuffer=function(size){var roundedP2=nextPow2(Math.ceil(size/8)),roundedSizeIndex=log2(roundedP2),roundedSize=8*roundedP2;this._aBuffers.length<=roundedSizeIndex&&(this._iBuffers.length=roundedSizeIndex+1);var buffer=this._aBuffers[roundedSize];return buffer||(this._aBuffers[roundedSize]=buffer=new ViewableBuffer(roundedSize*this.vertexSize*4)),buffer},AbstractBatchRenderer.prototype.getIndexBuffer=function(size){var roundedP2=nextPow2(Math.ceil(size/12)),roundedSizeIndex=log2(roundedP2),roundedSize=12*roundedP2;this._iBuffers.length<=roundedSizeIndex&&(this._iBuffers.length=roundedSizeIndex+1);var buffer=this._iBuffers[roundedSizeIndex];return buffer||(this._iBuffers[roundedSizeIndex]=buffer=new Uint16Array(roundedSize)),buffer},AbstractBatchRenderer.prototype.packInterleavedGeometry=function(element,attributeBuffer,indexBuffer,aIndex,iIndex){for(var uint32View=attributeBuffer.uint32View,float32View=attributeBuffer.float32View,packedVertices=aIndex/this.vertexSize,uvs=element.uvs,indicies=element.indices,vertexData=element.vertexData,textureId=element._texture.baseTexture._batchLocation,alpha=Math.min(element.worldAlpha,1),argb=alpha<1&&element._texture.baseTexture.alphaMode?premultiplyTint(element._tintRGB,alpha):element._tintRGB+(255*alpha<<24),i=0;i<vertexData.length;i+=2)float32View[aIndex++]=vertexData[i],float32View[aIndex++]=vertexData[i+1],float32View[aIndex++]=uvs[i],float32View[aIndex++]=uvs[i+1],uint32View[aIndex++]=argb,float32View[aIndex++]=textureId;for(i=0;i<indicies.length;i++)indexBuffer[iIndex++]=packedVertices+indicies[i]},AbstractBatchRenderer._drawCallPool=[],AbstractBatchRenderer._textureArrayPool=[],AbstractBatchRenderer}(ObjectRenderer),BatchShaderGenerator=function(){function BatchShaderGenerator(vertexSrc,fragTemplate){if(this.vertexSrc=vertexSrc,this.fragTemplate=fragTemplate,this.programCache={},this.defaultGroupCache={},fragTemplate.indexOf("%count%")<0)throw new Error('Fragment template must contain "%count%".');if(fragTemplate.indexOf("%forloop%")<0)throw new Error('Fragment template must contain "%forloop%".')}return BatchShaderGenerator.prototype.generateShader=function(maxTextures){if(!this.programCache[maxTextures]){for(var sampleValues=new Int32Array(maxTextures),i=0;i<maxTextures;i++)sampleValues[i]=i;this.defaultGroupCache[maxTextures]=UniformGroup.from({uSamplers:sampleValues},!0);var fragmentSrc=this.fragTemplate;fragmentSrc=(fragmentSrc=fragmentSrc.replace(/%count%/gi,""+maxTextures)).replace(/%forloop%/gi,this.generateSampleSrc(maxTextures)),this.programCache[maxTextures]=new Program(this.vertexSrc,fragmentSrc)}var uniforms={tint:new Float32Array([1,1,1,1]),translationMatrix:new Matrix,default:this.defaultGroupCache[maxTextures]};return new Shader(this.programCache[maxTextures],uniforms)},BatchShaderGenerator.prototype.generateSampleSrc=function(maxTextures){var src="";src+="\n",src+="\n";for(var i=0;i<maxTextures;i++)i>0&&(src+="\nelse "),i<maxTextures-1&&(src+="if(vTextureId < "+i+".5)"),src+="\n{",src+="\n\tcolor = texture2D(uSamplers["+i+"], vTextureCoord);",src+="\n}";return src+="\n",src+="\n"},BatchShaderGenerator}(),BatchGeometry=function(_super){function BatchGeometry(_static){void 0===_static&&(_static=!1);var _this=_super.call(this)||this;return _this._buffer=new Buffer(null,_static,!1),_this._indexBuffer=new Buffer(null,_static,!0),_this.addAttribute("aVertexPosition",_this._buffer,2,!1,constants_TYPES.FLOAT).addAttribute("aTextureCoord",_this._buffer,2,!1,constants_TYPES.FLOAT).addAttribute("aColor",_this._buffer,4,!0,constants_TYPES.UNSIGNED_BYTE).addAttribute("aTextureId",_this._buffer,1,!0,constants_TYPES.FLOAT).addIndex(_this._indexBuffer),_this}return core_extends(BatchGeometry,_super),BatchGeometry}(Geometry),defaultVertex$3="precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n",defaultFragment$2="varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = color * vColor;\n}\n",BatchPluginFactory=function(){function BatchPluginFactory(){}return BatchPluginFactory.create=function(options){var _a=Object.assign({vertex:defaultVertex$3,fragment:defaultFragment$2,geometryClass:BatchGeometry,vertexSize:6},options),vertex=_a.vertex,fragment=_a.fragment,vertexSize=_a.vertexSize,geometryClass=_a.geometryClass;return function(_super){function BatchPlugin(renderer){var _this=_super.call(this,renderer)||this;return _this.shaderGenerator=new BatchShaderGenerator(vertex,fragment),_this.geometryClass=geometryClass,_this.vertexSize=vertexSize,_this}return core_extends(BatchPlugin,_super),BatchPlugin}(AbstractBatchRenderer)},Object.defineProperty(BatchPluginFactory,"defaultVertexSrc",{get:function(){return defaultVertex$3},enumerable:!1,configurable:!0}),Object.defineProperty(BatchPluginFactory,"defaultFragmentTemplate",{get:function(){return defaultFragment$2},enumerable:!1,configurable:!0}),BatchPluginFactory}(),BatchRenderer=BatchPluginFactory.create(),resources={},_loop_1=function(name){Object.defineProperty(resources,name,{get:function(){return deprecation("6.0.0","PIXI.systems."+name+" has moved to PIXI."+name),_resources[name]}})};for(var core_name in _resources)_loop_1(core_name);var systems={},_loop_2=function(name){Object.defineProperty(systems,name,{get:function(){return deprecation("6.0.0","PIXI.resources."+name+" has moved to PIXI."+name),_systems[name]}})};for(var core_name in _systems)_loop_2(core_name);var Application=function(){function Application(options){var _this=this;this.stage=new Container,options=Object.assign({forceCanvas:!1},options),this.renderer=function(options){return Renderer.create(options)}(options),Application._plugins.forEach((function(plugin){plugin.init.call(_this,options)}))}return Application.registerPlugin=function(plugin){Application._plugins.push(plugin)},Application.prototype.render=function(){this.renderer.render(this.stage)},Object.defineProperty(Application.prototype,"view",{get:function(){return this.renderer.view},enumerable:!1,configurable:!0}),Object.defineProperty(Application.prototype,"screen",{get:function(){return this.renderer.screen},enumerable:!1,configurable:!0}),Application.prototype.destroy=function(removeView,stageOptions){var _this=this,plugins=Application._plugins.slice(0);plugins.reverse(),plugins.forEach((function(plugin){plugin.destroy.call(_this)})),this.stage.destroy(stageOptions),this.stage=null,this.renderer.destroy(removeView),this.renderer=null},Application._plugins=[],Application}(),ResizePlugin=function(){function ResizePlugin(){}return ResizePlugin.init=function(options){var _this=this;Object.defineProperty(this,"resizeTo",{set:function(dom){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=dom,dom&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get:function(){return this._resizeTo}}),this.queueResize=function(){_this._resizeTo&&(_this.cancelResize(),_this._resizeId=requestAnimationFrame((function(){return _this.resize()})))},this.cancelResize=function(){_this._resizeId&&(cancelAnimationFrame(_this._resizeId),_this._resizeId=null)},this.resize=function(){if(_this._resizeTo){var width,height;if(_this.cancelResize(),_this._resizeTo===globalThis.window)width=globalThis.innerWidth,height=globalThis.innerHeight;else{var _a=_this._resizeTo;width=_a.clientWidth,height=_a.clientHeight}_this.renderer.resize(width,height)}},this._resizeId=null,this._resizeTo=null,this.resizeTo=options.resizeTo||null},ResizePlugin.destroy=function(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null},ResizePlugin}();Application.registerPlugin(ResizePlugin);var TEMP_RECT=new Rectangle,Extract=function(){function Extract(renderer){this.renderer=renderer}return Extract.prototype.image=function(target,format,quality){var image=new Image;return image.src=this.base64(target,format,quality),image},Extract.prototype.base64=function(target,format,quality){return this.canvas(target).toDataURL(format,quality)},Extract.prototype.canvas=function(target){var resolution,frame,renderTexture,renderer=this.renderer,flipY=!1,generated=!1;target&&(target instanceof RenderTexture?renderTexture=target:(renderTexture=this.renderer.generateTexture(target),generated=!0)),renderTexture?(resolution=renderTexture.baseTexture.resolution,frame=renderTexture.frame,flipY=!1,renderer.renderTexture.bind(renderTexture)):(resolution=this.renderer.resolution,flipY=!0,(frame=TEMP_RECT).width=this.renderer.width,frame.height=this.renderer.height,renderer.renderTexture.bind(null));var width=Math.floor(frame.width*resolution+1e-4),height=Math.floor(frame.height*resolution+1e-4),canvasBuffer=new CanvasRenderTarget(width,height,1),webglPixels=new Uint8Array(4*width*height),gl=renderer.gl;gl.readPixels(frame.x*resolution,frame.y*resolution,width,height,gl.RGBA,gl.UNSIGNED_BYTE,webglPixels);var canvasData=canvasBuffer.context.getImageData(0,0,width,height);if(Extract.arrayPostDivide(webglPixels,canvasData.data),canvasBuffer.context.putImageData(canvasData,0,0),flipY){var target_1=new CanvasRenderTarget(canvasBuffer.width,canvasBuffer.height,1);target_1.context.scale(1,-1),target_1.context.drawImage(canvasBuffer.canvas,0,-height),canvasBuffer.destroy(),canvasBuffer=target_1}return generated&&renderTexture.destroy(!0),canvasBuffer.canvas},Extract.prototype.pixels=function(target){var resolution,frame,renderTexture,renderer=this.renderer,generated=!1;target&&(target instanceof RenderTexture?renderTexture=target:(renderTexture=this.renderer.generateTexture(target),generated=!0)),renderTexture?(resolution=renderTexture.baseTexture.resolution,frame=renderTexture.frame,renderer.renderTexture.bind(renderTexture)):(resolution=renderer.resolution,(frame=TEMP_RECT).width=renderer.width,frame.height=renderer.height,renderer.renderTexture.bind(null));var width=frame.width*resolution,height=frame.height*resolution,webglPixels=new Uint8Array(4*width*height),gl=renderer.gl;return gl.readPixels(frame.x*resolution,frame.y*resolution,width,height,gl.RGBA,gl.UNSIGNED_BYTE,webglPixels),generated&&renderTexture.destroy(!0),Extract.arrayPostDivide(webglPixels,webglPixels),webglPixels},Extract.prototype.destroy=function(){this.renderer=null},Extract.arrayPostDivide=function(pixels,out){for(var i=0;i<pixels.length;i+=4){var alpha=out[i+3]=pixels[i+3];0!==alpha?(out[i]=Math.round(Math.min(255*pixels[i]/alpha,255)),out[i+1]=Math.round(Math.min(255*pixels[i+1]/alpha,255)),out[i+2]=Math.round(Math.min(255*pixels[i+2]/alpha,255))):(out[i]=pixels[i],out[i+1]=pixels[i+1],out[i+2]=pixels[i+2])}},Extract}(),SignalBinding=function(){function SignalBinding(fn,once,thisArg){void 0===once&&(once=!1),this._fn=fn,this._once=once,this._thisArg=thisArg,this._next=this._prev=this._owner=null}return SignalBinding.prototype.detach=function(){return null!==this._owner&&(this._owner.detach(this),!0)},SignalBinding}();function _addSignalBinding(self,node){return self._head?(self._tail._next=node,node._prev=self._tail,self._tail=node):(self._head=node,self._tail=node),node._owner=self,node}var Signal=function(){function Signal(){this._head=this._tail=void 0}return Signal.prototype.handlers=function(exists){void 0===exists&&(exists=!1);var node=this._head;if(exists)return!!node;for(var ee=[];node;)ee.push(node),node=node._next;return ee},Signal.prototype.has=function(node){if(!(node instanceof SignalBinding))throw new Error("MiniSignal#has(): First arg must be a SignalBinding object.");return node._owner===this},Signal.prototype.dispatch=function(){for(var arguments$1=arguments,args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments$1[_i];var node=this._head;if(!node)return!1;for(;node;)node._once&&this.detach(node),node._fn.apply(node._thisArg,args),node=node._next;return!0},Signal.prototype.add=function(fn,thisArg){if(void 0===thisArg&&(thisArg=null),"function"!=typeof fn)throw new Error("MiniSignal#add(): First arg must be a Function.");return _addSignalBinding(this,new SignalBinding(fn,!1,thisArg))},Signal.prototype.once=function(fn,thisArg){if(void 0===thisArg&&(thisArg=null),"function"!=typeof fn)throw new Error("MiniSignal#once(): First arg must be a Function.");return _addSignalBinding(this,new SignalBinding(fn,!0,thisArg))},Signal.prototype.detach=function(node){if(!(node instanceof SignalBinding))throw new Error("MiniSignal#detach(): First arg must be a SignalBinding object.");return node._owner!==this||(node._prev&&(node._prev._next=node._next),node._next&&(node._next._prev=node._prev),node===this._head?(this._head=node._next,null===node._next&&(this._tail=null)):node===this._tail&&(this._tail=node._prev,this._tail._next=null),node._owner=null),this},Signal.prototype.detachAll=function(){var node=this._head;if(!node)return this;for(this._head=this._tail=null;node;)node._owner=null,node=node._next;return this},Signal}();function parseUri(str,opts){opts=opts||{};for(var o={key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},m=o.parser[opts.strictMode?"strict":"loose"].exec(str),uri={},i=14;i--;)uri[o.key[i]]=m[i]||"";return uri[o.q.name]={},uri[o.key[12]].replace(o.q.parser,(function(_t0,t1,t2){t1&&(uri[o.q.name][t1]=t2)})),uri}var useXdr=!(!globalThis.XDomainRequest||"withCredentials"in new XMLHttpRequest),loaders_tempAnchor=null;function _noop(){}function setExtMap(map,extname,val){extname&&0===extname.indexOf(".")&&(extname=extname.substring(1)),extname&&(map[extname]=val)}function reqType(xhr){return xhr.toString().replace("object ","")}var LoaderResource=function(){function LoaderResource(name,url,options){if(this._dequeue=_noop,this._onLoadBinding=null,this._elementTimer=0,this._boundComplete=null,this._boundOnError=null,this._boundOnProgress=null,this._boundOnTimeout=null,this._boundXhrOnError=null,this._boundXhrOnTimeout=null,this._boundXhrOnAbort=null,this._boundXhrOnLoad=null,"string"!=typeof name||"string"!=typeof url)throw new Error("Both name and url are required for constructing a resource.");options=options||{},this._flags=0,this._setFlag(LoaderResource.STATUS_FLAGS.DATA_URL,0===url.indexOf("data:")),this.name=name,this.url=url,this.extension=this._getExtension(),this.data=null,this.crossOrigin=!0===options.crossOrigin?"anonymous":options.crossOrigin,this.timeout=options.timeout||0,this.loadType=options.loadType||this._determineLoadType(),this.xhrType=options.xhrType,this.metadata=options.metadata||{},this.error=null,this.xhr=null,this.children=[],this.type=LoaderResource.TYPE.UNKNOWN,this.progressChunk=0,this._dequeue=_noop,this._onLoadBinding=null,this._elementTimer=0,this._boundComplete=this.complete.bind(this),this._boundOnError=this._onError.bind(this),this._boundOnProgress=this._onProgress.bind(this),this._boundOnTimeout=this._onTimeout.bind(this),this._boundXhrOnError=this._xhrOnError.bind(this),this._boundXhrOnTimeout=this._xhrOnTimeout.bind(this),this._boundXhrOnAbort=this._xhrOnAbort.bind(this),this._boundXhrOnLoad=this._xhrOnLoad.bind(this),this.onStart=new Signal,this.onProgress=new Signal,this.onComplete=new Signal,this.onAfterMiddleware=new Signal}return LoaderResource.setExtensionLoadType=function(extname,loadType){setExtMap(LoaderResource._loadTypeMap,extname,loadType)},LoaderResource.setExtensionXhrType=function(extname,xhrType){setExtMap(LoaderResource._xhrTypeMap,extname,xhrType)},Object.defineProperty(LoaderResource.prototype,"isDataUrl",{get:function(){return this._hasFlag(LoaderResource.STATUS_FLAGS.DATA_URL)},enumerable:!1,configurable:!0}),Object.defineProperty(LoaderResource.prototype,"isComplete",{get:function(){return this._hasFlag(LoaderResource.STATUS_FLAGS.COMPLETE)},enumerable:!1,configurable:!0}),Object.defineProperty(LoaderResource.prototype,"isLoading",{get:function(){return this._hasFlag(LoaderResource.STATUS_FLAGS.LOADING)},enumerable:!1,configurable:!0}),LoaderResource.prototype.complete=function(){this._clearEvents(),this._finish()},LoaderResource.prototype.abort=function(message){if(!this.error){if(this.error=new Error(message),this._clearEvents(),this.xhr)this.xhr.abort();else if(this.xdr)this.xdr.abort();else if(this.data)if(this.data.src)this.data.src=LoaderResource.EMPTY_GIF;else for(;this.data.firstChild;)this.data.removeChild(this.data.firstChild);this._finish()}},LoaderResource.prototype.load=function(cb){var _this=this;if(!this.isLoading)if(this.isComplete)cb&&setTimeout((function(){return cb(_this)}),1);else switch(cb&&this.onComplete.once(cb),this._setFlag(LoaderResource.STATUS_FLAGS.LOADING,!0),this.onStart.dispatch(this),!1!==this.crossOrigin&&"string"==typeof this.crossOrigin||(this.crossOrigin=this._determineCrossOrigin(this.url)),this.loadType){case LoaderResource.LOAD_TYPE.IMAGE:this.type=LoaderResource.TYPE.IMAGE,this._loadElement("image");break;case LoaderResource.LOAD_TYPE.AUDIO:this.type=LoaderResource.TYPE.AUDIO,this._loadSourceElement("audio");break;case LoaderResource.LOAD_TYPE.VIDEO:this.type=LoaderResource.TYPE.VIDEO,this._loadSourceElement("video");break;case LoaderResource.LOAD_TYPE.XHR:default:useXdr&&this.crossOrigin?this._loadXdr():this._loadXhr()}},LoaderResource.prototype._hasFlag=function(flag){return 0!=(this._flags&flag)},LoaderResource.prototype._setFlag=function(flag,value){this._flags=value?this._flags|flag:this._flags&~flag},LoaderResource.prototype._clearEvents=function(){clearTimeout(this._elementTimer),this.data&&this.data.removeEventListener&&(this.data.removeEventListener("error",this._boundOnError,!1),this.data.removeEventListener("load",this._boundComplete,!1),this.data.removeEventListener("progress",this._boundOnProgress,!1),this.data.removeEventListener("canplaythrough",this._boundComplete,!1)),this.xhr&&(this.xhr.removeEventListener?(this.xhr.removeEventListener("error",this._boundXhrOnError,!1),this.xhr.removeEventListener("timeout",this._boundXhrOnTimeout,!1),this.xhr.removeEventListener("abort",this._boundXhrOnAbort,!1),this.xhr.removeEventListener("progress",this._boundOnProgress,!1),this.xhr.removeEventListener("load",this._boundXhrOnLoad,!1)):(this.xhr.onerror=null,this.xhr.ontimeout=null,this.xhr.onprogress=null,this.xhr.onload=null))},LoaderResource.prototype._finish=function(){if(this.isComplete)throw new Error("Complete called again for an already completed resource.");this._setFlag(LoaderResource.STATUS_FLAGS.COMPLETE,!0),this._setFlag(LoaderResource.STATUS_FLAGS.LOADING,!1),this.onComplete.dispatch(this)},LoaderResource.prototype._loadElement=function(type){this.metadata.loadElement?this.data=this.metadata.loadElement:"image"===type&&void 0!==globalThis.Image?this.data=new Image:this.data=document.createElement(type),this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),this.metadata.skipSource||(this.data.src=this.url),this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))},LoaderResource.prototype._loadSourceElement=function(type){if(this.metadata.loadElement?this.data=this.metadata.loadElement:"audio"===type&&void 0!==globalThis.Audio?this.data=new Audio:this.data=document.createElement(type),null!==this.data){if(this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),!this.metadata.skipSource)if(navigator.isCocoonJS)this.data.src=Array.isArray(this.url)?this.url[0]:this.url;else if(Array.isArray(this.url))for(var mimeTypes=this.metadata.mimeType,i=0;i<this.url.length;++i)this.data.appendChild(this._createSource(type,this.url[i],Array.isArray(mimeTypes)?mimeTypes[i]:mimeTypes));else{mimeTypes=this.metadata.mimeType;this.data.appendChild(this._createSource(type,this.url,Array.isArray(mimeTypes)?mimeTypes[0]:mimeTypes))}this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.data.addEventListener("canplaythrough",this._boundComplete,!1),this.data.load(),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))}else this.abort("Unsupported element: "+type)},LoaderResource.prototype._loadXhr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var xhr=this.xhr=new XMLHttpRequest;"use-credentials"===this.crossOrigin&&(xhr.withCredentials=!0),xhr.open("GET",this.url,!0),xhr.timeout=this.timeout,this.xhrType===LoaderResource.XHR_RESPONSE_TYPE.JSON||this.xhrType===LoaderResource.XHR_RESPONSE_TYPE.DOCUMENT?xhr.responseType=LoaderResource.XHR_RESPONSE_TYPE.TEXT:xhr.responseType=this.xhrType,xhr.addEventListener("error",this._boundXhrOnError,!1),xhr.addEventListener("timeout",this._boundXhrOnTimeout,!1),xhr.addEventListener("abort",this._boundXhrOnAbort,!1),xhr.addEventListener("progress",this._boundOnProgress,!1),xhr.addEventListener("load",this._boundXhrOnLoad,!1),xhr.send()},LoaderResource.prototype._loadXdr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var xdr=this.xhr=new globalThis.XDomainRequest;xdr.timeout=this.timeout||5e3,xdr.onerror=this._boundXhrOnError,xdr.ontimeout=this._boundXhrOnTimeout,xdr.onprogress=this._boundOnProgress,xdr.onload=this._boundXhrOnLoad,xdr.open("GET",this.url,!0),setTimeout((function(){return xdr.send()}),1)},LoaderResource.prototype._createSource=function(type,url,mime){mime||(mime=type+"/"+this._getExtension(url));var source=document.createElement("source");return source.src=url,source.type=mime,source},LoaderResource.prototype._onError=function(event){this.abort("Failed to load element using: "+event.target.nodeName)},LoaderResource.prototype._onProgress=function(event){event&&event.lengthComputable&&this.onProgress.dispatch(this,event.loaded/event.total)},LoaderResource.prototype._onTimeout=function(){this.abort("Load timed out.")},LoaderResource.prototype._xhrOnError=function(){var xhr=this.xhr;this.abort(reqType(xhr)+" Request failed. Status: "+xhr.status+', text: "'+xhr.statusText+'"')},LoaderResource.prototype._xhrOnTimeout=function(){var xhr=this.xhr;this.abort(reqType(xhr)+" Request timed out.")},LoaderResource.prototype._xhrOnAbort=function(){var xhr=this.xhr;this.abort(reqType(xhr)+" Request was aborted by the user.")},LoaderResource.prototype._xhrOnLoad=function(){var xhr=this.xhr,text="",status=void 0===xhr.status?200:xhr.status;if(""!==xhr.responseType&&"text"!==xhr.responseType&&void 0!==xhr.responseType||(text=xhr.responseText),0===status&&(text.length>0||xhr.responseType===LoaderResource.XHR_RESPONSE_TYPE.BUFFER)?status=200:1223===status&&(status=204),2===(status/100|0)){if(this.xhrType===LoaderResource.XHR_RESPONSE_TYPE.TEXT)this.data=text,this.type=LoaderResource.TYPE.TEXT;else if(this.xhrType===LoaderResource.XHR_RESPONSE_TYPE.JSON)try{this.data=JSON.parse(text),this.type=LoaderResource.TYPE.JSON}catch(e){return void this.abort("Error trying to parse loaded json: "+e)}else if(this.xhrType===LoaderResource.XHR_RESPONSE_TYPE.DOCUMENT)try{if(globalThis.DOMParser){var domparser=new DOMParser;this.data=domparser.parseFromString(text,"text/xml")}else{var div=document.createElement("div");div.innerHTML=text,this.data=div}this.type=LoaderResource.TYPE.XML}catch(e$1){return void this.abort("Error trying to parse loaded xml: "+e$1)}else this.data=xhr.response||text;this.complete()}else this.abort("["+xhr.status+"] "+xhr.statusText+": "+xhr.responseURL)},LoaderResource.prototype._determineCrossOrigin=function(url,loc){if(0===url.indexOf("data:"))return"";if(globalThis.origin!==globalThis.location.origin)return"anonymous";loc=loc||globalThis.location,loaders_tempAnchor||(loaders_tempAnchor=document.createElement("a")),loaders_tempAnchor.href=url;var parsedUrl=parseUri(loaders_tempAnchor.href,{strictMode:!0}),samePort=!parsedUrl.port&&""===loc.port||parsedUrl.port===loc.port,protocol=parsedUrl.protocol?parsedUrl.protocol+":":"";return parsedUrl.host===loc.hostname&&samePort&&protocol===loc.protocol?"":"anonymous"},LoaderResource.prototype._determineXhrType=function(){return LoaderResource._xhrTypeMap[this.extension]||LoaderResource.XHR_RESPONSE_TYPE.TEXT},LoaderResource.prototype._determineLoadType=function(){return LoaderResource._loadTypeMap[this.extension]||LoaderResource.LOAD_TYPE.XHR},LoaderResource.prototype._getExtension=function(url){void 0===url&&(url=this.url);var ext="";if(this.isDataUrl){var slashIndex=url.indexOf("/");ext=url.substring(slashIndex+1,url.indexOf(";",slashIndex))}else{var queryStart=url.indexOf("?"),hashStart=url.indexOf("#"),index=Math.min(queryStart>-1?queryStart:url.length,hashStart>-1?hashStart:url.length);ext=(url=url.substring(0,index)).substring(url.lastIndexOf(".")+1)}return ext.toLowerCase()},LoaderResource.prototype._getMimeFromXhrType=function(type){switch(type){case LoaderResource.XHR_RESPONSE_TYPE.BUFFER:return"application/octet-binary";case LoaderResource.XHR_RESPONSE_TYPE.BLOB:return"application/blob";case LoaderResource.XHR_RESPONSE_TYPE.DOCUMENT:return"application/xml";case LoaderResource.XHR_RESPONSE_TYPE.JSON:return"application/json";case LoaderResource.XHR_RESPONSE_TYPE.DEFAULT:case LoaderResource.XHR_RESPONSE_TYPE.TEXT:default:return"text/plain"}},LoaderResource}();function _noop$1(){}function onlyOnce(fn){return function(){for(var arguments$1=arguments,args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments$1[_i];if(null===fn)throw new Error("Callback was already called.");var callFn=fn;fn=null,callFn.apply(this,args)}}!function(LoaderResource){!function(STATUS_FLAGS){STATUS_FLAGS[STATUS_FLAGS.NONE=0]="NONE",STATUS_FLAGS[STATUS_FLAGS.DATA_URL=1]="DATA_URL",STATUS_FLAGS[STATUS_FLAGS.COMPLETE=2]="COMPLETE",STATUS_FLAGS[STATUS_FLAGS.LOADING=4]="LOADING"}(LoaderResource.STATUS_FLAGS||(LoaderResource.STATUS_FLAGS={})),function(TYPE){TYPE[TYPE.UNKNOWN=0]="UNKNOWN",TYPE[TYPE.JSON=1]="JSON",TYPE[TYPE.XML=2]="XML",TYPE[TYPE.IMAGE=3]="IMAGE",TYPE[TYPE.AUDIO=4]="AUDIO",TYPE[TYPE.VIDEO=5]="VIDEO",TYPE[TYPE.TEXT=6]="TEXT"}(LoaderResource.TYPE||(LoaderResource.TYPE={})),function(LOAD_TYPE){LOAD_TYPE[LOAD_TYPE.XHR=1]="XHR",LOAD_TYPE[LOAD_TYPE.IMAGE=2]="IMAGE",LOAD_TYPE[LOAD_TYPE.AUDIO=3]="AUDIO",LOAD_TYPE[LOAD_TYPE.VIDEO=4]="VIDEO"}(LoaderResource.LOAD_TYPE||(LoaderResource.LOAD_TYPE={})),function(XHR_RESPONSE_TYPE){XHR_RESPONSE_TYPE.DEFAULT="text",XHR_RESPONSE_TYPE.BUFFER="arraybuffer",XHR_RESPONSE_TYPE.BLOB="blob",XHR_RESPONSE_TYPE.DOCUMENT="document",XHR_RESPONSE_TYPE.JSON="json",XHR_RESPONSE_TYPE.TEXT="text"}(LoaderResource.XHR_RESPONSE_TYPE||(LoaderResource.XHR_RESPONSE_TYPE={})),LoaderResource._loadTypeMap={gif:LoaderResource.LOAD_TYPE.IMAGE,png:LoaderResource.LOAD_TYPE.IMAGE,bmp:LoaderResource.LOAD_TYPE.IMAGE,jpg:LoaderResource.LOAD_TYPE.IMAGE,jpeg:LoaderResource.LOAD_TYPE.IMAGE,tif:LoaderResource.LOAD_TYPE.IMAGE,tiff:LoaderResource.LOAD_TYPE.IMAGE,webp:LoaderResource.LOAD_TYPE.IMAGE,tga:LoaderResource.LOAD_TYPE.IMAGE,svg:LoaderResource.LOAD_TYPE.IMAGE,"svg+xml":LoaderResource.LOAD_TYPE.IMAGE,mp3:LoaderResource.LOAD_TYPE.AUDIO,ogg:LoaderResource.LOAD_TYPE.AUDIO,wav:LoaderResource.LOAD_TYPE.AUDIO,mp4:LoaderResource.LOAD_TYPE.VIDEO,webm:LoaderResource.LOAD_TYPE.VIDEO},LoaderResource._xhrTypeMap={xhtml:LoaderResource.XHR_RESPONSE_TYPE.DOCUMENT,html:LoaderResource.XHR_RESPONSE_TYPE.DOCUMENT,htm:LoaderResource.XHR_RESPONSE_TYPE.DOCUMENT,xml:LoaderResource.XHR_RESPONSE_TYPE.DOCUMENT,tmx:LoaderResource.XHR_RESPONSE_TYPE.DOCUMENT,svg:LoaderResource.XHR_RESPONSE_TYPE.DOCUMENT,tsx:LoaderResource.XHR_RESPONSE_TYPE.DOCUMENT,gif:LoaderResource.XHR_RESPONSE_TYPE.BLOB,png:LoaderResource.XHR_RESPONSE_TYPE.BLOB,bmp:LoaderResource.XHR_RESPONSE_TYPE.BLOB,jpg:LoaderResource.XHR_RESPONSE_TYPE.BLOB,jpeg:LoaderResource.XHR_RESPONSE_TYPE.BLOB,tif:LoaderResource.XHR_RESPONSE_TYPE.BLOB,tiff:LoaderResource.XHR_RESPONSE_TYPE.BLOB,webp:LoaderResource.XHR_RESPONSE_TYPE.BLOB,tga:LoaderResource.XHR_RESPONSE_TYPE.BLOB,json:LoaderResource.XHR_RESPONSE_TYPE.JSON,text:LoaderResource.XHR_RESPONSE_TYPE.TEXT,txt:LoaderResource.XHR_RESPONSE_TYPE.TEXT,ttf:LoaderResource.XHR_RESPONSE_TYPE.BUFFER,otf:LoaderResource.XHR_RESPONSE_TYPE.BUFFER},LoaderResource.EMPTY_GIF="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=="}(LoaderResource||(LoaderResource={}));var AsyncQueueItem=function(data,callback){this.data=data,this.callback=callback},AsyncQueue=function(){function AsyncQueue(worker,concurrency){var _this=this;if(void 0===concurrency&&(concurrency=1),this.workers=0,this.saturated=_noop$1,this.unsaturated=_noop$1,this.empty=_noop$1,this.drain=_noop$1,this.error=_noop$1,this.started=!1,this.paused=!1,this._tasks=[],this._insert=function(data,insertAtFront,callback){if(callback&&"function"!=typeof callback)throw new Error("task callback must be a function");if(_this.started=!0,null==data&&_this.idle())setTimeout((function(){return _this.drain()}),1);else{var item=new AsyncQueueItem(data,"function"==typeof callback?callback:_noop$1);insertAtFront?_this._tasks.unshift(item):_this._tasks.push(item),setTimeout(_this.process,1)}},this.process=function(){for(;!_this.paused&&_this.workers<_this.concurrency&&_this._tasks.length;){var task=_this._tasks.shift();0===_this._tasks.length&&_this.empty(),_this.workers+=1,_this.workers===_this.concurrency&&_this.saturated(),_this._worker(task.data,onlyOnce(_this._next(task)))}},this._worker=worker,0===concurrency)throw new Error("Concurrency must not be zero");this.concurrency=concurrency,this.buffer=concurrency/4}return AsyncQueue.prototype._next=function(task){var _this=this;return function(){for(var arguments$1=arguments,args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments$1[_i];_this.workers-=1,task.callback.apply(task,args),null!=args[0]&&_this.error(args[0],task.data),_this.workers<=_this.concurrency-_this.buffer&&_this.unsaturated(),_this.idle()&&_this.drain(),_this.process()}},AsyncQueue.prototype.push=function(data,callback){this._insert(data,!1,callback)},AsyncQueue.prototype.kill=function(){this.workers=0,this.drain=_noop$1,this.started=!1,this._tasks=[]},AsyncQueue.prototype.unshift=function(data,callback){this._insert(data,!0,callback)},AsyncQueue.prototype.length=function(){return this._tasks.length},AsyncQueue.prototype.running=function(){return this.workers},AsyncQueue.prototype.idle=function(){return this._tasks.length+this.workers===0},AsyncQueue.prototype.pause=function(){!0!==this.paused&&(this.paused=!0)},AsyncQueue.prototype.resume=function(){if(!1!==this.paused){this.paused=!1;for(var w=1;w<=this.concurrency;w++)this.process()}},AsyncQueue.eachSeries=function(array,iterator,callback,deferNext){var i=0,len=array.length;!function next(err){err||i===len?callback&&callback(err):deferNext?setTimeout((function(){iterator(array[i++],next)}),1):iterator(array[i++],next)}()},AsyncQueue.queue=function(worker,concurrency){return new AsyncQueue(worker,concurrency)},AsyncQueue}(),rgxExtractUrlHash=/(#[\w-]+)?$/,Loader=function(){function Loader(baseUrl,concurrency){var _this=this;void 0===baseUrl&&(baseUrl=""),void 0===concurrency&&(concurrency=10),this.progress=0,this.loading=!1,this.defaultQueryString="",this._beforeMiddleware=[],this._afterMiddleware=[],this._resourcesParsing=[],this._boundLoadResource=function(r,d){return _this._loadResource(r,d)},this.resources={},this.baseUrl=baseUrl,this._beforeMiddleware=[],this._afterMiddleware=[],this._resourcesParsing=[],this._boundLoadResource=function(r,d){return _this._loadResource(r,d)},this._queue=AsyncQueue.queue(this._boundLoadResource,concurrency),this._queue.pause(),this.resources={},this.onProgress=new Signal,this.onError=new Signal,this.onLoad=new Signal,this.onStart=new Signal,this.onComplete=new Signal;for(var i=0;i<Loader._plugins.length;++i){var plugin=Loader._plugins[i],pre=plugin.pre,use=plugin.use;pre&&this.pre(pre),use&&this.use(use)}this._protected=!1}return Loader.prototype._add=function(name,url,options,callback){if(this.loading&&(!options||!options.parentResource))throw new Error("Cannot add resources while the loader is running.");if(this.resources[name])throw new Error('Resource named "'+name+'" already exists.');if(url=this._prepareUrl(url),this.resources[name]=new LoaderResource(name,url,options),"function"==typeof callback&&this.resources[name].onAfterMiddleware.once(callback),this.loading){for(var parent=options.parentResource,incompleteChildren=[],i=0;i<parent.children.length;++i)parent.children[i].isComplete||incompleteChildren.push(parent.children[i]);var eachChunk=parent.progressChunk*(incompleteChildren.length+1)/(incompleteChildren.length+2);parent.children.push(this.resources[name]),parent.progressChunk=eachChunk;for(i=0;i<incompleteChildren.length;++i)incompleteChildren[i].progressChunk=eachChunk;this.resources[name].progressChunk=eachChunk}return this._queue.push(this.resources[name]),this},Loader.prototype.pre=function(fn){return this._beforeMiddleware.push(fn),this},Loader.prototype.use=function(fn){return this._afterMiddleware.push(fn),this},Loader.prototype.reset=function(){for(var k in this.progress=0,this.loading=!1,this._queue.kill(),this._queue.pause(),this.resources){var res=this.resources[k];res._onLoadBinding&&res._onLoadBinding.detach(),res.isLoading&&res.abort("loader reset")}return this.resources={},this},Loader.prototype.load=function(cb){if("function"==typeof cb&&this.onComplete.once(cb),this.loading)return this;if(this._queue.idle())this._onStart(),this._onComplete();else{for(var chunk=100/this._queue._tasks.length,i=0;i<this._queue._tasks.length;++i)this._queue._tasks[i].data.progressChunk=chunk;this._onStart(),this._queue.resume()}return this},Object.defineProperty(Loader.prototype,"concurrency",{get:function(){return this._queue.concurrency},set:function(concurrency){this._queue.concurrency=concurrency},enumerable:!1,configurable:!0}),Loader.prototype._prepareUrl=function(url){var result,parsedUrl=parseUri(url,{strictMode:!0});if(result=parsedUrl.protocol||!parsedUrl.path||0===url.indexOf("//")?url:this.baseUrl.length&&this.baseUrl.lastIndexOf("/")!==this.baseUrl.length-1&&"/"!==url.charAt(0)?this.baseUrl+"/"+url:this.baseUrl+url,this.defaultQueryString){var hash=rgxExtractUrlHash.exec(result)[0];-1!==(result=result.slice(0,result.length-hash.length)).indexOf("?")?result+="&"+this.defaultQueryString:result+="?"+this.defaultQueryString,result+=hash}return result},Loader.prototype._loadResource=function(resource,dequeue){var _this=this;resource._dequeue=dequeue,AsyncQueue.eachSeries(this._beforeMiddleware,(function(fn,next){fn.call(_this,resource,(function(){next(resource.isComplete?{}:null)}))}),(function(){resource.isComplete?_this._onLoad(resource):(resource._onLoadBinding=resource.onComplete.once(_this._onLoad,_this),resource.load())}),!0)},Loader.prototype._onStart=function(){this.progress=0,this.loading=!0,this.onStart.dispatch(this)},Loader.prototype._onComplete=function(){this.progress=100,this.loading=!1,this.onComplete.dispatch(this,this.resources)},Loader.prototype._onLoad=function(resource){var _this=this;resource._onLoadBinding=null,this._resourcesParsing.push(resource),resource._dequeue(),AsyncQueue.eachSeries(this._afterMiddleware,(function(fn,next){fn.call(_this,resource,next)}),(function(){resource.onAfterMiddleware.dispatch(resource),_this.progress=Math.min(100,_this.progress+resource.progressChunk),_this.onProgress.dispatch(_this,resource),resource.error?_this.onError.dispatch(resource.error,_this,resource):_this.onLoad.dispatch(_this,resource),_this._resourcesParsing.splice(_this._resourcesParsing.indexOf(resource),1),_this._queue.idle()&&0===_this._resourcesParsing.length&&_this._onComplete()}),!0)},Loader.prototype.destroy=function(){this._protected||this.reset()},Object.defineProperty(Loader,"shared",{get:function(){var shared=Loader._shared;return shared||((shared=new Loader)._protected=!0,Loader._shared=shared),shared},enumerable:!1,configurable:!0}),Loader.registerPlugin=function(plugin){return Loader._plugins.push(plugin),plugin.add&&plugin.add(),Loader},Loader._plugins=[],Loader}();Loader.prototype.add=function(name,url,options,callback){if(Array.isArray(name)){for(var i=0;i<name.length;++i)this.add(name[i]);return this}if("object"==typeof name&&(options=name,callback=url||options.callback||options.onComplete,url=options.url,name=options.name||options.key||options.url),"string"!=typeof url&&(callback=options,options=url,url=name),"string"!=typeof url)throw new Error("No url passed to add resource to loader.");return"function"==typeof options&&(callback=options,options=null),this._add(name,url,options,callback)};var AppLoaderPlugin=function(){function AppLoaderPlugin(){}return AppLoaderPlugin.init=function(options){options=Object.assign({sharedLoader:!1},options),this.loader=options.sharedLoader?Loader.shared:new Loader},AppLoaderPlugin.destroy=function(){this.loader&&(this.loader.destroy(),this.loader=null)},AppLoaderPlugin}(),TextureLoader=function(){function TextureLoader(){}return TextureLoader.add=function(){LoaderResource.setExtensionLoadType("svg",LoaderResource.LOAD_TYPE.XHR),LoaderResource.setExtensionXhrType("svg",LoaderResource.XHR_RESPONSE_TYPE.TEXT)},TextureLoader.use=function(resource,next){if(!resource.data||resource.type!==LoaderResource.TYPE.IMAGE&&"svg"!==resource.extension)next();else{var data=resource.data,url=resource.url,name=resource.name,metadata=resource.metadata;Texture.fromLoader(data,url,name,metadata).then((function(texture){resource.texture=texture,next()})).catch(next)}},TextureLoader}();var _a,INTERNAL_FORMATS,Url=self.URL||self.webkitURL;Loader.registerPlugin({use:function(resource,next){if(resource.data){if(resource.xhr&&resource.xhrType===LoaderResource.XHR_RESPONSE_TYPE.BLOB)if(self.Blob&&"string"!=typeof resource.data){if(0===resource.data.type.indexOf("image")){var src_1=Url.createObjectURL(resource.data);return resource.blob=resource.data,resource.data=new Image,resource.data.src=src_1,resource.type=LoaderResource.TYPE.IMAGE,void(resource.data.onload=function(){Url.revokeObjectURL(src_1),resource.data.onload=null,next()})}}else{var type=resource.xhr.getResponseHeader("content-type");if(type&&0===type.indexOf("image"))return resource.data=new Image,resource.data.src="data:"+type+";base64,"+function(input){for(var output="",inx=0;inx<input.length;){for(var bytebuffer=[0,0,0],encodedCharIndexes=[0,0,0,0],jnx=0;jnx<bytebuffer.length;++jnx)inx<input.length?bytebuffer[jnx]=255&input.charCodeAt(inx++):bytebuffer[jnx]=0;switch(encodedCharIndexes[0]=bytebuffer[0]>>2,encodedCharIndexes[1]=(3&bytebuffer[0])<<4|bytebuffer[1]>>4,encodedCharIndexes[2]=(15&bytebuffer[1])<<2|bytebuffer[2]>>6,encodedCharIndexes[3]=63&bytebuffer[2],inx-(input.length-1)){case 2:encodedCharIndexes[3]=64,encodedCharIndexes[2]=64;break;case 1:encodedCharIndexes[3]=64}for(jnx=0;jnx<encodedCharIndexes.length;++jnx)output+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(encodedCharIndexes[jnx])}return output}(resource.xhr.responseText),resource.type=LoaderResource.TYPE.IMAGE,void(resource.data.onload=function(){resource.data.onload=null,next()})}next()}else next()}}),Loader.registerPlugin(TextureLoader),function(INTERNAL_FORMATS){INTERNAL_FORMATS[INTERNAL_FORMATS.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",INTERNAL_FORMATS[INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",INTERNAL_FORMATS[INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",INTERNAL_FORMATS[INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",INTERNAL_FORMATS[INTERNAL_FORMATS.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",INTERNAL_FORMATS[INTERNAL_FORMATS.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",INTERNAL_FORMATS[INTERNAL_FORMATS.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",INTERNAL_FORMATS[INTERNAL_FORMATS.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",INTERNAL_FORMATS[INTERNAL_FORMATS.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",INTERNAL_FORMATS[INTERNAL_FORMATS.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",INTERNAL_FORMATS[INTERNAL_FORMATS.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",INTERNAL_FORMATS[INTERNAL_FORMATS.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",INTERNAL_FORMATS[INTERNAL_FORMATS.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",INTERNAL_FORMATS[INTERNAL_FORMATS.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",INTERNAL_FORMATS[INTERNAL_FORMATS.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",INTERNAL_FORMATS[INTERNAL_FORMATS.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",INTERNAL_FORMATS[INTERNAL_FORMATS.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",INTERNAL_FORMATS[INTERNAL_FORMATS.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",INTERNAL_FORMATS[INTERNAL_FORMATS.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",INTERNAL_FORMATS[INTERNAL_FORMATS.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",INTERNAL_FORMATS[INTERNAL_FORMATS.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",INTERNAL_FORMATS[INTERNAL_FORMATS.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",INTERNAL_FORMATS[INTERNAL_FORMATS.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",INTERNAL_FORMATS[INTERNAL_FORMATS.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",INTERNAL_FORMATS[INTERNAL_FORMATS.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",INTERNAL_FORMATS[INTERNAL_FORMATS.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL"}(INTERNAL_FORMATS||(INTERNAL_FORMATS={}));var INTERNAL_FORMAT_TO_BYTES_PER_PIXEL=((_a={})[INTERNAL_FORMATS.COMPRESSED_RGB_S3TC_DXT1_EXT]=.5,_a[INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT1_EXT]=.5,_a[INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT3_EXT]=1,_a[INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT5_EXT]=1,_a[INTERNAL_FORMATS.COMPRESSED_SRGB_S3TC_DXT1_EXT]=.5,_a[INTERNAL_FORMATS.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT]=.5,_a[INTERNAL_FORMATS.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT]=1,_a[INTERNAL_FORMATS.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT]=1,_a[INTERNAL_FORMATS.COMPRESSED_R11_EAC]=.5,_a[INTERNAL_FORMATS.COMPRESSED_SIGNED_R11_EAC]=.5,_a[INTERNAL_FORMATS.COMPRESSED_RG11_EAC]=1,_a[INTERNAL_FORMATS.COMPRESSED_SIGNED_RG11_EAC]=1,_a[INTERNAL_FORMATS.COMPRESSED_RGB8_ETC2]=.5,_a[INTERNAL_FORMATS.COMPRESSED_RGBA8_ETC2_EAC]=1,_a[INTERNAL_FORMATS.COMPRESSED_SRGB8_ETC2]=.5,_a[INTERNAL_FORMATS.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC]=1,_a[INTERNAL_FORMATS.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2]=.5,_a[INTERNAL_FORMATS.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2]=.5,_a[INTERNAL_FORMATS.COMPRESSED_RGB_PVRTC_4BPPV1_IMG]=.5,_a[INTERNAL_FORMATS.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG]=.5,_a[INTERNAL_FORMATS.COMPRESSED_RGB_PVRTC_2BPPV1_IMG]=.25,_a[INTERNAL_FORMATS.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG]=.25,_a[INTERNAL_FORMATS.COMPRESSED_RGB_ETC1_WEBGL]=.5,_a[INTERNAL_FORMATS.COMPRESSED_RGB_ATC_WEBGL]=.5,_a[INTERNAL_FORMATS.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL]=1,_a[INTERNAL_FORMATS.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL]=1,_a),compressed_textures_extendStatics=function(d,b){return compressed_textures_extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])},compressed_textures_extendStatics(d,b)};function compressed_textures_extends(d,b){function __(){this.constructor=d}compressed_textures_extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}function __generator(thisArg,body){var f,y,t,g,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return g={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return function(op){if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,t&&(op=[2&op[0],t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=_.trys,(t=t.length>0&&t[t.length-1])||6!==op[0]&&2!==op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(6===op[0]&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}([n,v])}}}var _a$1,_b,BlobResource=function(_super){function BlobResource(source,options){void 0===options&&(options={width:1,height:1,autoLoad:!0});var origin,data,_this=this;return"string"==typeof source?(origin=source,data=new Uint8Array):(origin=null,data=source),(_this=_super.call(this,data,options)||this).origin=origin,_this.buffer=data?new ViewableBuffer(data):null,_this.origin&&!1!==options.autoLoad&&_this.load(),data&&data.length&&(_this.loaded=!0,_this.onBlobLoaded(_this.buffer.rawBinaryData)),_this}return compressed_textures_extends(BlobResource,_super),BlobResource.prototype.onBlobLoaded=function(_data){},BlobResource.prototype.load=function(){return thisArg=this,_arguments=void 0,generator=function(){var arrayBuffer;return __generator(this,(function(_a){switch(_a.label){case 0:return[4,fetch(this.origin)];case 1:return[4,_a.sent().blob()];case 2:return[4,_a.sent().arrayBuffer()];case 3:return arrayBuffer=_a.sent(),this.data=new Uint32Array(arrayBuffer),this.buffer=new ViewableBuffer(arrayBuffer),this.loaded=!0,this.onBlobLoaded(arrayBuffer),this.update(),[2,this]}}))},new((P=Promise)||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):new P((function(resolve){resolve(result.value)})).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}));var thisArg,_arguments,P,generator},BlobResource}(BufferResource),CompressedTextureResource=function(_super){function CompressedTextureResource(source,options){var _this=_super.call(this,source,options)||this;return _this.format=options.format,_this.levels=options.levels||1,_this._width=options.width,_this._height=options.height,_this._extension=CompressedTextureResource._formatToExtension(_this.format),(options.levelBuffers||_this.buffer)&&(_this._levelBuffers=options.levelBuffers||CompressedTextureResource._createLevelBuffers(source instanceof Uint8Array?source:_this.buffer.uint8View,_this.format,_this.levels,4,4,_this.width,_this.height)),_this}return compressed_textures_extends(CompressedTextureResource,_super),CompressedTextureResource.prototype.upload=function(renderer,_texture,_glTexture){var gl=renderer.gl;if(!renderer.context.extensions[this._extension])throw new Error(this._extension+" textures are not supported on the current machine");if(!this._levelBuffers)return!1;for(var i=0,j=this.levels;i<j;i++){var _a=this._levelBuffers[i],levelID=_a.levelID,levelWidth=_a.levelWidth,levelHeight=_a.levelHeight,levelBuffer=_a.levelBuffer;gl.compressedTexImage2D(gl.TEXTURE_2D,levelID,this.format,levelWidth,levelHeight,0,levelBuffer)}return!0},CompressedTextureResource.prototype.onBlobLoaded=function(){this._levelBuffers=CompressedTextureResource._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)},CompressedTextureResource._formatToExtension=function(format){if(format>=33776&&format<=33779)return"s3tc";if(format>=37488&&format<=37497)return"etc";if(format>=35840&&format<=35843)return"pvrtc";if(format>=36196)return"etc1";if(format>=35986&&format<=34798)return"atc";throw new Error("Invalid (compressed) texture format given!")},CompressedTextureResource._createLevelBuffers=function(buffer,format,levels,blockWidth,blockHeight,imageWidth,imageHeight){for(var buffers=new Array(levels),offset=buffer.byteOffset,levelWidth=imageWidth,levelHeight=imageHeight,alignedLevelWidth=levelWidth+blockWidth-1&~(blockWidth-1),alignedLevelHeight=levelHeight+blockHeight-1&~(blockHeight-1),levelSize=alignedLevelWidth*alignedLevelHeight*INTERNAL_FORMAT_TO_BYTES_PER_PIXEL[format],i=0;i<levels;i++)buffers[i]={levelID:i,levelWidth:levels>1?levelWidth:alignedLevelWidth,levelHeight:levels>1?levelHeight:alignedLevelHeight,levelBuffer:new Uint8Array(buffer.buffer,offset,levelSize)},offset+=levelSize,levelSize=(alignedLevelWidth=(levelWidth=levelWidth>>1||1)+blockWidth-1&~(blockWidth-1))*(alignedLevelHeight=(levelHeight=levelHeight>>1||1)+blockHeight-1&~(blockHeight-1))*INTERNAL_FORMAT_TO_BYTES_PER_PIXEL[format];return buffers},CompressedTextureResource}(BlobResource),CompressedTextureLoader=function(){function CompressedTextureLoader(){}return CompressedTextureLoader.use=function(resource,next){var data=resource.data;if(resource.type===LoaderResource.TYPE.JSON&&data&&data.cacheID&&data.textures){for(var textures=data.textures,textureURL=void 0,fallbackURL=void 0,i=0,j=textures.length;i<j;i++){var texture=textures[i],url_1=texture.src,format=texture.format;if(format||(fallbackURL=url_1),CompressedTextureLoader.textureFormats[format]){textureURL=url_1;break}}if(!(textureURL=textureURL||fallbackURL))return void next(new Error("Cannot load compressed-textures in "+resource.url+", make sure you provide a fallback"));if(textureURL===resource.url)return void next(new Error("URL of compressed texture cannot be the same as the manifest's URL"));var loadOptions={crossOrigin:resource.crossOrigin,metadata:resource.metadata.imageMetadata,parentResource:resource},resourcePath=utils_url.resolve(resource.url.replace(this.baseUrl,""),textureURL),resourceName=data.cacheID;this.add(resourceName,resourcePath,loadOptions,(function(res){if(res.error)next(res.error);else{var _a=res.texture,texture=void 0===_a?null:_a,_b=res.textures,textures=void 0===_b?{}:_b;Object.assign(resource,{texture,textures}),next()}}))}else next()},CompressedTextureLoader.add=function(){var gl=document.createElement("canvas").getContext("webgl");if(gl){var extensions={s3tc:gl.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:gl.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:gl.getExtension("WEBGL_compressed_texture_etc"),etc1:gl.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:gl.getExtension("WEBGL_compressed_texture_pvrtc")||gl.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:gl.getExtension("WEBGL_compressed_texture_atc"),astc:gl.getExtension("WEBGL_compressed_texture_astc")};for(var extensionName in CompressedTextureLoader.textureExtensions=extensions,CompressedTextureLoader.textureFormats={},extensions){var extension=extensions[extensionName];extension&&Object.assign(CompressedTextureLoader.textureFormats,Object.getPrototypeOf(extension))}}else console.warn("WebGL not available for compressed textures. Silently failing.")},CompressedTextureLoader}();function registerCompressedTextures(url,resources,metadata){var result={textures:{},texture:null};return resources?(resources.map((function(resource){return new Texture(new BaseTexture(resource,Object.assign({mipmap:constants_MIPMAP_MODES.OFF,alphaMode:constants_ALPHA_MODES.NO_PREMULTIPLIED_ALPHA},metadata)))})).forEach((function(texture,i){var baseTexture=texture.baseTexture,cacheID=url+"-"+(i+1);BaseTexture.addToCache(baseTexture,cacheID),Texture.addToCache(texture,cacheID),0===i&&(BaseTexture.addToCache(baseTexture,url),Texture.addToCache(texture,url),result.texture=texture),result.textures[cacheID]=texture})),result):result}LoaderResource.setExtensionXhrType("dds",LoaderResource.XHR_RESPONSE_TYPE.BUFFER);var DXGI_FORMAT,D3D10_RESOURCE_DIMENSION,DDS_FIELDS_HEIGHT=3,DDS_FIELDS_WIDTH=4,DDS_FIELDS_MIPMAP_COUNT=7,DDS_FIELDS_PIXEL_FORMAT=19,DDS_PF_FIELDS_FOURCC=2,DDS_DX10_FIELDS_DXGI_FORMAT=0,DDS_DX10_FIELDS_RESOURCE_DIMENSION=1,DDS_DX10_FIELDS_MISC_FLAG=2,DDS_DX10_FIELDS_ARRAY_SIZE=3;!function(DXGI_FORMAT){DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_UNKNOWN=0]="DXGI_FORMAT_UNKNOWN",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_R32G32B32A32_TYPELESS=1]="DXGI_FORMAT_R32G32B32A32_TYPELESS",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_R32G32B32A32_FLOAT=2]="DXGI_FORMAT_R32G32B32A32_FLOAT",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_R32G32B32A32_UINT=3]="DXGI_FORMAT_R32G32B32A32_UINT",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_R32G32B32A32_SINT=4]="DXGI_FORMAT_R32G32B32A32_SINT",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_R32G32B32_TYPELESS=5]="DXGI_FORMAT_R32G32B32_TYPELESS",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_R32G32B32_FLOAT=6]="DXGI_FORMAT_R32G32B32_FLOAT",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_R32G32B32_UINT=7]="DXGI_FORMAT_R32G32B32_UINT",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_R32G32B32_SINT=8]="DXGI_FORMAT_R32G32B32_SINT",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_R16G16B16A16_TYPELESS=9]="DXGI_FORMAT_R16G16B16A16_TYPELESS",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_R16G16B16A16_FLOAT=10]="DXGI_FORMAT_R16G16B16A16_FLOAT",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_R16G16B16A16_UNORM=11]="DXGI_FORMAT_R16G16B16A16_UNORM",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_R16G16B16A16_UINT=12]="DXGI_FORMAT_R16G16B16A16_UINT",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_R16G16B16A16_SNORM=13]="DXGI_FORMAT_R16G16B16A16_SNORM",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_R16G16B16A16_SINT=14]="DXGI_FORMAT_R16G16B16A16_SINT",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_R32G32_TYPELESS=15]="DXGI_FORMAT_R32G32_TYPELESS",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_R32G32_FLOAT=16]="DXGI_FORMAT_R32G32_FLOAT",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_R32G32_UINT=17]="DXGI_FORMAT_R32G32_UINT",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_R32G32_SINT=18]="DXGI_FORMAT_R32G32_SINT",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_R32G8X24_TYPELESS=19]="DXGI_FORMAT_R32G8X24_TYPELESS",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_D32_FLOAT_S8X24_UINT=20]="DXGI_FORMAT_D32_FLOAT_S8X24_UINT",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_R32_FLOAT_X8X24_TYPELESS=21]="DXGI_FORMAT_R32_FLOAT_X8X24_TYPELESS",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_X32_TYPELESS_G8X24_UINT=22]="DXGI_FORMAT_X32_TYPELESS_G8X24_UINT",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_R10G10B10A2_TYPELESS=23]="DXGI_FORMAT_R10G10B10A2_TYPELESS",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_R10G10B10A2_UNORM=24]="DXGI_FORMAT_R10G10B10A2_UNORM",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_R10G10B10A2_UINT=25]="DXGI_FORMAT_R10G10B10A2_UINT",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_R11G11B10_FLOAT=26]="DXGI_FORMAT_R11G11B10_FLOAT",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_R8G8B8A8_TYPELESS=27]="DXGI_FORMAT_R8G8B8A8_TYPELESS",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_R8G8B8A8_UNORM=28]="DXGI_FORMAT_R8G8B8A8_UNORM",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_R8G8B8A8_UNORM_SRGB=29]="DXGI_FORMAT_R8G8B8A8_UNORM_SRGB",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_R8G8B8A8_UINT=30]="DXGI_FORMAT_R8G8B8A8_UINT",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_R8G8B8A8_SNORM=31]="DXGI_FORMAT_R8G8B8A8_SNORM",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_R8G8B8A8_SINT=32]="DXGI_FORMAT_R8G8B8A8_SINT",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_R16G16_TYPELESS=33]="DXGI_FORMAT_R16G16_TYPELESS",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_R16G16_FLOAT=34]="DXGI_FORMAT_R16G16_FLOAT",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_R16G16_UNORM=35]="DXGI_FORMAT_R16G16_UNORM",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_R16G16_UINT=36]="DXGI_FORMAT_R16G16_UINT",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_R16G16_SNORM=37]="DXGI_FORMAT_R16G16_SNORM",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_R16G16_SINT=38]="DXGI_FORMAT_R16G16_SINT",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_R32_TYPELESS=39]="DXGI_FORMAT_R32_TYPELESS",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_D32_FLOAT=40]="DXGI_FORMAT_D32_FLOAT",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_R32_FLOAT=41]="DXGI_FORMAT_R32_FLOAT",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_R32_UINT=42]="DXGI_FORMAT_R32_UINT",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_R32_SINT=43]="DXGI_FORMAT_R32_SINT",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_R24G8_TYPELESS=44]="DXGI_FORMAT_R24G8_TYPELESS",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_D24_UNORM_S8_UINT=45]="DXGI_FORMAT_D24_UNORM_S8_UINT",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_R24_UNORM_X8_TYPELESS=46]="DXGI_FORMAT_R24_UNORM_X8_TYPELESS",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_X24_TYPELESS_G8_UINT=47]="DXGI_FORMAT_X24_TYPELESS_G8_UINT",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_R8G8_TYPELESS=48]="DXGI_FORMAT_R8G8_TYPELESS",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_R8G8_UNORM=49]="DXGI_FORMAT_R8G8_UNORM",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_R8G8_UINT=50]="DXGI_FORMAT_R8G8_UINT",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_R8G8_SNORM=51]="DXGI_FORMAT_R8G8_SNORM",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_R8G8_SINT=52]="DXGI_FORMAT_R8G8_SINT",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_R16_TYPELESS=53]="DXGI_FORMAT_R16_TYPELESS",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_R16_FLOAT=54]="DXGI_FORMAT_R16_FLOAT",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_D16_UNORM=55]="DXGI_FORMAT_D16_UNORM",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_R16_UNORM=56]="DXGI_FORMAT_R16_UNORM",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_R16_UINT=57]="DXGI_FORMAT_R16_UINT",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_R16_SNORM=58]="DXGI_FORMAT_R16_SNORM",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_R16_SINT=59]="DXGI_FORMAT_R16_SINT",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_R8_TYPELESS=60]="DXGI_FORMAT_R8_TYPELESS",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_R8_UNORM=61]="DXGI_FORMAT_R8_UNORM",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_R8_UINT=62]="DXGI_FORMAT_R8_UINT",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_R8_SNORM=63]="DXGI_FORMAT_R8_SNORM",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_R8_SINT=64]="DXGI_FORMAT_R8_SINT",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_A8_UNORM=65]="DXGI_FORMAT_A8_UNORM",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_R1_UNORM=66]="DXGI_FORMAT_R1_UNORM",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_R9G9B9E5_SHAREDEXP=67]="DXGI_FORMAT_R9G9B9E5_SHAREDEXP",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_R8G8_B8G8_UNORM=68]="DXGI_FORMAT_R8G8_B8G8_UNORM",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_G8R8_G8B8_UNORM=69]="DXGI_FORMAT_G8R8_G8B8_UNORM",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_BC1_TYPELESS=70]="DXGI_FORMAT_BC1_TYPELESS",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_BC1_UNORM=71]="DXGI_FORMAT_BC1_UNORM",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_BC1_UNORM_SRGB=72]="DXGI_FORMAT_BC1_UNORM_SRGB",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_BC2_TYPELESS=73]="DXGI_FORMAT_BC2_TYPELESS",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_BC2_UNORM=74]="DXGI_FORMAT_BC2_UNORM",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_BC2_UNORM_SRGB=75]="DXGI_FORMAT_BC2_UNORM_SRGB",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_BC3_TYPELESS=76]="DXGI_FORMAT_BC3_TYPELESS",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_BC3_UNORM=77]="DXGI_FORMAT_BC3_UNORM",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_BC3_UNORM_SRGB=78]="DXGI_FORMAT_BC3_UNORM_SRGB",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_BC4_TYPELESS=79]="DXGI_FORMAT_BC4_TYPELESS",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_BC4_UNORM=80]="DXGI_FORMAT_BC4_UNORM",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_BC4_SNORM=81]="DXGI_FORMAT_BC4_SNORM",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_BC5_TYPELESS=82]="DXGI_FORMAT_BC5_TYPELESS",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_BC5_UNORM=83]="DXGI_FORMAT_BC5_UNORM",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_BC5_SNORM=84]="DXGI_FORMAT_BC5_SNORM",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_B5G6R5_UNORM=85]="DXGI_FORMAT_B5G6R5_UNORM",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_B5G5R5A1_UNORM=86]="DXGI_FORMAT_B5G5R5A1_UNORM",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_B8G8R8A8_UNORM=87]="DXGI_FORMAT_B8G8R8A8_UNORM",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_B8G8R8X8_UNORM=88]="DXGI_FORMAT_B8G8R8X8_UNORM",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_R10G10B10_XR_BIAS_A2_UNORM=89]="DXGI_FORMAT_R10G10B10_XR_BIAS_A2_UNORM",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_B8G8R8A8_TYPELESS=90]="DXGI_FORMAT_B8G8R8A8_TYPELESS",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_B8G8R8A8_UNORM_SRGB=91]="DXGI_FORMAT_B8G8R8A8_UNORM_SRGB",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_B8G8R8X8_TYPELESS=92]="DXGI_FORMAT_B8G8R8X8_TYPELESS",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_B8G8R8X8_UNORM_SRGB=93]="DXGI_FORMAT_B8G8R8X8_UNORM_SRGB",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_BC6H_TYPELESS=94]="DXGI_FORMAT_BC6H_TYPELESS",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_BC6H_UF16=95]="DXGI_FORMAT_BC6H_UF16",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_BC6H_SF16=96]="DXGI_FORMAT_BC6H_SF16",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_BC7_TYPELESS=97]="DXGI_FORMAT_BC7_TYPELESS",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_BC7_UNORM=98]="DXGI_FORMAT_BC7_UNORM",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_BC7_UNORM_SRGB=99]="DXGI_FORMAT_BC7_UNORM_SRGB",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_AYUV=100]="DXGI_FORMAT_AYUV",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_Y410=101]="DXGI_FORMAT_Y410",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_Y416=102]="DXGI_FORMAT_Y416",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_NV12=103]="DXGI_FORMAT_NV12",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_P010=104]="DXGI_FORMAT_P010",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_P016=105]="DXGI_FORMAT_P016",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_420_OPAQUE=106]="DXGI_FORMAT_420_OPAQUE",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_YUY2=107]="DXGI_FORMAT_YUY2",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_Y210=108]="DXGI_FORMAT_Y210",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_Y216=109]="DXGI_FORMAT_Y216",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_NV11=110]="DXGI_FORMAT_NV11",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_AI44=111]="DXGI_FORMAT_AI44",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_IA44=112]="DXGI_FORMAT_IA44",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_P8=113]="DXGI_FORMAT_P8",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_A8P8=114]="DXGI_FORMAT_A8P8",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_B4G4R4A4_UNORM=115]="DXGI_FORMAT_B4G4R4A4_UNORM",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_P208=116]="DXGI_FORMAT_P208",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_V208=117]="DXGI_FORMAT_V208",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_V408=118]="DXGI_FORMAT_V408",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_SAMPLER_FEEDBACK_MIN_MIP_OPAQUE=119]="DXGI_FORMAT_SAMPLER_FEEDBACK_MIN_MIP_OPAQUE",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_SAMPLER_FEEDBACK_MIP_REGION_USED_OPAQUE=120]="DXGI_FORMAT_SAMPLER_FEEDBACK_MIP_REGION_USED_OPAQUE",DXGI_FORMAT[DXGI_FORMAT.DXGI_FORMAT_FORCE_UINT=121]="DXGI_FORMAT_FORCE_UINT"}(DXGI_FORMAT||(DXGI_FORMAT={})),function(D3D10_RESOURCE_DIMENSION){D3D10_RESOURCE_DIMENSION[D3D10_RESOURCE_DIMENSION.DDS_DIMENSION_TEXTURE1D=2]="DDS_DIMENSION_TEXTURE1D",D3D10_RESOURCE_DIMENSION[D3D10_RESOURCE_DIMENSION.DDS_DIMENSION_TEXTURE2D=3]="DDS_DIMENSION_TEXTURE2D",D3D10_RESOURCE_DIMENSION[D3D10_RESOURCE_DIMENSION.DDS_DIMENSION_TEXTURE3D=6]="DDS_DIMENSION_TEXTURE3D"}(D3D10_RESOURCE_DIMENSION||(D3D10_RESOURCE_DIMENSION={}));var _a$2,_b$1,_c,FOURCC_TO_FORMAT=((_a$1={})[827611204]=INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT1_EXT,_a$1[861165636]=INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT3_EXT,_a$1[894720068]=INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT5_EXT,_a$1),DXGI_TO_FORMAT=((_b={})[DXGI_FORMAT.DXGI_FORMAT_BC1_TYPELESS]=INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT1_EXT,_b[DXGI_FORMAT.DXGI_FORMAT_BC1_UNORM]=INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT1_EXT,_b[DXGI_FORMAT.DXGI_FORMAT_BC2_TYPELESS]=INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT3_EXT,_b[DXGI_FORMAT.DXGI_FORMAT_BC2_UNORM]=INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT3_EXT,_b[DXGI_FORMAT.DXGI_FORMAT_BC3_TYPELESS]=INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT5_EXT,_b[DXGI_FORMAT.DXGI_FORMAT_BC3_UNORM]=INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT5_EXT,_b[DXGI_FORMAT.DXGI_FORMAT_BC1_UNORM_SRGB]=INTERNAL_FORMATS.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,_b[DXGI_FORMAT.DXGI_FORMAT_BC2_UNORM_SRGB]=INTERNAL_FORMATS.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,_b[DXGI_FORMAT.DXGI_FORMAT_BC3_UNORM_SRGB]=INTERNAL_FORMATS.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT,_b),DDSLoader=function(){function DDSLoader(){}return DDSLoader.use=function(resource,next){if("dds"===resource.extension&&resource.data)try{Object.assign(resource,registerCompressedTextures(resource.name||resource.url,DDSLoader.parse(resource.data),resource.metadata))}catch(err){return void next(err)}next()},DDSLoader.parse=function(arrayBuffer){var data=new Uint32Array(arrayBuffer);if(542327876!==data[0])throw new Error("Invalid DDS file magic word");var header=new Uint32Array(arrayBuffer,0,124/Uint32Array.BYTES_PER_ELEMENT),height=header[DDS_FIELDS_HEIGHT],width=header[DDS_FIELDS_WIDTH],mipmapCount=header[DDS_FIELDS_MIPMAP_COUNT],pixelFormat=new Uint32Array(arrayBuffer,DDS_FIELDS_PIXEL_FORMAT*Uint32Array.BYTES_PER_ELEMENT,32/Uint32Array.BYTES_PER_ELEMENT),formatFlags=pixelFormat[1];if(4&formatFlags){var fourCC=pixelFormat[DDS_PF_FIELDS_FOURCC];if(808540228!==fourCC){var internalFormat_1=FOURCC_TO_FORMAT[fourCC],texData=new Uint8Array(arrayBuffer,128);return[new CompressedTextureResource(texData,{format:internalFormat_1,width,height,levels:mipmapCount})]}var dx10Header=new Uint32Array(data.buffer,128,20/Uint32Array.BYTES_PER_ELEMENT),dxgiFormat=dx10Header[DDS_DX10_FIELDS_DXGI_FORMAT],resourceDimension=dx10Header[DDS_DX10_FIELDS_RESOURCE_DIMENSION],miscFlag=dx10Header[DDS_DX10_FIELDS_MISC_FLAG],arraySize=dx10Header[DDS_DX10_FIELDS_ARRAY_SIZE],internalFormat_2=DXGI_TO_FORMAT[dxgiFormat];if(void 0===internalFormat_2)throw new Error("DDSLoader cannot parse texture data with DXGI format "+dxgiFormat);if(4===miscFlag)throw new Error("DDSLoader does not support cubemap textures");if(resourceDimension===D3D10_RESOURCE_DIMENSION.DDS_DIMENSION_TEXTURE3D)throw new Error("DDSLoader does not supported 3D texture data");var imageBuffers=new Array;if(1===arraySize)imageBuffers.push(new Uint8Array(arrayBuffer,148));else{for(var pixelSize=INTERNAL_FORMAT_TO_BYTES_PER_PIXEL[internalFormat_2],imageSize=0,levelWidth=width,levelHeight=height,i=0;i<mipmapCount;i++){imageSize+=Math.max(1,levelWidth+3&-4)*Math.max(1,levelHeight+3&-4)*pixelSize,levelWidth>>>=1,levelHeight>>>=1}var imageOffset=148;for(i=0;i<arraySize;i++)imageBuffers.push(new Uint8Array(arrayBuffer,imageOffset,imageSize)),imageOffset+=imageSize}return imageBuffers.map((function(buffer){return new CompressedTextureResource(buffer,{format:internalFormat_2,width,height,levels:mipmapCount})}))}if(64&formatFlags)throw new Error("DDSLoader does not support uncompressed texture data.");if(512&formatFlags)throw new Error("DDSLoader does not supported YUV uncompressed texture data.");if(131072&formatFlags)throw new Error("DDSLoader does not support single-channel (lumninance) texture data!");if(2&formatFlags)throw new Error("DDSLoader does not support single-channel (alpha) texture data!");throw new Error("DDSLoader failed to load a texture file due to an unknown reason!")},DDSLoader}();LoaderResource.setExtensionXhrType("ktx",LoaderResource.XHR_RESPONSE_TYPE.BUFFER);var FILE_IDENTIFIER=[171,75,84,88,32,49,49,187,13,10,26,10],KTX_FIELDS_ENDIANNESS=12,KTX_FIELDS_GL_TYPE=16,KTX_FIELDS_GL_FORMAT=24,KTX_FIELDS_GL_INTERNAL_FORMAT=28,KTX_FIELDS_PIXEL_WIDTH=36,KTX_FIELDS_PIXEL_HEIGHT=40,KTX_FIELDS_PIXEL_DEPTH=44,KTX_FIELDS_NUMBER_OF_ARRAY_ELEMENTS=48,KTX_FIELDS_NUMBER_OF_FACES=52,KTX_FIELDS_NUMBER_OF_MIPMAP_LEVELS=56,KTX_FIELDS_BYTES_OF_KEY_VALUE_DATA=60,TYPES_TO_BYTES_PER_COMPONENT=((_a$2={})[constants_TYPES.UNSIGNED_BYTE]=1,_a$2[constants_TYPES.UNSIGNED_SHORT]=2,_a$2[constants_TYPES.INT]=4,_a$2[constants_TYPES.UNSIGNED_INT]=4,_a$2[constants_TYPES.FLOAT]=4,_a$2[constants_TYPES.HALF_FLOAT]=8,_a$2),FORMATS_TO_COMPONENTS=((_b$1={})[constants_FORMATS.RGBA]=4,_b$1[constants_FORMATS.RGB]=3,_b$1[constants_FORMATS.RG]=2,_b$1[constants_FORMATS.RED]=1,_b$1[constants_FORMATS.LUMINANCE]=1,_b$1[constants_FORMATS.LUMINANCE_ALPHA]=2,_b$1[constants_FORMATS.ALPHA]=1,_b$1),TYPES_TO_BYTES_PER_PIXEL=((_c={})[constants_TYPES.UNSIGNED_SHORT_4_4_4_4]=2,_c[constants_TYPES.UNSIGNED_SHORT_5_5_5_1]=2,_c[constants_TYPES.UNSIGNED_SHORT_5_6_5]=2,_c),KTXLoader=function(){function KTXLoader(){}return KTXLoader.use=function(resource,next){if("ktx"===resource.extension&&resource.data)try{var url_1=resource.name||resource.url,_a=KTXLoader.parse(url_1,resource.data),compressed=_a.compressed,uncompressed=_a.uncompressed;if(compressed)Object.assign(resource,registerCompressedTextures(url_1,compressed,resource.metadata));else if(uncompressed){var textures_1={};uncompressed.forEach((function(image,i){var texture=new Texture(new BaseTexture(image.resource,{mipmap:constants_MIPMAP_MODES.OFF,alphaMode:constants_ALPHA_MODES.NO_PREMULTIPLIED_ALPHA,type:image.type,format:image.format})),cacheID=url_1+"-"+(i+1);BaseTexture.addToCache(texture.baseTexture,cacheID),Texture.addToCache(texture,cacheID),0===i&&(textures_1[url_1]=texture,BaseTexture.addToCache(texture.baseTexture,url_1),Texture.addToCache(texture,url_1)),textures_1[cacheID]=texture})),Object.assign(resource,{textures:textures_1})}}catch(err){return void next(err)}next()},KTXLoader.parse=function(url,arrayBuffer){var dataView=new DataView(arrayBuffer);if(!KTXLoader.validate(url,dataView))return null;var littleEndian=67305985===dataView.getUint32(KTX_FIELDS_ENDIANNESS,!0),glType=dataView.getUint32(KTX_FIELDS_GL_TYPE,littleEndian),glFormat=dataView.getUint32(KTX_FIELDS_GL_FORMAT,littleEndian),glInternalFormat=dataView.getUint32(KTX_FIELDS_GL_INTERNAL_FORMAT,littleEndian),pixelWidth=dataView.getUint32(KTX_FIELDS_PIXEL_WIDTH,littleEndian),pixelHeight=dataView.getUint32(KTX_FIELDS_PIXEL_HEIGHT,littleEndian)||1,pixelDepth=dataView.getUint32(KTX_FIELDS_PIXEL_DEPTH,littleEndian)||1,numberOfArrayElements=dataView.getUint32(KTX_FIELDS_NUMBER_OF_ARRAY_ELEMENTS,littleEndian)||1,numberOfFaces=dataView.getUint32(KTX_FIELDS_NUMBER_OF_FACES,littleEndian),numberOfMipmapLevels=dataView.getUint32(KTX_FIELDS_NUMBER_OF_MIPMAP_LEVELS,littleEndian),bytesOfKeyValueData=dataView.getUint32(KTX_FIELDS_BYTES_OF_KEY_VALUE_DATA,littleEndian);if(0===pixelHeight||1!==pixelDepth)throw new Error("Only 2D textures are supported");if(1!==numberOfFaces)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(1!==numberOfArrayElements)throw new Error("WebGL does not support array textures");var imagePixelByteSize,alignedWidth=pixelWidth+3&-4,alignedHeight=pixelHeight+3&-4,imageBuffers=new Array(numberOfArrayElements),imagePixels=pixelWidth*pixelHeight;if(0===glType&&(imagePixels=alignedWidth*alignedHeight),void 0===(imagePixelByteSize=0!==glType?TYPES_TO_BYTES_PER_COMPONENT[glType]?TYPES_TO_BYTES_PER_COMPONENT[glType]*FORMATS_TO_COMPONENTS[glFormat]:TYPES_TO_BYTES_PER_PIXEL[glType]:INTERNAL_FORMAT_TO_BYTES_PER_PIXEL[glInternalFormat]))throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");for(var mipByteSize=imagePixels*imagePixelByteSize,mipWidth=pixelWidth,mipHeight=pixelHeight,alignedMipWidth=alignedWidth,alignedMipHeight=alignedHeight,imageOffset=64+bytesOfKeyValueData,mipmapLevel=0;mipmapLevel<numberOfMipmapLevels;mipmapLevel++){for(var imageSize=dataView.getUint32(imageOffset,littleEndian),elementOffset=imageOffset+4,arrayElement=0;arrayElement<numberOfArrayElements;arrayElement++){var mips=imageBuffers[arrayElement];mips||(mips=imageBuffers[arrayElement]=new Array(numberOfMipmapLevels)),mips[mipmapLevel]={levelID:mipmapLevel,levelWidth:numberOfMipmapLevels>1||0!==glType?mipWidth:alignedMipWidth,levelHeight:numberOfMipmapLevels>1||0!==glType?mipHeight:alignedMipHeight,levelBuffer:new Uint8Array(arrayBuffer,elementOffset,mipByteSize)},elementOffset+=mipByteSize}imageOffset=(imageOffset+=imageSize+4)%4!=0?imageOffset+4-imageOffset%4:imageOffset,mipByteSize=(alignedMipWidth=(mipWidth=mipWidth>>1||1)+4-1&-4)*(alignedMipHeight=(mipHeight=mipHeight>>1||1)+4-1&-4)*imagePixelByteSize}return 0!==glType?{uncompressed:imageBuffers.map((function(levelBuffers){var buffer=levelBuffers[0].levelBuffer,convertToInt=!1;return glType===constants_TYPES.FLOAT?buffer=new Float32Array(levelBuffers[0].levelBuffer.buffer,levelBuffers[0].levelBuffer.byteOffset,levelBuffers[0].levelBuffer.byteLength/4):glType===constants_TYPES.UNSIGNED_INT?(convertToInt=!0,buffer=new Uint32Array(levelBuffers[0].levelBuffer.buffer,levelBuffers[0].levelBuffer.byteOffset,levelBuffers[0].levelBuffer.byteLength/4)):glType===constants_TYPES.INT&&(convertToInt=!0,buffer=new Int32Array(levelBuffers[0].levelBuffer.buffer,levelBuffers[0].levelBuffer.byteOffset,levelBuffers[0].levelBuffer.byteLength/4)),{resource:new BufferResource(buffer,{width:levelBuffers[0].levelWidth,height:levelBuffers[0].levelHeight}),type:glType,format:convertToInt?KTXLoader.convertFormatToInteger(glFormat):glFormat}}))}:{compressed:imageBuffers.map((function(levelBuffers){return new CompressedTextureResource(null,{format:glInternalFormat,width:pixelWidth,height:pixelHeight,levels:numberOfMipmapLevels,levelBuffers})}))}},KTXLoader.validate=function(url,dataView){for(var i=0;i<FILE_IDENTIFIER.length;i++)if(dataView.getUint8(i)!==FILE_IDENTIFIER[i])return console.error(url+" is not a valid *.ktx file!"),!1;return!0},KTXLoader.convertFormatToInteger=function(format){switch(format){case constants_FORMATS.RGBA:return constants_FORMATS.RGBA_INTEGER;case constants_FORMATS.RGB:return constants_FORMATS.RGB_INTEGER;case constants_FORMATS.RG:return constants_FORMATS.RG_INTEGER;case constants_FORMATS.RED:return constants_FORMATS.RED_INTEGER;default:return format}},KTXLoader}(),particle_container_extendStatics=function(d,b){return particle_container_extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])},particle_container_extendStatics(d,b)};function particle_container_extends(d,b){function __(){this.constructor=d}particle_container_extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}var LINE_JOIN,LINE_CAP,ParticleContainer=function(_super){function ParticleContainer(maxSize,properties,batchSize,autoResize){void 0===maxSize&&(maxSize=1500),void 0===batchSize&&(batchSize=16384),void 0===autoResize&&(autoResize=!1);var _this=_super.call(this)||this;return batchSize>16384&&(batchSize=16384),_this._properties=[!1,!0,!1,!1,!1],_this._maxSize=maxSize,_this._batchSize=batchSize,_this._buffers=null,_this._bufferUpdateIDs=[],_this._updateID=0,_this.interactiveChildren=!1,_this.blendMode=constants_BLEND_MODES.NORMAL,_this.autoResize=autoResize,_this.roundPixels=!0,_this.baseTexture=null,_this.setProperties(properties),_this._tint=0,_this.tintRgb=new Float32Array(4),_this.tint=16777215,_this}return particle_container_extends(ParticleContainer,_super),ParticleContainer.prototype.setProperties=function(properties){properties&&(this._properties[0]="vertices"in properties||"scale"in properties?!!properties.vertices||!!properties.scale:this._properties[0],this._properties[1]="position"in properties?!!properties.position:this._properties[1],this._properties[2]="rotation"in properties?!!properties.rotation:this._properties[2],this._properties[3]="uvs"in properties?!!properties.uvs:this._properties[3],this._properties[4]="tint"in properties||"alpha"in properties?!!properties.tint||!!properties.alpha:this._properties[4])},ParticleContainer.prototype.updateTransform=function(){this.displayObjectUpdateTransform()},Object.defineProperty(ParticleContainer.prototype,"tint",{get:function(){return this._tint},set:function(value){this._tint=value,hex2rgb(value,this.tintRgb)},enumerable:!1,configurable:!0}),ParticleContainer.prototype.render=function(renderer){var _this=this;this.visible&&!(this.worldAlpha<=0)&&this.children.length&&this.renderable&&(this.baseTexture||(this.baseTexture=this.children[0]._texture.baseTexture,this.baseTexture.valid||this.baseTexture.once("update",(function(){return _this.onChildrenChange(0)}))),renderer.batch.setObjectRenderer(renderer.plugins.particle),renderer.plugins.particle.render(this))},ParticleContainer.prototype.onChildrenChange=function(smallestChildIndex){for(var bufferIndex=Math.floor(smallestChildIndex/this._batchSize);this._bufferUpdateIDs.length<bufferIndex;)this._bufferUpdateIDs.push(0);this._bufferUpdateIDs[bufferIndex]=++this._updateID},ParticleContainer.prototype.dispose=function(){if(this._buffers){for(var i=0;i<this._buffers.length;++i)this._buffers[i].destroy();this._buffers=null}},ParticleContainer.prototype.destroy=function(options){_super.prototype.destroy.call(this,options),this.dispose(),this._properties=null,this._buffers=null,this._bufferUpdateIDs=null},ParticleContainer}(Container),ParticleBuffer=function(){function ParticleBuffer(properties,dynamicPropertyFlags,size){this.geometry=new Geometry,this.indexBuffer=null,this.size=size,this.dynamicProperties=[],this.staticProperties=[];for(var i=0;i<properties.length;++i){var property=properties[i];property={attributeName:property.attributeName,size:property.size,uploadFunction:property.uploadFunction,type:property.type||constants_TYPES.FLOAT,offset:property.offset},dynamicPropertyFlags[i]?this.dynamicProperties.push(property):this.staticProperties.push(property)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}return ParticleBuffer.prototype.initBuffers=function(){var geometry=this.geometry,dynamicOffset=0;this.indexBuffer=new Buffer(function(size,outBuffer){void 0===outBuffer&&(outBuffer=null);var totalIndices=6*size;if((outBuffer=outBuffer||new Uint16Array(totalIndices)).length!==totalIndices)throw new Error("Out buffer length is incorrect, got "+outBuffer.length+" and expected "+totalIndices);for(var i=0,j=0;i<totalIndices;i+=6,j+=4)outBuffer[i+0]=j+0,outBuffer[i+1]=j+1,outBuffer[i+2]=j+2,outBuffer[i+3]=j+0,outBuffer[i+4]=j+2,outBuffer[i+5]=j+3;return outBuffer}(this.size),!0,!0),geometry.addIndex(this.indexBuffer),this.dynamicStride=0;for(var i=0;i<this.dynamicProperties.length;++i){(property=this.dynamicProperties[i]).offset=dynamicOffset,dynamicOffset+=property.size,this.dynamicStride+=property.size}var dynBuffer=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(dynBuffer),this.dynamicDataUint32=new Uint32Array(dynBuffer),this.dynamicBuffer=new Buffer(this.dynamicData,!1,!1);var staticOffset=0;this.staticStride=0;for(i=0;i<this.staticProperties.length;++i){(property=this.staticProperties[i]).offset=staticOffset,staticOffset+=property.size,this.staticStride+=property.size}var statBuffer=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(statBuffer),this.staticDataUint32=new Uint32Array(statBuffer),this.staticBuffer=new Buffer(this.staticData,!0,!1);for(i=0;i<this.dynamicProperties.length;++i){var property=this.dynamicProperties[i];geometry.addAttribute(property.attributeName,this.dynamicBuffer,0,property.type===constants_TYPES.UNSIGNED_BYTE,property.type,4*this.dynamicStride,4*property.offset)}for(i=0;i<this.staticProperties.length;++i){property=this.staticProperties[i];geometry.addAttribute(property.attributeName,this.staticBuffer,0,property.type===constants_TYPES.UNSIGNED_BYTE,property.type,4*this.staticStride,4*property.offset)}},ParticleBuffer.prototype.uploadDynamic=function(children,startIndex,amount){for(var i=0;i<this.dynamicProperties.length;i++){var property=this.dynamicProperties[i];property.uploadFunction(children,startIndex,amount,property.type===constants_TYPES.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,property.offset)}this.dynamicBuffer._updateID++},ParticleBuffer.prototype.uploadStatic=function(children,startIndex,amount){for(var i=0;i<this.staticProperties.length;i++){var property=this.staticProperties[i];property.uploadFunction(children,startIndex,amount,property.type===constants_TYPES.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,property.offset)}this.staticBuffer._updateID++},ParticleBuffer.prototype.destroy=function(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()},ParticleBuffer}(),ParticleRenderer=function(_super){function ParticleRenderer(renderer){var _this=_super.call(this,renderer)||this;return _this.shader=null,_this.properties=null,_this.tempMatrix=new Matrix,_this.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:_this.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:_this.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:_this.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:_this.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:constants_TYPES.UNSIGNED_BYTE,uploadFunction:_this.uploadTint,offset:0}],_this.shader=Shader.from("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nattribute vec2 aPositionCoord;\nattribute float aRotation;\n\nuniform mat3 translationMatrix;\nuniform vec4 uColor;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nvoid main(void){\n    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);\n    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);\n\n    vec2 v = vec2(x, y);\n    v = v + aPositionCoord;\n\n    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vColor = aColor * uColor;\n}\n","varying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;\n    gl_FragColor = color;\n}",{}),_this.state=State.for2d(),_this}return particle_container_extends(ParticleRenderer,_super),ParticleRenderer.prototype.render=function(container){var children=container.children,maxSize=container._maxSize,batchSize=container._batchSize,renderer=this.renderer,totalChildren=children.length;if(0!==totalChildren){totalChildren>maxSize&&!container.autoResize&&(totalChildren=maxSize);var buffers=container._buffers;buffers||(buffers=container._buffers=this.generateBuffers(container));var baseTexture=children[0]._texture.baseTexture;this.state.blendMode=correctBlendMode(container.blendMode,baseTexture.alphaMode),renderer.state.set(this.state);var rgb,alpha,out,premultiply,gl=renderer.gl,m=container.worldTransform.copyTo(this.tempMatrix);m.prepend(renderer.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=m.toArray(!0),this.shader.uniforms.uColor=(rgb=container.tintRgb,alpha=container.worldAlpha,out=this.shader.uniforms.uColor,premultiply=baseTexture.alphaMode,out=out||new Float32Array(4),premultiply||void 0===premultiply?(out[0]=rgb[0]*alpha,out[1]=rgb[1]*alpha,out[2]=rgb[2]*alpha):(out[0]=rgb[0],out[1]=rgb[1],out[2]=rgb[2]),out[3]=alpha,out),this.shader.uniforms.uSampler=baseTexture,this.renderer.shader.bind(this.shader);for(var updateStatic=!1,i=0,j=0;i<totalChildren;i+=batchSize,j+=1){var amount=totalChildren-i;amount>batchSize&&(amount=batchSize),j>=buffers.length&&buffers.push(this._generateOneMoreBuffer(container));var buffer=buffers[j];buffer.uploadDynamic(children,i,amount);var bid=container._bufferUpdateIDs[j]||0;(updateStatic=updateStatic||buffer._updateID<bid)&&(buffer._updateID=container._updateID,buffer.uploadStatic(children,i,amount)),renderer.geometry.bind(buffer.geometry),gl.drawElements(gl.TRIANGLES,6*amount,gl.UNSIGNED_SHORT,0)}}},ParticleRenderer.prototype.generateBuffers=function(container){for(var buffers=[],size=container._maxSize,batchSize=container._batchSize,dynamicPropertyFlags=container._properties,i=0;i<size;i+=batchSize)buffers.push(new ParticleBuffer(this.properties,dynamicPropertyFlags,batchSize));return buffers},ParticleRenderer.prototype._generateOneMoreBuffer=function(container){var batchSize=container._batchSize,dynamicPropertyFlags=container._properties;return new ParticleBuffer(this.properties,dynamicPropertyFlags,batchSize)},ParticleRenderer.prototype.uploadVertices=function(children,startIndex,amount,array,stride,offset){for(var w0=0,w1=0,h0=0,h1=0,i=0;i<amount;++i){var sprite=children[startIndex+i],texture=sprite._texture,sx=sprite.scale.x,sy=sprite.scale.y,trim=texture.trim,orig=texture.orig;trim?(w0=(w1=trim.x-sprite.anchor.x*orig.width)+trim.width,h0=(h1=trim.y-sprite.anchor.y*orig.height)+trim.height):(w0=orig.width*(1-sprite.anchor.x),w1=orig.width*-sprite.anchor.x,h0=orig.height*(1-sprite.anchor.y),h1=orig.height*-sprite.anchor.y),array[offset]=w1*sx,array[offset+1]=h1*sy,array[offset+stride]=w0*sx,array[offset+stride+1]=h1*sy,array[offset+2*stride]=w0*sx,array[offset+2*stride+1]=h0*sy,array[offset+3*stride]=w1*sx,array[offset+3*stride+1]=h0*sy,offset+=4*stride}},ParticleRenderer.prototype.uploadPosition=function(children,startIndex,amount,array,stride,offset){for(var i=0;i<amount;i++){var spritePosition=children[startIndex+i].position;array[offset]=spritePosition.x,array[offset+1]=spritePosition.y,array[offset+stride]=spritePosition.x,array[offset+stride+1]=spritePosition.y,array[offset+2*stride]=spritePosition.x,array[offset+2*stride+1]=spritePosition.y,array[offset+3*stride]=spritePosition.x,array[offset+3*stride+1]=spritePosition.y,offset+=4*stride}},ParticleRenderer.prototype.uploadRotation=function(children,startIndex,amount,array,stride,offset){for(var i=0;i<amount;i++){var spriteRotation=children[startIndex+i].rotation;array[offset]=spriteRotation,array[offset+stride]=spriteRotation,array[offset+2*stride]=spriteRotation,array[offset+3*stride]=spriteRotation,offset+=4*stride}},ParticleRenderer.prototype.uploadUvs=function(children,startIndex,amount,array,stride,offset){for(var i=0;i<amount;++i){var textureUvs=children[startIndex+i]._texture._uvs;textureUvs?(array[offset]=textureUvs.x0,array[offset+1]=textureUvs.y0,array[offset+stride]=textureUvs.x1,array[offset+stride+1]=textureUvs.y1,array[offset+2*stride]=textureUvs.x2,array[offset+2*stride+1]=textureUvs.y2,array[offset+3*stride]=textureUvs.x3,array[offset+3*stride+1]=textureUvs.y3,offset+=4*stride):(array[offset]=0,array[offset+1]=0,array[offset+stride]=0,array[offset+stride+1]=0,array[offset+2*stride]=0,array[offset+2*stride+1]=0,array[offset+3*stride]=0,array[offset+3*stride+1]=0,offset+=4*stride)}},ParticleRenderer.prototype.uploadTint=function(children,startIndex,amount,array,stride,offset){for(var i=0;i<amount;++i){var sprite=children[startIndex+i],premultiplied=sprite._texture.baseTexture.alphaMode>0,alpha=sprite.alpha,argb=alpha<1&&premultiplied?premultiplyTint(sprite._tintRGB,alpha):sprite._tintRGB+(255*alpha<<24);array[offset]=argb,array[offset+stride]=argb,array[offset+2*stride]=argb,array[offset+3*stride]=argb,offset+=4*stride}},ParticleRenderer.prototype.destroy=function(){_super.prototype.destroy.call(this),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null},ParticleRenderer}(ObjectRenderer);!function(LINE_JOIN){LINE_JOIN.MITER="miter",LINE_JOIN.BEVEL="bevel",LINE_JOIN.ROUND="round"}(LINE_JOIN||(LINE_JOIN={})),function(LINE_CAP){LINE_CAP.BUTT="butt",LINE_CAP.ROUND="round",LINE_CAP.SQUARE="square"}(LINE_CAP||(LINE_CAP={}));var GRAPHICS_CURVES={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount:function(length,defaultSegments){if(void 0===defaultSegments&&(defaultSegments=20),!this.adaptive||!length||isNaN(length))return defaultSegments;var result=Math.ceil(length/this.maxLength);return result<this.minSegments?result=this.minSegments:result>this.maxSegments&&(result=this.maxSegments),result}},FillStyle=function(){function FillStyle(){this.color=16777215,this.alpha=1,this.texture=Texture.WHITE,this.matrix=null,this.visible=!1,this.reset()}return FillStyle.prototype.clone=function(){var obj=new FillStyle;return obj.color=this.color,obj.alpha=this.alpha,obj.texture=this.texture,obj.matrix=this.matrix,obj.visible=this.visible,obj},FillStyle.prototype.reset=function(){this.color=16777215,this.alpha=1,this.texture=Texture.WHITE,this.matrix=null,this.visible=!1},FillStyle.prototype.destroy=function(){this.texture=null,this.matrix=null},FillStyle}(),graphics_extendStatics=function(d,b){return graphics_extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])},graphics_extendStatics(d,b)};function graphics_extends(d,b){function __(){this.constructor=d}graphics_extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}function fixOrientation(points,hole){var _a,_b;void 0===hole&&(hole=!1);var m=points.length;if(!(m<6)){for(var area=0,i=0,x1=points[m-2],y1=points[m-1];i<m;i+=2){var x2=points[i],y2=points[i+1];area+=(x2-x1)*(y2+y1),x1=x2,y1=y2}if(!hole&&area>0||hole&&area<=0){var n=m/2;for(i=n+n%2;i<m;i+=2){var i1=m-i-2,i2=m-i-1,i3=i,i4=i+1;_a=[points[i3],points[i1]],points[i1]=_a[0],points[i3]=_a[1],_b=[points[i4],points[i2]],points[i2]=_b[0],points[i4]=_b[1]}}}}var buildPoly={build:function(graphicsData){graphicsData.points=graphicsData.shape.points.slice()},triangulate:function(graphicsData,graphicsGeometry){var points=graphicsData.points,holes=graphicsData.holes,verts=graphicsGeometry.points,indices=graphicsGeometry.indices;if(points.length>=6){fixOrientation(points,!1);for(var holeArray=[],i=0;i<holes.length;i++){var hole=holes[i];fixOrientation(hole.points,!0),holeArray.push(points.length/2),points=points.concat(hole.points)}var triangles=earcut_default()(points,holeArray,2);if(!triangles)return;var vertPos=verts.length/2;for(i=0;i<triangles.length;i+=3)indices.push(triangles[i]+vertPos),indices.push(triangles[i+1]+vertPos),indices.push(triangles[i+2]+vertPos);for(i=0;i<points.length;i++)verts.push(points[i])}}},buildCircle={build:function(graphicsData){var x,y,dx,dy,rx,ry,points=graphicsData.points;if(graphicsData.type===SHAPES.CIRC){var circle=graphicsData.shape;x=circle.x,y=circle.y,rx=ry=circle.radius,dx=dy=0}else if(graphicsData.type===SHAPES.ELIP){var ellipse=graphicsData.shape;x=ellipse.x,y=ellipse.y,rx=ellipse.width,ry=ellipse.height,dx=dy=0}else{var roundedRect=graphicsData.shape,halfWidth=roundedRect.width/2,halfHeight=roundedRect.height/2;x=roundedRect.x+halfWidth,y=roundedRect.y+halfHeight,dx=halfWidth-(rx=ry=Math.max(0,Math.min(roundedRect.radius,Math.min(halfWidth,halfHeight)))),dy=halfHeight-ry}var n=Math.ceil(2.3*Math.sqrt(rx+ry)),m=8*n+(dx?4:0)+(dy?4:0);if(points.length=m,0!==m){if(0===n)return points.length=8,points[0]=points[6]=x+dx,points[1]=points[3]=y+dy,points[2]=points[4]=x-dx,void(points[5]=points[7]=y-dy);var j1=0,j2=4*n+(dx?2:0)+2,j3=j2,j4=m,x1=x+(x0=dx+rx),x2=x-x0,y1=y+(y0=dy);if(points[j1++]=x1,points[j1++]=y1,points[--j2]=y1,points[--j2]=x2,dy){var y2=y-y0;points[j3++]=x2,points[j3++]=y2,points[--j4]=y2,points[--j4]=x1}for(var i=1;i<n;i++){var a=Math.PI/2*(i/n);x1=x+(x0=dx+Math.cos(a)*rx),x2=x-x0,y1=y+(y0=dy+Math.sin(a)*ry),y2=y-y0;points[j1++]=x1,points[j1++]=y1,points[--j2]=y1,points[--j2]=x2,points[j3++]=x2,points[j3++]=y2,points[--j4]=y2,points[--j4]=x1}var x0,y0;x1=x+(x0=dx),x2=x-x0,y1=y+(y0=dy+ry),y2=y-y0;points[j1++]=x1,points[j1++]=y1,points[--j4]=y2,points[--j4]=x1,dx&&(points[j1++]=x2,points[j1++]=y1,points[--j4]=y2,points[--j4]=x2)}},triangulate:function(graphicsData,graphicsGeometry){var x,y,points=graphicsData.points,verts=graphicsGeometry.points,indices=graphicsGeometry.indices,vertPos=verts.length/2,center=vertPos;if(graphicsData.type!==SHAPES.RREC){var circle=graphicsData.shape;x=circle.x,y=circle.y}else{var roundedRect=graphicsData.shape;x=roundedRect.x+roundedRect.width/2,y=roundedRect.y+roundedRect.height/2}var matrix=graphicsData.matrix;verts.push(graphicsData.matrix?matrix.a*x+matrix.c*y+matrix.tx:x,graphicsData.matrix?matrix.b*x+matrix.d*y+matrix.ty:y),vertPos++,verts.push(points[0],points[1]);for(var i=2;i<points.length;i+=2)verts.push(points[i],points[i+1]),indices.push(vertPos++,center,vertPos);indices.push(center+1,center,vertPos)}},buildRectangle={build:function(graphicsData){var rectData=graphicsData.shape,x=rectData.x,y=rectData.y,width=rectData.width,height=rectData.height,points=graphicsData.points;points.length=0,points.push(x,y,x+width,y,x+width,y+height,x,y+height)},triangulate:function(graphicsData,graphicsGeometry){var points=graphicsData.points,verts=graphicsGeometry.points,vertPos=verts.length/2;verts.push(points[0],points[1],points[2],points[3],points[6],points[7],points[4],points[5]),graphicsGeometry.indices.push(vertPos,vertPos+1,vertPos+2,vertPos+1,vertPos+2,vertPos+3)}};function getPt(n1,n2,perc){return n1+(n2-n1)*perc}function quadraticBezierCurve(fromX,fromY,cpX,cpY,toX,toY,out){void 0===out&&(out=[]);for(var points=out,xa=0,ya=0,xb=0,yb=0,x=0,y=0,i=0,j=0;i<=20;++i)xa=getPt(fromX,cpX,j=i/20),ya=getPt(fromY,cpY,j),xb=getPt(cpX,toX,j),yb=getPt(cpY,toY,j),x=getPt(xa,xb,j),y=getPt(ya,yb,j),0===i&&points[points.length-2]===x&&points[points.length-1]===y||points.push(x,y);return points}var buildRoundedRectangle={build:function(graphicsData){if(Graphics.nextRoundedRectBehavior)buildCircle.build(graphicsData);else{var rrectData=graphicsData.shape,points=graphicsData.points,x=rrectData.x,y=rrectData.y,width=rrectData.width,height=rrectData.height,radius=Math.max(0,Math.min(rrectData.radius,Math.min(width,height)/2));points.length=0,radius?(quadraticBezierCurve(x,y+radius,x,y,x+radius,y,points),quadraticBezierCurve(x+width-radius,y,x+width,y,x+width,y+radius,points),quadraticBezierCurve(x+width,y+height-radius,x+width,y+height,x+width-radius,y+height,points),quadraticBezierCurve(x+radius,y+height,x,y+height,x,y+height-radius,points)):points.push(x,y,x+width,y,x+width,y+height,x,y+height)}},triangulate:function(graphicsData,graphicsGeometry){if(Graphics.nextRoundedRectBehavior)buildCircle.triangulate(graphicsData,graphicsGeometry);else{for(var points=graphicsData.points,verts=graphicsGeometry.points,indices=graphicsGeometry.indices,vecPos=verts.length/2,triangles=earcut_default()(points,null,2),i=0,j=triangles.length;i<j;i+=3)indices.push(triangles[i]+vecPos),indices.push(triangles[i+1]+vecPos),indices.push(triangles[i+2]+vecPos);for(i=0,j=points.length;i<j;i++)verts.push(points[i],points[++i])}}};function square(x,y,nx,ny,innerWeight,outerWeight,clockwise,verts){var exx,eyy;clockwise?(exx=ny,eyy=-nx):(exx=-ny,eyy=nx);var eix=x-nx*innerWeight+exx,eiy=y-ny*innerWeight+eyy,eox=x+nx*outerWeight+exx,eoy=y+ny*outerWeight+eyy;return verts.push(eix,eiy),verts.push(eox,eoy),2}function round(cx,cy,sx,sy,ex,ey,verts,clockwise){var cx2p0x=sx-cx,cy2p0y=sy-cy,angle0=Math.atan2(cx2p0x,cy2p0y),angle1=Math.atan2(ex-cx,ey-cy);clockwise&&angle0<angle1?angle0+=2*Math.PI:!clockwise&&angle0>angle1&&(angle1+=2*Math.PI);var startAngle=angle0,angleDiff=angle1-angle0,absAngleDiff=Math.abs(angleDiff),radius=Math.sqrt(cx2p0x*cx2p0x+cy2p0y*cy2p0y),segCount=1+(15*absAngleDiff*Math.sqrt(radius)/Math.PI>>0),angleInc=angleDiff/segCount;if(startAngle+=angleInc,clockwise){verts.push(cx,cy),verts.push(sx,sy);for(var i=1,angle=startAngle;i<segCount;i++,angle+=angleInc)verts.push(cx,cy),verts.push(cx+Math.sin(angle)*radius,cy+Math.cos(angle)*radius);verts.push(cx,cy),verts.push(ex,ey)}else{verts.push(sx,sy),verts.push(cx,cy);for(i=1,angle=startAngle;i<segCount;i++,angle+=angleInc)verts.push(cx+Math.sin(angle)*radius,cy+Math.cos(angle)*radius),verts.push(cx,cy);verts.push(ex,ey),verts.push(cx,cy)}return 2*segCount}function buildLine(graphicsData,graphicsGeometry){graphicsData.lineStyle.native?function(graphicsData,graphicsGeometry){var i=0,shape=graphicsData.shape,points=graphicsData.points||shape.points,closedShape=shape.type!==SHAPES.POLY||shape.closeStroke;if(0!==points.length){var verts=graphicsGeometry.points,indices=graphicsGeometry.indices,length=points.length/2,startIndex=verts.length/2,currentIndex=startIndex;for(verts.push(points[0],points[1]),i=1;i<length;i++)verts.push(points[2*i],points[2*i+1]),indices.push(currentIndex,currentIndex+1),currentIndex++;closedShape&&indices.push(currentIndex,startIndex)}}(graphicsData,graphicsGeometry):function(graphicsData,graphicsGeometry){var shape=graphicsData.shape,points=graphicsData.points||shape.points.slice(),eps=graphicsGeometry.closePointEps;if(0!==points.length){var style=graphicsData.lineStyle,firstPoint=new Point(points[0],points[1]),lastPoint=new Point(points[points.length-2],points[points.length-1]),closedShape=shape.type!==SHAPES.POLY||shape.closeStroke,closedPath=Math.abs(firstPoint.x-lastPoint.x)<eps&&Math.abs(firstPoint.y-lastPoint.y)<eps;if(closedShape){points=points.slice(),closedPath&&(points.pop(),points.pop(),lastPoint.set(points[points.length-2],points[points.length-1]));var midPointX=.5*(firstPoint.x+lastPoint.x),midPointY=.5*(lastPoint.y+firstPoint.y);points.unshift(midPointX,midPointY),points.push(midPointX,midPointY)}var verts=graphicsGeometry.points,length=points.length/2,indexCount=points.length,indexStart=verts.length/2,width=style.width/2,widthSquared=width*width,miterLimitSquared=style.miterLimit*style.miterLimit,x0=points[0],y0=points[1],x1=points[2],y1=points[3],x2=0,y2=0,perpx=-(y0-y1),perpy=x0-x1,perp1x=0,perp1y=0,dist=Math.sqrt(perpx*perpx+perpy*perpy);perpx/=dist,perpy/=dist,perpx*=width,perpy*=width;var ratio=style.alignment,innerWeight=2*(1-ratio),outerWeight=2*ratio;closedShape||(style.cap===LINE_CAP.ROUND?indexCount+=round(x0-perpx*(innerWeight-outerWeight)*.5,y0-perpy*(innerWeight-outerWeight)*.5,x0-perpx*innerWeight,y0-perpy*innerWeight,x0+perpx*outerWeight,y0+perpy*outerWeight,verts,!0)+2:style.cap===LINE_CAP.SQUARE&&(indexCount+=square(x0,y0,perpx,perpy,innerWeight,outerWeight,!0,verts))),verts.push(x0-perpx*innerWeight,y0-perpy*innerWeight),verts.push(x0+perpx*outerWeight,y0+perpy*outerWeight);for(var i=1;i<length-1;++i){x0=points[2*(i-1)],y0=points[2*(i-1)+1],x1=points[2*i],y1=points[2*i+1],x2=points[2*(i+1)],y2=points[2*(i+1)+1],perpx=-(y0-y1),perpy=x0-x1,perpx/=dist=Math.sqrt(perpx*perpx+perpy*perpy),perpy/=dist,perpx*=width,perpy*=width,perp1x=-(y1-y2),perp1y=x1-x2,perp1x/=dist=Math.sqrt(perp1x*perp1x+perp1y*perp1y),perp1y/=dist,perp1x*=width,perp1y*=width;var dx0=x1-x0,dy0=y0-y1,dx1=x1-x2,dy1=y2-y1,cross=dy0*dx1-dy1*dx0,clockwise=cross<0;if(Math.abs(cross)<.1)verts.push(x1-perpx*innerWeight,y1-perpy*innerWeight),verts.push(x1+perpx*outerWeight,y1+perpy*outerWeight);else{var c1=(-perpx+x0)*(-perpy+y1)-(-perpx+x1)*(-perpy+y0),c2=(-perp1x+x2)*(-perp1y+y1)-(-perp1x+x1)*(-perp1y+y2),px=(dx0*c2-dx1*c1)/cross,py=(dy1*c1-dy0*c2)/cross,pdist=(px-x1)*(px-x1)+(py-y1)*(py-y1),imx=x1+(px-x1)*innerWeight,imy=y1+(py-y1)*innerWeight,omx=x1-(px-x1)*outerWeight,omy=y1-(py-y1)*outerWeight,insideWeight=clockwise?innerWeight:outerWeight;pdist<=Math.min(dx0*dx0+dy0*dy0,dx1*dx1+dy1*dy1)+insideWeight*insideWeight*widthSquared?style.join===LINE_JOIN.BEVEL||pdist/widthSquared>miterLimitSquared?(clockwise?(verts.push(imx,imy),verts.push(x1+perpx*outerWeight,y1+perpy*outerWeight),verts.push(imx,imy),verts.push(x1+perp1x*outerWeight,y1+perp1y*outerWeight)):(verts.push(x1-perpx*innerWeight,y1-perpy*innerWeight),verts.push(omx,omy),verts.push(x1-perp1x*innerWeight,y1-perp1y*innerWeight),verts.push(omx,omy)),indexCount+=2):style.join===LINE_JOIN.ROUND?clockwise?(verts.push(imx,imy),verts.push(x1+perpx*outerWeight,y1+perpy*outerWeight),indexCount+=round(x1,y1,x1+perpx*outerWeight,y1+perpy*outerWeight,x1+perp1x*outerWeight,y1+perp1y*outerWeight,verts,!0)+4,verts.push(imx,imy),verts.push(x1+perp1x*outerWeight,y1+perp1y*outerWeight)):(verts.push(x1-perpx*innerWeight,y1-perpy*innerWeight),verts.push(omx,omy),indexCount+=round(x1,y1,x1-perpx*innerWeight,y1-perpy*innerWeight,x1-perp1x*innerWeight,y1-perp1y*innerWeight,verts,!1)+4,verts.push(x1-perp1x*innerWeight,y1-perp1y*innerWeight),verts.push(omx,omy)):(verts.push(imx,imy),verts.push(omx,omy)):(verts.push(x1-perpx*innerWeight,y1-perpy*innerWeight),verts.push(x1+perpx*outerWeight,y1+perpy*outerWeight),style.join===LINE_JOIN.BEVEL||pdist/widthSquared>miterLimitSquared||(style.join===LINE_JOIN.ROUND?indexCount+=clockwise?round(x1,y1,x1+perpx*outerWeight,y1+perpy*outerWeight,x1+perp1x*outerWeight,y1+perp1y*outerWeight,verts,!0)+2:round(x1,y1,x1-perpx*innerWeight,y1-perpy*innerWeight,x1-perp1x*innerWeight,y1-perp1y*innerWeight,verts,!1)+2:(clockwise?(verts.push(omx,omy),verts.push(omx,omy)):(verts.push(imx,imy),verts.push(imx,imy)),indexCount+=2)),verts.push(x1-perp1x*innerWeight,y1-perp1y*innerWeight),verts.push(x1+perp1x*outerWeight,y1+perp1y*outerWeight),indexCount+=2)}}x0=points[2*(length-2)],y0=points[2*(length-2)+1],x1=points[2*(length-1)],perpx=-(y0-(y1=points[2*(length-1)+1])),perpy=x0-x1,perpx/=dist=Math.sqrt(perpx*perpx+perpy*perpy),perpy/=dist,perpx*=width,perpy*=width,verts.push(x1-perpx*innerWeight,y1-perpy*innerWeight),verts.push(x1+perpx*outerWeight,y1+perpy*outerWeight),closedShape||(style.cap===LINE_CAP.ROUND?indexCount+=round(x1-perpx*(innerWeight-outerWeight)*.5,y1-perpy*(innerWeight-outerWeight)*.5,x1-perpx*innerWeight,y1-perpy*innerWeight,x1+perpx*outerWeight,y1+perpy*outerWeight,verts,!1)+2:style.cap===LINE_CAP.SQUARE&&(indexCount+=square(x1,y1,perpx,perpy,innerWeight,outerWeight,!1,verts)));var indices=graphicsGeometry.indices,eps2=GRAPHICS_CURVES.epsilon*GRAPHICS_CURVES.epsilon;for(i=indexStart;i<indexCount+indexStart-2;++i)x0=verts[2*i],y0=verts[2*i+1],x1=verts[2*(i+1)],y1=verts[2*(i+1)+1],x2=verts[2*(i+2)],y2=verts[2*(i+2)+1],Math.abs(x0*(y1-y2)+x1*(y2-y0)+x2*(y0-y1))<eps2||indices.push(i,i+1,i+2)}}(graphicsData,graphicsGeometry)}var graphics_a,ArcUtils=function(){function ArcUtils(){}return ArcUtils.curveTo=function(x1,y1,x2,y2,radius,points){var fromX=points[points.length-2],a1=points[points.length-1]-y1,b1=fromX-x1,a2=y2-y1,b2=x2-x1,mm=Math.abs(a1*b2-b1*a2);if(mm<1e-8||0===radius)return points[points.length-2]===x1&&points[points.length-1]===y1||points.push(x1,y1),null;var dd=a1*a1+b1*b1,cc=a2*a2+b2*b2,tt=a1*a2+b1*b2,k1=radius*Math.sqrt(dd)/mm,k2=radius*Math.sqrt(cc)/mm,j1=k1*tt/dd,j2=k2*tt/cc,cx=k1*b2+k2*b1,cy=k1*a2+k2*a1,px=b1*(k2+j1),py=a1*(k2+j1),qx=b2*(k1+j2),qy=a2*(k1+j2);return{cx:cx+x1,cy:cy+y1,radius,startAngle:Math.atan2(py-cy,px-cx),endAngle:Math.atan2(qy-cy,qx-cx),anticlockwise:b1*a2>b2*a1}},ArcUtils.arc=function(_startX,_startY,cx,cy,radius,startAngle,endAngle,_anticlockwise,points){for(var sweep=endAngle-startAngle,n=GRAPHICS_CURVES._segmentsCount(Math.abs(sweep)*radius,40*Math.ceil(Math.abs(sweep)/PI_2)),theta=sweep/(2*n),theta2=2*theta,cTheta=Math.cos(theta),sTheta=Math.sin(theta),segMinus=n-1,remainder=segMinus%1/segMinus,i=0;i<=segMinus;++i){var angle=theta+startAngle+theta2*(i+remainder*i),c=Math.cos(angle),s=-Math.sin(angle);points.push((cTheta*c+sTheta*s)*radius+cx,(cTheta*-s+sTheta*c)*radius+cy)}},ArcUtils}(),BezierUtils=function(){function BezierUtils(){}return BezierUtils.curveLength=function(fromX,fromY,cpX,cpY,cpX2,cpY2,toX,toY){for(var result=0,t=0,t2=0,t3=0,nt=0,nt2=0,nt3=0,x=0,y=0,dx=0,dy=0,prevX=fromX,prevY=fromY,i=1;i<=10;++i)dx=prevX-(x=(nt3=(nt2=(nt=1-(t=i/10))*nt)*nt)*fromX+3*nt2*t*cpX+3*nt*(t2=t*t)*cpX2+(t3=t2*t)*toX),dy=prevY-(y=nt3*fromY+3*nt2*t*cpY+3*nt*t2*cpY2+t3*toY),prevX=x,prevY=y,result+=Math.sqrt(dx*dx+dy*dy);return result},BezierUtils.curveTo=function(cpX,cpY,cpX2,cpY2,toX,toY,points){var fromX=points[points.length-2],fromY=points[points.length-1];points.length-=2;var n=GRAPHICS_CURVES._segmentsCount(BezierUtils.curveLength(fromX,fromY,cpX,cpY,cpX2,cpY2,toX,toY)),dt=0,dt2=0,dt3=0,t2=0,t3=0;points.push(fromX,fromY);for(var i=1,j=0;i<=n;++i)dt3=(dt2=(dt=1-(j=i/n))*dt)*dt,t3=(t2=j*j)*j,points.push(dt3*fromX+3*dt2*j*cpX+3*dt*t2*cpX2+t3*toX,dt3*fromY+3*dt2*j*cpY+3*dt*t2*cpY2+t3*toY)},BezierUtils}(),QuadraticUtils=function(){function QuadraticUtils(){}return QuadraticUtils.curveLength=function(fromX,fromY,cpX,cpY,toX,toY){var ax=fromX-2*cpX+toX,ay=fromY-2*cpY+toY,bx=2*cpX-2*fromX,by=2*cpY-2*fromY,a=4*(ax*ax+ay*ay),b=4*(ax*bx+ay*by),c=bx*bx+by*by,s=2*Math.sqrt(a+b+c),a2=Math.sqrt(a),a32=2*a*a2,c2=2*Math.sqrt(c),ba=b/a2;return(a32*s+a2*b*(s-c2)+(4*c*a-b*b)*Math.log((2*a2+ba+s)/(ba+c2)))/(4*a32)},QuadraticUtils.curveTo=function(cpX,cpY,toX,toY,points){for(var fromX=points[points.length-2],fromY=points[points.length-1],n=GRAPHICS_CURVES._segmentsCount(QuadraticUtils.curveLength(fromX,fromY,cpX,cpY,toX,toY)),xa=0,ya=0,i=1;i<=n;++i){var j=i/n;xa=fromX+(cpX-fromX)*j,ya=fromY+(cpY-fromY)*j,points.push(xa+(cpX+(toX-cpX)*j-xa)*j,ya+(cpY+(toY-cpY)*j-ya)*j)}},QuadraticUtils}(),BatchPart=function(){function BatchPart(){this.reset()}return BatchPart.prototype.begin=function(style,startIndex,attribStart){this.reset(),this.style=style,this.start=startIndex,this.attribStart=attribStart},BatchPart.prototype.end=function(endIndex,endAttrib){this.attribSize=endAttrib-this.attribStart,this.size=endIndex-this.start},BatchPart.prototype.reset=function(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0},BatchPart}(),FILL_COMMANDS=((graphics_a={})[SHAPES.POLY]=buildPoly,graphics_a[SHAPES.CIRC]=buildCircle,graphics_a[SHAPES.ELIP]=buildCircle,graphics_a[SHAPES.RECT]=buildRectangle,graphics_a[SHAPES.RREC]=buildRoundedRectangle,graphics_a),BATCH_POOL=[],DRAW_CALL_POOL=[],GraphicsData=function(){function GraphicsData(shape,fillStyle,lineStyle,matrix){void 0===fillStyle&&(fillStyle=null),void 0===lineStyle&&(lineStyle=null),void 0===matrix&&(matrix=null),this.points=[],this.holes=[],this.shape=shape,this.lineStyle=lineStyle,this.fillStyle=fillStyle,this.matrix=matrix,this.type=shape.type}return GraphicsData.prototype.clone=function(){return new GraphicsData(this.shape,this.fillStyle,this.lineStyle,this.matrix)},GraphicsData.prototype.destroy=function(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null},GraphicsData}(),tmpPoint=new Point,tmpBounds=new Bounds,GraphicsGeometry=function(_super){function GraphicsGeometry(){var _this=_super.call(this)||this;return _this.closePointEps=1e-4,_this.boundsPadding=0,_this.uvsFloat32=null,_this.indicesUint16=null,_this.batchable=!1,_this.points=[],_this.colors=[],_this.uvs=[],_this.indices=[],_this.textureIds=[],_this.graphicsData=[],_this.drawCalls=[],_this.batchDirty=-1,_this.batches=[],_this.dirty=0,_this.cacheDirty=-1,_this.clearDirty=0,_this.shapeIndex=0,_this._bounds=new Bounds,_this.boundsDirty=-1,_this}return graphics_extends(GraphicsGeometry,_super),Object.defineProperty(GraphicsGeometry.prototype,"bounds",{get:function(){return this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds},enumerable:!1,configurable:!0}),GraphicsGeometry.prototype.invalidate=function(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(var i=0;i<this.drawCalls.length;i++)this.drawCalls[i].texArray.clear(),DRAW_CALL_POOL.push(this.drawCalls[i]);this.drawCalls.length=0;for(i=0;i<this.batches.length;i++){var batchPart=this.batches[i];batchPart.reset(),BATCH_POOL.push(batchPart)}this.batches.length=0},GraphicsGeometry.prototype.clear=function(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this},GraphicsGeometry.prototype.drawShape=function(shape,fillStyle,lineStyle,matrix){void 0===fillStyle&&(fillStyle=null),void 0===lineStyle&&(lineStyle=null),void 0===matrix&&(matrix=null);var data=new GraphicsData(shape,fillStyle,lineStyle,matrix);return this.graphicsData.push(data),this.dirty++,this},GraphicsGeometry.prototype.drawHole=function(shape,matrix){if(void 0===matrix&&(matrix=null),!this.graphicsData.length)return null;var data=new GraphicsData(shape,null,null,matrix),lastShape=this.graphicsData[this.graphicsData.length-1];return data.lineStyle=lastShape.lineStyle,lastShape.holes.push(data),this.dirty++,this},GraphicsGeometry.prototype.destroy=function(){_super.prototype.destroy.call(this);for(var i=0;i<this.graphicsData.length;++i)this.graphicsData[i].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null},GraphicsGeometry.prototype.containsPoint=function(point){for(var graphicsData=this.graphicsData,i=0;i<graphicsData.length;++i){var data=graphicsData[i];if(data.fillStyle.visible&&(data.shape&&(data.matrix?data.matrix.applyInverse(point,tmpPoint):tmpPoint.copyFrom(point),data.shape.contains(tmpPoint.x,tmpPoint.y)))){var hitHole=!1;if(data.holes)for(var i_1=0;i_1<data.holes.length;i_1++){if(data.holes[i_1].shape.contains(tmpPoint.x,tmpPoint.y)){hitHole=!0;break}}if(!hitHole)return!0}}return!1},GraphicsGeometry.prototype.updateBatches=function(allow32Indices){if(this.graphicsData.length){if(this.validateBatching()){this.cacheDirty=this.dirty;var uvs=this.uvs,graphicsData=this.graphicsData,batchPart=null,currentStyle=null;this.batches.length>0&&(currentStyle=(batchPart=this.batches[this.batches.length-1]).style);for(var i=this.shapeIndex;i<graphicsData.length;i++){this.shapeIndex++;var data=graphicsData[i],fillStyle=data.fillStyle,lineStyle=data.lineStyle;FILL_COMMANDS[data.type].build(data),data.matrix&&this.transformPoints(data.points,data.matrix),(fillStyle.visible||lineStyle.visible)&&this.processHoles(data.holes);for(var j=0;j<2;j++){var style=0===j?fillStyle:lineStyle;if(style.visible){var nextTexture=style.texture.baseTexture,index_1=this.indices.length,attribIndex=this.points.length/2;nextTexture.wrapMode=constants_WRAP_MODES.REPEAT,0===j?this.processFill(data):this.processLine(data);var size=this.points.length/2-attribIndex;0!==size&&(batchPart&&!this._compareStyles(currentStyle,style)&&(batchPart.end(index_1,attribIndex),batchPart=null),batchPart||((batchPart=BATCH_POOL.pop()||new BatchPart).begin(style,index_1,attribIndex),this.batches.push(batchPart),currentStyle=style),this.addUvs(this.points,uvs,style.texture,attribIndex,size,style.matrix))}}}var index=this.indices.length,attrib=this.points.length/2;if(batchPart&&batchPart.end(index,attrib),0!==this.batches.length){if(this.indicesUint16&&this.indices.length===this.indicesUint16.length)this.indicesUint16.set(this.indices);else{var need32=attrib>65535&&allow32Indices;this.indicesUint16=need32?new Uint32Array(this.indices):new Uint16Array(this.indices)}this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}else this.batchable=!0}}else this.batchable=!0},GraphicsGeometry.prototype._compareStyles=function(styleA,styleB){return!(!styleA||!styleB)&&(styleA.texture.baseTexture===styleB.texture.baseTexture&&(styleA.color+styleA.alpha===styleB.color+styleB.alpha&&!!styleA.native==!!styleB.native))},GraphicsGeometry.prototype.validateBatching=function(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(var i=0,l=this.graphicsData.length;i<l;i++){var data=this.graphicsData[i],fill=data.fillStyle,line=data.lineStyle;if(fill&&!fill.texture.baseTexture.valid)return!1;if(line&&!line.texture.baseTexture.valid)return!1}return!0},GraphicsGeometry.prototype.packBatches=function(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);for(var batches=this.batches,i=0,l=batches.length;i<l;i++)for(var batch=batches[i],j=0;j<batch.size;j++){var index=batch.start+j;this.indicesUint16[index]=this.indicesUint16[index]-batch.attribStart}},GraphicsGeometry.prototype.isBatchable=function(){if(this.points.length>131070)return!1;for(var batches=this.batches,i=0;i<batches.length;i++)if(batches[i].style.native)return!1;return this.points.length<2*GraphicsGeometry.BATCHABLE_SIZE},GraphicsGeometry.prototype.buildDrawCalls=function(){for(var TICK=++BaseTexture._globalBatch,i=0;i<this.drawCalls.length;i++)this.drawCalls[i].texArray.clear(),DRAW_CALL_POOL.push(this.drawCalls[i]);this.drawCalls.length=0;var colors=this.colors,textureIds=this.textureIds,currentGroup=DRAW_CALL_POOL.pop();currentGroup||((currentGroup=new BatchDrawCall).texArray=new BatchTextureArray),currentGroup.texArray.count=0,currentGroup.start=0,currentGroup.size=0,currentGroup.type=constants_DRAW_MODES.TRIANGLES;var textureCount=0,currentTexture=null,textureId=0,native=!1,drawMode=constants_DRAW_MODES.TRIANGLES,index=0;this.drawCalls.push(currentGroup);for(i=0;i<this.batches.length;i++){var data=this.batches[i],style=data.style,nextTexture=style.texture.baseTexture;native!==!!style.native&&(drawMode=(native=!!style.native)?constants_DRAW_MODES.LINES:constants_DRAW_MODES.TRIANGLES,currentTexture=null,textureCount=8,TICK++),currentTexture!==nextTexture&&(currentTexture=nextTexture,nextTexture._batchEnabled!==TICK&&(8===textureCount&&(TICK++,textureCount=0,currentGroup.size>0&&((currentGroup=DRAW_CALL_POOL.pop())||((currentGroup=new BatchDrawCall).texArray=new BatchTextureArray),this.drawCalls.push(currentGroup)),currentGroup.start=index,currentGroup.size=0,currentGroup.texArray.count=0,currentGroup.type=drawMode),nextTexture.touched=1,nextTexture._batchEnabled=TICK,nextTexture._batchLocation=textureCount,nextTexture.wrapMode=constants_WRAP_MODES.REPEAT,currentGroup.texArray.elements[currentGroup.texArray.count++]=nextTexture,textureCount++)),currentGroup.size+=data.size,index+=data.size,textureId=nextTexture._batchLocation,this.addColors(colors,style.color,style.alpha,data.attribSize,data.attribStart),this.addTextureIds(textureIds,textureId,data.attribSize,data.attribStart)}BaseTexture._globalBatch=TICK,this.packAttributes()},GraphicsGeometry.prototype.packAttributes=function(){for(var verts=this.points,uvs=this.uvs,colors=this.colors,textureIds=this.textureIds,glPoints=new ArrayBuffer(3*verts.length*4),f32=new Float32Array(glPoints),u32=new Uint32Array(glPoints),p=0,i=0;i<verts.length/2;i++)f32[p++]=verts[2*i],f32[p++]=verts[2*i+1],f32[p++]=uvs[2*i],f32[p++]=uvs[2*i+1],u32[p++]=colors[i],f32[p++]=textureIds[i];this._buffer.update(glPoints),this._indexBuffer.update(this.indicesUint16)},GraphicsGeometry.prototype.processFill=function(data){data.holes.length?buildPoly.triangulate(data,this):FILL_COMMANDS[data.type].triangulate(data,this)},GraphicsGeometry.prototype.processLine=function(data){buildLine(data,this);for(var i=0;i<data.holes.length;i++)buildLine(data.holes[i],this)},GraphicsGeometry.prototype.processHoles=function(holes){for(var i=0;i<holes.length;i++){var hole=holes[i];FILL_COMMANDS[hole.type].build(hole),hole.matrix&&this.transformPoints(hole.points,hole.matrix)}},GraphicsGeometry.prototype.calculateBounds=function(){var bounds=this._bounds,sequenceBounds=tmpBounds,curMatrix=Matrix.IDENTITY;this._bounds.clear(),sequenceBounds.clear();for(var i=0;i<this.graphicsData.length;i++){var data=this.graphicsData[i],shape=data.shape,type=data.type,lineStyle=data.lineStyle,nextMatrix=data.matrix||Matrix.IDENTITY,lineWidth=0;if(lineStyle&&lineStyle.visible&&(lineWidth=lineStyle.width*Math.max(0,lineStyle.alignment)),curMatrix!==nextMatrix&&(sequenceBounds.isEmpty()||(bounds.addBoundsMatrix(sequenceBounds,curMatrix),sequenceBounds.clear()),curMatrix=nextMatrix),type===SHAPES.RECT||type===SHAPES.RREC){var rect=shape;sequenceBounds.addFramePad(rect.x,rect.y,rect.x+rect.width,rect.y+rect.height,lineWidth,lineWidth)}else if(type===SHAPES.CIRC){var circle=shape;sequenceBounds.addFramePad(circle.x,circle.y,circle.x,circle.y,circle.radius+lineWidth,circle.radius+lineWidth)}else if(type===SHAPES.ELIP){var ellipse=shape;sequenceBounds.addFramePad(ellipse.x,ellipse.y,ellipse.x,ellipse.y,ellipse.width+lineWidth,ellipse.height+lineWidth)}else{var poly=shape;bounds.addVerticesMatrix(curMatrix,poly.points,0,poly.points.length,lineWidth,lineWidth)}}sequenceBounds.isEmpty()||bounds.addBoundsMatrix(sequenceBounds,curMatrix),bounds.pad(this.boundsPadding,this.boundsPadding)},GraphicsGeometry.prototype.transformPoints=function(points,matrix){for(var i=0;i<points.length/2;i++){var x=points[2*i],y=points[2*i+1];points[2*i]=matrix.a*x+matrix.c*y+matrix.tx,points[2*i+1]=matrix.b*x+matrix.d*y+matrix.ty}},GraphicsGeometry.prototype.addColors=function(colors,color,alpha,size,offset){void 0===offset&&(offset=0);var rgba=premultiplyTint((color>>16)+(65280&color)+((255&color)<<16),alpha);colors.length=Math.max(colors.length,offset+size);for(var i=0;i<size;i++)colors[offset+i]=rgba},GraphicsGeometry.prototype.addTextureIds=function(textureIds,id,size,offset){void 0===offset&&(offset=0),textureIds.length=Math.max(textureIds.length,offset+size);for(var i=0;i<size;i++)textureIds[offset+i]=id},GraphicsGeometry.prototype.addUvs=function(verts,uvs,texture,start,size,matrix){void 0===matrix&&(matrix=null);for(var index=0,uvsStart=uvs.length,frame=texture.frame;index<size;){var x=verts[2*(start+index)],y=verts[2*(start+index)+1];if(matrix){var nx=matrix.a*x+matrix.c*y+matrix.tx;y=matrix.b*x+matrix.d*y+matrix.ty,x=nx}index++,uvs.push(x/frame.width,y/frame.height)}var baseTexture=texture.baseTexture;(frame.width<baseTexture.width||frame.height<baseTexture.height)&&this.adjustUvs(uvs,texture,uvsStart,size)},GraphicsGeometry.prototype.adjustUvs=function(uvs,texture,start,size){for(var baseTexture=texture.baseTexture,eps=1e-6,finish=start+2*size,frame=texture.frame,scaleX=frame.width/baseTexture.width,scaleY=frame.height/baseTexture.height,offsetX=frame.x/frame.width,offsetY=frame.y/frame.height,minX=Math.floor(uvs[start]+eps),minY=Math.floor(uvs[start+1]+eps),i=start+2;i<finish;i+=2)minX=Math.min(minX,Math.floor(uvs[i]+eps)),minY=Math.min(minY,Math.floor(uvs[i+1]+eps));offsetX-=minX,offsetY-=minY;for(i=start;i<finish;i+=2)uvs[i]=(uvs[i]+offsetX)*scaleX,uvs[i+1]=(uvs[i+1]+offsetY)*scaleY},GraphicsGeometry.BATCHABLE_SIZE=100,GraphicsGeometry}(BatchGeometry),LineStyle=function(_super){function LineStyle(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.width=0,_this.alignment=.5,_this.native=!1,_this.cap=LINE_CAP.BUTT,_this.join=LINE_JOIN.MITER,_this.miterLimit=10,_this}return graphics_extends(LineStyle,_super),LineStyle.prototype.clone=function(){var obj=new LineStyle;return obj.color=this.color,obj.alpha=this.alpha,obj.texture=this.texture,obj.matrix=this.matrix,obj.visible=this.visible,obj.width=this.width,obj.alignment=this.alignment,obj.native=this.native,obj.cap=this.cap,obj.join=this.join,obj.miterLimit=this.miterLimit,obj},LineStyle.prototype.reset=function(){_super.prototype.reset.call(this),this.color=0,this.alignment=.5,this.width=0,this.native=!1},LineStyle}(FillStyle),temp=new Float32Array(3),DEFAULT_SHADERS={},Graphics=function(_super){function Graphics(geometry){void 0===geometry&&(geometry=null);var _this=_super.call(this)||this;return _this.shader=null,_this.pluginName="batch",_this.currentPath=null,_this.batches=[],_this.batchTint=-1,_this.batchDirty=-1,_this.vertexData=null,_this._fillStyle=new FillStyle,_this._lineStyle=new LineStyle,_this._matrix=null,_this._holeMode=!1,_this.state=State.for2d(),_this._geometry=geometry||new GraphicsGeometry,_this._geometry.refCount++,_this._transformID=-1,_this.tint=16777215,_this.blendMode=constants_BLEND_MODES.NORMAL,_this}return graphics_extends(Graphics,_super),Object.defineProperty(Graphics.prototype,"geometry",{get:function(){return this._geometry},enumerable:!1,configurable:!0}),Graphics.prototype.clone=function(){return this.finishPoly(),new Graphics(this._geometry)},Object.defineProperty(Graphics.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(value){this.state.blendMode=value},enumerable:!1,configurable:!0}),Object.defineProperty(Graphics.prototype,"tint",{get:function(){return this._tint},set:function(value){this._tint=value},enumerable:!1,configurable:!0}),Object.defineProperty(Graphics.prototype,"fill",{get:function(){return this._fillStyle},enumerable:!1,configurable:!0}),Object.defineProperty(Graphics.prototype,"line",{get:function(){return this._lineStyle},enumerable:!1,configurable:!0}),Graphics.prototype.lineStyle=function(options,color,alpha,alignment,native){return void 0===options&&(options=null),void 0===color&&(color=0),void 0===alpha&&(alpha=1),void 0===alignment&&(alignment=.5),void 0===native&&(native=!1),"number"==typeof options&&(options={width:options,color,alpha,alignment,native}),this.lineTextureStyle(options)},Graphics.prototype.lineTextureStyle=function(options){options=Object.assign({width:0,texture:Texture.WHITE,color:options&&options.texture?16777215:0,alpha:1,matrix:null,alignment:.5,native:!1,cap:LINE_CAP.BUTT,join:LINE_JOIN.MITER,miterLimit:10},options),this.currentPath&&this.startPoly();var visible=options.width>0&&options.alpha>0;return visible?(options.matrix&&(options.matrix=options.matrix.clone(),options.matrix.invert()),Object.assign(this._lineStyle,{visible},options)):this._lineStyle.reset(),this},Graphics.prototype.startPoly=function(){if(this.currentPath){var points=this.currentPath.points,len=this.currentPath.points.length;len>2&&(this.drawShape(this.currentPath),this.currentPath=new Polygon,this.currentPath.closeStroke=!1,this.currentPath.points.push(points[len-2],points[len-1]))}else this.currentPath=new Polygon,this.currentPath.closeStroke=!1},Graphics.prototype.finishPoly=function(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)},Graphics.prototype.moveTo=function(x,y){return this.startPoly(),this.currentPath.points[0]=x,this.currentPath.points[1]=y,this},Graphics.prototype.lineTo=function(x,y){this.currentPath||this.moveTo(0,0);var points=this.currentPath.points,fromX=points[points.length-2],fromY=points[points.length-1];return fromX===x&&fromY===y||points.push(x,y),this},Graphics.prototype._initCurve=function(x,y){void 0===x&&(x=0),void 0===y&&(y=0),this.currentPath?0===this.currentPath.points.length&&(this.currentPath.points=[x,y]):this.moveTo(x,y)},Graphics.prototype.quadraticCurveTo=function(cpX,cpY,toX,toY){this._initCurve();var points=this.currentPath.points;return 0===points.length&&this.moveTo(0,0),QuadraticUtils.curveTo(cpX,cpY,toX,toY,points),this},Graphics.prototype.bezierCurveTo=function(cpX,cpY,cpX2,cpY2,toX,toY){return this._initCurve(),BezierUtils.curveTo(cpX,cpY,cpX2,cpY2,toX,toY,this.currentPath.points),this},Graphics.prototype.arcTo=function(x1,y1,x2,y2,radius){this._initCurve(x1,y1);var points=this.currentPath.points,result=ArcUtils.curveTo(x1,y1,x2,y2,radius,points);if(result){var cx=result.cx,cy=result.cy,radius_1=result.radius,startAngle=result.startAngle,endAngle=result.endAngle,anticlockwise=result.anticlockwise;this.arc(cx,cy,radius_1,startAngle,endAngle,anticlockwise)}return this},Graphics.prototype.arc=function(cx,cy,radius,startAngle,endAngle,anticlockwise){if(void 0===anticlockwise&&(anticlockwise=!1),startAngle===endAngle)return this;if(!anticlockwise&&endAngle<=startAngle?endAngle+=PI_2:anticlockwise&&startAngle<=endAngle&&(startAngle+=PI_2),0===endAngle-startAngle)return this;var startX=cx+Math.cos(startAngle)*radius,startY=cy+Math.sin(startAngle)*radius,eps=this._geometry.closePointEps,points=this.currentPath?this.currentPath.points:null;if(points){var xDiff=Math.abs(points[points.length-2]-startX),yDiff=Math.abs(points[points.length-1]-startY);xDiff<eps&&yDiff<eps||points.push(startX,startY)}else this.moveTo(startX,startY),points=this.currentPath.points;return ArcUtils.arc(startX,startY,cx,cy,radius,startAngle,endAngle,anticlockwise,points),this},Graphics.prototype.beginFill=function(color,alpha){return void 0===color&&(color=0),void 0===alpha&&(alpha=1),this.beginTextureFill({texture:Texture.WHITE,color,alpha})},Graphics.prototype.beginTextureFill=function(options){options=Object.assign({texture:Texture.WHITE,color:16777215,alpha:1,matrix:null},options),this.currentPath&&this.startPoly();var visible=options.alpha>0;return visible?(options.matrix&&(options.matrix=options.matrix.clone(),options.matrix.invert()),Object.assign(this._fillStyle,{visible},options)):this._fillStyle.reset(),this},Graphics.prototype.endFill=function(){return this.finishPoly(),this._fillStyle.reset(),this},Graphics.prototype.drawRect=function(x,y,width,height){return this.drawShape(new Rectangle(x,y,width,height))},Graphics.prototype.drawRoundedRect=function(x,y,width,height,radius){return this.drawShape(new RoundedRectangle(x,y,width,height,radius))},Graphics.prototype.drawCircle=function(x,y,radius){return this.drawShape(new Circle(x,y,radius))},Graphics.prototype.drawEllipse=function(x,y,width,height){return this.drawShape(new Ellipse(x,y,width,height))},Graphics.prototype.drawPolygon=function(){for(var points,arguments$1=arguments,path=[],_i=0;_i<arguments.length;_i++)path[_i]=arguments$1[_i];var closeStroke=!0,poly=path[0];poly.points?(closeStroke=poly.closeStroke,points=poly.points):points=Array.isArray(path[0])?path[0]:path;var shape=new Polygon(points);return shape.closeStroke=closeStroke,this.drawShape(shape),this},Graphics.prototype.drawShape=function(shape){return this._holeMode?this._geometry.drawHole(shape,this._matrix):this._geometry.drawShape(shape,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this},Graphics.prototype.clear=function(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this},Graphics.prototype.isFastRect=function(){var data=this._geometry.graphicsData;return!(1!==data.length||data[0].shape.type!==SHAPES.RECT||data[0].matrix||data[0].holes.length||data[0].lineStyle.visible&&data[0].lineStyle.width)},Graphics.prototype._render=function(renderer){this.finishPoly();var geometry=this._geometry,hasuint32=renderer.context.supports.uint32Indices;geometry.updateBatches(hasuint32),geometry.batchable?(this.batchDirty!==geometry.batchDirty&&this._populateBatches(),this._renderBatched(renderer)):(renderer.batch.flush(),this._renderDirect(renderer))},Graphics.prototype._populateBatches=function(){var geometry=this._geometry,blendMode=this.blendMode,len=geometry.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=geometry.batchDirty,this.batches.length=len,this.vertexData=new Float32Array(geometry.points);for(var i=0;i<len;i++){var gI=geometry.batches[i],color=gI.style.color,vertexData=new Float32Array(this.vertexData.buffer,4*gI.attribStart*2,2*gI.attribSize),uvs=new Float32Array(geometry.uvsFloat32.buffer,4*gI.attribStart*2,2*gI.attribSize),batch={vertexData,blendMode,indices:new Uint16Array(geometry.indicesUint16.buffer,2*gI.start,gI.size),uvs,_batchRGB:hex2rgb(color),_tintRGB:color,_texture:gI.style.texture,alpha:gI.style.alpha,worldAlpha:1};this.batches[i]=batch}},Graphics.prototype._renderBatched=function(renderer){if(this.batches.length){renderer.batch.setObjectRenderer(renderer.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(var i=0,l=this.batches.length;i<l;i++){var batch=this.batches[i];batch.worldAlpha=this.worldAlpha*batch.alpha,renderer.plugins[this.pluginName].render(batch)}}},Graphics.prototype._renderDirect=function(renderer){var shader=this._resolveDirectShader(renderer),geometry=this._geometry,tint=this.tint,worldAlpha=this.worldAlpha,uniforms=shader.uniforms,drawCalls=geometry.drawCalls;uniforms.translationMatrix=this.transform.worldTransform,uniforms.tint[0]=(tint>>16&255)/255*worldAlpha,uniforms.tint[1]=(tint>>8&255)/255*worldAlpha,uniforms.tint[2]=(255&tint)/255*worldAlpha,uniforms.tint[3]=worldAlpha,renderer.shader.bind(shader),renderer.geometry.bind(geometry,shader),renderer.state.set(this.state);for(var i=0,l=drawCalls.length;i<l;i++)this._renderDrawCallDirect(renderer,geometry.drawCalls[i])},Graphics.prototype._renderDrawCallDirect=function(renderer,drawCall){for(var texArray=drawCall.texArray,type=drawCall.type,size=drawCall.size,start=drawCall.start,groupTextureCount=texArray.count,j=0;j<groupTextureCount;j++)renderer.texture.bind(texArray.elements[j],j);renderer.geometry.draw(type,size,start)},Graphics.prototype._resolveDirectShader=function(renderer){var shader=this.shader,pluginName=this.pluginName;if(!shader){if(!DEFAULT_SHADERS[pluginName]){for(var MAX_TEXTURES=renderer.plugins.batch.MAX_TEXTURES,sampleValues=new Int32Array(MAX_TEXTURES),i=0;i<MAX_TEXTURES;i++)sampleValues[i]=i;var uniforms={tint:new Float32Array([1,1,1,1]),translationMatrix:new Matrix,default:UniformGroup.from({uSamplers:sampleValues},!0)},program=renderer.plugins[pluginName]._shader.program;DEFAULT_SHADERS[pluginName]=new Shader(program,uniforms)}shader=DEFAULT_SHADERS[pluginName]}return shader},Graphics.prototype._calculateBounds=function(){this.finishPoly();var geometry=this._geometry;if(geometry.graphicsData.length){var _a=geometry.bounds,minX=_a.minX,minY=_a.minY,maxX=_a.maxX,maxY=_a.maxY;this._bounds.addFrame(this.transform,minX,minY,maxX,maxY)}},Graphics.prototype.containsPoint=function(point){return this.worldTransform.applyInverse(point,Graphics._TEMP_POINT),this._geometry.containsPoint(Graphics._TEMP_POINT)},Graphics.prototype.calculateTints=function(){if(this.batchTint!==this.tint){this.batchTint=this.tint;for(var tintRGB=hex2rgb(this.tint,temp),i=0;i<this.batches.length;i++){var batch=this.batches[i],batchTint=batch._batchRGB,color=(tintRGB[0]*batchTint[0]*255<<16)+(tintRGB[1]*batchTint[1]*255<<8)+(0|tintRGB[2]*batchTint[2]*255);batch._tintRGB=(color>>16)+(65280&color)+((255&color)<<16)}}},Graphics.prototype.calculateVertices=function(){var wtID=this.transform._worldID;if(this._transformID!==wtID){this._transformID=wtID;for(var wt=this.transform.worldTransform,a=wt.a,b=wt.b,c=wt.c,d=wt.d,tx=wt.tx,ty=wt.ty,data=this._geometry.points,vertexData=this.vertexData,count=0,i=0;i<data.length;i+=2){var x=data[i],y=data[i+1];vertexData[count++]=a*x+c*y+tx,vertexData[count++]=d*y+b*x+ty}}},Graphics.prototype.closePath=function(){var currentPath=this.currentPath;return currentPath&&(currentPath.closeStroke=!0,this.finishPoly()),this},Graphics.prototype.setMatrix=function(matrix){return this._matrix=matrix,this},Graphics.prototype.beginHole=function(){return this.finishPoly(),this._holeMode=!0,this},Graphics.prototype.endHole=function(){return this.finishPoly(),this._holeMode=!1,this},Graphics.prototype.destroy=function(options){this._geometry.refCount--,0===this._geometry.refCount&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,_super.prototype.destroy.call(this,options)},Graphics.nextRoundedRectBehavior=!1,Graphics._TEMP_POINT=new Point,Graphics}(Container),sprite_extendStatics=function(d,b){return sprite_extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])},sprite_extendStatics(d,b)};var TEXT_GRADIENT,tempPoint=new Point,indices=new Uint16Array([0,1,2,0,2,3]),Sprite=function(_super){function Sprite(texture){var _this=_super.call(this)||this;return _this._anchor=new ObservablePoint(_this._onAnchorUpdate,_this,texture?texture.defaultAnchor.x:0,texture?texture.defaultAnchor.y:0),_this._texture=null,_this._width=0,_this._height=0,_this._tint=null,_this._tintRGB=null,_this.tint=16777215,_this.blendMode=constants_BLEND_MODES.NORMAL,_this._cachedTint=16777215,_this.uvs=null,_this.texture=texture||Texture.EMPTY,_this.vertexData=new Float32Array(8),_this.vertexTrimmedData=null,_this._transformID=-1,_this._textureID=-1,_this._transformTrimmedID=-1,_this._textureTrimmedID=-1,_this.indices=indices,_this.pluginName="batch",_this.isSprite=!0,_this._roundPixels=settings.ROUND_PIXELS,_this}return function(d,b){function __(){this.constructor=d}sprite_extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}(Sprite,_super),Sprite.prototype._onTextureUpdate=function(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=sign(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=sign(this.scale.y)*this._height/this._texture.orig.height)},Sprite.prototype._onAnchorUpdate=function(){this._transformID=-1,this._transformTrimmedID=-1},Sprite.prototype.calculateVertices=function(){var texture=this._texture;if(this._transformID!==this.transform._worldID||this._textureID!==texture._updateID){this._textureID!==texture._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=texture._updateID;var wt=this.transform.worldTransform,a=wt.a,b=wt.b,c=wt.c,d=wt.d,tx=wt.tx,ty=wt.ty,vertexData=this.vertexData,trim=texture.trim,orig=texture.orig,anchor=this._anchor,w0=0,w1=0,h0=0,h1=0;if(trim?(w0=(w1=trim.x-anchor._x*orig.width)+trim.width,h0=(h1=trim.y-anchor._y*orig.height)+trim.height):(w0=(w1=-anchor._x*orig.width)+orig.width,h0=(h1=-anchor._y*orig.height)+orig.height),vertexData[0]=a*w1+c*h1+tx,vertexData[1]=d*h1+b*w1+ty,vertexData[2]=a*w0+c*h1+tx,vertexData[3]=d*h1+b*w0+ty,vertexData[4]=a*w0+c*h0+tx,vertexData[5]=d*h0+b*w0+ty,vertexData[6]=a*w1+c*h0+tx,vertexData[7]=d*h0+b*w1+ty,this._roundPixels)for(var resolution=settings.RESOLUTION,i=0;i<vertexData.length;++i)vertexData[i]=Math.round((vertexData[i]*resolution|0)/resolution)}},Sprite.prototype.calculateTrimmedVertices=function(){if(this.vertexTrimmedData){if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return}else this.vertexTrimmedData=new Float32Array(8);this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;var texture=this._texture,vertexData=this.vertexTrimmedData,orig=texture.orig,anchor=this._anchor,wt=this.transform.worldTransform,a=wt.a,b=wt.b,c=wt.c,d=wt.d,tx=wt.tx,ty=wt.ty,w1=-anchor._x*orig.width,w0=w1+orig.width,h1=-anchor._y*orig.height,h0=h1+orig.height;vertexData[0]=a*w1+c*h1+tx,vertexData[1]=d*h1+b*w1+ty,vertexData[2]=a*w0+c*h1+tx,vertexData[3]=d*h1+b*w0+ty,vertexData[4]=a*w0+c*h0+tx,vertexData[5]=d*h0+b*w0+ty,vertexData[6]=a*w1+c*h0+tx,vertexData[7]=d*h0+b*w1+ty},Sprite.prototype._render=function(renderer){this.calculateVertices(),renderer.batch.setObjectRenderer(renderer.plugins[this.pluginName]),renderer.plugins[this.pluginName].render(this)},Sprite.prototype._calculateBounds=function(){var trim=this._texture.trim,orig=this._texture.orig;!trim||trim.width===orig.width&&trim.height===orig.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))},Sprite.prototype.getLocalBounds=function(rect){return 0===this.children.length?(this._localBounds||(this._localBounds=new Bounds),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),rect||(this._localBoundsRect||(this._localBoundsRect=new Rectangle),rect=this._localBoundsRect),this._localBounds.getRectangle(rect)):_super.prototype.getLocalBounds.call(this,rect)},Sprite.prototype.containsPoint=function(point){this.worldTransform.applyInverse(point,tempPoint);var width=this._texture.orig.width,height=this._texture.orig.height,x1=-width*this.anchor.x,y1=0;return tempPoint.x>=x1&&tempPoint.x<x1+width&&(y1=-height*this.anchor.y,tempPoint.y>=y1&&tempPoint.y<y1+height)},Sprite.prototype.destroy=function(options){if(_super.prototype.destroy.call(this,options),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,"boolean"==typeof options?options:options&&options.texture){var destroyBaseTexture="boolean"==typeof options?options:options&&options.baseTexture;this._texture.destroy(!!destroyBaseTexture)}this._texture=null},Sprite.from=function(source,options){return new Sprite(source instanceof Texture?source:Texture.from(source,options))},Object.defineProperty(Sprite.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(value){this._roundPixels!==value&&(this._transformID=-1),this._roundPixels=value},enumerable:!1,configurable:!0}),Object.defineProperty(Sprite.prototype,"width",{get:function(){return Math.abs(this.scale.x)*this._texture.orig.width},set:function(value){var s=sign(this.scale.x)||1;this.scale.x=s*value/this._texture.orig.width,this._width=value},enumerable:!1,configurable:!0}),Object.defineProperty(Sprite.prototype,"height",{get:function(){return Math.abs(this.scale.y)*this._texture.orig.height},set:function(value){var s=sign(this.scale.y)||1;this.scale.y=s*value/this._texture.orig.height,this._height=value},enumerable:!1,configurable:!0}),Object.defineProperty(Sprite.prototype,"anchor",{get:function(){return this._anchor},set:function(value){this._anchor.copyFrom(value)},enumerable:!1,configurable:!0}),Object.defineProperty(Sprite.prototype,"tint",{get:function(){return this._tint},set:function(value){this._tint=value,this._tintRGB=(value>>16)+(65280&value)+((255&value)<<16)},enumerable:!1,configurable:!0}),Object.defineProperty(Sprite.prototype,"texture",{get:function(){return this._texture},set:function(value){this._texture!==value&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=value||Texture.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,value&&(value.baseTexture.valid?this._onTextureUpdate():value.once("update",this._onTextureUpdate,this)))},enumerable:!1,configurable:!0}),Sprite}(Container),text_extendStatics=function(d,b){return text_extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])},text_extendStatics(d,b)};!function(TEXT_GRADIENT){TEXT_GRADIENT[TEXT_GRADIENT.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",TEXT_GRADIENT[TEXT_GRADIENT.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL"}(TEXT_GRADIENT||(TEXT_GRADIENT={}));var defaultStyle={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:TEXT_GRADIENT.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100,leading:0},genericFontFamilies=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],TextStyle=function(){function TextStyle(style){this.styleID=0,this.reset(),deepCopyProperties(this,style,style)}return TextStyle.prototype.clone=function(){var clonedProperties={};return deepCopyProperties(clonedProperties,this,defaultStyle),new TextStyle(clonedProperties)},TextStyle.prototype.reset=function(){deepCopyProperties(this,defaultStyle,defaultStyle)},Object.defineProperty(TextStyle.prototype,"align",{get:function(){return this._align},set:function(align){this._align!==align&&(this._align=align,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(TextStyle.prototype,"breakWords",{get:function(){return this._breakWords},set:function(breakWords){this._breakWords!==breakWords&&(this._breakWords=breakWords,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(TextStyle.prototype,"dropShadow",{get:function(){return this._dropShadow},set:function(dropShadow){this._dropShadow!==dropShadow&&(this._dropShadow=dropShadow,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(TextStyle.prototype,"dropShadowAlpha",{get:function(){return this._dropShadowAlpha},set:function(dropShadowAlpha){this._dropShadowAlpha!==dropShadowAlpha&&(this._dropShadowAlpha=dropShadowAlpha,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(TextStyle.prototype,"dropShadowAngle",{get:function(){return this._dropShadowAngle},set:function(dropShadowAngle){this._dropShadowAngle!==dropShadowAngle&&(this._dropShadowAngle=dropShadowAngle,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(TextStyle.prototype,"dropShadowBlur",{get:function(){return this._dropShadowBlur},set:function(dropShadowBlur){this._dropShadowBlur!==dropShadowBlur&&(this._dropShadowBlur=dropShadowBlur,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(TextStyle.prototype,"dropShadowColor",{get:function(){return this._dropShadowColor},set:function(dropShadowColor){var outputColor=getColor(dropShadowColor);this._dropShadowColor!==outputColor&&(this._dropShadowColor=outputColor,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(TextStyle.prototype,"dropShadowDistance",{get:function(){return this._dropShadowDistance},set:function(dropShadowDistance){this._dropShadowDistance!==dropShadowDistance&&(this._dropShadowDistance=dropShadowDistance,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(TextStyle.prototype,"fill",{get:function(){return this._fill},set:function(fill){var outputColor=getColor(fill);this._fill!==outputColor&&(this._fill=outputColor,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(TextStyle.prototype,"fillGradientType",{get:function(){return this._fillGradientType},set:function(fillGradientType){this._fillGradientType!==fillGradientType&&(this._fillGradientType=fillGradientType,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(TextStyle.prototype,"fillGradientStops",{get:function(){return this._fillGradientStops},set:function(fillGradientStops){(function(array1,array2){if(!Array.isArray(array1)||!Array.isArray(array2))return!1;if(array1.length!==array2.length)return!1;for(var i=0;i<array1.length;++i)if(array1[i]!==array2[i])return!1;return!0})(this._fillGradientStops,fillGradientStops)||(this._fillGradientStops=fillGradientStops,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(TextStyle.prototype,"fontFamily",{get:function(){return this._fontFamily},set:function(fontFamily){this.fontFamily!==fontFamily&&(this._fontFamily=fontFamily,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(TextStyle.prototype,"fontSize",{get:function(){return this._fontSize},set:function(fontSize){this._fontSize!==fontSize&&(this._fontSize=fontSize,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(TextStyle.prototype,"fontStyle",{get:function(){return this._fontStyle},set:function(fontStyle){this._fontStyle!==fontStyle&&(this._fontStyle=fontStyle,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(TextStyle.prototype,"fontVariant",{get:function(){return this._fontVariant},set:function(fontVariant){this._fontVariant!==fontVariant&&(this._fontVariant=fontVariant,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(TextStyle.prototype,"fontWeight",{get:function(){return this._fontWeight},set:function(fontWeight){this._fontWeight!==fontWeight&&(this._fontWeight=fontWeight,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(TextStyle.prototype,"letterSpacing",{get:function(){return this._letterSpacing},set:function(letterSpacing){this._letterSpacing!==letterSpacing&&(this._letterSpacing=letterSpacing,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(TextStyle.prototype,"lineHeight",{get:function(){return this._lineHeight},set:function(lineHeight){this._lineHeight!==lineHeight&&(this._lineHeight=lineHeight,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(TextStyle.prototype,"leading",{get:function(){return this._leading},set:function(leading){this._leading!==leading&&(this._leading=leading,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(TextStyle.prototype,"lineJoin",{get:function(){return this._lineJoin},set:function(lineJoin){this._lineJoin!==lineJoin&&(this._lineJoin=lineJoin,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(TextStyle.prototype,"miterLimit",{get:function(){return this._miterLimit},set:function(miterLimit){this._miterLimit!==miterLimit&&(this._miterLimit=miterLimit,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(TextStyle.prototype,"padding",{get:function(){return this._padding},set:function(padding){this._padding!==padding&&(this._padding=padding,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(TextStyle.prototype,"stroke",{get:function(){return this._stroke},set:function(stroke){var outputColor=getColor(stroke);this._stroke!==outputColor&&(this._stroke=outputColor,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(TextStyle.prototype,"strokeThickness",{get:function(){return this._strokeThickness},set:function(strokeThickness){this._strokeThickness!==strokeThickness&&(this._strokeThickness=strokeThickness,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(TextStyle.prototype,"textBaseline",{get:function(){return this._textBaseline},set:function(textBaseline){this._textBaseline!==textBaseline&&(this._textBaseline=textBaseline,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(TextStyle.prototype,"trim",{get:function(){return this._trim},set:function(trim){this._trim!==trim&&(this._trim=trim,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(TextStyle.prototype,"whiteSpace",{get:function(){return this._whiteSpace},set:function(whiteSpace){this._whiteSpace!==whiteSpace&&(this._whiteSpace=whiteSpace,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(TextStyle.prototype,"wordWrap",{get:function(){return this._wordWrap},set:function(wordWrap){this._wordWrap!==wordWrap&&(this._wordWrap=wordWrap,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(TextStyle.prototype,"wordWrapWidth",{get:function(){return this._wordWrapWidth},set:function(wordWrapWidth){this._wordWrapWidth!==wordWrapWidth&&(this._wordWrapWidth=wordWrapWidth,this.styleID++)},enumerable:!1,configurable:!0}),TextStyle.prototype.toFontString=function(){var fontSizeString="number"==typeof this.fontSize?this.fontSize+"px":this.fontSize,fontFamilies=this.fontFamily;Array.isArray(this.fontFamily)||(fontFamilies=this.fontFamily.split(","));for(var i=fontFamilies.length-1;i>=0;i--){var fontFamily=fontFamilies[i].trim();!/([\"\'])[^\'\"]+\1/.test(fontFamily)&&genericFontFamilies.indexOf(fontFamily)<0&&(fontFamily='"'+fontFamily+'"'),fontFamilies[i]=fontFamily}return this.fontStyle+" "+this.fontVariant+" "+this.fontWeight+" "+fontSizeString+" "+fontFamilies.join(",")},TextStyle}();function getSingleColor(color){return"number"==typeof color?hex2string(color):("string"==typeof color&&0===color.indexOf("0x")&&(color=color.replace("0x","#")),color)}function getColor(color){if(Array.isArray(color)){for(var i=0;i<color.length;++i)color[i]=getSingleColor(color[i]);return color}return getSingleColor(color)}function deepCopyProperties(target,source,propertyObj){for(var prop in propertyObj)Array.isArray(source[prop])?target[prop]=source[prop].slice():target[prop]=source[prop]}var TextMetrics=function(){function TextMetrics(text,style,width,height,lines,lineWidths,lineHeight,maxLineWidth,fontProperties){this.text=text,this.style=style,this.width=width,this.height=height,this.lines=lines,this.lineWidths=lineWidths,this.lineHeight=lineHeight,this.maxLineWidth=maxLineWidth,this.fontProperties=fontProperties}return TextMetrics.measureText=function(text,style,wordWrap,canvas){void 0===canvas&&(canvas=TextMetrics._canvas),wordWrap=null==wordWrap?style.wordWrap:wordWrap;var font=style.toFontString(),fontProperties=TextMetrics.measureFont(font);0===fontProperties.fontSize&&(fontProperties.fontSize=style.fontSize,fontProperties.ascent=style.fontSize);var context=canvas.getContext("2d");context.font=font;for(var lines=(wordWrap?TextMetrics.wordWrap(text,style,canvas):text).split(/(?:\r\n|\r|\n)/),lineWidths=new Array(lines.length),maxLineWidth=0,i=0;i<lines.length;i++){var lineWidth=context.measureText(lines[i]).width+(lines[i].length-1)*style.letterSpacing;lineWidths[i]=lineWidth,maxLineWidth=Math.max(maxLineWidth,lineWidth)}var width=maxLineWidth+style.strokeThickness;style.dropShadow&&(width+=style.dropShadowDistance);var lineHeight=style.lineHeight||fontProperties.fontSize+style.strokeThickness,height=Math.max(lineHeight,fontProperties.fontSize+style.strokeThickness)+(lines.length-1)*(lineHeight+style.leading);return style.dropShadow&&(height+=style.dropShadowDistance),new TextMetrics(text,style,width,height,lines,lineWidths,lineHeight+style.leading,maxLineWidth,fontProperties)},TextMetrics.wordWrap=function(text,style,canvas){void 0===canvas&&(canvas=TextMetrics._canvas);for(var context=canvas.getContext("2d"),width=0,line="",lines="",cache=Object.create(null),letterSpacing=style.letterSpacing,whiteSpace=style.whiteSpace,collapseSpaces=TextMetrics.collapseSpaces(whiteSpace),collapseNewlines=TextMetrics.collapseNewlines(whiteSpace),canPrependSpaces=!collapseSpaces,wordWrapWidth=style.wordWrapWidth+letterSpacing,tokens=TextMetrics.tokenize(text),i=0;i<tokens.length;i++){var token=tokens[i];if(TextMetrics.isNewline(token)){if(!collapseNewlines){lines+=TextMetrics.addLine(line),canPrependSpaces=!collapseSpaces,line="",width=0;continue}token=" "}if(collapseSpaces){var currIsBreakingSpace=TextMetrics.isBreakingSpace(token),lastIsBreakingSpace=TextMetrics.isBreakingSpace(line[line.length-1]);if(currIsBreakingSpace&&lastIsBreakingSpace)continue}var tokenWidth=TextMetrics.getFromCache(token,letterSpacing,cache,context);if(tokenWidth>wordWrapWidth)if(""!==line&&(lines+=TextMetrics.addLine(line),line="",width=0),TextMetrics.canBreakWords(token,style.breakWords))for(var characters=TextMetrics.wordWrapSplit(token),j=0;j<characters.length;j++){for(var char=characters[j],k=1;characters[j+k];){var nextChar=characters[j+k],lastChar=char[char.length-1];if(TextMetrics.canBreakChars(lastChar,nextChar,token,j,style.breakWords))break;char+=nextChar,k++}j+=char.length-1;var characterWidth=TextMetrics.getFromCache(char,letterSpacing,cache,context);characterWidth+width>wordWrapWidth&&(lines+=TextMetrics.addLine(line),canPrependSpaces=!1,line="",width=0),line+=char,width+=characterWidth}else{line.length>0&&(lines+=TextMetrics.addLine(line),line="",width=0);var isLastToken=i===tokens.length-1;lines+=TextMetrics.addLine(token,!isLastToken),canPrependSpaces=!1,line="",width=0}else tokenWidth+width>wordWrapWidth&&(canPrependSpaces=!1,lines+=TextMetrics.addLine(line),line="",width=0),(line.length>0||!TextMetrics.isBreakingSpace(token)||canPrependSpaces)&&(line+=token,width+=tokenWidth)}return lines+=TextMetrics.addLine(line,!1)},TextMetrics.addLine=function(line,newLine){return void 0===newLine&&(newLine=!0),line=TextMetrics.trimRight(line),line=newLine?line+"\n":line},TextMetrics.getFromCache=function(key,letterSpacing,cache,context){var width=cache[key];if("number"!=typeof width){var spacing=key.length*letterSpacing;width=context.measureText(key).width+spacing,cache[key]=width}return width},TextMetrics.collapseSpaces=function(whiteSpace){return"normal"===whiteSpace||"pre-line"===whiteSpace},TextMetrics.collapseNewlines=function(whiteSpace){return"normal"===whiteSpace},TextMetrics.trimRight=function(text){if("string"!=typeof text)return"";for(var i=text.length-1;i>=0;i--){var char=text[i];if(!TextMetrics.isBreakingSpace(char))break;text=text.slice(0,-1)}return text},TextMetrics.isNewline=function(char){return"string"==typeof char&&TextMetrics._newlines.indexOf(char.charCodeAt(0))>=0},TextMetrics.isBreakingSpace=function(char,_nextChar){return"string"==typeof char&&TextMetrics._breakingSpaces.indexOf(char.charCodeAt(0))>=0},TextMetrics.tokenize=function(text){var tokens=[],token="";if("string"!=typeof text)return tokens;for(var i=0;i<text.length;i++){var char=text[i],nextChar=text[i+1];TextMetrics.isBreakingSpace(char,nextChar)||TextMetrics.isNewline(char)?(""!==token&&(tokens.push(token),token=""),tokens.push(char)):token+=char}return""!==token&&tokens.push(token),tokens},TextMetrics.canBreakWords=function(_token,breakWords){return breakWords},TextMetrics.canBreakChars=function(_char,_nextChar,_token,_index,_breakWords){return!0},TextMetrics.wordWrapSplit=function(token){return token.split("")},TextMetrics.measureFont=function(font){if(TextMetrics._fonts[font])return TextMetrics._fonts[font];var properties={ascent:0,descent:0,fontSize:0},canvas=TextMetrics._canvas,context=TextMetrics._context;context.font=font;var metricsString=TextMetrics.METRICS_STRING+TextMetrics.BASELINE_SYMBOL,width=Math.ceil(context.measureText(metricsString).width),baseline=Math.ceil(context.measureText(TextMetrics.BASELINE_SYMBOL).width),height=Math.ceil(TextMetrics.HEIGHT_MULTIPLIER*baseline);baseline=baseline*TextMetrics.BASELINE_MULTIPLIER|0,canvas.width=width,canvas.height=height,context.fillStyle="#f00",context.fillRect(0,0,width,height),context.font=font,context.textBaseline="alphabetic",context.fillStyle="#000",context.fillText(metricsString,0,baseline);var imagedata=context.getImageData(0,0,width,height).data,pixels=imagedata.length,line=4*width,i=0,idx=0,stop=!1;for(i=0;i<baseline;++i){for(var j=0;j<line;j+=4)if(255!==imagedata[idx+j]){stop=!0;break}if(stop)break;idx+=line}for(properties.ascent=baseline-i,idx=pixels-line,stop=!1,i=height;i>baseline;--i){for(j=0;j<line;j+=4)if(255!==imagedata[idx+j]){stop=!0;break}if(stop)break;idx-=line}return properties.descent=i-baseline,properties.fontSize=properties.ascent+properties.descent,TextMetrics._fonts[font]=properties,properties},TextMetrics.clearMetrics=function(font){void 0===font&&(font=""),font?delete TextMetrics._fonts[font]:TextMetrics._fonts={}},TextMetrics}(),canvas=function(){try{var c=new OffscreenCanvas(0,0),context=c.getContext("2d");return context&&context.measureText?c:document.createElement("canvas")}catch(ex){return document.createElement("canvas")}}();canvas.width=canvas.height=10,TextMetrics._canvas=canvas,TextMetrics._context=canvas.getContext("2d"),TextMetrics._fonts={},TextMetrics.METRICS_STRING="|q",TextMetrics.BASELINE_SYMBOL="M",TextMetrics.BASELINE_MULTIPLIER=1.4,TextMetrics.HEIGHT_MULTIPLIER=2,TextMetrics._newlines=[10,13],TextMetrics._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];var defaultDestroyOptions={texture:!0,children:!1,baseTexture:!0},Text=function(_super){function Text(text,style,canvas){var _this=this,ownCanvas=!1;canvas||(canvas=document.createElement("canvas"),ownCanvas=!0),canvas.width=3,canvas.height=3;var texture=Texture.from(canvas);return texture.orig=new Rectangle,texture.trim=new Rectangle,(_this=_super.call(this,texture)||this)._ownCanvas=ownCanvas,_this.canvas=canvas,_this.context=_this.canvas.getContext("2d"),_this._resolution=settings.RESOLUTION,_this._autoResolution=!0,_this._text=null,_this._style=null,_this._styleListener=null,_this._font="",_this.text=text,_this.style=style,_this.localStyleID=-1,_this}return function(d,b){function __(){this.constructor=d}text_extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}(Text,_super),Text.prototype.updateText=function(respectDirty){var style=this._style;if(this.localStyleID!==style.styleID&&(this.dirty=!0,this.localStyleID=style.styleID),this.dirty||!respectDirty){this._font=this._style.toFontString();var linePositionX,linePositionY,context=this.context,measured=TextMetrics.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),width=measured.width,height=measured.height,lines=measured.lines,lineHeight=measured.lineHeight,lineWidths=measured.lineWidths,maxLineWidth=measured.maxLineWidth,fontProperties=measured.fontProperties;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,width)+2*style.padding)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,height)+2*style.padding)*this._resolution),context.scale(this._resolution,this._resolution),context.clearRect(0,0,this.canvas.width,this.canvas.height),context.font=this._font,context.lineWidth=style.strokeThickness,context.textBaseline=style.textBaseline,context.lineJoin=style.lineJoin,context.miterLimit=style.miterLimit;for(var passesCount=style.dropShadow?2:1,i=0;i<passesCount;++i){var isShadowPass=style.dropShadow&&0===i,dsOffsetText=isShadowPass?Math.ceil(Math.max(1,height)+2*style.padding):0,dsOffsetShadow=dsOffsetText*this._resolution;if(isShadowPass){context.fillStyle="black",context.strokeStyle="black";var dropShadowColor=style.dropShadowColor,rgb=hex2rgb("number"==typeof dropShadowColor?dropShadowColor:string2hex(dropShadowColor)),dropShadowBlur=style.dropShadowBlur*this._resolution,dropShadowDistance=style.dropShadowDistance*this._resolution;context.shadowColor="rgba("+255*rgb[0]+","+255*rgb[1]+","+255*rgb[2]+","+style.dropShadowAlpha+")",context.shadowBlur=dropShadowBlur,context.shadowOffsetX=Math.cos(style.dropShadowAngle)*dropShadowDistance,context.shadowOffsetY=Math.sin(style.dropShadowAngle)*dropShadowDistance+dsOffsetShadow}else context.fillStyle=this._generateFillStyle(style,lines,measured),context.strokeStyle=style.stroke,context.shadowColor="black",context.shadowBlur=0,context.shadowOffsetX=0,context.shadowOffsetY=0;var linePositionYShift=(lineHeight-fontProperties.fontSize)/2;(!Text.nextLineHeightBehavior||lineHeight-fontProperties.fontSize<0)&&(linePositionYShift=0);for(var i_1=0;i_1<lines.length;i_1++)linePositionX=style.strokeThickness/2,linePositionY=style.strokeThickness/2+i_1*lineHeight+fontProperties.ascent+linePositionYShift,"right"===style.align?linePositionX+=maxLineWidth-lineWidths[i_1]:"center"===style.align&&(linePositionX+=(maxLineWidth-lineWidths[i_1])/2),style.stroke&&style.strokeThickness&&this.drawLetterSpacing(lines[i_1],linePositionX+style.padding,linePositionY+style.padding-dsOffsetText,!0),style.fill&&this.drawLetterSpacing(lines[i_1],linePositionX+style.padding,linePositionY+style.padding-dsOffsetText)}this.updateTexture()}},Text.prototype.drawLetterSpacing=function(text,x,y,isStroke){void 0===isStroke&&(isStroke=!1);var letterSpacing=this._style.letterSpacing,supportLetterSpacing=Text.experimentalLetterSpacing&&("letterSpacing"in CanvasRenderingContext2D.prototype||"textLetterSpacing"in CanvasRenderingContext2D.prototype);if(0===letterSpacing||supportLetterSpacing)return supportLetterSpacing&&(this.context.letterSpacing=letterSpacing,this.context.textLetterSpacing=letterSpacing),void(isStroke?this.context.strokeText(text,x,y):this.context.fillText(text,x,y));for(var currentPosition=x,stringArray=Array.from?Array.from(text):text.split(""),previousWidth=this.context.measureText(text).width,currentWidth=0,i=0;i<stringArray.length;++i){var currentChar=stringArray[i];isStroke?this.context.strokeText(currentChar,currentPosition,y):this.context.fillText(currentChar,currentPosition,y);for(var textStr="",j=i+1;j<stringArray.length;++j)textStr+=stringArray[j];currentPosition+=previousWidth-(currentWidth=this.context.measureText(textStr).width)+letterSpacing,previousWidth=currentWidth}},Text.prototype.updateTexture=function(){var canvas=this.canvas;if(this._style.trim){var trimmed=function(canvas){var i,x,y,width=canvas.width,height=canvas.height,context=canvas.getContext("2d"),pixels=context.getImageData(0,0,width,height).data,len=pixels.length,bound={top:null,left:null,right:null,bottom:null},data=null;for(i=0;i<len;i+=4)0!==pixels[i+3]&&(x=i/4%width,y=~~(i/4/width),null===bound.top&&(bound.top=y),(null===bound.left||x<bound.left)&&(bound.left=x),(null===bound.right||bound.right<x)&&(bound.right=x+1),(null===bound.bottom||bound.bottom<y)&&(bound.bottom=y));return null!==bound.top&&(width=bound.right-bound.left,height=bound.bottom-bound.top+1,data=context.getImageData(bound.left,bound.top,width,height)),{height,width,data}}(canvas);trimmed.data&&(canvas.width=trimmed.width,canvas.height=trimmed.height,this.context.putImageData(trimmed.data,0,0))}var texture=this._texture,style=this._style,padding=style.trim?0:style.padding,baseTexture=texture.baseTexture;texture.trim.width=texture._frame.width=canvas.width/this._resolution,texture.trim.height=texture._frame.height=canvas.height/this._resolution,texture.trim.x=-padding,texture.trim.y=-padding,texture.orig.width=texture._frame.width-2*padding,texture.orig.height=texture._frame.height-2*padding,this._onTextureUpdate(),baseTexture.setRealSize(canvas.width,canvas.height,this._resolution),texture.updateUvs(),this._recursivePostUpdateTransform(),this.dirty=!1},Text.prototype._render=function(renderer){this._autoResolution&&this._resolution!==renderer.resolution&&(this._resolution=renderer.resolution,this.dirty=!0),this.updateText(!0),_super.prototype._render.call(this,renderer)},Text.prototype.getLocalBounds=function(rect){return this.updateText(!0),_super.prototype.getLocalBounds.call(this,rect)},Text.prototype._calculateBounds=function(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)},Text.prototype._generateFillStyle=function(style,lines,metrics){var gradient,fillStyle=style.fill;if(!Array.isArray(fillStyle))return fillStyle;if(1===fillStyle.length)return fillStyle[0];var dropShadowCorrection=style.dropShadow?style.dropShadowDistance:0,padding=style.padding||0,width=this.canvas.width/this._resolution-dropShadowCorrection-2*padding,height=this.canvas.height/this._resolution-dropShadowCorrection-2*padding,fill=fillStyle.slice(),fillGradientStops=style.fillGradientStops.slice();if(!fillGradientStops.length)for(var lengthPlus1=fill.length+1,i=1;i<lengthPlus1;++i)fillGradientStops.push(i/lengthPlus1);if(fill.unshift(fillStyle[0]),fillGradientStops.unshift(0),fill.push(fillStyle[fillStyle.length-1]),fillGradientStops.push(1),style.fillGradientType===TEXT_GRADIENT.LINEAR_VERTICAL){gradient=this.context.createLinearGradient(width/2,padding,width/2,height+padding);var textHeight=metrics.fontProperties.fontSize+style.strokeThickness;for(i=0;i<lines.length;i++){var lastLineBottom=metrics.lineHeight*(i-1)+textHeight,thisLineTop=metrics.lineHeight*i,thisLineGradientStart=thisLineTop;i>0&&lastLineBottom>thisLineTop&&(thisLineGradientStart=(thisLineTop+lastLineBottom)/2);var thisLineBottom=thisLineTop+textHeight,nextLineTop=metrics.lineHeight*(i+1),thisLineGradientEnd=thisLineBottom;i+1<lines.length&&nextLineTop<thisLineBottom&&(thisLineGradientEnd=(thisLineBottom+nextLineTop)/2);for(var gradStopLineHeight=(thisLineGradientEnd-thisLineGradientStart)/height,j=0;j<fill.length;j++){var lineStop=0;lineStop="number"==typeof fillGradientStops[j]?fillGradientStops[j]:j/fill.length;var globalStop=Math.min(1,Math.max(0,thisLineGradientStart/height+lineStop*gradStopLineHeight));globalStop=Number(globalStop.toFixed(5)),gradient.addColorStop(globalStop,fill[j])}}}else{gradient=this.context.createLinearGradient(padding,height/2,width+padding,height/2);var totalIterations=fill.length+1,currentIteration=1;for(i=0;i<fill.length;i++){var stop=void 0;stop="number"==typeof fillGradientStops[i]?fillGradientStops[i]:currentIteration/totalIterations,gradient.addColorStop(stop,fill[i]),currentIteration++}}return gradient},Text.prototype.destroy=function(options){"boolean"==typeof options&&(options={children:options}),options=Object.assign({},defaultDestroyOptions,options),_super.prototype.destroy.call(this,options),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null},Object.defineProperty(Text.prototype,"width",{get:function(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width},set:function(value){this.updateText(!0);var s=sign(this.scale.x)||1;this.scale.x=s*value/this._texture.orig.width,this._width=value},enumerable:!1,configurable:!0}),Object.defineProperty(Text.prototype,"height",{get:function(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height},set:function(value){this.updateText(!0);var s=sign(this.scale.y)||1;this.scale.y=s*value/this._texture.orig.height,this._height=value},enumerable:!1,configurable:!0}),Object.defineProperty(Text.prototype,"style",{get:function(){return this._style},set:function(style){style=style||{},this._style=style instanceof TextStyle?style:new TextStyle(style),this.localStyleID=-1,this.dirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(Text.prototype,"text",{get:function(){return this._text},set:function(text){text=String(null==text?"":text),this._text!==text&&(this._text=text,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(Text.prototype,"resolution",{get:function(){return this._resolution},set:function(value){this._autoResolution=!1,this._resolution!==value&&(this._resolution=value,this.dirty=!0)},enumerable:!1,configurable:!0}),Text.nextLineHeightBehavior=!1,Text.experimentalLetterSpacing=!1,Text}(Sprite);settings.UPLOADS_PER_FRAME=4;var prepare_extendStatics=function(d,b){return prepare_extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])},prepare_extendStatics(d,b)};var CountLimiter=function(){function CountLimiter(maxItemsPerFrame){this.maxItemsPerFrame=maxItemsPerFrame,this.itemsLeft=0}return CountLimiter.prototype.beginFrame=function(){this.itemsLeft=this.maxItemsPerFrame},CountLimiter.prototype.allowedToUpload=function(){return this.itemsLeft-- >0},CountLimiter}();function findMultipleBaseTextures(item,queue){var result=!1;if(item&&item._textures&&item._textures.length)for(var i=0;i<item._textures.length;i++)if(item._textures[i]instanceof Texture){var baseTexture=item._textures[i].baseTexture;-1===queue.indexOf(baseTexture)&&(queue.push(baseTexture),result=!0)}return result}function findBaseTexture(item,queue){if(item.baseTexture instanceof BaseTexture){var texture=item.baseTexture;return-1===queue.indexOf(texture)&&queue.push(texture),!0}return!1}function findTexture(item,queue){if(item._texture&&item._texture instanceof Texture){var texture=item._texture.baseTexture;return-1===queue.indexOf(texture)&&queue.push(texture),!0}return!1}function drawText(_helper,item){return item instanceof Text&&(item.updateText(!0),!0)}function calculateTextStyle(_helper,item){if(item instanceof TextStyle){var font=item.toFontString();return TextMetrics.measureFont(font),!0}return!1}function findText(item,queue){if(item instanceof Text){-1===queue.indexOf(item.style)&&queue.push(item.style),-1===queue.indexOf(item)&&queue.push(item);var texture=item._texture.baseTexture;return-1===queue.indexOf(texture)&&queue.push(texture),!0}return!1}function findTextStyle(item,queue){return item instanceof TextStyle&&(-1===queue.indexOf(item)&&queue.push(item),!0)}var BasePrepare=function(){function BasePrepare(renderer){var _this=this;this.limiter=new CountLimiter(settings.UPLOADS_PER_FRAME),this.renderer=renderer,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=function(){_this.queue&&_this.prepareItems()},this.registerFindHook(findText),this.registerFindHook(findTextStyle),this.registerFindHook(findMultipleBaseTextures),this.registerFindHook(findBaseTexture),this.registerFindHook(findTexture),this.registerUploadHook(drawText),this.registerUploadHook(calculateTextStyle)}return BasePrepare.prototype.upload=function(item,done){"function"==typeof item&&(done=item,item=null),item&&this.add(item),this.queue.length?(done&&this.completes.push(done),this.ticking||(this.ticking=!0,Ticker.system.addOnce(this.tick,this,UPDATE_PRIORITY.UTILITY))):done&&done()},BasePrepare.prototype.tick=function(){setTimeout(this.delayedTick,0)},BasePrepare.prototype.prepareItems=function(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){var item=this.queue[0],uploaded=!1;if(item&&!item._destroyed)for(var i=0,len=this.uploadHooks.length;i<len;i++)if(this.uploadHooks[i](this.uploadHookHelper,item)){this.queue.shift(),uploaded=!0;break}uploaded||this.queue.shift()}if(this.queue.length)Ticker.system.addOnce(this.tick,this,UPDATE_PRIORITY.UTILITY);else{this.ticking=!1;var completes=this.completes.slice(0);this.completes.length=0;for(i=0,len=completes.length;i<len;i++)completes[i]()}},BasePrepare.prototype.registerFindHook=function(addHook){return addHook&&this.addHooks.push(addHook),this},BasePrepare.prototype.registerUploadHook=function(uploadHook){return uploadHook&&this.uploadHooks.push(uploadHook),this},BasePrepare.prototype.add=function(item){for(var i=0,len=this.addHooks.length;i<len&&!this.addHooks[i](item,this.queue);i++);if(item instanceof Container)for(i=item.children.length-1;i>=0;i--)this.add(item.children[i]);return this},BasePrepare.prototype.destroy=function(){this.ticking&&Ticker.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null},BasePrepare}();function uploadBaseTextures(renderer,item){return item instanceof BaseTexture&&(item._glTextures[renderer.CONTEXT_UID]||renderer.texture.bind(item),!0)}function uploadGraphics(renderer,item){if(!(item instanceof Graphics))return!1;var geometry=item.geometry;item.finishPoly(),geometry.updateBatches();for(var batches=geometry.batches,i=0;i<batches.length;i++){var texture=batches[i].style.texture;texture&&uploadBaseTextures(renderer,texture.baseTexture)}return geometry.batchable||renderer.geometry.bind(geometry,item._resolveDirectShader(renderer)),!0}function findGraphics(item,queue){return item instanceof Graphics&&(queue.push(item),!0)}var Prepare=function(_super){function Prepare(renderer){var _this=_super.call(this,renderer)||this;return _this.uploadHookHelper=_this.renderer,_this.registerFindHook(findGraphics),_this.registerUploadHook(uploadBaseTextures),_this.registerUploadHook(uploadGraphics),_this}return function(d,b){function __(){this.constructor=d}prepare_extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}(Prepare,_super),Prepare}(BasePrepare),Spritesheet=(function(){function TimeLimiter(maxMilliseconds){this.maxMilliseconds=maxMilliseconds,this.frameStart=0}TimeLimiter.prototype.beginFrame=function(){this.frameStart=Date.now()},TimeLimiter.prototype.allowedToUpload=function(){return Date.now()-this.frameStart<this.maxMilliseconds}}(),function(){function Spritesheet(texture,data,resolutionFilename){void 0===resolutionFilename&&(resolutionFilename=null),this._texture=texture instanceof Texture?texture:null,this.baseTexture=texture instanceof BaseTexture?texture:this._texture.baseTexture,this.textures={},this.animations={},this.data=data;var resource=this.baseTexture.resource;this.resolution=this._updateResolution(resolutionFilename||(resource?resource.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}return Spritesheet.prototype._updateResolution=function(resolutionFilename){void 0===resolutionFilename&&(resolutionFilename=null);var scale=this.data.meta.scale,resolution=getResolutionOfUrl(resolutionFilename,null);return null===resolution&&(resolution=void 0!==scale?parseFloat(scale):1),1!==resolution&&this.baseTexture.setResolution(resolution),resolution},Spritesheet.prototype.parse=function(callback){this._batchIndex=0,this._callback=callback,this._frameKeys.length<=Spritesheet.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()},Spritesheet.prototype._processFrames=function(initialFrameIndex){for(var frameIndex=initialFrameIndex,maxFrames=Spritesheet.BATCH_SIZE;frameIndex-initialFrameIndex<maxFrames&&frameIndex<this._frameKeys.length;){var i=this._frameKeys[frameIndex],data=this._frames[i],rect=data.frame;if(rect){var frame=null,trim=null,sourceSize=!1!==data.trimmed&&data.sourceSize?data.sourceSize:data.frame,orig=new Rectangle(0,0,Math.floor(sourceSize.w)/this.resolution,Math.floor(sourceSize.h)/this.resolution);frame=data.rotated?new Rectangle(Math.floor(rect.x)/this.resolution,Math.floor(rect.y)/this.resolution,Math.floor(rect.h)/this.resolution,Math.floor(rect.w)/this.resolution):new Rectangle(Math.floor(rect.x)/this.resolution,Math.floor(rect.y)/this.resolution,Math.floor(rect.w)/this.resolution,Math.floor(rect.h)/this.resolution),!1!==data.trimmed&&data.spriteSourceSize&&(trim=new Rectangle(Math.floor(data.spriteSourceSize.x)/this.resolution,Math.floor(data.spriteSourceSize.y)/this.resolution,Math.floor(rect.w)/this.resolution,Math.floor(rect.h)/this.resolution)),this.textures[i]=new Texture(this.baseTexture,frame,orig,trim,data.rotated?2:0,data.anchor),Texture.addToCache(this.textures[i],i)}frameIndex++}},Spritesheet.prototype._processAnimations=function(){var animations=this.data.animations||{};for(var animName in animations){this.animations[animName]=[];for(var i=0;i<animations[animName].length;i++){var frameName=animations[animName][i];this.animations[animName].push(this.textures[frameName])}}},Spritesheet.prototype._parseComplete=function(){var callback=this._callback;this._callback=null,this._batchIndex=0,callback.call(this,this.textures)},Spritesheet.prototype._nextBatch=function(){var _this=this;this._processFrames(this._batchIndex*Spritesheet.BATCH_SIZE),this._batchIndex++,setTimeout((function(){_this._batchIndex*Spritesheet.BATCH_SIZE<_this._frameKeys.length?_this._nextBatch():(_this._processAnimations(),_this._parseComplete())}),0)},Spritesheet.prototype.destroy=function(destroyBase){var _a;for(var i in void 0===destroyBase&&(destroyBase=!1),this.textures)this.textures[i].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,destroyBase&&(null===(_a=this._texture)||void 0===_a||_a.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null},Spritesheet.BATCH_SIZE=1e3,Spritesheet}()),SpritesheetLoader=function(){function SpritesheetLoader(){}return SpritesheetLoader.use=function(resource,next){var _a,_b,loader=this,imageResourceName=resource.name+"_image";if(resource.data&&resource.type===LoaderResource.TYPE.JSON&&resource.data.frames&&!loader.resources[imageResourceName]){var multiPacks=null===(_b=null===(_a=resource.data)||void 0===_a?void 0:_a.meta)||void 0===_b?void 0:_b.related_multi_packs;if(Array.isArray(multiPacks))for(var _loop_1=function(item){if("string"!=typeof item)return"continue";var itemName=item.replace(".json",""),itemUrl=utils_url.resolve(resource.url.replace(loader.baseUrl,""),item);if(loader.resources[itemName]||Object.values(loader.resources).some((function(r){return utils_url.format(utils_url.parse(r.url))===itemUrl})))return"continue";var options={crossOrigin:resource.crossOrigin,loadType:LoaderResource.LOAD_TYPE.XHR,xhrType:LoaderResource.XHR_RESPONSE_TYPE.JSON,parentResource:resource,metadata:resource.metadata};loader.add(itemName,itemUrl,options)},_i=0,multiPacks_1=multiPacks;_i<multiPacks_1.length;_i++){_loop_1(multiPacks_1[_i])}var loadOptions={crossOrigin:resource.crossOrigin,metadata:resource.metadata.imageMetadata,parentResource:resource},resourcePath=SpritesheetLoader.getResourcePath(resource,loader.baseUrl);loader.add(imageResourceName,resourcePath,loadOptions,(function(res){if(res.error)next(res.error);else{var spritesheet=new Spritesheet(res.texture,resource.data,resource.url);spritesheet.parse((function(){resource.spritesheet=spritesheet,resource.textures=spritesheet.textures,next()}))}}))}else next()},SpritesheetLoader.getResourcePath=function(resource,baseUrl){return resource.isDataUrl?resource.data.meta.image:utils_url.resolve(resource.url.replace(baseUrl,""),resource.data.meta.image)},SpritesheetLoader}(),sprite_tiling_extendStatics=function(d,b){return sprite_tiling_extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])},sprite_tiling_extendStatics(d,b)};function sprite_tiling_extends(d,b){function __(){this.constructor=d}sprite_tiling_extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}var sprite_tiling_tempPoint=new Point,TilingSprite=function(_super){function TilingSprite(texture,width,height){void 0===width&&(width=100),void 0===height&&(height=100);var _this=_super.call(this,texture)||this;return _this.tileTransform=new Transform,_this._width=width,_this._height=height,_this.uvMatrix=_this.texture.uvMatrix||new TextureMatrix(texture),_this.pluginName="tilingSprite",_this.uvRespectAnchor=!1,_this}return sprite_tiling_extends(TilingSprite,_super),Object.defineProperty(TilingSprite.prototype,"clampMargin",{get:function(){return this.uvMatrix.clampMargin},set:function(value){this.uvMatrix.clampMargin=value,this.uvMatrix.update(!0)},enumerable:!1,configurable:!0}),Object.defineProperty(TilingSprite.prototype,"tileScale",{get:function(){return this.tileTransform.scale},set:function(value){this.tileTransform.scale.copyFrom(value)},enumerable:!1,configurable:!0}),Object.defineProperty(TilingSprite.prototype,"tilePosition",{get:function(){return this.tileTransform.position},set:function(value){this.tileTransform.position.copyFrom(value)},enumerable:!1,configurable:!0}),TilingSprite.prototype._onTextureUpdate=function(){this.uvMatrix&&(this.uvMatrix.texture=this._texture),this._cachedTint=16777215},TilingSprite.prototype._render=function(renderer){var texture=this._texture;texture&&texture.valid&&(this.tileTransform.updateLocalTransform(),this.uvMatrix.update(),renderer.batch.setObjectRenderer(renderer.plugins[this.pluginName]),renderer.plugins[this.pluginName].render(this))},TilingSprite.prototype._calculateBounds=function(){var minX=this._width*-this._anchor._x,minY=this._height*-this._anchor._y,maxX=this._width*(1-this._anchor._x),maxY=this._height*(1-this._anchor._y);this._bounds.addFrame(this.transform,minX,minY,maxX,maxY)},TilingSprite.prototype.getLocalBounds=function(rect){return 0===this.children.length?(this._bounds.minX=this._width*-this._anchor._x,this._bounds.minY=this._height*-this._anchor._y,this._bounds.maxX=this._width*(1-this._anchor._x),this._bounds.maxY=this._height*(1-this._anchor._y),rect||(this._localBoundsRect||(this._localBoundsRect=new Rectangle),rect=this._localBoundsRect),this._bounds.getRectangle(rect)):_super.prototype.getLocalBounds.call(this,rect)},TilingSprite.prototype.containsPoint=function(point){this.worldTransform.applyInverse(point,sprite_tiling_tempPoint);var width=this._width,height=this._height,x1=-width*this.anchor._x;if(sprite_tiling_tempPoint.x>=x1&&sprite_tiling_tempPoint.x<x1+width){var y1=-height*this.anchor._y;if(sprite_tiling_tempPoint.y>=y1&&sprite_tiling_tempPoint.y<y1+height)return!0}return!1},TilingSprite.prototype.destroy=function(options){_super.prototype.destroy.call(this,options),this.tileTransform=null,this.uvMatrix=null},TilingSprite.from=function(source,options){return new TilingSprite(source instanceof Texture?source:Texture.from(source,options),options.width,options.height)},Object.defineProperty(TilingSprite.prototype,"width",{get:function(){return this._width},set:function(value){this._width=value},enumerable:!1,configurable:!0}),Object.defineProperty(TilingSprite.prototype,"height",{get:function(){return this._height},set:function(value){this._height=value},enumerable:!1,configurable:!0}),TilingSprite}(Sprite),gl1VertexSrc="#version 100\n#define SHADER_NAME Tiling-Sprite-100\n\nprecision lowp float;\n\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n",sprite_tiling_tempMat=new Matrix,TilingSpriteRenderer=function(_super){function TilingSpriteRenderer(renderer){var _this=_super.call(this,renderer)||this;return renderer.runners.contextChange.add(_this),_this.quad=new QuadUv,_this.state=State.for2d(),_this}return sprite_tiling_extends(TilingSpriteRenderer,_super),TilingSpriteRenderer.prototype.contextChange=function(){var renderer=this.renderer,uniforms={globals:renderer.globalUniforms};this.simpleShader=Shader.from(gl1VertexSrc,"#version 100\n#define SHADER_NAME Tiling-Sprite-Simple-100\n\nprecision lowp float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\n\nvoid main(void)\n{\n    vec4 texSample = texture2D(uSampler, vTextureCoord);\n    gl_FragColor = texSample * uColor;\n}\n",uniforms),this.shader=renderer.context.webGLVersion>1?Shader.from("#version 300 es\n#define SHADER_NAME Tiling-Sprite-300\n\nprecision lowp float;\n\nin vec2 aVertexPosition;\nin vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nout vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n","#version 300 es\n#define SHADER_NAME Tiling-Sprite-100\n\nprecision lowp float;\n\nin vec2 vTextureCoord;\n\nout vec4 fragmentColor;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform mat3 uMapCoord;\nuniform vec4 uClampFrame;\nuniform vec2 uClampOffset;\n\nvoid main(void)\n{\n    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);\n    coord = (uMapCoord * vec3(coord, 1.0)).xy;\n    vec2 unclamped = coord;\n    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0\n\n    fragmentColor = texSample * uColor;\n}\n",uniforms):Shader.from(gl1VertexSrc,"#version 100\n#ifdef GL_EXT_shader_texture_lod\n    #extension GL_EXT_shader_texture_lod : enable\n#endif\n#define SHADER_NAME Tiling-Sprite-100\n\nprecision lowp float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform mat3 uMapCoord;\nuniform vec4 uClampFrame;\nuniform vec2 uClampOffset;\n\nvoid main(void)\n{\n    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);\n    coord = (uMapCoord * vec3(coord, 1.0)).xy;\n    vec2 unclamped = coord;\n    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n    #ifdef GL_EXT_shader_texture_lod\n        vec4 texSample = unclamped == coord\n            ? texture2D(uSampler, coord) \n            : texture2DLodEXT(uSampler, coord, 0);\n    #else\n        vec4 texSample = texture2D(uSampler, coord);\n    #endif\n\n    gl_FragColor = texSample * uColor;\n}\n",uniforms)},TilingSpriteRenderer.prototype.render=function(ts){var renderer=this.renderer,quad=this.quad,vertices=quad.vertices;vertices[0]=vertices[6]=ts._width*-ts.anchor.x,vertices[1]=vertices[3]=ts._height*-ts.anchor.y,vertices[2]=vertices[4]=ts._width*(1-ts.anchor.x),vertices[5]=vertices[7]=ts._height*(1-ts.anchor.y);var anchorX=ts.uvRespectAnchor?ts.anchor.x:0,anchorY=ts.uvRespectAnchor?ts.anchor.y:0;(vertices=quad.uvs)[0]=vertices[6]=-anchorX,vertices[1]=vertices[3]=-anchorY,vertices[2]=vertices[4]=1-anchorX,vertices[5]=vertices[7]=1-anchorY,quad.invalidate();var tex=ts._texture,baseTex=tex.baseTexture,lt=ts.tileTransform.localTransform,uv=ts.uvMatrix,isSimple=baseTex.isPowerOfTwo&&tex.frame.width===baseTex.width&&tex.frame.height===baseTex.height;isSimple&&(baseTex._glTextures[renderer.CONTEXT_UID]?isSimple=baseTex.wrapMode!==constants_WRAP_MODES.CLAMP:baseTex.wrapMode===constants_WRAP_MODES.CLAMP&&(baseTex.wrapMode=constants_WRAP_MODES.REPEAT));var shader=isSimple?this.simpleShader:this.shader,w=tex.width,h=tex.height,W=ts._width,H=ts._height;sprite_tiling_tempMat.set(lt.a*w/W,lt.b*w/H,lt.c*h/W,lt.d*h/H,lt.tx/W,lt.ty/H),sprite_tiling_tempMat.invert(),isSimple?sprite_tiling_tempMat.prepend(uv.mapCoord):(shader.uniforms.uMapCoord=uv.mapCoord.toArray(!0),shader.uniforms.uClampFrame=uv.uClampFrame,shader.uniforms.uClampOffset=uv.uClampOffset),shader.uniforms.uTransform=sprite_tiling_tempMat.toArray(!0),shader.uniforms.uColor=premultiplyTintToRgba(ts.tint,ts.worldAlpha,shader.uniforms.uColor,baseTex.alphaMode),shader.uniforms.translationMatrix=ts.transform.worldTransform.toArray(!0),shader.uniforms.uSampler=tex,renderer.shader.bind(shader),renderer.geometry.bind(quad),this.state.blendMode=correctBlendMode(ts.blendMode,baseTex.alphaMode),renderer.state.set(this.state),renderer.geometry.draw(this.renderer.gl.TRIANGLES,6,0)},TilingSpriteRenderer}(ObjectRenderer),mesh_extendStatics=function(d,b){return mesh_extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])},mesh_extendStatics(d,b)};function mesh_extends(d,b){function __(){this.constructor=d}mesh_extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}var MeshBatchUvs=function(){function MeshBatchUvs(uvBuffer,uvMatrix){this.uvBuffer=uvBuffer,this.uvMatrix=uvMatrix,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}return MeshBatchUvs.prototype.update=function(forceUpdate){if(forceUpdate||this._bufferUpdateId!==this.uvBuffer._updateID||this._textureUpdateId!==this.uvMatrix._updateID){this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;var data=this.uvBuffer.data;this.data&&this.data.length===data.length||(this.data=new Float32Array(data.length)),this.uvMatrix.multiplyUvs(data,this.data),this._updateID++}},MeshBatchUvs}(),mesh_tempPoint=new Point,tempPolygon=new Polygon,Mesh=function(_super){function Mesh(geometry,shader,state,drawMode){void 0===drawMode&&(drawMode=constants_DRAW_MODES.TRIANGLES);var _this=_super.call(this)||this;return _this.geometry=geometry,_this.shader=shader,_this.state=state||State.for2d(),_this.drawMode=drawMode,_this.start=0,_this.size=0,_this.uvs=null,_this.indices=null,_this.vertexData=new Float32Array(1),_this.vertexDirty=-1,_this._transformID=-1,_this._roundPixels=settings.ROUND_PIXELS,_this.batchUvs=null,_this}return mesh_extends(Mesh,_super),Object.defineProperty(Mesh.prototype,"geometry",{get:function(){return this._geometry},set:function(value){this._geometry!==value&&(this._geometry&&(this._geometry.refCount--,0===this._geometry.refCount&&this._geometry.dispose()),this._geometry=value,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1)},enumerable:!1,configurable:!0}),Object.defineProperty(Mesh.prototype,"uvBuffer",{get:function(){return this.geometry.buffers[1]},enumerable:!1,configurable:!0}),Object.defineProperty(Mesh.prototype,"verticesBuffer",{get:function(){return this.geometry.buffers[0]},enumerable:!1,configurable:!0}),Object.defineProperty(Mesh.prototype,"material",{get:function(){return this.shader},set:function(value){this.shader=value},enumerable:!1,configurable:!0}),Object.defineProperty(Mesh.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(value){this.state.blendMode=value},enumerable:!1,configurable:!0}),Object.defineProperty(Mesh.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(value){this._roundPixels!==value&&(this._transformID=-1),this._roundPixels=value},enumerable:!1,configurable:!0}),Object.defineProperty(Mesh.prototype,"tint",{get:function(){return"tint"in this.shader?this.shader.tint:null},set:function(value){this.shader.tint=value},enumerable:!1,configurable:!0}),Object.defineProperty(Mesh.prototype,"texture",{get:function(){return"texture"in this.shader?this.shader.texture:null},set:function(value){this.shader.texture=value},enumerable:!1,configurable:!0}),Mesh.prototype._render=function(renderer){var vertices=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===constants_DRAW_MODES.TRIANGLES&&vertices.length<2*Mesh.BATCHABLE_SIZE?this._renderToBatch(renderer):this._renderDefault(renderer)},Mesh.prototype._renderDefault=function(renderer){var shader=this.shader;shader.alpha=this.worldAlpha,shader.update&&shader.update(),renderer.batch.flush(),shader.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),renderer.shader.bind(shader),renderer.state.set(this.state),renderer.geometry.bind(this.geometry,shader),renderer.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)},Mesh.prototype._renderToBatch=function(renderer){var geometry=this.geometry,shader=this.shader;shader.uvMatrix&&(shader.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=geometry.indexBuffer.data,this._tintRGB=shader._tintRGB,this._texture=shader.texture;var pluginName=this.material.pluginName;renderer.batch.setObjectRenderer(renderer.plugins[pluginName]),renderer.plugins[pluginName].render(this)},Mesh.prototype.calculateVertices=function(){var verticesBuffer=this.geometry.buffers[0],vertices=verticesBuffer.data,vertexDirtyId=verticesBuffer._updateID;if(vertexDirtyId!==this.vertexDirty||this._transformID!==this.transform._worldID){this._transformID=this.transform._worldID,this.vertexData.length!==vertices.length&&(this.vertexData=new Float32Array(vertices.length));for(var wt=this.transform.worldTransform,a=wt.a,b=wt.b,c=wt.c,d=wt.d,tx=wt.tx,ty=wt.ty,vertexData=this.vertexData,i=0;i<vertexData.length/2;i++){var x=vertices[2*i],y=vertices[2*i+1];vertexData[2*i]=a*x+c*y+tx,vertexData[2*i+1]=b*x+d*y+ty}if(this._roundPixels){var resolution=settings.RESOLUTION;for(i=0;i<vertexData.length;++i)vertexData[i]=Math.round((vertexData[i]*resolution|0)/resolution)}this.vertexDirty=vertexDirtyId}},Mesh.prototype.calculateUvs=function(){var geomUvs=this.geometry.buffers[1],shader=this.shader;shader.uvMatrix.isSimple?this.uvs=geomUvs.data:(this.batchUvs||(this.batchUvs=new MeshBatchUvs(geomUvs,shader.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)},Mesh.prototype._calculateBounds=function(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)},Mesh.prototype.containsPoint=function(point){if(!this.getBounds().contains(point.x,point.y))return!1;this.worldTransform.applyInverse(point,mesh_tempPoint);for(var vertices=this.geometry.getBuffer("aVertexPosition").data,points=tempPolygon.points,indices=this.geometry.getIndex().data,len=indices.length,step=4===this.drawMode?3:1,i=0;i+2<len;i+=step){var ind0=2*indices[i],ind1=2*indices[i+1],ind2=2*indices[i+2];if(points[0]=vertices[ind0],points[1]=vertices[ind0+1],points[2]=vertices[ind1],points[3]=vertices[ind1+1],points[4]=vertices[ind2],points[5]=vertices[ind2+1],tempPolygon.contains(mesh_tempPoint.x,mesh_tempPoint.y))return!0}return!1},Mesh.prototype.destroy=function(options){_super.prototype.destroy.call(this,options),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null},Mesh.BATCHABLE_SIZE=100,Mesh}(Container),MeshMaterial=function(_super){function MeshMaterial(uSampler,options){var _this=this,uniforms={uSampler,alpha:1,uTextureMatrix:Matrix.IDENTITY,uColor:new Float32Array([1,1,1,1])};return(options=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},options)).uniforms&&Object.assign(uniforms,options.uniforms),(_this=_super.call(this,options.program||Program.from("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTextureMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\n}\n","varying vec2 vTextureCoord;\nuniform vec4 uColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;\n}\n"),uniforms)||this)._colorDirty=!1,_this.uvMatrix=new TextureMatrix(uSampler),_this.batchable=void 0===options.program,_this.pluginName=options.pluginName,_this.tint=options.tint,_this.alpha=options.alpha,_this}return mesh_extends(MeshMaterial,_super),Object.defineProperty(MeshMaterial.prototype,"texture",{get:function(){return this.uniforms.uSampler},set:function(value){this.uniforms.uSampler!==value&&(this.uniforms.uSampler=value,this.uvMatrix.texture=value)},enumerable:!1,configurable:!0}),Object.defineProperty(MeshMaterial.prototype,"alpha",{get:function(){return this._alpha},set:function(value){value!==this._alpha&&(this._alpha=value,this._colorDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(MeshMaterial.prototype,"tint",{get:function(){return this._tint},set:function(value){value!==this._tint&&(this._tint=value,this._tintRGB=(value>>16)+(65280&value)+((255&value)<<16),this._colorDirty=!0)},enumerable:!1,configurable:!0}),MeshMaterial.prototype.update=function(){if(this._colorDirty){this._colorDirty=!1;var baseTexture=this.texture.baseTexture;premultiplyTintToRgba(this._tint,this._alpha,this.uniforms.uColor,baseTexture.alphaMode)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)},MeshMaterial}(Shader),MeshGeometry=function(_super){function MeshGeometry(vertices,uvs,index){var _this=_super.call(this)||this,verticesBuffer=new Buffer(vertices),uvsBuffer=new Buffer(uvs,!0),indexBuffer=new Buffer(index,!0,!0);return _this.addAttribute("aVertexPosition",verticesBuffer,2,!1,constants_TYPES.FLOAT).addAttribute("aTextureCoord",uvsBuffer,2,!1,constants_TYPES.FLOAT).addIndex(indexBuffer),_this._updateId=-1,_this}return mesh_extends(MeshGeometry,_super),Object.defineProperty(MeshGeometry.prototype,"vertexDirtyId",{get:function(){return this.buffers[0]._updateID},enumerable:!1,configurable:!0}),MeshGeometry}(Geometry),text_bitmap_extendStatics=function(d,b){return text_bitmap_extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])},text_bitmap_extendStatics(d,b)};var BitmapFontData=function(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[],this.distanceField=[]},TextFormat=function(){function TextFormat(){}return TextFormat.test=function(data){return"string"==typeof data&&0===data.indexOf("info face=")},TextFormat.parse=function(txt){var items=txt.match(/^[a-z]+\s+.+$/gm),rawData={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(var i in items){var name=items[i].match(/^[a-z]+/gm)[0],attributeList=items[i].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),itemData={};for(var i_1 in attributeList){var split=attributeList[i_1].split("="),key=split[0],strValue=split[1].replace(/"/gm,""),floatValue=parseFloat(strValue),value=isNaN(floatValue)?strValue:floatValue;itemData[key]=value}rawData[name].push(itemData)}var font=new BitmapFontData;return rawData.info.forEach((function(info){return font.info.push({face:info.face,size:parseInt(info.size,10)})})),rawData.common.forEach((function(common){return font.common.push({lineHeight:parseInt(common.lineHeight,10)})})),rawData.page.forEach((function(page){return font.page.push({id:parseInt(page.id,10),file:page.file})})),rawData.char.forEach((function(char){return font.char.push({id:parseInt(char.id,10),page:parseInt(char.page,10),x:parseInt(char.x,10),y:parseInt(char.y,10),width:parseInt(char.width,10),height:parseInt(char.height,10),xoffset:parseInt(char.xoffset,10),yoffset:parseInt(char.yoffset,10),xadvance:parseInt(char.xadvance,10)})})),rawData.kerning.forEach((function(kerning){return font.kerning.push({first:parseInt(kerning.first,10),second:parseInt(kerning.second,10),amount:parseInt(kerning.amount,10)})})),rawData.distanceField.forEach((function(df){return font.distanceField.push({distanceRange:parseInt(df.distanceRange,10),fieldType:df.fieldType})})),font},TextFormat}(),XMLFormat=function(){function XMLFormat(){}return XMLFormat.test=function(data){return data instanceof XMLDocument&&data.getElementsByTagName("page").length&&null!==data.getElementsByTagName("info")[0].getAttribute("face")},XMLFormat.parse=function(xml){for(var data=new BitmapFontData,info=xml.getElementsByTagName("info"),common=xml.getElementsByTagName("common"),page=xml.getElementsByTagName("page"),char=xml.getElementsByTagName("char"),kerning=xml.getElementsByTagName("kerning"),distanceField=xml.getElementsByTagName("distanceField"),i=0;i<info.length;i++)data.info.push({face:info[i].getAttribute("face"),size:parseInt(info[i].getAttribute("size"),10)});for(i=0;i<common.length;i++)data.common.push({lineHeight:parseInt(common[i].getAttribute("lineHeight"),10)});for(i=0;i<page.length;i++)data.page.push({id:parseInt(page[i].getAttribute("id"),10)||0,file:page[i].getAttribute("file")});for(i=0;i<char.length;i++){var letter=char[i];data.char.push({id:parseInt(letter.getAttribute("id"),10),page:parseInt(letter.getAttribute("page"),10)||0,x:parseInt(letter.getAttribute("x"),10),y:parseInt(letter.getAttribute("y"),10),width:parseInt(letter.getAttribute("width"),10),height:parseInt(letter.getAttribute("height"),10),xoffset:parseInt(letter.getAttribute("xoffset"),10),yoffset:parseInt(letter.getAttribute("yoffset"),10),xadvance:parseInt(letter.getAttribute("xadvance"),10)})}for(i=0;i<kerning.length;i++)data.kerning.push({first:parseInt(kerning[i].getAttribute("first"),10),second:parseInt(kerning[i].getAttribute("second"),10),amount:parseInt(kerning[i].getAttribute("amount"),10)});for(i=0;i<distanceField.length;i++)data.distanceField.push({fieldType:distanceField[i].getAttribute("fieldType"),distanceRange:parseInt(distanceField[i].getAttribute("distanceRange"),10)});return data},XMLFormat}(),XMLStringFormat=function(){function XMLStringFormat(){}return XMLStringFormat.test=function(data){if("string"==typeof data&&data.indexOf("<font>")>-1){var xml=(new globalThis.DOMParser).parseFromString(data,"text/xml");return XMLFormat.test(xml)}return!1},XMLStringFormat.parse=function(xmlTxt){var xml=(new globalThis.DOMParser).parseFromString(xmlTxt,"text/xml");return XMLFormat.parse(xml)},XMLStringFormat}(),formats=[TextFormat,XMLFormat,XMLStringFormat];function autoDetectFormat(data){for(var i=0;i<formats.length;i++)if(formats[i].test(data))return formats[i];return null}function drawGlyph(canvas,context,metrics,x,y,resolution,style){var char=metrics.text,fontProperties=metrics.fontProperties;context.translate(x,y),context.scale(resolution,resolution);var tx=style.strokeThickness/2,ty=-style.strokeThickness/2;if(context.font=style.toFontString(),context.lineWidth=style.strokeThickness,context.textBaseline=style.textBaseline,context.lineJoin=style.lineJoin,context.miterLimit=style.miterLimit,context.fillStyle=function(canvas,context,style,resolution,lines,metrics){var gradient,fillStyle=style.fill;if(!Array.isArray(fillStyle))return fillStyle;if(1===fillStyle.length)return fillStyle[0];var dropShadowCorrection=style.dropShadow?style.dropShadowDistance:0,padding=style.padding||0,width=canvas.width/resolution-dropShadowCorrection-2*padding,height=canvas.height/resolution-dropShadowCorrection-2*padding,fill=fillStyle.slice(),fillGradientStops=style.fillGradientStops.slice();if(!fillGradientStops.length)for(var lengthPlus1=fill.length+1,i=1;i<lengthPlus1;++i)fillGradientStops.push(i/lengthPlus1);if(fill.unshift(fillStyle[0]),fillGradientStops.unshift(0),fill.push(fillStyle[fillStyle.length-1]),fillGradientStops.push(1),style.fillGradientType===TEXT_GRADIENT.LINEAR_VERTICAL){gradient=context.createLinearGradient(width/2,padding,width/2,height+padding);var lastIterationStop=0,gradStopLineHeight=(metrics.fontProperties.fontSize+style.strokeThickness)/height;for(i=0;i<lines.length;i++)for(var thisLineTop=metrics.lineHeight*i,j=0;j<fill.length;j++){var globalStop=thisLineTop/height+("number"==typeof fillGradientStops[j]?fillGradientStops[j]:j/fill.length)*gradStopLineHeight,clampedStop=Math.max(lastIterationStop,globalStop);clampedStop=Math.min(clampedStop,1),gradient.addColorStop(clampedStop,fill[j]),lastIterationStop=clampedStop}}else{gradient=context.createLinearGradient(padding,height/2,width+padding,height/2);var totalIterations=fill.length+1,currentIteration=1;for(i=0;i<fill.length;i++){var stop=void 0;stop="number"==typeof fillGradientStops[i]?fillGradientStops[i]:currentIteration/totalIterations,gradient.addColorStop(stop,fill[i]),currentIteration++}}return gradient}(canvas,context,style,resolution,[char],metrics),context.strokeStyle=style.stroke,style.dropShadow){var dropShadowColor=style.dropShadowColor,rgb=hex2rgb("number"==typeof dropShadowColor?dropShadowColor:string2hex(dropShadowColor)),dropShadowBlur=style.dropShadowBlur*resolution,dropShadowDistance=style.dropShadowDistance*resolution;context.shadowColor="rgba("+255*rgb[0]+","+255*rgb[1]+","+255*rgb[2]+","+style.dropShadowAlpha+")",context.shadowBlur=dropShadowBlur,context.shadowOffsetX=Math.cos(style.dropShadowAngle)*dropShadowDistance,context.shadowOffsetY=Math.sin(style.dropShadowAngle)*dropShadowDistance}else context.shadowColor="black",context.shadowBlur=0,context.shadowOffsetX=0,context.shadowOffsetY=0;style.stroke&&style.strokeThickness&&context.strokeText(char,tx,ty+metrics.lineHeight-fontProperties.descent),style.fill&&context.fillText(char,tx,ty+metrics.lineHeight-fontProperties.descent),context.setTransform(1,0,0,1,0,0),context.fillStyle="rgba(0, 0, 0, 0)"}function splitTextToCharacters(text){return Array.from?Array.from(text):text.split("")}function extractCharCode(str){return str.codePointAt?str.codePointAt(0):str.charCodeAt(0)}var BitmapFont=function(){function BitmapFont(data,textures,ownsTextures){var _a,_b,info=data.info[0],common=data.common[0],page=data.page[0],distanceField=data.distanceField[0],res=getResolutionOfUrl(page.file),pageTextures={};this._ownsTextures=ownsTextures,this.font=info.face,this.size=info.size,this.lineHeight=common.lineHeight/res,this.chars={},this.pageTextures=pageTextures;for(var i=0;i<data.page.length;i++){var _c=data.page[i],id=_c.id,file=_c.file;pageTextures[id]=textures instanceof Array?textures[i]:textures[file],(null==distanceField?void 0:distanceField.fieldType)&&"none"!==distanceField.fieldType&&(pageTextures[id].baseTexture.alphaMode=constants_ALPHA_MODES.NO_PREMULTIPLIED_ALPHA)}for(i=0;i<data.char.length;i++){var _d=data.char[i],page_1=(id=_d.id,_d.page),_e=data.char[i],x=_e.x,y=_e.y,width=_e.width,height=_e.height,xoffset=_e.xoffset,yoffset=_e.yoffset,xadvance=_e.xadvance;y/=res,width/=res,height/=res,xoffset/=res,yoffset/=res,xadvance/=res;var rect=new Rectangle((x/=res)+pageTextures[page_1].frame.x/res,y+pageTextures[page_1].frame.y/res,width,height);this.chars[id]={xOffset:xoffset,yOffset:yoffset,xAdvance:xadvance,kerning:{},texture:new Texture(pageTextures[page_1].baseTexture,rect),page:page_1}}for(i=0;i<data.kerning.length;i++){var _f=data.kerning[i],first=_f.first,second=_f.second,amount=_f.amount;first/=res,second/=res,amount/=res,this.chars[second]&&(this.chars[second].kerning[first]=amount)}this.distanceFieldRange=null==distanceField?void 0:distanceField.distanceRange,this.distanceFieldType=null!==(_b=null===(_a=null==distanceField?void 0:distanceField.fieldType)||void 0===_a?void 0:_a.toLowerCase())&&void 0!==_b?_b:"none"}return BitmapFont.prototype.destroy=function(){for(var id in this.chars)this.chars[id].texture.destroy(),this.chars[id].texture=null;for(var id in this.pageTextures)this._ownsTextures&&this.pageTextures[id].destroy(!0),this.pageTextures[id]=null;this.chars=null,this.pageTextures=null},BitmapFont.install=function(data,textures,ownsTextures){var fontData;if(data instanceof BitmapFontData)fontData=data;else{var format=autoDetectFormat(data);if(!format)throw new Error("Unrecognized data format for font.");fontData=format.parse(data)}textures instanceof Texture&&(textures=[textures]);var font=new BitmapFont(fontData,textures,ownsTextures);return BitmapFont.available[font.font]=font,font},BitmapFont.uninstall=function(name){var font=BitmapFont.available[name];if(!font)throw new Error("No font found named '"+name+"'");font.destroy(),delete BitmapFont.available[name]},BitmapFont.from=function(name,textStyle,options){if(!name)throw new Error("[BitmapFont] Property `name` is required.");var _a=Object.assign({},BitmapFont.defaultOptions,options),chars=_a.chars,padding=_a.padding,resolution=_a.resolution,textureWidth=_a.textureWidth,textureHeight=_a.textureHeight,charsList=function(chars){"string"==typeof chars&&(chars=[chars]);for(var result=[],i=0,j=chars.length;i<j;i++){var item=chars[i];if(Array.isArray(item)){if(2!==item.length)throw new Error("[BitmapFont]: Invalid character range length, expecting 2 got "+item.length+".");var startCode=item[0].charCodeAt(0),endCode=item[1].charCodeAt(0);if(endCode<startCode)throw new Error("[BitmapFont]: Invalid character range.");for(var i_1=startCode,j_1=endCode;i_1<=j_1;i_1++)result.push(String.fromCharCode(i_1))}else result.push.apply(result,splitTextToCharacters(item))}if(0===result.length)throw new Error("[BitmapFont]: Empty set when resolving characters.");return result}(chars),style=textStyle instanceof TextStyle?textStyle:new TextStyle(textStyle),lineWidth=textureWidth,fontData=new BitmapFontData;fontData.info[0]={face:style.fontFamily,size:style.fontSize},fontData.common[0]={lineHeight:style.fontSize};for(var canvas,context,baseTexture,positionX=0,positionY=0,maxCharHeight=0,textures=[],i=0;i<charsList.length;i++){canvas||((canvas=document.createElement("canvas")).width=textureWidth,canvas.height=textureHeight,context=canvas.getContext("2d"),baseTexture=new BaseTexture(canvas,{resolution}),textures.push(new Texture(baseTexture)),fontData.page.push({id:textures.length-1,file:""}));var metrics=TextMetrics.measureText(charsList[i],style,!1,canvas),width=metrics.width,height=Math.ceil(metrics.height),textureGlyphWidth=Math.ceil(("italic"===style.fontStyle?2:1)*width);if(positionY>=textureHeight-height*resolution){if(0===positionY)throw new Error("[BitmapFont] textureHeight "+textureHeight+"px is too small for "+style.fontSize+"px fonts");--i,canvas=null,context=null,baseTexture=null,positionY=0,positionX=0,maxCharHeight=0}else if(maxCharHeight=Math.max(height+metrics.fontProperties.descent,maxCharHeight),textureGlyphWidth*resolution+positionX>=lineWidth)--i,positionY+=maxCharHeight*resolution,positionY=Math.ceil(positionY),positionX=0,maxCharHeight=0;else{drawGlyph(canvas,context,metrics,positionX,positionY,resolution,style);var id=extractCharCode(metrics.text);fontData.char.push({id,page:textures.length-1,x:positionX/resolution,y:positionY/resolution,width:textureGlyphWidth,height,xoffset:0,yoffset:0,xadvance:Math.ceil(width-(style.dropShadow?style.dropShadowDistance:0)-(style.stroke?style.strokeThickness:0))}),positionX+=(textureGlyphWidth+2*padding)*resolution,positionX=Math.ceil(positionX)}}i=0;for(var len=charsList.length;i<len;i++)for(var first=charsList[i],j=0;j<len;j++){var second=charsList[j],c1=context.measureText(first).width,c2=context.measureText(second).width,amount=context.measureText(first+second).width-(c1+c2);amount&&fontData.kerning.push({first:extractCharCode(first),second:extractCharCode(second),amount})}var font=new BitmapFont(fontData,textures,!0);return void 0!==BitmapFont.available[name]&&BitmapFont.uninstall(name),BitmapFont.available[name]=font,font},BitmapFont.ALPHA=[["a","z"],["A","Z"]," "],BitmapFont.NUMERIC=[["0","9"]],BitmapFont.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],BitmapFont.ASCII=[[" ","~"]],BitmapFont.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:BitmapFont.ALPHANUMERIC},BitmapFont.available={},BitmapFont}(),pageMeshDataDefaultPageMeshData=[],pageMeshDataMSDFPageMeshData=[],charRenderDataPool=[],BitmapFontLoader=(function(_super){function BitmapText(text,style){void 0===style&&(style={});var _this=_super.call(this)||this;_this._tint=16777215;var _a=Object.assign({},BitmapText.styleDefaults,style),align=_a.align,tint=_a.tint,maxWidth=_a.maxWidth,letterSpacing=_a.letterSpacing,fontName=_a.fontName,fontSize=_a.fontSize;if(!BitmapFont.available[fontName])throw new Error('Missing BitmapFont "'+fontName+'"');return _this._activePagesMeshData=[],_this._textWidth=0,_this._textHeight=0,_this._align=align,_this._tint=tint,_this._fontName=fontName,_this._fontSize=fontSize||BitmapFont.available[fontName].size,_this._text=text,_this._maxWidth=maxWidth,_this._maxLineHeight=0,_this._letterSpacing=letterSpacing,_this._anchor=new ObservablePoint((function(){_this.dirty=!0}),_this,0,0),_this._roundPixels=settings.ROUND_PIXELS,_this.dirty=!0,_this._textureCache={},_this}(function(d,b){function __(){this.constructor=d}text_bitmap_extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)})(BitmapText,_super),BitmapText.prototype.updateText=function(){for(var _a,data=BitmapFont.available[this._fontName],scale=this._fontSize/data.size,pos=new Point,chars=[],lineWidths=[],lineSpaces=[],charsInput=splitTextToCharacters(this._text.replace(/(?:\r\n|\r)/g,"\n")||" "),maxWidth=this._maxWidth*data.size/this._fontSize,pageMeshDataPool="none"===data.distanceFieldType?pageMeshDataDefaultPageMeshData:pageMeshDataMSDFPageMeshData,prevCharCode=null,lastLineWidth=0,maxLineWidth=0,line=0,lastBreakPos=-1,lastBreakWidth=0,spacesRemoved=0,maxLineHeight=0,spaceCount=0,i=0;i<charsInput.length;i++){var charCode=extractCharCode(char=charsInput[i]);if(/(?:\s)/.test(char)&&(lastBreakPos=i,lastBreakWidth=lastLineWidth,spaceCount++),"\r"!==char&&"\n"!==char){var charData=data.chars[charCode];if(charData){prevCharCode&&charData.kerning[prevCharCode]&&(pos.x+=charData.kerning[prevCharCode]);var charRenderData=charRenderDataPool.pop()||{texture:Texture.EMPTY,line:0,charCode:0,prevSpaces:0,position:new Point};charRenderData.texture=charData.texture,charRenderData.line=line,charRenderData.charCode=charCode,charRenderData.position.x=pos.x+charData.xOffset+this._letterSpacing/2,charRenderData.position.y=pos.y+charData.yOffset,charRenderData.prevSpaces=spaceCount,chars.push(charRenderData),lastLineWidth=charRenderData.position.x+Math.max(charData.xAdvance,charData.texture.orig.width),pos.x+=charData.xAdvance+this._letterSpacing,maxLineHeight=Math.max(maxLineHeight,charData.yOffset+charData.texture.height),prevCharCode=charCode,-1!==lastBreakPos&&maxWidth>0&&pos.x>maxWidth&&(removeItems(chars,1+lastBreakPos-++spacesRemoved,1+i-lastBreakPos),i=lastBreakPos,lastBreakPos=-1,lineWidths.push(lastBreakWidth),lineSpaces.push(chars.length>0?chars[chars.length-1].prevSpaces:0),maxLineWidth=Math.max(maxLineWidth,lastBreakWidth),line++,pos.x=0,pos.y+=data.lineHeight,prevCharCode=null,spaceCount=0)}}else lineWidths.push(lastLineWidth),lineSpaces.push(-1),maxLineWidth=Math.max(maxLineWidth,lastLineWidth),++line,++spacesRemoved,pos.x=0,pos.y+=data.lineHeight,prevCharCode=null,spaceCount=0}var lastChar=charsInput[charsInput.length-1];"\r"!==lastChar&&"\n"!==lastChar&&(/(?:\s)/.test(lastChar)&&(lastLineWidth=lastBreakWidth),lineWidths.push(lastLineWidth),maxLineWidth=Math.max(maxLineWidth,lastLineWidth),lineSpaces.push(-1));var lineAlignOffsets=[];for(i=0;i<=line;i++){var alignOffset=0;"right"===this._align?alignOffset=maxLineWidth-lineWidths[i]:"center"===this._align?alignOffset=(maxLineWidth-lineWidths[i])/2:"justify"===this._align&&(alignOffset=lineSpaces[i]<0?0:(maxLineWidth-lineWidths[i])/lineSpaces[i]),lineAlignOffsets.push(alignOffset)}var lenChars=chars.length,pagesMeshData={},newPagesMeshData=[],activePagesMeshData=this._activePagesMeshData;for(i=0;i<activePagesMeshData.length;i++)pageMeshDataPool.push(activePagesMeshData[i]);for(i=0;i<lenChars;i++){var baseTextureUid=(texture=chars[i].texture).baseTexture.uid;if(!pagesMeshData[baseTextureUid]){if(!(pageMeshData=pageMeshDataPool.pop())){var geometry=new MeshGeometry,material=void 0,meshBlendMode=void 0;"none"===data.distanceFieldType?(material=new MeshMaterial(Texture.EMPTY),meshBlendMode=constants_BLEND_MODES.NORMAL):(material=new MeshMaterial(Texture.EMPTY,{program:Program.from("// Mesh material default fragment\r\nattribute vec2 aVertexPosition;\r\nattribute vec2 aTextureCoord;\r\n\r\nuniform mat3 projectionMatrix;\r\nuniform mat3 translationMatrix;\r\nuniform mat3 uTextureMatrix;\r\n\r\nvarying vec2 vTextureCoord;\r\n\r\nvoid main(void)\r\n{\r\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r\n\r\n    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\r\n}\r\n","// Pixi texture info\r\nvarying vec2 vTextureCoord;\r\nuniform sampler2D uSampler;\r\n\r\n// Tint\r\nuniform vec4 uColor;\r\n\r\n// on 2D applications fwidth is screenScale / glyphAtlasScale * distanceFieldRange\r\nuniform float uFWidth;\r\n\r\nvoid main(void) {\r\n\r\n  // To stack MSDF and SDF we need a non-pre-multiplied-alpha texture.\r\n  vec4 texColor = texture2D(uSampler, vTextureCoord);\r\n\r\n  // MSDF\r\n  float median = texColor.r + texColor.g + texColor.b -\r\n                  min(texColor.r, min(texColor.g, texColor.b)) -\r\n                  max(texColor.r, max(texColor.g, texColor.b));\r\n  // SDF\r\n  median = min(median, texColor.a);\r\n\r\n  float screenPxDistance = uFWidth * (median - 0.5);\r\n  float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\r\n\r\n  // NPM Textures, NPM outputs\r\n  gl_FragColor = vec4(uColor.rgb, uColor.a * alpha);\r\n\r\n}\r\n"),uniforms:{uFWidth:0}}),meshBlendMode=constants_BLEND_MODES.NORMAL_NPM);var mesh=new Mesh(geometry,material);mesh.blendMode=meshBlendMode,pageMeshData={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh,vertices:null,uvs:null,indices:null}}pageMeshData.index=0,pageMeshData.indexCount=0,pageMeshData.vertexCount=0,pageMeshData.uvsCount=0,pageMeshData.total=0;var _textureCache=this._textureCache;_textureCache[baseTextureUid]=_textureCache[baseTextureUid]||new Texture(texture.baseTexture),pageMeshData.mesh.texture=_textureCache[baseTextureUid],pageMeshData.mesh.tint=this._tint,newPagesMeshData.push(pageMeshData),pagesMeshData[baseTextureUid]=pageMeshData}pagesMeshData[baseTextureUid].total++}for(i=0;i<activePagesMeshData.length;i++)-1===newPagesMeshData.indexOf(activePagesMeshData[i])&&this.removeChild(activePagesMeshData[i].mesh);for(i=0;i<newPagesMeshData.length;i++)newPagesMeshData[i].mesh.parent!==this&&this.addChild(newPagesMeshData[i].mesh);for(var i in this._activePagesMeshData=newPagesMeshData,pagesMeshData){var total=(pageMeshData=pagesMeshData[i]).total;if(!((null===(_a=pageMeshData.indices)||void 0===_a?void 0:_a.length)>6*total)||pageMeshData.vertices.length<2*Mesh.BATCHABLE_SIZE)pageMeshData.vertices=new Float32Array(8*total),pageMeshData.uvs=new Float32Array(8*total),pageMeshData.indices=new Uint16Array(6*total);else for(var total_1=pageMeshData.total,vertices=pageMeshData.vertices,i_1=4*total_1*2;i_1<vertices.length;i_1++)vertices[i_1]=0;pageMeshData.mesh.size=6*total}for(i=0;i<lenChars;i++){var char,offset=(char=chars[i]).position.x+lineAlignOffsets[char.line]*("justify"===this._align?char.prevSpaces:1);this._roundPixels&&(offset=Math.round(offset));var texture,xPos=offset*scale,yPos=char.position.y*scale,pageMesh=pagesMeshData[(texture=char.texture).baseTexture.uid],textureFrame=texture.frame,textureUvs=texture._uvs,index=pageMesh.index++;pageMesh.indices[6*index+0]=0+4*index,pageMesh.indices[6*index+1]=1+4*index,pageMesh.indices[6*index+2]=2+4*index,pageMesh.indices[6*index+3]=0+4*index,pageMesh.indices[6*index+4]=2+4*index,pageMesh.indices[6*index+5]=3+4*index,pageMesh.vertices[8*index+0]=xPos,pageMesh.vertices[8*index+1]=yPos,pageMesh.vertices[8*index+2]=xPos+textureFrame.width*scale,pageMesh.vertices[8*index+3]=yPos,pageMesh.vertices[8*index+4]=xPos+textureFrame.width*scale,pageMesh.vertices[8*index+5]=yPos+textureFrame.height*scale,pageMesh.vertices[8*index+6]=xPos,pageMesh.vertices[8*index+7]=yPos+textureFrame.height*scale,pageMesh.uvs[8*index+0]=textureUvs.x0,pageMesh.uvs[8*index+1]=textureUvs.y0,pageMesh.uvs[8*index+2]=textureUvs.x1,pageMesh.uvs[8*index+3]=textureUvs.y1,pageMesh.uvs[8*index+4]=textureUvs.x2,pageMesh.uvs[8*index+5]=textureUvs.y2,pageMesh.uvs[8*index+6]=textureUvs.x3,pageMesh.uvs[8*index+7]=textureUvs.y3}for(var i in this._textWidth=maxLineWidth*scale,this._textHeight=(pos.y+data.lineHeight)*scale,pagesMeshData){var pageMeshData=pagesMeshData[i];if(0!==this.anchor.x||0!==this.anchor.y)for(var vertexCount=0,anchorOffsetX=this._textWidth*this.anchor.x,anchorOffsetY=this._textHeight*this.anchor.y,i_2=0;i_2<pageMeshData.total;i_2++)pageMeshData.vertices[vertexCount++]-=anchorOffsetX,pageMeshData.vertices[vertexCount++]-=anchorOffsetY,pageMeshData.vertices[vertexCount++]-=anchorOffsetX,pageMeshData.vertices[vertexCount++]-=anchorOffsetY,pageMeshData.vertices[vertexCount++]-=anchorOffsetX,pageMeshData.vertices[vertexCount++]-=anchorOffsetY,pageMeshData.vertices[vertexCount++]-=anchorOffsetX,pageMeshData.vertices[vertexCount++]-=anchorOffsetY;this._maxLineHeight=maxLineHeight*scale;var vertexBuffer=pageMeshData.mesh.geometry.getBuffer("aVertexPosition"),textureBuffer=pageMeshData.mesh.geometry.getBuffer("aTextureCoord"),indexBuffer=pageMeshData.mesh.geometry.getIndex();vertexBuffer.data=pageMeshData.vertices,textureBuffer.data=pageMeshData.uvs,indexBuffer.data=pageMeshData.indices,vertexBuffer.update(),textureBuffer.update(),indexBuffer.update()}for(i=0;i<chars.length;i++)charRenderDataPool.push(chars[i])},BitmapText.prototype.updateTransform=function(){this.validate(),this.containerUpdateTransform()},BitmapText.prototype._render=function(renderer){var _a=BitmapFont.available[this._fontName],distanceFieldRange=_a.distanceFieldRange,distanceFieldType=_a.distanceFieldType,size=_a.size;if("none"!==distanceFieldType)for(var _b=this.worldTransform,a=_b.a,b=_b.b,c=_b.c,d=_b.d,dx=Math.sqrt(a*a+b*b),dy=Math.sqrt(c*c+d*d),worldScale=(Math.abs(dx)+Math.abs(dy))/2,fontScale=this._fontSize/size,_i=0,_c=this._activePagesMeshData;_i<_c.length;_i++){_c[_i].mesh.shader.uniforms.uFWidth=worldScale*distanceFieldRange*fontScale*renderer.resolution}_super.prototype._render.call(this,renderer)},BitmapText.prototype.getLocalBounds=function(){return this.validate(),_super.prototype.getLocalBounds.call(this)},BitmapText.prototype.validate=function(){this.dirty&&(this.updateText(),this.dirty=!1)},Object.defineProperty(BitmapText.prototype,"tint",{get:function(){return this._tint},set:function(value){if(this._tint!==value){this._tint=value;for(var i=0;i<this._activePagesMeshData.length;i++)this._activePagesMeshData[i].mesh.tint=value}},enumerable:!1,configurable:!0}),Object.defineProperty(BitmapText.prototype,"align",{get:function(){return this._align},set:function(value){this._align!==value&&(this._align=value,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(BitmapText.prototype,"fontName",{get:function(){return this._fontName},set:function(value){if(!BitmapFont.available[value])throw new Error('Missing BitmapFont "'+value+'"');this._fontName!==value&&(this._fontName=value,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(BitmapText.prototype,"fontSize",{get:function(){return this._fontSize},set:function(value){this._fontSize!==value&&(this._fontSize=value,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(BitmapText.prototype,"anchor",{get:function(){return this._anchor},set:function(value){"number"==typeof value?this._anchor.set(value):this._anchor.copyFrom(value)},enumerable:!1,configurable:!0}),Object.defineProperty(BitmapText.prototype,"text",{get:function(){return this._text},set:function(text){text=String(null==text?"":text),this._text!==text&&(this._text=text,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(BitmapText.prototype,"maxWidth",{get:function(){return this._maxWidth},set:function(value){this._maxWidth!==value&&(this._maxWidth=value,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(BitmapText.prototype,"maxLineHeight",{get:function(){return this.validate(),this._maxLineHeight},enumerable:!1,configurable:!0}),Object.defineProperty(BitmapText.prototype,"textWidth",{get:function(){return this.validate(),this._textWidth},enumerable:!1,configurable:!0}),Object.defineProperty(BitmapText.prototype,"letterSpacing",{get:function(){return this._letterSpacing},set:function(value){this._letterSpacing!==value&&(this._letterSpacing=value,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(BitmapText.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(value){value!==this._roundPixels&&(this._roundPixels=value,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(BitmapText.prototype,"textHeight",{get:function(){return this.validate(),this._textHeight},enumerable:!1,configurable:!0}),BitmapText.prototype.destroy=function(options){var _textureCache=this._textureCache;for(var id in _textureCache){_textureCache[id].destroy(),delete _textureCache[id]}this._textureCache=null,_super.prototype.destroy.call(this,options)},BitmapText.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0}}(Container),function(){function BitmapFontLoader(){}return BitmapFontLoader.add=function(){LoaderResource.setExtensionXhrType("fnt",LoaderResource.XHR_RESPONSE_TYPE.TEXT)},BitmapFontLoader.use=function(resource,next){var format=autoDetectFormat(resource.data);if(format)for(var baseUrl=BitmapFontLoader.getBaseUrl(this,resource),data=format.parse(resource.data),textures={},completed=function(page){textures[page.metadata.pageFile]=page.texture,Object.keys(textures).length===data.page.length&&(resource.bitmapFont=BitmapFont.install(data,textures,!0),next())},i=0;i<data.page.length;++i){var pageFile=data.page[i].file,url=baseUrl+pageFile,exists=!1;for(var name in this.resources){var bitmapResource=this.resources[name];if(bitmapResource.url===url){bitmapResource.metadata.pageFile=pageFile,bitmapResource.texture?completed(bitmapResource):bitmapResource.onAfterMiddleware.add(completed),exists=!0;break}}if(!exists){var options={crossOrigin:resource.crossOrigin,loadType:LoaderResource.LOAD_TYPE.IMAGE,metadata:Object.assign({pageFile},resource.metadata.imageMetadata),parentResource:resource};this.add(url,options,completed)}}else next()},BitmapFontLoader.getBaseUrl=function(loader,resource){var resUrl=resource.isDataUrl?"":BitmapFontLoader.dirname(resource.url);return resource.isDataUrl&&("."===resUrl&&(resUrl=""),loader.baseUrl&&resUrl&&"/"===loader.baseUrl.charAt(loader.baseUrl.length-1)&&(resUrl+="/")),(resUrl=resUrl.replace(loader.baseUrl,""))&&"/"!==resUrl.charAt(resUrl.length-1)&&(resUrl+="/"),resUrl},BitmapFontLoader.dirname=function(url){var dir=url.replace(/\\/g,"/").replace(/\/$/,"").replace(/\/[^\/]*$/,"");return dir===url?".":""===dir?"/":dir},BitmapFontLoader}()),filter_alpha_extendStatics=function(d,b){return filter_alpha_extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])},filter_alpha_extendStatics(d,b)};!function(_super){function AlphaFilter(alpha){void 0===alpha&&(alpha=1);var _this=_super.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float uAlpha;\n\nvoid main(void)\n{\n   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;\n}\n",{uAlpha:1})||this;return _this.alpha=alpha,_this}(function(d,b){function __(){this.constructor=d}filter_alpha_extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)})(AlphaFilter,_super),Object.defineProperty(AlphaFilter.prototype,"alpha",{get:function(){return this.uniforms.uAlpha},set:function(value){this.uniforms.uAlpha=value},enumerable:!1,configurable:!0})}(Filter);var filter_blur_extendStatics=function(d,b){return filter_blur_extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])},filter_blur_extendStatics(d,b)};function filter_blur_extends(d,b){function __(){this.constructor=d}filter_blur_extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}var filter_blur_ENV,filter_blur_RENDERER_TYPE,filter_blur_BUFFER_BITS,filter_blur_BLEND_MODES,filter_blur_DRAW_MODES,filter_blur_FORMATS,filter_blur_TARGETS,filter_blur_TYPES,filter_blur_SAMPLER_TYPES,filter_blur_SCALE_MODES,filter_blur_WRAP_MODES,filter_blur_MIPMAP_MODES,filter_blur_ALPHA_MODES,filter_blur_CLEAR_MODES,filter_blur_GC_MODES,filter_blur_PRECISION,filter_blur_MASK_TYPES,filter_blur_MSAA_QUALITY,filter_blur_BUFFER_TYPE,GAUSSIAN_VALUES={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},filter_blur_fragTemplate=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join("\n");!function(ENV){ENV[ENV.WEBGL_LEGACY=0]="WEBGL_LEGACY",ENV[ENV.WEBGL=1]="WEBGL",ENV[ENV.WEBGL2=2]="WEBGL2"}(filter_blur_ENV||(filter_blur_ENV={})),function(RENDERER_TYPE){RENDERER_TYPE[RENDERER_TYPE.UNKNOWN=0]="UNKNOWN",RENDERER_TYPE[RENDERER_TYPE.WEBGL=1]="WEBGL",RENDERER_TYPE[RENDERER_TYPE.CANVAS=2]="CANVAS"}(filter_blur_RENDERER_TYPE||(filter_blur_RENDERER_TYPE={})),function(BUFFER_BITS){BUFFER_BITS[BUFFER_BITS.COLOR=16384]="COLOR",BUFFER_BITS[BUFFER_BITS.DEPTH=256]="DEPTH",BUFFER_BITS[BUFFER_BITS.STENCIL=1024]="STENCIL"}(filter_blur_BUFFER_BITS||(filter_blur_BUFFER_BITS={})),function(BLEND_MODES){BLEND_MODES[BLEND_MODES.NORMAL=0]="NORMAL",BLEND_MODES[BLEND_MODES.ADD=1]="ADD",BLEND_MODES[BLEND_MODES.MULTIPLY=2]="MULTIPLY",BLEND_MODES[BLEND_MODES.SCREEN=3]="SCREEN",BLEND_MODES[BLEND_MODES.OVERLAY=4]="OVERLAY",BLEND_MODES[BLEND_MODES.DARKEN=5]="DARKEN",BLEND_MODES[BLEND_MODES.LIGHTEN=6]="LIGHTEN",BLEND_MODES[BLEND_MODES.COLOR_DODGE=7]="COLOR_DODGE",BLEND_MODES[BLEND_MODES.COLOR_BURN=8]="COLOR_BURN",BLEND_MODES[BLEND_MODES.HARD_LIGHT=9]="HARD_LIGHT",BLEND_MODES[BLEND_MODES.SOFT_LIGHT=10]="SOFT_LIGHT",BLEND_MODES[BLEND_MODES.DIFFERENCE=11]="DIFFERENCE",BLEND_MODES[BLEND_MODES.EXCLUSION=12]="EXCLUSION",BLEND_MODES[BLEND_MODES.HUE=13]="HUE",BLEND_MODES[BLEND_MODES.SATURATION=14]="SATURATION",BLEND_MODES[BLEND_MODES.COLOR=15]="COLOR",BLEND_MODES[BLEND_MODES.LUMINOSITY=16]="LUMINOSITY",BLEND_MODES[BLEND_MODES.NORMAL_NPM=17]="NORMAL_NPM",BLEND_MODES[BLEND_MODES.ADD_NPM=18]="ADD_NPM",BLEND_MODES[BLEND_MODES.SCREEN_NPM=19]="SCREEN_NPM",BLEND_MODES[BLEND_MODES.NONE=20]="NONE",BLEND_MODES[BLEND_MODES.SRC_OVER=0]="SRC_OVER",BLEND_MODES[BLEND_MODES.SRC_IN=21]="SRC_IN",BLEND_MODES[BLEND_MODES.SRC_OUT=22]="SRC_OUT",BLEND_MODES[BLEND_MODES.SRC_ATOP=23]="SRC_ATOP",BLEND_MODES[BLEND_MODES.DST_OVER=24]="DST_OVER",BLEND_MODES[BLEND_MODES.DST_IN=25]="DST_IN",BLEND_MODES[BLEND_MODES.DST_OUT=26]="DST_OUT",BLEND_MODES[BLEND_MODES.DST_ATOP=27]="DST_ATOP",BLEND_MODES[BLEND_MODES.ERASE=26]="ERASE",BLEND_MODES[BLEND_MODES.SUBTRACT=28]="SUBTRACT",BLEND_MODES[BLEND_MODES.XOR=29]="XOR"}(filter_blur_BLEND_MODES||(filter_blur_BLEND_MODES={})),function(DRAW_MODES){DRAW_MODES[DRAW_MODES.POINTS=0]="POINTS",DRAW_MODES[DRAW_MODES.LINES=1]="LINES",DRAW_MODES[DRAW_MODES.LINE_LOOP=2]="LINE_LOOP",DRAW_MODES[DRAW_MODES.LINE_STRIP=3]="LINE_STRIP",DRAW_MODES[DRAW_MODES.TRIANGLES=4]="TRIANGLES",DRAW_MODES[DRAW_MODES.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",DRAW_MODES[DRAW_MODES.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(filter_blur_DRAW_MODES||(filter_blur_DRAW_MODES={})),function(FORMATS){FORMATS[FORMATS.RGBA=6408]="RGBA",FORMATS[FORMATS.RGB=6407]="RGB",FORMATS[FORMATS.RG=33319]="RG",FORMATS[FORMATS.RED=6403]="RED",FORMATS[FORMATS.RGBA_INTEGER=36249]="RGBA_INTEGER",FORMATS[FORMATS.RGB_INTEGER=36248]="RGB_INTEGER",FORMATS[FORMATS.RG_INTEGER=33320]="RG_INTEGER",FORMATS[FORMATS.RED_INTEGER=36244]="RED_INTEGER",FORMATS[FORMATS.ALPHA=6406]="ALPHA",FORMATS[FORMATS.LUMINANCE=6409]="LUMINANCE",FORMATS[FORMATS.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",FORMATS[FORMATS.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",FORMATS[FORMATS.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(filter_blur_FORMATS||(filter_blur_FORMATS={})),function(TARGETS){TARGETS[TARGETS.TEXTURE_2D=3553]="TEXTURE_2D",TARGETS[TARGETS.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",TARGETS[TARGETS.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",TARGETS[TARGETS.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",TARGETS[TARGETS.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",TARGETS[TARGETS.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",TARGETS[TARGETS.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",TARGETS[TARGETS.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",TARGETS[TARGETS.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(filter_blur_TARGETS||(filter_blur_TARGETS={})),function(TYPES){TYPES[TYPES.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",TYPES[TYPES.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",TYPES[TYPES.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",TYPES[TYPES.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",TYPES[TYPES.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",TYPES[TYPES.UNSIGNED_INT=5125]="UNSIGNED_INT",TYPES[TYPES.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",TYPES[TYPES.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",TYPES[TYPES.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",TYPES[TYPES.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",TYPES[TYPES.BYTE=5120]="BYTE",TYPES[TYPES.SHORT=5122]="SHORT",TYPES[TYPES.INT=5124]="INT",TYPES[TYPES.FLOAT=5126]="FLOAT",TYPES[TYPES.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",TYPES[TYPES.HALF_FLOAT=36193]="HALF_FLOAT"}(filter_blur_TYPES||(filter_blur_TYPES={})),function(SAMPLER_TYPES){SAMPLER_TYPES[SAMPLER_TYPES.FLOAT=0]="FLOAT",SAMPLER_TYPES[SAMPLER_TYPES.INT=1]="INT",SAMPLER_TYPES[SAMPLER_TYPES.UINT=2]="UINT"}(filter_blur_SAMPLER_TYPES||(filter_blur_SAMPLER_TYPES={})),function(SCALE_MODES){SCALE_MODES[SCALE_MODES.NEAREST=0]="NEAREST",SCALE_MODES[SCALE_MODES.LINEAR=1]="LINEAR"}(filter_blur_SCALE_MODES||(filter_blur_SCALE_MODES={})),function(WRAP_MODES){WRAP_MODES[WRAP_MODES.CLAMP=33071]="CLAMP",WRAP_MODES[WRAP_MODES.REPEAT=10497]="REPEAT",WRAP_MODES[WRAP_MODES.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(filter_blur_WRAP_MODES||(filter_blur_WRAP_MODES={})),function(MIPMAP_MODES){MIPMAP_MODES[MIPMAP_MODES.OFF=0]="OFF",MIPMAP_MODES[MIPMAP_MODES.POW2=1]="POW2",MIPMAP_MODES[MIPMAP_MODES.ON=2]="ON",MIPMAP_MODES[MIPMAP_MODES.ON_MANUAL=3]="ON_MANUAL"}(filter_blur_MIPMAP_MODES||(filter_blur_MIPMAP_MODES={})),function(ALPHA_MODES){ALPHA_MODES[ALPHA_MODES.NPM=0]="NPM",ALPHA_MODES[ALPHA_MODES.UNPACK=1]="UNPACK",ALPHA_MODES[ALPHA_MODES.PMA=2]="PMA",ALPHA_MODES[ALPHA_MODES.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",ALPHA_MODES[ALPHA_MODES.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",ALPHA_MODES[ALPHA_MODES.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",ALPHA_MODES[ALPHA_MODES.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA"}(filter_blur_ALPHA_MODES||(filter_blur_ALPHA_MODES={})),function(CLEAR_MODES){CLEAR_MODES[CLEAR_MODES.NO=0]="NO",CLEAR_MODES[CLEAR_MODES.YES=1]="YES",CLEAR_MODES[CLEAR_MODES.AUTO=2]="AUTO",CLEAR_MODES[CLEAR_MODES.BLEND=0]="BLEND",CLEAR_MODES[CLEAR_MODES.CLEAR=1]="CLEAR",CLEAR_MODES[CLEAR_MODES.BLIT=2]="BLIT"}(filter_blur_CLEAR_MODES||(filter_blur_CLEAR_MODES={})),function(GC_MODES){GC_MODES[GC_MODES.AUTO=0]="AUTO",GC_MODES[GC_MODES.MANUAL=1]="MANUAL"}(filter_blur_GC_MODES||(filter_blur_GC_MODES={})),function(PRECISION){PRECISION.LOW="lowp",PRECISION.MEDIUM="mediump",PRECISION.HIGH="highp"}(filter_blur_PRECISION||(filter_blur_PRECISION={})),function(MASK_TYPES){MASK_TYPES[MASK_TYPES.NONE=0]="NONE",MASK_TYPES[MASK_TYPES.SCISSOR=1]="SCISSOR",MASK_TYPES[MASK_TYPES.STENCIL=2]="STENCIL",MASK_TYPES[MASK_TYPES.SPRITE=3]="SPRITE"}(filter_blur_MASK_TYPES||(filter_blur_MASK_TYPES={})),function(MSAA_QUALITY){MSAA_QUALITY[MSAA_QUALITY.NONE=0]="NONE",MSAA_QUALITY[MSAA_QUALITY.LOW=2]="LOW",MSAA_QUALITY[MSAA_QUALITY.MEDIUM=4]="MEDIUM",MSAA_QUALITY[MSAA_QUALITY.HIGH=8]="HIGH"}(filter_blur_MSAA_QUALITY||(filter_blur_MSAA_QUALITY={})),function(BUFFER_TYPE){BUFFER_TYPE[BUFFER_TYPE.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",BUFFER_TYPE[BUFFER_TYPE.ARRAY_BUFFER=34962]="ARRAY_BUFFER",BUFFER_TYPE[BUFFER_TYPE.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER"}(filter_blur_BUFFER_TYPE||(filter_blur_BUFFER_TYPE={}));var BlurFilterPass=function(_super){function BlurFilterPass(horizontal,strength,quality,resolution,kernelSize){void 0===strength&&(strength=8),void 0===quality&&(quality=4),void 0===resolution&&(resolution=settings.FILTER_RESOLUTION),void 0===kernelSize&&(kernelSize=5);var _this=this,vertSrc=function(kernelSize,x){var template,halfLength=Math.ceil(kernelSize/2),vertSource="\n    attribute vec2 aVertexPosition;\n\n    uniform mat3 projectionMatrix;\n\n    uniform float strength;\n\n    varying vec2 vBlurTexCoords[%size%];\n\n    uniform vec4 inputSize;\n    uniform vec4 outputFrame;\n\n    vec4 filterVertexPosition( void )\n    {\n        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n    }\n\n    vec2 filterTextureCoord( void )\n    {\n        return aVertexPosition * (outputFrame.zw * inputSize.zw);\n    }\n\n    void main(void)\n    {\n        gl_Position = filterVertexPosition();\n\n        vec2 textureCoord = filterTextureCoord();\n        %blur%\n    }",blurLoop="";template=x?"vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":"vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(var i=0;i<kernelSize;i++){var blur=template.replace("%index%",i.toString());blurLoop+=blur=blur.replace("%sampleIndex%",i-(halfLength-1)+".0"),blurLoop+="\n"}return(vertSource=vertSource.replace("%blur%",blurLoop)).replace("%size%",kernelSize.toString())}(kernelSize,horizontal),fragSrc=function(kernelSize){for(var value,kernel=GAUSSIAN_VALUES[kernelSize],halfLength=kernel.length,fragSource=filter_blur_fragTemplate,blurLoop="",i=0;i<kernelSize;i++){var blur="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;".replace("%index%",i.toString());value=i,i>=halfLength&&(value=kernelSize-i-1),blurLoop+=blur=blur.replace("%value%",kernel[value].toString()),blurLoop+="\n"}return(fragSource=fragSource.replace("%blur%",blurLoop)).replace("%size%",kernelSize.toString())}(kernelSize);return(_this=_super.call(this,vertSrc,fragSrc)||this).horizontal=horizontal,_this.resolution=resolution,_this._quality=0,_this.quality=quality,_this.blur=strength,_this}return filter_blur_extends(BlurFilterPass,_super),BlurFilterPass.prototype.apply=function(filterManager,input,output,clearMode){if(output?this.horizontal?this.uniforms.strength=1/output.width*(output.width/input.width):this.uniforms.strength=1/output.height*(output.height/input.height):this.horizontal?this.uniforms.strength=1/filterManager.renderer.width*(filterManager.renderer.width/input.width):this.uniforms.strength=1/filterManager.renderer.height*(filterManager.renderer.height/input.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,1===this.passes)filterManager.applyFilter(this,input,output,clearMode);else{var renderTarget=filterManager.getFilterTexture(),renderer=filterManager.renderer,flip=input,flop=renderTarget;this.state.blend=!1,filterManager.applyFilter(this,flip,flop,filter_blur_CLEAR_MODES.CLEAR);for(var i=1;i<this.passes-1;i++){filterManager.bindAndClear(flip,filter_blur_CLEAR_MODES.BLIT),this.uniforms.uSampler=flop;var temp=flop;flop=flip,flip=temp,renderer.shader.bind(this),renderer.geometry.draw(5)}this.state.blend=!0,filterManager.applyFilter(this,flop,output,clearMode),filterManager.returnFilterTexture(renderTarget)}},Object.defineProperty(BlurFilterPass.prototype,"blur",{get:function(){return this.strength},set:function(value){this.padding=1+2*Math.abs(value),this.strength=value},enumerable:!1,configurable:!0}),Object.defineProperty(BlurFilterPass.prototype,"quality",{get:function(){return this._quality},set:function(value){this._quality=value,this.passes=value},enumerable:!1,configurable:!0}),BlurFilterPass}(Filter),filter_color_matrix_extendStatics=(function(_super){function BlurFilter(strength,quality,resolution,kernelSize){void 0===strength&&(strength=8),void 0===quality&&(quality=4),void 0===resolution&&(resolution=settings.FILTER_RESOLUTION),void 0===kernelSize&&(kernelSize=5);var _this=_super.call(this)||this;return _this.blurXFilter=new BlurFilterPass(!0,strength,quality,resolution,kernelSize),_this.blurYFilter=new BlurFilterPass(!1,strength,quality,resolution,kernelSize),_this.resolution=resolution,_this.quality=quality,_this.blur=strength,_this.repeatEdgePixels=!1,_this}filter_blur_extends(BlurFilter,_super),BlurFilter.prototype.apply=function(filterManager,input,output,clearMode){var xStrength=Math.abs(this.blurXFilter.strength),yStrength=Math.abs(this.blurYFilter.strength);if(xStrength&&yStrength){var renderTarget=filterManager.getFilterTexture();this.blurXFilter.apply(filterManager,input,renderTarget,filter_blur_CLEAR_MODES.CLEAR),this.blurYFilter.apply(filterManager,renderTarget,output,clearMode),filterManager.returnFilterTexture(renderTarget)}else yStrength?this.blurYFilter.apply(filterManager,input,output,clearMode):this.blurXFilter.apply(filterManager,input,output,clearMode)},BlurFilter.prototype.updatePadding=function(){this._repeatEdgePixels?this.padding=0:this.padding=2*Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))},Object.defineProperty(BlurFilter.prototype,"blur",{get:function(){return this.blurXFilter.blur},set:function(value){this.blurXFilter.blur=this.blurYFilter.blur=value,this.updatePadding()},enumerable:!1,configurable:!0}),Object.defineProperty(BlurFilter.prototype,"quality",{get:function(){return this.blurXFilter.quality},set:function(value){this.blurXFilter.quality=this.blurYFilter.quality=value},enumerable:!1,configurable:!0}),Object.defineProperty(BlurFilter.prototype,"blurX",{get:function(){return this.blurXFilter.blur},set:function(value){this.blurXFilter.blur=value,this.updatePadding()},enumerable:!1,configurable:!0}),Object.defineProperty(BlurFilter.prototype,"blurY",{get:function(){return this.blurYFilter.blur},set:function(value){this.blurYFilter.blur=value,this.updatePadding()},enumerable:!1,configurable:!0}),Object.defineProperty(BlurFilter.prototype,"blendMode",{get:function(){return this.blurYFilter.blendMode},set:function(value){this.blurYFilter.blendMode=value},enumerable:!1,configurable:!0}),Object.defineProperty(BlurFilter.prototype,"repeatEdgePixels",{get:function(){return this._repeatEdgePixels},set:function(value){this._repeatEdgePixels=value,this.updatePadding()},enumerable:!1,configurable:!0})}(Filter),function(d,b){return filter_color_matrix_extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])},filter_color_matrix_extendStatics(d,b)});var ColorMatrixFilter=function(_super){function ColorMatrixFilter(){var _this=this,uniforms={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};return(_this=_super.call(this,defaultFilterVertex,"varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float m[20];\nuniform float uAlpha;\n\nvoid main(void)\n{\n    vec4 c = texture2D(uSampler, vTextureCoord);\n\n    if (uAlpha == 0.0) {\n        gl_FragColor = c;\n        return;\n    }\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (c.a > 0.0) {\n      c.rgb /= c.a;\n    }\n\n    vec4 result;\n\n    result.r = (m[0] * c.r);\n        result.r += (m[1] * c.g);\n        result.r += (m[2] * c.b);\n        result.r += (m[3] * c.a);\n        result.r += m[4];\n\n    result.g = (m[5] * c.r);\n        result.g += (m[6] * c.g);\n        result.g += (m[7] * c.b);\n        result.g += (m[8] * c.a);\n        result.g += m[9];\n\n    result.b = (m[10] * c.r);\n       result.b += (m[11] * c.g);\n       result.b += (m[12] * c.b);\n       result.b += (m[13] * c.a);\n       result.b += m[14];\n\n    result.a = (m[15] * c.r);\n       result.a += (m[16] * c.g);\n       result.a += (m[17] * c.b);\n       result.a += (m[18] * c.a);\n       result.a += m[19];\n\n    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);\n\n    // Premultiply alpha again.\n    rgb *= result.a;\n\n    gl_FragColor = vec4(rgb, result.a);\n}\n",uniforms)||this).alpha=1,_this}return function(d,b){function __(){this.constructor=d}filter_color_matrix_extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}(ColorMatrixFilter,_super),ColorMatrixFilter.prototype._loadMatrix=function(matrix,multiply){void 0===multiply&&(multiply=!1);var newMatrix=matrix;multiply&&(this._multiply(newMatrix,this.uniforms.m,matrix),newMatrix=this._colorMatrix(newMatrix)),this.uniforms.m=newMatrix},ColorMatrixFilter.prototype._multiply=function(out,a,b){return out[0]=a[0]*b[0]+a[1]*b[5]+a[2]*b[10]+a[3]*b[15],out[1]=a[0]*b[1]+a[1]*b[6]+a[2]*b[11]+a[3]*b[16],out[2]=a[0]*b[2]+a[1]*b[7]+a[2]*b[12]+a[3]*b[17],out[3]=a[0]*b[3]+a[1]*b[8]+a[2]*b[13]+a[3]*b[18],out[4]=a[0]*b[4]+a[1]*b[9]+a[2]*b[14]+a[3]*b[19]+a[4],out[5]=a[5]*b[0]+a[6]*b[5]+a[7]*b[10]+a[8]*b[15],out[6]=a[5]*b[1]+a[6]*b[6]+a[7]*b[11]+a[8]*b[16],out[7]=a[5]*b[2]+a[6]*b[7]+a[7]*b[12]+a[8]*b[17],out[8]=a[5]*b[3]+a[6]*b[8]+a[7]*b[13]+a[8]*b[18],out[9]=a[5]*b[4]+a[6]*b[9]+a[7]*b[14]+a[8]*b[19]+a[9],out[10]=a[10]*b[0]+a[11]*b[5]+a[12]*b[10]+a[13]*b[15],out[11]=a[10]*b[1]+a[11]*b[6]+a[12]*b[11]+a[13]*b[16],out[12]=a[10]*b[2]+a[11]*b[7]+a[12]*b[12]+a[13]*b[17],out[13]=a[10]*b[3]+a[11]*b[8]+a[12]*b[13]+a[13]*b[18],out[14]=a[10]*b[4]+a[11]*b[9]+a[12]*b[14]+a[13]*b[19]+a[14],out[15]=a[15]*b[0]+a[16]*b[5]+a[17]*b[10]+a[18]*b[15],out[16]=a[15]*b[1]+a[16]*b[6]+a[17]*b[11]+a[18]*b[16],out[17]=a[15]*b[2]+a[16]*b[7]+a[17]*b[12]+a[18]*b[17],out[18]=a[15]*b[3]+a[16]*b[8]+a[17]*b[13]+a[18]*b[18],out[19]=a[15]*b[4]+a[16]*b[9]+a[17]*b[14]+a[18]*b[19]+a[19],out},ColorMatrixFilter.prototype._colorMatrix=function(matrix){var m=new Float32Array(matrix);return m[4]/=255,m[9]/=255,m[14]/=255,m[19]/=255,m},ColorMatrixFilter.prototype.brightness=function(b,multiply){var matrix=[b,0,0,0,0,0,b,0,0,0,0,0,b,0,0,0,0,0,1,0];this._loadMatrix(matrix,multiply)},ColorMatrixFilter.prototype.tint=function(color,multiply){var matrix=[(color>>16&255)/255,0,0,0,0,0,(color>>8&255)/255,0,0,0,0,0,(255&color)/255,0,0,0,0,0,1,0];this._loadMatrix(matrix,multiply)},ColorMatrixFilter.prototype.greyscale=function(scale,multiply){var matrix=[scale,scale,scale,0,0,scale,scale,scale,0,0,scale,scale,scale,0,0,0,0,0,1,0];this._loadMatrix(matrix,multiply)},ColorMatrixFilter.prototype.blackAndWhite=function(multiply){this._loadMatrix([.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0],multiply)},ColorMatrixFilter.prototype.hue=function(rotation,multiply){rotation=(rotation||0)/180*Math.PI;var cosR=Math.cos(rotation),sinR=Math.sin(rotation),w=1/3,sqrW=(0,Math.sqrt)(w),matrix=[cosR+(1-cosR)*w,w*(1-cosR)-sqrW*sinR,w*(1-cosR)+sqrW*sinR,0,0,w*(1-cosR)+sqrW*sinR,cosR+w*(1-cosR),w*(1-cosR)-sqrW*sinR,0,0,w*(1-cosR)-sqrW*sinR,w*(1-cosR)+sqrW*sinR,cosR+w*(1-cosR),0,0,0,0,0,1,0];this._loadMatrix(matrix,multiply)},ColorMatrixFilter.prototype.contrast=function(amount,multiply){var v=(amount||0)+1,o=-.5*(v-1),matrix=[v,0,0,0,o,0,v,0,0,o,0,0,v,0,o,0,0,0,1,0];this._loadMatrix(matrix,multiply)},ColorMatrixFilter.prototype.saturate=function(amount,multiply){void 0===amount&&(amount=0);var x=2*amount/3+1,y=-.5*(x-1),matrix=[x,y,y,0,0,y,x,y,0,0,y,y,x,0,0,0,0,0,1,0];this._loadMatrix(matrix,multiply)},ColorMatrixFilter.prototype.desaturate=function(){this.saturate(-1)},ColorMatrixFilter.prototype.negative=function(multiply){this._loadMatrix([-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0],multiply)},ColorMatrixFilter.prototype.sepia=function(multiply){this._loadMatrix([.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0],multiply)},ColorMatrixFilter.prototype.technicolor=function(multiply){this._loadMatrix([1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0],multiply)},ColorMatrixFilter.prototype.polaroid=function(multiply){this._loadMatrix([1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],multiply)},ColorMatrixFilter.prototype.toBGR=function(multiply){this._loadMatrix([0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0],multiply)},ColorMatrixFilter.prototype.kodachrome=function(multiply){this._loadMatrix([1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0],multiply)},ColorMatrixFilter.prototype.browni=function(multiply){this._loadMatrix([.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0],multiply)},ColorMatrixFilter.prototype.vintage=function(multiply){this._loadMatrix([.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0],multiply)},ColorMatrixFilter.prototype.colorTone=function(desaturation,toned,lightColor,darkColor,multiply){var lR=((lightColor=lightColor||16770432)>>16&255)/255,lG=(lightColor>>8&255)/255,lB=(255&lightColor)/255,dR=((darkColor=darkColor||3375104)>>16&255)/255,dG=(darkColor>>8&255)/255,dB=(255&darkColor)/255,matrix=[.3,.59,.11,0,0,lR,lG,lB,desaturation=desaturation||.2,0,dR,dG,dB,toned=toned||.15,0,lR-dR,lG-dG,lB-dB,0,0];this._loadMatrix(matrix,multiply)},ColorMatrixFilter.prototype.night=function(intensity,multiply){var matrix=[-2*(intensity=intensity||.1),-intensity,0,0,0,-intensity,0,intensity,0,0,0,intensity,2*intensity,0,0,0,0,0,1,0];this._loadMatrix(matrix,multiply)},ColorMatrixFilter.prototype.predator=function(amount,multiply){var matrix=[11.224130630493164*amount,-4.794486999511719*amount,-2.8746118545532227*amount,0*amount,.40342438220977783*amount,-3.6330697536468506*amount,9.193157196044922*amount,-2.951810836791992*amount,0*amount,-1.316135048866272*amount,-3.2184197902679443*amount,-4.2375030517578125*amount,7.476448059082031*amount,0*amount,.8044459223747253*amount,0,0,0,1,0];this._loadMatrix(matrix,multiply)},ColorMatrixFilter.prototype.lsd=function(multiply){this._loadMatrix([2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0],multiply)},ColorMatrixFilter.prototype.reset=function(){this._loadMatrix([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],!1)},Object.defineProperty(ColorMatrixFilter.prototype,"matrix",{get:function(){return this.uniforms.m},set:function(value){this.uniforms.m=value},enumerable:!1,configurable:!0}),Object.defineProperty(ColorMatrixFilter.prototype,"alpha",{get:function(){return this.uniforms.uAlpha},set:function(value){this.uniforms.uAlpha=value},enumerable:!1,configurable:!0}),ColorMatrixFilter}(Filter);ColorMatrixFilter.prototype.grayscale=ColorMatrixFilter.prototype.greyscale;var filter_displacement_extendStatics=function(d,b){return filter_displacement_extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])},filter_displacement_extendStatics(d,b)};!function(_super){function DisplacementFilter(sprite,scale){var _this=this,maskMatrix=new Matrix;return sprite.renderable=!1,(_this=_super.call(this,"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\nuniform mat3 filterMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vFilterCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n\tgl_Position = filterVertexPosition();\n\tvTextureCoord = filterTextureCoord();\n\tvFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;\n}\n","varying vec2 vFilterCoord;\nvarying vec2 vTextureCoord;\n\nuniform vec2 scale;\nuniform mat2 rotation;\nuniform sampler2D uSampler;\nuniform sampler2D mapSampler;\n\nuniform highp vec4 inputSize;\nuniform vec4 inputClamp;\n\nvoid main(void)\n{\n  vec4 map =  texture2D(mapSampler, vFilterCoord);\n\n  map -= 0.5;\n  map.xy = scale * inputSize.zw * (rotation * map.xy);\n\n  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));\n}\n",{mapSampler:sprite._texture,filterMatrix:maskMatrix,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])})||this).maskSprite=sprite,_this.maskMatrix=maskMatrix,null==scale&&(scale=20),_this.scale=new Point(scale,scale),_this}(function(d,b){function __(){this.constructor=d}filter_displacement_extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)})(DisplacementFilter,_super),DisplacementFilter.prototype.apply=function(filterManager,input,output,clearMode){this.uniforms.filterMatrix=filterManager.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;var wt=this.maskSprite.worldTransform,lenX=Math.sqrt(wt.a*wt.a+wt.b*wt.b),lenY=Math.sqrt(wt.c*wt.c+wt.d*wt.d);0!==lenX&&0!==lenY&&(this.uniforms.rotation[0]=wt.a/lenX,this.uniforms.rotation[1]=wt.b/lenX,this.uniforms.rotation[2]=wt.c/lenY,this.uniforms.rotation[3]=wt.d/lenY),filterManager.applyFilter(this,input,output,clearMode)},Object.defineProperty(DisplacementFilter.prototype,"map",{get:function(){return this.uniforms.mapSampler},set:function(value){this.uniforms.mapSampler=value},enumerable:!1,configurable:!0})}(Filter);var filter_fxaa_extendStatics=function(d,b){return filter_fxaa_extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])},filter_fxaa_extendStatics(d,b)};!function(_super){function FXAAFilter(){return _super.call(this,"\nattribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vFragCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvoid texcoords(vec2 fragCoord, vec2 inverseVP,\n               out vec2 v_rgbNW, out vec2 v_rgbNE,\n               out vec2 v_rgbSW, out vec2 v_rgbSE,\n               out vec2 v_rgbM) {\n    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;\n    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;\n    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;\n    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;\n    v_rgbM = vec2(fragCoord * inverseVP);\n}\n\nvoid main(void) {\n\n   gl_Position = filterVertexPosition();\n\n   vFragCoord = aVertexPosition * outputFrame.zw;\n\n   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n}\n",'varying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vFragCoord;\nuniform sampler2D uSampler;\nuniform highp vec4 inputSize;\n\n\n/**\n Basic FXAA implementation based on the code on geeks3d.com with the\n modification that the texture2DLod stuff was removed since it\'s\n unsupported by WebGL.\n\n --\n\n From:\n https://github.com/mitsuhiko/webgl-meincraft\n\n Copyright (c) 2011 by Armin Ronacher.\n\n Some rights reserved.\n\n Redistribution and use in source and binary forms, with or without\n modification, are permitted provided that the following conditions are\n met:\n\n * Redistributions of source code must retain the above copyright\n notice, this list of conditions and the following disclaimer.\n\n * Redistributions in binary form must reproduce the above\n copyright notice, this list of conditions and the following\n disclaimer in the documentation and/or other materials provided\n with the distribution.\n\n * The names of the contributors may not be used to endorse or\n promote products derived from this software without specific\n prior written permission.\n\n THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n#ifndef FXAA_REDUCE_MIN\n#define FXAA_REDUCE_MIN   (1.0/ 128.0)\n#endif\n#ifndef FXAA_REDUCE_MUL\n#define FXAA_REDUCE_MUL   (1.0 / 8.0)\n#endif\n#ifndef FXAA_SPAN_MAX\n#define FXAA_SPAN_MAX     8.0\n#endif\n\n//optimized version for mobile, where dependent\n//texture reads can be a bottleneck\nvec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,\n          vec2 v_rgbNW, vec2 v_rgbNE,\n          vec2 v_rgbSW, vec2 v_rgbSE,\n          vec2 v_rgbM) {\n    vec4 color;\n    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;\n    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;\n    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;\n    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;\n    vec4 texColor = texture2D(tex, v_rgbM);\n    vec3 rgbM  = texColor.xyz;\n    vec3 luma = vec3(0.299, 0.587, 0.114);\n    float lumaNW = dot(rgbNW, luma);\n    float lumaNE = dot(rgbNE, luma);\n    float lumaSW = dot(rgbSW, luma);\n    float lumaSE = dot(rgbSE, luma);\n    float lumaM  = dot(rgbM,  luma);\n    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\n\n    mediump vec2 dir;\n    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n\n    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *\n                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\n\n    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\n    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\n              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\n                  dir * rcpDirMin)) * inverseVP;\n\n    vec3 rgbA = 0.5 * (\n                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +\n                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);\n    vec3 rgbB = rgbA * 0.5 + 0.25 * (\n                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +\n                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);\n\n    float lumaB = dot(rgbB, luma);\n    if ((lumaB < lumaMin) || (lumaB > lumaMax))\n        color = vec4(rgbA, texColor.a);\n    else\n        color = vec4(rgbB, texColor.a);\n    return color;\n}\n\nvoid main() {\n\n      vec4 color;\n\n      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n\n      gl_FragColor = color;\n}\n')||this}(function(d,b){function __(){this.constructor=d}filter_fxaa_extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)})(FXAAFilter,_super)}(Filter);var filter_noise_extendStatics=function(d,b){return filter_noise_extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])},filter_noise_extendStatics(d,b)};var mixin_cache_as_bitmap_ENV,mixin_cache_as_bitmap_RENDERER_TYPE,mixin_cache_as_bitmap_BUFFER_BITS,mixin_cache_as_bitmap_BLEND_MODES,mixin_cache_as_bitmap_DRAW_MODES,mixin_cache_as_bitmap_FORMATS,mixin_cache_as_bitmap_TARGETS,mixin_cache_as_bitmap_TYPES,mixin_cache_as_bitmap_SAMPLER_TYPES,mixin_cache_as_bitmap_SCALE_MODES,mixin_cache_as_bitmap_WRAP_MODES,mixin_cache_as_bitmap_MIPMAP_MODES,mixin_cache_as_bitmap_ALPHA_MODES,mixin_cache_as_bitmap_CLEAR_MODES,mixin_cache_as_bitmap_GC_MODES,mixin_cache_as_bitmap_PRECISION,mixin_cache_as_bitmap_MASK_TYPES,mixin_cache_as_bitmap_MSAA_QUALITY,mixin_cache_as_bitmap_BUFFER_TYPE;!function(_super){function NoiseFilter(noise,seed){void 0===noise&&(noise=.5),void 0===seed&&(seed=Math.random());var _this=_super.call(this,defaultFilterVertex,"precision highp float;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform float uNoise;\nuniform float uSeed;\nuniform sampler2D uSampler;\n\nfloat rand(vec2 co)\n{\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main()\n{\n    vec4 color = texture2D(uSampler, vTextureCoord);\n    float randomValue = rand(gl_FragCoord.xy * uSeed);\n    float diff = (randomValue - 0.5) * uNoise;\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (color.a > 0.0) {\n        color.rgb /= color.a;\n    }\n\n    color.r += diff;\n    color.g += diff;\n    color.b += diff;\n\n    // Premultiply alpha again.\n    color.rgb *= color.a;\n\n    gl_FragColor = color;\n}\n",{uNoise:0,uSeed:0})||this;return _this.noise=noise,_this.seed=seed,_this}(function(d,b){function __(){this.constructor=d}filter_noise_extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)})(NoiseFilter,_super),Object.defineProperty(NoiseFilter.prototype,"noise",{get:function(){return this.uniforms.uNoise},set:function(value){this.uniforms.uNoise=value},enumerable:!1,configurable:!0}),Object.defineProperty(NoiseFilter.prototype,"seed",{get:function(){return this.uniforms.uSeed},set:function(value){this.uniforms.uSeed=value},enumerable:!1,configurable:!0})}(Filter);!function(ENV){ENV[ENV.WEBGL_LEGACY=0]="WEBGL_LEGACY",ENV[ENV.WEBGL=1]="WEBGL",ENV[ENV.WEBGL2=2]="WEBGL2"}(mixin_cache_as_bitmap_ENV||(mixin_cache_as_bitmap_ENV={})),function(RENDERER_TYPE){RENDERER_TYPE[RENDERER_TYPE.UNKNOWN=0]="UNKNOWN",RENDERER_TYPE[RENDERER_TYPE.WEBGL=1]="WEBGL",RENDERER_TYPE[RENDERER_TYPE.CANVAS=2]="CANVAS"}(mixin_cache_as_bitmap_RENDERER_TYPE||(mixin_cache_as_bitmap_RENDERER_TYPE={})),function(BUFFER_BITS){BUFFER_BITS[BUFFER_BITS.COLOR=16384]="COLOR",BUFFER_BITS[BUFFER_BITS.DEPTH=256]="DEPTH",BUFFER_BITS[BUFFER_BITS.STENCIL=1024]="STENCIL"}(mixin_cache_as_bitmap_BUFFER_BITS||(mixin_cache_as_bitmap_BUFFER_BITS={})),function(BLEND_MODES){BLEND_MODES[BLEND_MODES.NORMAL=0]="NORMAL",BLEND_MODES[BLEND_MODES.ADD=1]="ADD",BLEND_MODES[BLEND_MODES.MULTIPLY=2]="MULTIPLY",BLEND_MODES[BLEND_MODES.SCREEN=3]="SCREEN",BLEND_MODES[BLEND_MODES.OVERLAY=4]="OVERLAY",BLEND_MODES[BLEND_MODES.DARKEN=5]="DARKEN",BLEND_MODES[BLEND_MODES.LIGHTEN=6]="LIGHTEN",BLEND_MODES[BLEND_MODES.COLOR_DODGE=7]="COLOR_DODGE",BLEND_MODES[BLEND_MODES.COLOR_BURN=8]="COLOR_BURN",BLEND_MODES[BLEND_MODES.HARD_LIGHT=9]="HARD_LIGHT",BLEND_MODES[BLEND_MODES.SOFT_LIGHT=10]="SOFT_LIGHT",BLEND_MODES[BLEND_MODES.DIFFERENCE=11]="DIFFERENCE",BLEND_MODES[BLEND_MODES.EXCLUSION=12]="EXCLUSION",BLEND_MODES[BLEND_MODES.HUE=13]="HUE",BLEND_MODES[BLEND_MODES.SATURATION=14]="SATURATION",BLEND_MODES[BLEND_MODES.COLOR=15]="COLOR",BLEND_MODES[BLEND_MODES.LUMINOSITY=16]="LUMINOSITY",BLEND_MODES[BLEND_MODES.NORMAL_NPM=17]="NORMAL_NPM",BLEND_MODES[BLEND_MODES.ADD_NPM=18]="ADD_NPM",BLEND_MODES[BLEND_MODES.SCREEN_NPM=19]="SCREEN_NPM",BLEND_MODES[BLEND_MODES.NONE=20]="NONE",BLEND_MODES[BLEND_MODES.SRC_OVER=0]="SRC_OVER",BLEND_MODES[BLEND_MODES.SRC_IN=21]="SRC_IN",BLEND_MODES[BLEND_MODES.SRC_OUT=22]="SRC_OUT",BLEND_MODES[BLEND_MODES.SRC_ATOP=23]="SRC_ATOP",BLEND_MODES[BLEND_MODES.DST_OVER=24]="DST_OVER",BLEND_MODES[BLEND_MODES.DST_IN=25]="DST_IN",BLEND_MODES[BLEND_MODES.DST_OUT=26]="DST_OUT",BLEND_MODES[BLEND_MODES.DST_ATOP=27]="DST_ATOP",BLEND_MODES[BLEND_MODES.ERASE=26]="ERASE",BLEND_MODES[BLEND_MODES.SUBTRACT=28]="SUBTRACT",BLEND_MODES[BLEND_MODES.XOR=29]="XOR"}(mixin_cache_as_bitmap_BLEND_MODES||(mixin_cache_as_bitmap_BLEND_MODES={})),function(DRAW_MODES){DRAW_MODES[DRAW_MODES.POINTS=0]="POINTS",DRAW_MODES[DRAW_MODES.LINES=1]="LINES",DRAW_MODES[DRAW_MODES.LINE_LOOP=2]="LINE_LOOP",DRAW_MODES[DRAW_MODES.LINE_STRIP=3]="LINE_STRIP",DRAW_MODES[DRAW_MODES.TRIANGLES=4]="TRIANGLES",DRAW_MODES[DRAW_MODES.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",DRAW_MODES[DRAW_MODES.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(mixin_cache_as_bitmap_DRAW_MODES||(mixin_cache_as_bitmap_DRAW_MODES={})),function(FORMATS){FORMATS[FORMATS.RGBA=6408]="RGBA",FORMATS[FORMATS.RGB=6407]="RGB",FORMATS[FORMATS.RG=33319]="RG",FORMATS[FORMATS.RED=6403]="RED",FORMATS[FORMATS.RGBA_INTEGER=36249]="RGBA_INTEGER",FORMATS[FORMATS.RGB_INTEGER=36248]="RGB_INTEGER",FORMATS[FORMATS.RG_INTEGER=33320]="RG_INTEGER",FORMATS[FORMATS.RED_INTEGER=36244]="RED_INTEGER",FORMATS[FORMATS.ALPHA=6406]="ALPHA",FORMATS[FORMATS.LUMINANCE=6409]="LUMINANCE",FORMATS[FORMATS.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",FORMATS[FORMATS.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",FORMATS[FORMATS.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(mixin_cache_as_bitmap_FORMATS||(mixin_cache_as_bitmap_FORMATS={})),function(TARGETS){TARGETS[TARGETS.TEXTURE_2D=3553]="TEXTURE_2D",TARGETS[TARGETS.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",TARGETS[TARGETS.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",TARGETS[TARGETS.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",TARGETS[TARGETS.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",TARGETS[TARGETS.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",TARGETS[TARGETS.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",TARGETS[TARGETS.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",TARGETS[TARGETS.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(mixin_cache_as_bitmap_TARGETS||(mixin_cache_as_bitmap_TARGETS={})),function(TYPES){TYPES[TYPES.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",TYPES[TYPES.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",TYPES[TYPES.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",TYPES[TYPES.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",TYPES[TYPES.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",TYPES[TYPES.UNSIGNED_INT=5125]="UNSIGNED_INT",TYPES[TYPES.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",TYPES[TYPES.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",TYPES[TYPES.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",TYPES[TYPES.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",TYPES[TYPES.BYTE=5120]="BYTE",TYPES[TYPES.SHORT=5122]="SHORT",TYPES[TYPES.INT=5124]="INT",TYPES[TYPES.FLOAT=5126]="FLOAT",TYPES[TYPES.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",TYPES[TYPES.HALF_FLOAT=36193]="HALF_FLOAT"}(mixin_cache_as_bitmap_TYPES||(mixin_cache_as_bitmap_TYPES={})),function(SAMPLER_TYPES){SAMPLER_TYPES[SAMPLER_TYPES.FLOAT=0]="FLOAT",SAMPLER_TYPES[SAMPLER_TYPES.INT=1]="INT",SAMPLER_TYPES[SAMPLER_TYPES.UINT=2]="UINT"}(mixin_cache_as_bitmap_SAMPLER_TYPES||(mixin_cache_as_bitmap_SAMPLER_TYPES={})),function(SCALE_MODES){SCALE_MODES[SCALE_MODES.NEAREST=0]="NEAREST",SCALE_MODES[SCALE_MODES.LINEAR=1]="LINEAR"}(mixin_cache_as_bitmap_SCALE_MODES||(mixin_cache_as_bitmap_SCALE_MODES={})),function(WRAP_MODES){WRAP_MODES[WRAP_MODES.CLAMP=33071]="CLAMP",WRAP_MODES[WRAP_MODES.REPEAT=10497]="REPEAT",WRAP_MODES[WRAP_MODES.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(mixin_cache_as_bitmap_WRAP_MODES||(mixin_cache_as_bitmap_WRAP_MODES={})),function(MIPMAP_MODES){MIPMAP_MODES[MIPMAP_MODES.OFF=0]="OFF",MIPMAP_MODES[MIPMAP_MODES.POW2=1]="POW2",MIPMAP_MODES[MIPMAP_MODES.ON=2]="ON",MIPMAP_MODES[MIPMAP_MODES.ON_MANUAL=3]="ON_MANUAL"}(mixin_cache_as_bitmap_MIPMAP_MODES||(mixin_cache_as_bitmap_MIPMAP_MODES={})),function(ALPHA_MODES){ALPHA_MODES[ALPHA_MODES.NPM=0]="NPM",ALPHA_MODES[ALPHA_MODES.UNPACK=1]="UNPACK",ALPHA_MODES[ALPHA_MODES.PMA=2]="PMA",ALPHA_MODES[ALPHA_MODES.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",ALPHA_MODES[ALPHA_MODES.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",ALPHA_MODES[ALPHA_MODES.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",ALPHA_MODES[ALPHA_MODES.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA"}(mixin_cache_as_bitmap_ALPHA_MODES||(mixin_cache_as_bitmap_ALPHA_MODES={})),function(CLEAR_MODES){CLEAR_MODES[CLEAR_MODES.NO=0]="NO",CLEAR_MODES[CLEAR_MODES.YES=1]="YES",CLEAR_MODES[CLEAR_MODES.AUTO=2]="AUTO",CLEAR_MODES[CLEAR_MODES.BLEND=0]="BLEND",CLEAR_MODES[CLEAR_MODES.CLEAR=1]="CLEAR",CLEAR_MODES[CLEAR_MODES.BLIT=2]="BLIT"}(mixin_cache_as_bitmap_CLEAR_MODES||(mixin_cache_as_bitmap_CLEAR_MODES={})),function(GC_MODES){GC_MODES[GC_MODES.AUTO=0]="AUTO",GC_MODES[GC_MODES.MANUAL=1]="MANUAL"}(mixin_cache_as_bitmap_GC_MODES||(mixin_cache_as_bitmap_GC_MODES={})),function(PRECISION){PRECISION.LOW="lowp",PRECISION.MEDIUM="mediump",PRECISION.HIGH="highp"}(mixin_cache_as_bitmap_PRECISION||(mixin_cache_as_bitmap_PRECISION={})),function(MASK_TYPES){MASK_TYPES[MASK_TYPES.NONE=0]="NONE",MASK_TYPES[MASK_TYPES.SCISSOR=1]="SCISSOR",MASK_TYPES[MASK_TYPES.STENCIL=2]="STENCIL",MASK_TYPES[MASK_TYPES.SPRITE=3]="SPRITE"}(mixin_cache_as_bitmap_MASK_TYPES||(mixin_cache_as_bitmap_MASK_TYPES={})),function(MSAA_QUALITY){MSAA_QUALITY[MSAA_QUALITY.NONE=0]="NONE",MSAA_QUALITY[MSAA_QUALITY.LOW=2]="LOW",MSAA_QUALITY[MSAA_QUALITY.MEDIUM=4]="MEDIUM",MSAA_QUALITY[MSAA_QUALITY.HIGH=8]="HIGH"}(mixin_cache_as_bitmap_MSAA_QUALITY||(mixin_cache_as_bitmap_MSAA_QUALITY={})),function(BUFFER_TYPE){BUFFER_TYPE[BUFFER_TYPE.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",BUFFER_TYPE[BUFFER_TYPE.ARRAY_BUFFER=34962]="ARRAY_BUFFER",BUFFER_TYPE[BUFFER_TYPE.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER"}(mixin_cache_as_bitmap_BUFFER_TYPE||(mixin_cache_as_bitmap_BUFFER_TYPE={}));var _tempMatrix=new Matrix;DisplayObject.prototype._cacheAsBitmap=!1,DisplayObject.prototype._cacheData=null,DisplayObject.prototype._cacheAsBitmapResolution=null,DisplayObject.prototype._cacheAsBitmapMultisample=mixin_cache_as_bitmap_MSAA_QUALITY.NONE;var CacheData=function(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null};Object.defineProperties(DisplayObject.prototype,{cacheAsBitmapResolution:{get:function(){return this._cacheAsBitmapResolution},set:function(resolution){resolution!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=resolution,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get:function(){return this._cacheAsBitmapMultisample},set:function(multisample){multisample!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=multisample,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get:function(){return this._cacheAsBitmap},set:function(value){var data;this._cacheAsBitmap!==value&&(this._cacheAsBitmap=value,value?(this._cacheData||(this._cacheData=new CacheData),(data=this._cacheData).originalRender=this.render,data.originalRenderCanvas=this.renderCanvas,data.originalUpdateTransform=this.updateTransform,data.originalCalculateBounds=this.calculateBounds,data.originalGetLocalBounds=this.getLocalBounds,data.originalDestroy=this.destroy,data.originalContainsPoint=this.containsPoint,data.originalMask=this._mask,data.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):((data=this._cacheData).sprite&&this._destroyCachedDisplayObject(),this.render=data.originalRender,this.renderCanvas=data.originalRenderCanvas,this.calculateBounds=data.originalCalculateBounds,this.getLocalBounds=data.originalGetLocalBounds,this.destroy=data.originalDestroy,this.updateTransform=data.originalUpdateTransform,this.containsPoint=data.originalContainsPoint,this._mask=data.originalMask,this.filterArea=data.originalFilterArea))}}}),DisplayObject.prototype._renderCached=function(renderer){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(renderer),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(renderer))},DisplayObject.prototype._initCachedDisplayObject=function(renderer){var _a;if(!this._cacheData||!this._cacheData.sprite){var cacheAlpha=this.alpha;this.alpha=1,renderer.batch.flush();var bounds=this.getLocalBounds(null,!0).clone();if(this.filters&&this.filters.length){var padding=this.filters[0].padding;bounds.pad(padding)}bounds.ceil(settings.RESOLUTION);var cachedRenderTexture=renderer.renderTexture.current,cachedSourceFrame=renderer.renderTexture.sourceFrame.clone(),cachedDestinationFrame=renderer.renderTexture.destinationFrame.clone(),cachedProjectionTransform=renderer.projection.transform,renderTexture=RenderTexture.create({width:bounds.width,height:bounds.height,resolution:this.cacheAsBitmapResolution||renderer.resolution,multisample:null!==(_a=this.cacheAsBitmapMultisample)&&void 0!==_a?_a:renderer.multisample}),textureCacheId="cacheAsBitmap_"+uid();this._cacheData.textureCacheId=textureCacheId,BaseTexture.addToCache(renderTexture.baseTexture,textureCacheId),Texture.addToCache(renderTexture,textureCacheId);var m=this.transform.localTransform.copyTo(_tempMatrix).invert().translate(-bounds.x,-bounds.y);this.render=this._cacheData.originalRender,renderer.render(this,{renderTexture,clear:!0,transform:m,skipUpdateTransform:!1}),renderer.framebuffer.blit(),renderer.projection.transform=cachedProjectionTransform,renderer.renderTexture.bind(cachedRenderTexture,cachedSourceFrame,cachedDestinationFrame),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=cacheAlpha;var cachedSprite=new Sprite(renderTexture);cachedSprite.transform.worldTransform=this.transform.worldTransform,cachedSprite.anchor.x=-bounds.x/bounds.width,cachedSprite.anchor.y=-bounds.y/bounds.height,cachedSprite.alpha=cacheAlpha,cachedSprite._bounds=this._bounds,this._cacheData.sprite=cachedSprite,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=cachedSprite.containsPoint.bind(cachedSprite)}},DisplayObject.prototype._renderCachedCanvas=function(renderer){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(renderer),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(renderer))},DisplayObject.prototype._initCachedDisplayObjectCanvas=function(renderer){if(!this._cacheData||!this._cacheData.sprite){var bounds=this.getLocalBounds(null,!0),cacheAlpha=this.alpha;this.alpha=1;var cachedRenderTarget=renderer.context,cachedProjectionTransform=renderer._projTransform;bounds.ceil(settings.RESOLUTION);var renderTexture=RenderTexture.create({width:bounds.width,height:bounds.height}),textureCacheId="cacheAsBitmap_"+uid();this._cacheData.textureCacheId=textureCacheId,BaseTexture.addToCache(renderTexture.baseTexture,textureCacheId),Texture.addToCache(renderTexture,textureCacheId);var m=_tempMatrix;this.transform.localTransform.copyTo(m),m.invert(),m.tx-=bounds.x,m.ty-=bounds.y,this.renderCanvas=this._cacheData.originalRenderCanvas,renderer.render(this,{renderTexture,clear:!0,transform:m,skipUpdateTransform:!1}),renderer.context=cachedRenderTarget,renderer._projTransform=cachedProjectionTransform,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=cacheAlpha;var cachedSprite=new Sprite(renderTexture);cachedSprite.transform.worldTransform=this.transform.worldTransform,cachedSprite.anchor.x=-bounds.x/bounds.width,cachedSprite.anchor.y=-bounds.y/bounds.height,cachedSprite.alpha=cacheAlpha,cachedSprite._bounds=this._bounds,this._cacheData.sprite=cachedSprite,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=renderer._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=cachedSprite.containsPoint.bind(cachedSprite)}},DisplayObject.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID},DisplayObject.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)},DisplayObject.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,BaseTexture.removeFromCache(this._cacheData.textureCacheId),Texture.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null},DisplayObject.prototype._cacheAsBitmapDestroy=function(options){this.cacheAsBitmap=!1,this.destroy(options)},DisplayObject.prototype.name=null,Container.prototype.getChildByName=function(name,deep){for(var i=0,j=this.children.length;i<j;i++)if(this.children[i].name===name)return this.children[i];if(deep)for(i=0,j=this.children.length;i<j;i++){if(this.children[i].getChildByName){var target=this.children[i].getChildByName(name,!0);if(target)return target}}return null},DisplayObject.prototype.getGlobalPosition=function(point,skipUpdate){return void 0===point&&(point=new Point),void 0===skipUpdate&&(skipUpdate=!1),this.parent?this.parent.toGlobal(this.position,point,skipUpdate):(point.x=this.position.x,point.y=this.position.y),point};var mesh_extras_extendStatics=function(d,b){return mesh_extras_extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])},mesh_extras_extendStatics(d,b)};function mesh_extras_extends(d,b){function __(){this.constructor=d}mesh_extras_extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}var PlaneGeometry=function(_super){function PlaneGeometry(width,height,segWidth,segHeight){void 0===width&&(width=100),void 0===height&&(height=100),void 0===segWidth&&(segWidth=10),void 0===segHeight&&(segHeight=10);var _this=_super.call(this)||this;return _this.segWidth=segWidth,_this.segHeight=segHeight,_this.width=width,_this.height=height,_this.build(),_this}return mesh_extras_extends(PlaneGeometry,_super),PlaneGeometry.prototype.build=function(){for(var total=this.segWidth*this.segHeight,verts=[],uvs=[],indices=[],segmentsX=this.segWidth-1,segmentsY=this.segHeight-1,sizeX=this.width/segmentsX,sizeY=this.height/segmentsY,i=0;i<total;i++){var x=i%this.segWidth,y=i/this.segWidth|0;verts.push(x*sizeX,y*sizeY),uvs.push(x/segmentsX,y/segmentsY)}var totalSub=segmentsX*segmentsY;for(i=0;i<totalSub;i++){var xpos=i%segmentsX,ypos=i/segmentsX|0,value=ypos*this.segWidth+xpos,value2=ypos*this.segWidth+xpos+1,value3=(ypos+1)*this.segWidth+xpos,value4=(ypos+1)*this.segWidth+xpos+1;indices.push(value,value2,value3,value2,value4,value3)}this.buffers[0].data=new Float32Array(verts),this.buffers[1].data=new Float32Array(uvs),this.indexBuffer.data=new Uint16Array(indices),this.buffers[0].update(),this.buffers[1].update(),this.indexBuffer.update()},PlaneGeometry}(MeshGeometry),RopeGeometry=function(_super){function RopeGeometry(width,points,textureScale){void 0===width&&(width=200),void 0===textureScale&&(textureScale=0);var _this=_super.call(this,new Float32Array(4*points.length),new Float32Array(4*points.length),new Uint16Array(6*(points.length-1)))||this;return _this.points=points,_this._width=width,_this.textureScale=textureScale,_this.build(),_this}return mesh_extras_extends(RopeGeometry,_super),Object.defineProperty(RopeGeometry.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0}),RopeGeometry.prototype.build=function(){var points=this.points;if(points){var vertexBuffer=this.getBuffer("aVertexPosition"),uvBuffer=this.getBuffer("aTextureCoord"),indexBuffer=this.getIndex();if(!(points.length<1)){vertexBuffer.data.length/4!==points.length&&(vertexBuffer.data=new Float32Array(4*points.length),uvBuffer.data=new Float32Array(4*points.length),indexBuffer.data=new Uint16Array(6*(points.length-1)));var uvs=uvBuffer.data,indices=indexBuffer.data;uvs[0]=0,uvs[1]=0,uvs[2]=0,uvs[3]=1;for(var amount=0,prev=points[0],textureWidth=this._width*this.textureScale,total=points.length,i=0;i<total;i++){var index=4*i;if(this.textureScale>0){var dx=prev.x-points[i].x,dy=prev.y-points[i].y,distance=Math.sqrt(dx*dx+dy*dy);prev=points[i],amount+=distance/textureWidth}else amount=i/(total-1);uvs[index]=amount,uvs[index+1]=0,uvs[index+2]=amount,uvs[index+3]=1}var indexCount=0;for(i=0;i<total-1;i++){index=2*i;indices[indexCount++]=index,indices[indexCount++]=index+1,indices[indexCount++]=index+2,indices[indexCount++]=index+2,indices[indexCount++]=index+1,indices[indexCount++]=index+3}uvBuffer.update(),indexBuffer.update(),this.updateVertices()}}},RopeGeometry.prototype.updateVertices=function(){var points=this.points;if(!(points.length<1)){for(var nextPoint,lastPoint=points[0],perpX=0,perpY=0,vertices=this.buffers[0].data,total=points.length,i=0;i<total;i++){var point=points[i],index=4*i;perpY=-((nextPoint=i<points.length-1?points[i+1]:point).x-lastPoint.x),perpX=nextPoint.y-lastPoint.y;var perpLength=Math.sqrt(perpX*perpX+perpY*perpY),num=this.textureScale>0?this.textureScale*this._width/2:this._width/2;perpX/=perpLength,perpY/=perpLength,perpX*=num,perpY*=num,vertices[index]=point.x+perpX,vertices[index+1]=point.y+perpY,vertices[index+2]=point.x-perpX,vertices[index+3]=point.y-perpY,lastPoint=point}this.buffers[0].update()}},RopeGeometry.prototype.update=function(){this.textureScale>0?this.build():this.updateVertices()},RopeGeometry}(MeshGeometry),SimpleRope=function(_super){function SimpleRope(texture,points,textureScale){void 0===textureScale&&(textureScale=0);var _this=this,ropeGeometry=new RopeGeometry(texture.height,points,textureScale),meshMaterial=new MeshMaterial(texture);return textureScale>0&&(texture.baseTexture.wrapMode=constants_WRAP_MODES.REPEAT),(_this=_super.call(this,ropeGeometry,meshMaterial)||this).autoUpdate=!0,_this}return mesh_extras_extends(SimpleRope,_super),SimpleRope.prototype._render=function(renderer){var geometry=this.geometry;(this.autoUpdate||geometry._width!==this.shader.texture.height)&&(geometry._width=this.shader.texture.height,geometry.update()),_super.prototype._render.call(this,renderer)},SimpleRope}(Mesh),SimplePlane=function(_super){function SimplePlane(texture,verticesX,verticesY){var _this=this,planeGeometry=new PlaneGeometry(texture.width,texture.height,verticesX,verticesY),meshMaterial=new MeshMaterial(Texture.WHITE);return(_this=_super.call(this,planeGeometry,meshMaterial)||this).texture=texture,_this.autoResize=!0,_this}return mesh_extras_extends(SimplePlane,_super),SimplePlane.prototype.textureUpdated=function(){this._textureID=this.shader.texture._updateID;var geometry=this.geometry,_a=this.shader.texture,width=_a.width,height=_a.height;!this.autoResize||geometry.width===width&&geometry.height===height||(geometry.width=this.shader.texture.width,geometry.height=this.shader.texture.height,geometry.build())},Object.defineProperty(SimplePlane.prototype,"texture",{get:function(){return this.shader.texture},set:function(value){this.shader.texture!==value&&(this.shader.texture=value,this._textureID=-1,value.baseTexture.valid?this.textureUpdated():value.once("update",this.textureUpdated,this))},enumerable:!1,configurable:!0}),SimplePlane.prototype._render=function(renderer){this._textureID!==this.shader.texture._updateID&&this.textureUpdated(),_super.prototype._render.call(this,renderer)},SimplePlane.prototype.destroy=function(options){this.shader.texture.off("update",this.textureUpdated,this),_super.prototype.destroy.call(this,options)},SimplePlane}(Mesh),SimpleMesh=function(_super){function SimpleMesh(texture,vertices,uvs,indices,drawMode){void 0===texture&&(texture=Texture.EMPTY);var _this=this,geometry=new MeshGeometry(vertices,uvs,indices);geometry.getBuffer("aVertexPosition").static=!1;var meshMaterial=new MeshMaterial(texture);return(_this=_super.call(this,geometry,meshMaterial,null,drawMode)||this).autoUpdate=!0,_this}return mesh_extras_extends(SimpleMesh,_super),Object.defineProperty(SimpleMesh.prototype,"vertices",{get:function(){return this.geometry.getBuffer("aVertexPosition").data},set:function(value){this.geometry.getBuffer("aVertexPosition").data=value},enumerable:!1,configurable:!0}),SimpleMesh.prototype._render=function(renderer){this.autoUpdate&&this.geometry.getBuffer("aVertexPosition").update(),_super.prototype._render.call(this,renderer)},SimpleMesh}(Mesh),NineSlicePlane=function(_super){function NineSlicePlane(texture,leftWidth,topHeight,rightWidth,bottomHeight){void 0===leftWidth&&(leftWidth=10),void 0===topHeight&&(topHeight=10),void 0===rightWidth&&(rightWidth=10),void 0===bottomHeight&&(bottomHeight=10);var _this=_super.call(this,Texture.WHITE,4,4)||this;return _this._origWidth=texture.orig.width,_this._origHeight=texture.orig.height,_this._width=_this._origWidth,_this._height=_this._origHeight,_this._leftWidth=leftWidth,_this._rightWidth=rightWidth,_this._topHeight=topHeight,_this._bottomHeight=bottomHeight,_this.texture=texture,_this}return mesh_extras_extends(NineSlicePlane,_super),NineSlicePlane.prototype.textureUpdated=function(){this._textureID=this.shader.texture._updateID,this._refresh()},Object.defineProperty(NineSlicePlane.prototype,"vertices",{get:function(){return this.geometry.getBuffer("aVertexPosition").data},set:function(value){this.geometry.getBuffer("aVertexPosition").data=value},enumerable:!1,configurable:!0}),NineSlicePlane.prototype.updateHorizontalVertices=function(){var vertices=this.vertices,scale=this._getMinScale();vertices[9]=vertices[11]=vertices[13]=vertices[15]=this._topHeight*scale,vertices[17]=vertices[19]=vertices[21]=vertices[23]=this._height-this._bottomHeight*scale,vertices[25]=vertices[27]=vertices[29]=vertices[31]=this._height},NineSlicePlane.prototype.updateVerticalVertices=function(){var vertices=this.vertices,scale=this._getMinScale();vertices[2]=vertices[10]=vertices[18]=vertices[26]=this._leftWidth*scale,vertices[4]=vertices[12]=vertices[20]=vertices[28]=this._width-this._rightWidth*scale,vertices[6]=vertices[14]=vertices[22]=vertices[30]=this._width},NineSlicePlane.prototype._getMinScale=function(){var w=this._leftWidth+this._rightWidth,scaleW=this._width>w?1:this._width/w,h=this._topHeight+this._bottomHeight,scaleH=this._height>h?1:this._height/h;return Math.min(scaleW,scaleH)},Object.defineProperty(NineSlicePlane.prototype,"width",{get:function(){return this._width},set:function(value){this._width=value,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(NineSlicePlane.prototype,"height",{get:function(){return this._height},set:function(value){this._height=value,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(NineSlicePlane.prototype,"leftWidth",{get:function(){return this._leftWidth},set:function(value){this._leftWidth=value,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(NineSlicePlane.prototype,"rightWidth",{get:function(){return this._rightWidth},set:function(value){this._rightWidth=value,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(NineSlicePlane.prototype,"topHeight",{get:function(){return this._topHeight},set:function(value){this._topHeight=value,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(NineSlicePlane.prototype,"bottomHeight",{get:function(){return this._bottomHeight},set:function(value){this._bottomHeight=value,this._refresh()},enumerable:!1,configurable:!0}),NineSlicePlane.prototype._refresh=function(){var texture=this.texture,uvs=this.geometry.buffers[1].data;this._origWidth=texture.orig.width,this._origHeight=texture.orig.height;var _uvw=1/this._origWidth,_uvh=1/this._origHeight;uvs[0]=uvs[8]=uvs[16]=uvs[24]=0,uvs[1]=uvs[3]=uvs[5]=uvs[7]=0,uvs[6]=uvs[14]=uvs[22]=uvs[30]=1,uvs[25]=uvs[27]=uvs[29]=uvs[31]=1,uvs[2]=uvs[10]=uvs[18]=uvs[26]=_uvw*this._leftWidth,uvs[4]=uvs[12]=uvs[20]=uvs[28]=1-_uvw*this._rightWidth,uvs[9]=uvs[11]=uvs[13]=uvs[15]=_uvh*this._topHeight,uvs[17]=uvs[19]=uvs[21]=uvs[23]=1-_uvh*this._bottomHeight,this.updateHorizontalVertices(),this.updateVerticalVertices(),this.geometry.buffers[0].update(),this.geometry.buffers[1].update()},NineSlicePlane}(SimplePlane),sprite_animated_extendStatics=function(d,b){return sprite_animated_extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])},sprite_animated_extendStatics(d,b)};!function(_super){function AnimatedSprite(textures,autoUpdate){void 0===autoUpdate&&(autoUpdate=!0);var _this=_super.call(this,textures[0]instanceof Texture?textures[0]:textures[0].texture)||this;return _this._textures=null,_this._durations=null,_this._autoUpdate=autoUpdate,_this._isConnectedToTicker=!1,_this.animationSpeed=1,_this.loop=!0,_this.updateAnchor=!1,_this.onComplete=null,_this.onFrameChange=null,_this.onLoop=null,_this._currentTime=0,_this._playing=!1,_this._previousFrame=null,_this.textures=textures,_this}(function(d,b){function __(){this.constructor=d}sprite_animated_extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)})(AnimatedSprite,_super),AnimatedSprite.prototype.stop=function(){this._playing&&(this._playing=!1,this._autoUpdate&&this._isConnectedToTicker&&(Ticker.shared.remove(this.update,this),this._isConnectedToTicker=!1))},AnimatedSprite.prototype.play=function(){this._playing||(this._playing=!0,this._autoUpdate&&!this._isConnectedToTicker&&(Ticker.shared.add(this.update,this,UPDATE_PRIORITY.HIGH),this._isConnectedToTicker=!0))},AnimatedSprite.prototype.gotoAndStop=function(frameNumber){this.stop();var previousFrame=this.currentFrame;this._currentTime=frameNumber,previousFrame!==this.currentFrame&&this.updateTexture()},AnimatedSprite.prototype.gotoAndPlay=function(frameNumber){var previousFrame=this.currentFrame;this._currentTime=frameNumber,previousFrame!==this.currentFrame&&this.updateTexture(),this.play()},AnimatedSprite.prototype.update=function(deltaTime){if(this._playing){var elapsed=this.animationSpeed*deltaTime,previousFrame=this.currentFrame;if(null!==this._durations){var lag=this._currentTime%1*this._durations[this.currentFrame];for(lag+=elapsed/60*1e3;lag<0;)this._currentTime--,lag+=this._durations[this.currentFrame];var sign=Math.sign(this.animationSpeed*deltaTime);for(this._currentTime=Math.floor(this._currentTime);lag>=this._durations[this.currentFrame];)lag-=this._durations[this.currentFrame]*sign,this._currentTime+=sign;this._currentTime+=lag/this._durations[this.currentFrame]}else this._currentTime+=elapsed;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):previousFrame!==this.currentFrame&&(this.loop&&this.onLoop&&(this.animationSpeed>0&&this.currentFrame<previousFrame||this.animationSpeed<0&&this.currentFrame>previousFrame)&&this.onLoop(),this.updateTexture())}},AnimatedSprite.prototype.updateTexture=function(){var currentFrame=this.currentFrame;this._previousFrame!==currentFrame&&(this._previousFrame=currentFrame,this._texture=this._textures[currentFrame],this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this.uvs=this._texture._uvs.uvsFloat32,this.updateAnchor&&this._anchor.copyFrom(this._texture.defaultAnchor),this.onFrameChange&&this.onFrameChange(this.currentFrame))},AnimatedSprite.prototype.destroy=function(options){this.stop(),_super.prototype.destroy.call(this,options),this.onComplete=null,this.onFrameChange=null,this.onLoop=null},AnimatedSprite.fromFrames=function(frames){for(var textures=[],i=0;i<frames.length;++i)textures.push(Texture.from(frames[i]));return new AnimatedSprite(textures)},AnimatedSprite.fromImages=function(images){for(var textures=[],i=0;i<images.length;++i)textures.push(Texture.from(images[i]));return new AnimatedSprite(textures)},Object.defineProperty(AnimatedSprite.prototype,"totalFrames",{get:function(){return this._textures.length},enumerable:!1,configurable:!0}),Object.defineProperty(AnimatedSprite.prototype,"textures",{get:function(){return this._textures},set:function(value){if(value[0]instanceof Texture)this._textures=value,this._durations=null;else{this._textures=[],this._durations=[];for(var i=0;i<value.length;i++)this._textures.push(value[i].texture),this._durations.push(value[i].time)}this._previousFrame=null,this.gotoAndStop(0),this.updateTexture()},enumerable:!1,configurable:!0}),Object.defineProperty(AnimatedSprite.prototype,"currentFrame",{get:function(){var currentFrame=Math.floor(this._currentTime)%this._textures.length;return currentFrame<0&&(currentFrame+=this._textures.length),currentFrame},enumerable:!1,configurable:!0}),Object.defineProperty(AnimatedSprite.prototype,"playing",{get:function(){return this._playing},enumerable:!1,configurable:!0}),Object.defineProperty(AnimatedSprite.prototype,"autoUpdate",{get:function(){return this._autoUpdate},set:function(value){value!==this._autoUpdate&&(this._autoUpdate=value,!this._autoUpdate&&this._isConnectedToTicker?(Ticker.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._playing&&(Ticker.shared.add(this.update,this),this._isConnectedToTicker=!0))},enumerable:!1,configurable:!0})}(Sprite);Renderer.registerPlugin("accessibility",AccessibilityManager),Renderer.registerPlugin("extract",Extract),Renderer.registerPlugin("interaction",InteractionManager),Renderer.registerPlugin("particle",ParticleRenderer),Renderer.registerPlugin("prepare",Prepare),Renderer.registerPlugin("batch",BatchRenderer),Renderer.registerPlugin("tilingSprite",TilingSpriteRenderer),Loader.registerPlugin(BitmapFontLoader),Loader.registerPlugin(CompressedTextureLoader),Loader.registerPlugin(DDSLoader),Loader.registerPlugin(KTXLoader),Loader.registerPlugin(SpritesheetLoader),Application.registerPlugin(TickerPlugin),Application.registerPlugin(AppLoaderPlugin);var canvas_renderer_extendStatics=function(d,b){return canvas_renderer_extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])},canvas_renderer_extendStatics(d,b)};var CanvasMaskManager=function(){function CanvasMaskManager(renderer){this._foundShapes=[],this.renderer=renderer}return CanvasMaskManager.prototype.pushMask=function(maskData){var renderer=this.renderer,maskObject=maskData.maskObject||maskData;renderer.context.save();var foundShapes=this._foundShapes;if(this.recursiveFindShapes(maskObject,foundShapes),foundShapes.length>0){var context=renderer.context;context.beginPath();for(var i=0;i<foundShapes.length;i++){var shape=foundShapes[i],transform=shape.transform.worldTransform;this.renderer.setContextTransform(transform),this.renderGraphicsShape(shape)}foundShapes.length=0,context.clip()}},CanvasMaskManager.prototype.recursiveFindShapes=function(container,out){container.geometry&&container.geometry.graphicsData&&out.push(container);var children=container.children;if(children)for(var i=0;i<children.length;i++)this.recursiveFindShapes(children[i],out)},CanvasMaskManager.prototype.renderGraphicsShape=function(graphics){graphics.finishPoly();var context=this.renderer.context,graphicsData=graphics.geometry.graphicsData,len=graphicsData.length;if(0!==len)for(var i=0;i<len;i++){var data=graphicsData[i],shape=data.shape;if(shape.type===SHAPES.POLY){var points=shape.points,holes=data.holes,outerArea=void 0,innerArea=void 0,px=void 0,py=void 0;context.moveTo(points[0],points[1]);for(var j=1;j<points.length/2;j++)context.lineTo(points[2*j],points[2*j+1]);if(holes.length>0){outerArea=0,px=points[0],py=points[1];for(j=2;j+2<points.length;j+=2)outerArea+=(points[j]-px)*(points[j+3]-py)-(points[j+2]-px)*(points[j+1]-py);for(var k=0;k<holes.length;k++)if(points=holes[k].shape.points){innerArea=0,px=points[0],py=points[1];for(j=2;j+2<points.length;j+=2)innerArea+=(points[j]-px)*(points[j+3]-py)-(points[j+2]-px)*(points[j+1]-py);if(innerArea*outerArea<0){context.moveTo(points[0],points[1]);for(j=2;j<points.length;j+=2)context.lineTo(points[j],points[j+1])}else{context.moveTo(points[points.length-2],points[points.length-1]);for(j=points.length-4;j>=0;j-=2)context.lineTo(points[j],points[j+1])}holes[k].shape.closeStroke&&context.closePath()}}points[0]===points[points.length-2]&&points[1]===points[points.length-1]&&context.closePath()}else if(shape.type===SHAPES.RECT)context.rect(shape.x,shape.y,shape.width,shape.height),context.closePath();else if(shape.type===SHAPES.CIRC)context.arc(shape.x,shape.y,shape.radius,0,2*Math.PI),context.closePath();else if(shape.type===SHAPES.ELIP){var w=2*shape.width,h=2*shape.height,x=shape.x-w/2,y=shape.y-h/2,ox=w/2*.5522848,oy=h/2*.5522848,xe=x+w,ye=y+h,xm=x+w/2,ym=y+h/2;context.moveTo(x,ym),context.bezierCurveTo(x,ym-oy,xm-ox,y,xm,y),context.bezierCurveTo(xm+ox,y,xe,ym-oy,xe,ym),context.bezierCurveTo(xe,ym+oy,xm+ox,ye,xm,ye),context.bezierCurveTo(xm-ox,ye,x,ym+oy,x,ym),context.closePath()}else if(shape.type===SHAPES.RREC){var rx=shape.x,ry=shape.y,width=shape.width,height=shape.height,radius=shape.radius,maxRadius=Math.min(width,height)/2;radius=radius>maxRadius?maxRadius:radius,context.moveTo(rx,ry+radius),context.lineTo(rx,ry+height-radius),context.quadraticCurveTo(rx,ry+height,rx+radius,ry+height),context.lineTo(rx+width-radius,ry+height),context.quadraticCurveTo(rx+width,ry+height,rx+width,ry+height-radius),context.lineTo(rx+width,ry+radius),context.quadraticCurveTo(rx+width,ry,rx+width-radius,ry),context.lineTo(rx+radius,ry),context.quadraticCurveTo(rx,ry,rx,ry+radius),context.closePath()}}},CanvasMaskManager.prototype.popMask=function(renderer){renderer.context.restore(),renderer.invalidateBlendMode()},CanvasMaskManager.prototype.destroy=function(){},CanvasMaskManager}();function createColoredCanvas(color){var canvas=document.createElement("canvas");canvas.width=6,canvas.height=1;var context=canvas.getContext("2d");return context.fillStyle=color,context.fillRect(0,0,6,1),canvas}function canUseNewCanvasBlendModes(){if("undefined"==typeof document)return!1;var magenta=createColoredCanvas("#ff00ff"),yellow=createColoredCanvas("#ffff00"),canvas=document.createElement("canvas");canvas.width=6,canvas.height=1;var context=canvas.getContext("2d");context.globalCompositeOperation="multiply",context.drawImage(magenta,0,0),context.drawImage(yellow,2,0);var imageData=context.getImageData(2,0,1,1);if(!imageData)return!1;var data=imageData.data;return 255===data[0]&&0===data[1]&&0===data[2]}var canvas_renderer_tempMatrix=new Matrix,CanvasRenderer=function(_super){function CanvasRenderer(options){var array,_this=_super.call(this,constants_RENDERER_TYPE.CANVAS,options)||this;if(_this.refresh=!0,_this.maskManager=new CanvasMaskManager(_this),_this.smoothProperty="imageSmoothingEnabled",_this.blendModes=(void 0===array&&(array=[]),canUseNewCanvasBlendModes()?(array[constants_BLEND_MODES.NORMAL]="source-over",array[constants_BLEND_MODES.ADD]="lighter",array[constants_BLEND_MODES.MULTIPLY]="multiply",array[constants_BLEND_MODES.SCREEN]="screen",array[constants_BLEND_MODES.OVERLAY]="overlay",array[constants_BLEND_MODES.DARKEN]="darken",array[constants_BLEND_MODES.LIGHTEN]="lighten",array[constants_BLEND_MODES.COLOR_DODGE]="color-dodge",array[constants_BLEND_MODES.COLOR_BURN]="color-burn",array[constants_BLEND_MODES.HARD_LIGHT]="hard-light",array[constants_BLEND_MODES.SOFT_LIGHT]="soft-light",array[constants_BLEND_MODES.DIFFERENCE]="difference",array[constants_BLEND_MODES.EXCLUSION]="exclusion",array[constants_BLEND_MODES.HUE]="hue",array[constants_BLEND_MODES.SATURATION]="saturate",array[constants_BLEND_MODES.COLOR]="color",array[constants_BLEND_MODES.LUMINOSITY]="luminosity"):(array[constants_BLEND_MODES.NORMAL]="source-over",array[constants_BLEND_MODES.ADD]="lighter",array[constants_BLEND_MODES.MULTIPLY]="source-over",array[constants_BLEND_MODES.SCREEN]="source-over",array[constants_BLEND_MODES.OVERLAY]="source-over",array[constants_BLEND_MODES.DARKEN]="source-over",array[constants_BLEND_MODES.LIGHTEN]="source-over",array[constants_BLEND_MODES.COLOR_DODGE]="source-over",array[constants_BLEND_MODES.COLOR_BURN]="source-over",array[constants_BLEND_MODES.HARD_LIGHT]="source-over",array[constants_BLEND_MODES.SOFT_LIGHT]="source-over",array[constants_BLEND_MODES.DIFFERENCE]="source-over",array[constants_BLEND_MODES.EXCLUSION]="source-over",array[constants_BLEND_MODES.HUE]="source-over",array[constants_BLEND_MODES.SATURATION]="source-over",array[constants_BLEND_MODES.COLOR]="source-over",array[constants_BLEND_MODES.LUMINOSITY]="source-over"),array[constants_BLEND_MODES.NORMAL_NPM]=array[constants_BLEND_MODES.NORMAL],array[constants_BLEND_MODES.ADD_NPM]=array[constants_BLEND_MODES.ADD],array[constants_BLEND_MODES.SCREEN_NPM]=array[constants_BLEND_MODES.SCREEN],array[constants_BLEND_MODES.SRC_IN]="source-in",array[constants_BLEND_MODES.SRC_OUT]="source-out",array[constants_BLEND_MODES.SRC_ATOP]="source-atop",array[constants_BLEND_MODES.DST_OVER]="destination-over",array[constants_BLEND_MODES.DST_IN]="destination-in",array[constants_BLEND_MODES.DST_OUT]="destination-out",array[constants_BLEND_MODES.DST_ATOP]="destination-atop",array[constants_BLEND_MODES.XOR]="xor",array[constants_BLEND_MODES.SUBTRACT]="source-over",array),_this.renderingToScreen=!1,_this._activeBlendMode=null,_this._projTransform=null,_this._outerBlend=!1,_this.rootContext=_this.view.getContext("2d",{alpha:_this.useContextAlpha}),_this.context=_this.rootContext,!_this.rootContext.imageSmoothingEnabled){var rc=_this.rootContext;rc.webkitImageSmoothingEnabled?_this.smoothProperty="webkitImageSmoothingEnabled":rc.mozImageSmoothingEnabled?_this.smoothProperty="mozImageSmoothingEnabled":rc.oImageSmoothingEnabled?_this.smoothProperty="oImageSmoothingEnabled":rc.msImageSmoothingEnabled&&(_this.smoothProperty="msImageSmoothingEnabled")}return _this.initPlugins(CanvasRenderer.__plugins),sayHello("Canvas"),_this.resize(_this.options.width,_this.options.height),_this}return function(d,b){function __(){this.constructor=d}canvas_renderer_extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}(CanvasRenderer,_super),CanvasRenderer.prototype.addSystem=function(){return this},CanvasRenderer.prototype.render=function(displayObject,options){if(this.view){var renderTexture,clear,transform,skipUpdateTransform;options&&(options instanceof RenderTexture||options instanceof BaseRenderTexture?(deprecation("6.0.0","CanvasRenderer#render arguments changed, use options instead."),renderTexture=options,clear=arguments[2],transform=arguments[3],skipUpdateTransform=arguments[4]):(renderTexture=options.renderTexture,clear=options.clear,transform=options.transform,skipUpdateTransform=options.skipUpdateTransform)),this.renderingToScreen=!renderTexture,this.emit("prerender");var rootResolution=this.resolution;renderTexture?((renderTexture=renderTexture.castToBaseTexture())._canvasRenderTarget||(renderTexture._canvasRenderTarget=new CanvasRenderTarget(renderTexture.width,renderTexture.height,renderTexture.resolution),renderTexture.resource=new CanvasResource(renderTexture._canvasRenderTarget.canvas),renderTexture.valid=!0),this.context=renderTexture._canvasRenderTarget.context,this.resolution=renderTexture._canvasRenderTarget.resolution):this.context=this.rootContext;var context=this.context;if(this._projTransform=transform||null,renderTexture||(this._lastObjectRendered=displayObject),!skipUpdateTransform){var cacheParent=displayObject.enableTempParent();displayObject.updateTransform(),displayObject.disableTempParent(cacheParent)}if(context.save(),context.setTransform(1,0,0,1,0,0),context.globalAlpha=1,this._activeBlendMode=constants_BLEND_MODES.NORMAL,this._outerBlend=!1,context.globalCompositeOperation=this.blendModes[constants_BLEND_MODES.NORMAL],void 0!==clear?clear:this.clearBeforeRender)if(this.renderingToScreen)context.clearRect(0,0,this.width,this.height),this.backgroundAlpha>0&&(context.globalAlpha=this.useContextAlpha?this.backgroundAlpha:1,context.fillStyle=this._backgroundColorString,context.fillRect(0,0,this.width,this.height),context.globalAlpha=1);else{(renderTexture=renderTexture)._canvasRenderTarget.clear();var clearColor=renderTexture.clearColor;clearColor[3]>0&&(context.globalAlpha=this.useContextAlpha?clearColor[3]:1,context.fillStyle=hex2string(rgb2hex(clearColor)),context.fillRect(0,0,renderTexture.realWidth,renderTexture.realHeight),context.globalAlpha=1)}var tempContext=this.context;this.context=context,displayObject.renderCanvas(this),this.context=tempContext,context.restore(),this.resolution=rootResolution,this._projTransform=null,this.emit("postrender")}},CanvasRenderer.prototype.setContextTransform=function(transform,roundPixels,localResolution){var mat=transform,proj=this._projTransform,resolution=this.resolution;localResolution=localResolution||resolution,proj&&((mat=canvas_renderer_tempMatrix).copyFrom(transform),mat.prepend(proj)),roundPixels?this.context.setTransform(mat.a*localResolution,mat.b*localResolution,mat.c*localResolution,mat.d*localResolution,mat.tx*resolution|0,mat.ty*resolution|0):this.context.setTransform(mat.a*localResolution,mat.b*localResolution,mat.c*localResolution,mat.d*localResolution,mat.tx*resolution,mat.ty*resolution)},CanvasRenderer.prototype.clear=function(clearColor,alpha){void 0===clearColor&&(clearColor=this._backgroundColorString),void 0===alpha&&(alpha=this.backgroundAlpha);var context=this.context;context.clearRect(0,0,this.width,this.height),clearColor&&(context.globalAlpha=this.useContextAlpha?alpha:1,context.fillStyle=clearColor,context.fillRect(0,0,this.width,this.height),context.globalAlpha=1)},CanvasRenderer.prototype.setBlendMode=function(blendMode,readyForOuterBlend){var outerBlend=blendMode===constants_BLEND_MODES.SRC_IN||blendMode===constants_BLEND_MODES.SRC_OUT||blendMode===constants_BLEND_MODES.DST_IN||blendMode===constants_BLEND_MODES.DST_ATOP;!readyForOuterBlend&&outerBlend&&(blendMode=constants_BLEND_MODES.NORMAL),this._activeBlendMode!==blendMode&&(this._activeBlendMode=blendMode,this._outerBlend=outerBlend,this.context.globalCompositeOperation=this.blendModes[blendMode])},CanvasRenderer.prototype.destroy=function(removeView){_super.prototype.destroy.call(this,removeView),this.context=null,this.refresh=!0,this.maskManager.destroy(),this.maskManager=null,this.smoothProperty=null},CanvasRenderer.prototype.resize=function(desiredScreenWidth,desiredScreenHeight){_super.prototype.resize.call(this,desiredScreenWidth,desiredScreenHeight),this.smoothProperty&&(this.rootContext[this.smoothProperty]=settings.SCALE_MODE===constants_SCALE_MODES.LINEAR)},CanvasRenderer.prototype.invalidateBlendMode=function(){this._activeBlendMode=this.blendModes.indexOf(this.context.globalCompositeOperation)},CanvasRenderer.registerPlugin=function(pluginName,ctor){CanvasRenderer.__plugins=CanvasRenderer.__plugins||{},CanvasRenderer.__plugins[pluginName]=ctor},CanvasRenderer}(AbstractRenderer),canvasUtils={canvas:null,getTintedCanvas:function(sprite,color){var texture=sprite.texture,stringColor="#"+("00000"+(0|(color=canvasUtils.roundColor(color))).toString(16)).slice(-6);texture.tintCache=texture.tintCache||{};var canvas,cachedCanvas=texture.tintCache[stringColor];if(cachedCanvas){if(cachedCanvas.tintId===texture._updateID)return texture.tintCache[stringColor];canvas=texture.tintCache[stringColor]}else canvas=document.createElement("canvas");if(canvasUtils.tintMethod(texture,color,canvas),canvas.tintId=texture._updateID,canvasUtils.convertTintToImage){var tintImage=new Image;tintImage.src=canvas.toDataURL(),texture.tintCache[stringColor]=tintImage}else texture.tintCache[stringColor]=canvas;return canvas},getTintedPattern:function(texture,color){var stringColor="#"+("00000"+(0|(color=canvasUtils.roundColor(color))).toString(16)).slice(-6);texture.patternCache=texture.patternCache||{};var pattern=texture.patternCache[stringColor];return pattern&&pattern.tintId===texture._updateID||(canvasUtils.canvas||(canvasUtils.canvas=document.createElement("canvas")),canvasUtils.tintMethod(texture,color,canvasUtils.canvas),(pattern=canvasUtils.canvas.getContext("2d").createPattern(canvasUtils.canvas,"repeat")).tintId=texture._updateID,texture.patternCache[stringColor]=pattern),pattern},tintWithMultiply:function(texture,color,canvas){var context=canvas.getContext("2d"),crop=texture._frame.clone(),resolution=texture.baseTexture.resolution;crop.x*=resolution,crop.y*=resolution,crop.width*=resolution,crop.height*=resolution,canvas.width=Math.ceil(crop.width),canvas.height=Math.ceil(crop.height),context.save(),context.fillStyle="#"+("00000"+(0|color).toString(16)).slice(-6),context.fillRect(0,0,crop.width,crop.height),context.globalCompositeOperation="multiply";var source=texture.baseTexture.getDrawableSource();context.drawImage(source,crop.x,crop.y,crop.width,crop.height,0,0,crop.width,crop.height),context.globalCompositeOperation="destination-atop",context.drawImage(source,crop.x,crop.y,crop.width,crop.height,0,0,crop.width,crop.height),context.restore()},tintWithOverlay:function(texture,color,canvas){var context=canvas.getContext("2d"),crop=texture._frame.clone(),resolution=texture.baseTexture.resolution;crop.x*=resolution,crop.y*=resolution,crop.width*=resolution,crop.height*=resolution,canvas.width=Math.ceil(crop.width),canvas.height=Math.ceil(crop.height),context.save(),context.globalCompositeOperation="copy",context.fillStyle="#"+("00000"+(0|color).toString(16)).slice(-6),context.fillRect(0,0,crop.width,crop.height),context.globalCompositeOperation="destination-atop",context.drawImage(texture.baseTexture.getDrawableSource(),crop.x,crop.y,crop.width,crop.height,0,0,crop.width,crop.height),context.restore()},tintWithPerPixel:function(texture,color,canvas){var context=canvas.getContext("2d"),crop=texture._frame.clone(),resolution=texture.baseTexture.resolution;crop.x*=resolution,crop.y*=resolution,crop.width*=resolution,crop.height*=resolution,canvas.width=Math.ceil(crop.width),canvas.height=Math.ceil(crop.height),context.save(),context.globalCompositeOperation="copy",context.drawImage(texture.baseTexture.getDrawableSource(),crop.x,crop.y,crop.width,crop.height,0,0,crop.width,crop.height),context.restore();for(var rgbValues=hex2rgb(color),r=rgbValues[0],g=rgbValues[1],b=rgbValues[2],pixelData=context.getImageData(0,0,crop.width,crop.height),pixels=pixelData.data,i=0;i<pixels.length;i+=4)pixels[i+0]*=r,pixels[i+1]*=g,pixels[i+2]*=b;context.putImageData(pixelData,0,0)},roundColor:function(color){var step=canvasUtils.cacheStepsPerColorChannel,rgbValues=hex2rgb(color);return rgbValues[0]=Math.min(255,rgbValues[0]/step*step),rgbValues[1]=Math.min(255,rgbValues[1]/step*step),rgbValues[2]=Math.min(255,rgbValues[2]/step*step),rgb2hex(rgbValues)},cacheStepsPerColorChannel:8,convertTintToImage:!1,canUseMultiply:canUseNewCanvasBlendModes(),tintMethod:null};canvasUtils.tintMethod=canvasUtils.canUseMultiply?canvasUtils.tintWithMultiply:canvasUtils.tintWithPerPixel;var parentCreate=Renderer.create;Renderer.create=function(options){if(!(options&&options.forceCanvas))try{return parentCreate(options)}catch(err){}return new CanvasRenderer(options)},BaseTexture.prototype.getDrawableSource=function(){var resource=this.resource;return resource?resource.bitmap||resource.source:null},BaseRenderTexture.prototype._canvasRenderTarget=null,Texture.prototype.patternCache=null,Texture.prototype.tintCache=null;var commonjsGlobal="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==__webpack_require__.g?__webpack_require__.g:"undefined"!=typeof self?self:{};function createCommonjsModule(fn,basedir,module){return fn(module={path:basedir,exports:{},require:function(path,base){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==base&&module.path)}},module.exports),module.exports}var canvas_mesh_eventemitter3=createCommonjsModule((function(module){var has=Object.prototype.hasOwnProperty,prefix="~";function Events(){}function EE(fn,context,once){this.fn=fn,this.context=context,this.once=once||!1}function addListener(emitter,event,fn,context,once){if("function"!=typeof fn)throw new TypeError("The listener must be a function");var listener=new EE(fn,context||emitter,once),evt=prefix?prefix+event:event;return emitter._events[evt]?emitter._events[evt].fn?emitter._events[evt]=[emitter._events[evt],listener]:emitter._events[evt].push(listener):(emitter._events[evt]=listener,emitter._eventsCount++),emitter}function clearEvent(emitter,evt){0==--emitter._eventsCount?emitter._events=new Events:delete emitter._events[evt]}function EventEmitter(){this._events=new Events,this._eventsCount=0}Object.create&&(Events.prototype=Object.create(null),(new Events).__proto__||(prefix=!1)),EventEmitter.prototype.eventNames=function(){var events,name,names=[];if(0===this._eventsCount)return names;for(name in events=this._events)has.call(events,name)&&names.push(prefix?name.slice(1):name);return Object.getOwnPropertySymbols?names.concat(Object.getOwnPropertySymbols(events)):names},EventEmitter.prototype.listeners=function(event){var evt=prefix?prefix+event:event,handlers=this._events[evt];if(!handlers)return[];if(handlers.fn)return[handlers.fn];for(var i=0,l=handlers.length,ee=new Array(l);i<l;i++)ee[i]=handlers[i].fn;return ee},EventEmitter.prototype.listenerCount=function(event){var evt=prefix?prefix+event:event,listeners=this._events[evt];return listeners?listeners.fn?1:listeners.length:0},EventEmitter.prototype.emit=function(event,a1,a2,a3,a4,a5){var arguments$1=arguments,evt=prefix?prefix+event:event;if(!this._events[evt])return!1;var args,i,listeners=this._events[evt],len=arguments.length;if(listeners.fn){switch(listeners.once&&this.removeListener(event,listeners.fn,void 0,!0),len){case 1:return listeners.fn.call(listeners.context),!0;case 2:return listeners.fn.call(listeners.context,a1),!0;case 3:return listeners.fn.call(listeners.context,a1,a2),!0;case 4:return listeners.fn.call(listeners.context,a1,a2,a3),!0;case 5:return listeners.fn.call(listeners.context,a1,a2,a3,a4),!0;case 6:return listeners.fn.call(listeners.context,a1,a2,a3,a4,a5),!0}for(i=1,args=new Array(len-1);i<len;i++)args[i-1]=arguments$1[i];listeners.fn.apply(listeners.context,args)}else{var j,length=listeners.length;for(i=0;i<length;i++)switch(listeners[i].once&&this.removeListener(event,listeners[i].fn,void 0,!0),len){case 1:listeners[i].fn.call(listeners[i].context);break;case 2:listeners[i].fn.call(listeners[i].context,a1);break;case 3:listeners[i].fn.call(listeners[i].context,a1,a2);break;case 4:listeners[i].fn.call(listeners[i].context,a1,a2,a3);break;default:if(!args)for(j=1,args=new Array(len-1);j<len;j++)args[j-1]=arguments$1[j];listeners[i].fn.apply(listeners[i].context,args)}}return!0},EventEmitter.prototype.on=function(event,fn,context){return addListener(this,event,fn,context,!1)},EventEmitter.prototype.once=function(event,fn,context){return addListener(this,event,fn,context,!0)},EventEmitter.prototype.removeListener=function(event,fn,context,once){var evt=prefix?prefix+event:event;if(!this._events[evt])return this;if(!fn)return clearEvent(this,evt),this;var listeners=this._events[evt];if(listeners.fn)listeners.fn!==fn||once&&!listeners.once||context&&listeners.context!==context||clearEvent(this,evt);else{for(var i=0,events=[],length=listeners.length;i<length;i++)(listeners[i].fn!==fn||once&&!listeners[i].once||context&&listeners[i].context!==context)&&events.push(listeners[i]);events.length?this._events[evt]=1===events.length?events[0]:events:clearEvent(this,evt)}return this},EventEmitter.prototype.removeAllListeners=function(event){var evt;return event?(evt=prefix?prefix+event:event,this._events[evt]&&clearEvent(this,evt)):(this._events=new Events,this._eventsCount=0),this},EventEmitter.prototype.off=EventEmitter.prototype.removeListener,EventEmitter.prototype.addListener=EventEmitter.prototype.on,EventEmitter.prefixed=prefix,EventEmitter.EventEmitter=EventEmitter,module.exports=EventEmitter})),punycode=createCommonjsModule((function(module,exports){!function(root){var freeExports=exports&&!exports.nodeType&&exports,freeModule=module&&!module.nodeType&&module,freeGlobal="object"==typeof commonjsGlobal&&commonjsGlobal;freeGlobal.global!==freeGlobal&&freeGlobal.window!==freeGlobal&&freeGlobal.self!==freeGlobal||(root=freeGlobal);var punycode,key,maxInt=2147483647,regexPunycode=/^xn--/,regexNonASCII=/[^\x20-\x7E]/,regexSeparators=/[\x2E\u3002\uFF0E\uFF61]/g,errors={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},floor=Math.floor,stringFromCharCode=String.fromCharCode;function error(type){throw RangeError(errors[type])}function map(array,fn){for(var length=array.length,result=[];length--;)result[length]=fn(array[length]);return result}function mapDomain(string,fn){var parts=string.split("@"),result="";return parts.length>1&&(result=parts[0]+"@",string=parts[1]),result+map((string=string.replace(regexSeparators,".")).split("."),fn).join(".")}function ucs2decode(string){for(var value,extra,output=[],counter=0,length=string.length;counter<length;)(value=string.charCodeAt(counter++))>=55296&&value<=56319&&counter<length?56320==(64512&(extra=string.charCodeAt(counter++)))?output.push(((1023&value)<<10)+(1023&extra)+65536):(output.push(value),counter--):output.push(value);return output}function ucs2encode(array){return map(array,(function(value){var output="";return value>65535&&(output+=stringFromCharCode((value-=65536)>>>10&1023|55296),value=56320|1023&value),output+=stringFromCharCode(value)})).join("")}function digitToBasic(digit,flag){return digit+22+75*(digit<26)-((0!=flag)<<5)}function adapt(delta,numPoints,firstTime){var k=0;for(delta=firstTime?floor(delta/700):delta>>1,delta+=floor(delta/numPoints);delta>455;k+=36)delta=floor(delta/35);return floor(k+36*delta/(delta+38))}function decode(input){var out,basic,j,index,oldi,w,k,digit,t,baseMinusT,codePoint,output=[],inputLength=input.length,i=0,n=128,bias=72;for((basic=input.lastIndexOf("-"))<0&&(basic=0),j=0;j<basic;++j)input.charCodeAt(j)>=128&&error("not-basic"),output.push(input.charCodeAt(j));for(index=basic>0?basic+1:0;index<inputLength;){for(oldi=i,w=1,k=36;index>=inputLength&&error("invalid-input"),((digit=(codePoint=input.charCodeAt(index++))-48<10?codePoint-22:codePoint-65<26?codePoint-65:codePoint-97<26?codePoint-97:36)>=36||digit>floor((maxInt-i)/w))&&error("overflow"),i+=digit*w,!(digit<(t=k<=bias?1:k>=bias+26?26:k-bias));k+=36)w>floor(maxInt/(baseMinusT=36-t))&&error("overflow"),w*=baseMinusT;bias=adapt(i-oldi,out=output.length+1,0==oldi),floor(i/out)>maxInt-n&&error("overflow"),n+=floor(i/out),i%=out,output.splice(i++,0,n)}return ucs2encode(output)}function encode(input){var n,delta,handledCPCount,basicLength,bias,j,m,q,k,t,currentValue,inputLength,handledCPCountPlusOne,baseMinusT,qMinusT,output=[];for(inputLength=(input=ucs2decode(input)).length,n=128,delta=0,bias=72,j=0;j<inputLength;++j)(currentValue=input[j])<128&&output.push(stringFromCharCode(currentValue));for(handledCPCount=basicLength=output.length,basicLength&&output.push("-");handledCPCount<inputLength;){for(m=maxInt,j=0;j<inputLength;++j)(currentValue=input[j])>=n&&currentValue<m&&(m=currentValue);for(m-n>floor((maxInt-delta)/(handledCPCountPlusOne=handledCPCount+1))&&error("overflow"),delta+=(m-n)*handledCPCountPlusOne,n=m,j=0;j<inputLength;++j)if((currentValue=input[j])<n&&++delta>maxInt&&error("overflow"),currentValue==n){for(q=delta,k=36;!(q<(t=k<=bias?1:k>=bias+26?26:k-bias));k+=36)qMinusT=q-t,baseMinusT=36-t,output.push(stringFromCharCode(digitToBasic(t+qMinusT%baseMinusT,0))),q=floor(qMinusT/baseMinusT);output.push(stringFromCharCode(digitToBasic(q,0))),bias=adapt(delta,handledCPCountPlusOne,handledCPCount==basicLength),delta=0,++handledCPCount}++delta,++n}return output.join("")}if(punycode={version:"1.3.2",ucs2:{decode:ucs2decode,encode:ucs2encode},decode,encode,toASCII:function(input){return mapDomain(input,(function(string){return regexNonASCII.test(string)?"xn--"+encode(string):string}))},toUnicode:function(input){return mapDomain(input,(function(string){return regexPunycode.test(string)?decode(string.slice(4).toLowerCase()):string}))}},freeExports&&freeModule)if(module.exports==freeExports)freeModule.exports=punycode;else for(key in punycode)punycode.hasOwnProperty(key)&&(freeExports[key]=punycode[key]);else root.punycode=punycode}(commonjsGlobal)})),util_isString=function(arg){return"string"==typeof arg},util_isObject=function(arg){return"object"==typeof arg&&null!==arg},util_isNull=function(arg){return null===arg},util_isNullOrUndefined=function(arg){return null==arg};function canvas_mesh_hasOwnProperty(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop)}var decode=function(qs,sep,eq,options){sep=sep||"&",eq=eq||"=";var obj={};if("string"!=typeof qs||0===qs.length)return obj;var regexp=/\+/g;qs=qs.split(sep);var maxKeys=1e3;options&&"number"==typeof options.maxKeys&&(maxKeys=options.maxKeys);var len=qs.length;maxKeys>0&&len>maxKeys&&(len=maxKeys);for(var i=0;i<len;++i){var kstr,vstr,k,v,x=qs[i].replace(regexp,"%20"),idx=x.indexOf(eq);idx>=0?(kstr=x.substr(0,idx),vstr=x.substr(idx+1)):(kstr=x,vstr=""),k=decodeURIComponent(kstr),v=decodeURIComponent(vstr),canvas_mesh_hasOwnProperty(obj,k)?Array.isArray(obj[k])?obj[k].push(v):obj[k]=[obj[k],v]:obj[k]=v}return obj},stringifyPrimitive=function(v){switch(typeof v){case"string":return v;case"boolean":return v?"true":"false";case"number":return isFinite(v)?v:"";default:return""}},encode=function(obj,sep,eq,name){return sep=sep||"&",eq=eq||"=",null===obj&&(obj=void 0),"object"==typeof obj?Object.keys(obj).map((function(k){var ks=encodeURIComponent(stringifyPrimitive(k))+eq;return Array.isArray(obj[k])?obj[k].map((function(v){return ks+encodeURIComponent(stringifyPrimitive(v))})).join(sep):ks+encodeURIComponent(stringifyPrimitive(obj[k]))})).join(sep):name?encodeURIComponent(stringifyPrimitive(name))+eq+encodeURIComponent(stringifyPrimitive(obj)):""},querystring=createCommonjsModule((function(module,exports){exports.decode=exports.parse=decode,exports.encode=exports.stringify=encode})),parse=urlParse,canvas_mesh_resolve=function(source,relative){return urlParse(source,!1,!0).resolve(relative)},format=function(obj){util_isString(obj)&&(obj=urlParse(obj));if(!(obj instanceof canvas_mesh_Url))return canvas_mesh_Url.prototype.format.call(obj);return obj.format()};function canvas_mesh_Url(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var protocolPattern=/^([a-z0-9.+-]+:)/i,portPattern=/:[0-9]*$/,simplePathPattern=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,unwise=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),autoEscape=["'"].concat(unwise),nonHostChars=["%","/","?",";","#"].concat(autoEscape),hostEndingChars=["/","?","#"],hostnamePartPattern=/^[+a-z0-9A-Z_-]{0,63}$/,hostnamePartStart=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,unsafeProtocol={javascript:!0,"javascript:":!0},hostlessProtocol={javascript:!0,"javascript:":!0},slashedProtocol={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};function urlParse(url,parseQueryString,slashesDenoteHost){if(url&&util_isObject(url)&&url instanceof canvas_mesh_Url)return url;var u=new canvas_mesh_Url;return u.parse(url,parseQueryString,slashesDenoteHost),u}canvas_mesh_Url.prototype.parse=function(url,parseQueryString,slashesDenoteHost){if(!util_isString(url))throw new TypeError("Parameter 'url' must be a string, not "+typeof url);var queryIndex=url.indexOf("?"),splitter=-1!==queryIndex&&queryIndex<url.indexOf("#")?"?":"#",uSplit=url.split(splitter);uSplit[0]=uSplit[0].replace(/\\/g,"/");var rest=url=uSplit.join(splitter);if(rest=rest.trim(),!slashesDenoteHost&&1===url.split("#").length){var simplePath=simplePathPattern.exec(rest);if(simplePath)return this.path=rest,this.href=rest,this.pathname=simplePath[1],simplePath[2]?(this.search=simplePath[2],this.query=parseQueryString?querystring.parse(this.search.substr(1)):this.search.substr(1)):parseQueryString&&(this.search="",this.query={}),this}var proto=protocolPattern.exec(rest);if(proto){var lowerProto=(proto=proto[0]).toLowerCase();this.protocol=lowerProto,rest=rest.substr(proto.length)}if(slashesDenoteHost||proto||rest.match(/^\/\/[^@\/]+@[^@\/]+/)){var slashes="//"===rest.substr(0,2);!slashes||proto&&hostlessProtocol[proto]||(rest=rest.substr(2),this.slashes=!0)}if(!hostlessProtocol[proto]&&(slashes||proto&&!slashedProtocol[proto])){for(var auth,atSign,hostEnd=-1,i=0;i<hostEndingChars.length;i++){-1!==(hec=rest.indexOf(hostEndingChars[i]))&&(-1===hostEnd||hec<hostEnd)&&(hostEnd=hec)}-1!==(atSign=-1===hostEnd?rest.lastIndexOf("@"):rest.lastIndexOf("@",hostEnd))&&(auth=rest.slice(0,atSign),rest=rest.slice(atSign+1),this.auth=decodeURIComponent(auth)),hostEnd=-1;for(i=0;i<nonHostChars.length;i++){var hec;-1!==(hec=rest.indexOf(nonHostChars[i]))&&(-1===hostEnd||hec<hostEnd)&&(hostEnd=hec)}-1===hostEnd&&(hostEnd=rest.length),this.host=rest.slice(0,hostEnd),rest=rest.slice(hostEnd),this.parseHost(),this.hostname=this.hostname||"";var ipv6Hostname="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!ipv6Hostname)for(var hostparts=this.hostname.split(/\./),l=(i=0,hostparts.length);i<l;i++){var part=hostparts[i];if(part&&!part.match(hostnamePartPattern)){for(var newpart="",j=0,k=part.length;j<k;j++)part.charCodeAt(j)>127?newpart+="x":newpart+=part[j];if(!newpart.match(hostnamePartPattern)){var validParts=hostparts.slice(0,i),notHost=hostparts.slice(i+1),bit=part.match(hostnamePartStart);bit&&(validParts.push(bit[1]),notHost.unshift(bit[2])),notHost.length&&(rest="/"+notHost.join(".")+rest),this.hostname=validParts.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),ipv6Hostname||(this.hostname=punycode.toASCII(this.hostname));var p=this.port?":"+this.port:"",h=this.hostname||"";this.host=h+p,this.href+=this.host,ipv6Hostname&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==rest[0]&&(rest="/"+rest))}if(!unsafeProtocol[lowerProto])for(i=0,l=autoEscape.length;i<l;i++){var ae=autoEscape[i];if(-1!==rest.indexOf(ae)){var esc=encodeURIComponent(ae);esc===ae&&(esc=escape(ae)),rest=rest.split(ae).join(esc)}}var hash=rest.indexOf("#");-1!==hash&&(this.hash=rest.substr(hash),rest=rest.slice(0,hash));var qm=rest.indexOf("?");if(-1!==qm?(this.search=rest.substr(qm),this.query=rest.substr(qm+1),parseQueryString&&(this.query=querystring.parse(this.query)),rest=rest.slice(0,qm)):parseQueryString&&(this.search="",this.query={}),rest&&(this.pathname=rest),slashedProtocol[lowerProto]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){p=this.pathname||"";var s=this.search||"";this.path=p+s}return this.href=this.format(),this},canvas_mesh_Url.prototype.format=function(){var auth=this.auth||"";auth&&(auth=(auth=encodeURIComponent(auth)).replace(/%3A/i,":"),auth+="@");var protocol=this.protocol||"",pathname=this.pathname||"",hash=this.hash||"",host=!1,query="";this.host?host=auth+this.host:this.hostname&&(host=auth+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(host+=":"+this.port)),this.query&&util_isObject(this.query)&&Object.keys(this.query).length&&(query=querystring.stringify(this.query));var search=this.search||query&&"?"+query||"";return protocol&&":"!==protocol.substr(-1)&&(protocol+=":"),this.slashes||(!protocol||slashedProtocol[protocol])&&!1!==host?(host="//"+(host||""),pathname&&"/"!==pathname.charAt(0)&&(pathname="/"+pathname)):host||(host=""),hash&&"#"!==hash.charAt(0)&&(hash="#"+hash),search&&"?"!==search.charAt(0)&&(search="?"+search),protocol+host+(pathname=pathname.replace(/[?#]/g,(function(match){return encodeURIComponent(match)})))+(search=search.replace("#","%23"))+hash},canvas_mesh_Url.prototype.resolve=function(relative){return this.resolveObject(urlParse(relative,!1,!0)).format()},canvas_mesh_Url.prototype.resolveObject=function(relative){if(util_isString(relative)){var rel=new canvas_mesh_Url;rel.parse(relative,!1,!0),relative=rel}for(var result=new canvas_mesh_Url,tkeys=Object.keys(this),tk=0;tk<tkeys.length;tk++){var tkey=tkeys[tk];result[tkey]=this[tkey]}if(result.hash=relative.hash,""===relative.href)return result.href=result.format(),result;if(relative.slashes&&!relative.protocol){for(var rkeys=Object.keys(relative),rk=0;rk<rkeys.length;rk++){var rkey=rkeys[rk];"protocol"!==rkey&&(result[rkey]=relative[rkey])}return slashedProtocol[result.protocol]&&result.hostname&&!result.pathname&&(result.path=result.pathname="/"),result.href=result.format(),result}if(relative.protocol&&relative.protocol!==result.protocol){if(!slashedProtocol[relative.protocol]){for(var keys=Object.keys(relative),v=0;v<keys.length;v++){var k=keys[v];result[k]=relative[k]}return result.href=result.format(),result}if(result.protocol=relative.protocol,relative.host||hostlessProtocol[relative.protocol])result.pathname=relative.pathname;else{for(var relPath=(relative.pathname||"").split("/");relPath.length&&!(relative.host=relPath.shift()););relative.host||(relative.host=""),relative.hostname||(relative.hostname=""),""!==relPath[0]&&relPath.unshift(""),relPath.length<2&&relPath.unshift(""),result.pathname=relPath.join("/")}if(result.search=relative.search,result.query=relative.query,result.host=relative.host||"",result.auth=relative.auth,result.hostname=relative.hostname||relative.host,result.port=relative.port,result.pathname||result.search){var p=result.pathname||"",s=result.search||"";result.path=p+s}return result.slashes=result.slashes||relative.slashes,result.href=result.format(),result}var isSourceAbs=result.pathname&&"/"===result.pathname.charAt(0),isRelAbs=relative.host||relative.pathname&&"/"===relative.pathname.charAt(0),mustEndAbs=isRelAbs||isSourceAbs||result.host&&relative.pathname,removeAllDots=mustEndAbs,srcPath=result.pathname&&result.pathname.split("/")||[],psychotic=(relPath=relative.pathname&&relative.pathname.split("/")||[],result.protocol&&!slashedProtocol[result.protocol]);if(psychotic&&(result.hostname="",result.port=null,result.host&&(""===srcPath[0]?srcPath[0]=result.host:srcPath.unshift(result.host)),result.host="",relative.protocol&&(relative.hostname=null,relative.port=null,relative.host&&(""===relPath[0]?relPath[0]=relative.host:relPath.unshift(relative.host)),relative.host=null),mustEndAbs=mustEndAbs&&(""===relPath[0]||""===srcPath[0])),isRelAbs)result.host=relative.host||""===relative.host?relative.host:result.host,result.hostname=relative.hostname||""===relative.hostname?relative.hostname:result.hostname,result.search=relative.search,result.query=relative.query,srcPath=relPath;else if(relPath.length)srcPath||(srcPath=[]),srcPath.pop(),srcPath=srcPath.concat(relPath),result.search=relative.search,result.query=relative.query;else if(!util_isNullOrUndefined(relative.search)){if(psychotic)result.hostname=result.host=srcPath.shift(),(authInHost=!!(result.host&&result.host.indexOf("@")>0)&&result.host.split("@"))&&(result.auth=authInHost.shift(),result.host=result.hostname=authInHost.shift());return result.search=relative.search,result.query=relative.query,util_isNull(result.pathname)&&util_isNull(result.search)||(result.path=(result.pathname?result.pathname:"")+(result.search?result.search:"")),result.href=result.format(),result}if(!srcPath.length)return result.pathname=null,result.search?result.path="/"+result.search:result.path=null,result.href=result.format(),result;for(var last=srcPath.slice(-1)[0],hasTrailingSlash=(result.host||relative.host||srcPath.length>1)&&("."===last||".."===last)||""===last,up=0,i=srcPath.length;i>=0;i--)"."===(last=srcPath[i])?srcPath.splice(i,1):".."===last?(srcPath.splice(i,1),up++):up&&(srcPath.splice(i,1),up--);if(!mustEndAbs&&!removeAllDots)for(;up--;up)srcPath.unshift("..");!mustEndAbs||""===srcPath[0]||srcPath[0]&&"/"===srcPath[0].charAt(0)||srcPath.unshift(""),hasTrailingSlash&&"/"!==srcPath.join("/").substr(-1)&&srcPath.push("");var authInHost,isAbsolute=""===srcPath[0]||srcPath[0]&&"/"===srcPath[0].charAt(0);psychotic&&(result.hostname=result.host=isAbsolute?"":srcPath.length?srcPath.shift():"",(authInHost=!!(result.host&&result.host.indexOf("@")>0)&&result.host.split("@"))&&(result.auth=authInHost.shift(),result.host=result.hostname=authInHost.shift()));return(mustEndAbs=mustEndAbs||result.host&&srcPath.length)&&!isAbsolute&&srcPath.unshift(""),srcPath.length?result.pathname=srcPath.join("/"):(result.pathname=null,result.path=null),util_isNull(result.pathname)&&util_isNull(result.search)||(result.path=(result.pathname?result.pathname:"")+(result.search?result.search:"")),result.auth=relative.auth||result.auth,result.slashes=result.slashes||relative.slashes,result.href=result.format(),result},canvas_mesh_Url.prototype.parseHost=function(){var host=this.host,port=portPattern.exec(host);port&&(":"!==(port=port[0])&&(this.port=port.substr(1)),host=host.substr(0,host.length-port.length)),host&&(this.hostname=host)};var canvas_mesh_url={parse,format,resolve:canvas_mesh_resolve};settings.RETINA_PREFIX=/@([0-9\.]+)x/,settings.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var canvas_mesh_supported,canvas_mesh_saidHello=!1;var canvas_mesh_premultiplyBlendMode=function(){for(var pm=[],npm=[],i=0;i<32;i++)pm[i]=i,npm[i]=i;pm[constants_BLEND_MODES.NORMAL_NPM]=constants_BLEND_MODES.NORMAL,pm[constants_BLEND_MODES.ADD_NPM]=constants_BLEND_MODES.ADD,pm[constants_BLEND_MODES.SCREEN_NPM]=constants_BLEND_MODES.SCREEN,npm[constants_BLEND_MODES.NORMAL]=constants_BLEND_MODES.NORMAL_NPM,npm[constants_BLEND_MODES.ADD]=constants_BLEND_MODES.ADD_NPM,npm[constants_BLEND_MODES.SCREEN]=constants_BLEND_MODES.SCREEN_NPM;var array=[];return array.push(npm),array.push(pm),array}();function canvas_mesh_getBufferType(array){if(4===array.BYTES_PER_ELEMENT)return array instanceof Float32Array?"Float32Array":array instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===array.BYTES_PER_ELEMENT){if(array instanceof Uint16Array)return"Uint16Array"}else if(1===array.BYTES_PER_ELEMENT&&array instanceof Uint8Array)return"Uint8Array";return null}function canvas_mesh_nextPow2(v){return v+=0===v?1:0,--v,v|=v>>>1,v|=v>>>2,v|=v>>>4,v|=v>>>8,(v|=v>>>16)+1}function canvas_mesh_isPow2(v){return!(v&v-1||!v)}function canvas_mesh_log2(v){var r=(v>65535?1:0)<<4,shift=((v>>>=r)>255?1:0)<<3;return r|=shift,r|=shift=((v>>>=shift)>15?1:0)<<2,(r|=shift=((v>>>=shift)>3?1:0)<<1)|(v>>>=shift)>>1}var canvas_mesh_nextUid=0;function canvas_mesh_uid(){return++canvas_mesh_nextUid}var canvas_mesh_warnings={};function canvas_mesh_deprecation(version,message,ignoreDepth){if(void 0===ignoreDepth&&(ignoreDepth=3),!canvas_mesh_warnings[message]){var stack=(new Error).stack;void 0===stack?console.warn("PixiJS Deprecation Warning: ",message+"\nDeprecated since v"+version):(stack=stack.split("\n").splice(ignoreDepth).join("\n"),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",message+"\nDeprecated since v"+version),console.warn(stack),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",message+"\nDeprecated since v"+version),console.warn(stack))),canvas_mesh_warnings[message]=!0}}var canvas_mesh_tempAnchor,canvas_mesh_ProgramCache={},canvas_mesh_TextureCache=Object.create(null),canvas_mesh_BaseTextureCache=Object.create(null);!function(){function CanvasRenderTarget(width,height,resolution){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=resolution||settings.RESOLUTION,this.resize(width,height)}CanvasRenderTarget.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},CanvasRenderTarget.prototype.resize=function(desiredWidth,desiredHeight){this.canvas.width=Math.round(desiredWidth*this.resolution),this.canvas.height=Math.round(desiredHeight*this.resolution)},CanvasRenderTarget.prototype.destroy=function(){this.context=null,this.canvas=null},Object.defineProperty(CanvasRenderTarget.prototype,"width",{get:function(){return this.canvas.width},set:function(val){this.canvas.width=Math.round(val)},enumerable:!1,configurable:!0}),Object.defineProperty(CanvasRenderTarget.prototype,"height",{get:function(){return this.canvas.height},set:function(val){this.canvas.height=Math.round(val)},enumerable:!1,configurable:!0})}();function canvas_mesh_getResolutionOfUrl(url,defaultValue){var resolution=settings.RETINA_PREFIX.exec(url);return resolution?parseFloat(resolution[1]):void 0!==defaultValue?defaultValue:1}var canvas_mesh_UPDATE_PRIORITY,canvas_mesh_Runner=function(){function Runner(name){this.items=[],this._name=name,this._aliasCount=0}return Runner.prototype.emit=function(a0,a1,a2,a3,a4,a5,a6,a7){if(arguments.length>8)throw new Error("max arguments reached");var _a=this,name=_a.name,items=_a.items;this._aliasCount++;for(var i=0,len=items.length;i<len;i++)items[i][name](a0,a1,a2,a3,a4,a5,a6,a7);return items===this.items&&this._aliasCount--,this},Runner.prototype.ensureNonAliasedItems=function(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))},Runner.prototype.add=function(item){return item[this._name]&&(this.ensureNonAliasedItems(),this.remove(item),this.items.push(item)),this},Runner.prototype.remove=function(item){var index=this.items.indexOf(item);return-1!==index&&(this.ensureNonAliasedItems(),this.items.splice(index,1)),this},Runner.prototype.contains=function(item){return-1!==this.items.indexOf(item)},Runner.prototype.removeAll=function(){return this.ensureNonAliasedItems(),this.items.length=0,this},Runner.prototype.destroy=function(){this.removeAll(),this.items=null,this._name=null},Object.defineProperty(Runner.prototype,"empty",{get:function(){return 0===this.items.length},enumerable:!1,configurable:!0}),Object.defineProperty(Runner.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),Runner}();Object.defineProperties(canvas_mesh_Runner.prototype,{dispatch:{value:canvas_mesh_Runner.prototype.emit},run:{value:canvas_mesh_Runner.prototype.emit}}),settings.TARGET_FPMS=.06,function(UPDATE_PRIORITY){UPDATE_PRIORITY[UPDATE_PRIORITY.INTERACTION=50]="INTERACTION",UPDATE_PRIORITY[UPDATE_PRIORITY.HIGH=25]="HIGH",UPDATE_PRIORITY[UPDATE_PRIORITY.NORMAL=0]="NORMAL",UPDATE_PRIORITY[UPDATE_PRIORITY.LOW=-25]="LOW",UPDATE_PRIORITY[UPDATE_PRIORITY.UTILITY=-50]="UTILITY"}(canvas_mesh_UPDATE_PRIORITY||(canvas_mesh_UPDATE_PRIORITY={}));var canvas_mesh_SHAPES,canvas_mesh_TickerListener=function(){function TickerListener(fn,context,priority,once){void 0===context&&(context=null),void 0===priority&&(priority=0),void 0===once&&(once=!1),this.next=null,this.previous=null,this._destroyed=!1,this.fn=fn,this.context=context,this.priority=priority,this.once=once}return TickerListener.prototype.match=function(fn,context){return void 0===context&&(context=null),this.fn===fn&&this.context===context},TickerListener.prototype.emit=function(deltaTime){this.fn&&(this.context?this.fn.call(this.context,deltaTime):this.fn(deltaTime));var redirect=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),redirect},TickerListener.prototype.connect=function(previous){this.previous=previous,previous.next&&(previous.next.previous=this),this.next=previous.next,previous.next=this},TickerListener.prototype.destroy=function(hard){void 0===hard&&(hard=!1),this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var redirect=this.next;return this.next=hard?null:redirect,this.previous=null,redirect},TickerListener}(),canvas_mesh_Ticker=function(){function Ticker(){var _this=this;this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new canvas_mesh_TickerListener(null,null,1/0),this.deltaMS=1/settings.TARGET_FPMS,this.elapsedMS=1/settings.TARGET_FPMS,this._tick=function(time){_this._requestId=null,_this.started&&(_this.update(time),_this.started&&null===_this._requestId&&_this._head.next&&(_this._requestId=requestAnimationFrame(_this._tick)))}}return Ticker.prototype._requestIfNeeded=function(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))},Ticker.prototype._cancelIfNeeded=function(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)},Ticker.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},Ticker.prototype.add=function(fn,context,priority){return void 0===priority&&(priority=canvas_mesh_UPDATE_PRIORITY.NORMAL),this._addListener(new canvas_mesh_TickerListener(fn,context,priority))},Ticker.prototype.addOnce=function(fn,context,priority){return void 0===priority&&(priority=canvas_mesh_UPDATE_PRIORITY.NORMAL),this._addListener(new canvas_mesh_TickerListener(fn,context,priority,!0))},Ticker.prototype._addListener=function(listener){var current=this._head.next,previous=this._head;if(current){for(;current;){if(listener.priority>current.priority){listener.connect(previous);break}previous=current,current=current.next}listener.previous||listener.connect(previous)}else listener.connect(previous);return this._startIfPossible(),this},Ticker.prototype.remove=function(fn,context){for(var listener=this._head.next;listener;)listener=listener.match(fn,context)?listener.destroy():listener.next;return this._head.next||this._cancelIfNeeded(),this},Object.defineProperty(Ticker.prototype,"count",{get:function(){if(!this._head)return 0;for(var count=0,current=this._head;current=current.next;)count++;return count},enumerable:!1,configurable:!0}),Ticker.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},Ticker.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},Ticker.prototype.destroy=function(){if(!this._protected){this.stop();for(var listener=this._head.next;listener;)listener=listener.destroy(!0);this._head.destroy(),this._head=null}},Ticker.prototype.update=function(currentTime){var elapsedMS;if(void 0===currentTime&&(currentTime=performance.now()),currentTime>this.lastTime){if((elapsedMS=this.elapsedMS=currentTime-this.lastTime)>this._maxElapsedMS&&(elapsedMS=this._maxElapsedMS),elapsedMS*=this.speed,this._minElapsedMS){var delta=currentTime-this._lastFrame|0;if(delta<this._minElapsedMS)return;this._lastFrame=currentTime-delta%this._minElapsedMS}this.deltaMS=elapsedMS,this.deltaTime=this.deltaMS*settings.TARGET_FPMS;for(var head=this._head,listener=head.next;listener;)listener=listener.emit(this.deltaTime);head.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=currentTime},Object.defineProperty(Ticker.prototype,"FPS",{get:function(){return 1e3/this.elapsedMS},enumerable:!1,configurable:!0}),Object.defineProperty(Ticker.prototype,"minFPS",{get:function(){return 1e3/this._maxElapsedMS},set:function(fps){var minFPS=Math.min(this.maxFPS,fps),minFPMS=Math.min(Math.max(0,minFPS)/1e3,settings.TARGET_FPMS);this._maxElapsedMS=1/minFPMS},enumerable:!1,configurable:!0}),Object.defineProperty(Ticker.prototype,"maxFPS",{get:function(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(fps){if(0===fps)this._minElapsedMS=0;else{var maxFPS=Math.max(this.minFPS,fps);this._minElapsedMS=1/(maxFPS/1e3)}},enumerable:!1,configurable:!0}),Object.defineProperty(Ticker,"shared",{get:function(){if(!Ticker._shared){var shared=Ticker._shared=new Ticker;shared.autoStart=!0,shared._protected=!0}return Ticker._shared},enumerable:!1,configurable:!0}),Object.defineProperty(Ticker,"system",{get:function(){if(!Ticker._system){var system=Ticker._system=new Ticker;system.autoStart=!0,system._protected=!0}return Ticker._system},enumerable:!1,configurable:!0}),Ticker}(),canvas_mesh_PI_2=2*Math.PI;!function(SHAPES){SHAPES[SHAPES.POLY=0]="POLY",SHAPES[SHAPES.RECT=1]="RECT",SHAPES[SHAPES.CIRC=2]="CIRC",SHAPES[SHAPES.ELIP=3]="ELIP",SHAPES[SHAPES.RREC=4]="RREC"}(canvas_mesh_SHAPES||(canvas_mesh_SHAPES={}));var canvas_mesh_Point=function(){function Point(x,y){void 0===x&&(x=0),void 0===y&&(y=0),this.x=0,this.y=0,this.x=x,this.y=y}return Point.prototype.clone=function(){return new Point(this.x,this.y)},Point.prototype.copyFrom=function(p){return this.set(p.x,p.y),this},Point.prototype.copyTo=function(p){return p.set(this.x,this.y),p},Point.prototype.equals=function(p){return p.x===this.x&&p.y===this.y},Point.prototype.set=function(x,y){return void 0===x&&(x=0),void 0===y&&(y=x),this.x=x,this.y=y,this},Point.prototype.toString=function(){return"[@pixi/math:Point x="+this.x+" y="+this.y+"]"},Point}(),canvas_mesh_tempPoints=[new canvas_mesh_Point,new canvas_mesh_Point,new canvas_mesh_Point,new canvas_mesh_Point],canvas_mesh_Rectangle=function(){function Rectangle(x,y,width,height){void 0===x&&(x=0),void 0===y&&(y=0),void 0===width&&(width=0),void 0===height&&(height=0),this.x=Number(x),this.y=Number(y),this.width=Number(width),this.height=Number(height),this.type=canvas_mesh_SHAPES.RECT}return Object.defineProperty(Rectangle.prototype,"left",{get:function(){return this.x},enumerable:!1,configurable:!0}),Object.defineProperty(Rectangle.prototype,"right",{get:function(){return this.x+this.width},enumerable:!1,configurable:!0}),Object.defineProperty(Rectangle.prototype,"top",{get:function(){return this.y},enumerable:!1,configurable:!0}),Object.defineProperty(Rectangle.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!1,configurable:!0}),Object.defineProperty(Rectangle,"EMPTY",{get:function(){return new Rectangle(0,0,0,0)},enumerable:!1,configurable:!0}),Rectangle.prototype.clone=function(){return new Rectangle(this.x,this.y,this.width,this.height)},Rectangle.prototype.copyFrom=function(rectangle){return this.x=rectangle.x,this.y=rectangle.y,this.width=rectangle.width,this.height=rectangle.height,this},Rectangle.prototype.copyTo=function(rectangle){return rectangle.x=this.x,rectangle.y=this.y,rectangle.width=this.width,rectangle.height=this.height,rectangle},Rectangle.prototype.contains=function(x,y){return!(this.width<=0||this.height<=0)&&(x>=this.x&&x<this.x+this.width&&y>=this.y&&y<this.y+this.height)},Rectangle.prototype.intersects=function(other,transform){if(!transform){var x0_1=this.x<other.x?other.x:this.x;if((this.right>other.right?other.right:this.right)<=x0_1)return!1;var y0_1=this.y<other.y?other.y:this.y;return(this.bottom>other.bottom?other.bottom:this.bottom)>y0_1}var x0=this.left,x1=this.right,y0=this.top,y1=this.bottom;if(x1<=x0||y1<=y0)return!1;var lt=canvas_mesh_tempPoints[0].set(other.left,other.top),lb=canvas_mesh_tempPoints[1].set(other.left,other.bottom),rt=canvas_mesh_tempPoints[2].set(other.right,other.top),rb=canvas_mesh_tempPoints[3].set(other.right,other.bottom);if(rt.x<=lt.x||lb.y<=lt.y)return!1;var s=Math.sign(transform.a*transform.d-transform.b*transform.c);if(0===s)return!1;if(transform.apply(lt,lt),transform.apply(lb,lb),transform.apply(rt,rt),transform.apply(rb,rb),Math.max(lt.x,lb.x,rt.x,rb.x)<=x0||Math.min(lt.x,lb.x,rt.x,rb.x)>=x1||Math.max(lt.y,lb.y,rt.y,rb.y)<=y0||Math.min(lt.y,lb.y,rt.y,rb.y)>=y1)return!1;var nx=s*(lb.y-lt.y),ny=s*(lt.x-lb.x),n00=nx*x0+ny*y0,n10=nx*x1+ny*y0,n01=nx*x0+ny*y1,n11=nx*x1+ny*y1;if(Math.max(n00,n10,n01,n11)<=nx*lt.x+ny*lt.y||Math.min(n00,n10,n01,n11)>=nx*rb.x+ny*rb.y)return!1;var mx=s*(lt.y-rt.y),my=s*(rt.x-lt.x),m00=mx*x0+my*y0,m10=mx*x1+my*y0,m01=mx*x0+my*y1,m11=mx*x1+my*y1;return!(Math.max(m00,m10,m01,m11)<=mx*lt.x+my*lt.y||Math.min(m00,m10,m01,m11)>=mx*rb.x+my*rb.y)},Rectangle.prototype.pad=function(paddingX,paddingY){return void 0===paddingX&&(paddingX=0),void 0===paddingY&&(paddingY=paddingX),this.x-=paddingX,this.y-=paddingY,this.width+=2*paddingX,this.height+=2*paddingY,this},Rectangle.prototype.fit=function(rectangle){var x1=Math.max(this.x,rectangle.x),x2=Math.min(this.x+this.width,rectangle.x+rectangle.width),y1=Math.max(this.y,rectangle.y),y2=Math.min(this.y+this.height,rectangle.y+rectangle.height);return this.x=x1,this.width=Math.max(x2-x1,0),this.y=y1,this.height=Math.max(y2-y1,0),this},Rectangle.prototype.ceil=function(resolution,eps){void 0===resolution&&(resolution=1),void 0===eps&&(eps=.001);var x2=Math.ceil((this.x+this.width-eps)*resolution)/resolution,y2=Math.ceil((this.y+this.height-eps)*resolution)/resolution;return this.x=Math.floor((this.x+eps)*resolution)/resolution,this.y=Math.floor((this.y+eps)*resolution)/resolution,this.width=x2-this.x,this.height=y2-this.y,this},Rectangle.prototype.enlarge=function(rectangle){var x1=Math.min(this.x,rectangle.x),x2=Math.max(this.x+this.width,rectangle.x+rectangle.width),y1=Math.min(this.y,rectangle.y),y2=Math.max(this.y+this.height,rectangle.y+rectangle.height);return this.x=x1,this.width=x2-x1,this.y=y1,this.height=y2-y1,this},Rectangle.prototype.toString=function(){return"[@pixi/math:Rectangle x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+"]"},Rectangle}(),canvas_mesh_ObservablePoint=function(){function ObservablePoint(cb,scope,x,y){void 0===x&&(x=0),void 0===y&&(y=0),this._x=x,this._y=y,this.cb=cb,this.scope=scope}return ObservablePoint.prototype.clone=function(cb,scope){return void 0===cb&&(cb=this.cb),void 0===scope&&(scope=this.scope),new ObservablePoint(cb,scope,this._x,this._y)},ObservablePoint.prototype.set=function(x,y){return void 0===x&&(x=0),void 0===y&&(y=x),this._x===x&&this._y===y||(this._x=x,this._y=y,this.cb.call(this.scope)),this},ObservablePoint.prototype.copyFrom=function(p){return this._x===p.x&&this._y===p.y||(this._x=p.x,this._y=p.y,this.cb.call(this.scope)),this},ObservablePoint.prototype.copyTo=function(p){return p.set(this._x,this._y),p},ObservablePoint.prototype.equals=function(p){return p.x===this._x&&p.y===this._y},ObservablePoint.prototype.toString=function(){return"[@pixi/math:ObservablePoint x=0 y=0 scope="+this.scope+"]"},Object.defineProperty(ObservablePoint.prototype,"x",{get:function(){return this._x},set:function(value){this._x!==value&&(this._x=value,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),Object.defineProperty(ObservablePoint.prototype,"y",{get:function(){return this._y},set:function(value){this._y!==value&&(this._y=value,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),ObservablePoint}(),canvas_mesh_Matrix=function(){function Matrix(a,b,c,d,tx,ty){void 0===a&&(a=1),void 0===b&&(b=0),void 0===c&&(c=0),void 0===d&&(d=1),void 0===tx&&(tx=0),void 0===ty&&(ty=0),this.array=null,this.a=a,this.b=b,this.c=c,this.d=d,this.tx=tx,this.ty=ty}return Matrix.prototype.fromArray=function(array){this.a=array[0],this.b=array[1],this.c=array[3],this.d=array[4],this.tx=array[2],this.ty=array[5]},Matrix.prototype.set=function(a,b,c,d,tx,ty){return this.a=a,this.b=b,this.c=c,this.d=d,this.tx=tx,this.ty=ty,this},Matrix.prototype.toArray=function(transpose,out){this.array||(this.array=new Float32Array(9));var array=out||this.array;return transpose?(array[0]=this.a,array[1]=this.b,array[2]=0,array[3]=this.c,array[4]=this.d,array[5]=0,array[6]=this.tx,array[7]=this.ty,array[8]=1):(array[0]=this.a,array[1]=this.c,array[2]=this.tx,array[3]=this.b,array[4]=this.d,array[5]=this.ty,array[6]=0,array[7]=0,array[8]=1),array},Matrix.prototype.apply=function(pos,newPos){newPos=newPos||new canvas_mesh_Point;var x=pos.x,y=pos.y;return newPos.x=this.a*x+this.c*y+this.tx,newPos.y=this.b*x+this.d*y+this.ty,newPos},Matrix.prototype.applyInverse=function(pos,newPos){newPos=newPos||new canvas_mesh_Point;var id=1/(this.a*this.d+this.c*-this.b),x=pos.x,y=pos.y;return newPos.x=this.d*id*x+-this.c*id*y+(this.ty*this.c-this.tx*this.d)*id,newPos.y=this.a*id*y+-this.b*id*x+(-this.ty*this.a+this.tx*this.b)*id,newPos},Matrix.prototype.translate=function(x,y){return this.tx+=x,this.ty+=y,this},Matrix.prototype.scale=function(x,y){return this.a*=x,this.d*=y,this.c*=x,this.b*=y,this.tx*=x,this.ty*=y,this},Matrix.prototype.rotate=function(angle){var cos=Math.cos(angle),sin=Math.sin(angle),a1=this.a,c1=this.c,tx1=this.tx;return this.a=a1*cos-this.b*sin,this.b=a1*sin+this.b*cos,this.c=c1*cos-this.d*sin,this.d=c1*sin+this.d*cos,this.tx=tx1*cos-this.ty*sin,this.ty=tx1*sin+this.ty*cos,this},Matrix.prototype.append=function(matrix){var a1=this.a,b1=this.b,c1=this.c,d1=this.d;return this.a=matrix.a*a1+matrix.b*c1,this.b=matrix.a*b1+matrix.b*d1,this.c=matrix.c*a1+matrix.d*c1,this.d=matrix.c*b1+matrix.d*d1,this.tx=matrix.tx*a1+matrix.ty*c1+this.tx,this.ty=matrix.tx*b1+matrix.ty*d1+this.ty,this},Matrix.prototype.setTransform=function(x,y,pivotX,pivotY,scaleX,scaleY,rotation,skewX,skewY){return this.a=Math.cos(rotation+skewY)*scaleX,this.b=Math.sin(rotation+skewY)*scaleX,this.c=-Math.sin(rotation-skewX)*scaleY,this.d=Math.cos(rotation-skewX)*scaleY,this.tx=x-(pivotX*this.a+pivotY*this.c),this.ty=y-(pivotX*this.b+pivotY*this.d),this},Matrix.prototype.prepend=function(matrix){var tx1=this.tx;if(1!==matrix.a||0!==matrix.b||0!==matrix.c||1!==matrix.d){var a1=this.a,c1=this.c;this.a=a1*matrix.a+this.b*matrix.c,this.b=a1*matrix.b+this.b*matrix.d,this.c=c1*matrix.a+this.d*matrix.c,this.d=c1*matrix.b+this.d*matrix.d}return this.tx=tx1*matrix.a+this.ty*matrix.c+matrix.tx,this.ty=tx1*matrix.b+this.ty*matrix.d+matrix.ty,this},Matrix.prototype.decompose=function(transform){var a=this.a,b=this.b,c=this.c,d=this.d,pivot=transform.pivot,skewX=-Math.atan2(-c,d),skewY=Math.atan2(b,a),delta=Math.abs(skewX+skewY);return delta<1e-5||Math.abs(canvas_mesh_PI_2-delta)<1e-5?(transform.rotation=skewY,transform.skew.x=transform.skew.y=0):(transform.rotation=0,transform.skew.x=skewX,transform.skew.y=skewY),transform.scale.x=Math.sqrt(a*a+b*b),transform.scale.y=Math.sqrt(c*c+d*d),transform.position.x=this.tx+(pivot.x*a+pivot.y*c),transform.position.y=this.ty+(pivot.x*b+pivot.y*d),transform},Matrix.prototype.invert=function(){var a1=this.a,b1=this.b,c1=this.c,d1=this.d,tx1=this.tx,n=a1*d1-b1*c1;return this.a=d1/n,this.b=-b1/n,this.c=-c1/n,this.d=a1/n,this.tx=(c1*this.ty-d1*tx1)/n,this.ty=-(a1*this.ty-b1*tx1)/n,this},Matrix.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},Matrix.prototype.clone=function(){var matrix=new Matrix;return matrix.a=this.a,matrix.b=this.b,matrix.c=this.c,matrix.d=this.d,matrix.tx=this.tx,matrix.ty=this.ty,matrix},Matrix.prototype.copyTo=function(matrix){return matrix.a=this.a,matrix.b=this.b,matrix.c=this.c,matrix.d=this.d,matrix.tx=this.tx,matrix.ty=this.ty,matrix},Matrix.prototype.copyFrom=function(matrix){return this.a=matrix.a,this.b=matrix.b,this.c=matrix.c,this.d=matrix.d,this.tx=matrix.tx,this.ty=matrix.ty,this},Matrix.prototype.toString=function(){return"[@pixi/math:Matrix a="+this.a+" b="+this.b+" c="+this.c+" d="+this.d+" tx="+this.tx+" ty="+this.ty+"]"},Object.defineProperty(Matrix,"IDENTITY",{get:function(){return new Matrix},enumerable:!1,configurable:!0}),Object.defineProperty(Matrix,"TEMP_MATRIX",{get:function(){return new Matrix},enumerable:!1,configurable:!0}),Matrix}(),canvas_mesh_ux=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],canvas_mesh_uy=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],canvas_mesh_vx=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],canvas_mesh_vy=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],canvas_mesh_rotationCayley=[],canvas_mesh_rotationMatrices=[],canvas_mesh_signum=Math.sign;!function(){for(var i=0;i<16;i++){var row=[];canvas_mesh_rotationCayley.push(row);for(var j=0;j<16;j++)for(var _ux=canvas_mesh_signum(canvas_mesh_ux[i]*canvas_mesh_ux[j]+canvas_mesh_vx[i]*canvas_mesh_uy[j]),_uy=canvas_mesh_signum(canvas_mesh_uy[i]*canvas_mesh_ux[j]+canvas_mesh_vy[i]*canvas_mesh_uy[j]),_vx=canvas_mesh_signum(canvas_mesh_ux[i]*canvas_mesh_vx[j]+canvas_mesh_vx[i]*canvas_mesh_vy[j]),_vy=canvas_mesh_signum(canvas_mesh_uy[i]*canvas_mesh_vx[j]+canvas_mesh_vy[i]*canvas_mesh_vy[j]),k=0;k<16;k++)if(canvas_mesh_ux[k]===_ux&&canvas_mesh_uy[k]===_uy&&canvas_mesh_vx[k]===_vx&&canvas_mesh_vy[k]===_vy){row.push(k);break}}for(i=0;i<16;i++){var mat=new canvas_mesh_Matrix;mat.set(canvas_mesh_ux[i],canvas_mesh_uy[i],canvas_mesh_vx[i],canvas_mesh_vy[i],0,0),canvas_mesh_rotationMatrices.push(mat)}}();var canvas_mesh_groupD8={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:function(ind){return canvas_mesh_ux[ind]},uY:function(ind){return canvas_mesh_uy[ind]},vX:function(ind){return canvas_mesh_vx[ind]},vY:function(ind){return canvas_mesh_vy[ind]},inv:function(rotation){return 8&rotation?15&rotation:7&-rotation},add:function(rotationSecond,rotationFirst){return canvas_mesh_rotationCayley[rotationSecond][rotationFirst]},sub:function(rotationSecond,rotationFirst){return canvas_mesh_rotationCayley[rotationSecond][canvas_mesh_groupD8.inv(rotationFirst)]},rotate180:function(rotation){return 4^rotation},isVertical:function(rotation){return 2==(3&rotation)},byDirection:function(dx,dy){return 2*Math.abs(dx)<=Math.abs(dy)?dy>=0?canvas_mesh_groupD8.S:canvas_mesh_groupD8.N:2*Math.abs(dy)<=Math.abs(dx)?dx>0?canvas_mesh_groupD8.E:canvas_mesh_groupD8.W:dy>0?dx>0?canvas_mesh_groupD8.SE:canvas_mesh_groupD8.SW:dx>0?canvas_mesh_groupD8.NE:canvas_mesh_groupD8.NW},matrixAppendRotationInv:function(matrix,rotation,tx,ty){void 0===tx&&(tx=0),void 0===ty&&(ty=0);var mat=canvas_mesh_rotationMatrices[canvas_mesh_groupD8.inv(rotation)];mat.tx=tx,mat.ty=ty,matrix.append(mat)}};!function(){function Transform(){this.worldTransform=new canvas_mesh_Matrix,this.localTransform=new canvas_mesh_Matrix,this.position=new canvas_mesh_ObservablePoint(this.onChange,this,0,0),this.scale=new canvas_mesh_ObservablePoint(this.onChange,this,1,1),this.pivot=new canvas_mesh_ObservablePoint(this.onChange,this,0,0),this.skew=new canvas_mesh_ObservablePoint(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}Transform.prototype.onChange=function(){this._localID++},Transform.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++},Transform.prototype.toString=function(){return"[@pixi/math:Transform position=("+this.position.x+", "+this.position.y+") rotation="+this.rotation+" scale=("+this.scale.x+", "+this.scale.y+") skew=("+this.skew.x+", "+this.skew.y+") ]"},Transform.prototype.updateLocalTransform=function(){var lt=this.localTransform;this._localID!==this._currentLocalID&&(lt.a=this._cx*this.scale.x,lt.b=this._sx*this.scale.x,lt.c=this._cy*this.scale.y,lt.d=this._sy*this.scale.y,lt.tx=this.position.x-(this.pivot.x*lt.a+this.pivot.y*lt.c),lt.ty=this.position.y-(this.pivot.x*lt.b+this.pivot.y*lt.d),this._currentLocalID=this._localID,this._parentID=-1)},Transform.prototype.updateTransform=function(parentTransform){var lt=this.localTransform;if(this._localID!==this._currentLocalID&&(lt.a=this._cx*this.scale.x,lt.b=this._sx*this.scale.x,lt.c=this._cy*this.scale.y,lt.d=this._sy*this.scale.y,lt.tx=this.position.x-(this.pivot.x*lt.a+this.pivot.y*lt.c),lt.ty=this.position.y-(this.pivot.x*lt.b+this.pivot.y*lt.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==parentTransform._worldID){var pt=parentTransform.worldTransform,wt=this.worldTransform;wt.a=lt.a*pt.a+lt.b*pt.c,wt.b=lt.a*pt.b+lt.b*pt.d,wt.c=lt.c*pt.a+lt.d*pt.c,wt.d=lt.c*pt.b+lt.d*pt.d,wt.tx=lt.tx*pt.a+lt.ty*pt.c+pt.tx,wt.ty=lt.tx*pt.b+lt.ty*pt.d+pt.ty,this._parentID=parentTransform._worldID,this._worldID++}},Transform.prototype.setFromMatrix=function(matrix){matrix.decompose(this),this._localID++},Object.defineProperty(Transform.prototype,"rotation",{get:function(){return this._rotation},set:function(value){this._rotation!==value&&(this._rotation=value,this.updateSkew())},enumerable:!1,configurable:!0}),Transform.IDENTITY=new Transform}();settings.PREFER_ENV=settings_isMobile.any?constants_ENV.WEBGL:constants_ENV.WEBGL2,settings.STRICT_TEXTURE_CACHE=!1;var canvas_mesh_INSTALLED=[];function canvas_mesh_autoDetectResource(source,options){if(!source)return null;var extension="";if("string"==typeof source){var result=/\.(\w{3,4})(?:$|\?|#)/i.exec(source);result&&(extension=result[1].toLowerCase())}for(var i=canvas_mesh_INSTALLED.length-1;i>=0;--i){var ResourcePlugin=canvas_mesh_INSTALLED[i];if(ResourcePlugin.test&&ResourcePlugin.test(source,extension))return new ResourcePlugin(source,options)}throw new Error("Unrecognized source type to auto-detect Resource")}var canvas_mesh_extendStatics=function(d,b){return canvas_mesh_extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])},canvas_mesh_extendStatics(d,b)};function canvas_mesh_extends(d,b){function __(){this.constructor=d}canvas_mesh_extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}var canvas_mesh_assign=function(){return canvas_mesh_assign=Object.assign||function(t){for(var s,arguments$1=arguments,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments$1[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t},canvas_mesh_assign.apply(this,arguments)};var canvas_mesh_Resource=function(){function Resource(width,height){void 0===width&&(width=0),void 0===height&&(height=0),this._width=width,this._height=height,this.destroyed=!1,this.internal=!1,this.onResize=new canvas_mesh_Runner("setRealSize"),this.onUpdate=new canvas_mesh_Runner("update"),this.onError=new canvas_mesh_Runner("onError")}return Resource.prototype.bind=function(baseTexture){this.onResize.add(baseTexture),this.onUpdate.add(baseTexture),this.onError.add(baseTexture),(this._width||this._height)&&this.onResize.emit(this._width,this._height)},Resource.prototype.unbind=function(baseTexture){this.onResize.remove(baseTexture),this.onUpdate.remove(baseTexture),this.onError.remove(baseTexture)},Resource.prototype.resize=function(width,height){width===this._width&&height===this._height||(this._width=width,this._height=height,this.onResize.emit(width,height))},Object.defineProperty(Resource.prototype,"valid",{get:function(){return!!this._width&&!!this._height},enumerable:!1,configurable:!0}),Resource.prototype.update=function(){this.destroyed||this.onUpdate.emit()},Resource.prototype.load=function(){return Promise.resolve(this)},Object.defineProperty(Resource.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0}),Object.defineProperty(Resource.prototype,"height",{get:function(){return this._height},enumerable:!1,configurable:!0}),Resource.prototype.style=function(_renderer,_baseTexture,_glTexture){return!1},Resource.prototype.dispose=function(){},Resource.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)},Resource.test=function(_source,_extension){return!1},Resource}(),canvas_mesh_BufferResource=function(_super){function BufferResource(source,options){var _this=this,_a=options||{},width=_a.width,height=_a.height;if(!width||!height)throw new Error("BufferResource width or height invalid");return(_this=_super.call(this,width,height)||this).data=source,_this}return canvas_mesh_extends(BufferResource,_super),BufferResource.prototype.upload=function(renderer,baseTexture,glTexture){var gl=renderer.gl;gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,baseTexture.alphaMode===constants_ALPHA_MODES.UNPACK);var width=baseTexture.realWidth,height=baseTexture.realHeight;return glTexture.width===width&&glTexture.height===height?gl.texSubImage2D(baseTexture.target,0,0,0,width,height,baseTexture.format,glTexture.type,this.data):(glTexture.width=width,glTexture.height=height,gl.texImage2D(baseTexture.target,0,glTexture.internalFormat,width,height,0,baseTexture.format,glTexture.type,this.data)),!0},BufferResource.prototype.dispose=function(){this.data=null},BufferResource.test=function(source){return source instanceof Float32Array||source instanceof Uint8Array||source instanceof Uint32Array},BufferResource}(canvas_mesh_Resource),canvas_mesh_defaultBufferOptions={scaleMode:constants_SCALE_MODES.NEAREST,format:constants_FORMATS.RGBA,alphaMode:constants_ALPHA_MODES.NPM},canvas_mesh_BaseTexture=function(_super){function BaseTexture(resource,options){void 0===resource&&(resource=null),void 0===options&&(options=null);var _this=_super.call(this)||this,alphaMode=(options=options||{}).alphaMode,mipmap=options.mipmap,anisotropicLevel=options.anisotropicLevel,scaleMode=options.scaleMode,width=options.width,height=options.height,wrapMode=options.wrapMode,format=options.format,type=options.type,target=options.target,resolution=options.resolution,resourceOptions=options.resourceOptions;return!resource||resource instanceof canvas_mesh_Resource||((resource=canvas_mesh_autoDetectResource(resource,resourceOptions)).internal=!0),_this.resolution=resolution||settings.RESOLUTION,_this.width=Math.round((width||0)*_this.resolution)/_this.resolution,_this.height=Math.round((height||0)*_this.resolution)/_this.resolution,_this._mipmap=void 0!==mipmap?mipmap:settings.MIPMAP_TEXTURES,_this.anisotropicLevel=void 0!==anisotropicLevel?anisotropicLevel:settings.ANISOTROPIC_LEVEL,_this._wrapMode=wrapMode||settings.WRAP_MODE,_this._scaleMode=void 0!==scaleMode?scaleMode:settings.SCALE_MODE,_this.format=format||constants_FORMATS.RGBA,_this.type=type||constants_TYPES.UNSIGNED_BYTE,_this.target=target||constants_TARGETS.TEXTURE_2D,_this.alphaMode=void 0!==alphaMode?alphaMode:constants_ALPHA_MODES.UNPACK,_this.uid=canvas_mesh_uid(),_this.touched=0,_this.isPowerOfTwo=!1,_this._refreshPOT(),_this._glTextures={},_this.dirtyId=0,_this.dirtyStyleId=0,_this.cacheId=null,_this.valid=width>0&&height>0,_this.textureCacheIds=[],_this.destroyed=!1,_this.resource=null,_this._batchEnabled=0,_this._batchLocation=0,_this.parentTextureArray=null,_this.setResource(resource),_this}return canvas_mesh_extends(BaseTexture,_super),Object.defineProperty(BaseTexture.prototype,"realWidth",{get:function(){return Math.round(this.width*this.resolution)},enumerable:!1,configurable:!0}),Object.defineProperty(BaseTexture.prototype,"realHeight",{get:function(){return Math.round(this.height*this.resolution)},enumerable:!1,configurable:!0}),Object.defineProperty(BaseTexture.prototype,"mipmap",{get:function(){return this._mipmap},set:function(value){this._mipmap!==value&&(this._mipmap=value,this.dirtyStyleId++)},enumerable:!1,configurable:!0}),Object.defineProperty(BaseTexture.prototype,"scaleMode",{get:function(){return this._scaleMode},set:function(value){this._scaleMode!==value&&(this._scaleMode=value,this.dirtyStyleId++)},enumerable:!1,configurable:!0}),Object.defineProperty(BaseTexture.prototype,"wrapMode",{get:function(){return this._wrapMode},set:function(value){this._wrapMode!==value&&(this._wrapMode=value,this.dirtyStyleId++)},enumerable:!1,configurable:!0}),BaseTexture.prototype.setStyle=function(scaleMode,mipmap){var dirty;return void 0!==scaleMode&&scaleMode!==this.scaleMode&&(this.scaleMode=scaleMode,dirty=!0),void 0!==mipmap&&mipmap!==this.mipmap&&(this.mipmap=mipmap,dirty=!0),dirty&&this.dirtyStyleId++,this},BaseTexture.prototype.setSize=function(desiredWidth,desiredHeight,resolution){return resolution=resolution||this.resolution,this.setRealSize(desiredWidth*resolution,desiredHeight*resolution,resolution)},BaseTexture.prototype.setRealSize=function(realWidth,realHeight,resolution){return this.resolution=resolution||this.resolution,this.width=Math.round(realWidth)/this.resolution,this.height=Math.round(realHeight)/this.resolution,this._refreshPOT(),this.update(),this},BaseTexture.prototype._refreshPOT=function(){this.isPowerOfTwo=canvas_mesh_isPow2(this.realWidth)&&canvas_mesh_isPow2(this.realHeight)},BaseTexture.prototype.setResolution=function(resolution){var oldResolution=this.resolution;return oldResolution===resolution||(this.resolution=resolution,this.valid&&(this.width=Math.round(this.width*oldResolution)/resolution,this.height=Math.round(this.height*oldResolution)/resolution,this.emit("update",this)),this._refreshPOT()),this},BaseTexture.prototype.setResource=function(resource){if(this.resource===resource)return this;if(this.resource)throw new Error("Resource can be set only once");return resource.bind(this),this.resource=resource,this},BaseTexture.prototype.update=function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},BaseTexture.prototype.onError=function(event){this.emit("error",this,event)},BaseTexture.prototype.destroy=function(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete canvas_mesh_BaseTextureCache[this.cacheId],delete canvas_mesh_TextureCache[this.cacheId],this.cacheId=null),this.dispose(),BaseTexture.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0},BaseTexture.prototype.dispose=function(){this.emit("dispose",this)},BaseTexture.prototype.castToBaseTexture=function(){return this},BaseTexture.from=function(source,options,strict){void 0===strict&&(strict=settings.STRICT_TEXTURE_CACHE);var isFrame="string"==typeof source,cacheId=null;if(isFrame)cacheId=source;else{if(!source._pixiId){var prefix=options&&options.pixiIdPrefix||"pixiid";source._pixiId=prefix+"_"+canvas_mesh_uid()}cacheId=source._pixiId}var baseTexture=canvas_mesh_BaseTextureCache[cacheId];if(isFrame&&strict&&!baseTexture)throw new Error('The cacheId "'+cacheId+'" does not exist in BaseTextureCache.');return baseTexture||((baseTexture=new BaseTexture(source,options)).cacheId=cacheId,BaseTexture.addToCache(baseTexture,cacheId)),baseTexture},BaseTexture.fromBuffer=function(buffer,width,height,options){buffer=buffer||new Float32Array(width*height*4);var resource=new canvas_mesh_BufferResource(buffer,{width,height}),type=buffer instanceof Float32Array?constants_TYPES.FLOAT:constants_TYPES.UNSIGNED_BYTE;return new BaseTexture(resource,Object.assign(canvas_mesh_defaultBufferOptions,options||{width,height,type}))},BaseTexture.addToCache=function(baseTexture,id){id&&(-1===baseTexture.textureCacheIds.indexOf(id)&&baseTexture.textureCacheIds.push(id),canvas_mesh_BaseTextureCache[id]&&console.warn("BaseTexture added to the cache with an id ["+id+"] that already had an entry"),canvas_mesh_BaseTextureCache[id]=baseTexture)},BaseTexture.removeFromCache=function(baseTexture){if("string"==typeof baseTexture){var baseTextureFromCache=canvas_mesh_BaseTextureCache[baseTexture];if(baseTextureFromCache){var index=baseTextureFromCache.textureCacheIds.indexOf(baseTexture);return index>-1&&baseTextureFromCache.textureCacheIds.splice(index,1),delete canvas_mesh_BaseTextureCache[baseTexture],baseTextureFromCache}}else if(baseTexture&&baseTexture.textureCacheIds){for(var i=0;i<baseTexture.textureCacheIds.length;++i)delete canvas_mesh_BaseTextureCache[baseTexture.textureCacheIds[i]];return baseTexture.textureCacheIds.length=0,baseTexture}return null},BaseTexture._globalBatch=0,BaseTexture}(canvas_mesh_eventemitter3),canvas_mesh_AbstractMultiResource=function(_super){function AbstractMultiResource(length,options){var _this=this,_a=options||{},width=_a.width,height=_a.height;(_this=_super.call(this,width,height)||this).items=[],_this.itemDirtyIds=[];for(var i=0;i<length;i++){var partTexture=new canvas_mesh_BaseTexture;_this.items.push(partTexture),_this.itemDirtyIds.push(-2)}return _this.length=length,_this._load=null,_this.baseTexture=null,_this}return canvas_mesh_extends(AbstractMultiResource,_super),AbstractMultiResource.prototype.initFromArray=function(resources,options){for(var i=0;i<this.length;i++)resources[i]&&(resources[i].castToBaseTexture?this.addBaseTextureAt(resources[i].castToBaseTexture(),i):resources[i]instanceof canvas_mesh_Resource?this.addResourceAt(resources[i],i):this.addResourceAt(canvas_mesh_autoDetectResource(resources[i],options),i))},AbstractMultiResource.prototype.dispose=function(){for(var i=0,len=this.length;i<len;i++)this.items[i].destroy();this.items=null,this.itemDirtyIds=null,this._load=null},AbstractMultiResource.prototype.addResourceAt=function(resource,index){if(!this.items[index])throw new Error("Index "+index+" is out of bounds");return resource.valid&&!this.valid&&this.resize(resource.width,resource.height),this.items[index].setResource(resource),this},AbstractMultiResource.prototype.bind=function(baseTexture){if(null!==this.baseTexture)throw new Error("Only one base texture per TextureArray is allowed");_super.prototype.bind.call(this,baseTexture);for(var i=0;i<this.length;i++)this.items[i].parentTextureArray=baseTexture,this.items[i].on("update",baseTexture.update,baseTexture)},AbstractMultiResource.prototype.unbind=function(baseTexture){_super.prototype.unbind.call(this,baseTexture);for(var i=0;i<this.length;i++)this.items[i].parentTextureArray=null,this.items[i].off("update",baseTexture.update,baseTexture)},AbstractMultiResource.prototype.load=function(){var _this=this;if(this._load)return this._load;var promises=this.items.map((function(item){return item.resource})).filter((function(item){return item})).map((function(item){return item.load()}));return this._load=Promise.all(promises).then((function(){var _a=_this.items[0],realWidth=_a.realWidth,realHeight=_a.realHeight;return _this.resize(realWidth,realHeight),Promise.resolve(_this)})),this._load},AbstractMultiResource}(canvas_mesh_Resource),canvas_mesh_ArrayResource=function(_super){function ArrayResource(source,options){var urls,length,_this=this,_a=options||{},width=_a.width,height=_a.height;return Array.isArray(source)?(urls=source,length=source.length):length=source,_this=_super.call(this,length,{width,height})||this,urls&&_this.initFromArray(urls,options),_this}return canvas_mesh_extends(ArrayResource,_super),ArrayResource.prototype.addBaseTextureAt=function(baseTexture,index){if(!baseTexture.resource)throw new Error("ArrayResource does not support RenderTexture");return this.addResourceAt(baseTexture.resource,index),this},ArrayResource.prototype.bind=function(baseTexture){_super.prototype.bind.call(this,baseTexture),baseTexture.target=constants_TARGETS.TEXTURE_2D_ARRAY},ArrayResource.prototype.upload=function(renderer,texture,glTexture){var length=this.length,itemDirtyIds=this.itemDirtyIds,items=this.items,gl=renderer.gl;glTexture.dirtyId<0&&gl.texImage3D(gl.TEXTURE_2D_ARRAY,0,glTexture.internalFormat,this._width,this._height,length,0,texture.format,glTexture.type,null);for(var i=0;i<length;i++){var item=items[i];itemDirtyIds[i]<item.dirtyId&&(itemDirtyIds[i]=item.dirtyId,item.valid&&gl.texSubImage3D(gl.TEXTURE_2D_ARRAY,0,0,0,i,item.resource.width,item.resource.height,1,texture.format,glTexture.type,item.resource.source))}return!0},ArrayResource}(canvas_mesh_AbstractMultiResource),canvas_mesh_BaseImageResource=function(_super){function BaseImageResource(source){var _this=this,sourceAny=source,width=sourceAny.naturalWidth||sourceAny.videoWidth||sourceAny.width,height=sourceAny.naturalHeight||sourceAny.videoHeight||sourceAny.height;return(_this=_super.call(this,width,height)||this).source=source,_this.noSubImage=!1,_this}return canvas_mesh_extends(BaseImageResource,_super),BaseImageResource.crossOrigin=function(element,url,crossorigin){void 0===crossorigin&&0!==url.indexOf("data:")?element.crossOrigin=function(url$1,loc){if(void 0===loc&&(loc=globalThis.location),0===url$1.indexOf("data:"))return"";loc=loc||globalThis.location,canvas_mesh_tempAnchor||(canvas_mesh_tempAnchor=document.createElement("a")),canvas_mesh_tempAnchor.href=url$1;var parsedUrl=canvas_mesh_url.parse(canvas_mesh_tempAnchor.href),samePort=!parsedUrl.port&&""===loc.port||parsedUrl.port===loc.port;return parsedUrl.hostname===loc.hostname&&samePort&&parsedUrl.protocol===loc.protocol?"":"anonymous"}(url):!1!==crossorigin&&(element.crossOrigin="string"==typeof crossorigin?crossorigin:"anonymous")},BaseImageResource.prototype.upload=function(renderer,baseTexture,glTexture,source){var gl=renderer.gl,width=baseTexture.realWidth,height=baseTexture.realHeight;if((source=source||this.source)instanceof HTMLImageElement){if(!source.complete||0===source.naturalWidth)return!1}else if(source instanceof HTMLVideoElement&&source.readyState<=1)return!1;return gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,baseTexture.alphaMode===constants_ALPHA_MODES.UNPACK),this.noSubImage||baseTexture.target!==gl.TEXTURE_2D||glTexture.width!==width||glTexture.height!==height?(glTexture.width=width,glTexture.height=height,gl.texImage2D(baseTexture.target,0,glTexture.internalFormat,baseTexture.format,glTexture.type,source)):gl.texSubImage2D(gl.TEXTURE_2D,0,0,0,baseTexture.format,glTexture.type,source),!0},BaseImageResource.prototype.update=function(){if(!this.destroyed){var source=this.source,width=source.naturalWidth||source.videoWidth||source.width,height=source.naturalHeight||source.videoHeight||source.height;this.resize(width,height),_super.prototype.update.call(this)}},BaseImageResource.prototype.dispose=function(){this.source=null},BaseImageResource}(canvas_mesh_Resource),canvas_mesh_CanvasResource=function(_super){function CanvasResource(source){return _super.call(this,source)||this}return canvas_mesh_extends(CanvasResource,_super),CanvasResource.test=function(source){var OffscreenCanvas=globalThis.OffscreenCanvas;return!!(OffscreenCanvas&&source instanceof OffscreenCanvas)||globalThis.HTMLCanvasElement&&source instanceof HTMLCanvasElement},CanvasResource}(canvas_mesh_BaseImageResource),canvas_mesh_CubeResource=function(_super){function CubeResource(source,options){var _this=this,_a=options||{},width=_a.width,height=_a.height,autoLoad=_a.autoLoad,linkBaseTexture=_a.linkBaseTexture;if(source&&source.length!==CubeResource.SIDES)throw new Error("Invalid length. Got "+source.length+", expected 6");_this=_super.call(this,6,{width,height})||this;for(var i=0;i<CubeResource.SIDES;i++)_this.items[i].target=constants_TARGETS.TEXTURE_CUBE_MAP_POSITIVE_X+i;return _this.linkBaseTexture=!1!==linkBaseTexture,source&&_this.initFromArray(source,options),!1!==autoLoad&&_this.load(),_this}return canvas_mesh_extends(CubeResource,_super),CubeResource.prototype.bind=function(baseTexture){_super.prototype.bind.call(this,baseTexture),baseTexture.target=constants_TARGETS.TEXTURE_CUBE_MAP},CubeResource.prototype.addBaseTextureAt=function(baseTexture,index,linkBaseTexture){if(void 0===linkBaseTexture&&(linkBaseTexture=this.linkBaseTexture),!this.items[index])throw new Error("Index "+index+" is out of bounds");if(!this.linkBaseTexture||baseTexture.parentTextureArray||Object.keys(baseTexture._glTextures).length>0){if(!baseTexture.resource)throw new Error("CubeResource does not support copying of renderTexture.");this.addResourceAt(baseTexture.resource,index)}else baseTexture.target=constants_TARGETS.TEXTURE_CUBE_MAP_POSITIVE_X+index,baseTexture.parentTextureArray=this.baseTexture,this.items[index]=baseTexture;return baseTexture.valid&&!this.valid&&this.resize(baseTexture.realWidth,baseTexture.realHeight),this.items[index]=baseTexture,this},CubeResource.prototype.upload=function(renderer,_baseTexture,glTexture){for(var dirty=this.itemDirtyIds,i=0;i<CubeResource.SIDES;i++){var side=this.items[i];dirty[i]<side.dirtyId&&(side.valid&&side.resource?(side.resource.upload(renderer,side,glTexture),dirty[i]=side.dirtyId):dirty[i]<-1&&(renderer.gl.texImage2D(side.target,0,glTexture.internalFormat,_baseTexture.realWidth,_baseTexture.realHeight,0,_baseTexture.format,glTexture.type,null),dirty[i]=-1))}return!0},CubeResource.test=function(source){return Array.isArray(source)&&source.length===CubeResource.SIDES},CubeResource.SIDES=6,CubeResource}(canvas_mesh_AbstractMultiResource),canvas_mesh_ImageResource=function(_super){function ImageResource(source,options){var _this=this;if(options=options||{},!(source instanceof HTMLImageElement)){var imageElement=new Image;canvas_mesh_BaseImageResource.crossOrigin(imageElement,source,options.crossorigin),imageElement.src=source,source=imageElement}return _this=_super.call(this,source)||this,!source.complete&&_this._width&&_this._height&&(_this._width=0,_this._height=0),_this.url=source.src,_this._process=null,_this.preserveBitmap=!1,_this.createBitmap=(void 0!==options.createBitmap?options.createBitmap:settings.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,_this.alphaMode="number"==typeof options.alphaMode?options.alphaMode:null,_this.bitmap=null,_this._load=null,!1!==options.autoLoad&&_this.load(),_this}return canvas_mesh_extends(ImageResource,_super),ImageResource.prototype.load=function(createBitmap){var _this=this;return this._load||(void 0!==createBitmap&&(this.createBitmap=createBitmap),this._load=new Promise((function(resolve,reject){var source=_this.source;_this.url=source.src;var completed=function(){_this.destroyed||(source.onload=null,source.onerror=null,_this.resize(source.width,source.height),_this._load=null,_this.createBitmap?resolve(_this.process()):resolve(_this))};source.complete&&source.src?completed():(source.onload=completed,source.onerror=function(event){reject(event),_this.onError.emit(event)})}))),this._load},ImageResource.prototype.process=function(){var _this=this,source=this.source;if(null!==this._process)return this._process;if(null!==this.bitmap||!globalThis.createImageBitmap)return Promise.resolve(this);var createImageBitmap=globalThis.createImageBitmap,cors=!source.crossOrigin||"anonymous"===source.crossOrigin;return this._process=fetch(source.src,{mode:cors?"cors":"no-cors"}).then((function(r){return r.blob()})).then((function(blob){return createImageBitmap(blob,0,0,source.width,source.height,{premultiplyAlpha:_this.alphaMode===constants_ALPHA_MODES.UNPACK?"premultiply":"none"})})).then((function(bitmap){return _this.destroyed?Promise.reject():(_this.bitmap=bitmap,_this.update(),_this._process=null,Promise.resolve(_this))})),this._process},ImageResource.prototype.upload=function(renderer,baseTexture,glTexture){if("number"==typeof this.alphaMode&&(baseTexture.alphaMode=this.alphaMode),!this.createBitmap)return _super.prototype.upload.call(this,renderer,baseTexture,glTexture);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(_super.prototype.upload.call(this,renderer,baseTexture,glTexture,this.bitmap),!this.preserveBitmap){var flag=!0,glTextures=baseTexture._glTextures;for(var key in glTextures){var otherTex=glTextures[key];if(otherTex!==glTexture&&otherTex.dirtyId!==baseTexture.dirtyId){flag=!1;break}}flag&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},ImageResource.prototype.dispose=function(){this.source.onload=null,this.source.onerror=null,_super.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},ImageResource.test=function(source){return"string"==typeof source||source instanceof HTMLImageElement},ImageResource}(canvas_mesh_BaseImageResource),canvas_mesh_SVGResource=function(_super){function SVGResource(sourceBase64,options){var _this=this;return options=options||{},(_this=_super.call(this,document.createElement("canvas"))||this)._width=0,_this._height=0,_this.svg=sourceBase64,_this.scale=options.scale||1,_this._overrideWidth=options.width,_this._overrideHeight=options.height,_this._resolve=null,_this._crossorigin=options.crossorigin,_this._load=null,!1!==options.autoLoad&&_this.load(),_this}return canvas_mesh_extends(SVGResource,_super),SVGResource.prototype.load=function(){var _this=this;return this._load||(this._load=new Promise((function(resolve){if(_this._resolve=function(){_this.resize(_this.source.width,_this.source.height),resolve(_this)},SVGResource.SVG_XML.test(_this.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");_this.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(_this.svg)))}_this._loadSvg()}))),this._load},SVGResource.prototype._loadSvg=function(){var _this=this,tempImage=new Image;canvas_mesh_BaseImageResource.crossOrigin(tempImage,this.svg,this._crossorigin),tempImage.src=this.svg,tempImage.onerror=function(event){_this._resolve&&(tempImage.onerror=null,_this.onError.emit(event))},tempImage.onload=function(){if(_this._resolve){var svgWidth=tempImage.width,svgHeight=tempImage.height;if(!svgWidth||!svgHeight)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");var width=svgWidth*_this.scale,height=svgHeight*_this.scale;(_this._overrideWidth||_this._overrideHeight)&&(width=_this._overrideWidth||_this._overrideHeight/svgHeight*svgWidth,height=_this._overrideHeight||_this._overrideWidth/svgWidth*svgHeight),width=Math.round(width),height=Math.round(height);var canvas=_this.source;canvas.width=width,canvas.height=height,canvas._pixiId="canvas_"+canvas_mesh_uid(),canvas.getContext("2d").drawImage(tempImage,0,0,svgWidth,svgHeight,0,0,width,height),_this._resolve(),_this._resolve=null}}},SVGResource.getSize=function(svgString){var sizeMatch=SVGResource.SVG_SIZE.exec(svgString),size={};return sizeMatch&&(size[sizeMatch[1]]=Math.round(parseFloat(sizeMatch[3])),size[sizeMatch[5]]=Math.round(parseFloat(sizeMatch[7]))),size},SVGResource.prototype.dispose=function(){_super.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},SVGResource.test=function(source,extension){return"svg"===extension||"string"==typeof source&&/^data:image\/svg\+xml(;(charset=utf8|utf8))?;base64/.test(source)||"string"==typeof source&&SVGResource.SVG_XML.test(source)},SVGResource.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m,SVGResource.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i,SVGResource}(canvas_mesh_BaseImageResource),canvas_mesh_VideoResource=function(_super){function VideoResource(source,options){var _this=this;if(options=options||{},!(source instanceof HTMLVideoElement)){var videoElement=document.createElement("video");videoElement.setAttribute("preload","auto"),videoElement.setAttribute("webkit-playsinline",""),videoElement.setAttribute("playsinline",""),"string"==typeof source&&(source=[source]);var firstSrc=source[0].src||source[0];canvas_mesh_BaseImageResource.crossOrigin(videoElement,firstSrc,options.crossorigin);for(var i=0;i<source.length;++i){var sourceElement=document.createElement("source"),_a=source[i],src=_a.src,mime=_a.mime,baseSrc=(src=src||source[i]).split("?").shift().toLowerCase(),ext=baseSrc.slice(baseSrc.lastIndexOf(".")+1);mime=mime||VideoResource.MIME_TYPES[ext]||"video/"+ext,sourceElement.src=src,sourceElement.type=mime,videoElement.appendChild(sourceElement)}source=videoElement}return(_this=_super.call(this,source)||this).noSubImage=!0,_this._autoUpdate=!0,_this._isConnectedToTicker=!1,_this._updateFPS=options.updateFPS||0,_this._msToNextUpdate=0,_this.autoPlay=!1!==options.autoPlay,_this._load=null,_this._resolve=null,_this._onCanPlay=_this._onCanPlay.bind(_this),_this._onError=_this._onError.bind(_this),!1!==options.autoLoad&&_this.load(),_this}return canvas_mesh_extends(VideoResource,_super),VideoResource.prototype.update=function(_deltaTime){if(!this.destroyed){var elapsedMS=canvas_mesh_Ticker.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-elapsedMS),(!this._updateFPS||this._msToNextUpdate<=0)&&(_super.prototype.update.call(this),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},VideoResource.prototype.load=function(){var _this=this;if(this._load)return this._load;var source=this.source;return(source.readyState===source.HAVE_ENOUGH_DATA||source.readyState===source.HAVE_FUTURE_DATA)&&source.width&&source.height&&(source.complete=!0),source.addEventListener("play",this._onPlayStart.bind(this)),source.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(source.addEventListener("canplay",this._onCanPlay),source.addEventListener("canplaythrough",this._onCanPlay),source.addEventListener("error",this._onError,!0)),this._load=new Promise((function(resolve){_this.valid?resolve(_this):(_this._resolve=resolve,source.load())})),this._load},VideoResource.prototype._onError=function(event){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(event)},VideoResource.prototype._isSourcePlaying=function(){var source=this.source;return source.currentTime>0&&!1===source.paused&&!1===source.ended&&source.readyState>2},VideoResource.prototype._isSourceReady=function(){var source=this.source;return 3===source.readyState||4===source.readyState},VideoResource.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(canvas_mesh_Ticker.shared.add(this.update,this),this._isConnectedToTicker=!0)},VideoResource.prototype._onPlayStop=function(){this._isConnectedToTicker&&(canvas_mesh_Ticker.shared.remove(this.update,this),this._isConnectedToTicker=!1)},VideoResource.prototype._onCanPlay=function(){var source=this.source;source.removeEventListener("canplay",this._onCanPlay),source.removeEventListener("canplaythrough",this._onCanPlay);var valid=this.valid;this.resize(source.videoWidth,source.videoHeight),!valid&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&source.play()},VideoResource.prototype.dispose=function(){this._isConnectedToTicker&&(canvas_mesh_Ticker.shared.remove(this.update,this),this._isConnectedToTicker=!1);var source=this.source;source&&(source.removeEventListener("error",this._onError,!0),source.pause(),source.src="",source.load()),_super.prototype.dispose.call(this)},Object.defineProperty(VideoResource.prototype,"autoUpdate",{get:function(){return this._autoUpdate},set:function(value){value!==this._autoUpdate&&(this._autoUpdate=value,!this._autoUpdate&&this._isConnectedToTicker?(canvas_mesh_Ticker.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(canvas_mesh_Ticker.shared.add(this.update,this),this._isConnectedToTicker=!0))},enumerable:!1,configurable:!0}),Object.defineProperty(VideoResource.prototype,"updateFPS",{get:function(){return this._updateFPS},set:function(value){value!==this._updateFPS&&(this._updateFPS=value)},enumerable:!1,configurable:!0}),VideoResource.test=function(source,extension){return globalThis.HTMLVideoElement&&source instanceof HTMLVideoElement||VideoResource.TYPES.indexOf(extension)>-1},VideoResource.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],VideoResource.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"},VideoResource}(canvas_mesh_BaseImageResource),canvas_mesh_ImageBitmapResource=function(_super){function ImageBitmapResource(source){return _super.call(this,source)||this}return canvas_mesh_extends(ImageBitmapResource,_super),ImageBitmapResource.test=function(source){return!!globalThis.createImageBitmap&&source instanceof ImageBitmap},ImageBitmapResource}(canvas_mesh_BaseImageResource);canvas_mesh_INSTALLED.push(canvas_mesh_ImageResource,canvas_mesh_ImageBitmapResource,canvas_mesh_CanvasResource,canvas_mesh_VideoResource,canvas_mesh_SVGResource,canvas_mesh_BufferResource,canvas_mesh_CubeResource,canvas_mesh_ArrayResource);var canvas_mesh_resources={__proto__:null,Resource:canvas_mesh_Resource,BaseImageResource:canvas_mesh_BaseImageResource,INSTALLED:canvas_mesh_INSTALLED,autoDetectResource:canvas_mesh_autoDetectResource,AbstractMultiResource:canvas_mesh_AbstractMultiResource,ArrayResource:canvas_mesh_ArrayResource,BufferResource:canvas_mesh_BufferResource,CanvasResource:canvas_mesh_CanvasResource,CubeResource:canvas_mesh_CubeResource,ImageResource:canvas_mesh_ImageResource,SVGResource:canvas_mesh_SVGResource,VideoResource:canvas_mesh_VideoResource,ImageBitmapResource:canvas_mesh_ImageBitmapResource},canvas_mesh_DepthResource=function(_super){function DepthResource(){return null!==_super&&_super.apply(this,arguments)||this}return canvas_mesh_extends(DepthResource,_super),DepthResource.prototype.upload=function(renderer,baseTexture,glTexture){var gl=renderer.gl;gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,baseTexture.alphaMode===constants_ALPHA_MODES.UNPACK);var width=baseTexture.realWidth,height=baseTexture.realHeight;return glTexture.width===width&&glTexture.height===height?gl.texSubImage2D(baseTexture.target,0,0,0,width,height,baseTexture.format,glTexture.type,this.data):(glTexture.width=width,glTexture.height=height,gl.texImage2D(baseTexture.target,0,glTexture.internalFormat,width,height,0,baseTexture.format,glTexture.type,this.data)),!0},DepthResource}(canvas_mesh_BufferResource),canvas_mesh_Framebuffer=function(){function Framebuffer(width,height){this.width=Math.round(width||100),this.height=Math.round(height||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new canvas_mesh_Runner("disposeFramebuffer"),this.multisample=constants_MSAA_QUALITY.NONE}return Object.defineProperty(Framebuffer.prototype,"colorTexture",{get:function(){return this.colorTextures[0]},enumerable:!1,configurable:!0}),Framebuffer.prototype.addColorTexture=function(index,texture){return void 0===index&&(index=0),this.colorTextures[index]=texture||new canvas_mesh_BaseTexture(null,{scaleMode:constants_SCALE_MODES.NEAREST,resolution:1,mipmap:constants_MIPMAP_MODES.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},Framebuffer.prototype.addDepthTexture=function(texture){return this.depthTexture=texture||new canvas_mesh_BaseTexture(new canvas_mesh_DepthResource(null,{width:this.width,height:this.height}),{scaleMode:constants_SCALE_MODES.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:constants_MIPMAP_MODES.OFF,format:constants_FORMATS.DEPTH_COMPONENT,type:constants_TYPES.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this},Framebuffer.prototype.enableDepth=function(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},Framebuffer.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},Framebuffer.prototype.resize=function(width,height){if(width=Math.round(width),height=Math.round(height),width!==this.width||height!==this.height){this.width=width,this.height=height,this.dirtyId++,this.dirtySize++;for(var i=0;i<this.colorTextures.length;i++){var texture=this.colorTextures[i],resolution=texture.resolution;texture.setSize(width/resolution,height/resolution)}if(this.depthTexture){resolution=this.depthTexture.resolution;this.depthTexture.setSize(width/resolution,height/resolution)}}},Framebuffer.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},Framebuffer.prototype.destroyDepthTexture=function(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)},Framebuffer}(),canvas_mesh_BaseRenderTexture=function(_super){function BaseRenderTexture(options){void 0===options&&(options={});var _this=this;if("number"==typeof options){var width=arguments[0],height=arguments[1],scaleMode=arguments[2],resolution=arguments[3];options={width,height,scaleMode,resolution}}return options.width=options.width||100,options.height=options.height||100,options.multisample=void 0!==options.multisample?options.multisample:constants_MSAA_QUALITY.NONE,(_this=_super.call(this,null,options)||this).mipmap=constants_MIPMAP_MODES.OFF,_this.valid=!0,_this.clearColor=[0,0,0,0],_this.framebuffer=new canvas_mesh_Framebuffer(_this.realWidth,_this.realHeight).addColorTexture(0,_this),_this.framebuffer.multisample=options.multisample,_this.maskStack=[],_this.filterStack=[{}],_this}return canvas_mesh_extends(BaseRenderTexture,_super),BaseRenderTexture.prototype.resize=function(desiredWidth,desiredHeight){this.framebuffer.resize(desiredWidth*this.resolution,desiredHeight*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)},BaseRenderTexture.prototype.dispose=function(){this.framebuffer.dispose(),_super.prototype.dispose.call(this)},BaseRenderTexture.prototype.destroy=function(){_super.prototype.destroy.call(this),this.framebuffer.destroyDepthTexture(),this.framebuffer=null},BaseRenderTexture}(canvas_mesh_BaseTexture),canvas_mesh_TextureUvs=function(){function TextureUvs(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}return TextureUvs.prototype.set=function(frame,baseFrame,rotate){var tw=baseFrame.width,th=baseFrame.height;if(rotate){var w2=frame.width/2/tw,h2=frame.height/2/th,cX=frame.x/tw+w2,cY=frame.y/th+h2;rotate=canvas_mesh_groupD8.add(rotate,canvas_mesh_groupD8.NW),this.x0=cX+w2*canvas_mesh_groupD8.uX(rotate),this.y0=cY+h2*canvas_mesh_groupD8.uY(rotate),rotate=canvas_mesh_groupD8.add(rotate,2),this.x1=cX+w2*canvas_mesh_groupD8.uX(rotate),this.y1=cY+h2*canvas_mesh_groupD8.uY(rotate),rotate=canvas_mesh_groupD8.add(rotate,2),this.x2=cX+w2*canvas_mesh_groupD8.uX(rotate),this.y2=cY+h2*canvas_mesh_groupD8.uY(rotate),rotate=canvas_mesh_groupD8.add(rotate,2),this.x3=cX+w2*canvas_mesh_groupD8.uX(rotate),this.y3=cY+h2*canvas_mesh_groupD8.uY(rotate)}else this.x0=frame.x/tw,this.y0=frame.y/th,this.x1=(frame.x+frame.width)/tw,this.y1=frame.y/th,this.x2=(frame.x+frame.width)/tw,this.y2=(frame.y+frame.height)/th,this.x3=frame.x/tw,this.y3=(frame.y+frame.height)/th;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3},TextureUvs.prototype.toString=function(){return"[@pixi/core:TextureUvs x0="+this.x0+" y0="+this.y0+" x1="+this.x1+" y1="+this.y1+" x2="+this.x2+" y2="+this.y2+" x3="+this.x3+" y3="+this.y3+"]"},TextureUvs}(),canvas_mesh_DEFAULT_UVS=new canvas_mesh_TextureUvs,canvas_mesh_Texture=function(_super){function Texture(baseTexture,frame,orig,trim,rotate,anchor){var _this=_super.call(this)||this;if(_this.noFrame=!1,frame||(_this.noFrame=!0,frame=new canvas_mesh_Rectangle(0,0,1,1)),baseTexture instanceof Texture&&(baseTexture=baseTexture.baseTexture),_this.baseTexture=baseTexture,_this._frame=frame,_this.trim=trim,_this.valid=!1,_this._uvs=canvas_mesh_DEFAULT_UVS,_this.uvMatrix=null,_this.orig=orig||frame,_this._rotate=Number(rotate||0),!0===rotate)_this._rotate=2;else if(_this._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");return _this.defaultAnchor=anchor?new canvas_mesh_Point(anchor.x,anchor.y):new canvas_mesh_Point(0,0),_this._updateID=0,_this.textureCacheIds=[],baseTexture.valid?_this.noFrame?baseTexture.valid&&_this.onBaseTextureUpdated(baseTexture):_this.frame=frame:baseTexture.once("loaded",_this.onBaseTextureUpdated,_this),_this.noFrame&&baseTexture.on("update",_this.onBaseTextureUpdated,_this),_this}return canvas_mesh_extends(Texture,_super),Texture.prototype.update=function(){this.baseTexture.resource&&this.baseTexture.resource.update()},Texture.prototype.onBaseTextureUpdated=function(baseTexture){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=baseTexture.width,this._frame.height=baseTexture.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)},Texture.prototype.destroy=function(destroyBase){if(this.baseTexture){if(destroyBase){var resource=this.baseTexture.resource;resource&&resource.url&&canvas_mesh_TextureCache[resource.url]&&Texture.removeFromCache(resource.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,Texture.removeFromCache(this),this.textureCacheIds=null},Texture.prototype.clone=function(){var clonedFrame=this._frame.clone(),clonedOrig=this._frame===this.orig?clonedFrame:this.orig.clone(),clonedTexture=new Texture(this.baseTexture,!this.noFrame&&clonedFrame,clonedOrig,this.trim&&this.trim.clone(),this.rotate,this.defaultAnchor);return this.noFrame&&(clonedTexture._frame=clonedFrame),clonedTexture},Texture.prototype.updateUvs=function(){this._uvs===canvas_mesh_DEFAULT_UVS&&(this._uvs=new canvas_mesh_TextureUvs),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},Texture.from=function(source,options,strict){void 0===options&&(options={}),void 0===strict&&(strict=settings.STRICT_TEXTURE_CACHE);var isFrame="string"==typeof source,cacheId=null;if(isFrame)cacheId=source;else if(source instanceof canvas_mesh_BaseTexture){if(!source.cacheId){var prefix=options&&options.pixiIdPrefix||"pixiid";source.cacheId=prefix+"-"+canvas_mesh_uid(),canvas_mesh_BaseTexture.addToCache(source,source.cacheId)}cacheId=source.cacheId}else{if(!source._pixiId){prefix=options&&options.pixiIdPrefix||"pixiid";source._pixiId=prefix+"_"+canvas_mesh_uid()}cacheId=source._pixiId}var texture=canvas_mesh_TextureCache[cacheId];if(isFrame&&strict&&!texture)throw new Error('The cacheId "'+cacheId+'" does not exist in TextureCache.');return texture||source instanceof canvas_mesh_BaseTexture?!texture&&source instanceof canvas_mesh_BaseTexture&&(texture=new Texture(source),Texture.addToCache(texture,cacheId)):(options.resolution||(options.resolution=canvas_mesh_getResolutionOfUrl(source)),(texture=new Texture(new canvas_mesh_BaseTexture(source,options))).baseTexture.cacheId=cacheId,canvas_mesh_BaseTexture.addToCache(texture.baseTexture,cacheId),Texture.addToCache(texture,cacheId)),texture},Texture.fromURL=function(url,options){var resourceOptions=Object.assign({autoLoad:!1},null==options?void 0:options.resourceOptions),texture=Texture.from(url,Object.assign({resourceOptions},options),!1),resource=texture.baseTexture.resource;return texture.baseTexture.valid?Promise.resolve(texture):resource.load().then((function(){return Promise.resolve(texture)}))},Texture.fromBuffer=function(buffer,width,height,options){return new Texture(canvas_mesh_BaseTexture.fromBuffer(buffer,width,height,options))},Texture.fromLoader=function(source,imageUrl,name,options){var baseTexture=new canvas_mesh_BaseTexture(source,Object.assign({scaleMode:settings.SCALE_MODE,resolution:canvas_mesh_getResolutionOfUrl(imageUrl)},options)),resource=baseTexture.resource;resource instanceof canvas_mesh_ImageResource&&(resource.url=imageUrl);var texture=new Texture(baseTexture);return name||(name=imageUrl),canvas_mesh_BaseTexture.addToCache(texture.baseTexture,name),Texture.addToCache(texture,name),name!==imageUrl&&(canvas_mesh_BaseTexture.addToCache(texture.baseTexture,imageUrl),Texture.addToCache(texture,imageUrl)),texture.baseTexture.valid?Promise.resolve(texture):new Promise((function(resolve){texture.baseTexture.once("loaded",(function(){return resolve(texture)}))}))},Texture.addToCache=function(texture,id){id&&(-1===texture.textureCacheIds.indexOf(id)&&texture.textureCacheIds.push(id),canvas_mesh_TextureCache[id]&&console.warn("Texture added to the cache with an id ["+id+"] that already had an entry"),canvas_mesh_TextureCache[id]=texture)},Texture.removeFromCache=function(texture){if("string"==typeof texture){var textureFromCache=canvas_mesh_TextureCache[texture];if(textureFromCache){var index=textureFromCache.textureCacheIds.indexOf(texture);return index>-1&&textureFromCache.textureCacheIds.splice(index,1),delete canvas_mesh_TextureCache[texture],textureFromCache}}else if(texture&&texture.textureCacheIds){for(var i=0;i<texture.textureCacheIds.length;++i)canvas_mesh_TextureCache[texture.textureCacheIds[i]]===texture&&delete canvas_mesh_TextureCache[texture.textureCacheIds[i]];return texture.textureCacheIds.length=0,texture}return null},Object.defineProperty(Texture.prototype,"resolution",{get:function(){return this.baseTexture.resolution},enumerable:!1,configurable:!0}),Object.defineProperty(Texture.prototype,"frame",{get:function(){return this._frame},set:function(frame){this._frame=frame,this.noFrame=!1;var x=frame.x,y=frame.y,width=frame.width,height=frame.height,xNotFit=x+width>this.baseTexture.width,yNotFit=y+height>this.baseTexture.height;if(xNotFit||yNotFit){var relationship=xNotFit&&yNotFit?"and":"or",errorX="X: "+x+" + "+width+" = "+(x+width)+" > "+this.baseTexture.width,errorY="Y: "+y+" + "+height+" = "+(y+height)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+errorX+" "+relationship+" "+errorY)}this.valid=width&&height&&this.baseTexture.valid,this.trim||this.rotate||(this.orig=frame),this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(Texture.prototype,"rotate",{get:function(){return this._rotate},set:function(rotate){this._rotate=rotate,this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(Texture.prototype,"width",{get:function(){return this.orig.width},enumerable:!1,configurable:!0}),Object.defineProperty(Texture.prototype,"height",{get:function(){return this.orig.height},enumerable:!1,configurable:!0}),Texture.prototype.castToBaseTexture=function(){return this.baseTexture},Texture}(canvas_mesh_eventemitter3);function canvas_mesh_removeAllHandlers(tex){tex.destroy=function(){},tex.on=function(){},tex.once=function(){},tex.emit=function(){}}canvas_mesh_Texture.EMPTY=new canvas_mesh_Texture(new canvas_mesh_BaseTexture),canvas_mesh_removeAllHandlers(canvas_mesh_Texture.EMPTY),canvas_mesh_removeAllHandlers(canvas_mesh_Texture.EMPTY.baseTexture),canvas_mesh_Texture.WHITE=function(){var canvas=document.createElement("canvas");canvas.width=16,canvas.height=16;var context=canvas.getContext("2d");return context.fillStyle="white",context.fillRect(0,0,16,16),new canvas_mesh_Texture(new canvas_mesh_BaseTexture(new canvas_mesh_CanvasResource(canvas)))}(),canvas_mesh_removeAllHandlers(canvas_mesh_Texture.WHITE),canvas_mesh_removeAllHandlers(canvas_mesh_Texture.WHITE.baseTexture);var canvas_mesh_RenderTexture=function(_super){function RenderTexture(baseRenderTexture,frame){var _this=_super.call(this,baseRenderTexture,frame)||this;return _this.valid=!0,_this.filterFrame=null,_this.filterPoolKey=null,_this.updateUvs(),_this}return canvas_mesh_extends(RenderTexture,_super),Object.defineProperty(RenderTexture.prototype,"framebuffer",{get:function(){return this.baseTexture.framebuffer},enumerable:!1,configurable:!0}),Object.defineProperty(RenderTexture.prototype,"multisample",{get:function(){return this.framebuffer.multisample},set:function(value){this.framebuffer.multisample=value},enumerable:!1,configurable:!0}),RenderTexture.prototype.resize=function(desiredWidth,desiredHeight,resizeBaseTexture){void 0===resizeBaseTexture&&(resizeBaseTexture=!0);var resolution=this.baseTexture.resolution,width=Math.round(desiredWidth*resolution)/resolution,height=Math.round(desiredHeight*resolution)/resolution;this.valid=width>0&&height>0,this._frame.width=this.orig.width=width,this._frame.height=this.orig.height=height,resizeBaseTexture&&this.baseTexture.resize(width,height),this.updateUvs()},RenderTexture.prototype.setResolution=function(resolution){var baseTexture=this.baseTexture;baseTexture.resolution!==resolution&&(baseTexture.setResolution(resolution),this.resize(baseTexture.width,baseTexture.height,!1))},RenderTexture.create=function(options){for(var arguments$1=arguments,rest=[],_i=1;_i<arguments.length;_i++)rest[_i-1]=arguments$1[_i];return"number"==typeof options&&(canvas_mesh_deprecation("6.0.0","Arguments (width, height, scaleMode, resolution) have been deprecated."),options={width:options,height:rest[0],scaleMode:rest[1],resolution:rest[2]}),new RenderTexture(new canvas_mesh_BaseRenderTexture(options))},RenderTexture}(canvas_mesh_Texture),canvas_mesh_RenderTexturePool=function(){function RenderTexturePool(textureOptions){this.texturePool={},this.textureOptions=textureOptions||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}return RenderTexturePool.prototype.createTexture=function(realWidth,realHeight,multisample){void 0===multisample&&(multisample=constants_MSAA_QUALITY.NONE);var baseRenderTexture=new canvas_mesh_BaseRenderTexture(Object.assign({width:realWidth,height:realHeight,resolution:1,multisample},this.textureOptions));return new canvas_mesh_RenderTexture(baseRenderTexture)},RenderTexturePool.prototype.getOptimalTexture=function(minWidth,minHeight,resolution,multisample){var key;void 0===resolution&&(resolution=1),void 0===multisample&&(multisample=constants_MSAA_QUALITY.NONE),minWidth=Math.ceil(minWidth*resolution-1e-6),minHeight=Math.ceil(minHeight*resolution-1e-6),this.enableFullScreen&&minWidth===this._pixelsWidth&&minHeight===this._pixelsHeight?key=multisample>1?-multisample:-1:(key=((65535&(minWidth=canvas_mesh_nextPow2(minWidth)))<<16|65535&(minHeight=canvas_mesh_nextPow2(minHeight)))>>>0,multisample>1&&(key+=4294967296*multisample)),this.texturePool[key]||(this.texturePool[key]=[]);var renderTexture=this.texturePool[key].pop();return renderTexture||(renderTexture=this.createTexture(minWidth,minHeight,multisample)),renderTexture.filterPoolKey=key,renderTexture.setResolution(resolution),renderTexture},RenderTexturePool.prototype.getFilterTexture=function(input,resolution,multisample){var filterTexture=this.getOptimalTexture(input.width,input.height,resolution||input.resolution,multisample||constants_MSAA_QUALITY.NONE);return filterTexture.filterFrame=input.filterFrame,filterTexture},RenderTexturePool.prototype.returnTexture=function(renderTexture){var key=renderTexture.filterPoolKey;renderTexture.filterFrame=null,this.texturePool[key].push(renderTexture)},RenderTexturePool.prototype.returnFilterTexture=function(renderTexture){this.returnTexture(renderTexture)},RenderTexturePool.prototype.clear=function(destroyTextures){if(destroyTextures=!1!==destroyTextures)for(var i in this.texturePool){var textures=this.texturePool[i];if(textures)for(var j=0;j<textures.length;j++)textures[j].destroy(!0)}this.texturePool={}},RenderTexturePool.prototype.setScreenSize=function(size){if(size.width!==this._pixelsWidth||size.height!==this._pixelsHeight){for(var i in this.enableFullScreen=size.width>0&&size.height>0,this.texturePool)if(Number(i)<0){var textures=this.texturePool[i];if(textures)for(var j=0;j<textures.length;j++)textures[j].destroy(!0);this.texturePool[i]=[]}this._pixelsWidth=size.width,this._pixelsHeight=size.height}},RenderTexturePool.SCREEN_KEY=-1,RenderTexturePool}(),canvas_mesh_Attribute=function(){function Attribute(buffer,size,normalized,type,stride,start,instance){void 0===size&&(size=0),void 0===normalized&&(normalized=!1),void 0===type&&(type=constants_TYPES.FLOAT),this.buffer=buffer,this.size=size,this.normalized=normalized,this.type=type,this.stride=stride,this.start=start,this.instance=instance}return Attribute.prototype.destroy=function(){this.buffer=null},Attribute.from=function(buffer,size,normalized,type,stride){return new Attribute(buffer,size,normalized,type,stride)},Attribute}(),canvas_mesh_UID=0,canvas_mesh_Buffer=function(){function Buffer(data,_static,index){void 0===_static&&(_static=!0),void 0===index&&(index=!1),this.data=data||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=index,this.static=_static,this.id=canvas_mesh_UID++,this.disposeRunner=new canvas_mesh_Runner("disposeBuffer")}return Buffer.prototype.update=function(data){data instanceof Array&&(data=new Float32Array(data)),this.data=data||this.data,this._updateID++},Buffer.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},Buffer.prototype.destroy=function(){this.dispose(),this.data=null},Object.defineProperty(Buffer.prototype,"index",{get:function(){return this.type===constants_BUFFER_TYPE.ELEMENT_ARRAY_BUFFER},set:function(value){this.type=value?constants_BUFFER_TYPE.ELEMENT_ARRAY_BUFFER:constants_BUFFER_TYPE.ARRAY_BUFFER},enumerable:!1,configurable:!0}),Buffer.from=function(data){return data instanceof Array&&(data=new Float32Array(data)),new Buffer(data)},Buffer}(),canvas_mesh_map={Float32Array,Uint32Array,Int32Array,Uint8Array};var canvas_mesh_byteSizeMap={5126:4,5123:2,5121:1},canvas_mesh_UID$1=0,canvas_mesh_map$1={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array},canvas_mesh_Geometry=function(){function Geometry(buffers,attributes){void 0===buffers&&(buffers=[]),void 0===attributes&&(attributes={}),this.buffers=buffers,this.indexBuffer=null,this.attributes=attributes,this.glVertexArrayObjects={},this.id=canvas_mesh_UID$1++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new canvas_mesh_Runner("disposeGeometry"),this.refCount=0}return Geometry.prototype.addAttribute=function(id,buffer,size,normalized,type,stride,start,instance){if(void 0===size&&(size=0),void 0===normalized&&(normalized=!1),void 0===instance&&(instance=!1),!buffer)throw new Error("You must pass a buffer when creating an attribute");buffer instanceof canvas_mesh_Buffer||(buffer instanceof Array&&(buffer=new Float32Array(buffer)),buffer=new canvas_mesh_Buffer(buffer));var ids=id.split("|");if(ids.length>1){for(var i=0;i<ids.length;i++)this.addAttribute(ids[i],buffer,size,normalized,type);return this}var bufferIndex=this.buffers.indexOf(buffer);return-1===bufferIndex&&(this.buffers.push(buffer),bufferIndex=this.buffers.length-1),this.attributes[id]=new canvas_mesh_Attribute(bufferIndex,size,normalized,type,stride,start,instance),this.instanced=this.instanced||instance,this},Geometry.prototype.getAttribute=function(id){return this.attributes[id]},Geometry.prototype.getBuffer=function(id){return this.buffers[this.getAttribute(id).buffer]},Geometry.prototype.addIndex=function(buffer){return buffer instanceof canvas_mesh_Buffer||(buffer instanceof Array&&(buffer=new Uint16Array(buffer)),buffer=new canvas_mesh_Buffer(buffer)),buffer.type=constants_BUFFER_TYPE.ELEMENT_ARRAY_BUFFER,this.indexBuffer=buffer,-1===this.buffers.indexOf(buffer)&&this.buffers.push(buffer),this},Geometry.prototype.getIndex=function(){return this.indexBuffer},Geometry.prototype.interleave=function(){if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;var i,arrays=[],sizes=[],interleavedBuffer=new canvas_mesh_Buffer;for(i in this.attributes){var attribute=this.attributes[i],buffer=this.buffers[attribute.buffer];arrays.push(buffer.data),sizes.push(attribute.size*canvas_mesh_byteSizeMap[attribute.type]/4),attribute.buffer=0}for(interleavedBuffer.data=function(arrays,sizes){for(var outSize=0,stride=0,views={},i=0;i<arrays.length;i++)stride+=sizes[i],outSize+=arrays[i].length;var buffer=new ArrayBuffer(4*outSize),out=null,littleOffset=0;for(i=0;i<arrays.length;i++){var size=sizes[i],array=arrays[i],type=canvas_mesh_getBufferType(array);views[type]||(views[type]=new canvas_mesh_map[type](buffer)),out=views[type];for(var j=0;j<array.length;j++)out[(j/size|0)*stride+littleOffset+j%size]=array[j];littleOffset+=size}return new Float32Array(buffer)}(arrays,sizes),i=0;i<this.buffers.length;i++)this.buffers[i]!==this.indexBuffer&&this.buffers[i].destroy();return this.buffers=[interleavedBuffer],this.indexBuffer&&this.buffers.push(this.indexBuffer),this},Geometry.prototype.getSize=function(){for(var i in this.attributes){var attribute=this.attributes[i];return this.buffers[attribute.buffer].data.length/(attribute.stride/4||attribute.size)}return 0},Geometry.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},Geometry.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null},Geometry.prototype.clone=function(){for(var geometry=new Geometry,i=0;i<this.buffers.length;i++)geometry.buffers[i]=new canvas_mesh_Buffer(this.buffers[i].data.slice(0));for(var i in this.attributes){var attrib=this.attributes[i];geometry.attributes[i]=new canvas_mesh_Attribute(attrib.buffer,attrib.size,attrib.normalized,attrib.type,attrib.stride,attrib.start,attrib.instance)}return this.indexBuffer&&(geometry.indexBuffer=geometry.buffers[this.buffers.indexOf(this.indexBuffer)],geometry.indexBuffer.type=constants_BUFFER_TYPE.ELEMENT_ARRAY_BUFFER),geometry},Geometry.merge=function(geometries){for(var geometry,geometryOut=new Geometry,arrays=[],sizes=[],offsets=[],i=0;i<geometries.length;i++){geometry=geometries[i];for(var j=0;j<geometry.buffers.length;j++)sizes[j]=sizes[j]||0,sizes[j]+=geometry.buffers[j].data.length,offsets[j]=0}for(i=0;i<geometry.buffers.length;i++)arrays[i]=new(canvas_mesh_map$1[canvas_mesh_getBufferType(geometry.buffers[i].data)])(sizes[i]),geometryOut.buffers[i]=new canvas_mesh_Buffer(arrays[i]);for(i=0;i<geometries.length;i++){geometry=geometries[i];for(j=0;j<geometry.buffers.length;j++)arrays[j].set(geometry.buffers[j].data,offsets[j]),offsets[j]+=geometry.buffers[j].data.length}if(geometryOut.attributes=geometry.attributes,geometry.indexBuffer){geometryOut.indexBuffer=geometryOut.buffers[geometry.buffers.indexOf(geometry.indexBuffer)],geometryOut.indexBuffer.type=constants_BUFFER_TYPE.ELEMENT_ARRAY_BUFFER;var offset=0,stride=0,offset2=0,bufferIndexToCount=0;for(i=0;i<geometry.buffers.length;i++)if(geometry.buffers[i]!==geometry.indexBuffer){bufferIndexToCount=i;break}for(var i in geometry.attributes){var attribute=geometry.attributes[i];(0|attribute.buffer)===bufferIndexToCount&&(stride+=attribute.size*canvas_mesh_byteSizeMap[attribute.type]/4)}for(i=0;i<geometries.length;i++){var indexBufferData=geometries[i].indexBuffer.data;for(j=0;j<indexBufferData.length;j++)geometryOut.indexBuffer.data[j+offset2]+=offset;offset+=geometries[i].buffers[bufferIndexToCount].data.length/stride,offset2+=indexBufferData.length}}return geometryOut},Geometry}(),canvas_mesh_Quad=function(_super){function Quad(){var _this=_super.call(this)||this;return _this.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2]),_this}return canvas_mesh_extends(Quad,_super),Quad}(canvas_mesh_Geometry),canvas_mesh_QuadUv=function(_super){function QuadUv(){var _this=_super.call(this)||this;return _this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),_this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),_this.vertexBuffer=new canvas_mesh_Buffer(_this.vertices),_this.uvBuffer=new canvas_mesh_Buffer(_this.uvs),_this.addAttribute("aVertexPosition",_this.vertexBuffer).addAttribute("aTextureCoord",_this.uvBuffer).addIndex([0,1,2,0,2,3]),_this}return canvas_mesh_extends(QuadUv,_super),QuadUv.prototype.map=function(targetTextureFrame,destinationFrame){var x=0,y=0;return this.uvs[0]=x,this.uvs[1]=y,this.uvs[2]=x+destinationFrame.width/targetTextureFrame.width,this.uvs[3]=y,this.uvs[4]=x+destinationFrame.width/targetTextureFrame.width,this.uvs[5]=y+destinationFrame.height/targetTextureFrame.height,this.uvs[6]=x,this.uvs[7]=y+destinationFrame.height/targetTextureFrame.height,x=destinationFrame.x,y=destinationFrame.y,this.vertices[0]=x,this.vertices[1]=y,this.vertices[2]=x+destinationFrame.width,this.vertices[3]=y,this.vertices[4]=x+destinationFrame.width,this.vertices[5]=y+destinationFrame.height,this.vertices[6]=x,this.vertices[7]=y+destinationFrame.height,this.invalidate(),this},QuadUv.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},QuadUv}(canvas_mesh_Geometry),canvas_mesh_UID$2=0,canvas_mesh_UniformGroup=function(){function UniformGroup(uniforms,isStatic,isUbo){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=canvas_mesh_UID$2++,this.static=!!isStatic,this.ubo=!!isUbo,uniforms instanceof canvas_mesh_Buffer?(this.buffer=uniforms,this.buffer.type=constants_BUFFER_TYPE.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=uniforms,this.ubo&&(this.buffer=new canvas_mesh_Buffer(new Float32Array(1)),this.buffer.type=constants_BUFFER_TYPE.UNIFORM_BUFFER,this.autoManage=!0))}return UniformGroup.prototype.update=function(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()},UniformGroup.prototype.add=function(name,uniforms,_static){if(this.ubo)throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them");this.uniforms[name]=new UniformGroup(uniforms,_static)},UniformGroup.from=function(uniforms,_static,_ubo){return new UniformGroup(uniforms,_static,_ubo)},UniformGroup.uboFrom=function(uniforms,_static){return new UniformGroup(uniforms,null==_static||_static,!0)},UniformGroup}(),canvas_mesh_FilterState=function(){function FilterState(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=constants_MSAA_QUALITY.NONE,this.sourceFrame=new canvas_mesh_Rectangle,this.destinationFrame=new canvas_mesh_Rectangle,this.bindingSourceFrame=new canvas_mesh_Rectangle,this.bindingDestinationFrame=new canvas_mesh_Rectangle,this.filters=[],this.transform=null}return FilterState.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null},FilterState}(),tempPoints$1=[new canvas_mesh_Point,new canvas_mesh_Point,new canvas_mesh_Point,new canvas_mesh_Point],canvas_mesh_tempMatrix=new canvas_mesh_Matrix,canvas_mesh_FilterSystem=function(){function FilterSystem(renderer){this.renderer=renderer,this.defaultFilterStack=[{}],this.texturePool=new canvas_mesh_RenderTexturePool,this.texturePool.setScreenSize(renderer.view),this.statePool=[],this.quad=new canvas_mesh_Quad,this.quadUv=new canvas_mesh_QuadUv,this.tempRect=new canvas_mesh_Rectangle,this.activeState={},this.globalUniforms=new canvas_mesh_UniformGroup({outputFrame:new canvas_mesh_Rectangle,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}return FilterSystem.prototype.push=function(target,filters){for(var _a,_b,renderer=this.renderer,filterStack=this.defaultFilterStack,state=this.statePool.pop()||new canvas_mesh_FilterState,renderTextureSystem=this.renderer.renderTexture,resolution=filters[0].resolution,multisample=filters[0].multisample,padding=filters[0].padding,autoFit=filters[0].autoFit,legacy=null===(_a=filters[0].legacy)||void 0===_a||_a,i=1;i<filters.length;i++){var filter=filters[i];resolution=Math.min(resolution,filter.resolution),multisample=Math.min(multisample,filter.multisample),padding=this.useMaxPadding?Math.max(padding,filter.padding):padding+filter.padding,autoFit=autoFit&&filter.autoFit,legacy=legacy||null===(_b=filter.legacy)||void 0===_b||_b}if(1===filterStack.length&&(this.defaultFilterStack[0].renderTexture=renderTextureSystem.current),filterStack.push(state),state.resolution=resolution,state.multisample=multisample,state.legacy=legacy,state.target=target,state.sourceFrame.copyFrom(target.filterArea||target.getBounds(!0)),state.sourceFrame.pad(padding),autoFit){var sourceFrameProjected=this.tempRect.copyFrom(renderTextureSystem.sourceFrame);renderer.projection.transform&&this.transformAABB(canvas_mesh_tempMatrix.copyFrom(renderer.projection.transform).invert(),sourceFrameProjected),state.sourceFrame.fit(sourceFrameProjected)}this.roundFrame(state.sourceFrame,renderTextureSystem.current?renderTextureSystem.current.resolution:renderer.resolution,renderTextureSystem.sourceFrame,renderTextureSystem.destinationFrame,renderer.projection.transform),state.renderTexture=this.getOptimalFilterTexture(state.sourceFrame.width,state.sourceFrame.height,resolution,multisample),state.filters=filters,state.destinationFrame.width=state.renderTexture.width,state.destinationFrame.height=state.renderTexture.height;var destinationFrame=this.tempRect;destinationFrame.x=0,destinationFrame.y=0,destinationFrame.width=state.sourceFrame.width,destinationFrame.height=state.sourceFrame.height,state.renderTexture.filterFrame=state.sourceFrame,state.bindingSourceFrame.copyFrom(renderTextureSystem.sourceFrame),state.bindingDestinationFrame.copyFrom(renderTextureSystem.destinationFrame),state.transform=renderer.projection.transform,renderer.projection.transform=null,renderTextureSystem.bind(state.renderTexture,state.sourceFrame,destinationFrame),renderer.framebuffer.clear(0,0,0,0)},FilterSystem.prototype.pop=function(){var filterStack=this.defaultFilterStack,state=filterStack.pop(),filters=state.filters;this.activeState=state;var globalUniforms=this.globalUniforms.uniforms;globalUniforms.outputFrame=state.sourceFrame,globalUniforms.resolution=state.resolution;var inputSize=globalUniforms.inputSize,inputPixel=globalUniforms.inputPixel,inputClamp=globalUniforms.inputClamp;if(inputSize[0]=state.destinationFrame.width,inputSize[1]=state.destinationFrame.height,inputSize[2]=1/inputSize[0],inputSize[3]=1/inputSize[1],inputPixel[0]=Math.round(inputSize[0]*state.resolution),inputPixel[1]=Math.round(inputSize[1]*state.resolution),inputPixel[2]=1/inputPixel[0],inputPixel[3]=1/inputPixel[1],inputClamp[0]=.5*inputPixel[2],inputClamp[1]=.5*inputPixel[3],inputClamp[2]=state.sourceFrame.width*inputSize[2]-.5*inputPixel[2],inputClamp[3]=state.sourceFrame.height*inputSize[3]-.5*inputPixel[3],state.legacy){var filterArea=globalUniforms.filterArea;filterArea[0]=state.destinationFrame.width,filterArea[1]=state.destinationFrame.height,filterArea[2]=state.sourceFrame.x,filterArea[3]=state.sourceFrame.y,globalUniforms.filterClamp=globalUniforms.inputClamp}this.globalUniforms.update();var lastState=filterStack[filterStack.length-1];if(this.renderer.framebuffer.blit(),1===filters.length)filters[0].apply(this,state.renderTexture,lastState.renderTexture,constants_CLEAR_MODES.BLEND,state),this.returnFilterTexture(state.renderTexture);else{var flip=state.renderTexture,flop=this.getOptimalFilterTexture(flip.width,flip.height,state.resolution);flop.filterFrame=flip.filterFrame;var i=0;for(i=0;i<filters.length-1;++i){1===i&&state.multisample>1&&((flop=this.getOptimalFilterTexture(flip.width,flip.height,state.resolution)).filterFrame=flip.filterFrame),filters[i].apply(this,flip,flop,constants_CLEAR_MODES.CLEAR,state);var t=flip;flip=flop,flop=t}filters[i].apply(this,flip,lastState.renderTexture,constants_CLEAR_MODES.BLEND,state),i>1&&state.multisample>1&&this.returnFilterTexture(state.renderTexture),this.returnFilterTexture(flip),this.returnFilterTexture(flop)}state.clear(),this.statePool.push(state)},FilterSystem.prototype.bindAndClear=function(filterTexture,clearMode){void 0===clearMode&&(clearMode=constants_CLEAR_MODES.CLEAR);var _a=this.renderer,renderTextureSystem=_a.renderTexture,stateSystem=_a.state;if(filterTexture===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,filterTexture&&filterTexture.filterFrame){var destinationFrame=this.tempRect;destinationFrame.x=0,destinationFrame.y=0,destinationFrame.width=filterTexture.filterFrame.width,destinationFrame.height=filterTexture.filterFrame.height,renderTextureSystem.bind(filterTexture,filterTexture.filterFrame,destinationFrame)}else filterTexture!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?renderTextureSystem.bind(filterTexture):this.renderer.renderTexture.bind(filterTexture,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);var autoClear=1&stateSystem.stateId||this.forceClear;(clearMode===constants_CLEAR_MODES.CLEAR||clearMode===constants_CLEAR_MODES.BLIT&&autoClear)&&this.renderer.framebuffer.clear(0,0,0,0)},FilterSystem.prototype.applyFilter=function(filter,input,output,clearMode){var renderer=this.renderer;renderer.state.set(filter.state),this.bindAndClear(output,clearMode),filter.uniforms.uSampler=input,filter.uniforms.filterGlobals=this.globalUniforms,renderer.shader.bind(filter),filter.legacy=!!filter.program.attributeData.aTextureCoord,filter.legacy?(this.quadUv.map(input._frame,input.filterFrame),renderer.geometry.bind(this.quadUv),renderer.geometry.draw(constants_DRAW_MODES.TRIANGLES)):(renderer.geometry.bind(this.quad),renderer.geometry.draw(constants_DRAW_MODES.TRIANGLE_STRIP))},FilterSystem.prototype.calculateSpriteMatrix=function(outputMatrix,sprite){var _a=this.activeState,sourceFrame=_a.sourceFrame,destinationFrame=_a.destinationFrame,orig=sprite._texture.orig,mappedMatrix=outputMatrix.set(destinationFrame.width,0,0,destinationFrame.height,sourceFrame.x,sourceFrame.y),worldTransform=sprite.worldTransform.copyTo(canvas_mesh_Matrix.TEMP_MATRIX);return worldTransform.invert(),mappedMatrix.prepend(worldTransform),mappedMatrix.scale(1/orig.width,1/orig.height),mappedMatrix.translate(sprite.anchor.x,sprite.anchor.y),mappedMatrix},FilterSystem.prototype.destroy=function(){this.renderer=null,this.texturePool.clear(!1)},FilterSystem.prototype.getOptimalFilterTexture=function(minWidth,minHeight,resolution,multisample){return void 0===resolution&&(resolution=1),void 0===multisample&&(multisample=constants_MSAA_QUALITY.NONE),this.texturePool.getOptimalTexture(minWidth,minHeight,resolution,multisample)},FilterSystem.prototype.getFilterTexture=function(input,resolution,multisample){if("number"==typeof input){var swap=input;input=resolution,resolution=swap}input=input||this.activeState.renderTexture;var filterTexture=this.texturePool.getOptimalTexture(input.width,input.height,resolution||input.resolution,multisample||constants_MSAA_QUALITY.NONE);return filterTexture.filterFrame=input.filterFrame,filterTexture},FilterSystem.prototype.returnFilterTexture=function(renderTexture){this.texturePool.returnTexture(renderTexture)},FilterSystem.prototype.emptyPool=function(){this.texturePool.clear(!0)},FilterSystem.prototype.resize=function(){this.texturePool.setScreenSize(this.renderer.view)},FilterSystem.prototype.transformAABB=function(matrix,rect){var lt=tempPoints$1[0],lb=tempPoints$1[1],rt=tempPoints$1[2],rb=tempPoints$1[3];lt.set(rect.left,rect.top),lb.set(rect.left,rect.bottom),rt.set(rect.right,rect.top),rb.set(rect.right,rect.bottom),matrix.apply(lt,lt),matrix.apply(lb,lb),matrix.apply(rt,rt),matrix.apply(rb,rb);var x0=Math.min(lt.x,lb.x,rt.x,rb.x),y0=Math.min(lt.y,lb.y,rt.y,rb.y),x1=Math.max(lt.x,lb.x,rt.x,rb.x),y1=Math.max(lt.y,lb.y,rt.y,rb.y);rect.x=x0,rect.y=y0,rect.width=x1-x0,rect.height=y1-y0},FilterSystem.prototype.roundFrame=function(frame,resolution,bindingSourceFrame,bindingDestinationFrame,transform){if(!(frame.width<=0||frame.height<=0||bindingSourceFrame.width<=0||bindingSourceFrame.height<=0)){if(transform){var a=transform.a,b=transform.b,c=transform.c,d=transform.d;if((Math.abs(b)>1e-4||Math.abs(c)>1e-4)&&(Math.abs(a)>1e-4||Math.abs(d)>1e-4))return}(transform=transform?canvas_mesh_tempMatrix.copyFrom(transform):canvas_mesh_tempMatrix.identity()).translate(-bindingSourceFrame.x,-bindingSourceFrame.y).scale(bindingDestinationFrame.width/bindingSourceFrame.width,bindingDestinationFrame.height/bindingSourceFrame.height).translate(bindingDestinationFrame.x,bindingDestinationFrame.y),this.transformAABB(transform,frame),frame.ceil(resolution),this.transformAABB(transform.invert(),frame)}},FilterSystem}(),canvas_mesh_ObjectRenderer=function(){function ObjectRenderer(renderer){this.renderer=renderer}return ObjectRenderer.prototype.flush=function(){},ObjectRenderer.prototype.destroy=function(){this.renderer=null},ObjectRenderer.prototype.start=function(){},ObjectRenderer.prototype.stop=function(){this.flush()},ObjectRenderer.prototype.render=function(_object){},ObjectRenderer}(),canvas_mesh_BatchSystem=function(){function BatchSystem(renderer){this.renderer=renderer,this.emptyRenderer=new canvas_mesh_ObjectRenderer(renderer),this.currentRenderer=this.emptyRenderer}return BatchSystem.prototype.setObjectRenderer=function(objectRenderer){this.currentRenderer!==objectRenderer&&(this.currentRenderer.stop(),this.currentRenderer=objectRenderer,this.currentRenderer.start())},BatchSystem.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},BatchSystem.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},BatchSystem.prototype.copyBoundTextures=function(arr,maxTextures){for(var boundTextures=this.renderer.texture.boundTextures,i=maxTextures-1;i>=0;--i)arr[i]=boundTextures[i]||null,arr[i]&&(arr[i]._batchLocation=i)},BatchSystem.prototype.boundArray=function(texArray,boundTextures,batchId,maxTextures){for(var elements=texArray.elements,ids=texArray.ids,count=texArray.count,j=0,i=0;i<count;i++){var tex=elements[i],loc=tex._batchLocation;if(loc>=0&&loc<maxTextures&&boundTextures[loc]===tex)ids[i]=loc;else for(;j<maxTextures;){var bound=boundTextures[j];if(!bound||bound._batchEnabled!==batchId||bound._batchLocation!==j){ids[i]=j,tex._batchLocation=j,boundTextures[j]=tex;break}j++}}},BatchSystem.prototype.destroy=function(){this.renderer=null},BatchSystem}(),canvas_mesh_CONTEXT_UID_COUNTER=0,canvas_mesh_ContextSystem=function(){function ContextSystem(renderer){this.renderer=renderer,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this),renderer.view.addEventListener("webglcontextlost",this.handleContextLost,!1),renderer.view.addEventListener("webglcontextrestored",this.handleContextRestored,!1)}return Object.defineProperty(ContextSystem.prototype,"isLost",{get:function(){return!this.gl||this.gl.isContextLost()},enumerable:!1,configurable:!0}),ContextSystem.prototype.contextChange=function(gl){this.gl=gl,this.renderer.gl=gl,this.renderer.CONTEXT_UID=canvas_mesh_CONTEXT_UID_COUNTER++,gl.isContextLost()&&gl.getExtension("WEBGL_lose_context")&&gl.getExtension("WEBGL_lose_context").restoreContext()},ContextSystem.prototype.initFromContext=function(gl){this.gl=gl,this.validateContext(gl),this.renderer.gl=gl,this.renderer.CONTEXT_UID=canvas_mesh_CONTEXT_UID_COUNTER++,this.renderer.runners.contextChange.emit(gl)},ContextSystem.prototype.initFromOptions=function(options){var gl=this.createContext(this.renderer.view,options);this.initFromContext(gl)},ContextSystem.prototype.createContext=function(canvas,options){var gl;if(settings.PREFER_ENV>=constants_ENV.WEBGL2&&(gl=canvas.getContext("webgl2",options)),gl)this.webGLVersion=2;else if(this.webGLVersion=1,!(gl=canvas.getContext("webgl",options)||canvas.getContext("experimental-webgl",options)))throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=gl,this.getExtensions(),this.gl},ContextSystem.prototype.getExtensions=function(){var gl=this.gl,common={anisotropicFiltering:gl.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:gl.getExtension("OES_texture_float_linear"),s3tc:gl.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:gl.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:gl.getExtension("WEBGL_compressed_texture_etc"),etc1:gl.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:gl.getExtension("WEBGL_compressed_texture_pvrtc")||gl.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:gl.getExtension("WEBGL_compressed_texture_atc"),astc:gl.getExtension("WEBGL_compressed_texture_astc")};1===this.webGLVersion?Object.assign(this.extensions,common,{drawBuffers:gl.getExtension("WEBGL_draw_buffers"),depthTexture:gl.getExtension("WEBGL_depth_texture"),loseContext:gl.getExtension("WEBGL_lose_context"),vertexArrayObject:gl.getExtension("OES_vertex_array_object")||gl.getExtension("MOZ_OES_vertex_array_object")||gl.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:gl.getExtension("OES_element_index_uint"),floatTexture:gl.getExtension("OES_texture_float"),floatTextureLinear:gl.getExtension("OES_texture_float_linear"),textureHalfFloat:gl.getExtension("OES_texture_half_float"),textureHalfFloatLinear:gl.getExtension("OES_texture_half_float_linear")}):2===this.webGLVersion&&Object.assign(this.extensions,common,{colorBufferFloat:gl.getExtension("EXT_color_buffer_float")})},ContextSystem.prototype.handleContextLost=function(event){event.preventDefault()},ContextSystem.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.emit(this.gl)},ContextSystem.prototype.destroy=function(){var view=this.renderer.view;this.renderer=null,view.removeEventListener("webglcontextlost",this.handleContextLost),view.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},ContextSystem.prototype.postrender=function(){this.renderer.renderingToScreen&&this.gl.flush()},ContextSystem.prototype.validateContext=function(gl){var attributes=gl.getContextAttributes(),isWebGl2="WebGL2RenderingContext"in globalThis&&gl instanceof globalThis.WebGL2RenderingContext;isWebGl2&&(this.webGLVersion=2),attributes.stencil||console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");var hasuint32=isWebGl2||!!gl.getExtension("OES_element_index_uint");this.supports.uint32Indices=hasuint32,hasuint32||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")},ContextSystem}(),canvas_mesh_GLFramebuffer=function(framebuffer){this.framebuffer=framebuffer,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=constants_MSAA_QUALITY.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0},canvas_mesh_tempRectangle=new canvas_mesh_Rectangle,canvas_mesh_FramebufferSystem=function(){function FramebufferSystem(renderer){this.renderer=renderer,this.managedFramebuffers=[],this.unknownFramebuffer=new canvas_mesh_Framebuffer(10,10),this.msaaSamples=null}return FramebufferSystem.prototype.contextChange=function(){var gl=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new canvas_mesh_Rectangle,this.hasMRT=!0,this.writeDepthTexture=!0,this.disposeAll(!0),1===this.renderer.context.webGLVersion){var nativeDrawBuffersExtension_1=this.renderer.context.extensions.drawBuffers,nativeDepthTextureExtension=this.renderer.context.extensions.depthTexture;settings.PREFER_ENV===constants_ENV.WEBGL_LEGACY&&(nativeDrawBuffersExtension_1=null,nativeDepthTextureExtension=null),nativeDrawBuffersExtension_1?gl.drawBuffers=function(activeTextures){return nativeDrawBuffersExtension_1.drawBuffersWEBGL(activeTextures)}:(this.hasMRT=!1,gl.drawBuffers=function(){}),nativeDepthTextureExtension||(this.writeDepthTexture=!1)}else this.msaaSamples=gl.getInternalformatParameter(gl.RENDERBUFFER,gl.RGBA8,gl.SAMPLES)},FramebufferSystem.prototype.bind=function(framebuffer,frame,mipLevel){void 0===mipLevel&&(mipLevel=0);var gl=this.gl;if(framebuffer){var fbo=framebuffer.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(framebuffer);this.current!==framebuffer&&(this.current=framebuffer,gl.bindFramebuffer(gl.FRAMEBUFFER,fbo.framebuffer)),fbo.mipLevel!==mipLevel&&(framebuffer.dirtyId++,framebuffer.dirtyFormat++,fbo.mipLevel=mipLevel),fbo.dirtyId!==framebuffer.dirtyId&&(fbo.dirtyId=framebuffer.dirtyId,fbo.dirtyFormat!==framebuffer.dirtyFormat?(fbo.dirtyFormat=framebuffer.dirtyFormat,fbo.dirtySize=framebuffer.dirtySize,this.updateFramebuffer(framebuffer,mipLevel)):fbo.dirtySize!==framebuffer.dirtySize&&(fbo.dirtySize=framebuffer.dirtySize,this.resizeFramebuffer(framebuffer)));for(var i=0;i<framebuffer.colorTextures.length;i++){var tex=framebuffer.colorTextures[i];this.renderer.texture.unbind(tex.parentTextureArray||tex)}if(framebuffer.depthTexture&&this.renderer.texture.unbind(framebuffer.depthTexture),frame){var mipWidth=frame.width>>mipLevel,mipHeight=frame.height>>mipLevel,scale=mipWidth/frame.width;this.setViewport(frame.x*scale,frame.y*scale,mipWidth,mipHeight)}else{mipWidth=framebuffer.width>>mipLevel,mipHeight=framebuffer.height>>mipLevel;this.setViewport(0,0,mipWidth,mipHeight)}}else this.current&&(this.current=null,gl.bindFramebuffer(gl.FRAMEBUFFER,null)),frame?this.setViewport(frame.x,frame.y,frame.width,frame.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},FramebufferSystem.prototype.setViewport=function(x,y,width,height){var v=this.viewport;x=Math.round(x),y=Math.round(y),width=Math.round(width),height=Math.round(height),v.width===width&&v.height===height&&v.x===x&&v.y===y||(v.x=x,v.y=y,v.width=width,v.height=height,this.gl.viewport(x,y,width,height))},Object.defineProperty(FramebufferSystem.prototype,"size",{get:function(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},enumerable:!1,configurable:!0}),FramebufferSystem.prototype.clear=function(r,g,b,a,mask){void 0===mask&&(mask=constants_BUFFER_BITS.COLOR|constants_BUFFER_BITS.DEPTH);var gl=this.gl;gl.clearColor(r,g,b,a),gl.clear(mask)},FramebufferSystem.prototype.initFramebuffer=function(framebuffer){var gl=this.gl,fbo=new canvas_mesh_GLFramebuffer(gl.createFramebuffer());return fbo.multisample=this.detectSamples(framebuffer.multisample),framebuffer.glFramebuffers[this.CONTEXT_UID]=fbo,this.managedFramebuffers.push(framebuffer),framebuffer.disposeRunner.add(this),fbo},FramebufferSystem.prototype.resizeFramebuffer=function(framebuffer){var gl=this.gl,fbo=framebuffer.glFramebuffers[this.CONTEXT_UID];fbo.msaaBuffer&&(gl.bindRenderbuffer(gl.RENDERBUFFER,fbo.msaaBuffer),gl.renderbufferStorageMultisample(gl.RENDERBUFFER,fbo.multisample,gl.RGBA8,framebuffer.width,framebuffer.height)),fbo.stencil&&(gl.bindRenderbuffer(gl.RENDERBUFFER,fbo.stencil),fbo.msaaBuffer?gl.renderbufferStorageMultisample(gl.RENDERBUFFER,fbo.multisample,gl.DEPTH24_STENCIL8,framebuffer.width,framebuffer.height):gl.renderbufferStorage(gl.RENDERBUFFER,gl.DEPTH_STENCIL,framebuffer.width,framebuffer.height));var colorTextures=framebuffer.colorTextures,count=colorTextures.length;gl.drawBuffers||(count=Math.min(count,1));for(var i=0;i<count;i++){var texture=colorTextures[i],parentTexture=texture.parentTextureArray||texture;this.renderer.texture.bind(parentTexture,0)}framebuffer.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(framebuffer.depthTexture,0)},FramebufferSystem.prototype.updateFramebuffer=function(framebuffer,mipLevel){var gl=this.gl,fbo=framebuffer.glFramebuffers[this.CONTEXT_UID],colorTextures=framebuffer.colorTextures,count=colorTextures.length;gl.drawBuffers||(count=Math.min(count,1)),fbo.multisample>1&&this.canMultisampleFramebuffer(framebuffer)?(fbo.msaaBuffer=fbo.msaaBuffer||gl.createRenderbuffer(),gl.bindRenderbuffer(gl.RENDERBUFFER,fbo.msaaBuffer),gl.renderbufferStorageMultisample(gl.RENDERBUFFER,fbo.multisample,gl.RGBA8,framebuffer.width,framebuffer.height),gl.framebufferRenderbuffer(gl.FRAMEBUFFER,gl.COLOR_ATTACHMENT0,gl.RENDERBUFFER,fbo.msaaBuffer)):fbo.msaaBuffer&&(gl.deleteRenderbuffer(fbo.msaaBuffer),fbo.msaaBuffer=null,fbo.blitFramebuffer&&(fbo.blitFramebuffer.dispose(),fbo.blitFramebuffer=null));for(var activeTextures=[],i=0;i<count;i++){var texture=colorTextures[i],parentTexture=texture.parentTextureArray||texture;this.renderer.texture.bind(parentTexture,0),0===i&&fbo.msaaBuffer||(gl.framebufferTexture2D(gl.FRAMEBUFFER,gl.COLOR_ATTACHMENT0+i,texture.target,parentTexture._glTextures[this.CONTEXT_UID].texture,mipLevel),activeTextures.push(gl.COLOR_ATTACHMENT0+i))}if((activeTextures.length>1&&gl.drawBuffers(activeTextures),framebuffer.depthTexture)&&this.writeDepthTexture){var depthTexture=framebuffer.depthTexture;this.renderer.texture.bind(depthTexture,0),gl.framebufferTexture2D(gl.FRAMEBUFFER,gl.DEPTH_ATTACHMENT,gl.TEXTURE_2D,depthTexture._glTextures[this.CONTEXT_UID].texture,mipLevel)}!framebuffer.stencil&&!framebuffer.depth||framebuffer.depthTexture&&this.writeDepthTexture?fbo.stencil&&(gl.deleteRenderbuffer(fbo.stencil),fbo.stencil=null):(fbo.stencil=fbo.stencil||gl.createRenderbuffer(),gl.bindRenderbuffer(gl.RENDERBUFFER,fbo.stencil),fbo.msaaBuffer?gl.renderbufferStorageMultisample(gl.RENDERBUFFER,fbo.multisample,gl.DEPTH24_STENCIL8,framebuffer.width,framebuffer.height):gl.renderbufferStorage(gl.RENDERBUFFER,gl.DEPTH_STENCIL,framebuffer.width,framebuffer.height),gl.framebufferRenderbuffer(gl.FRAMEBUFFER,gl.DEPTH_STENCIL_ATTACHMENT,gl.RENDERBUFFER,fbo.stencil))},FramebufferSystem.prototype.canMultisampleFramebuffer=function(framebuffer){return 1!==this.renderer.context.webGLVersion&&framebuffer.colorTextures.length<=1&&!framebuffer.depthTexture},FramebufferSystem.prototype.detectSamples=function(samples){var msaaSamples=this.msaaSamples,res=constants_MSAA_QUALITY.NONE;if(samples<=1||null===msaaSamples)return res;for(var i=0;i<msaaSamples.length;i++)if(msaaSamples[i]<=samples){res=msaaSamples[i];break}return 1===res&&(res=constants_MSAA_QUALITY.NONE),res},FramebufferSystem.prototype.blit=function(framebuffer,sourcePixels,destPixels){var current=this.current,renderer=this.renderer,gl=this.gl,CONTEXT_UID=this.CONTEXT_UID;if(2===renderer.context.webGLVersion&&current){var fbo=current.glFramebuffers[CONTEXT_UID];if(fbo){if(!framebuffer){if(!fbo.msaaBuffer)return;var colorTexture=current.colorTextures[0];if(!colorTexture)return;fbo.blitFramebuffer||(fbo.blitFramebuffer=new canvas_mesh_Framebuffer(current.width,current.height),fbo.blitFramebuffer.addColorTexture(0,colorTexture)),(framebuffer=fbo.blitFramebuffer).colorTextures[0]!==colorTexture&&(framebuffer.colorTextures[0]=colorTexture,framebuffer.dirtyId++,framebuffer.dirtyFormat++),framebuffer.width===current.width&&framebuffer.height===current.height||(framebuffer.width=current.width,framebuffer.height=current.height,framebuffer.dirtyId++,framebuffer.dirtySize++)}sourcePixels||((sourcePixels=canvas_mesh_tempRectangle).width=current.width,sourcePixels.height=current.height),destPixels||(destPixels=sourcePixels);var sameSize=sourcePixels.width===destPixels.width&&sourcePixels.height===destPixels.height;this.bind(framebuffer),gl.bindFramebuffer(gl.READ_FRAMEBUFFER,fbo.framebuffer),gl.blitFramebuffer(sourcePixels.left,sourcePixels.top,sourcePixels.right,sourcePixels.bottom,destPixels.left,destPixels.top,destPixels.right,destPixels.bottom,gl.COLOR_BUFFER_BIT,sameSize?gl.NEAREST:gl.LINEAR)}}},FramebufferSystem.prototype.disposeFramebuffer=function(framebuffer,contextLost){var fbo=framebuffer.glFramebuffers[this.CONTEXT_UID],gl=this.gl;if(fbo){delete framebuffer.glFramebuffers[this.CONTEXT_UID];var index=this.managedFramebuffers.indexOf(framebuffer);index>=0&&this.managedFramebuffers.splice(index,1),framebuffer.disposeRunner.remove(this),contextLost||(gl.deleteFramebuffer(fbo.framebuffer),fbo.msaaBuffer&&gl.deleteRenderbuffer(fbo.msaaBuffer),fbo.stencil&&gl.deleteRenderbuffer(fbo.stencil)),fbo.blitFramebuffer&&fbo.blitFramebuffer.dispose()}},FramebufferSystem.prototype.disposeAll=function(contextLost){var list=this.managedFramebuffers;this.managedFramebuffers=[];for(var i=0;i<list.length;i++)this.disposeFramebuffer(list[i],contextLost)},FramebufferSystem.prototype.forceStencil=function(){var framebuffer=this.current;if(framebuffer){var fbo=framebuffer.glFramebuffers[this.CONTEXT_UID];if(fbo&&!fbo.stencil){framebuffer.stencil=!0;var w=framebuffer.width,h=framebuffer.height,gl=this.gl,stencil=gl.createRenderbuffer();gl.bindRenderbuffer(gl.RENDERBUFFER,stencil),fbo.msaaBuffer?gl.renderbufferStorageMultisample(gl.RENDERBUFFER,fbo.multisample,gl.DEPTH24_STENCIL8,w,h):gl.renderbufferStorage(gl.RENDERBUFFER,gl.DEPTH_STENCIL,w,h),fbo.stencil=stencil,gl.framebufferRenderbuffer(gl.FRAMEBUFFER,gl.DEPTH_STENCIL_ATTACHMENT,gl.RENDERBUFFER,stencil)}}},FramebufferSystem.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new canvas_mesh_Rectangle},FramebufferSystem.prototype.destroy=function(){this.renderer=null},FramebufferSystem}(),canvas_mesh_byteSizeMap$1={5126:4,5123:2,5121:1},canvas_mesh_GeometrySystem=function(){function GeometrySystem(renderer){this.renderer=renderer,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}return GeometrySystem.prototype.contextChange=function(){this.disposeAll(!0);var gl=this.gl=this.renderer.gl,context=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,2!==context.webGLVersion){var nativeVaoExtension_1=this.renderer.context.extensions.vertexArrayObject;settings.PREFER_ENV===constants_ENV.WEBGL_LEGACY&&(nativeVaoExtension_1=null),nativeVaoExtension_1?(gl.createVertexArray=function(){return nativeVaoExtension_1.createVertexArrayOES()},gl.bindVertexArray=function(vao){return nativeVaoExtension_1.bindVertexArrayOES(vao)},gl.deleteVertexArray=function(vao){return nativeVaoExtension_1.deleteVertexArrayOES(vao)}):(this.hasVao=!1,gl.createVertexArray=function(){return null},gl.bindVertexArray=function(){return null},gl.deleteVertexArray=function(){return null})}if(2!==context.webGLVersion){var instanceExt_1=gl.getExtension("ANGLE_instanced_arrays");instanceExt_1?(gl.vertexAttribDivisor=function(a,b){return instanceExt_1.vertexAttribDivisorANGLE(a,b)},gl.drawElementsInstanced=function(a,b,c,d,e){return instanceExt_1.drawElementsInstancedANGLE(a,b,c,d,e)},gl.drawArraysInstanced=function(a,b,c,d){return instanceExt_1.drawArraysInstancedANGLE(a,b,c,d)}):this.hasInstance=!1}this.canUseUInt32ElementIndex=2===context.webGLVersion||!!context.extensions.uint32ElementIndex},GeometrySystem.prototype.bind=function(geometry,shader){shader=shader||this.renderer.shader.shader;var gl=this.gl,vaos=geometry.glVertexArrayObjects[this.CONTEXT_UID],incRefCount=!1;vaos||(this.managedGeometries[geometry.id]=geometry,geometry.disposeRunner.add(this),geometry.glVertexArrayObjects[this.CONTEXT_UID]=vaos={},incRefCount=!0);var vao=vaos[shader.program.id]||this.initGeometryVao(geometry,shader,incRefCount);this._activeGeometry=geometry,this._activeVao!==vao&&(this._activeVao=vao,this.hasVao?gl.bindVertexArray(vao):this.activateVao(geometry,shader.program)),this.updateBuffers()},GeometrySystem.prototype.reset=function(){this.unbind()},GeometrySystem.prototype.updateBuffers=function(){for(var geometry=this._activeGeometry,bufferSystem=this.renderer.buffer,i=0;i<geometry.buffers.length;i++){var buffer=geometry.buffers[i];bufferSystem.update(buffer)}},GeometrySystem.prototype.checkCompatibility=function(geometry,program){var geometryAttributes=geometry.attributes,shaderAttributes=program.attributeData;for(var j in shaderAttributes)if(!geometryAttributes[j])throw new Error('shader and geometry incompatible, geometry missing the "'+j+'" attribute')},GeometrySystem.prototype.getSignature=function(geometry,program){var attribs=geometry.attributes,shaderAttributes=program.attributeData,strings=["g",geometry.id];for(var i in attribs)shaderAttributes[i]&&strings.push(i,shaderAttributes[i].location);return strings.join("-")},GeometrySystem.prototype.initGeometryVao=function(geometry,shader,incRefCount){void 0===incRefCount&&(incRefCount=!0);var gl=this.gl,CONTEXT_UID=this.CONTEXT_UID,bufferSystem=this.renderer.buffer,program=shader.program;program.glPrograms[CONTEXT_UID]||this.renderer.shader.generateProgram(shader),this.checkCompatibility(geometry,program);var signature=this.getSignature(geometry,program),vaoObjectHash=geometry.glVertexArrayObjects[this.CONTEXT_UID],vao=vaoObjectHash[signature];if(vao)return vaoObjectHash[program.id]=vao,vao;var buffers=geometry.buffers,attributes=geometry.attributes,tempStride={},tempStart={};for(var j in buffers)tempStride[j]=0,tempStart[j]=0;for(var j in attributes)!attributes[j].size&&program.attributeData[j]?attributes[j].size=program.attributeData[j].size:attributes[j].size||console.warn("PIXI Geometry attribute '"+j+"' size cannot be determined (likely the bound shader does not have the attribute)"),tempStride[attributes[j].buffer]+=attributes[j].size*canvas_mesh_byteSizeMap$1[attributes[j].type];for(var j in attributes){var attribute=attributes[j],attribSize=attribute.size;void 0===attribute.stride&&(tempStride[attribute.buffer]===attribSize*canvas_mesh_byteSizeMap$1[attribute.type]?attribute.stride=0:attribute.stride=tempStride[attribute.buffer]),void 0===attribute.start&&(attribute.start=tempStart[attribute.buffer],tempStart[attribute.buffer]+=attribSize*canvas_mesh_byteSizeMap$1[attribute.type])}vao=gl.createVertexArray(),gl.bindVertexArray(vao);for(var i=0;i<buffers.length;i++){var buffer=buffers[i];bufferSystem.bind(buffer),incRefCount&&buffer._glBuffers[CONTEXT_UID].refCount++}return this.activateVao(geometry,program),this._activeVao=vao,vaoObjectHash[program.id]=vao,vaoObjectHash[signature]=vao,vao},GeometrySystem.prototype.disposeGeometry=function(geometry,contextLost){var _a;if(this.managedGeometries[geometry.id]){delete this.managedGeometries[geometry.id];var vaos=geometry.glVertexArrayObjects[this.CONTEXT_UID],gl=this.gl,buffers=geometry.buffers,bufferSystem=null===(_a=this.renderer)||void 0===_a?void 0:_a.buffer;if(geometry.disposeRunner.remove(this),vaos){if(bufferSystem)for(var i=0;i<buffers.length;i++){var buf=buffers[i]._glBuffers[this.CONTEXT_UID];buf&&(buf.refCount--,0!==buf.refCount||contextLost||bufferSystem.dispose(buffers[i],contextLost))}if(!contextLost)for(var vaoId in vaos)if("g"===vaoId[0]){var vao=vaos[vaoId];this._activeVao===vao&&this.unbind(),gl.deleteVertexArray(vao)}delete geometry.glVertexArrayObjects[this.CONTEXT_UID]}}},GeometrySystem.prototype.disposeAll=function(contextLost){for(var all=Object.keys(this.managedGeometries),i=0;i<all.length;i++)this.disposeGeometry(this.managedGeometries[all[i]],contextLost)},GeometrySystem.prototype.activateVao=function(geometry,program){var gl=this.gl,CONTEXT_UID=this.CONTEXT_UID,bufferSystem=this.renderer.buffer,buffers=geometry.buffers,attributes=geometry.attributes;geometry.indexBuffer&&bufferSystem.bind(geometry.indexBuffer);var lastBuffer=null;for(var j in attributes){var attribute=attributes[j],buffer=buffers[attribute.buffer],glBuffer=buffer._glBuffers[CONTEXT_UID];if(program.attributeData[j]){lastBuffer!==glBuffer&&(bufferSystem.bind(buffer),lastBuffer=glBuffer);var location=program.attributeData[j].location;if(gl.enableVertexAttribArray(location),gl.vertexAttribPointer(location,attribute.size,attribute.type||gl.FLOAT,attribute.normalized,attribute.stride,attribute.start),attribute.instance){if(!this.hasInstance)throw new Error("geometry error, GPU Instancing is not supported on this device");gl.vertexAttribDivisor(location,1)}}}},GeometrySystem.prototype.draw=function(type,size,start,instanceCount){var gl=this.gl,geometry=this._activeGeometry;if(geometry.indexBuffer){var byteSize=geometry.indexBuffer.data.BYTES_PER_ELEMENT,glType=2===byteSize?gl.UNSIGNED_SHORT:gl.UNSIGNED_INT;2===byteSize||4===byteSize&&this.canUseUInt32ElementIndex?geometry.instanced?gl.drawElementsInstanced(type,size||geometry.indexBuffer.data.length,glType,(start||0)*byteSize,instanceCount||1):gl.drawElements(type,size||geometry.indexBuffer.data.length,glType,(start||0)*byteSize):console.warn("unsupported index buffer type: uint32")}else geometry.instanced?gl.drawArraysInstanced(type,start,size||geometry.getSize(),instanceCount||1):gl.drawArrays(type,start,size||geometry.getSize());return this},GeometrySystem.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null},GeometrySystem.prototype.destroy=function(){this.renderer=null},GeometrySystem}(),canvas_mesh_MaskData=function(){function MaskData(maskObject){void 0===maskObject&&(maskObject=null),this.type=constants_MASK_TYPES.NONE,this.autoDetect=!0,this.maskObject=maskObject||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=settings.FILTER_MULTISAMPLE,this.enabled=!0,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._target=null}return Object.defineProperty(MaskData.prototype,"filter",{get:function(){return this._filters?this._filters[0]:null},set:function(value){value?this._filters?this._filters[0]=value:this._filters=[value]:this._filters=null},enumerable:!1,configurable:!0}),MaskData.prototype.reset=function(){this.pooled&&(this.maskObject=null,this.type=constants_MASK_TYPES.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null},MaskData.prototype.copyCountersOrReset=function(maskAbove){maskAbove?(this._stencilCounter=maskAbove._stencilCounter,this._scissorCounter=maskAbove._scissorCounter,this._scissorRect=maskAbove._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)},MaskData}();function canvas_mesh_compileShader(gl,type,src){var shader=gl.createShader(type);return gl.shaderSource(shader,src),gl.compileShader(shader),shader}function canvas_mesh_logPrettyShaderError(gl,shader){var shaderSrc=gl.getShaderSource(shader).split("\n").map((function(line,index){return index+": "+line})),shaderLog=gl.getShaderInfoLog(shader),splitShader=shaderLog.split("\n"),dedupe={},lineNumbers=splitShader.map((function(line){return parseFloat(line.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))})).filter((function(n){return!(!n||dedupe[n])&&(dedupe[n]=!0,!0)})),logArgs=[""];lineNumbers.forEach((function(number){shaderSrc[number-1]="%c"+shaderSrc[number-1]+"%c",logArgs.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")}));var fragmentSourceToLog=shaderSrc.join("\n");logArgs[0]=fragmentSourceToLog,console.error(shaderLog),console.groupCollapsed("click to view full shader code"),console.warn.apply(console,logArgs),console.groupEnd()}function canvas_mesh_booleanArray(size){for(var array=new Array(size),i=0;i<array.length;i++)array[i]=!1;return array}function canvas_mesh_defaultValue(type,size){switch(type){case"float":case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"vec2":return new Float32Array(2*size);case"vec3":return new Float32Array(3*size);case"vec4":return new Float32Array(4*size);case"ivec2":return new Int32Array(2*size);case"ivec3":return new Int32Array(3*size);case"ivec4":return new Int32Array(4*size);case"uvec2":return new Uint32Array(2*size);case"uvec3":return new Uint32Array(3*size);case"uvec4":return new Uint32Array(4*size);case"bool":return!1;case"bvec2":return canvas_mesh_booleanArray(2*size);case"bvec3":return canvas_mesh_booleanArray(3*size);case"bvec4":return canvas_mesh_booleanArray(4*size);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}var canvas_mesh_maxFragmentPrecision,canvas_mesh_unknownContext={},canvas_mesh_context=canvas_mesh_unknownContext;function canvas_mesh_getMaxFragmentPrecision(){if(!canvas_mesh_maxFragmentPrecision){canvas_mesh_maxFragmentPrecision=constants_PRECISION.MEDIUM;var gl=function(){if(canvas_mesh_context===canvas_mesh_unknownContext||canvas_mesh_context&&canvas_mesh_context.isContextLost()){var canvas=document.createElement("canvas"),gl=void 0;settings.PREFER_ENV>=constants_ENV.WEBGL2&&(gl=canvas.getContext("webgl2",{})),gl||((gl=canvas.getContext("webgl",{})||canvas.getContext("experimental-webgl",{}))?gl.getExtension("WEBGL_draw_buffers"):gl=null),canvas_mesh_context=gl}return canvas_mesh_context}();if(gl&&gl.getShaderPrecisionFormat){var shaderFragment=gl.getShaderPrecisionFormat(gl.FRAGMENT_SHADER,gl.HIGH_FLOAT);canvas_mesh_maxFragmentPrecision=shaderFragment.precision?constants_PRECISION.HIGH:constants_PRECISION.MEDIUM}}return canvas_mesh_maxFragmentPrecision}function canvas_mesh_setPrecision(src,requestedPrecision,maxSupportedPrecision){if("precision"!==src.substring(0,9)){var precision=requestedPrecision;return requestedPrecision===constants_PRECISION.HIGH&&maxSupportedPrecision!==constants_PRECISION.HIGH&&(precision=constants_PRECISION.MEDIUM),"precision "+precision+" float;\n"+src}return maxSupportedPrecision!==constants_PRECISION.HIGH&&"precision highp"===src.substring(0,15)?src.replace("precision highp","precision mediump"):src}var canvas_mesh_GLSL_TO_SIZE={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function canvas_mesh_mapSize(type){return canvas_mesh_GLSL_TO_SIZE[type]}var canvas_mesh_GL_TABLE=null,canvas_mesh_GL_TO_GLSL_TYPES={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function canvas_mesh_mapType(gl,type){if(!canvas_mesh_GL_TABLE){var typeNames=Object.keys(canvas_mesh_GL_TO_GLSL_TYPES);canvas_mesh_GL_TABLE={};for(var i=0;i<typeNames.length;++i){var tn=typeNames[i];canvas_mesh_GL_TABLE[gl[tn]]=canvas_mesh_GL_TO_GLSL_TYPES[tn]}}return canvas_mesh_GL_TABLE[type]}var canvas_mesh_uniformParsers=[{test:function(data){return"float"===data.type&&1===data.size},code:function(name){return'\n            if(uv["'+name+'"] !== ud["'+name+'"].value)\n            {\n                ud["'+name+'"].value = uv["'+name+'"]\n                gl.uniform1f(ud["'+name+'"].location, uv["'+name+'"])\n            }\n            '}},{test:function(data){return("sampler2D"===data.type||"samplerCube"===data.type||"sampler2DArray"===data.type)&&1===data.size&&!data.isArray},code:function(name){return't = syncData.textureCount++;\n\n            renderer.texture.bind(uv["'+name+'"], t);\n\n            if(ud["'+name+'"].value !== t)\n            {\n                ud["'+name+'"].value = t;\n                gl.uniform1i(ud["'+name+'"].location, t);\n; // eslint-disable-line max-len\n            }'}},{test:function(data,uniform){return"mat3"===data.type&&1===data.size&&void 0!==uniform.a},code:function(name){return'\n            gl.uniformMatrix3fv(ud["'+name+'"].location, false, uv["'+name+'"].toArray(true));\n            '},codeUbo:function(name){return"\n                var "+name+"_matrix = uv."+name+".toArray(true);\n\n                data[offset] = "+name+"_matrix[0];\n                data[offset+1] = "+name+"_matrix[1];\n                data[offset+2] = "+name+"_matrix[2];\n        \n                data[offset + 4] = "+name+"_matrix[3];\n                data[offset + 5] = "+name+"_matrix[4];\n                data[offset + 6] = "+name+"_matrix[5];\n        \n                data[offset + 8] = "+name+"_matrix[6];\n                data[offset + 9] = "+name+"_matrix[7];\n                data[offset + 10] = "+name+"_matrix[8];\n            "}},{test:function(data,uniform){return"vec2"===data.type&&1===data.size&&void 0!==uniform.x},code:function(name){return'\n                cv = ud["'+name+'"].value;\n                v = uv["'+name+'"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud["'+name+'"].location, v.x, v.y);\n                }'},codeUbo:function(name){return"\n                v = uv."+name+";\n\n                data[offset] = v.x;\n                data[offset+1] = v.y;\n            "}},{test:function(data){return"vec2"===data.type&&1===data.size},code:function(name){return'\n                cv = ud["'+name+'"].value;\n                v = uv["'+name+'"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud["'+name+'"].location, v[0], v[1]);\n                }\n            '}},{test:function(data,uniform){return"vec4"===data.type&&1===data.size&&void 0!==uniform.width},code:function(name){return'\n                cv = ud["'+name+'"].value;\n                v = uv["'+name+'"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud["'+name+'"].location, v.x, v.y, v.width, v.height)\n                }'},codeUbo:function(name){return"\n                    v = uv."+name+";\n\n                    data[offset] = v.x;\n                    data[offset+1] = v.y;\n                    data[offset+2] = v.width;\n                    data[offset+3] = v.height;\n                "}},{test:function(data){return"vec4"===data.type&&1===data.size},code:function(name){return'\n                cv = ud["'+name+'"].value;\n                v = uv["'+name+'"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud["'+name+'"].location, v[0], v[1], v[2], v[3])\n                }'}}],canvas_mesh_GLSL_TO_SINGLE_SETTERS_CACHED={float:"\n    if (cv !== v)\n    {\n        cu.value = v;\n        gl.uniform1f(location, v);\n    }",vec2:"\n    if (cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2f(location, v[0], v[1])\n    }",vec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",vec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4f(location, v[0], v[1], v[2], v[3]);\n    }",int:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1i(location, v);\n    }",ivec2:"\n    if (cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2i(location, v[0], v[1]);\n    }",ivec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3i(location, v[0], v[1], v[2]);\n    }",ivec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4i(location, v[0], v[1], v[2], v[3]);\n    }",uint:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1ui(location, v);\n    }",uvec2:"\n    if (cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2ui(location, v[0], v[1]);\n    }",uvec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3ui(location, v[0], v[1], v[2]);\n    }",uvec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);\n    }",bool:"\n    if (cv !== v)\n    {\n        cu.value = v;\n        gl.uniform1i(location, v);\n    }",bvec2:"\n    if (cv[0] != v[0] || cv[1] != v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2i(location, v[0], v[1]);\n    }",bvec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3i(location, v[0], v[1], v[2]);\n    }",bvec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4i(location, v[0], v[1], v[2], v[3]);\n    }",mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"gl.uniform1i(location, v)",samplerCube:"gl.uniform1i(location, v)",sampler2DArray:"gl.uniform1i(location, v)"},canvas_mesh_GLSL_TO_ARRAY_SETTERS={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};var canvas_mesh_unsafeEval,canvas_mesh_fragTemplate=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n");function canvas_mesh_generateIfTestSrc(maxIfs){for(var src="",i=0;i<maxIfs;++i)i>0&&(src+="\nelse "),i<maxIfs-1&&(src+="if(test == "+i+".0){}");return src}var canvas_mesh_UID$3=0,canvas_mesh_nameCache={},canvas_mesh_Program=function(){function Program(vertexSrc,fragmentSrc,name){void 0===name&&(name="pixi-shader"),this.id=canvas_mesh_UID$3++,this.vertexSrc=vertexSrc||Program.defaultVertexSrc,this.fragmentSrc=fragmentSrc||Program.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),"#version"!==this.vertexSrc.substring(0,8)&&(name=name.replace(/\s+/g,"-"),canvas_mesh_nameCache[name]?(canvas_mesh_nameCache[name]++,name+="-"+canvas_mesh_nameCache[name]):canvas_mesh_nameCache[name]=1,this.vertexSrc="#define SHADER_NAME "+name+"\n"+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+name+"\n"+this.fragmentSrc,this.vertexSrc=canvas_mesh_setPrecision(this.vertexSrc,settings.PRECISION_VERTEX,constants_PRECISION.HIGH),this.fragmentSrc=canvas_mesh_setPrecision(this.fragmentSrc,settings.PRECISION_FRAGMENT,canvas_mesh_getMaxFragmentPrecision())),this.glPrograms={},this.syncUniforms=null}return Object.defineProperty(Program,"defaultVertexSrc",{get:function(){return"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n"},enumerable:!1,configurable:!0}),Object.defineProperty(Program,"defaultFragmentSrc",{get:function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}"},enumerable:!1,configurable:!0}),Program.from=function(vertexSrc,fragmentSrc,name){var key=vertexSrc+fragmentSrc,program=canvas_mesh_ProgramCache[key];return program||(canvas_mesh_ProgramCache[key]=program=new Program(vertexSrc,fragmentSrc,name)),program},Program}(),canvas_mesh_Shader=function(){function Shader(program,uniforms){this.uniformBindCount=0,this.program=program,this.uniformGroup=uniforms?uniforms instanceof canvas_mesh_UniformGroup?uniforms:new canvas_mesh_UniformGroup(uniforms):new canvas_mesh_UniformGroup({})}return Shader.prototype.checkUniformExists=function(name,group){if(group.uniforms[name])return!0;for(var i in group.uniforms){var uniform=group.uniforms[i];if(uniform.group&&this.checkUniformExists(name,uniform))return!0}return!1},Shader.prototype.destroy=function(){this.uniformGroup=null},Object.defineProperty(Shader.prototype,"uniforms",{get:function(){return this.uniformGroup.uniforms},enumerable:!1,configurable:!0}),Shader.from=function(vertexSrc,fragmentSrc,uniforms){return new Shader(canvas_mesh_Program.from(vertexSrc,fragmentSrc),uniforms)},Shader}(),canvas_mesh_State=function(){function State(){this.data=0,this.blendMode=constants_BLEND_MODES.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}return Object.defineProperty(State.prototype,"blend",{get:function(){return!!(1&this.data)},set:function(value){!!(1&this.data)!==value&&(this.data^=1)},enumerable:!1,configurable:!0}),Object.defineProperty(State.prototype,"offsets",{get:function(){return!!(2&this.data)},set:function(value){!!(2&this.data)!==value&&(this.data^=2)},enumerable:!1,configurable:!0}),Object.defineProperty(State.prototype,"culling",{get:function(){return!!(4&this.data)},set:function(value){!!(4&this.data)!==value&&(this.data^=4)},enumerable:!1,configurable:!0}),Object.defineProperty(State.prototype,"depthTest",{get:function(){return!!(8&this.data)},set:function(value){!!(8&this.data)!==value&&(this.data^=8)},enumerable:!1,configurable:!0}),Object.defineProperty(State.prototype,"depthMask",{get:function(){return!!(32&this.data)},set:function(value){!!(32&this.data)!==value&&(this.data^=32)},enumerable:!1,configurable:!0}),Object.defineProperty(State.prototype,"clockwiseFrontFace",{get:function(){return!!(16&this.data)},set:function(value){!!(16&this.data)!==value&&(this.data^=16)},enumerable:!1,configurable:!0}),Object.defineProperty(State.prototype,"blendMode",{get:function(){return this._blendMode},set:function(value){this.blend=value!==constants_BLEND_MODES.NONE,this._blendMode=value},enumerable:!1,configurable:!0}),Object.defineProperty(State.prototype,"polygonOffset",{get:function(){return this._polygonOffset},set:function(value){this.offsets=!!value,this._polygonOffset=value},enumerable:!1,configurable:!0}),State.prototype.toString=function(){return"[@pixi/core:State blendMode="+this.blendMode+" clockwiseFrontFace="+this.clockwiseFrontFace+" culling="+this.culling+" depthMask="+this.depthMask+" polygonOffset="+this.polygonOffset+"]"},State.for2d=function(){var state=new State;return state.depthTest=!1,state.blend=!0,state},State}(),canvas_mesh_Filter=function(_super){function Filter(vertexSrc,fragmentSrc,uniforms){var _this=this,program=canvas_mesh_Program.from(vertexSrc||Filter.defaultVertexSrc,fragmentSrc||Filter.defaultFragmentSrc);return(_this=_super.call(this,program,uniforms)||this).padding=0,_this.resolution=settings.FILTER_RESOLUTION,_this.multisample=settings.FILTER_MULTISAMPLE,_this.enabled=!0,_this.autoFit=!0,_this.state=new canvas_mesh_State,_this}return canvas_mesh_extends(Filter,_super),Filter.prototype.apply=function(filterManager,input,output,clearMode,_currentState){filterManager.applyFilter(this,input,output,clearMode)},Object.defineProperty(Filter.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(value){this.state.blendMode=value},enumerable:!1,configurable:!0}),Object.defineProperty(Filter.prototype,"resolution",{get:function(){return this._resolution},set:function(value){this._resolution=value},enumerable:!1,configurable:!0}),Object.defineProperty(Filter,"defaultVertexSrc",{get:function(){return"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n"},enumerable:!1,configurable:!0}),Object.defineProperty(Filter,"defaultFragmentSrc",{get:function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n"},enumerable:!1,configurable:!0}),Filter}(canvas_mesh_Shader),canvas_mesh_tempMat=new canvas_mesh_Matrix,canvas_mesh_TextureMatrix=function(){function TextureMatrix(texture,clampMargin){this._texture=texture,this.mapCoord=new canvas_mesh_Matrix,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=void 0===clampMargin?.5:clampMargin,this.isSimple=!1}return Object.defineProperty(TextureMatrix.prototype,"texture",{get:function(){return this._texture},set:function(value){this._texture=value,this._textureID=-1},enumerable:!1,configurable:!0}),TextureMatrix.prototype.multiplyUvs=function(uvs,out){void 0===out&&(out=uvs);for(var mat=this.mapCoord,i=0;i<uvs.length;i+=2){var x=uvs[i],y=uvs[i+1];out[i]=x*mat.a+y*mat.c+mat.tx,out[i+1]=x*mat.b+y*mat.d+mat.ty}return out},TextureMatrix.prototype.update=function(forceUpdate){var tex=this._texture;if(!tex||!tex.valid)return!1;if(!forceUpdate&&this._textureID===tex._updateID)return!1;this._textureID=tex._updateID,this._updateID++;var uvs=tex._uvs;this.mapCoord.set(uvs.x1-uvs.x0,uvs.y1-uvs.y0,uvs.x3-uvs.x0,uvs.y3-uvs.y0,uvs.x0,uvs.y0);var orig=tex.orig,trim=tex.trim;trim&&(canvas_mesh_tempMat.set(orig.width/trim.width,0,0,orig.height/trim.height,-trim.x/trim.width,-trim.y/trim.height),this.mapCoord.append(canvas_mesh_tempMat));var texBase=tex.baseTexture,frame=this.uClampFrame,margin=this.clampMargin/texBase.resolution,offset=this.clampOffset;return frame[0]=(tex._frame.x+margin+offset)/texBase.width,frame[1]=(tex._frame.y+margin+offset)/texBase.height,frame[2]=(tex._frame.x+tex._frame.width-margin+offset)/texBase.width,frame[3]=(tex._frame.y+tex._frame.height-margin+offset)/texBase.height,this.uClampOffset[0]=offset/texBase.realWidth,this.uClampOffset[1]=offset/texBase.realHeight,this.isSimple=tex._frame.width===texBase.width&&tex._frame.height===texBase.height&&0===tex.rotate,!0},TextureMatrix}(),canvas_mesh_SpriteMaskFilter=function(_super){function SpriteMaskFilter(vertexSrc,fragmentSrc,uniforms){var _this=this,sprite=null;return"string"!=typeof vertexSrc&&void 0===fragmentSrc&&void 0===uniforms&&(sprite=vertexSrc,vertexSrc=void 0,fragmentSrc=void 0,uniforms=void 0),(_this=_super.call(this,vertexSrc||"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n",fragmentSrc||"varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n",uniforms)||this).maskSprite=sprite,_this.maskMatrix=new canvas_mesh_Matrix,_this}return canvas_mesh_extends(SpriteMaskFilter,_super),Object.defineProperty(SpriteMaskFilter.prototype,"maskSprite",{get:function(){return this._maskSprite},set:function(value){this._maskSprite=value,this._maskSprite&&(this._maskSprite.renderable=!1)},enumerable:!1,configurable:!0}),SpriteMaskFilter.prototype.apply=function(filterManager,input,output,clearMode){var maskSprite=this._maskSprite,tex=maskSprite._texture;tex.valid&&(tex.uvMatrix||(tex.uvMatrix=new canvas_mesh_TextureMatrix(tex,0)),tex.uvMatrix.update(),this.uniforms.npmAlpha=tex.baseTexture.alphaMode?0:1,this.uniforms.mask=tex,this.uniforms.otherMatrix=filterManager.calculateSpriteMatrix(this.maskMatrix,maskSprite).prepend(tex.uvMatrix.mapCoord),this.uniforms.alpha=maskSprite.worldAlpha,this.uniforms.maskClamp=tex.uvMatrix.uClampFrame,filterManager.applyFilter(this,input,output,clearMode))},SpriteMaskFilter}(canvas_mesh_Filter),canvas_mesh_MaskSystem=function(){function MaskSystem(renderer){this.renderer=renderer,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}return MaskSystem.prototype.setMaskStack=function(maskStack){this.maskStack=maskStack,this.renderer.scissor.setMaskStack(maskStack),this.renderer.stencil.setMaskStack(maskStack)},MaskSystem.prototype.push=function(target,maskDataOrTarget){var maskData=maskDataOrTarget;if(!maskData.isMaskData){var d=this.maskDataPool.pop()||new canvas_mesh_MaskData;d.pooled=!0,d.maskObject=maskDataOrTarget,maskData=d}var maskAbove=0!==this.maskStack.length?this.maskStack[this.maskStack.length-1]:null;if(maskData.copyCountersOrReset(maskAbove),maskData.autoDetect&&this.detect(maskData),maskData._target=target,maskData.type!==constants_MASK_TYPES.SPRITE&&this.maskStack.push(maskData),maskData.enabled)switch(maskData.type){case constants_MASK_TYPES.SCISSOR:this.renderer.scissor.push(maskData);break;case constants_MASK_TYPES.STENCIL:this.renderer.stencil.push(maskData);break;case constants_MASK_TYPES.SPRITE:maskData.copyCountersOrReset(null),this.pushSpriteMask(maskData)}maskData.type===constants_MASK_TYPES.SPRITE&&this.maskStack.push(maskData)},MaskSystem.prototype.pop=function(target){var maskData=this.maskStack.pop();if(maskData&&maskData._target===target){if(maskData.enabled)switch(maskData.type){case constants_MASK_TYPES.SCISSOR:this.renderer.scissor.pop();break;case constants_MASK_TYPES.STENCIL:this.renderer.stencil.pop(maskData.maskObject);break;case constants_MASK_TYPES.SPRITE:this.popSpriteMask(maskData)}if(maskData.reset(),maskData.pooled&&this.maskDataPool.push(maskData),0!==this.maskStack.length){var maskCurrent=this.maskStack[this.maskStack.length-1];maskCurrent.type===constants_MASK_TYPES.SPRITE&&maskCurrent._filters&&(maskCurrent._filters[0].maskSprite=maskCurrent.maskObject)}}},MaskSystem.prototype.detect=function(maskData){maskData.maskObject.isSprite?maskData.type=constants_MASK_TYPES.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(maskData)?maskData.type=constants_MASK_TYPES.SCISSOR:maskData.type=constants_MASK_TYPES.STENCIL},MaskSystem.prototype.pushSpriteMask=function(maskData){var _a,_b,maskObject=maskData.maskObject,target=maskData._target,alphaMaskFilter=maskData._filters;alphaMaskFilter||(alphaMaskFilter=this.alphaMaskPool[this.alphaMaskIndex])||(alphaMaskFilter=this.alphaMaskPool[this.alphaMaskIndex]=[new canvas_mesh_SpriteMaskFilter]);var resolution,multisample,renderer=this.renderer,renderTextureSystem=renderer.renderTexture;if(renderTextureSystem.current){var renderTexture=renderTextureSystem.current;resolution=maskData.resolution||renderTexture.resolution,multisample=null!==(_a=maskData.multisample)&&void 0!==_a?_a:renderTexture.multisample}else resolution=maskData.resolution||renderer.resolution,multisample=null!==(_b=maskData.multisample)&&void 0!==_b?_b:renderer.multisample;alphaMaskFilter[0].resolution=resolution,alphaMaskFilter[0].multisample=multisample,alphaMaskFilter[0].maskSprite=maskObject;var stashFilterArea=target.filterArea;target.filterArea=maskObject.getBounds(!0),renderer.filter.push(target,alphaMaskFilter),target.filterArea=stashFilterArea,maskData._filters||this.alphaMaskIndex++},MaskSystem.prototype.popSpriteMask=function(maskData){this.renderer.filter.pop(),maskData._filters?maskData._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)},MaskSystem.prototype.destroy=function(){this.renderer=null},MaskSystem}(),canvas_mesh_AbstractMaskSystem=function(){function AbstractMaskSystem(renderer){this.renderer=renderer,this.maskStack=[],this.glConst=0}return AbstractMaskSystem.prototype.getStackLength=function(){return this.maskStack.length},AbstractMaskSystem.prototype.setMaskStack=function(maskStack){var gl=this.renderer.gl,curStackLen=this.getStackLength();this.maskStack=maskStack;var newStackLen=this.getStackLength();newStackLen!==curStackLen&&(0===newStackLen?gl.disable(this.glConst):(gl.enable(this.glConst),this._useCurrent()))},AbstractMaskSystem.prototype._useCurrent=function(){},AbstractMaskSystem.prototype.destroy=function(){this.renderer=null,this.maskStack=null},AbstractMaskSystem}(),canvas_mesh_tempMatrix$1=new canvas_mesh_Matrix,canvas_mesh_ScissorSystem=function(_super){function ScissorSystem(renderer){var _this=_super.call(this,renderer)||this;return _this.glConst=WebGLRenderingContext.SCISSOR_TEST,_this}return canvas_mesh_extends(ScissorSystem,_super),ScissorSystem.prototype.getStackLength=function(){var maskData=this.maskStack[this.maskStack.length-1];return maskData?maskData._scissorCounter:0},ScissorSystem.prototype.calcScissorRect=function(maskData){if(!maskData._scissorRectLocal){var prevData=maskData._scissorRect,maskObject=maskData.maskObject,renderer=this.renderer,renderTextureSystem=renderer.renderTexture;maskObject.renderable=!0;var rect=maskObject.getBounds();this.roundFrameToPixels(rect,renderTextureSystem.current?renderTextureSystem.current.resolution:renderer.resolution,renderTextureSystem.sourceFrame,renderTextureSystem.destinationFrame,renderer.projection.transform),maskObject.renderable=!1,prevData&&rect.fit(prevData),maskData._scissorRectLocal=rect}},ScissorSystem.isMatrixRotated=function(matrix){if(!matrix)return!1;var a=matrix.a,b=matrix.b,c=matrix.c,d=matrix.d;return(Math.abs(b)>1e-4||Math.abs(c)>1e-4)&&(Math.abs(a)>1e-4||Math.abs(d)>1e-4)},ScissorSystem.prototype.testScissor=function(maskData){var maskObject=maskData.maskObject;if(!maskObject.isFastRect||!maskObject.isFastRect())return!1;if(ScissorSystem.isMatrixRotated(maskObject.worldTransform))return!1;if(ScissorSystem.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(maskData);var rect=maskData._scissorRectLocal;return rect.width>0&&rect.height>0},ScissorSystem.prototype.roundFrameToPixels=function(frame,resolution,bindingSourceFrame,bindingDestinationFrame,transform){ScissorSystem.isMatrixRotated(transform)||((transform=transform?canvas_mesh_tempMatrix$1.copyFrom(transform):canvas_mesh_tempMatrix$1.identity()).translate(-bindingSourceFrame.x,-bindingSourceFrame.y).scale(bindingDestinationFrame.width/bindingSourceFrame.width,bindingDestinationFrame.height/bindingSourceFrame.height).translate(bindingDestinationFrame.x,bindingDestinationFrame.y),this.renderer.filter.transformAABB(transform,frame),frame.fit(bindingDestinationFrame),frame.x=Math.round(frame.x*resolution),frame.y=Math.round(frame.y*resolution),frame.width=Math.round(frame.width*resolution),frame.height=Math.round(frame.height*resolution))},ScissorSystem.prototype.push=function(maskData){maskData._scissorRectLocal||this.calcScissorRect(maskData);var gl=this.renderer.gl;maskData._scissorRect||gl.enable(gl.SCISSOR_TEST),maskData._scissorCounter++,maskData._scissorRect=maskData._scissorRectLocal,this._useCurrent()},ScissorSystem.prototype.pop=function(){var gl=this.renderer.gl;this.getStackLength()>0?this._useCurrent():gl.disable(gl.SCISSOR_TEST)},ScissorSystem.prototype._useCurrent=function(){var y,rect=this.maskStack[this.maskStack.length-1]._scissorRect;y=this.renderer.renderTexture.current?rect.y:this.renderer.height-rect.height-rect.y,this.renderer.gl.scissor(rect.x,y,rect.width,rect.height)},ScissorSystem}(canvas_mesh_AbstractMaskSystem),canvas_mesh_StencilSystem=function(_super){function StencilSystem(renderer){var _this=_super.call(this,renderer)||this;return _this.glConst=WebGLRenderingContext.STENCIL_TEST,_this}return canvas_mesh_extends(StencilSystem,_super),StencilSystem.prototype.getStackLength=function(){var maskData=this.maskStack[this.maskStack.length-1];return maskData?maskData._stencilCounter:0},StencilSystem.prototype.push=function(maskData){var maskObject=maskData.maskObject,gl=this.renderer.gl,prevMaskCount=maskData._stencilCounter;0===prevMaskCount&&(this.renderer.framebuffer.forceStencil(),gl.clearStencil(0),gl.clear(gl.STENCIL_BUFFER_BIT),gl.enable(gl.STENCIL_TEST)),maskData._stencilCounter++,gl.colorMask(!1,!1,!1,!1),gl.stencilFunc(gl.EQUAL,prevMaskCount,4294967295),gl.stencilOp(gl.KEEP,gl.KEEP,gl.INCR),maskObject.renderable=!0,maskObject.render(this.renderer),this.renderer.batch.flush(),maskObject.renderable=!1,this._useCurrent()},StencilSystem.prototype.pop=function(maskObject){var gl=this.renderer.gl;0===this.getStackLength()?gl.disable(gl.STENCIL_TEST):(gl.colorMask(!1,!1,!1,!1),gl.stencilOp(gl.KEEP,gl.KEEP,gl.DECR),maskObject.renderable=!0,maskObject.render(this.renderer),this.renderer.batch.flush(),maskObject.renderable=!1,this._useCurrent())},StencilSystem.prototype._useCurrent=function(){var gl=this.renderer.gl;gl.colorMask(!0,!0,!0,!0),gl.stencilFunc(gl.EQUAL,this.getStackLength(),4294967295),gl.stencilOp(gl.KEEP,gl.KEEP,gl.KEEP)},StencilSystem}(canvas_mesh_AbstractMaskSystem),canvas_mesh_ProjectionSystem=function(){function ProjectionSystem(renderer){this.renderer=renderer,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new canvas_mesh_Matrix,this.transform=null}return ProjectionSystem.prototype.update=function(destinationFrame,sourceFrame,resolution,root){this.destinationFrame=destinationFrame||this.destinationFrame||this.defaultFrame,this.sourceFrame=sourceFrame||this.sourceFrame||destinationFrame,this.calculateProjection(this.destinationFrame,this.sourceFrame,resolution,root),this.transform&&this.projectionMatrix.append(this.transform);var renderer=this.renderer;renderer.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,renderer.globalUniforms.update(),renderer.shader.shader&&renderer.shader.syncUniformGroup(renderer.shader.shader.uniforms.globals)},ProjectionSystem.prototype.calculateProjection=function(_destinationFrame,sourceFrame,_resolution,root){var pm=this.projectionMatrix,sign=root?-1:1;pm.identity(),pm.a=1/sourceFrame.width*2,pm.d=sign*(1/sourceFrame.height*2),pm.tx=-1-sourceFrame.x*pm.a,pm.ty=-sign-sourceFrame.y*pm.d},ProjectionSystem.prototype.setTransform=function(_matrix){},ProjectionSystem.prototype.destroy=function(){this.renderer=null},ProjectionSystem}(),canvas_mesh_tempRect=new canvas_mesh_Rectangle,canvas_mesh_tempRect2=new canvas_mesh_Rectangle,canvas_mesh_RenderTextureSystem=function(){function RenderTextureSystem(renderer){this.renderer=renderer,this.clearColor=renderer._backgroundColorRgba,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new canvas_mesh_Rectangle,this.destinationFrame=new canvas_mesh_Rectangle,this.viewportFrame=new canvas_mesh_Rectangle}return RenderTextureSystem.prototype.bind=function(renderTexture,sourceFrame,destinationFrame){void 0===renderTexture&&(renderTexture=null);var baseTexture,framebuffer,resolution,renderer=this.renderer;this.current=renderTexture,renderTexture?(resolution=(baseTexture=renderTexture.baseTexture).resolution,sourceFrame||(canvas_mesh_tempRect.width=renderTexture.frame.width,canvas_mesh_tempRect.height=renderTexture.frame.height,sourceFrame=canvas_mesh_tempRect),destinationFrame||(canvas_mesh_tempRect2.x=renderTexture.frame.x,canvas_mesh_tempRect2.y=renderTexture.frame.y,canvas_mesh_tempRect2.width=sourceFrame.width,canvas_mesh_tempRect2.height=sourceFrame.height,destinationFrame=canvas_mesh_tempRect2),framebuffer=baseTexture.framebuffer):(resolution=renderer.resolution,sourceFrame||(canvas_mesh_tempRect.width=renderer.screen.width,canvas_mesh_tempRect.height=renderer.screen.height,sourceFrame=canvas_mesh_tempRect),destinationFrame||((destinationFrame=canvas_mesh_tempRect).width=sourceFrame.width,destinationFrame.height=sourceFrame.height));var viewportFrame=this.viewportFrame;viewportFrame.x=destinationFrame.x*resolution,viewportFrame.y=destinationFrame.y*resolution,viewportFrame.width=destinationFrame.width*resolution,viewportFrame.height=destinationFrame.height*resolution,renderTexture||(viewportFrame.y=renderer.view.height-(viewportFrame.y+viewportFrame.height)),viewportFrame.ceil(),this.renderer.framebuffer.bind(framebuffer,viewportFrame),this.renderer.projection.update(destinationFrame,sourceFrame,resolution,!framebuffer),renderTexture?this.renderer.mask.setMaskStack(baseTexture.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(sourceFrame),this.destinationFrame.copyFrom(destinationFrame)},RenderTextureSystem.prototype.clear=function(clearColor,mask){clearColor=this.current?clearColor||this.current.baseTexture.clearColor:clearColor||this.clearColor;var destinationFrame=this.destinationFrame,baseFrame=this.current?this.current.baseTexture:this.renderer.screen,clearMask=destinationFrame.width!==baseFrame.width||destinationFrame.height!==baseFrame.height;if(clearMask){var _a=this.viewportFrame,x=_a.x,y=_a.y,width=_a.width,height=_a.height;x=Math.round(x),y=Math.round(y),width=Math.round(width),height=Math.round(height),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(x,y,width,height)}this.renderer.framebuffer.clear(clearColor[0],clearColor[1],clearColor[2],clearColor[3],mask),clearMask&&this.renderer.scissor.pop()},RenderTextureSystem.prototype.resize=function(){this.bind(null)},RenderTextureSystem.prototype.reset=function(){this.bind(null)},RenderTextureSystem.prototype.destroy=function(){this.renderer=null},RenderTextureSystem}();function canvas_mesh_uboUpdate(_ud,_uv,_renderer,_syncData,buffer){_renderer.buffer.update(buffer)}var canvas_mesh_UBO_TO_SINGLE_SETTERS={float:"\n        data[offset] = v;\n    ",vec2:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n    ",vec3:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n\n    ",vec4:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n        data[offset+3] = v[3];\n    ",mat2:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n\n        data[offset+4] = v[2];\n        data[offset+5] = v[3];\n    ",mat3:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n\n        data[offset + 4] = v[3];\n        data[offset + 5] = v[4];\n        data[offset + 6] = v[5];\n\n        data[offset + 8] = v[6];\n        data[offset + 9] = v[7];\n        data[offset + 10] = v[8];\n    ",mat4:"\n        for(var i = 0; i < 16; i++)\n        {\n            data[offset + i] = v[i];\n        }\n    "},canvas_mesh_GLSL_TO_STD40_SIZE={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:32,mat3:48,mat4:64};function canvas_mesh_generateUniformBufferSync(group,uniformData){if(!group.autoManage)return{size:0,syncFunc:canvas_mesh_uboUpdate};for(var usedUniformDatas=function(uniforms,uniformData){var usedUniformDatas=[];for(var i in uniforms)uniformData[i]&&usedUniformDatas.push(uniformData[i]);return usedUniformDatas.sort((function(a,b){return a.index-b.index})),usedUniformDatas}(group.uniforms,uniformData),_a=function(uniformData){for(var uboElements=uniformData.map((function(data){return{data,offset:0,dataLen:0,dirty:0}})),size=0,chunkSize=0,offset=0,i=0;i<uboElements.length;i++){var uboElement=uboElements[i];if(size=canvas_mesh_GLSL_TO_STD40_SIZE[uboElement.data.type],uboElement.data.size>1&&(size=Math.max(size,16)*uboElement.data.size),uboElement.dataLen=size,chunkSize%size!=0&&chunkSize<16){var lineUpValue=chunkSize%size%16;chunkSize+=lineUpValue,offset+=lineUpValue}chunkSize+size>16?(offset=16*Math.ceil(offset/16),uboElement.offset=offset,offset+=size,chunkSize=size):(uboElement.offset=offset,chunkSize+=size,offset+=size)}return{uboElements,size:offset=16*Math.ceil(offset/16)}}(usedUniformDatas),uboElements=_a.uboElements,size=_a.size,funcFragments=["\n    var v = null;\n    var v2 = null;\n    var cv = null;\n    var t = 0;\n    var gl = renderer.gl\n    var index = 0;\n    var data = buffer.data;\n    "],i=0;i<uboElements.length;i++){for(var uboElement=uboElements[i],uniform=group.uniforms[uboElement.data.name],name=uboElement.data.name,parsed=!1,j=0;j<canvas_mesh_uniformParsers.length;j++){var uniformParser=canvas_mesh_uniformParsers[j];if(uniformParser.codeUbo&&uniformParser.test(uboElement.data,uniform)){funcFragments.push("offset = "+uboElement.offset/4+";",canvas_mesh_uniformParsers[j].codeUbo(uboElement.data.name,uniform)),parsed=!0;break}}if(!parsed)if(uboElement.data.size>1){var size_1=canvas_mesh_mapSize(uboElement.data.type),rowSize=Math.max(canvas_mesh_GLSL_TO_STD40_SIZE[uboElement.data.type]/16,1),elementSize=size_1/rowSize,remainder=(4-elementSize%4)%4;funcFragments.push("\n                cv = ud."+name+".value;\n                v = uv."+name+";\n                offset = "+uboElement.offset/4+";\n\n                t = 0;\n\n                for(var i=0; i < "+uboElement.data.size*rowSize+"; i++)\n                {\n                    for(var j = 0; j < "+elementSize+"; j++)\n                    {\n                        data[offset++] = v[t++];\n                    }\n                    offset += "+remainder+";\n                }\n\n                ")}else{var template=canvas_mesh_UBO_TO_SINGLE_SETTERS[uboElement.data.type];funcFragments.push("\n                cv = ud."+name+".value;\n                v = uv."+name+";\n                offset = "+uboElement.offset/4+";\n                "+template+";\n                ")}}return funcFragments.push("\n       renderer.buffer.update(buffer);\n    "),{size,syncFunc:new Function("ud","uv","renderer","syncData","buffer",funcFragments.join("\n"))}}var canvas_mesh_GLProgram=function(){function GLProgram(program,uniformData){this.program=program,this.uniformData=uniformData,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}return GLProgram.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null},GLProgram}();function canvas_mesh_generateProgram(gl,program){var glVertShader=canvas_mesh_compileShader(gl,gl.VERTEX_SHADER,program.vertexSrc),glFragShader=canvas_mesh_compileShader(gl,gl.FRAGMENT_SHADER,program.fragmentSrc),webGLProgram=gl.createProgram();if(gl.attachShader(webGLProgram,glVertShader),gl.attachShader(webGLProgram,glFragShader),gl.linkProgram(webGLProgram),gl.getProgramParameter(webGLProgram,gl.LINK_STATUS)||function(gl,program,vertexShader,fragmentShader){gl.getProgramParameter(program,gl.LINK_STATUS)||(gl.getShaderParameter(vertexShader,gl.COMPILE_STATUS)||canvas_mesh_logPrettyShaderError(gl,vertexShader),gl.getShaderParameter(fragmentShader,gl.COMPILE_STATUS)||canvas_mesh_logPrettyShaderError(gl,fragmentShader),console.error("PixiJS Error: Could not initialize shader."),""!==gl.getProgramInfoLog(program)&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",gl.getProgramInfoLog(program)))}(gl,webGLProgram,glVertShader,glFragShader),program.attributeData=function(program,gl){for(var attributes={},totalAttributes=gl.getProgramParameter(program,gl.ACTIVE_ATTRIBUTES),i=0;i<totalAttributes;i++){var attribData=gl.getActiveAttrib(program,i);if(0!==attribData.name.indexOf("gl_")){var type=canvas_mesh_mapType(gl,attribData.type),data={type,name:attribData.name,size:canvas_mesh_mapSize(type),location:gl.getAttribLocation(program,attribData.name)};attributes[attribData.name]=data}}return attributes}(webGLProgram,gl),program.uniformData=function(program,gl){for(var uniforms={},totalUniforms=gl.getProgramParameter(program,gl.ACTIVE_UNIFORMS),i=0;i<totalUniforms;i++){var uniformData=gl.getActiveUniform(program,i),name=uniformData.name.replace(/\[.*?\]$/,""),isArray=!!uniformData.name.match(/\[.*?\]$/),type=canvas_mesh_mapType(gl,uniformData.type);uniforms[name]={name,index:i,type,size:uniformData.size,isArray,value:canvas_mesh_defaultValue(type,uniformData.size)}}return uniforms}(webGLProgram,gl),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(program.vertexSrc)){var keys=Object.keys(program.attributeData);keys.sort((function(a,b){return a>b?1:-1}));for(var i=0;i<keys.length;i++)program.attributeData[keys[i]].location=i,gl.bindAttribLocation(webGLProgram,i,keys[i]);gl.linkProgram(webGLProgram)}gl.deleteShader(glVertShader),gl.deleteShader(glFragShader);var uniformData={};for(var i in program.uniformData){var data=program.uniformData[i];uniformData[i]={location:gl.getUniformLocation(webGLProgram,i),value:canvas_mesh_defaultValue(data.type,data.size)}}return new canvas_mesh_GLProgram(webGLProgram,uniformData)}var canvas_mesh_UID$4=0,canvas_mesh_defaultSyncData={textureCount:0,uboCount:0},canvas_mesh_ShaderSystem=function(){function ShaderSystem(renderer){this.destroyed=!1,this.renderer=renderer,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=canvas_mesh_UID$4++}return ShaderSystem.prototype.systemCheck=function(){if(!function(){if("boolean"==typeof canvas_mesh_unsafeEval)return canvas_mesh_unsafeEval;try{var func=new Function("param1","param2","param3","return param1[param2] === param3;");canvas_mesh_unsafeEval=!0===func({a:"b"},"a","b")}catch(e){canvas_mesh_unsafeEval=!1}return canvas_mesh_unsafeEval}())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},ShaderSystem.prototype.contextChange=function(gl){this.gl=gl,this.reset()},ShaderSystem.prototype.bind=function(shader,dontSync){shader.uniforms.globals=this.renderer.globalUniforms;var program=shader.program,glProgram=program.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(shader);return this.shader=shader,this.program!==program&&(this.program=program,this.gl.useProgram(glProgram.program)),dontSync||(canvas_mesh_defaultSyncData.textureCount=0,canvas_mesh_defaultSyncData.uboCount=0,this.syncUniformGroup(shader.uniformGroup,canvas_mesh_defaultSyncData)),glProgram},ShaderSystem.prototype.setUniforms=function(uniforms){var shader=this.shader.program,glProgram=shader.glPrograms[this.renderer.CONTEXT_UID];shader.syncUniforms(glProgram.uniformData,uniforms,this.renderer)},ShaderSystem.prototype.syncUniformGroup=function(group,syncData){var glProgram=this.getGlProgram();group.static&&group.dirtyId===glProgram.uniformDirtyGroups[group.id]||(glProgram.uniformDirtyGroups[group.id]=group.dirtyId,this.syncUniforms(group,glProgram,syncData))},ShaderSystem.prototype.syncUniforms=function(group,glProgram,syncData){(group.syncUniforms[this.shader.program.id]||this.createSyncGroups(group))(glProgram.uniformData,group.uniforms,this.renderer,syncData)},ShaderSystem.prototype.createSyncGroups=function(group){var id=this.getSignature(group,this.shader.program.uniformData,"u");return this.cache[id]||(this.cache[id]=function(group,uniformData){var _a,funcFragments=["\n        var v = null;\n        var cv = null;\n        var cu = null;\n        var t = 0;\n        var gl = renderer.gl;\n    "];for(var i in group.uniforms){var data=uniformData[i];if(data){for(var uniform=group.uniforms[i],parsed=!1,j=0;j<canvas_mesh_uniformParsers.length;j++)if(canvas_mesh_uniformParsers[j].test(data,uniform)){funcFragments.push(canvas_mesh_uniformParsers[j].code(i,uniform)),parsed=!0;break}if(!parsed){var template=(1===data.size?canvas_mesh_GLSL_TO_SINGLE_SETTERS_CACHED:canvas_mesh_GLSL_TO_ARRAY_SETTERS)[data.type].replace("location",'ud["'+i+'"].location');funcFragments.push('\n            cu = ud["'+i+'"];\n            cv = cu.value;\n            v = uv["'+i+'"];\n            '+template+";")}}else(null===(_a=group.uniforms[i])||void 0===_a?void 0:_a.group)&&(group.uniforms[i].ubo?funcFragments.push("\n                        renderer.shader.syncUniformBufferGroup(uv."+i+", '"+i+"');\n                    "):funcFragments.push("\n                        renderer.shader.syncUniformGroup(uv."+i+", syncData);\n                    "))}return new Function("ud","uv","renderer","syncData",funcFragments.join("\n"))}(group,this.shader.program.uniformData)),group.syncUniforms[this.shader.program.id]=this.cache[id],group.syncUniforms[this.shader.program.id]},ShaderSystem.prototype.syncUniformBufferGroup=function(group,name){var glProgram=this.getGlProgram();if(!group.static||0!==group.dirtyId||!glProgram.uniformGroups[group.id]){group.dirtyId=0;var syncFunc=glProgram.uniformGroups[group.id]||this.createSyncBufferGroup(group,glProgram,name);group.buffer.update(),syncFunc(glProgram.uniformData,group.uniforms,this.renderer,canvas_mesh_defaultSyncData,group.buffer)}this.renderer.buffer.bindBufferBase(group.buffer,glProgram.uniformBufferBindings[name])},ShaderSystem.prototype.createSyncBufferGroup=function(group,glProgram,name){var gl=this.renderer.gl;this.renderer.buffer.bind(group.buffer);var uniformBlockIndex=this.gl.getUniformBlockIndex(glProgram.program,name);glProgram.uniformBufferBindings[name]=this.shader.uniformBindCount,gl.uniformBlockBinding(glProgram.program,uniformBlockIndex,this.shader.uniformBindCount),this.shader.uniformBindCount++;var id=this.getSignature(group,this.shader.program.uniformData,"ubo"),uboData=this._uboCache[id];if(uboData||(uboData=this._uboCache[id]=canvas_mesh_generateUniformBufferSync(group,this.shader.program.uniformData)),group.autoManage){var data=new Float32Array(uboData.size/4);group.buffer.update(data)}return glProgram.uniformGroups[group.id]=uboData.syncFunc,glProgram.uniformGroups[group.id]},ShaderSystem.prototype.getSignature=function(group,uniformData,preFix){var uniforms=group.uniforms,strings=[preFix+"-"];for(var i in uniforms)strings.push(i),uniformData[i]&&strings.push(uniformData[i].type);return strings.join("-")},ShaderSystem.prototype.getGlProgram=function(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},ShaderSystem.prototype.generateProgram=function(shader){var gl=this.gl,program=shader.program,glProgram=canvas_mesh_generateProgram(gl,program);return program.glPrograms[this.renderer.CONTEXT_UID]=glProgram,glProgram},ShaderSystem.prototype.reset=function(){this.program=null,this.shader=null},ShaderSystem.prototype.destroy=function(){this.renderer=null,this.destroyed=!0},ShaderSystem}();var canvas_mesh_StateSystem=function(){function StateSystem(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=constants_BLEND_MODES.NONE,this._blendEq=!1,this.map=[],this.map[0]=this.setBlend,this.map[1]=this.setOffset,this.map[2]=this.setCullFace,this.map[3]=this.setDepthTest,this.map[4]=this.setFrontFace,this.map[5]=this.setDepthMask,this.checks=[],this.defaultState=new canvas_mesh_State,this.defaultState.blend=!0}return StateSystem.prototype.contextChange=function(gl){this.gl=gl,this.blendModes=function(gl,array){return void 0===array&&(array=[]),array[constants_BLEND_MODES.NORMAL]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA],array[constants_BLEND_MODES.ADD]=[gl.ONE,gl.ONE],array[constants_BLEND_MODES.MULTIPLY]=[gl.DST_COLOR,gl.ONE_MINUS_SRC_ALPHA,gl.ONE,gl.ONE_MINUS_SRC_ALPHA],array[constants_BLEND_MODES.SCREEN]=[gl.ONE,gl.ONE_MINUS_SRC_COLOR,gl.ONE,gl.ONE_MINUS_SRC_ALPHA],array[constants_BLEND_MODES.OVERLAY]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA],array[constants_BLEND_MODES.DARKEN]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA],array[constants_BLEND_MODES.LIGHTEN]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA],array[constants_BLEND_MODES.COLOR_DODGE]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA],array[constants_BLEND_MODES.COLOR_BURN]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA],array[constants_BLEND_MODES.HARD_LIGHT]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA],array[constants_BLEND_MODES.SOFT_LIGHT]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA],array[constants_BLEND_MODES.DIFFERENCE]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA],array[constants_BLEND_MODES.EXCLUSION]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA],array[constants_BLEND_MODES.HUE]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA],array[constants_BLEND_MODES.SATURATION]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA],array[constants_BLEND_MODES.COLOR]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA],array[constants_BLEND_MODES.LUMINOSITY]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA],array[constants_BLEND_MODES.NONE]=[0,0],array[constants_BLEND_MODES.NORMAL_NPM]=[gl.SRC_ALPHA,gl.ONE_MINUS_SRC_ALPHA,gl.ONE,gl.ONE_MINUS_SRC_ALPHA],array[constants_BLEND_MODES.ADD_NPM]=[gl.SRC_ALPHA,gl.ONE,gl.ONE,gl.ONE],array[constants_BLEND_MODES.SCREEN_NPM]=[gl.SRC_ALPHA,gl.ONE_MINUS_SRC_COLOR,gl.ONE,gl.ONE_MINUS_SRC_ALPHA],array[constants_BLEND_MODES.SRC_IN]=[gl.DST_ALPHA,gl.ZERO],array[constants_BLEND_MODES.SRC_OUT]=[gl.ONE_MINUS_DST_ALPHA,gl.ZERO],array[constants_BLEND_MODES.SRC_ATOP]=[gl.DST_ALPHA,gl.ONE_MINUS_SRC_ALPHA],array[constants_BLEND_MODES.DST_OVER]=[gl.ONE_MINUS_DST_ALPHA,gl.ONE],array[constants_BLEND_MODES.DST_IN]=[gl.ZERO,gl.SRC_ALPHA],array[constants_BLEND_MODES.DST_OUT]=[gl.ZERO,gl.ONE_MINUS_SRC_ALPHA],array[constants_BLEND_MODES.DST_ATOP]=[gl.ONE_MINUS_DST_ALPHA,gl.SRC_ALPHA],array[constants_BLEND_MODES.XOR]=[gl.ONE_MINUS_DST_ALPHA,gl.ONE_MINUS_SRC_ALPHA],array[constants_BLEND_MODES.SUBTRACT]=[gl.ONE,gl.ONE,gl.ONE,gl.ONE,gl.FUNC_REVERSE_SUBTRACT,gl.FUNC_ADD],array}(gl),this.set(this.defaultState),this.reset()},StateSystem.prototype.set=function(state){if(state=state||this.defaultState,this.stateId!==state.data){for(var diff=this.stateId^state.data,i=0;diff;)1&diff&&this.map[i].call(this,!!(state.data&1<<i)),diff>>=1,i++;this.stateId=state.data}for(i=0;i<this.checks.length;i++)this.checks[i](this,state)},StateSystem.prototype.forceState=function(state){state=state||this.defaultState;for(var i=0;i<this.map.length;i++)this.map[i].call(this,!!(state.data&1<<i));for(i=0;i<this.checks.length;i++)this.checks[i](this,state);this.stateId=state.data},StateSystem.prototype.setBlend=function(value){this.updateCheck(StateSystem.checkBlendMode,value),this.gl[value?"enable":"disable"](this.gl.BLEND)},StateSystem.prototype.setOffset=function(value){this.updateCheck(StateSystem.checkPolygonOffset,value),this.gl[value?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)},StateSystem.prototype.setDepthTest=function(value){this.gl[value?"enable":"disable"](this.gl.DEPTH_TEST)},StateSystem.prototype.setDepthMask=function(value){this.gl.depthMask(value)},StateSystem.prototype.setCullFace=function(value){this.gl[value?"enable":"disable"](this.gl.CULL_FACE)},StateSystem.prototype.setFrontFace=function(value){this.gl.frontFace(this.gl[value?"CW":"CCW"])},StateSystem.prototype.setBlendMode=function(value){if(value!==this.blendMode){this.blendMode=value;var mode=this.blendModes[value],gl=this.gl;2===mode.length?gl.blendFunc(mode[0],mode[1]):gl.blendFuncSeparate(mode[0],mode[1],mode[2],mode[3]),6===mode.length?(this._blendEq=!0,gl.blendEquationSeparate(mode[4],mode[5])):this._blendEq&&(this._blendEq=!1,gl.blendEquationSeparate(gl.FUNC_ADD,gl.FUNC_ADD))}},StateSystem.prototype.setPolygonOffset=function(value,scale){this.gl.polygonOffset(value,scale)},StateSystem.prototype.reset=function(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},StateSystem.prototype.updateCheck=function(func,value){var index=this.checks.indexOf(func);value&&-1===index?this.checks.push(func):value||-1===index||this.checks.splice(index,1)},StateSystem.checkBlendMode=function(system,state){system.setBlendMode(state.blendMode)},StateSystem.checkPolygonOffset=function(system,state){system.setPolygonOffset(1,state.polygonOffset)},StateSystem.prototype.destroy=function(){this.gl=null},StateSystem}(),canvas_mesh_TextureGCSystem=function(){function TextureGCSystem(renderer){this.renderer=renderer,this.count=0,this.checkCount=0,this.maxIdle=settings.GC_MAX_IDLE,this.checkCountMax=settings.GC_MAX_CHECK_COUNT,this.mode=settings.GC_MODE}return TextureGCSystem.prototype.postrender=function(){this.renderer.renderingToScreen&&(this.count++,this.mode!==constants_GC_MODES.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))},TextureGCSystem.prototype.run=function(){for(var tm=this.renderer.texture,managedTextures=tm.managedTextures,wasRemoved=!1,i=0;i<managedTextures.length;i++){var texture=managedTextures[i];!texture.framebuffer&&this.count-texture.touched>this.maxIdle&&(tm.destroyTexture(texture,!0),managedTextures[i]=null,wasRemoved=!0)}if(wasRemoved){var j=0;for(i=0;i<managedTextures.length;i++)null!==managedTextures[i]&&(managedTextures[j++]=managedTextures[i]);managedTextures.length=j}},TextureGCSystem.prototype.unload=function(displayObject){var tm=this.renderer.texture,texture=displayObject._texture;texture&&!texture.framebuffer&&tm.destroyTexture(texture);for(var i=displayObject.children.length-1;i>=0;i--)this.unload(displayObject.children[i])},TextureGCSystem.prototype.destroy=function(){this.renderer=null},TextureGCSystem}();var canvas_mesh_GLTexture=function(texture){this.texture=texture,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=constants_TYPES.UNSIGNED_BYTE,this.internalFormat=constants_FORMATS.RGBA,this.samplerType=0},canvas_mesh_TextureSystem=function(){function TextureSystem(renderer){this.renderer=renderer,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new canvas_mesh_BaseTexture,this.hasIntegerTextures=!1}return TextureSystem.prototype.contextChange=function(){var gl=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=function(gl){var _a,_b,_c,_d,_e,_f,_g,_h,_j,_k,_l,_m,_o,_p,_q,_r,_s,_t,_u,_v,_w,_x,table;return"WebGL2RenderingContext"in globalThis&&gl instanceof globalThis.WebGL2RenderingContext?((_a={})[constants_TYPES.UNSIGNED_BYTE]=((_b={})[constants_FORMATS.RGBA]=gl.RGBA8,_b[constants_FORMATS.RGB]=gl.RGB8,_b[constants_FORMATS.RG]=gl.RG8,_b[constants_FORMATS.RED]=gl.R8,_b[constants_FORMATS.RGBA_INTEGER]=gl.RGBA8UI,_b[constants_FORMATS.RGB_INTEGER]=gl.RGB8UI,_b[constants_FORMATS.RG_INTEGER]=gl.RG8UI,_b[constants_FORMATS.RED_INTEGER]=gl.R8UI,_b[constants_FORMATS.ALPHA]=gl.ALPHA,_b[constants_FORMATS.LUMINANCE]=gl.LUMINANCE,_b[constants_FORMATS.LUMINANCE_ALPHA]=gl.LUMINANCE_ALPHA,_b),_a[constants_TYPES.BYTE]=((_c={})[constants_FORMATS.RGBA]=gl.RGBA8_SNORM,_c[constants_FORMATS.RGB]=gl.RGB8_SNORM,_c[constants_FORMATS.RG]=gl.RG8_SNORM,_c[constants_FORMATS.RED]=gl.R8_SNORM,_c[constants_FORMATS.RGBA_INTEGER]=gl.RGBA8I,_c[constants_FORMATS.RGB_INTEGER]=gl.RGB8I,_c[constants_FORMATS.RG_INTEGER]=gl.RG8I,_c[constants_FORMATS.RED_INTEGER]=gl.R8I,_c),_a[constants_TYPES.UNSIGNED_SHORT]=((_d={})[constants_FORMATS.RGBA_INTEGER]=gl.RGBA16UI,_d[constants_FORMATS.RGB_INTEGER]=gl.RGB16UI,_d[constants_FORMATS.RG_INTEGER]=gl.RG16UI,_d[constants_FORMATS.RED_INTEGER]=gl.R16UI,_d[constants_FORMATS.DEPTH_COMPONENT]=gl.DEPTH_COMPONENT16,_d),_a[constants_TYPES.SHORT]=((_e={})[constants_FORMATS.RGBA_INTEGER]=gl.RGBA16I,_e[constants_FORMATS.RGB_INTEGER]=gl.RGB16I,_e[constants_FORMATS.RG_INTEGER]=gl.RG16I,_e[constants_FORMATS.RED_INTEGER]=gl.R16I,_e),_a[constants_TYPES.UNSIGNED_INT]=((_f={})[constants_FORMATS.RGBA_INTEGER]=gl.RGBA32UI,_f[constants_FORMATS.RGB_INTEGER]=gl.RGB32UI,_f[constants_FORMATS.RG_INTEGER]=gl.RG32UI,_f[constants_FORMATS.RED_INTEGER]=gl.R32UI,_f[constants_FORMATS.DEPTH_COMPONENT]=gl.DEPTH_COMPONENT24,_f),_a[constants_TYPES.INT]=((_g={})[constants_FORMATS.RGBA_INTEGER]=gl.RGBA32I,_g[constants_FORMATS.RGB_INTEGER]=gl.RGB32I,_g[constants_FORMATS.RG_INTEGER]=gl.RG32I,_g[constants_FORMATS.RED_INTEGER]=gl.R32I,_g),_a[constants_TYPES.FLOAT]=((_h={})[constants_FORMATS.RGBA]=gl.RGBA32F,_h[constants_FORMATS.RGB]=gl.RGB32F,_h[constants_FORMATS.RG]=gl.RG32F,_h[constants_FORMATS.RED]=gl.R32F,_h[constants_FORMATS.DEPTH_COMPONENT]=gl.DEPTH_COMPONENT32F,_h),_a[constants_TYPES.HALF_FLOAT]=((_j={})[constants_FORMATS.RGBA]=gl.RGBA16F,_j[constants_FORMATS.RGB]=gl.RGB16F,_j[constants_FORMATS.RG]=gl.RG16F,_j[constants_FORMATS.RED]=gl.R16F,_j),_a[constants_TYPES.UNSIGNED_SHORT_5_6_5]=((_k={})[constants_FORMATS.RGB]=gl.RGB565,_k),_a[constants_TYPES.UNSIGNED_SHORT_4_4_4_4]=((_l={})[constants_FORMATS.RGBA]=gl.RGBA4,_l),_a[constants_TYPES.UNSIGNED_SHORT_5_5_5_1]=((_m={})[constants_FORMATS.RGBA]=gl.RGB5_A1,_m),_a[constants_TYPES.UNSIGNED_INT_2_10_10_10_REV]=((_o={})[constants_FORMATS.RGBA]=gl.RGB10_A2,_o[constants_FORMATS.RGBA_INTEGER]=gl.RGB10_A2UI,_o),_a[constants_TYPES.UNSIGNED_INT_10F_11F_11F_REV]=((_p={})[constants_FORMATS.RGB]=gl.R11F_G11F_B10F,_p),_a[constants_TYPES.UNSIGNED_INT_5_9_9_9_REV]=((_q={})[constants_FORMATS.RGB]=gl.RGB9_E5,_q),_a[constants_TYPES.UNSIGNED_INT_24_8]=((_r={})[constants_FORMATS.DEPTH_STENCIL]=gl.DEPTH24_STENCIL8,_r),_a[constants_TYPES.FLOAT_32_UNSIGNED_INT_24_8_REV]=((_s={})[constants_FORMATS.DEPTH_STENCIL]=gl.DEPTH32F_STENCIL8,_s),table=_a):((_t={})[constants_TYPES.UNSIGNED_BYTE]=((_u={})[constants_FORMATS.RGBA]=gl.RGBA,_u[constants_FORMATS.RGB]=gl.RGB,_u[constants_FORMATS.ALPHA]=gl.ALPHA,_u[constants_FORMATS.LUMINANCE]=gl.LUMINANCE,_u[constants_FORMATS.LUMINANCE_ALPHA]=gl.LUMINANCE_ALPHA,_u),_t[constants_TYPES.UNSIGNED_SHORT_5_6_5]=((_v={})[constants_FORMATS.RGB]=gl.RGB,_v),_t[constants_TYPES.UNSIGNED_SHORT_4_4_4_4]=((_w={})[constants_FORMATS.RGBA]=gl.RGBA,_w),_t[constants_TYPES.UNSIGNED_SHORT_5_5_5_1]=((_x={})[constants_FORMATS.RGBA]=gl.RGBA,_x),table=_t),table}(gl);var maxTextures=gl.getParameter(gl.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=maxTextures;for(var i=0;i<maxTextures;i++)this.boundTextures[i]=null;this.emptyTextures={};var emptyTexture2D=new canvas_mesh_GLTexture(gl.createTexture());gl.bindTexture(gl.TEXTURE_2D,emptyTexture2D.texture),gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,1,1,0,gl.RGBA,gl.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[gl.TEXTURE_2D]=emptyTexture2D,this.emptyTextures[gl.TEXTURE_CUBE_MAP]=new canvas_mesh_GLTexture(gl.createTexture()),gl.bindTexture(gl.TEXTURE_CUBE_MAP,this.emptyTextures[gl.TEXTURE_CUBE_MAP].texture);for(i=0;i<6;i++)gl.texImage2D(gl.TEXTURE_CUBE_MAP_POSITIVE_X+i,0,gl.RGBA,1,1,0,gl.RGBA,gl.UNSIGNED_BYTE,null);gl.texParameteri(gl.TEXTURE_CUBE_MAP,gl.TEXTURE_MAG_FILTER,gl.LINEAR),gl.texParameteri(gl.TEXTURE_CUBE_MAP,gl.TEXTURE_MIN_FILTER,gl.LINEAR);for(i=0;i<this.boundTextures.length;i++)this.bind(null,i)},TextureSystem.prototype.bind=function(texture,location){void 0===location&&(location=0);var gl=this.gl;if((texture=null==texture?void 0:texture.castToBaseTexture())&&texture.valid&&!texture.parentTextureArray){texture.touched=this.renderer.textureGC.count;var glTexture=texture._glTextures[this.CONTEXT_UID]||this.initTexture(texture);this.boundTextures[location]!==texture&&(this.currentLocation!==location&&(this.currentLocation=location,gl.activeTexture(gl.TEXTURE0+location)),gl.bindTexture(texture.target,glTexture.texture)),glTexture.dirtyId!==texture.dirtyId&&(this.currentLocation!==location&&(this.currentLocation=location,gl.activeTexture(gl.TEXTURE0+location)),this.updateTexture(texture)),this.boundTextures[location]=texture}else this.currentLocation!==location&&(this.currentLocation=location,gl.activeTexture(gl.TEXTURE0+location)),gl.bindTexture(gl.TEXTURE_2D,this.emptyTextures[gl.TEXTURE_2D].texture),this.boundTextures[location]=null},TextureSystem.prototype.reset=function(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(var i=0;i<this.boundTextures.length;i++)this.boundTextures[i]=this.unknownTexture},TextureSystem.prototype.unbind=function(texture){var gl=this.gl,boundTextures=this.boundTextures;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var i=0;i<boundTextures.length;i++)boundTextures[i]===this.unknownTexture&&this.bind(null,i)}for(i=0;i<boundTextures.length;i++)boundTextures[i]===texture&&(this.currentLocation!==i&&(gl.activeTexture(gl.TEXTURE0+i),this.currentLocation=i),gl.bindTexture(texture.target,this.emptyTextures[texture.target].texture),boundTextures[i]=null)},TextureSystem.prototype.ensureSamplerType=function(maxTextures){var boundTextures=this.boundTextures,hasIntegerTextures=this.hasIntegerTextures,CONTEXT_UID=this.CONTEXT_UID;if(hasIntegerTextures)for(var i=maxTextures-1;i>=0;--i){var tex=boundTextures[i];if(tex)tex._glTextures[CONTEXT_UID].samplerType!==constants_SAMPLER_TYPES.FLOAT&&this.renderer.texture.unbind(tex)}},TextureSystem.prototype.initTexture=function(texture){var glTexture=new canvas_mesh_GLTexture(this.gl.createTexture());return glTexture.dirtyId=-1,texture._glTextures[this.CONTEXT_UID]=glTexture,this.managedTextures.push(texture),texture.on("dispose",this.destroyTexture,this),glTexture},TextureSystem.prototype.initTextureType=function(texture,glTexture){var _a,_b;glTexture.internalFormat=null!==(_b=null===(_a=this.internalFormats[texture.type])||void 0===_a?void 0:_a[texture.format])&&void 0!==_b?_b:texture.format,2===this.webGLVersion&&texture.type===constants_TYPES.HALF_FLOAT?glTexture.type=this.gl.HALF_FLOAT:glTexture.type=texture.type},TextureSystem.prototype.updateTexture=function(texture){var glTexture=texture._glTextures[this.CONTEXT_UID];if(glTexture){var renderer=this.renderer;if(this.initTextureType(texture,glTexture),texture.resource&&texture.resource.upload(renderer,texture,glTexture))glTexture.samplerType!==constants_SAMPLER_TYPES.FLOAT&&(this.hasIntegerTextures=!0);else{var width=texture.realWidth,height=texture.realHeight,gl=renderer.gl;(glTexture.width!==width||glTexture.height!==height||glTexture.dirtyId<0)&&(glTexture.width=width,glTexture.height=height,gl.texImage2D(texture.target,0,glTexture.internalFormat,width,height,0,texture.format,glTexture.type,null))}texture.dirtyStyleId!==glTexture.dirtyStyleId&&this.updateTextureStyle(texture),glTexture.dirtyId=texture.dirtyId}},TextureSystem.prototype.destroyTexture=function(texture,skipRemove){var gl=this.gl;if((texture=texture.castToBaseTexture())._glTextures[this.CONTEXT_UID]&&(this.unbind(texture),gl.deleteTexture(texture._glTextures[this.CONTEXT_UID].texture),texture.off("dispose",this.destroyTexture,this),delete texture._glTextures[this.CONTEXT_UID],!skipRemove)){var i=this.managedTextures.indexOf(texture);-1!==i&&function(arr,startIdx,removeCount){var i,length=arr.length;if(!(startIdx>=length||0===removeCount)){var len=length-(removeCount=startIdx+removeCount>length?length-startIdx:removeCount);for(i=startIdx;i<len;++i)arr[i]=arr[i+removeCount];arr.length=len}}(this.managedTextures,i,1)}},TextureSystem.prototype.updateTextureStyle=function(texture){var glTexture=texture._glTextures[this.CONTEXT_UID];glTexture&&(texture.mipmap!==constants_MIPMAP_MODES.POW2&&2===this.webGLVersion||texture.isPowerOfTwo?glTexture.mipmap=texture.mipmap>=1:glTexture.mipmap=!1,2===this.webGLVersion||texture.isPowerOfTwo?glTexture.wrapMode=texture.wrapMode:glTexture.wrapMode=constants_WRAP_MODES.CLAMP,texture.resource&&texture.resource.style(this.renderer,texture,glTexture)||this.setStyle(texture,glTexture),glTexture.dirtyStyleId=texture.dirtyStyleId)},TextureSystem.prototype.setStyle=function(texture,glTexture){var gl=this.gl;if(glTexture.mipmap&&texture.mipmap!==constants_MIPMAP_MODES.ON_MANUAL&&gl.generateMipmap(texture.target),gl.texParameteri(texture.target,gl.TEXTURE_WRAP_S,glTexture.wrapMode),gl.texParameteri(texture.target,gl.TEXTURE_WRAP_T,glTexture.wrapMode),glTexture.mipmap){gl.texParameteri(texture.target,gl.TEXTURE_MIN_FILTER,texture.scaleMode===constants_SCALE_MODES.LINEAR?gl.LINEAR_MIPMAP_LINEAR:gl.NEAREST_MIPMAP_NEAREST);var anisotropicExt=this.renderer.context.extensions.anisotropicFiltering;if(anisotropicExt&&texture.anisotropicLevel>0&&texture.scaleMode===constants_SCALE_MODES.LINEAR){var level=Math.min(texture.anisotropicLevel,gl.getParameter(anisotropicExt.MAX_TEXTURE_MAX_ANISOTROPY_EXT));gl.texParameterf(texture.target,anisotropicExt.TEXTURE_MAX_ANISOTROPY_EXT,level)}}else gl.texParameteri(texture.target,gl.TEXTURE_MIN_FILTER,texture.scaleMode===constants_SCALE_MODES.LINEAR?gl.LINEAR:gl.NEAREST);gl.texParameteri(texture.target,gl.TEXTURE_MAG_FILTER,texture.scaleMode===constants_SCALE_MODES.LINEAR?gl.LINEAR:gl.NEAREST)},TextureSystem.prototype.destroy=function(){this.renderer=null},TextureSystem}(),canvas_mesh_systems={__proto__:null,FilterSystem:canvas_mesh_FilterSystem,BatchSystem:canvas_mesh_BatchSystem,ContextSystem:canvas_mesh_ContextSystem,FramebufferSystem:canvas_mesh_FramebufferSystem,GeometrySystem:canvas_mesh_GeometrySystem,MaskSystem:canvas_mesh_MaskSystem,ScissorSystem:canvas_mesh_ScissorSystem,StencilSystem:canvas_mesh_StencilSystem,ProjectionSystem:canvas_mesh_ProjectionSystem,RenderTextureSystem:canvas_mesh_RenderTextureSystem,ShaderSystem:canvas_mesh_ShaderSystem,StateSystem:canvas_mesh_StateSystem,TextureGCSystem:canvas_mesh_TextureGCSystem,TextureSystem:canvas_mesh_TextureSystem},canvas_mesh_tempMatrix$2=new canvas_mesh_Matrix,canvas_mesh_AbstractRenderer=function(_super){function AbstractRenderer(type,options){void 0===type&&(type=constants_RENDERER_TYPE.UNKNOWN);var _this=_super.call(this)||this;return options=Object.assign({},settings.RENDER_OPTIONS,options),_this.options=options,_this.type=type,_this.screen=new canvas_mesh_Rectangle(0,0,options.width,options.height),_this.view=options.view||document.createElement("canvas"),_this.resolution=options.resolution||settings.RESOLUTION,_this.useContextAlpha=options.useContextAlpha,_this.autoDensity=!!options.autoDensity,_this.preserveDrawingBuffer=options.preserveDrawingBuffer,_this.clearBeforeRender=options.clearBeforeRender,_this._backgroundColor=0,_this._backgroundColorRgba=[0,0,0,1],_this._backgroundColorString="#000000",_this.backgroundColor=options.backgroundColor||_this._backgroundColor,_this.backgroundAlpha=options.backgroundAlpha,void 0!==options.transparent&&(canvas_mesh_deprecation("6.0.0","Option transparent is deprecated, please use backgroundAlpha instead."),_this.useContextAlpha=options.transparent,_this.backgroundAlpha=options.transparent?0:1),_this._lastObjectRendered=null,_this.plugins={},_this}return canvas_mesh_extends(AbstractRenderer,_super),AbstractRenderer.prototype.initPlugins=function(staticMap){for(var o in staticMap)this.plugins[o]=new staticMap[o](this)},Object.defineProperty(AbstractRenderer.prototype,"width",{get:function(){return this.view.width},enumerable:!1,configurable:!0}),Object.defineProperty(AbstractRenderer.prototype,"height",{get:function(){return this.view.height},enumerable:!1,configurable:!0}),AbstractRenderer.prototype.resize=function(desiredScreenWidth,desiredScreenHeight){this.view.width=Math.round(desiredScreenWidth*this.resolution),this.view.height=Math.round(desiredScreenHeight*this.resolution);var screenWidth=this.view.width/this.resolution,screenHeight=this.view.height/this.resolution;this.screen.width=screenWidth,this.screen.height=screenHeight,this.autoDensity&&(this.view.style.width=screenWidth+"px",this.view.style.height=screenHeight+"px"),this.emit("resize",screenWidth,screenHeight)},AbstractRenderer.prototype.generateTexture=function(displayObject,options,resolution,region){void 0===options&&(options={}),"number"==typeof options&&(canvas_mesh_deprecation("6.1.0","generateTexture options (scaleMode, resolution, region) are now object options."),options={scaleMode:options,resolution,region});var manualRegion=options.region,textureOptions=function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&(t[p[i]]=s[p[i]])}return t}(options,["region"]);0===(region=manualRegion||displayObject.getLocalBounds(null,!0)).width&&(region.width=1),0===region.height&&(region.height=1);var renderTexture=canvas_mesh_RenderTexture.create(canvas_mesh_assign({width:region.width,height:region.height},textureOptions));return canvas_mesh_tempMatrix$2.tx=-region.x,canvas_mesh_tempMatrix$2.ty=-region.y,this.render(displayObject,{renderTexture,clear:!1,transform:canvas_mesh_tempMatrix$2,skipUpdateTransform:!!displayObject.parent}),renderTexture},AbstractRenderer.prototype.destroy=function(removeView){for(var o in this.plugins)this.plugins[o].destroy(),this.plugins[o]=null;removeView&&this.view.parentNode&&this.view.parentNode.removeChild(this.view);this.plugins=null,this.type=constants_RENDERER_TYPE.UNKNOWN,this.view=null,this.screen=null,this._tempDisplayObjectParent=null,this.options=null,this._backgroundColorRgba=null,this._backgroundColorString=null,this._lastObjectRendered=null},Object.defineProperty(AbstractRenderer.prototype,"backgroundColor",{get:function(){return this._backgroundColor},set:function(value){var hexString;this._backgroundColor=value,this._backgroundColorString=(hexString=value.toString(16),"#"+("000000".substring(0,6-hexString.length)+hexString)),function(hex,out){void 0===out&&(out=[]),out[0]=(hex>>16&255)/255,out[1]=(hex>>8&255)/255,out[2]=(255&hex)/255}(value,this._backgroundColorRgba)},enumerable:!1,configurable:!0}),Object.defineProperty(AbstractRenderer.prototype,"backgroundAlpha",{get:function(){return this._backgroundColorRgba[3]},set:function(value){this._backgroundColorRgba[3]=value},enumerable:!1,configurable:!0}),AbstractRenderer}(canvas_mesh_eventemitter3),canvas_mesh_GLBuffer=function(buffer){this.buffer=buffer||null,this.updateID=-1,this.byteLength=-1,this.refCount=0},canvas_mesh_BufferSystem=function(){function BufferSystem(renderer){this.renderer=renderer,this.managedBuffers={},this.boundBufferBases={}}return BufferSystem.prototype.destroy=function(){this.renderer=null},BufferSystem.prototype.contextChange=function(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID},BufferSystem.prototype.bind=function(buffer){var gl=this.gl,CONTEXT_UID=this.CONTEXT_UID,glBuffer=buffer._glBuffers[CONTEXT_UID]||this.createGLBuffer(buffer);gl.bindBuffer(buffer.type,glBuffer.buffer)},BufferSystem.prototype.bindBufferBase=function(buffer,index){var gl=this.gl,CONTEXT_UID=this.CONTEXT_UID;if(this.boundBufferBases[index]!==buffer){var glBuffer=buffer._glBuffers[CONTEXT_UID]||this.createGLBuffer(buffer);this.boundBufferBases[index]=buffer,gl.bindBufferBase(gl.UNIFORM_BUFFER,index,glBuffer.buffer)}},BufferSystem.prototype.bindBufferRange=function(buffer,index,offset){var gl=this.gl,CONTEXT_UID=this.CONTEXT_UID;offset=offset||0;var glBuffer=buffer._glBuffers[CONTEXT_UID]||this.createGLBuffer(buffer);gl.bindBufferRange(gl.UNIFORM_BUFFER,index||0,glBuffer.buffer,256*offset,256)},BufferSystem.prototype.update=function(buffer){var gl=this.gl,CONTEXT_UID=this.CONTEXT_UID,glBuffer=buffer._glBuffers[CONTEXT_UID];if(buffer._updateID!==glBuffer.updateID)if(glBuffer.updateID=buffer._updateID,gl.bindBuffer(buffer.type,glBuffer.buffer),glBuffer.byteLength>=buffer.data.byteLength)gl.bufferSubData(buffer.type,0,buffer.data);else{var drawType=buffer.static?gl.STATIC_DRAW:gl.DYNAMIC_DRAW;glBuffer.byteLength=buffer.data.byteLength,gl.bufferData(buffer.type,buffer.data,drawType)}},BufferSystem.prototype.dispose=function(buffer,contextLost){if(this.managedBuffers[buffer.id]){delete this.managedBuffers[buffer.id];var glBuffer=buffer._glBuffers[this.CONTEXT_UID],gl=this.gl;buffer.disposeRunner.remove(this),glBuffer&&(contextLost||gl.deleteBuffer(glBuffer.buffer),delete buffer._glBuffers[this.CONTEXT_UID])}},BufferSystem.prototype.disposeAll=function(contextLost){for(var all=Object.keys(this.managedBuffers),i=0;i<all.length;i++)this.dispose(this.managedBuffers[all[i]],contextLost)},BufferSystem.prototype.createGLBuffer=function(buffer){var CONTEXT_UID=this.CONTEXT_UID,gl=this.gl;return buffer._glBuffers[CONTEXT_UID]=new canvas_mesh_GLBuffer(gl.createBuffer()),this.managedBuffers[buffer.id]=buffer,buffer.disposeRunner.add(this),buffer._glBuffers[CONTEXT_UID]},BufferSystem}(),canvas_mesh_BatchDrawCall=(function(_super){function Renderer(options){var _this=_super.call(this,constants_RENDERER_TYPE.WEBGL,options)||this;return options=_this.options,_this.gl=null,_this.CONTEXT_UID=0,_this.runners={destroy:new canvas_mesh_Runner("destroy"),contextChange:new canvas_mesh_Runner("contextChange"),reset:new canvas_mesh_Runner("reset"),update:new canvas_mesh_Runner("update"),postrender:new canvas_mesh_Runner("postrender"),prerender:new canvas_mesh_Runner("prerender"),resize:new canvas_mesh_Runner("resize")},_this.runners.contextChange.add(_this),_this.globalUniforms=new canvas_mesh_UniformGroup({projectionMatrix:new canvas_mesh_Matrix},!0),_this.addSystem(canvas_mesh_MaskSystem,"mask").addSystem(canvas_mesh_ContextSystem,"context").addSystem(canvas_mesh_StateSystem,"state").addSystem(canvas_mesh_ShaderSystem,"shader").addSystem(canvas_mesh_TextureSystem,"texture").addSystem(canvas_mesh_BufferSystem,"buffer").addSystem(canvas_mesh_GeometrySystem,"geometry").addSystem(canvas_mesh_FramebufferSystem,"framebuffer").addSystem(canvas_mesh_ScissorSystem,"scissor").addSystem(canvas_mesh_StencilSystem,"stencil").addSystem(canvas_mesh_ProjectionSystem,"projection").addSystem(canvas_mesh_TextureGCSystem,"textureGC").addSystem(canvas_mesh_FilterSystem,"filter").addSystem(canvas_mesh_RenderTextureSystem,"renderTexture").addSystem(canvas_mesh_BatchSystem,"batch"),_this.initPlugins(Renderer.__plugins),_this.multisample=void 0,options.context?_this.context.initFromContext(options.context):_this.context.initFromOptions({alpha:!!_this.useContextAlpha,antialias:options.antialias,premultipliedAlpha:_this.useContextAlpha&&"notMultiplied"!==_this.useContextAlpha,stencil:!0,preserveDrawingBuffer:options.preserveDrawingBuffer,powerPreference:_this.options.powerPreference}),_this.renderingToScreen=!0,function(type){var _a;if(!canvas_mesh_saidHello){if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var args=["\n %c %c %c PixiJS 6.3.0 -  "+type+"   %c  %c  http://www.pixijs.com/  %c %c %c%c \n\n","background: #ff66a5; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff66a5; background: #030307; padding:5px 0;","background: #ff66a5; padding:5px 0;","background: #ffc3dc; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;"];(_a=globalThis.console).log.apply(_a,args)}else globalThis.console&&globalThis.console.log("PixiJS 6.3.0 - "+type+" - http://www.pixijs.com/");canvas_mesh_saidHello=!0}}(2===_this.context.webGLVersion?"WebGL 2":"WebGL 1"),_this.resize(_this.options.width,_this.options.height),_this}canvas_mesh_extends(Renderer,_super),Renderer.create=function(options){if(void 0===canvas_mesh_supported&&(canvas_mesh_supported=function(){var contextOptions={stencil:!0,failIfMajorPerformanceCaveat:settings.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!globalThis.WebGLRenderingContext)return!1;var canvas=document.createElement("canvas"),gl=canvas.getContext("webgl",contextOptions)||canvas.getContext("experimental-webgl",contextOptions),success=!(!gl||!gl.getContextAttributes().stencil);if(gl){var loseContext=gl.getExtension("WEBGL_lose_context");loseContext&&loseContext.loseContext()}return gl=null,success}catch(e){return!1}}()),canvas_mesh_supported)return new Renderer(options);throw new Error('WebGL unsupported in this browser, use "pixi.js-legacy" for fallback canvas2d support.')},Renderer.prototype.contextChange=function(){var samples,gl=this.gl;if(1===this.context.webGLVersion){var framebuffer=gl.getParameter(gl.FRAMEBUFFER_BINDING);gl.bindFramebuffer(gl.FRAMEBUFFER,null),samples=gl.getParameter(gl.SAMPLES),gl.bindFramebuffer(gl.FRAMEBUFFER,framebuffer)}else{framebuffer=gl.getParameter(gl.DRAW_FRAMEBUFFER_BINDING);gl.bindFramebuffer(gl.DRAW_FRAMEBUFFER,null),samples=gl.getParameter(gl.SAMPLES),gl.bindFramebuffer(gl.DRAW_FRAMEBUFFER,framebuffer)}samples>=constants_MSAA_QUALITY.HIGH?this.multisample=constants_MSAA_QUALITY.HIGH:samples>=constants_MSAA_QUALITY.MEDIUM?this.multisample=constants_MSAA_QUALITY.MEDIUM:samples>=constants_MSAA_QUALITY.LOW?this.multisample=constants_MSAA_QUALITY.LOW:this.multisample=constants_MSAA_QUALITY.NONE},Renderer.prototype.addSystem=function(ClassRef,name){var system=new ClassRef(this);if(this[name])throw new Error('Whoops! The name "'+name+'" is already in use');for(var i in this[name]=system,this.runners)this.runners[i].add(system);return this},Renderer.prototype.render=function(displayObject,options){var renderTexture,clear,transform,skipUpdateTransform;if(options&&(options instanceof canvas_mesh_RenderTexture?(canvas_mesh_deprecation("6.0.0","Renderer#render arguments changed, use options instead."),renderTexture=options,clear=arguments[2],transform=arguments[3],skipUpdateTransform=arguments[4]):(renderTexture=options.renderTexture,clear=options.clear,transform=options.transform,skipUpdateTransform=options.skipUpdateTransform)),this.renderingToScreen=!renderTexture,this.runners.prerender.emit(),this.emit("prerender"),this.projection.transform=transform,!this.context.isLost){if(renderTexture||(this._lastObjectRendered=displayObject),!skipUpdateTransform){var cacheParent=displayObject.enableTempParent();displayObject.updateTransform(),displayObject.disableTempParent(cacheParent)}this.renderTexture.bind(renderTexture),this.batch.currentRenderer.start(),(void 0!==clear?clear:this.clearBeforeRender)&&this.renderTexture.clear(),displayObject.render(this),this.batch.currentRenderer.flush(),renderTexture&&renderTexture.baseTexture.update(),this.runners.postrender.emit(),this.projection.transform=null,this.emit("postrender")}},Renderer.prototype.generateTexture=function(displayObject,options,resolution,region){void 0===options&&(options={});var renderTexture=_super.prototype.generateTexture.call(this,displayObject,options,resolution,region);return this.framebuffer.blit(),renderTexture},Renderer.prototype.resize=function(desiredScreenWidth,desiredScreenHeight){_super.prototype.resize.call(this,desiredScreenWidth,desiredScreenHeight),this.runners.resize.emit(this.screen.height,this.screen.width)},Renderer.prototype.reset=function(){return this.runners.reset.emit(),this},Renderer.prototype.clear=function(){this.renderTexture.bind(),this.renderTexture.clear()},Renderer.prototype.destroy=function(removeView){for(var r in this.runners.destroy.emit(),this.runners)this.runners[r].destroy();_super.prototype.destroy.call(this,removeView),this.gl=null},Object.defineProperty(Renderer.prototype,"extract",{get:function(){return canvas_mesh_deprecation("6.0.0","Renderer#extract has been deprecated, please use Renderer#plugins.extract instead."),this.plugins.extract},enumerable:!1,configurable:!0}),Renderer.registerPlugin=function(pluginName,ctor){Renderer.__plugins=Renderer.__plugins||{},Renderer.__plugins[pluginName]=ctor}}(canvas_mesh_AbstractRenderer),function(){this.texArray=null,this.blend=0,this.type=constants_DRAW_MODES.TRIANGLES,this.start=0,this.size=0,this.data=null}),canvas_mesh_BatchTextureArray=function(){function BatchTextureArray(){this.elements=[],this.ids=[],this.count=0}return BatchTextureArray.prototype.clear=function(){for(var i=0;i<this.count;i++)this.elements[i]=null;this.count=0},BatchTextureArray}(),canvas_mesh_ViewableBuffer=function(){function ViewableBuffer(sizeOrBuffer){"number"==typeof sizeOrBuffer?this.rawBinaryData=new ArrayBuffer(sizeOrBuffer):sizeOrBuffer instanceof Uint8Array?this.rawBinaryData=sizeOrBuffer.buffer:this.rawBinaryData=sizeOrBuffer,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}return Object.defineProperty(ViewableBuffer.prototype,"int8View",{get:function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View},enumerable:!1,configurable:!0}),Object.defineProperty(ViewableBuffer.prototype,"uint8View",{get:function(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View},enumerable:!1,configurable:!0}),Object.defineProperty(ViewableBuffer.prototype,"int16View",{get:function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View},enumerable:!1,configurable:!0}),Object.defineProperty(ViewableBuffer.prototype,"uint16View",{get:function(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View},enumerable:!1,configurable:!0}),Object.defineProperty(ViewableBuffer.prototype,"int32View",{get:function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View},enumerable:!1,configurable:!0}),ViewableBuffer.prototype.view=function(type){return this[type+"View"]},ViewableBuffer.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},ViewableBuffer.sizeOf=function(type){switch(type){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(type+" isn't a valid view type")}},ViewableBuffer}(),canvas_mesh_AbstractBatchRenderer=function(_super){function AbstractBatchRenderer(renderer){var _this=_super.call(this,renderer)||this;return _this.shaderGenerator=null,_this.geometryClass=null,_this.vertexSize=null,_this.state=canvas_mesh_State.for2d(),_this.size=4*settings.SPRITE_BATCH_SIZE,_this._vertexCount=0,_this._indexCount=0,_this._bufferedElements=[],_this._bufferedTextures=[],_this._bufferSize=0,_this._shader=null,_this._packedGeometries=[],_this._packedGeometryPoolSize=2,_this._flushId=0,_this._aBuffers={},_this._iBuffers={},_this.MAX_TEXTURES=1,_this.renderer.on("prerender",_this.onPrerender,_this),renderer.runners.contextChange.add(_this),_this._dcIndex=0,_this._aIndex=0,_this._iIndex=0,_this._attributeBuffer=null,_this._indexBuffer=null,_this._tempBoundTextures=[],_this}return canvas_mesh_extends(AbstractBatchRenderer,_super),AbstractBatchRenderer.prototype.contextChange=function(){var gl=this.renderer.gl;settings.PREFER_ENV===constants_ENV.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(gl.getParameter(gl.MAX_TEXTURE_IMAGE_UNITS),settings.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=function(maxIfs,gl){if(0===maxIfs)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var shader=gl.createShader(gl.FRAGMENT_SHADER);;){var fragmentSrc=canvas_mesh_fragTemplate.replace(/%forloop%/gi,canvas_mesh_generateIfTestSrc(maxIfs));if(gl.shaderSource(shader,fragmentSrc),gl.compileShader(shader),gl.getShaderParameter(shader,gl.COMPILE_STATUS))break;maxIfs=maxIfs/2|0}return maxIfs}(this.MAX_TEXTURES,gl)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var i=0;i<this._packedGeometryPoolSize;i++)this._packedGeometries[i]=new this.geometryClass;this.initFlushBuffers()},AbstractBatchRenderer.prototype.initFlushBuffers=function(){for(var _drawCallPool=AbstractBatchRenderer._drawCallPool,_textureArrayPool=AbstractBatchRenderer._textureArrayPool,MAX_SPRITES=this.size/4,MAX_TA=Math.floor(MAX_SPRITES/this.MAX_TEXTURES)+1;_drawCallPool.length<MAX_SPRITES;)_drawCallPool.push(new canvas_mesh_BatchDrawCall);for(;_textureArrayPool.length<MAX_TA;)_textureArrayPool.push(new canvas_mesh_BatchTextureArray);for(var i=0;i<this.MAX_TEXTURES;i++)this._tempBoundTextures[i]=null},AbstractBatchRenderer.prototype.onPrerender=function(){this._flushId=0},AbstractBatchRenderer.prototype.render=function(element){element._texture.valid&&(this._vertexCount+element.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=element.vertexData.length/2,this._indexCount+=element.indices.length,this._bufferedTextures[this._bufferSize]=element._texture.baseTexture,this._bufferedElements[this._bufferSize++]=element)},AbstractBatchRenderer.prototype.buildTexturesAndDrawCalls=function(){var textures=this._bufferedTextures,MAX_TEXTURES=this.MAX_TEXTURES,textureArrays=AbstractBatchRenderer._textureArrayPool,batch=this.renderer.batch,boundTextures=this._tempBoundTextures,touch=this.renderer.textureGC.count,TICK=++canvas_mesh_BaseTexture._globalBatch,countTexArrays=0,texArray=textureArrays[0],start=0;batch.copyBoundTextures(boundTextures,MAX_TEXTURES);for(var i=0;i<this._bufferSize;++i){var tex=textures[i];textures[i]=null,tex._batchEnabled!==TICK&&(texArray.count>=MAX_TEXTURES&&(batch.boundArray(texArray,boundTextures,TICK,MAX_TEXTURES),this.buildDrawCalls(texArray,start,i),start=i,texArray=textureArrays[++countTexArrays],++TICK),tex._batchEnabled=TICK,tex.touched=touch,texArray.elements[texArray.count++]=tex)}texArray.count>0&&(batch.boundArray(texArray,boundTextures,TICK,MAX_TEXTURES),this.buildDrawCalls(texArray,start,this._bufferSize),++countTexArrays,++TICK);for(i=0;i<boundTextures.length;i++)boundTextures[i]=null;canvas_mesh_BaseTexture._globalBatch=TICK},AbstractBatchRenderer.prototype.buildDrawCalls=function(texArray,start,finish){var elements=this._bufferedElements,_attributeBuffer=this._attributeBuffer,_indexBuffer=this._indexBuffer,vertexSize=this.vertexSize,drawCalls=AbstractBatchRenderer._drawCallPool,dcIndex=this._dcIndex,aIndex=this._aIndex,iIndex=this._iIndex,drawCall=drawCalls[dcIndex];drawCall.start=this._iIndex,drawCall.texArray=texArray;for(var i=start;i<finish;++i){var sprite=elements[i],tex=sprite._texture.baseTexture,spriteBlendMode=canvas_mesh_premultiplyBlendMode[tex.alphaMode?1:0][sprite.blendMode];elements[i]=null,start<i&&drawCall.blend!==spriteBlendMode&&(drawCall.size=iIndex-drawCall.start,start=i,(drawCall=drawCalls[++dcIndex]).texArray=texArray,drawCall.start=iIndex),this.packInterleavedGeometry(sprite,_attributeBuffer,_indexBuffer,aIndex,iIndex),aIndex+=sprite.vertexData.length/2*vertexSize,iIndex+=sprite.indices.length,drawCall.blend=spriteBlendMode}start<finish&&(drawCall.size=iIndex-drawCall.start,++dcIndex),this._dcIndex=dcIndex,this._aIndex=aIndex,this._iIndex=iIndex},AbstractBatchRenderer.prototype.bindAndClearTexArray=function(texArray){for(var textureSystem=this.renderer.texture,j=0;j<texArray.count;j++)textureSystem.bind(texArray.elements[j],texArray.ids[j]),texArray.elements[j]=null;texArray.count=0},AbstractBatchRenderer.prototype.updateGeometry=function(){var packedGeometries=this._packedGeometries,attributeBuffer=this._attributeBuffer,indexBuffer=this._indexBuffer;settings.CAN_UPLOAD_SAME_BUFFER?(packedGeometries[this._flushId]._buffer.update(attributeBuffer.rawBinaryData),packedGeometries[this._flushId]._indexBuffer.update(indexBuffer),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,packedGeometries[this._flushId]=new this.geometryClass),packedGeometries[this._flushId]._buffer.update(attributeBuffer.rawBinaryData),packedGeometries[this._flushId]._indexBuffer.update(indexBuffer),this.renderer.geometry.bind(packedGeometries[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)},AbstractBatchRenderer.prototype.drawBatches=function(){for(var dcCount=this._dcIndex,_a=this.renderer,gl=_a.gl,stateSystem=_a.state,drawCalls=AbstractBatchRenderer._drawCallPool,curTexArray=null,i=0;i<dcCount;i++){var _b=drawCalls[i],texArray=_b.texArray,type=_b.type,size=_b.size,start=_b.start,blend=_b.blend;curTexArray!==texArray&&(curTexArray=texArray,this.bindAndClearTexArray(texArray)),this.state.blendMode=blend,stateSystem.set(this.state),gl.drawElements(type,size,gl.UNSIGNED_SHORT,2*start)}},AbstractBatchRenderer.prototype.flush=function(){0!==this._vertexCount&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)},AbstractBatchRenderer.prototype.start=function(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.MAX_TEXTURES),this.renderer.shader.bind(this._shader),settings.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])},AbstractBatchRenderer.prototype.stop=function(){this.flush()},AbstractBatchRenderer.prototype.destroy=function(){for(var i=0;i<this._packedGeometryPoolSize;i++)this._packedGeometries[i]&&this._packedGeometries[i].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),_super.prototype.destroy.call(this)},AbstractBatchRenderer.prototype.getAttributeBuffer=function(size){var roundedP2=canvas_mesh_nextPow2(Math.ceil(size/8)),roundedSizeIndex=canvas_mesh_log2(roundedP2),roundedSize=8*roundedP2;this._aBuffers.length<=roundedSizeIndex&&(this._iBuffers.length=roundedSizeIndex+1);var buffer=this._aBuffers[roundedSize];return buffer||(this._aBuffers[roundedSize]=buffer=new canvas_mesh_ViewableBuffer(roundedSize*this.vertexSize*4)),buffer},AbstractBatchRenderer.prototype.getIndexBuffer=function(size){var roundedP2=canvas_mesh_nextPow2(Math.ceil(size/12)),roundedSizeIndex=canvas_mesh_log2(roundedP2),roundedSize=12*roundedP2;this._iBuffers.length<=roundedSizeIndex&&(this._iBuffers.length=roundedSizeIndex+1);var buffer=this._iBuffers[roundedSizeIndex];return buffer||(this._iBuffers[roundedSizeIndex]=buffer=new Uint16Array(roundedSize)),buffer},AbstractBatchRenderer.prototype.packInterleavedGeometry=function(element,attributeBuffer,indexBuffer,aIndex,iIndex){for(var uint32View=attributeBuffer.uint32View,float32View=attributeBuffer.float32View,packedVertices=aIndex/this.vertexSize,uvs=element.uvs,indicies=element.indices,vertexData=element.vertexData,textureId=element._texture.baseTexture._batchLocation,alpha=Math.min(element.worldAlpha,1),argb=alpha<1&&element._texture.baseTexture.alphaMode?function(tint,alpha){if(1===alpha)return(255*alpha<<24)+tint;if(0===alpha)return 0;var R=tint>>16&255,G=tint>>8&255,B=255&tint;return(255*alpha<<24)+((R=R*alpha+.5|0)<<16)+((G=G*alpha+.5|0)<<8)+(B*alpha+.5|0)}(element._tintRGB,alpha):element._tintRGB+(255*alpha<<24),i=0;i<vertexData.length;i+=2)float32View[aIndex++]=vertexData[i],float32View[aIndex++]=vertexData[i+1],float32View[aIndex++]=uvs[i],float32View[aIndex++]=uvs[i+1],uint32View[aIndex++]=argb,float32View[aIndex++]=textureId;for(i=0;i<indicies.length;i++)indexBuffer[iIndex++]=packedVertices+indicies[i]},AbstractBatchRenderer._drawCallPool=[],AbstractBatchRenderer._textureArrayPool=[],AbstractBatchRenderer}(canvas_mesh_ObjectRenderer),canvas_mesh_BatchShaderGenerator=function(){function BatchShaderGenerator(vertexSrc,fragTemplate){if(this.vertexSrc=vertexSrc,this.fragTemplate=fragTemplate,this.programCache={},this.defaultGroupCache={},fragTemplate.indexOf("%count%")<0)throw new Error('Fragment template must contain "%count%".');if(fragTemplate.indexOf("%forloop%")<0)throw new Error('Fragment template must contain "%forloop%".')}return BatchShaderGenerator.prototype.generateShader=function(maxTextures){if(!this.programCache[maxTextures]){for(var sampleValues=new Int32Array(maxTextures),i=0;i<maxTextures;i++)sampleValues[i]=i;this.defaultGroupCache[maxTextures]=canvas_mesh_UniformGroup.from({uSamplers:sampleValues},!0);var fragmentSrc=this.fragTemplate;fragmentSrc=(fragmentSrc=fragmentSrc.replace(/%count%/gi,""+maxTextures)).replace(/%forloop%/gi,this.generateSampleSrc(maxTextures)),this.programCache[maxTextures]=new canvas_mesh_Program(this.vertexSrc,fragmentSrc)}var uniforms={tint:new Float32Array([1,1,1,1]),translationMatrix:new canvas_mesh_Matrix,default:this.defaultGroupCache[maxTextures]};return new canvas_mesh_Shader(this.programCache[maxTextures],uniforms)},BatchShaderGenerator.prototype.generateSampleSrc=function(maxTextures){var src="";src+="\n",src+="\n";for(var i=0;i<maxTextures;i++)i>0&&(src+="\nelse "),i<maxTextures-1&&(src+="if(vTextureId < "+i+".5)"),src+="\n{",src+="\n\tcolor = texture2D(uSamplers["+i+"], vTextureCoord);",src+="\n}";return src+="\n",src+="\n"},BatchShaderGenerator}(),canvas_mesh_BatchGeometry=function(_super){function BatchGeometry(_static){void 0===_static&&(_static=!1);var _this=_super.call(this)||this;return _this._buffer=new canvas_mesh_Buffer(null,_static,!1),_this._indexBuffer=new canvas_mesh_Buffer(null,_static,!0),_this.addAttribute("aVertexPosition",_this._buffer,2,!1,constants_TYPES.FLOAT).addAttribute("aTextureCoord",_this._buffer,2,!1,constants_TYPES.FLOAT).addAttribute("aColor",_this._buffer,4,!0,constants_TYPES.UNSIGNED_BYTE).addAttribute("aTextureId",_this._buffer,1,!0,constants_TYPES.FLOAT).addIndex(_this._indexBuffer),_this}return canvas_mesh_extends(BatchGeometry,_super),BatchGeometry}(canvas_mesh_Geometry),canvas_mesh_defaultVertex$3="precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n",canvas_mesh_defaultFragment$2="varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = color * vColor;\n}\n",canvas_mesh_BatchPluginFactory=function(){function BatchPluginFactory(){}return BatchPluginFactory.create=function(options){var _a=Object.assign({vertex:canvas_mesh_defaultVertex$3,fragment:canvas_mesh_defaultFragment$2,geometryClass:canvas_mesh_BatchGeometry,vertexSize:6},options),vertex=_a.vertex,fragment=_a.fragment,vertexSize=_a.vertexSize,geometryClass=_a.geometryClass;return function(_super){function BatchPlugin(renderer){var _this=_super.call(this,renderer)||this;return _this.shaderGenerator=new canvas_mesh_BatchShaderGenerator(vertex,fragment),_this.geometryClass=geometryClass,_this.vertexSize=vertexSize,_this}return canvas_mesh_extends(BatchPlugin,_super),BatchPlugin}(canvas_mesh_AbstractBatchRenderer)},Object.defineProperty(BatchPluginFactory,"defaultVertexSrc",{get:function(){return canvas_mesh_defaultVertex$3},enumerable:!1,configurable:!0}),Object.defineProperty(BatchPluginFactory,"defaultFragmentTemplate",{get:function(){return canvas_mesh_defaultFragment$2},enumerable:!1,configurable:!0}),BatchPluginFactory}(),esm_canvas_mesh_resources=(canvas_mesh_BatchPluginFactory.create(),{}),canvas_mesh_loop_1=function(name){Object.defineProperty(esm_canvas_mesh_resources,name,{get:function(){return canvas_mesh_deprecation("6.0.0","PIXI.systems."+name+" has moved to PIXI."+name),canvas_mesh_resources[name]}})};for(var canvas_mesh_name in canvas_mesh_resources)canvas_mesh_loop_1(canvas_mesh_name);var esm_canvas_mesh_systems={},canvas_mesh_loop_2=function(name){Object.defineProperty(esm_canvas_mesh_systems,name,{get:function(){return canvas_mesh_deprecation("6.0.0","PIXI.resources."+name+" has moved to PIXI."+name),canvas_mesh_systems[name]}})};for(var canvas_mesh_name in canvas_mesh_systems)canvas_mesh_loop_2(canvas_mesh_name);var CanvasMeshRenderer=function(){function CanvasMeshRenderer(renderer){this.renderer=renderer}return CanvasMeshRenderer.prototype.render=function(mesh){var renderer=this.renderer,transform=mesh.worldTransform;renderer.context.globalAlpha=mesh.worldAlpha,renderer.setBlendMode(mesh.blendMode),renderer.setContextTransform(transform,mesh.roundPixels),mesh.drawMode!==constants_DRAW_MODES.TRIANGLES?this._renderTriangleMesh(mesh):this._renderTriangles(mesh)},CanvasMeshRenderer.prototype._renderTriangleMesh=function(mesh){for(var length=mesh.geometry.buffers[0].data.length,i=0;i<length-2;i++){var index=2*i;this._renderDrawTriangle(mesh,index,index+2,index+4)}},CanvasMeshRenderer.prototype._renderTriangles=function(mesh){for(var indices=mesh.geometry.getIndex().data,length=indices.length,i=0;i<length;i+=3){var index0=2*indices[i],index1=2*indices[i+1],index2=2*indices[i+2];this._renderDrawTriangle(mesh,index0,index1,index2)}},CanvasMeshRenderer.prototype._renderDrawTriangle=function(mesh,index0,index1,index2){var context=this.renderer.context,vertices=mesh.geometry.buffers[0].data,uvs=mesh.uvs,texture=mesh.texture;if(texture.valid){var isTinted=16777215!==mesh.tint,base=texture.baseTexture,textureWidth=base.width,textureHeight=base.height;isTinted&&mesh._cachedTint!==mesh.tint&&(mesh._cachedTint=mesh.tint,mesh._cachedTexture=mesh._cachedTexture||new canvas_mesh_Texture(base),mesh._tintedCanvas=canvasUtils.getTintedCanvas({texture:mesh._cachedTexture},mesh.tint));var textureSource=isTinted?mesh._tintedCanvas:base.getDrawableSource(),u0=uvs[index0]*base.width,u1=uvs[index1]*base.width,u2=uvs[index2]*base.width,v0=uvs[index0+1]*base.height,v1=uvs[index1+1]*base.height,v2=uvs[index2+1]*base.height,x0=vertices[index0],x1=vertices[index1],x2=vertices[index2],y0=vertices[index0+1],y1=vertices[index1+1],y2=vertices[index2+1],screenPadding=mesh.canvasPadding/this.renderer.resolution;if(screenPadding>0){var _a=mesh.worldTransform,a=_a.a,b=_a.b,c=_a.c,d=_a.d,centerX=(x0+x1+x2)/3,centerY=(y0+y1+y2)/3,normX=x0-centerX,normY=y0-centerY,screenX=a*normX+c*normY,screenY=b*normX+d*normY,screenDist=Math.sqrt(screenX*screenX+screenY*screenY),paddingFactor=1+screenPadding/screenDist;x0=centerX+normX*paddingFactor,y0=centerY+normY*paddingFactor,screenX=a*(normX=x1-centerX)+c*(normY=y1-centerY),screenY=b*normX+d*normY,x1=centerX+normX*(paddingFactor=1+screenPadding/(screenDist=Math.sqrt(screenX*screenX+screenY*screenY))),y1=centerY+normY*paddingFactor,screenX=a*(normX=x2-centerX)+c*(normY=y2-centerY),screenY=b*normX+d*normY,x2=centerX+normX*(paddingFactor=1+screenPadding/(screenDist=Math.sqrt(screenX*screenX+screenY*screenY))),y2=centerY+normY*paddingFactor}context.save(),context.beginPath(),context.moveTo(x0,y0),context.lineTo(x1,y1),context.lineTo(x2,y2),context.closePath(),context.clip();var delta=u0*v1+v0*u2+u1*v2-v1*u2-v0*u1-u0*v2,deltaA=x0*v1+v0*x2+x1*v2-v1*x2-v0*x1-x0*v2,deltaB=u0*x1+x0*u2+u1*x2-x1*u2-x0*u1-u0*x2,deltaC=u0*v1*x2+v0*x1*u2+x0*u1*v2-x0*v1*u2-v0*u1*x2-u0*x1*v2,deltaD=y0*v1+v0*y2+y1*v2-v1*y2-v0*y1-y0*v2,deltaE=u0*y1+y0*u2+u1*y2-y1*u2-y0*u1-u0*y2,deltaF=u0*v1*y2+v0*y1*u2+y0*u1*v2-y0*v1*u2-v0*u1*y2-u0*y1*v2;context.transform(deltaA/delta,deltaD/delta,deltaB/delta,deltaE/delta,deltaC/delta,deltaF/delta),context.drawImage(textureSource,0,0,textureWidth*base.resolution,textureHeight*base.resolution,0,0,textureWidth,textureHeight),context.restore(),this.renderer.invalidateBlendMode()}},CanvasMeshRenderer.prototype.renderMeshFlat=function(mesh){var context=this.renderer.context,vertices=mesh.geometry.getBuffer("aVertexPosition").data,length=vertices.length/2;context.beginPath();for(var i=1;i<length-2;++i){var index=2*i,x0=vertices[index],y0=vertices[index+1],x1=vertices[index+2],y1=vertices[index+3],x2=vertices[index+4],y2=vertices[index+5];context.moveTo(x0,y0),context.lineTo(x1,y1),context.lineTo(x2,y2)}context.fillStyle="#FF0000",context.fill(),context.closePath()},CanvasMeshRenderer.prototype.destroy=function(){this.renderer=null},CanvasMeshRenderer}();settings.MESH_CANVAS_PADDING=0,MeshMaterial.prototype._renderCanvas=function(renderer,mesh){renderer.plugins.mesh.render(mesh)},NineSlicePlane.prototype._cachedTint=16777215,NineSlicePlane.prototype._tintedCanvas=null,NineSlicePlane.prototype._canvasUvs=null,NineSlicePlane.prototype._renderCanvas=function(renderer){var context=renderer.context,transform=this.worldTransform,isTinted=16777215!==this.tint,texture=this.texture;if(texture.valid){isTinted&&this._cachedTint!==this.tint&&(this._cachedTint=this.tint,this._tintedCanvas=canvasUtils.getTintedCanvas(this,this.tint));var textureSource=isTinted?this._tintedCanvas:texture.baseTexture.getDrawableSource();this._canvasUvs||(this._canvasUvs=[0,0,0,0,0,0,0,0]);var vertices=this.vertices,uvs=this._canvasUvs,u0=isTinted?0:texture.frame.x,v0=isTinted?0:texture.frame.y,u1=u0+texture.frame.width,v1=v0+texture.frame.height;uvs[0]=u0,uvs[1]=u0+this._leftWidth,uvs[2]=u1-this._rightWidth,uvs[3]=u1,uvs[4]=v0,uvs[5]=v0+this._topHeight,uvs[6]=v1-this._bottomHeight,uvs[7]=v1;for(var i=0;i<8;i++)uvs[i]*=texture.baseTexture.resolution;context.globalAlpha=this.worldAlpha,renderer.setBlendMode(this.blendMode),renderer.setContextTransform(transform,this.roundPixels);for(var row=0;row<3;row++)for(var col=0;col<3;col++){var ind=2*col+8*row,sw=Math.max(1,uvs[col+1]-uvs[col]),sh=Math.max(1,uvs[row+5]-uvs[row+4]),dw=Math.max(1,vertices[ind+10]-vertices[ind]),dh=Math.max(1,vertices[ind+11]-vertices[ind+1]);context.drawImage(textureSource,uvs[col],uvs[row+4],sw,sh,vertices[ind],vertices[ind+1],dw,dh)}}};var warned=!1;Mesh.prototype._cachedTint=16777215,Mesh.prototype._tintedCanvas=null,Mesh.prototype._cachedTexture=null,Mesh.prototype._renderCanvas=function(renderer){this.shader.uvMatrix&&(this.shader.uvMatrix.update(),this.calculateUvs()),this.material._renderCanvas?this.material._renderCanvas(renderer,this):warned||(warned=!0,globalThis.console&&console.warn("Mesh with custom shaders are not supported in CanvasRenderer."))},Mesh.prototype._canvasPadding=null,Object.defineProperty(Mesh.prototype,"canvasPadding",{get:function(){return null!==this._canvasPadding?this._canvasPadding:settings.MESH_CANVAS_PADDING},set:function(value){this._canvasPadding=value}}),SimpleMesh.prototype._renderCanvas=function(renderer){this.autoUpdate&&this.geometry.getBuffer("aVertexPosition").update(),this.shader.update&&this.shader.update(),this.calculateUvs(),this.material._renderCanvas(renderer,this)},SimpleRope.prototype._renderCanvas=function(renderer){(this.autoUpdate||this.geometry._width!==this.shader.texture.height)&&(this.geometry._width=this.shader.texture.height,this.geometry.update()),this.shader.update&&this.shader.update(),this.calculateUvs(),this.material._renderCanvas(renderer,this)};var canvasRenderer,PolygonUtils=function(){function PolygonUtils(){}return PolygonUtils.offsetPolygon=function(points,offset){var offsetPoints=[],length=points.length;offset=PolygonUtils.isPolygonClockwise(points)?offset:-1*offset;for(var j=0;j<length;j+=2){var i=j-2;i<0&&(i+=length);var k=(j+2)%length,v1x=points[j]-points[i],v1y=points[j+1]-points[i+1],len=Math.sqrt(v1x*v1x+v1y*v1y);v1x/=len,v1y/=len;var norm1x=-(v1y*=offset),norm1y=v1x*=offset,pij1=[points[i]+norm1x,points[i+1]+norm1y],pij2=[points[j]+norm1x,points[j+1]+norm1y],v2x=points[k]-points[j],v2y=points[k+1]-points[j+1];v2x/=len=Math.sqrt(v2x*v2x+v2y*v2y),v2y/=len;var norm2x=-(v2y*=offset),norm2y=v2x*=offset,pjk1=[points[j]+norm2x,points[j+1]+norm2y],pjk2=[points[k]+norm2x,points[k+1]+norm2y],intersectPoint=PolygonUtils.findIntersection(pij1[0],pij1[1],pij2[0],pij2[1],pjk1[0],pjk1[1],pjk2[0],pjk2[1]);intersectPoint&&offsetPoints.push.apply(offsetPoints,intersectPoint)}return offsetPoints},PolygonUtils.findIntersection=function(x1,y1,x2,y2,x3,y3,x4,y4){var denominator=(y4-y3)*(x2-x1)-(x4-x3)*(y2-y1),numeratorA=(x4-x3)*(y1-y3)-(y4-y3)*(x1-x3);if(0===denominator)return 0===numeratorA&&0===(x2-x1)*(y1-y3)-(y2-y1)*(x1-x3)?[(x1+x2)/2,(y1+y2)/2]:null;var uA=numeratorA/denominator;return[x1+uA*(x2-x1),y1+uA*(y2-y1)]},PolygonUtils.isPolygonClockwise=function(polygon){for(var sum=0,i=0,j=polygon.length-2;i<polygon.length;j=i,i+=2)sum+=(polygon[i]-polygon[j])*(polygon[i+1]+polygon[j+1]);return sum>0},PolygonUtils}(),CanvasGraphicsRenderer=function(){function CanvasGraphicsRenderer(renderer){this._svgMatrix=null,this._tempMatrix=new Matrix,this.renderer=renderer}return CanvasGraphicsRenderer.prototype._calcCanvasStyle=function(style,tint){var res;return style.texture&&style.texture.baseTexture!==Texture.WHITE.baseTexture?style.texture.valid?(res=canvasUtils.getTintedPattern(style.texture,tint),this.setPatternTransform(res,style.matrix||Matrix.IDENTITY)):res="#808080":res="#"+("00000"+(0|tint).toString(16)).slice(-6),res},CanvasGraphicsRenderer.prototype.render=function(graphics){var renderer=this.renderer,context=renderer.context,worldAlpha=graphics.worldAlpha,transform=graphics.transform.worldTransform;renderer.setContextTransform(transform),renderer.setBlendMode(graphics.blendMode);for(var contextFillStyle,contextStrokeStyle,graphicsData=graphics.geometry.graphicsData,tintR=(graphics.tint>>16&255)/255,tintG=(graphics.tint>>8&255)/255,tintB=(255&graphics.tint)/255,i=0;i<graphicsData.length;i++){var data=graphicsData[i],shape=data.shape,fillStyle=data.fillStyle,lineStyle=data.lineStyle,fillColor=0|data.fillStyle.color,lineColor=0|data.lineStyle.color;if(data.matrix&&renderer.setContextTransform(transform.copyTo(this._tempMatrix).append(data.matrix)),fillStyle.visible){var fillTint=((fillColor>>16&255)/255*tintR*255<<16)+((fillColor>>8&255)/255*tintG*255<<8)+(255&fillColor)/255*tintB*255;contextFillStyle=this._calcCanvasStyle(fillStyle,fillTint)}if(lineStyle.visible){var lineTint=((lineColor>>16&255)/255*tintR*255<<16)+((lineColor>>8&255)/255*tintG*255<<8)+(255&lineColor)/255*tintB*255;contextStrokeStyle=this._calcCanvasStyle(lineStyle,lineTint)}if(context.lineWidth=lineStyle.width,context.lineCap=lineStyle.cap,context.lineJoin=lineStyle.join,context.miterLimit=lineStyle.miterLimit,data.type===SHAPES.POLY){context.beginPath();var points=(tempShape=shape).points,holes=data.holes,outerArea=void 0,innerArea=void 0,px=void 0,py=void 0,holesDirection=void 0;context.moveTo(points[0],points[1]);for(var j=2;j<points.length;j+=2)context.lineTo(points[j],points[j+1]);if(tempShape.closeStroke&&context.closePath(),holes.length>0){holesDirection=[],outerArea=0,px=points[0],py=points[1];for(j=2;j+2<points.length;j+=2)outerArea+=(points[j]-px)*(points[j+3]-py)-(points[j+2]-px)*(points[j+1]-py);for(var k=0;k<holes.length;k++)if(points=holes[k].shape.points){innerArea=0,px=points[0],py=points[1];for(j=2;j+2<points.length;j+=2)innerArea+=(points[j]-px)*(points[j+3]-py)-(points[j+2]-px)*(points[j+1]-py);if(innerArea*outerArea<0){context.moveTo(points[0],points[1]);for(j=2;j<points.length;j+=2)context.lineTo(points[j],points[j+1])}else{context.moveTo(points[points.length-2],points[points.length-1]);for(j=points.length-4;j>=0;j-=2)context.lineTo(points[j],points[j+1])}holes[k].shape.closeStroke&&context.closePath(),holesDirection[k]=innerArea*outerArea<0}}fillStyle.visible&&(context.globalAlpha=fillStyle.alpha*worldAlpha,context.fillStyle=contextFillStyle,context.fill()),lineStyle.visible&&this.paintPolygonStroke(tempShape,lineStyle,contextStrokeStyle,holes,holesDirection,worldAlpha,context)}else if(data.type===SHAPES.RECT){var tempShape=shape;if(fillStyle.visible&&(context.globalAlpha=fillStyle.alpha*worldAlpha,context.fillStyle=contextFillStyle,context.fillRect(tempShape.x,tempShape.y,tempShape.width,tempShape.height)),lineStyle.visible){var alignmentOffset=lineStyle.width*(.5-(1-lineStyle.alignment)),width=tempShape.width+2*alignmentOffset,height=tempShape.height+2*alignmentOffset;context.globalAlpha=lineStyle.alpha*worldAlpha,context.strokeStyle=contextStrokeStyle,context.strokeRect(tempShape.x-alignmentOffset,tempShape.y-alignmentOffset,width,height)}}else if(data.type===SHAPES.CIRC){tempShape=shape;if(context.beginPath(),context.arc(tempShape.x,tempShape.y,tempShape.radius,0,2*Math.PI),context.closePath(),fillStyle.visible&&(context.globalAlpha=fillStyle.alpha*worldAlpha,context.fillStyle=contextFillStyle,context.fill()),lineStyle.visible){if(.5!==lineStyle.alignment){alignmentOffset=lineStyle.width*(.5-(1-lineStyle.alignment));context.beginPath(),context.arc(tempShape.x,tempShape.y,tempShape.radius+alignmentOffset,0,2*Math.PI),context.closePath()}context.globalAlpha=lineStyle.alpha*worldAlpha,context.strokeStyle=contextStrokeStyle,context.stroke()}}else if(data.type===SHAPES.ELIP){tempShape=shape;if((drawShapeOverStroke=1===lineStyle.alignment)||this.paintEllipse(tempShape,fillStyle,lineStyle,contextFillStyle,worldAlpha,context),lineStyle.visible){if(.5!==lineStyle.alignment){alignmentOffset=lineStyle.width*(.5-(1-lineStyle.alignment));var sW=2*(tempShape.width+alignmentOffset),sH=2*(tempShape.height+alignmentOffset),sX=tempShape.x-sW/2,sY=tempShape.y-sH/2,sOx=sW/2*.5522848,sOy=sH/2*.5522848,sXe=sX+sW,sYe=sY+sH,sXm=sX+sW/2,sYm=sY+sH/2;context.beginPath(),context.moveTo(sX,sYm),context.bezierCurveTo(sX,sYm-sOy,sXm-sOx,sY,sXm,sY),context.bezierCurveTo(sXm+sOx,sY,sXe,sYm-sOy,sXe,sYm),context.bezierCurveTo(sXe,sYm+sOy,sXm+sOx,sYe,sXm,sYe),context.bezierCurveTo(sXm-sOx,sYe,sX,sYm+sOy,sX,sYm),context.closePath()}context.globalAlpha=lineStyle.alpha*worldAlpha,context.strokeStyle=contextStrokeStyle,context.stroke()}drawShapeOverStroke&&this.paintEllipse(tempShape,fillStyle,lineStyle,contextFillStyle,worldAlpha,context)}else if(data.type===SHAPES.RREC){var drawShapeOverStroke;tempShape=shape;if((drawShapeOverStroke=1===lineStyle.alignment)||this.paintRoundedRectangle(tempShape,fillStyle,lineStyle,contextFillStyle,worldAlpha,context),lineStyle.visible){if(.5!==lineStyle.alignment){width=tempShape.width,height=tempShape.height,alignmentOffset=lineStyle.width*(.5-(1-lineStyle.alignment));var sRx=tempShape.x-alignmentOffset,sRy=tempShape.y-alignmentOffset,sWidth=tempShape.width+2*alignmentOffset,sHeight=tempShape.height+2*alignmentOffset,radiusOffset=alignmentOffset*(lineStyle.alignment>=1?Math.min(sWidth/width,sHeight/height):Math.min(width/sWidth,height/sHeight)),sRadius=tempShape.radius+radiusOffset,sMaxRadius=Math.min(sWidth,sHeight)/2;sRadius=sRadius>sMaxRadius?sMaxRadius:sRadius,context.beginPath(),context.moveTo(sRx,sRy+sRadius),context.lineTo(sRx,sRy+sHeight-sRadius),context.quadraticCurveTo(sRx,sRy+sHeight,sRx+sRadius,sRy+sHeight),context.lineTo(sRx+sWidth-sRadius,sRy+sHeight),context.quadraticCurveTo(sRx+sWidth,sRy+sHeight,sRx+sWidth,sRy+sHeight-sRadius),context.lineTo(sRx+sWidth,sRy+sRadius),context.quadraticCurveTo(sRx+sWidth,sRy,sRx+sWidth-sRadius,sRy),context.lineTo(sRx+sRadius,sRy),context.quadraticCurveTo(sRx,sRy,sRx,sRy+sRadius),context.closePath()}context.globalAlpha=lineStyle.alpha*worldAlpha,context.strokeStyle=contextStrokeStyle,context.stroke()}drawShapeOverStroke&&this.paintRoundedRectangle(tempShape,fillStyle,lineStyle,contextFillStyle,worldAlpha,context)}}},CanvasGraphicsRenderer.prototype.paintPolygonStroke=function(shape,lineStyle,contextStrokeStyle,holes,holesDirection,worldAlpha,context){if(.5!==lineStyle.alignment){var alignmentOffset=lineStyle.width*(.5-(1-lineStyle.alignment)),offsetPoints=PolygonUtils.offsetPolygon(shape.points,alignmentOffset),points=void 0;context.beginPath(),context.moveTo(offsetPoints[0],offsetPoints[1]);for(var j=2;j<offsetPoints.length;j+=2)context.lineTo(offsetPoints[j],offsetPoints[j+1]);shape.closeStroke&&context.closePath();for(var k=0;k<holes.length;k++){if(points=holes[k].shape.points,offsetPoints=PolygonUtils.offsetPolygon(points,alignmentOffset),holesDirection[k]){context.moveTo(offsetPoints[0],offsetPoints[1]);for(j=2;j<offsetPoints.length;j+=2)context.lineTo(offsetPoints[j],offsetPoints[j+1])}else{context.moveTo(offsetPoints[offsetPoints.length-2],offsetPoints[offsetPoints.length-1]);for(j=offsetPoints.length-4;j>=0;j-=2)context.lineTo(offsetPoints[j],offsetPoints[j+1])}holes[k].shape.closeStroke&&context.closePath()}}context.globalAlpha=lineStyle.alpha*worldAlpha,context.strokeStyle=contextStrokeStyle,context.stroke()},CanvasGraphicsRenderer.prototype.paintEllipse=function(shape,fillStyle,lineStyle,contextFillStyle,worldAlpha,context){var w=2*shape.width,h=2*shape.height,x=shape.x-w/2,y=shape.y-h/2,ox=w/2*.5522848,oy=h/2*.5522848,xe=x+w,ye=y+h,xm=x+w/2,ym=y+h/2;0===lineStyle.alignment&&context.save(),context.beginPath(),context.moveTo(x,ym),context.bezierCurveTo(x,ym-oy,xm-ox,y,xm,y),context.bezierCurveTo(xm+ox,y,xe,ym-oy,xe,ym),context.bezierCurveTo(xe,ym+oy,xm+ox,ye,xm,ye),context.bezierCurveTo(xm-ox,ye,x,ym+oy,x,ym),context.closePath(),0===lineStyle.alignment&&context.clip(),fillStyle.visible&&(context.globalAlpha=fillStyle.alpha*worldAlpha,context.fillStyle=contextFillStyle,context.fill()),0===lineStyle.alignment&&context.restore()},CanvasGraphicsRenderer.prototype.paintRoundedRectangle=function(shape,fillStyle,lineStyle,contextFillStyle,worldAlpha,context){var rx=shape.x,ry=shape.y,width=shape.width,height=shape.height,radius=shape.radius,maxRadius=Math.min(width,height)/2;radius=radius>maxRadius?maxRadius:radius,0===lineStyle.alignment&&context.save(),context.beginPath(),context.moveTo(rx,ry+radius),context.lineTo(rx,ry+height-radius),context.quadraticCurveTo(rx,ry+height,rx+radius,ry+height),context.lineTo(rx+width-radius,ry+height),context.quadraticCurveTo(rx+width,ry+height,rx+width,ry+height-radius),context.lineTo(rx+width,ry+radius),context.quadraticCurveTo(rx+width,ry,rx+width-radius,ry),context.lineTo(rx+radius,ry),context.quadraticCurveTo(rx,ry,rx,ry+radius),context.closePath(),0===lineStyle.alignment&&context.clip(),fillStyle.visible&&(context.globalAlpha=fillStyle.alpha*worldAlpha,context.fillStyle=contextFillStyle,context.fill()),0===lineStyle.alignment&&context.restore()},CanvasGraphicsRenderer.prototype.setPatternTransform=function(pattern,matrix){if(!1!==this._svgMatrix){if(!this._svgMatrix){var svg=document.createElementNS("http://www.w3.org/2000/svg","svg");if(svg&&svg.createSVGMatrix&&(this._svgMatrix=svg.createSVGMatrix()),!this._svgMatrix||!pattern.setTransform)return void(this._svgMatrix=!1)}this._svgMatrix.a=matrix.a,this._svgMatrix.b=matrix.b,this._svgMatrix.c=matrix.c,this._svgMatrix.d=matrix.d,this._svgMatrix.e=matrix.tx,this._svgMatrix.f=matrix.ty,pattern.setTransform(this._svgMatrix.inverse())}},CanvasGraphicsRenderer.prototype.destroy=function(){this.renderer=null,this._svgMatrix=null,this._tempMatrix=null},CanvasGraphicsRenderer}(),canvas_graphics_tempMatrix=new Matrix;Graphics.prototype.generateCanvasTexture=function(scaleMode,resolution){void 0===resolution&&(resolution=1);var bounds=this.getLocalBounds(),canvasBuffer=RenderTexture.create({width:bounds.width,height:bounds.height,scaleMode,resolution});canvasRenderer||(canvasRenderer=new CanvasRenderer),this.transform.updateLocalTransform(),this.transform.localTransform.copyTo(canvas_graphics_tempMatrix),canvas_graphics_tempMatrix.invert(),canvas_graphics_tempMatrix.tx-=bounds.x,canvas_graphics_tempMatrix.ty-=bounds.y,canvasRenderer.render(this,{renderTexture:canvasBuffer,clear:!0,transform:canvas_graphics_tempMatrix});var texture=Texture.from(canvasBuffer.baseTexture._canvasRenderTarget.canvas,{scaleMode});return texture.baseTexture.setResolution(resolution),texture},Graphics.prototype.cachedGraphicsData=[],Graphics.prototype._renderCanvas=function(renderer){!0!==this.isMask&&(this.finishPoly(),renderer.plugins.graphics.render(this))};var canvasRenderWorldTransform=new Matrix,CanvasSpriteRenderer=function(){function CanvasSpriteRenderer(renderer){this.renderer=renderer}return CanvasSpriteRenderer.prototype.render=function(sprite){var texture=sprite._texture,renderer=this.renderer,context=renderer.context;if(texture.valid){var width=texture._frame.width,height=texture._frame.height,wt=sprite.transform.worldTransform,dx=0,dy=0,source=texture.baseTexture.getDrawableSource();if(!(texture.orig.width<=0||texture.orig.height<=0)&&texture.valid&&source){renderer.setBlendMode(sprite.blendMode,!0),renderer.context.globalAlpha=sprite.worldAlpha;var smoothingEnabled=texture.baseTexture.scaleMode===constants_SCALE_MODES.LINEAR;renderer.smoothProperty&&renderer.context[renderer.smoothProperty]!==smoothingEnabled&&(context[renderer.smoothProperty]=smoothingEnabled),texture.trim?(dx=texture.trim.width/2+texture.trim.x-sprite.anchor.x*texture.orig.width,dy=texture.trim.height/2+texture.trim.y-sprite.anchor.y*texture.orig.height):(dx=(.5-sprite.anchor.x)*texture.orig.width,dy=(.5-sprite.anchor.y)*texture.orig.height),texture.rotate&&(wt.copyTo(canvasRenderWorldTransform),wt=canvasRenderWorldTransform,groupD8.matrixAppendRotationInv(wt,texture.rotate,dx,dy),dx=0,dy=0),dx-=width/2,dy-=height/2,renderer.setContextTransform(wt,sprite.roundPixels,1),sprite.roundPixels&&(dx|=0,dy|=0);var resolution=texture.baseTexture.resolution,outerBlend=renderer._outerBlend;outerBlend&&(context.save(),context.beginPath(),context.rect(dx*renderer.resolution,dy*renderer.resolution,width*renderer.resolution,height*renderer.resolution),context.clip()),16777215!==sprite.tint?(sprite._cachedTint===sprite.tint&&sprite._tintedCanvas.tintId===sprite._texture._updateID||(sprite._cachedTint=sprite.tint,sprite._tintedCanvas=canvasUtils.getTintedCanvas(sprite,sprite.tint)),context.drawImage(sprite._tintedCanvas,0,0,Math.floor(width*resolution),Math.floor(height*resolution),Math.floor(dx*renderer.resolution),Math.floor(dy*renderer.resolution),Math.floor(width*renderer.resolution),Math.floor(height*renderer.resolution))):context.drawImage(source,texture._frame.x*resolution,texture._frame.y*resolution,Math.floor(width*resolution),Math.floor(height*resolution),Math.floor(dx*renderer.resolution),Math.floor(dy*renderer.resolution),Math.floor(width*renderer.resolution),Math.floor(height*renderer.resolution)),outerBlend&&context.restore(),renderer.setBlendMode(constants_BLEND_MODES.NORMAL)}}},CanvasSpriteRenderer.prototype.destroy=function(){this.renderer=null},CanvasSpriteRenderer}();Sprite.prototype._tintedCanvas=null,Sprite.prototype._renderCanvas=function(renderer){renderer.plugins.sprite.render(this)};var canvas_extract_TEMP_RECT=new Rectangle,CanvasExtract=function(){function CanvasExtract(renderer){this.renderer=renderer}return CanvasExtract.prototype.image=function(target,format,quality){var image=new Image;return image.src=this.base64(target,format,quality),image},CanvasExtract.prototype.base64=function(target,format,quality){return this.canvas(target).toDataURL(format,quality)},CanvasExtract.prototype.canvas=function(target){var context,resolution,frame,renderTexture,renderer=this.renderer;target&&(renderTexture=target instanceof RenderTexture?target:renderer.generateTexture(target)),renderTexture?(context=renderTexture.baseTexture._canvasRenderTarget.context,resolution=renderTexture.baseTexture._canvasRenderTarget.resolution,frame=renderTexture.frame):(context=renderer.rootContext,resolution=renderer.resolution,(frame=canvas_extract_TEMP_RECT).width=this.renderer.width,frame.height=this.renderer.height);var width=Math.floor(frame.width*resolution+1e-4),height=Math.floor(frame.height*resolution+1e-4),canvasBuffer=new CanvasRenderTarget(width,height,1),canvasData=context.getImageData(frame.x*resolution,frame.y*resolution,width,height);return canvasBuffer.context.putImageData(canvasData,0,0),canvasBuffer.canvas},CanvasExtract.prototype.pixels=function(target){var context,resolution,frame,renderTexture,renderer=this.renderer;target&&(renderTexture=target instanceof RenderTexture?target:renderer.generateTexture(target)),renderTexture?(context=renderTexture.baseTexture._canvasRenderTarget.context,resolution=renderTexture.baseTexture._canvasRenderTarget.resolution,frame=renderTexture.frame):(context=renderer.rootContext,resolution=renderer.resolution,(frame=canvas_extract_TEMP_RECT).width=renderer.width,frame.height=renderer.height);var x=frame.x*resolution,y=frame.y*resolution,width=frame.width*resolution,height=frame.height*resolution;return context.getImageData(x,y,width,height).data},CanvasExtract.prototype.destroy=function(){this.renderer=null},CanvasExtract}(),canvas_prepare_extendStatics=function(d,b){return canvas_prepare_extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])},canvas_prepare_extendStatics(d,b)};function canvas_prepare_uploadBaseTextures(prepare,item){var tempPrepare=prepare;if(item instanceof BaseTexture){var image=item.source,imageWidth=0===image.width?tempPrepare.canvas.width:Math.min(tempPrepare.canvas.width,image.width),imageHeight=0===image.height?tempPrepare.canvas.height:Math.min(tempPrepare.canvas.height,image.height);return tempPrepare.ctx.drawImage(image,0,0,imageWidth,imageHeight,0,0,tempPrepare.canvas.width,tempPrepare.canvas.height),!0}return!1}var CanvasPrepare=function(_super){function CanvasPrepare(renderer){var _this=_super.call(this,renderer)||this;return _this.uploadHookHelper=_this,_this.canvas=document.createElement("canvas"),_this.canvas.width=16,_this.canvas.height=16,_this.ctx=_this.canvas.getContext("2d"),_this.registerUploadHook(canvas_prepare_uploadBaseTextures),_this}return function(d,b){function __(){this.constructor=d}canvas_prepare_extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}(CanvasPrepare,_super),CanvasPrepare.prototype.destroy=function(){_super.prototype.destroy.call(this),this.ctx=null,this.canvas=null},CanvasPrepare}(BasePrepare),worldMatrix=new Matrix,patternMatrix=new Matrix,patternRect=[new Point,new Point,new Point,new Point];TilingSprite.prototype._renderCanvas=function(renderer){var texture=this._texture;if(texture.baseTexture.valid){var context=renderer.context,transform=this.worldTransform,baseTexture=texture.baseTexture,source=baseTexture.getDrawableSource(),baseTextureResolution=baseTexture.resolution;if(this._textureID!==this._texture._updateID||this._cachedTint!==this.tint){this._textureID=this._texture._updateID;var tempCanvas=new CanvasRenderTarget(texture._frame.width,texture._frame.height,baseTextureResolution);16777215!==this.tint?(this._tintedCanvas=canvasUtils.getTintedCanvas(this,this.tint),tempCanvas.context.drawImage(this._tintedCanvas,0,0)):tempCanvas.context.drawImage(source,-texture._frame.x*baseTextureResolution,-texture._frame.y*baseTextureResolution),this._cachedTint=this.tint,this._canvasPattern=tempCanvas.context.createPattern(tempCanvas.canvas,"repeat")}context.globalAlpha=this.worldAlpha,renderer.setBlendMode(this.blendMode),this.tileTransform.updateLocalTransform();var lt=this.tileTransform.localTransform,W=this._width,H=this._height;worldMatrix.identity(),patternMatrix.copyFrom(lt),this.uvRespectAnchor||patternMatrix.translate(-this.anchor.x*W,-this.anchor.y*H),patternMatrix.scale(this.tileScale.x/baseTextureResolution,this.tileScale.y/baseTextureResolution),worldMatrix.prepend(patternMatrix),worldMatrix.prepend(transform),renderer.setContextTransform(worldMatrix),context.fillStyle=this._canvasPattern;var lx=this.anchor.x*-W,ly=this.anchor.y*-H;patternRect[0].set(lx,ly),patternRect[1].set(lx+W,ly),patternRect[2].set(lx+W,ly+H),patternRect[3].set(lx,ly+H);for(var i=0;i<4;i++)patternMatrix.applyInverse(patternRect[i],patternRect[i]);context.beginPath(),context.moveTo(patternRect[0].x,patternRect[0].y);for(i=1;i<4;i++)context.lineTo(patternRect[i].x,patternRect[i].y);context.closePath(),context.fill()}},ParticleContainer.prototype.renderCanvas=function(renderer){if(this.visible&&!(this.worldAlpha<=0)&&this.children.length&&this.renderable){var context=renderer.context,transform=this.worldTransform,isRotated=!0,positionX=0,positionY=0,finalWidth=0,finalHeight=0;renderer.setBlendMode(this.blendMode),context.globalAlpha=this.worldAlpha,this.displayObjectUpdateTransform();for(var i=0;i<this.children.length;++i){var child=this.children[i];if(child.visible&&child._texture.valid){var frame=child._texture.frame;if(context.globalAlpha=this.worldAlpha*child.alpha,child.rotation%(2*Math.PI)==0)isRotated&&(renderer.setContextTransform(transform,!1,1),isRotated=!1),positionX=child.anchor.x*(-frame.width*child.scale.x)+child.position.x+.5,positionY=child.anchor.y*(-frame.height*child.scale.y)+child.position.y+.5,finalWidth=frame.width*child.scale.x,finalHeight=frame.height*child.scale.y;else{isRotated||(isRotated=!0),child.displayObjectUpdateTransform();var childTransform=child.worldTransform;renderer.setContextTransform(childTransform,this.roundPixels,1),positionX=child.anchor.x*-frame.width+.5,positionY=child.anchor.y*-frame.height+.5,finalWidth=frame.width,finalHeight=frame.height}var resolution=child._texture.baseTexture.resolution;context.drawImage(child._texture.baseTexture.getDrawableSource(),frame.x*resolution,frame.y*resolution,frame.width*resolution,frame.height*resolution,positionX*renderer.resolution,positionY*renderer.resolution,finalWidth*renderer.resolution,finalHeight*renderer.resolution)}}}},Container.prototype._renderCanvas=function(_renderer){},Container.prototype.renderCanvas=function(renderer){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable){this._mask&&renderer.maskManager.pushMask(this._mask),this._renderCanvas(renderer);for(var i=0,j=this.children.length;i<j;++i)this.children[i].renderCanvas(renderer);this._mask&&renderer.maskManager.popMask(renderer)}},DisplayObject.prototype.renderCanvas=function(_renderer){},Text.prototype._renderCanvas=function(renderer){this._autoResolution&&this._resolution!==renderer.resolution&&(this._resolution=renderer.resolution,this.dirty=!0),this.updateText(!0),Sprite.prototype._renderCanvas.call(this,renderer)},CanvasRenderer.registerPlugin("accessibility",AccessibilityManager),CanvasRenderer.registerPlugin("extract",CanvasExtract),CanvasRenderer.registerPlugin("graphics",CanvasGraphicsRenderer),CanvasRenderer.registerPlugin("interaction",InteractionManager),CanvasRenderer.registerPlugin("mesh",CanvasMeshRenderer),CanvasRenderer.registerPlugin("prepare",CanvasPrepare),CanvasRenderer.registerPlugin("sprite",CanvasSpriteRenderer);const graphics={init:function(){this.initBonkGraphics()},initBonkGraphics:function(){BonkGraphics.prototype.render=(BonkGraphics.prototype.render_OLD=BonkGraphics.prototype.render,function(){const gmStateA=arguments[0].physics.bodies[0]?.cf,gmStateB=arguments[1].physics.bodies[0]?.cf;if(arguments[0].physics.shapes.length!=arguments[1].physics.shapes.length){for(let i=0;i<arguments[1].physics.shapes.length;i++)arguments[0].physics.shapes[i]||(arguments[0].physics.shapes[i]=arguments[1].physics.shapes[i]);for(let i=0;i<arguments[1].physics.bodies.length;i++)arguments[0].physics.bodies[i]||(arguments[0].physics.bodies[i]=arguments[1].physics.bodies[i]);for(let i=0;i<arguments[1].physics.fixtures.length;i++)arguments[0].physics.fixtures[i]||(arguments[0].physics.fixtures[i]=arguments[1].physics.fixtures[i])}if(!this.discGraphics?.[this.discGraphics?.length-1]?.__proto__.doOffScreen_OLD&&this.discGraphics?.[this.discGraphics?.length-1]?.__proto__.doOffScreen){const discGraphic=this.discGraphics?.[this.discGraphics?.length-1];discGraphic.__proto__.doOffScreen_OLD=discGraphic.__proto__.doOffScreen,discGraphic.__proto__.doOffScreen=function(){if(this.offScreenContainer.visible=!1,!gm.physics.gameState?.physics.bodies[0].cf.cameraChanged&&gm.physics.gameState?.rl>1)return this.doOffScreen_OLD.apply(this,arguments)}}if(gm.graphics.cameraContainer&&!gm.graphics.cameraContainer._destroyed&&gm.lobby.networkEngine&&gmStateA?.cameras?.[gm.lobby.networkEngine.getLSID()]&&gmStateB?.cameras?.[gm.lobby.networkEngine.getLSID()]){const cameraObjA=gmStateA.cameras[gm.lobby.networkEngine.getLSID()],cameraObjB=gmStateB.cameras[gm.lobby.networkEngine.getLSID()],scaleMultiplier=arguments[0].physics.ppm*gm.graphics.rendererClass.scaleRatio;if(cameraObjA.doLerp||cameraObjB.doLerp){const anglePointA=[Math.sin(cameraObjA.angle),Math.cos(cameraObjA.angle)],anglePointB=[Math.sin(cameraObjB.angle),Math.cos(cameraObjB.angle)],lerpedAnglePoint=[(1-arguments[2])*anglePointA[0]+arguments[2]*anglePointB[0],(1-arguments[2])*anglePointA[1]+arguments[2]*anglePointB[1]];gm.graphics.cameraContainer.pivot.x=(1-arguments[2])*cameraObjA.xpos*scaleMultiplier+arguments[2]*cameraObjB.xpos*scaleMultiplier,gm.graphics.cameraContainer.pivot.y=(1-arguments[2])*cameraObjA.ypos*scaleMultiplier+arguments[2]*cameraObjB.ypos*scaleMultiplier,gm.graphics.cameraContainer.rotation=Math.atan2(lerpedAnglePoint[0],lerpedAnglePoint[1]),gm.graphics.cameraContainer.scale.x=(1-arguments[2])*cameraObjA.xscal+arguments[2]*cameraObjB.xscal,gm.graphics.cameraContainer.scale.y=(1-arguments[2])*cameraObjA.yscal+arguments[2]*cameraObjB.yscal,gm.graphics.cameraContainer.skew.x=(1-arguments[2])*cameraObjA.xskew+arguments[2]*cameraObjB.xskew,gm.graphics.cameraContainer.skew.y=(1-arguments[2])*cameraObjA.yskew+arguments[2]*cameraObjB.yskew}else gm.graphics.cameraContainer.pivot.x=cameraObjB.xpos*scaleMultiplier,gm.graphics.cameraContainer.pivot.y=cameraObjB.ypos*scaleMultiplier,gm.graphics.cameraContainer.angle=cameraObjB.angle,gm.graphics.cameraContainer.scale.x=cameraObjB.xscal,gm.graphics.cameraContainer.scale.y=cameraObjB.yscal,gm.graphics.cameraContainer.skew.x=cameraObjB.xskew,gm.graphics.cameraContainer.skew.y=cameraObjB.yskew;window.gmReplaceAccessors.addToStereo=(-gm.graphics.cameraContainer.pivot.x+730*this.scaleRatio)*gm.graphics.cameraContainer.scale.x/(365*this.scaleRatio)-1}for(let i=0;i<this.arrowGraphics.length;i++)!this.arrowGraphics[i]||!gm.graphics.cameraContainer.children.includes(this.arrowGraphics[i].graphic)||arguments[0].projectiles[i]&&arguments[1].projectiles[i]&&arguments[1].projectiles[i].did==this.arrowGraphics[i].ownerID||gm.graphics.cameraContainer.removeChild(this.arrowGraphics[i].graphic);const result=this.render_OLD.apply(this,arguments);gm.graphics.bodyGraphicsClass||(gm.graphics.bodyGraphicsClass=this.roundGraphics.bodyGraphics[0]?.constructor),gm.graphics.rendererClass=this,gm.graphics.rendering=!0,gm.graphics.cameraContainer&&!gm.graphics.cameraContainer._destroyed&&this.blurContainer.children.includes(gm.graphics.cameraContainer)||(gm.graphics.cameraContainer=new Container,this.blurContainer.addChild(gm.graphics.cameraContainer),gm.graphics.cameraContainer.addChild(this.environmentContainer),gm.graphics.cameraContainer.addChild(this.discContainer),gm.graphics.cameraContainer.pivot.x=365*gm.graphics.rendererClass.scaleRatio,gm.graphics.cameraContainer.pivot.y=250*gm.graphics.rendererClass.scaleRatio,gm.graphics.cameraContainer.sortableChildren=!0),gm.graphics.cameraContainer.children.includes(this.particleManager.container)||gm.graphics.cameraContainer.addChild(this.particleManager.container),!this.blurContainer||this.blurContainer.pivot.x==gm.graphics.rendererClass.domLastWidth/2&&this.blurContainer.pivot.y==gm.graphics.rendererClass.domLastHeight/2||(this.blurContainer.pivot.x=-365*gm.graphics.rendererClass.scaleRatio,this.blurContainer.pivot.y=-250*gm.graphics.rendererClass.scaleRatio);for(let i=0;i<this.arrowGraphics.length;i++)this.arrowGraphics[i]&&!gm.graphics.cameraContainer.children.includes(this.arrowGraphics[i].graphic)&&gm.graphics.cameraContainer.addChild(this.arrowGraphics[i].graphic);if(gm.graphics.rendererClass)for(let i=0;i<gm.graphics.rendererClass.discGraphics.length;i++)arguments[0].discs[i]&&gm.graphics.rendererClass.discGraphics[i]&&gm.graphics.additionalDiscGraphics[i]&&!gm.graphics.rendererClass.discGraphics[i].container.children.includes(gm.graphics.additionalDiscGraphics[i])&&(gm.graphics.additionalDiscGraphics[i].scale.x=gm.graphics.rendererClass.scaleRatio,gm.graphics.additionalDiscGraphics[i].scale.y=gm.graphics.rendererClass.scaleRatio,gm.graphics.rendererClass.discGraphics[i].container.addChild(gm.graphics.additionalDiscGraphics[i])),arguments[0].discs[i]&&gm.graphics.rendererClass.blurContainer&&gm.graphics.additionalWorldGraphics[i]&&!gm.graphics.cameraContainer.children.includes(gm.graphics.additionalWorldGraphics[i])&&(gm.graphics.additionalWorldGraphics[i].scale.x=gm.graphics.rendererClass.scaleRatio,gm.graphics.additionalWorldGraphics[i].scale.y=gm.graphics.rendererClass.scaleRatio,gm.graphics.cameraContainer.addChild(gm.graphics.additionalWorldGraphics[i])),arguments[0].discs[i]&&gm.graphics.rendererClass.blurContainer&&gm.graphics.additionalScreenGraphics[i]&&!gm.graphics.rendererClass.blurContainer.children.includes(gm.graphics.additionalScreenGraphics[i])&&(gm.graphics.additionalScreenGraphics[i].scale.x=gm.graphics.rendererClass.scaleRatio,gm.graphics.additionalScreenGraphics[i].scale.y=gm.graphics.rendererClass.scaleRatio,gm.graphics.additionalScreenGraphics[i].pivot.x=365,gm.graphics.additionalScreenGraphics[i].pivot.y=250,gm.graphics.rendererClass.blurContainer.addChild(gm.graphics.additionalScreenGraphics[i]));const gst=gm.physics.gameState;let randomSeed=0;for(let i=0;i<gst.physics.bodies.length;i++)gst.physics.bodies[i]&&(randomSeed=randomSeed+gst.physics.bodies[i].p[0]+gst.physics.bodies[i].p[1]+gst.physics.bodies[i].a);for(let i=0;i<gst.discs.length;i++)gst.discs[i]&&(randomSeed=randomSeed+gst.discs[i].x+gst.discs[i].y+gst.discs[i].xv+gst.discs[i].yv);if(randomSeed+=gst.rl,randomSeed/=gst.seed,gm.physics.pseudoRandom=new(seedrandom_default())(randomSeed),gm.physics.gameState&&gm.physics.gameState.discs)for(let i=0;i<gm.physics.gameState.discs.length;i++)if(gm.physics.gameState.discs[i]){gm.inputs.allPlayerInputs[i]||(gm.inputs.allPlayerInputs[i]={left:!1,right:!1,up:!1,down:!1,action:!1,action2:!1});try{gm.graphics.onRender(i)}catch(e){gm.lobby.gameCrashed||("gmInfiniteLoop"===e?gm.lobby.haltCausedByLoop=!0:console.error(e),gm.lobby.gameCrashed=!0,setTimeout(gm.lobby.gameHalt,500))}}return gm.graphics.rendering=!1,result}),BonkGraphics.prototype.build=(BonkGraphics.prototype.build_OLD=BonkGraphics.prototype.build,function(){const result=this.build_OLD.apply(this,arguments);return gm.blockly.varInspector.innerHTML="",result}),BonkGraphics.prototype.destroy=(BonkGraphics.prototype.destroy_OLD=BonkGraphics.prototype.destroy,function(){if(gm.blockly.varInspector.innerHTML="",gm.graphics.rendererClass){for(let a=0;a!=gm.graphics.rendererClass.discGraphics.length;a++){if(!gm.graphics.rendererClass.discGraphics[a])continue;gm.graphics.additionalDiscGraphics[a]?.removeChildren(),gm.graphics.additionalWorldGraphics[a]?.removeChildren(),gm.graphics.additionalScreenGraphics[a]?.removeChildren();const discObject=gm.graphics.rendererClass.discGraphics[a].container;for(;discObject.children[0];)discObject.removeChild(discObject.children[0])}const worldObject=gm.graphics.rendererClass.blurContainer;for(;worldObject.children[0];)worldObject.removeChild(worldObject.children[0]);gm.graphics.cameraContainer?.destroy(),gm.graphics.additionalDiscGraphics=[],gm.graphics.additionalWorldGraphics=[],gm.graphics.additionalScreenGraphics=[]}const result=this.destroy_OLD.apply(this,arguments);return gm.graphics.renderUpdates=[],result}),BonkGraphics.prototype.resizeRenderer=(BonkGraphics.prototype.resizeRenderer_OLD=BonkGraphics.prototype.resizeRenderer,function(){if(gm.graphics.rendererClass){for(let i=0;i<gm.graphics.additionalDiscGraphics.length;i++)gm.graphics.additionalDiscGraphics[i]&&gm.graphics.rendererClass.discGraphics[i]?.container.removeChild(gm.graphics.additionalDiscGraphics[i]);for(let i=0;i<gm.graphics.additionalWorldGraphics.length;i++)gm.graphics.additionalWorldGraphics[i]&&gm.graphics.cameraContainer?.removeChild(gm.graphics.additionalWorldGraphics[i]);for(let i=0;i<gm.graphics.additionalScreenGraphics.length;i++)gm.graphics.additionalScreenGraphics[i]&&gm.graphics.rendererClass.blurContainer?.removeChild(gm.graphics.additionalScreenGraphics[i]);const result=this.resizeRenderer_OLD.apply(this,arguments);for(let i=0;i<gm.graphics.additionalDiscGraphics.length;i++)gm.graphics.additionalDiscGraphics[i]&&(gm.graphics.additionalDiscGraphics[i].scale.x=gm.graphics.rendererClass.scaleRatio,gm.graphics.additionalDiscGraphics[i].scale.y=gm.graphics.rendererClass.scaleRatio,gm.graphics.rendererClass.discGraphics[i]?.container.addChild(gm.graphics.additionalDiscGraphics[i]),gm.graphics.additionalWorldGraphics[i].scale.x=gm.graphics.rendererClass.scaleRatio,gm.graphics.additionalWorldGraphics[i].scale.y=gm.graphics.rendererClass.scaleRatio,gm.graphics.cameraContainer?.addChild(gm.graphics.additionalWorldGraphics[i]),gm.graphics.additionalScreenGraphics[i].scale.x=gm.graphics.rendererClass.scaleRatio,gm.graphics.additionalScreenGraphics[i].scale.y=gm.graphics.rendererClass.scaleRatio,gm.graphics.additionalScreenGraphics[i].pivot.x=365,gm.graphics.additionalScreenGraphics[i].pivot.y=250,gm.graphics.rendererClass.blurContainer?.addChild(gm.graphics.additionalScreenGraphics[i]));return gm.graphics.cameraContainer&&!gm.graphics.cameraContainer._destroyed&&(gm.graphics.cameraContainer.pivot.x=365*gm.graphics.rendererClass.scaleRatio,gm.graphics.cameraContainer.pivot.y=250*gm.graphics.rendererClass.scaleRatio),result}return this.resizeRenderer_OLD.apply(this,arguments)})},onPhysStep:function(gameState){0==gameState.fte&&(gm.blockly.varInspector.innerHTML="");const shouldShowVarInsp="true"===gm.blockly.savedSettings?.getAttribute("show_var_insp");shouldShowVarInsp&&"block"!==gm.blockly.varInspectorContainer.style.display?gm.blockly.varInspectorContainer.style.display="block":shouldShowVarInsp||"none"===gm.blockly.varInspectorContainer.style.display||(gm.blockly.varInspectorContainer.style.display="none"),gm.graphics.rendererClass?.playerArray&&shouldShowVarInsp&&gm.blockly.updateVarInspector(gameState);for(let i=0;i<gameState.physics.bodies[0]?.cf.initialPlayers?.length;i++){const id=gameState.physics.bodies[0].cf.initialPlayers[i];gm.graphics.additionalDiscGraphics[id]&&!gm.graphics.additionalDiscGraphics[id]._destroyed||(gm.graphics.additionalDiscGraphics[id]=new Graphics),gm.graphics.additionalWorldGraphics[id]&&!gm.graphics.additionalWorldGraphics[id]._destroyed||(gm.graphics.additionalWorldGraphics[id]=new Graphics,gm.graphics.additionalWorldGraphics[id].zIndex=9999),gm.graphics.additionalScreenGraphics[id]&&!gm.graphics.additionalScreenGraphics[id]._destroyed||(gm.graphics.additionalScreenGraphics[id]=new Graphics,gm.graphics.additionalScreenGraphics[id].zIndex=9999)}1===gameState.rl&&gm.blockly.funcs.clearGraphics()},doRollback:function(fromStepCount,toStepCount){for(let i=fromStepCount;i>toStepCount;i--){const previousGameState=window.gmReplaceAccessors.gameStateList[i-1],gameState=window.gmReplaceAccessors.gameStateList[i];if(gm.graphics.renderUpdates[gameState.rl]&&previousGameState){const alreadyDone=[];for(let a=0;a!=gm.graphics.renderUpdates[gameState.rl].length;a++){const update=gm.graphics.renderUpdates[gameState.rl][a];if(!alreadyDone.includes(update)){switch(update.action){case"create":this.rendererClass.roundGraphics.bodyGraphics[update.id]&&(this.rendererClass.roundGraphics.displayObject.removeChild(this.rendererClass.roundGraphics.bodyGraphics[update.id].jointContainer),this.rendererClass.roundGraphics.displayObject.removeChild(this.rendererClass.roundGraphics.bodyGraphics[update.id].displayObject),this.rendererClass.roundGraphics.bodyGraphics[update.id].destroy(),delete this.rendererClass.roundGraphics.bodyGraphics[update.id]);break;case"delete":{const newBodyGraphics=new gm.graphics.bodyGraphicsClass(previousGameState,update.id,this.rendererClass.scaleRatio,this.rendererClass.renderer,gm.lobby.mpSession.getGameSettings(),this.rendererClass.playerArray);this.rendererClass.roundGraphics.bodyGraphics[update.id]=newBodyGraphics;const bodyBehind=this.rendererClass.roundGraphics.bodyGraphics[previousGameState.physics.bro[Math.min(previousGameState.physics.bro.indexOf(update.id),0)]]?.displayObject,index=this.rendererClass.roundGraphics.displayObject.children.indexOf(bodyBehind);bodyBehind&&-1!==index?(newBodyGraphics.jointContainer.children.length>0&&this.rendererClass.roundGraphics.displayObject.addChildAt(newBodyGraphics.jointContainer,index),this.rendererClass.roundGraphics.displayObject.addChildAt(newBodyGraphics.displayObject,index)):(newBodyGraphics.jointContainer.children.length>0&&this.rendererClass.roundGraphics.displayObject.addChild(newBodyGraphics.jointContainer),this.rendererClass.roundGraphics.displayObject.addChildAt(newBodyGraphics.displayObject,0));break}case"update":{this.rendererClass.roundGraphics.bodyGraphics[update.id]&&(this.rendererClass.roundGraphics.displayObject.removeChild(this.rendererClass.roundGraphics.bodyGraphics[update.id].jointContainer),this.rendererClass.roundGraphics.displayObject.removeChild(this.rendererClass.roundGraphics.bodyGraphics[update.id].displayObject),this.rendererClass.roundGraphics.bodyGraphics[update.id]?.destroy());const newBodyGraphics=new gm.graphics.bodyGraphicsClass(previousGameState,update.id,this.rendererClass.scaleRatio,this.rendererClass.renderer,gm.lobby.mpSession.getGameSettings(),this.rendererClass.playerArray);this.rendererClass.roundGraphics.bodyGraphics[update.id]=newBodyGraphics;const bodyBehind=this.rendererClass.roundGraphics.bodyGraphics[previousGameState.physics.bro[Math.min(previousGameState.physics.bro.indexOf(update.id),0)]]?.displayObject,index=this.rendererClass.roundGraphics.displayObject.children.indexOf(bodyBehind);bodyBehind&&-1!==index?(newBodyGraphics.jointContainer.children.length>0&&this.rendererClass.roundGraphics.displayObject.addChildAt(newBodyGraphics.jointContainer,index),this.rendererClass.roundGraphics.displayObject.addChildAt(newBodyGraphics.displayObject,index)):(newBodyGraphics.jointContainer.children.length>0&&this.rendererClass.roundGraphics.displayObject.addChild(newBodyGraphics.jointContainer),this.rendererClass.roundGraphics.displayObject.addChildAt(newBodyGraphics.displayObject,0));break}}alreadyDone.push(update)}}delete gm.graphics.renderUpdates[gameState.rl]}}},doRenderUpdates:function(gameState){if(!gm.graphics.renderUpdates[gameState.rl])return;if(!gm.graphics.rendererClass.roundGraphics)return;const alreadyDone=[];for(let i=0;i<gm.graphics.renderUpdates[gameState.rl].length;i++){const update=gm.graphics.renderUpdates[gameState.rl][i];if(!alreadyDone.includes(update)&&!update.done){switch(update.action){case"create":{const newBodyGraphics=new gm.graphics.bodyGraphicsClass(gameState,update.id,this.rendererClass.scaleRatio,this.rendererClass.renderer,gm.lobby.mpSession.getGameSettings(),this.rendererClass.playerArray);this.rendererClass.roundGraphics.bodyGraphics[update.id]=newBodyGraphics;const bodyBehind=this.rendererClass.roundGraphics.bodyGraphics[gameState.physics.bro[Math.min(gameState.physics.bro.indexOf(update.id),0)]]?.displayObject,index=this.rendererClass.roundGraphics.displayObject.children.indexOf(bodyBehind);bodyBehind&&-1!==index?(newBodyGraphics.jointContainer.children.length>0&&this.rendererClass.roundGraphics.displayObject.addChildAt(newBodyGraphics.jointContainer,index),this.rendererClass.roundGraphics.displayObject.addChildAt(newBodyGraphics.displayObject,index)):(newBodyGraphics.jointContainer.children.length>0&&this.rendererClass.roundGraphics.displayObject.addChild(newBodyGraphics.jointContainer),this.rendererClass.roundGraphics.displayObject.addChild(newBodyGraphics.displayObject));break}case"delete":this.rendererClass.roundGraphics.bodyGraphics[update.id]&&(this.rendererClass.roundGraphics.displayObject.removeChild(this.rendererClass.roundGraphics.bodyGraphics[update.id].jointContainer),this.rendererClass.roundGraphics.displayObject.removeChild(this.rendererClass.roundGraphics.bodyGraphics[update.id].displayObject),this.rendererClass.roundGraphics.bodyGraphics[update.id].destroy(),delete this.rendererClass.roundGraphics.bodyGraphics[update.id]);break;case"update":{this.rendererClass.roundGraphics.bodyGraphics[update.id]&&(this.rendererClass.roundGraphics.displayObject.removeChild(this.rendererClass.roundGraphics.bodyGraphics[update.id].jointContainer),this.rendererClass.roundGraphics.displayObject.removeChild(this.rendererClass.roundGraphics.bodyGraphics[update.id].displayObject),this.rendererClass.roundGraphics.bodyGraphics[update.id]?.destroy());const newBodyGraphics=new gm.graphics.bodyGraphicsClass(gameState,update.id,this.rendererClass.scaleRatio,this.rendererClass.renderer,gm.lobby.mpSession.getGameSettings(),this.rendererClass.playerArray);this.rendererClass.roundGraphics.bodyGraphics[update.id]=newBodyGraphics;const bodyBehind=this.rendererClass.roundGraphics.bodyGraphics[gameState.physics.bro[Math.min(gameState.physics.bro.indexOf(update.id),0)]]?.displayObject,index=this.rendererClass.roundGraphics.displayObject.children.indexOf(bodyBehind);bodyBehind&&-1!==index?(newBodyGraphics.jointContainer.children.length>0&&this.rendererClass.roundGraphics.displayObject.addChildAt(newBodyGraphics.jointContainer,index),this.rendererClass.roundGraphics.displayObject.addChildAt(newBodyGraphics.displayObject,index)):(newBodyGraphics.jointContainer.children.length>0&&this.rendererClass.roundGraphics.displayObject.addChild(newBodyGraphics.jointContainer),this.rendererClass.roundGraphics.displayObject.addChild(newBodyGraphics.displayObject));break}}gm.graphics.renderUpdates[gameState.rl][i].done=!0,update.done=!0,alreadyDone.push(update)}}},rendererClass:null,bodyGraphicsClass:null,cameraContainer:null,rendering:!1,renderUpdates:[],additionalDiscGraphics:[],additionalWorldGraphics:[],additionalScreenGraphics:[],availableText:[],usedText:[],onRender:function(){}},inputs={init:function(){},allPlayerInputs:{}};var lobby=__webpack_require__(6111),blockly=__webpack_require__(9323);window.initGM=function(){if(!window.gm){window.gmStyles&&document.querySelector("head").appendChild(window.gmStyles),window.gm={physics,graphics,lobby:lobby.Z,inputs,blockly:blockly.Z};for(const key in gm)gm[key].init();console.log("[Game Mode Maker] The extension has been successfully loaded!")}}})()})();